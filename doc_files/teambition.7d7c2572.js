webpackJsonp([5],[function(t,e,i){t.exports=i(616)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){var n,r,o,s=[].slice;r=i(351),o=i(558),n="apps.create-organization.",t.exports={locale:$("html").attr("lang")||"en",setLocale:function(t){return this.locale=t},__:function(){var t,e;return e=arguments[0],t=2<=arguments.length?s.call(arguments,1):[],t.unshift(this.locale),t.unshift(n+e),o.point.apply(o,t)}}},function(t,e,i){var n=i(455);n.setLocales("zh",{"apps.create-organization.title":"创建企业","apps.create-organization.introContent":"协作之上，是更有意义的企业管理。Teambition 组织帮助你更好地管理部门、成员，并拥有无限项目数量。可以免费使用14天。","apps.create-organization.tabTitleCreate":"创建企业","apps.create-organization.tabTitleContact":"联络方式","apps.create-organization.tabInfoCreateGuide":"输入企业名称，解锁企业独有功能","apps.create-organization.tabInfoCreateGuideBusinessLink":"Teambition企业版","apps.create-organization.tabInfoOrgNamePlaceholder":"企业名称","apps.create-organization.tabContactPhoneGuide":"最后一步，确认联系方式，免费培训团队<br>如需帮助，可拨打 400-060-5576","apps.create-organization.tabContactName":"联系人","apps.create-organization.tabContactPhoneNumber":"手机号","apps.create-organization.tabContactRetryGetVerifyCode":"重新获取","apps.create-organization.tabContactRetryGetVerifyCodeCD":"重新获取 (%s)","apps.create-organization.tabContactNotValidVerifyCode":"验证码错误","apps.create-organization.tabContactSendingVerifyCode":"正在发送中...","apps.create-organization.tabContactSMSVerifyCode":"短信验证码","apps.create-organization.tabContactPhoneBound":"该号码已通过验证","apps.create-organization.tabContactNoSMSNeeded":"该号码无需验证","apps.create-organization.tabFooterDone":"完成","apps.create-organization.tabFooterStepNext":"下一步","apps.create-organization.tabFooterCreatingOrg":"企业创建中","apps.create-organization.tabFooterGetSMSVerify":"获取短信验证码","apps.create-organization.countrycode":"国际区号","apps.create-organization.country_chn":"中国","apps.create-organization.country_hk":"中国香港","apps.create-organization.country_tw":"台湾","apps.create-organization.country_jp":"日本","apps.create-organization.country_us":"美国","apps.create-organization.country_other":"其他","apps.create-organization.captchaTitle":"请点击下图中的 %s","apps.create-organization.captchaInvalided":"验证失败","apps.create-organization.captchaValided":"请继续","apps.create-organization.captchaTooFrequency":"图片验证码错误次数过多, 请明天再试","apps.create-organization.captchaTips":"请先选择图片验证码","apps.create-organization.captchaNotNeeded":"无需验证","apps.create-organization.captchaRefresh":"刷新验证码","apps.create-organization.captchaSetupErr":"获取验证码出错, 请刷新重试"}),n.setLocales("zh_tw",{"apps.create-organization.title":"創建組織","apps.create-organization.introContent":"協作之上，是更有意義的企業管理。Teambition 組織幫助你更好地管理團隊、成員，並擁有無限項目數量。可以免費使用14天。","apps.create-organization.tabTitleCreate":"創建企業","apps.create-organization.tabTitleContact":"聯絡方式","apps.create-organization.tabInfoCreateGuide":"現在創建企業，免費試用14天","apps.create-organization.tabInfoCreateGuideBusinessLink":"Teambition企業版專屬功能","apps.create-organization.tabInfoOrgNamePlaceholder":"企業名稱","apps.create-organization.tabContactPhoneGuide":"最後一步，確認聯繫方式，免費培訓團隊<br>如需幫助，可撥打400-060-5576","apps.create-organization.tabContactName":"聯系人","apps.create-organization.tabContactPhoneNumber":"手機號","apps.create-organization.tabContactRetryGetVerifyCode":"重新獲取","apps.create-organization.tabContactRetryGetVerifyCodeCD":"重新獲取（%s）","apps.create-organization.tabContactNotValidVerifyCode":"驗證碼錯誤","apps.create-organization.tabContactSendingVerifyCode":"正在發送中…","apps.create-organization.tabContactSMSVerifyCode":"簡訊驗證碼","apps.create-organization.tabContactPhoneBound":"該手機號已被綁定","apps.create-organization.tabContactNoSMSNeeded":"該號碼無需驗證","apps.create-organization.tabFooterDone":"完成","apps.create-organization.tabFooterStepNext":"下一步","apps.create-organization.tabFooterCreatingOrg":"企業創建中","apps.create-organization.tabFooterGetSMSVerify":"獲取簡訊驗證碼","apps.create-organization.countrycode":"國家號","apps.create-organization.country_chn":"中國","apps.create-organization.country_hk":"中國香港","apps.create-organization.country_tw":"臺灣","apps.create-organization.country_jp":"日本","apps.create-organization.country_us":"美國","apps.create-organization.country_other":"其他","apps.create-organization.captchaTitle":"請點擊下圖中的 %s","apps.create-organization.captchaInvalided":"驗證失敗","apps.create-organization.captchaValided":"驗證成功","apps.create-organization.captchaTooFrequency":"圖片驗證碼錯誤次數過多，請明天再試","apps.create-organization.captchaTips":"請先選擇圖片驗證碼","apps.create-organization.captchaNotNeeded":"無需驗證","apps.create-organization.captchaRefresh":"刷新驗證碼","apps.create-organization.captchaSetupErr":"獲取驗證碼出錯"}),n.setLocales("en",{"apps.create-organization.title":"Create Organization","apps.create-organization.introContent":"Teambition Business provides administrative control with higher level. You can create unlimited number of project, and have advanced features to manage access permission and project progress.","apps.create-organization.tabTitleCreate":"New organization","apps.create-organization.tabTitleContact":"Contact","apps.create-organization.tabInfoCreateGuide":"Type in your organization's name to start using exclusive enterprise features now.","apps.create-organization.tabInfoCreateGuideBusinessLink":"Teambition for Business","apps.create-organization.tabInfoOrgNamePlaceholder":"Organization name","apps.create-organization.tabContactPhoneGuide":"Leave us your contact to schedule a free Demo <br> Or, just call us +86-400-060-5576","apps.create-organization.tabContactName":"Contact","apps.create-organization.tabContactPhoneNumber":"Mobile Number","apps.create-organization.tabContactRetryGetVerifyCode":"Resend","apps.create-organization.tabContactRetryGetVerifyCodeCD":"Resend (%s)","apps.create-organization.tabContactNotValidVerifyCode":"Invalid verification code","apps.create-organization.tabContactSendingVerifyCode":"Sending...","apps.create-organization.tabContactSMSVerifyCode":"Verification Code","apps.create-organization.tabContactPhoneBound":"This number is already taken.","apps.create-organization.tabContactNoSMSNeeded":"Verification Passed","apps.create-organization.tabFooterDone":"Completed","apps.create-organization.tabFooterStepNext":"Next","apps.create-organization.tabFooterCreatingOrg":"Creating…","apps.create-organization.tabFooterGetSMSVerify":"Get Verification Code","apps.create-organization.countrycode":"Code","apps.create-organization.country_chn":"China","apps.create-organization.country_hk":"Hong Kong","apps.create-organization.country_tw":"Taiwan","apps.create-organization.country_jp":"Japan","apps.create-organization.country_us":"USA","apps.create-organization.country_other":"Other","apps.create-organization.captchaTitle":"Please click the %s icon below  ↓ .","apps.create-organization.captchaInvalided":"That's not it, please try again : )","apps.create-organization.captchaValided":"Please continue","apps.create-organization.captchaTooFrequency":"This IP has no attempts left, try again tomorrow.","apps.create-organization.captchaTips":"Select the correct picture","apps.create-organization.captchaNotNeeded":"Verified number","apps.create-organization.captchaRefresh":"Refresh","apps.create-organization.captchaSetupErr":"Failed to load captcha"}),n.setLocales("ja",{"apps.create-organization.title":"組織の新規作成","apps.create-organization.introContent":"コラボレーションより有意義なことは企業管理です。Teambitionの「組織」でプロジェクト数の限りがなくて、チームとメンバーを管理することが便利になります。14日以内に無料です。","apps.create-organization.tabTitleCreate":"创建企业","apps.create-organization.tabTitleContact":"联络方式","apps.create-organization.tabInfoCreateGuide":"输入企业名称，专享企业独有功能","apps.create-organization.tabInfoCreateGuideBusinessLink":"Teambition企业版","apps.create-organization.tabInfoOrgNamePlaceholder":"企业名称","apps.create-organization.tabContactPhoneGuide":"最后一步，确认联系方式，免费培训团队<br>如需帮助，可拨打 400-060-5576","apps.create-organization.tabContactName":"連絡先","apps.create-organization.tabContactPhoneNumber":"手机号","apps.create-organization.tabContactRetryGetVerifyCode":"重新获取","apps.create-organization.tabContactRetryGetVerifyCodeCD":"重新获取 (%s)","apps.create-organization.tabContactNotValidVerifyCode":"验证码错误","apps.create-organization.tabContactSendingVerifyCode":"正在发送中...","apps.create-organization.tabContactSMSVerifyCode":"短信验证码","apps.create-organization.tabContactPhoneBound":"この携帯番号は既に登録されています。","apps.create-organization.tabContactNoSMSNeeded":"该号码无需验证","apps.create-organization.tabFooterDone":"完成","apps.create-organization.tabFooterStepNext":"下一步","apps.create-organization.tabFooterCreatingOrg":"企业创建中","apps.create-organization.tabFooterGetSMSVerify":"获取短信验证码","apps.create-organization.countrycode":"国番号","apps.create-organization.country_chn":"中国","apps.create-organization.country_hk":"中国香港","apps.create-organization.country_tw":"台湾","apps.create-organization.country_jp":"日本","apps.create-organization.country_us":"美国","apps.create-organization.country_other":"其他","apps.create-organization.captchaTitle":"请点击下图中的 %s","apps.create-organization.captchaInvalided":"失敗を検証する","apps.create-organization.captchaValided":"検証する","apps.create-organization.captchaTooFrequency":"图片验证码错误次数过多, 请明天再试","apps.create-organization.captchaTips":"まず選択画像の確認コード","apps.create-organization.captchaNotNeeded":"无需验证","apps.create-organization.captchaRefresh":"更新の確認コード","apps.create-organization.captchaSetupErr":"検証番号を間違い"}),n.setLocales("ko",{"apps.create-organization.title":"단체 추가","apps.create-organization.introContent":"협동 그이상, 더 의미있는 기업관리입니다. Teambition은 단체, 멤버를 조직하는 데에 도울 수 있고 무제한 프로젝트 수량을 갖고 있으며 무료로 14일을 사용할 수 있습니다.","apps.create-organization.tabTitleCreate":"创建企业","apps.create-organization.tabTitleContact":"联络方式","apps.create-organization.tabInfoCreateGuide":"输入企业名称，专享企业独有功能","apps.create-organization.tabInfoCreateGuideBusinessLink":"Teambition企业版","apps.create-organization.tabInfoOrgNamePlaceholder":"企业名称","apps.create-organization.tabContactPhoneGuide":"最后一步，确认联系方式，免费培训团队<br>如需帮助，可拨打 400-060-5576","apps.create-organization.tabContactName":"연락인","apps.create-organization.tabContactPhoneNumber":"手机号","apps.create-organization.tabContactRetryGetVerifyCode":"重新获取","apps.create-organization.tabContactRetryGetVerifyCodeCD":"重新获取 (%s)","apps.create-organization.tabContactNotValidVerifyCode":"验证码错误","apps.create-organization.tabContactSendingVerifyCode":"正在发送中...","apps.create-organization.tabContactSMSVerifyCode":"短信验证码","apps.create-organization.tabContactPhoneBound":"해당 핸드폰 번호가 연동되어 있습니다","apps.create-organization.tabContactNoSMSNeeded":"该号码无需验证","apps.create-organization.tabFooterDone":"完成","apps.create-organization.tabFooterStepNext":"下一步","apps.create-organization.tabFooterCreatingOrg":"企业创建中","apps.create-organization.tabFooterGetSMSVerify":"获取短信验证码","apps.create-organization.countrycode":"국번","apps.create-organization.country_chn":"中国","apps.create-organization.country_hk":"中国香港","apps.create-organization.country_tw":"台湾","apps.create-organization.country_jp":"日本","apps.create-organization.country_us":"美国","apps.create-organization.country_other":"其他","apps.create-organization.captchaTitle":"다음 그림속의 %s를(을) 클릭하세요","apps.create-organization.captchaInvalided":"인증 실패","apps.create-organization.captchaValided":"인증 성공","apps.create-organization.captchaTooFrequency":"图片验证码错误次数过多, 请明天再试","apps.create-organization.captchaTips":"인증번호 그림을 먼저 선택하세요","apps.create-organization.captchaNotNeeded":"无需验证","apps.create-organization.captchaRefresh":"인증코드 리프레시","apps.create-organization.captchaSetupErr":"인증코드 틀렸습니다"}),t.exports=n},function(t,e,i){var n,r;n=i(557),r=i(560),t.exports=new r({__:n.__.bind(n)})},function(t,e,i){var n,r,o;!function(i,s){"use strict";"object"==typeof t&&t.exports?t.exports=s():(r=[],n=s,o="function"==typeof n?n.apply(e,r):n,!(void 0!==o&&(t.exports=o)))}("object"==typeof window?window:this,function(){"use strict";function t(t){this.locals=t||{},this.templates=e({},n,!0)}function e(t,e,n){t=t||{};for(var r in e)!i.call(e,r)||!n&&i.call(t,r)||(t[r]=e[r]);return t}var i=Object.prototype.hasOwnProperty,n={},r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"};t["import"]=function(t){return e(n,t,!0),this};var o=t.prototype;return o.copy=e,o.render=function(t,e){var i=this.get(t);if("function"!=typeof i)throw new Error(t+" is not found");return i.call(this,this.copy(e,this.locals),t)},o.get=function(t){return i.call(this.templates,t)?this.templates[t]:null},o.add=function(t,e,n){if(!n&&i.call(this.templates,t))throw new Error(t+" exist");return this.templates[t]=e,this},o.remove=function(t){return delete this.templates[t],this},o["import"]=function(t,e,n){"string"!=typeof t?(n=e,e=t,t="/"):t=t.replace(/\/?$/,"/");for(var r in e.templates)i.call(e.templates,r)&&this.add(this.resolve(t,r),e.get(r),n);return this},o.resolve=function(t,e){for(t=this.stringify(t),e=this.stringify(e).replace(/^([^\.\/])/,"/$1"),e=/^\//.test(e)&&!/\/$/.test(t)?e:t.replace(/[^\/]*\.?[^\/]*$/,"").replace(/\/?$/,"/")+e,e=e.replace(/\/\.?\/+/g,"/");/\/\.\.\//.test(e);)e=e.replace(/[^\/]*\/\.\.\//g,"");return e.replace(/^[\.\/]*/,"")},o.escape=function(t){return this.stringify(t).replace(/[&<>"'`]/g,function(t){return r[t]})},o.stringify=function(t){return null==t?"":String(t)},n["app-header"]=function(t,e){var i=this,n="";return n+='<header class="navbar navbar-default site-header">\n  <div class="container-fluid">\n    <div class="navbar-header">\n      <div class="nav-handler">\n        <a href="#" class="logo">',n+=i.stringify(t.__("title")),n+='</a>\n      </div>\n      <div class="pull-right nav-handler clearfix">\n        <a href="/" target="_blank" class="user-info">\n        <div style="background-image:url(',n+=i.escape(t.user.avatarUrl),n+=');" class="avatar img-circle img-24"></div><span class="user-name">',n+=i.escape(t.user.name),n+="</span>\n        </a>\n      </div>\n    </div>\n  </div>\n</header>\n",n.trim()},n["app-intro"]=function(t,e){var i=this,n="";return n+='<div class="card intro">\n  <div class="intro-content">\n    ',n+=i.stringify(t.__("introContent")),n+='\n  </div>\n  <a class="intro-remove">\n    <span class="icon icon-remove"></span>\n  </a>\n</div>\n',n.trim()},n.captcha=function(t,e){var i=this,n="";n+='<div class="visual-captcha">\n  <div class="captcha-title">\n    <span>',n+=i.escape(t.title),n+='</span>\n    <div class="captcha-refresh" title="',n+=i.stringify(t.__("captchaRefresh")),n+='">\n      <span class="icon icon-refresh"></span>\n    </div>\n  </div>\n  <div class="group-imgs" data-gta="{action: \'picture verification code\'}">\n    ';for(var r=0;r<t.num;r++)n+='\n      <div class="img-wrap">\n        <img class="captcha-image" src=',n+=i.escape(t.imagePrefix+r),n+=' data-value="',n+=i.escape(t.values[r]),n+='">\n      </div>\n    ';return n+="\n  </div>\n  ",t.notNeeded?(n+='\n    <div class="captcha-tips captcha-close">\n     <span class="icon icon-info"></span>\n      ',n+=i.stringify(t.__("captchaNotNeeded")),n+="\n    </div>\n  "):t.passed?(n+='\n    <div class="captcha-tips captcha-pass">\n      <span class="icon icon-circle-check"></span>\n      ',n+=i.stringify(t.__("captchaValided")),n+="\n    </div>\n  "):t.tooFreq?(n+='\n    <div class="captcha-tips captcha-error">\n      <span class="icon icon-circle-error"></span>\n      ',n+=i.stringify(t.__("captchaTooFrequency")),n+="\n    </div>\n  "):t.setupErr&&(n+='\n    <div class="captcha-tips captcha-error">\n      <span class="icon icon-circle-error"></span>\n      ',n+=i.stringify(t.__("captchaSetupErr")),n+="\n    </div>\n  "),n+="\n</div>\n",n.trim()},n.footer=function(t,e){var i=this,n="";return n+='<div class="handler-wrap">\n  <a class="btn btn-lg btn-primary main-command-handler ',n+=i.stringify(t.disabled?"disabled":""),n+='">\n     ',n+=i.stringify(t.stepName),n+="\n  </a>\n</div>\n",n.trim()},n.header=function(t,e){var i=this,n="";return n+='<h4 class="title">\n  ',t.currentTabIndex>0&&(n+='\n    <a class="icon icon-chevron-left switch-handler" data-action="prev"></a>\n  '),n+="\n  ",n+=i.stringify(t.headerTitle),n+="\n</h4>\n",n.trim()},n["loading-indicator"]=function(t,e){var i="";return i+='<div class="loading-indicator">\n  <span class="loader-dot"></span>\n  <span class="loader-dot"></span>\n  <span class="loader-dot"></span>\n</div>\n',i.trim()},n.main=function(t,e){var i="";return i+='<div class="org-creator">\n  <div class="tab-wrap">\n    <div class="tab-header">\n    </div>\n    <div class="tab-content">\n    </div>\n    <div class="tab-footer">\n    </div>\n  </div>\n</div>\n',i.trim()},n["tab-contact"]=function(t,e){var i=this,n="",r=function(n,r){return i.render(i.resolve(e,n),i.copy(r,t))};return n+='<div class="tab-pane tab-contact fade">\n  <div class="illustration-phone"></div>\n  <p class="tab-contact-intro">\n    ',n+=i.stringify(t.__("tabContactPhoneGuide")),n+='\n  </p>\n  <form class="form-horizontal">\n    <div class="form-group">\n      <input type="text" class="form-control require-validate" name="contactName"\n             value="',n+=i.stringify(t.name),n+='" placeholder="',n+=i.stringify(t.__("tabContactName")),n+='">\n    </div>\n\n    <div class="form-group group-phone">\n      <div class="phone-country form-control">\n        <div class="column-left">\n          <span class="dropdown selectcountry">\n            <a class="dropdown-toggle current-country setcountry zh" data-toggle="dropdown">\n               <span class="country"></span>\n               <span class="icon icon-chevron-down"></span>\n            </a>\n            <div class="dropdown-menu" role="menu" aria-labelledby="dLabel">\n              <ul class="dropdown-menu-fixed">\n                ',t.countries.forEach(function(t){n+='\n                  <li>\n                    <a class="setcountry ',n+=i.stringify(t.abbr),n+='"\n                       data-areacode="',n+=i.stringify(t.areaCode),n+='"\n                       data-abbr="',n+=i.stringify(t.abbr),n+='"\n                       data-reqphone="',n+=i.stringify(t.reqPhone),n+='">\n                      <span class="country"></span>\n                      ',n+=i.stringify(t.name),n+="\n                    </a>\n                  </li>\n                "}),n+='\n              </ul>\n            </div>\n          </span>\n          <span class="span-edit area-plus">+</span>\n          <input class="span-edit area-code cea-placeholder require-validate"\n                 type="text" name="countryCode" value="86" autocomplete="off"\n                 placeholder="',n+=i.stringify(t.__("countrycode")),n+='">\n        </div>\n        <div class="phone-number-wrap">\n          <input class="span-edit phone-number cea-placeholder require-validate"\n                 type="text" name="contactPhone" value="',n+=i.stringify(t.phoneForLogin),n+='"\n                 placeholder="',n+=i.stringify(t.__("tabContactPhoneNumber")),n+='">\n        </div>\n      </div>\n    </div>\n\n    <div class="form-group group-vi">\n      <div class="verify-image-wrap">\n        ',n+=i.stringify(r("loading-indicator")),n+='\n      </div>\n    </div>\n\n    <div class="form-group group-vc" data-gta="{action: \'enter sms code\'}">\n      <input type="text" class="form-control" name="verifyCode"\n             placeholder="',n+=i.stringify(t.__("tabContactSMSVerifyCode")),n+='">\n      <a class="send-vc-handler fade in">',n+=i.stringify(t.__("tabContactRetryGetVerifyCode")),n+="</a>\n    </div>\n  </form>\n</div>\n",n.trim()},n["tab-info"]=function(t,e){var i=this,n="";return n+='<div class="tab-pane tab-info fade">\n  <div class="illustration-enterprise"></div>\n  <p class="tab-info-intro">\n    ',n+=i.stringify(t.__("tabInfoCreateGuide")),n+="\n    ",t.businessUrl&&(n+='\n    <br>\n    <a href="',n+=i.stringify(t.businessUrl),n+='" target="_blank">\n      ',n+=i.stringify(t.__("tabInfoCreateGuideBusinessLink")),n+="\n    </a>\n    "),n+='\n  </p>\n  <form>\n    <div class="form-group">\n      <input type="text" name="orgName"\n             class="form-control require-validate"\n             data-gta="{action: \'enter organization name\'}"\n             placeholder="',n+=i.stringify(t.__("tabInfoOrgNamePlaceholder")),n+='">\n    </div>\n  </form>\n</div>\n',n.trim()},t})},function(t,e,i){var n,r,o,s,a,c=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};i(562),i(351),r=i(401),s=i(559),o=i(557),a=i(564),t.exports=n=function(){function t(t){this.options=t,this.orgData={},this.gta=this.options.gta,this.name="orgCreator",this.userMe=this.options.userMe,this.tabList=this.options.tabList,this.environment=this.options.environment,this.businessUrl=this.options.businessUrl,this.options.locale&&o.setLocale(this.options.locale),this.captcha={host:this.options.captchaHost,num:5,notNeeded:!1,passed:!1},this.countries=[{abbr:"zh",name:o.__("country_chn"),areaCode:"86",reqPhone:!0},{abbr:"hk",name:o.__("country_hk"),areaCode:"852",reqPhone:!1},{abbr:"tw",name:o.__("country_tw"),areaCode:"886",reqPhone:!1},{abbr:"jp",name:o.__("country_jp"),areaCode:"81",reqPhone:!1},{abbr:"us",name:o.__("country_us"),areaCode:"1",reqPhone:!1},{abbr:"other",name:o.__("country_other"),areaCode:"",reqPhone:!1}],this.renderMain(),this.bindEvents(),this.renderTabs(),this.switchTab(),this.resetCaptcha(),this.$forms.on("submit",function(t){return t.preventDefault()})}return t.prototype.renderMain=function(){return this.$wrap=this.options.$wrap,this.$main=$(s.render("main")),this.$tabHeader=$(".tab-header",this.$main),this.$tabContent=$(".tab-content",this.$main),this.$tabFooter=$(".tab-footer",this.$main),this.$wrap.append(this.$main),this},t.prototype.bindEvents=function(){return this.$main.on("click."+this.name,".switch-handler",function(t){return function(e){return t.onSwitchTab(e)}}(this)).on("click."+this.name,".handler-wrap",function(t){return function(e){return t.onMainCommand(e)}}(this)).on("click."+this.name,".send-vc-handler",function(t){return function(e){return t.onSendVerifyCode(e)}}(this)).on("click."+this.name,".captcha-image",function(t){return function(e){return t.validCaptcha(e,t.onValidCaptcha.bind(t))}}(this)).on("click."+this.name,".captcha-refresh",function(t){return function(e){return t.resetCaptcha(e)}}(this)).on("click."+this.name,"li > .setcountry",function(t){return function(e){return t.onSetCountry(e)}}(this)).on("input."+this.name,":input.require-validate",function(t){return function(e){return t.validateInputs(e)}}(this)).on("input."+this.name,".area-code",function(t){return function(e){return t.onSetAreaCode(e)}}(this)).on("input."+this.name,".phone-number",function(t){return function(e){return t.onSetPhoneNumer(e)}}(this)).on("submit."+this.name,function(t){return function(e){return t.onMainCommand(e)}}(this)).on("click."+this.name,".captcha-close, .captcha-pass",function(){return $(".main-command-handler").click()}),this},t.prototype.renderTabs=function(){var t;return t=$.extend({},{countries:this.countries},this.userMe),$.each(this.tabList,function(e){return function(i,n){return e.$tabContent.append(s.render("tab-"+n,t))}}(this)),this.$forms=$("form",this.$tabContent),this.$tabPanes=$(".tab-pane",this.$tabContent),this.$groupVerifyCode=$(".group-vc",this.$tabContent),this.$groupVerifyImage=$(".group-vi",this.$tabContent),this.$sendCodeHandler=$(".send-vc-handler",this.$tabContent),this.$verifyImageWrap=$(".verify-image-wrap",this.$tabContent),this.inputOrgName=$(':input[name="orgName"]',this.$tabContent),this.$inputVerifyCode=$(':input[name="verifyCode"]',this.$tabContent),this.$inputCountryCode=$(':input[name="countryCode"]',this.$tabContent),this.$inputPhone=$(':input[name="contactPhone"]',this.$tabContent),this.$currentCountry=$(".current-country",this.$tabContent),this.$phoneCountry=$(".phone-country",this.$tabContent),this.hasSendPhones=[],this},t.prototype.renderCaptcha=function(){var t;return this.$groupVerifyCode.is(":visible")?this.$groupVerifyImage.hide():!this.captcha.notNeeded&&this.$currentTab.fixTypoMode?this.$groupVerifyImage.show():this.$groupVerifyImage.hide(),this.captcha.host&&(t=$.extend({},this.captcha,{imagePrefix:this.captcha.host+"/image?uid="+this.captcha.uid+"&index=",title:o.__("captchaTitle",this.captcha.title)}),this.$verifyImageWrap.html(s.render("captcha",t))),this},t.prototype.validCaptcha=function(t,e){var i,n,s,a,c,l,p;return p=$(t.target).data("value"),a=this.captcha,n=a.host,s=a.num,l=a.uid,i=n+"/valid?num="+s+"&uid="+l+"&value="+p,c=$.get(i),c.done(function(t){return function(i){return(null!=i?i.valid:void 0)?(t.captcha.passed=!0,t.renderCaptcha(),e(!0)):(r.show({message:o.__("captchaInvalided"),status:"error"}),t.resetCaptcha(),e(!1))}}(this)),c.fail(function(t){return function(){return t.captcha.tooFreq=!0,t.renderCaptcha(),e(!1)}}(this)),this},t.prototype.resetCaptcha=function(){var t,e,i,n,r,s;return this.captcha.host?(n=this.captcha,e=n.host,i=n.num,s=n.uid,t=e+"/setup?num="+i+"&uid="+s+"&lang="+o.locale,r=$.get(t),r.done(function(t){return function(e){if(null!=e?e.values:void 0)return t.captcha.values=e.values,t.captcha.title=e.imageName,t.captcha.uid=e.uid,t.captcha.setupErr=!1,t.captcha.tooFreq=!1,t.renderCaptcha()}}(this)),r.fail(function(t){return function(){return t.captcha.setupErr=!0,t.renderCaptcha()}}(this))):this.$groupVerifyImage.remove(),this},t.prototype.renderHeader=function(t){var e;return e=s.render("header",{headerTitle:t,currentTabIndex:this.currentTabIndex}),this.$tabHeader.html(e),this},t.prototype.renderFooter=function(t,e){var i;return null==e&&(e=!1),i=s.render("footer",{stepName:t,disabled:e}),this.$tabFooter.html(i),this},t.prototype.switchTab=function(t){switch(this.currentTabIndex=t>=0?t:0,this.currentTab=this.tabList[this.currentTabIndex],this.$currentTab=this.$tabPanes.eq(this.currentTabIndex),this.currentTab){case"info":this.renderHeader(o.__("tabTitleCreate")),"build"!==this.environment&&this.options.enableSMSVerification?this.renderFooter(o.__("tabFooterStepNext")):this.renderFooter(o.__("tabFooterDone")),this.gta.event({action:"add organization step one"});break;case"contact":this.renderHeader(o.__("tabTitleContact")),this.onSetPhoneNumer(),this.captcha.passed||this.captcha.notNeeded?this.renderFooter(o.__("tabFooterDone")):(this.validatePhone()&&this.$groupVerifyImage.show(),this.renderFooter(o.__("tabFooterGetSMSVerify"),!0)),this.gta.event({action:"add organization step two"})}return this.switchTabTransition(),this},t.prototype.switchTabTransition=function(){return this.$tabContent.css("min-height",this.$tabPanes.filter(".active").outerHeight()||0).addClass("is-transition"),this.$currentTab.addClass("active"),setTimeout(function(t){return function(){return t.$currentTab.addClass("in")}}(this),0),this.$tabPanes.not(this.$currentTab).filter(".active").one("bsTransitionEnd",function(){return $(this).removeClass("active")}).emulateTransitionEnd(150).removeClass("in"),this.$tabContent.one("bsTransitionEnd",function(t){return function(){return t.$tabContent.removeClass("is-transition"),t.$tabContent.css("min-height","")}}(this)).emulateTransitionEnd(300).css("min-height",this.$currentTab.outerHeight()||0),clearTimeout(this.transitionTimer),this.transitionTimer=setTimeout(function(t){return function(){return t.$tabContent.removeClass("is-transition"),t.$tabContent.css("min-height","")}}(this),800),this},t.prototype.onMainCommand=function(t){if(null!=t&&t.preventDefault(),this.$currentTab.fixTypoMode=!0,"info"===this.currentTab){if(this.validateInputs())return"build"!==this.environment&&this.options.enableSMSVerification?this.switchTab(this.currentTabIndex+1):this.submitCreateOrg()}else if("contact"===this.currentTab&&this.captcha.notNeeded){if(this.validateInputs())return this.submitCreateOrg()}else if("contact"===this.currentTab&&$(".group-vi").is(":visible")){if(!this.captcha.passed)return;if(this.validateInputs())return $(".group-vi").hide(),$(".group-vc").show(),this.renderFooter(o.__("tabFooterDone")),this.sendVerifyCode()}else{if("contact"===this.currentTab&&$(".group-vc").is(":visible"))return this.validateVerifyCode(this.submitCreateOrg.bind(this));if("contact"===this.currentTab)return this.validateInputs()}},t.prototype.onSwitchTab=function(t,e){var i;switch(i=$(null!=t?t.currentTarget:void 0),e=e||(null!=i?i.data("action"):void 0)){case"prev":this.switchTab(this.currentTabIndex-1);break;case"next":this.switchTab(this.currentTabIndex+1)}return this},t.prototype.validateInputs=function(){var t,e,i;return i=this,t=!0,e=$(".require-validate",this.$currentTab),$.each(e,function(e,n){var r,o,s;switch(r=$(n),o=r.attr("name"),s=r.val().trim(),o){case"orgName":if(s.length<2||s.length>40){if(t=!1,i.$currentTab.fixTypoMode)return r.addClass("validate-error")}else if(i.orgData.name=s,i.$currentTab.fixTypoMode)return r.removeClass("validate-error");break;case"contactName":return i.orgData.contactName=s;case"countryCode":if(i.validateCountryCode()){if(i.orgData.countryCode=s,i.$currentTab.fixTypoMode)return i.$phoneCountry.removeClass("validate-error")}else if(t=!1,i.$currentTab.fixTypoMode)return i.$phoneCountry.addClass("validate-error");break;case"contactPhone":if((""+s).length>=11&&(i.$currentTab.fixTypoMode=!0,"86"===i.orgData.countryCode&&i.$groupVerifyCode.is(":hidden")&&!i.captcha.notNeeded&&i.$groupVerifyImage.show()),i.validatePhone()){if(i.orgData.contactPhone=s,i.$currentTab.fixTypoMode)return i.$phoneCountry.removeClass("validate-error")}else if(t=!1,i.$currentTab.fixTypoMode)return i.$phoneCountry.addClass("validate-error");break;case"verifyCode":return i.$errorVcodeBlock.empty()}}),t},t.prototype.onValidCaptcha=function(t){if(this.renderFooter(o.__("tabFooterGetSMSVerify"),!t),this.validatePhone())return this.onMainCommand()},t.prototype.onSetCountry=function(t){var e,i,n,r,s,a,c;return e=$(t.currentTarget),r=e.data("areacode"),i=e.data("abbr"),c=e.data("reqphone"),s=this.$currentCountry.attr("class").split(" "),a=s[s.length-1],this.$inputCountryCode.val(r),this.$currentCountry.removeClass(a).addClass(i),n=this.$inputCountryCode.val(),this.$inputCountryCode.css("width",this.getAreaCodeWidth(n)),this.captcha.notNeeded="86"!==n,this.captcha.notNeeded?this.renderFooter(o.__("tabFooterDone")):$(".group-vi").is(":visible")?this.renderFooter(o.__("tabFooterGetSMSVerify"),!this.captcha.passed):this.renderFooter(o.__("tabFooterDone")),this.renderCaptcha(),this.onSetPhoneNumer(),this.$currentTab.fixTypoMode&&this.validateInputs(),this},t.prototype.onSetAreaCode=function(t){var e,i,n,r,s,a,c,l,p,u;for(e=$(t.currentTarget),i="other",u=!1,n=e.val(),r=this.$currentCountry.attr("class").split(" "),s=r[r.length-1],this.$inputCountryCode.css("width",this.getAreaCodeWidth(n)),p=this.countries,c=0,l=p.length;c<l;c++)a=p[c],a.areaCode===n&&(i=a.abbr,u=a.reqPhone);return this.$currentCountry.removeClass(s).addClass(i),this.captcha.notNeeded="86"!==n,this.captcha.notNeeded?this.renderFooter(o.__("tabFooterDone")):$(".group-vi").is(":visible")?this.renderFooter(o.__("tabFooterGetSMSVerify"),!this.captcha.passed):this.renderFooter(o.__("tabFooterDone")),this.renderCaptcha(),this.onSetPhoneNumer(),this.$currentTab.fixTypoMode&&this.validateInputs(),this},t.prototype.onSetPhoneNumer=function(){var t,e;return e=this.$inputPhone.val().replace(/\s+/g,""),t=this.$inputCountryCode.val().trim(),86===parseInt(t)&&e&&e===this.userMe.phoneForLogin?(this.captcha.notNeeded=!0,$(".group-vi").is(":visible")?(this.renderCaptcha(),this.renderFooter(o.__("tabFooterDone"))):this.updateVerifyCodeHandler("is-bound")):86!==parseInt(t)?this.updateVerifyCodeHandler("cant-send"):this.captcha.notNeeded?(this.captcha.notNeeded=!1,this.renderCaptcha(),$(".group-vi").is(":visible")?this.renderFooter(o.__("tabFooterGetSMSVerify"),!this.captcha.passed):this.updateVerifyCodeHandler("can-send")):(this.updateVerifyCodeHandler("can-send"),
$(".group-vi").is(":visible")?this.renderFooter(o.__("tabFooterGetSMSVerify"),!this.captcha.passed):void 0)},t.prototype.sendVerifyCode=function(){var t,e,i;return e=this.$inputPhone.val().replace(/\s+/g,""),t=this.$inputCountryCode.val().trim(),i=t+"-"+e,this.updateVerifyCodeHandler("is-sending"),this.options.apiGetVerifyCode(i,this.captcha.uid).then(function(t){return function(){return t.updateVerifyCodeHandler("is-cd"),t.hasSendPhones.push(e)}}(this))["catch"](function(t){return function(e){return t.updateVerifyCodeHandler("can-send")}}(this)),this.gta.event({action:"send sms code"}),this},t.prototype.onSendVerifyCode=function(t){var e;if(e=this.$sendCodeHandler.hasClass("can-send"),e&&this.validateInputs())return this.sendVerifyCode()},t.prototype.updateVerifyCodeHandler=function(t){var e,i,n,r,s,a;if(i=this.$sendCodeHandler.hasClass("is-cd"),e=["is-retry","is-focus"],n=this.$sendCodeHandler.hasClass("in")?"in":"",s=c.call(e,t)>=0?"can-send "+t:t,s+=" "+n,!i)switch(this.$sendCodeHandler.attr("class","send-vc-handler fade "+s),t){case"is-cd":r=60,a=setInterval(function(t){return function(){if(t.$sendCodeHandler.text(o.__("tabContactRetryGetVerifyCodeCD",--r)),0===r)return clearInterval(a),t.$sendCodeHandler.removeClass("is-cd"),t.updateVerifyCodeHandler("can-send"),t.onSetPhoneNumer()}}(this),1e3);break;case"is-bound":this.$sendCodeHandler.text(o.__("tabContactPhoneBound"));break;case"is-retry":this.$sendCodeHandler.text(o.__("tabContactRetryGetVerifyCode"));break;case"is-focus":case"can-send":this.$sendCodeHandler.text(o.__("tabContactRetryGetVerifyCode"));break;case"cant-send":this.$sendCodeHandler.text(o.__("tabContactNoSMSNeeded"));break;case"is-sending":this.$sendCodeHandler.text(o.__("tabContactSendingVerifyCode"))}return this},t.prototype.validateVerifyCode=function(t){var e,i,n,s;return n=this.$inputVerifyCode.val().trim(),i=this.$inputPhone.val().replace(/\s+/g,""),e=this.$inputCountryCode.val().trim(),s=e+"-"+i,this.options.apiPostVerifyCode(s,{vcode:n,uid:this.captcha.uid}).then(function(){return t()})["catch"](function(){return r.show({message:o.__("tabContactNotValidVerifyCode"),status:"error"})}),this},t.prototype.getAreaCodeWidth=function(t){if(t.length)return 8*t.length+11;switch(o.locale){case"en":return 47;case"ko":return 34;default:return 70}},t.prototype.validateCountryCode=function(){var t,e;return e=this.$inputPhone.val().replace(/\s+/g,""),t=this.$inputCountryCode.val().trim(),a.isCountryCode(t,e)},t.prototype.validatePhone=function(){var t,e;return e=this.$inputPhone.val().replace(/\s+/g,""),t=parseInt(this.$inputCountryCode.val()),this.validateCountryCode()&&a.isPhone(e,t)},t.prototype.submitCreateOrg=function(){var t,e,i,n;return e=$(":input",this.$currentTab),t=$(".btn, .check-box, .selectcountry a",this.$main),i=$(".main-command-handler",this.$tabFooter),e.prop("readonly",!0),this.$phoneCountry.attr("readonly",!0),t.addClass("disabled"),i.text(o.__("tabFooterCreatingOrg")),setTimeout(function(){return i.addClass("disabled is-submitting")},50),n=$.extend({},this.orgData),this.options.apiPostCreateOrg(n).then(function(e){return function(i){return setTimeout(function(){var n;return t.removeClass("disabled is-submitting"),e.org=$.extend({},i),"function"==typeof(n=e.options).cbLastButtonAction?n.cbLastButtonAction(e.org):void 0},1e3)}}(this))["catch"](function(n){return function(){return t.removeClass("disabled is-submitting"),setTimeout(function(){return e.prop("readonly",!1),n.$phoneCountry.attr("readonly",!1),i.text(o.__("orgCreate"))},1e3)}}(this)),this.gta.event({action:"added content",type:"organization",control:"new organization button"}),this},t}()},function(t,e){},,function(t,e,i){var n;n=i(351),t.exports={getFormsData:function(t){var e,i,n,r;for(i={},r=t.serializeArray(),e=0;e<r.length;)n=r[e],i[n.name]=n.value.trim(),e++;return i},random:function(t,e){return null===e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},isCountryCode:function(t,e){var i;return i=/^\d{1,7}$/.test(t),e?86===parseInt(t)?i&&/^\d{11}$/.test(e):i&&/^\d{5,15}$/.test(e):i},isPhone:function(t,e){return 86===parseInt(e)?/^\d{11}$/.test(t):/^\d{5,15}$/.test(t)},isEmail:function(t){return/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/.test(t)},uniqArray:function(t){return $.grep(t,function(e,i){return $.inArray(e,t)===i})}}},,,,,,,,,,,,,,,function(t,e,i){var n,r,o,s,a=[].slice;o=i(351),s=i(580),n=$("html").attr("lang")||"en",r="apps.create-organization.",t.exports={locale:n,setLocale:function(t){return this.locale=t},__:function(){var t,e;return e=arguments[0],t=2<=arguments.length?a.call(arguments,1):[],t.unshift(this.locale),t.unshift(r+e),s.point.apply(s,t)}}},function(t,e,i){var n=i(455);n.setLocales("zh",{"apps.create-organization.title":"创建组织","apps.create-organization.introContent":"协作之上，是更有意义的企业管理。Teambition 组织帮助你更好地管理部门、成员，并拥有无限项目数量。可以免费使用14天。","apps.create-organization.tabInfo":"完善企业信息","apps.create-organization.tabInfoOrgName":"企业名称","apps.create-organization.tabInfoOrgNamePlace":"名称","apps.create-organization.tabInfoOrgDesc":"描述","apps.create-organization.tabInfoOrgDescPlace":"一句话描述","apps.create-organization.tabInfoOrgIndustry":"行业","apps.create-organization.tabInfoOrgIndustryPlace":"请选择所属行业","apps.create-organization.tabInfoOrgIndustryFood":"餐饮食品","apps.create-organization.tabInfoOrgIndustryTelecommunication":"电信","apps.create-organization.tabInfoOrgIndustryLaw":"法律实践","apps.create-organization.tabInfoOrgIndustryRealEstate":"房地产","apps.create-organization.tabInfoOrgIndustryApparel":"服装","apps.create-organization.tabInfoOrgIndustryManagement":"管理咨询","apps.create-organization.tabInfoOrgIndustryAdvertising":"广告","apps.create-organization.tabInfoOrgIndustryInternationalTrade":"国际贸易","apps.create-organization.tabInfoOrgIndustryInternet":"互联网","apps.create-organization.tabInfoOrgIndustryChemistry":"化学","apps.create-organization.tabInfoOrgIndustryEventServices":"会展服务","apps.create-organization.tabInfoOrgIndustryManufacture":"制造业","apps.create-organization.tabInfoOrgIndustryFurnitures":"家具建材","apps.create-organization.tabInfoOrgIndustryFinancial":"金融服务","apps.create-organization.tabInfoOrgIndustryEnergy":"能源","apps.create-organization.tabInfoOrgIndustryAutomotive":"汽车","apps.create-organization.tabInfoOrgIndustryBiotechnology":"生物技术","apps.create-organization.tabInfoOrgIndustryDesign":"设计","apps.create-organization.tabInfoOrgIndustryLuxury":"奢侈品","apps.create-organization.tabInfoOrgIndustryInformation":"信息技术与服务","apps.create-organization.tabInfoOrgIndustryHealthCare":"医疗健康","apps.create-organization.tabInfoOrgIndustryEntertainment":"文化","apps.create-organization.tabInfoOrgIndustryTransportation":"运输","apps.create-organization.tabInfoOrgIndustryCoaching":"职业培训","apps.create-organization.tabContact":"填写联系人信息","apps.create-organization.tabContactName":"联系人","apps.create-organization.tabContactPhone":"手机","apps.create-organization.tabContactPhoneBound":"该号码已通过验证","apps.create-organization.tabContactVerifyCodeSend":"发送验证码","apps.create-organization.tabContactVerifyCodeSending":"正在发送中","apps.create-organization.tabContactVerifyCodeRetry":"重新发送","apps.create-organization.tabContactVerifyCodeRetryCD":"重新发送 (%s)","apps.create-organization.tabContactVerifyCodeError":"验证码错误","apps.create-organization.tabContactService":"顾问服务","apps.create-organization.tabContactServiceTip":"请为我提供顾问服务（免费）","apps.create-organization.tabMembers":"添加企业成员","apps.create-organization.tabMembersBlankTip":"新成员的邮箱","apps.create-organization.tabMembersErrorEmail":"邮箱格式错误","apps.create-organization.tabMembersErrorRepeat":"该邮箱已是企业成员","apps.create-organization.tabMembersOrgInfoTips":"当前企业成员上限为%s人，","apps.create-organization.tabMembersOrgInfoTips2":"还可免费试用14天。您可以随时升级您的方案。","apps.create-organization.tabMembersPriceLink":"查看所有方案","apps.create-organization.tabMembersUpperLimitTip":"成员数超过上限","apps.create-organization.tabMembersRemove":"移除成员","apps.create-organization.tabMembersImportEmail":"批量输入邮箱","apps.create-organization.tabMembersImportEmailTip":"将邮箱粘帖至输入框即可添加，不同邮箱间用换行分割","apps.create-organization.tabMembersImportWorked":"导入合作过的成员","apps.create-organization.tabMembersImportWorkedNoContent":"没有找到合作过的成员","apps.create-organization.membersCountAddExceed":"已经超出 %s 人","apps.create-organization.membersCountAddRemain":"还可以添加 %s 人","apps.create-organization.membersCountUpperLimit":"企业成员达到上限","apps.create-organization.membersCountUpdatePlan":"升级方案","apps.create-organization.comma":"，","apps.create-organization.modalEnter":"确定","apps.create-organization.orgCreate":"创建企业","apps.create-organization.orgCreating":"创建企业中","apps.create-organization.stepPrev":"上一步","apps.create-organization.stepNext":"下一步","apps.create-organization.stepLast":"完成，并进入企业","apps.create-organization.countrycode":"国际区号","apps.create-organization.china":"中国","apps.create-organization.hongkong":"中国香港","apps.create-organization.taiwan":"台湾","apps.create-organization.japan":"日本","apps.create-organization.unitedstates":"美国","apps.create-organization.other":"其他","apps.create-organization.tabContactVerifyCode":"验证码","apps.create-organization.tabContactVerifyImage":"图片验证码","apps.create-organization.captchaTitle":"请点击下图中的 %s","apps.create-organization.captchaInvalided":"验证失败","apps.create-organization.captchaValided":"验证成功","apps.create-organization.captchaValidedFreq":"图片验证码错误次数过多, 请明天再试","apps.create-organization.captchaTips":"请先选择图片验证码","apps.create-organization.captchaOff":"无需验证","apps.create-organization.captchaRefresh":"刷新验证码","apps.create-organization.captchaSetupErr":"获取验证码出错, 请刷新重试"}),n.setLocales("zh_tw",{"apps.create-organization.title":"創建組織","apps.create-organization.introContent":"協作之上，是更有意義的企業管理。Teambition 組織幫助你更好地管理團隊、成員，並擁有無限項目數量。可以免費使用14天。","apps.create-organization.tabInfo":"完善企業信息","apps.create-organization.tabInfoOrgName":"企業名稱","apps.create-organization.tabInfoOrgNamePlace":"名稱","apps.create-organization.tabInfoOrgDesc":"描述","apps.create-organization.tabInfoOrgDescPlace":"一句話描述","apps.create-organization.tabInfoOrgIndustry":"行業","apps.create-organization.tabInfoOrgIndustryPlace":"請選擇所屬行業","apps.create-organization.tabInfoOrgIndustryFood":"餐飲食品","apps.create-organization.tabInfoOrgIndustryTelecommunication":"電信","apps.create-organization.tabInfoOrgIndustryLaw":"法律實踐","apps.create-organization.tabInfoOrgIndustryRealEstate":"房地產","apps.create-organization.tabInfoOrgIndustryApparel":"服裝","apps.create-organization.tabInfoOrgIndustryManagement":"管理咨詢","apps.create-organization.tabInfoOrgIndustryAdvertising":"廣告","apps.create-organization.tabInfoOrgIndustryInternationalTrade":"國際貿易","apps.create-organization.tabInfoOrgIndustryInternet":"互聯網","apps.create-organization.tabInfoOrgIndustryChemistry":"化學","apps.create-organization.tabInfoOrgIndustryEventServices":"會展服務","apps.create-organization.tabInfoOrgIndustryManufacture":"制造業","apps.create-organization.tabInfoOrgIndustryFurnitures":"家具建材","apps.create-organization.tabInfoOrgIndustryFinancial":"金融服務","apps.create-organization.tabInfoOrgIndustryEnergy":"能源","apps.create-organization.tabInfoOrgIndustryAutomotive":"汽車","apps.create-organization.tabInfoOrgIndustryBiotechnology":"生物技術","apps.create-organization.tabInfoOrgIndustryDesign":"設計","apps.create-organization.tabInfoOrgIndustryLuxury":"奢侈品","apps.create-organization.tabInfoOrgIndustryInformation":"信息技術與服務","apps.create-organization.tabInfoOrgIndustryHealthCare":"醫療健康","apps.create-organization.tabInfoOrgIndustryEntertainment":"文化","apps.create-organization.tabInfoOrgIndustryTransportation":"運輸","apps.create-organization.tabInfoOrgIndustryCoaching":"職業培訓","apps.create-organization.tabContact":"填寫聯系人信息","apps.create-organization.tabContactName":"聯系人","apps.create-organization.tabContactPhone":"手機","apps.create-organization.tabContactPhoneBound":"該手機號已被綁定","apps.create-organization.tabContactVerifyCodeSend":"發送驗證碼","apps.create-organization.tabContactVerifyCodeSending":"正在發送中","apps.create-organization.tabContactVerifyCodeRetry":"重新發送","apps.create-organization.tabContactVerifyCodeRetryCD":"重新發送 (%s)","apps.create-organization.tabContactVerifyCodeError":"驗證碼錯誤","apps.create-organization.tabContactService":"顧問服務","apps.create-organization.tabContactServiceTip":"請為我提供顧問服務（免費）","apps.create-organization.tabMembers":"添加企業成員","apps.create-organization.tabMembersBlankTip":"新成員的郵箱","apps.create-organization.tabMembersErrorEmail":"郵箱格式錯誤","apps.create-organization.tabMembersErrorRepeat":"該郵箱已是企業成員","apps.create-organization.tabMembersOrgInfoTips":"當前企業成員上限為%s人，","apps.create-organization.tabMembersOrgInfoTips2":"還可免費試用14天。您可以隨時升級您的方案。","apps.create-organization.tabMembersPriceLink":"查看所有方案","apps.create-organization.tabMembersUpperLimitTip":"成員數超過上限","apps.create-organization.tabMembersRemove":"移除成員","apps.create-organization.tabMembersImportEmail":"批量輸入郵箱","apps.create-organization.tabMembersImportEmailTip":"將郵箱粘帖至輸入框即可添加，不同郵箱間用換行分割","apps.create-organization.tabMembersImportWorked":"導入合作過的成員","apps.create-organization.tabMembersImportWorkedNoContent":"沒有找到合作過的成員","apps.create-organization.membersCountAddExceed":"已經超出 %s 人","apps.create-organization.membersCountAddRemain":"還可以添加 %s 人","apps.create-organization.membersCountUpperLimit":"企業成員達到上限","apps.create-organization.membersCountUpdatePlan":"升級方案","apps.create-organization.comma":"，","apps.create-organization.modalEnter":"確定","apps.create-organization.orgCreate":"創建企業","apps.create-organization.orgCreating":"創建企業中","apps.create-organization.stepPrev":"上一步","apps.create-organization.stepNext":"下一步","apps.create-organization.stepLast":"完成，並進入企業","apps.create-organization.countrycode":"國家號","apps.create-organization.china":"中國","apps.create-organization.hongkong":"中國香港","apps.create-organization.taiwan":"台灣","apps.create-organization.japan":"日本","apps.create-organization.unitedstates":"美國","apps.create-organization.other":"其他","apps.create-organization.tabContactVerifyCode":"驗證碼","apps.create-organization.tabContactVerifyImage":"圖片驗證碼","apps.create-organization.captchaTitle":"請點擊下圖中的 %s","apps.create-organization.captchaInvalided":"驗證失敗","apps.create-organization.captchaValided":"驗證成功","apps.create-organization.captchaValidedFreq":"圖片驗證碼錯誤次數過多, 請明天再試","apps.create-organization.captchaTips":"請先選擇圖片驗證碼","apps.create-organization.captchaOff":"無需驗證","apps.create-organization.captchaRefresh":"刷新驗證碼","apps.create-organization.captchaSetupErr":"獲取驗證碼出錯"}),n.setLocales("en",{"apps.create-organization.title":"Create Organization","apps.create-organization.introContent":"Teambition Business provides administrative control with higher level. You can create unlimited number of project, and have advanced features to manage access permission and project progress.","apps.create-organization.tabInfo":"Set up your organization","apps.create-organization.tabInfoOrgName":"Organization name","apps.create-organization.tabInfoOrgNamePlace":"Name","apps.create-organization.tabInfoOrgDesc":"Description","apps.create-organization.tabInfoOrgDescPlace":"Describe your organization","apps.create-organization.tabInfoOrgIndustry":"Industry","apps.create-organization.tabInfoOrgIndustryPlace":"Please select a industry","apps.create-organization.tabInfoOrgIndustryFood":"Restaurant and Food","apps.create-organization.tabInfoOrgIndustryTelecommunication":"Telecommunication","apps.create-organization.tabInfoOrgIndustryLaw":"law Firms","apps.create-organization.tabInfoOrgIndustryRealEstate":"Real Estate","apps.create-organization.tabInfoOrgIndustryApparel":"Apparel & Fashion","apps.create-organization.tabInfoOrgIndustryManagement":"Management Consulting","apps.create-organization.tabInfoOrgIndustryAdvertising":"Marketing & Advertising","apps.create-organization.tabInfoOrgIndustryInternationalTrade":"International Trade","apps.create-organization.tabInfoOrgIndustryInternet":"Internet","apps.create-organization.tabInfoOrgIndustryChemistry":"Chemistry","apps.create-organization.tabInfoOrgIndustryEventServices":"Event Services","apps.create-organization.tabInfoOrgIndustryManufacture":"Manufacture","apps.create-organization.tabInfoOrgIndustryFurnitures":"Furnitures & Building Materials","apps.create-organization.tabInfoOrgIndustryFinancial":"Financial Services","apps.create-organization.tabInfoOrgIndustryEnergy":"Energy","apps.create-organization.tabInfoOrgIndustryAutomotive":"Automotive","apps.create-organization.tabInfoOrgIndustryBiotechnology":"Biotechnology","apps.create-organization.tabInfoOrgIndustryDesign":"Design","apps.create-organization.tabInfoOrgIndustryLuxury":"Luxury","apps.create-organization.tabInfoOrgIndustryInformation":"Information Technology","apps.create-organization.tabInfoOrgIndustryHealthCare":"Health Care","apps.create-organization.tabInfoOrgIndustryEntertainment":"Entertainment","apps.create-organization.tabInfoOrgIndustryTransportation":"Transportation","apps.create-organization.tabInfoOrgIndustryCoaching":"Professional Training & Coaching","apps.create-organization.tabContact":"Contact information","apps.create-organization.tabContactName":"Contact","apps.create-organization.tabContactPhone":"Phone","apps.create-organization.tabContactPhoneBound":"This number is already taken.","apps.create-organization.tabContactVerifyCodeSend":"Send verification Code","apps.create-organization.tabContactVerifyCodeSending":"Sending","apps.create-organization.tabContactVerifyCodeRetry":"Resend","apps.create-organization.tabContactVerifyCodeRetryCD":"Resend (%s)","apps.create-organization.tabContactVerifyCodeError":"Invalid verification code","apps.create-organization.tabContactService":"Consulting","apps.create-organization.tabContactServiceTip":"Please get in touch, I need some help","apps.create-organization.tabMembers":"Invite your team","apps.create-organization.tabMembersBlankTip":"Email address","apps.create-organization.tabMembersErrorEmail":"Invalid email address","apps.create-organization.tabMembersErrorRepeat":"Already in organization","apps.create-organization.tabMembersOrgInfoTips":"Current contains %s licenses.","apps.create-organization.tabMembersOrgInfoTips2":"14 days' trial remaining. You can upgrade your plan anytime as you wish.","apps.create-organization.tabMembersPriceLink":"View all plans","apps.create-organization.tabMembersUpperLimitTip":"The number of members exceeds the limit.","apps.create-organization.tabMembersRemove":"Remove from Organization","apps.create-organization.tabMembersImportEmail":"Invite via email","apps.create-organization.tabMembersImportEmailTip":"Tap here the email addresses of the people you would like to join, separated by a comma. You can invite a maximum of 20 people in one batch.","apps.create-organization.tabMembersImportWorked":"Invite people I worked with","apps.create-organization.tabMembersImportWorkedNoContent":"There’s no personal project member.","apps.create-organization.membersCountAddExceed":"%s license(s) short","apps.create-organization.membersCountAddRemain":"%s license(s) left","apps.create-organization.membersCountUpperLimit":"Reached license limit","apps.create-organization.membersCountUpdatePlan":"upgrade plan","apps.create-organization.comma":", ","apps.create-organization.modalEnter":"Confirm","apps.create-organization.orgCreate":"Next","apps.create-organization.orgCreating":"Creating…","apps.create-organization.stepPrev":"Previous","apps.create-organization.stepNext":"Next","apps.create-organization.stepLast":"Done","apps.create-organization.countrycode":"Code","apps.create-organization.china":"China","apps.create-organization.hongkong":"Hong kong","apps.create-organization.taiwan":"Taiwan","apps.create-organization.japan":"Japan","apps.create-organization.unitedstates":"United States","apps.create-organization.other":"Other","apps.create-organization.tabContactVerifyCode":"Verification Code","apps.create-organization.tabContactVerifyImage":"Captcha","apps.create-organization.captchaTitle":"Please click the %s icon below  ↓ .","apps.create-organization.captchaInvalided":"That's not it, please try again : )","apps.create-organization.captchaValided":"Please continue","apps.create-organization.captchaValidedFreq":"Failed too many times, try again tomorrow","apps.create-organization.captchaTips":"Select the correct picture","apps.create-organization.captchaOff":"Verification is not necessary","apps.create-organization.captchaRefresh":"Refresh","apps.create-organization.captchaSetupErr":"Failed to load captcha"}),n.setLocales("ja",{"apps.create-organization.title":"組織の新規作成","apps.create-organization.introContent":"コラボレーションより有意義なことは企業管理です。Teambitionの「組織」でプロジェクト数の限りがなくて、チームとメンバーを管理することが便利になります。14日以内に無料です。","apps.create-organization.tabInfo":"組織情報を記入","apps.create-organization.tabInfoOrgName":"組織名","apps.create-organization.tabInfoOrgNamePlace":"組織名","apps.create-organization.tabInfoOrgDesc":"概要","apps.create-organization.tabInfoOrgDescPlace":"組織についての概要","apps.create-organization.tabInfoOrgIndustry":"業界","apps.create-organization.tabInfoOrgIndustryPlace":"所属業種を選択してください","apps.create-organization.tabInfoOrgIndustryFood":"飲食食品","apps.create-organization.tabInfoOrgIndustryTelecommunication":"電信","apps.create-organization.tabInfoOrgIndustryLaw":"法律の実踐","apps.create-organization.tabInfoOrgIndustryRealEstate":"不動産","apps.create-organization.tabInfoOrgIndustryApparel":"服装","apps.create-organization.tabInfoOrgIndustryManagement":"管理のコンサルティング","apps.create-organization.tabInfoOrgIndustryAdvertising":"広告","apps.create-organization.tabInfoOrgIndustryInternationalTrade":"国際貿易","apps.create-organization.tabInfoOrgIndustryInternet":"インターネット","apps.create-organization.tabInfoOrgIndustryChemistry":"化学","apps.create-organization.tabInfoOrgIndustryEventServices":"コンベンションサービス","apps.create-organization.tabInfoOrgIndustryManufacture":"製造業","apps.create-organization.tabInfoOrgIndustryFurnitures":"家具建材","apps.create-organization.tabInfoOrgIndustryFinancial":"金融サービス","apps.create-organization.tabInfoOrgIndustryEnergy":"エネルギー","apps.create-organization.tabInfoOrgIndustryAutomotive":"自動車","apps.create-organization.tabInfoOrgIndustryBiotechnology":"生物技術","apps.create-organization.tabInfoOrgIndustryDesign":"デザイン","apps.create-organization.tabInfoOrgIndustryLuxury":"ぜいたく品","apps.create-organization.tabInfoOrgIndustryInformation":"情報技術とサービス","apps.create-organization.tabInfoOrgIndustryHealthCare":"医療と健康","apps.create-organization.tabInfoOrgIndustryEntertainment":"文化","apps.create-organization.tabInfoOrgIndustryTransportation":"輸送","apps.create-organization.tabInfoOrgIndustryCoaching":"職業訓練","apps.create-organization.tabContact":"連絡先の情報を記入する","apps.create-organization.tabContactName":"連絡先","apps.create-organization.tabContactPhone":"携帯","apps.create-organization.tabContactPhoneBound":"この携帯番号は既に登録されています。","apps.create-organization.tabContactVerifyCodeSend":"認証コードを送信する","apps.create-organization.tabContactVerifyCodeSending":"送信中","apps.create-organization.tabContactVerifyCodeRetry":"再送信","apps.create-organization.tabContactVerifyCodeRetryCD":"(%s)を再送信する","apps.create-organization.tabContactVerifyCodeError":"認証コードが間違っています","apps.create-organization.tabContactService":"コンサルサービス","apps.create-organization.tabContactServiceTip":"無料のコンサルタントサービスを希望します","apps.create-organization.tabMembers":"組織にメンバーを追加する","apps.create-organization.tabMembersBlankTip":"新しいメンバーのメール","apps.create-organization.tabMembersErrorEmail":"メールフォーマットが誤っています","apps.create-organization.tabMembersErrorRepeat":"このメールは既に登録されています","apps.create-organization.tabMembersOrgInfoTips":"現在の14日間無料お試しプランは、%sユーザーライセンスまで登録可能です。プランをアップグレードして下さい。","apps.create-organization.tabMembersOrgInfoTips2":"まだ無料試用14日。あなたのことはいつでもあなたの案をアップグレード。","apps.create-organization.tabMembersPriceLink":"全てのプランを表示","apps.create-organization.tabMembersUpperLimitTip":"メンバー上限を越えました","apps.create-organization.tabMembersRemove":"組織から削除","apps.create-organization.tabMembersImportEmail":"メールの一括インポート","apps.create-organization.tabMembersImportEmailTip":"メールアドレスは改行もしくはカンマで区切ることができます","apps.create-organization.tabMembersImportWorked":"個人プロジェクトのメンバーをインポートする","apps.create-organization.tabMembersImportWorkedNoContent":"個人プロジェクトに登録したメンバーはいません","apps.create-organization.membersCountAddExceed":"を超えている%s人","apps.create-organization.membersCountAddRemain":"また添加%s人","apps.create-organization.membersCountUpperLimit":"組織のメンバーを上限に達する","apps.create-organization.membersCountUpdatePlan":"アップグレードプログラム","apps.create-organization.comma":"、","apps.create-organization.modalEnter":"はい","apps.create-organization.orgCreate":"組織を作成","apps.create-organization.orgCreating":"組織作成中","apps.create-organization.stepPrev":"前へ","apps.create-organization.stepNext":"次へ","apps.create-organization.stepLast":"完了しました","apps.create-organization.countrycode":"国番号","apps.create-organization.china":"中国","apps.create-organization.hongkong":"香港","apps.create-organization.taiwan":"台湾","apps.create-organization.japan":"日本","apps.create-organization.unitedstates":"アメリカ","apps.create-organization.other":"その他","apps.create-organization.tabContactVerifyCode":"認証コード","apps.create-organization.tabContactVerifyImage":"画像の確認コード","apps.create-organization.captchaTitle":"请点击下图中的 %s","apps.create-organization.captchaInvalided":"失敗を検証する","apps.create-organization.captchaValided":"検証する","apps.create-organization.captchaValidedFreq":"画像の確認コードエラー回数が多いので、明日また","apps.create-organization.captchaTips":"まず選択画像の確認コード","apps.create-organization.captchaOff":"検証する必要はない","apps.create-organization.captchaRefresh":"更新の確認コード","apps.create-organization.captchaSetupErr":"検証番号を間違い"}),n.setLocales("ko",{"apps.create-organization.title":"단체 추가","apps.create-organization.introContent":"협동 그이상, 더 의미있는 기업관리입니다. Teambition은 단체, 멤버를 조직하는 데에 도울 수 있고 무제한 프로젝트 수량을 갖고 있으며 무료로 14일을 사용할 수 있습니다.","apps.create-organization.tabInfo":"기업 정보를 완성해 주세요","apps.create-organization.tabInfoOrgName":"기업 명칭","apps.create-organization.tabInfoOrgNamePlace":"명칭","apps.create-organization.tabInfoOrgDesc":"설명","apps.create-organization.tabInfoOrgDescPlace":"한마디로 설명","apps.create-organization.tabInfoOrgIndustry":"업계","apps.create-organization.tabInfoOrgIndustryPlace":"업계를 선택하세요","apps.create-organization.tabInfoOrgIndustryFood":"외식식품","apps.create-organization.tabInfoOrgIndustryTelecommunication":"전자통신","apps.create-organization.tabInfoOrgIndustryLaw":"법률 실천","apps.create-organization.tabInfoOrgIndustryRealEstate":"부동산","apps.create-organization.tabInfoOrgIndustryApparel":"복장","apps.create-organization.tabInfoOrgIndustryManagement":"관리 상담","apps.create-organization.tabInfoOrgIndustryAdvertising":"광고","apps.create-organization.tabInfoOrgIndustryInternationalTrade":"국제무역","apps.create-organization.tabInfoOrgIndustryInternet":"인터넷","apps.create-organization.tabInfoOrgIndustryChemistry":"화학","apps.create-organization.tabInfoOrgIndustryEventServices":"전시 서비스","apps.create-organization.tabInfoOrgIndustryManufacture":"제조업","apps.create-organization.tabInfoOrgIndustryFurnitures":"가구 건축 재료","apps.create-organization.tabInfoOrgIndustryFinancial":"금용 서비스","apps.create-organization.tabInfoOrgIndustryEnergy":"에너지","apps.create-organization.tabInfoOrgIndustryAutomotive":"자동차","apps.create-organization.tabInfoOrgIndustryBiotechnology":"생물기술","apps.create-organization.tabInfoOrgIndustryDesign":"디자인","apps.create-organization.tabInfoOrgIndustryLuxury":"사치품","apps.create-organization.tabInfoOrgIndustryInformation":"정보기술과 서비스","apps.create-organization.tabInfoOrgIndustryHealthCare":"의료 건강","apps.create-organization.tabInfoOrgIndustryEntertainment":"문화","apps.create-organization.tabInfoOrgIndustryTransportation":"수송업","apps.create-organization.tabInfoOrgIndustryCoaching":"직업 트레이닝","apps.create-organization.tabContact":"연락인 정보 입력하기","apps.create-organization.tabContactName":"연락인","apps.create-organization.tabContactPhone":"핸드폰","apps.create-organization.tabContactPhoneBound":"해당 핸드폰 번호가 연동되어 있습니다","apps.create-organization.tabContactVerifyCodeSend":"인증코드 보내기","apps.create-organization.tabContactVerifyCodeSending":"보내는중입니다","apps.create-organization.tabContactVerifyCodeRetry":"다시 보내기","apps.create-organization.tabContactVerifyCodeRetryCD":"다시 (%s)를(을) 보내기","apps.create-organization.tabContactVerifyCodeError":"인증코드 잘못되었습니다","apps.create-organization.tabContactService":"고문 서비스","apps.create-organization.tabContactServiceTip":"고문 서비스(무료)를 제공해 주세요","apps.create-organization.tabMembers":"기업 멤버 추가","apps.create-organization.tabMembersBlankTip":"새 멤버 메일","apps.create-organization.tabMembersErrorEmail":"메일 격식 잘못되었습니다","apps.create-organization.tabMembersErrorRepeat":"해당 메일은 이미 기업 멤버입니다","apps.create-organization.tabMembersOrgInfoTips":"현재 기업성원 제한이 %s 명입니다","apps.create-organization.tabMembersOrgInfoTips2":"무료체험은 14일이 남았습니다. 언제든 코스를 업데이트할 수 있습니다.","apps.create-organization.tabMembersPriceLink":"모든 선택 보기","apps.create-organization.tabMembersUpperLimitTip":"멤버 수량 제한을 초과합니다","apps.create-organization.tabMembersRemove":"멤버 제거","apps.create-organization.tabMembersImportEmail":"메일 대량 입력","apps.create-organization.tabMembersImportEmailTip":"메일주소를 입력란에 붙이면 됩니다. 메일 추가할 때 줄을 바꿔 입력해 주세요","apps.create-organization.tabMembersImportWorked":"협동한 적 있는 멤버 가져오기","apps.create-organization.tabMembersImportWorkedNoContent":"협동한 적 있는 멤버가 없습니다","apps.create-organization.membersCountAddExceed":"%s 사람이 초과했습니다","apps.create-organization.membersCountAddRemain":"%s명을 더 추가할 수 있습니다","apps.create-organization.membersCountUpperLimit":"제한된 멤버 수량을 초과했습니다","apps.create-organization.membersCountUpdatePlan":"제한된 멤버 수량에 도달했습니다","apps.create-organization.comma":"，","apps.create-organization.modalEnter":"확인","apps.create-organization.orgCreate":"기업 만들기","apps.create-organization.orgCreating":"기업 만드는중","apps.create-organization.stepPrev":"위로","apps.create-organization.stepNext":"다음","apps.create-organization.stepLast":"완성했습니다. 기업에 들어가기","apps.create-organization.countrycode":"국번","apps.create-organization.china":"중국","apps.create-organization.hongkong":"중국 홍콩","apps.create-organization.taiwan":"대만","apps.create-organization.japan":"일본","apps.create-organization.unitedstates":"미국","apps.create-organization.other":"기타","apps.create-organization.tabContactVerifyCode":"인증코드","apps.create-organization.tabContactVerifyImage":"그림 인증코드","apps.create-organization.captchaTitle":"다음 그림속의 %s를(을) 클릭하세요","apps.create-organization.captchaInvalided":"인증 실패","apps.create-organization.captchaValided":"인증 성공","apps.create-organization.captchaValidedFreq":"그림인증 실패회수가 많은 이유로 내일 시도해 보세요.","apps.create-organization.captchaTips":"인증번호 그림을 먼저 선택하세요","apps.create-organization.captchaOff":"인증 불필요","apps.create-organization.captchaRefresh":"인증코드 리프레시","apps.create-organization.captchaSetupErr":"인증코드 틀렸습니다"}),t.exports=n},function(t,e,i){var n,r;n=i(579),r=i(582),t.exports=new r({__:n.__.bind(n)})},function(t,e,i){var n,r,o;!function(i,s){"use strict";"object"==typeof t&&t.exports?t.exports=s():(r=[],n=s,o="function"==typeof n?n.apply(e,r):n,!(void 0!==o&&(t.exports=o)))}("object"==typeof window?window:this,function(){"use strict";function t(t){this.locals=t||{},this.templates=e({},n,!0)}function e(t,e,n){t=t||{};for(var r in e)!i.call(e,r)||!n&&i.call(t,r)||(t[r]=e[r]);return t}var i=Object.prototype.hasOwnProperty,n={},r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"};t["import"]=function(t){return e(n,t,!0),this};var o=t.prototype;return o.copy=e,o.render=function(t,e){var i=this.get(t);if("function"!=typeof i)throw new Error(t+" is not found");return i.call(this,this.copy(e,this.locals),t)},o.get=function(t){return i.call(this.templates,t)?this.templates[t]:null},o.add=function(t,e,n){if(!n&&i.call(this.templates,t))throw new Error(t+" exist");return this.templates[t]=e,this},o.remove=function(t){return delete this.templates[t],this},o["import"]=function(t,e,n){"string"!=typeof t?(n=e,e=t,t="/"):t=t.replace(/\/?$/,"/");for(var r in e.templates)i.call(e.templates,r)&&this.add(this.resolve(t,r),e.get(r),n);return this},o.resolve=function(t,e){
for(t=this.stringify(t),e=this.stringify(e).replace(/^([^\.\/])/,"/$1"),e=/^\//.test(e)&&!/\/$/.test(t)?e:t.replace(/[^\/]*\.?[^\/]*$/,"").replace(/\/?$/,"/")+e,e=e.replace(/\/\.?\/+/g,"/");/\/\.\.\//.test(e);)e=e.replace(/[^\/]*\/\.\.\//g,"");return e.replace(/^[\.\/]*/,"")},o.escape=function(t){return this.stringify(t).replace(/[&<>"'`]/g,function(t){return r[t]})},o.stringify=function(t){return null==t?"":String(t)},n["app-header"]=function(t,e){var i=this,n="";return n+='<header class="navbar navbar-default site-header">\n  <div class="container-fluid">\n    <div class="navbar-header">\n      <div class="nav-handler">\n        <a href="#" class="logo">',n+=i.stringify(t.__("title")),n+='</a>\n      </div>\n      <div class="pull-right nav-handler clearfix">\n        <a href="/" target="_blank" class="user-info">\n        <div style="background-image:url(',n+=i.escape(t.user.avatarUrl),n+=');" class="avatar img-circle img-24"></div><span class="user-name">',n+=i.escape(t.user.name),n+="</span>\n        </a>\n      </div>\n    </div>\n  </div>\n</header>\n",n.trim()},n["app-intro"]=function(t,e){var i=this,n="";return n+='<div class="card intro">\n  <div class="intro-content">\n    ',n+=i.stringify(t.__("introContent")),n+='\n  </div>\n  <a class="intro-remove">\n    <span class="icon icon-remove"></span>\n  </a>\n</div>\n',n.trim()},n.captcha=function(t,e){var i=this,n="";n+='<div class="visual-captcha">\n  <div class="captcha-title">\n    <span>',n+=i.escape(t.title),n+='</span>\n    <div class="captcha-refresh" title="',n+=i.stringify(t.__("captchaRefresh")),n+='">\n      <span class="icon icon-refresh"></span>\n    </div>\n  </div>\n  <div class="group-imgs">\n    ';for(var r=0;r<t.num;r++)n+='\n      <div class="img-wrap">\n        <img class="captcha-image" src=',n+=i.escape(t.imagePrefix+r),n+=' data-value="',n+=i.escape(t.values[r]),n+='">\n      </div>\n    ';return n+="\n  </div>\n  ",t.close?(n+='\n    <div class="captcha-tips captcha-close">\n     <span class="icon icon-info"></span>\n      ',n+=i.stringify(t.__("captchaOff")),n+="\n    </div>\n  "):t.pass?(n+='\n    <div class="captcha-tips captcha-pass">\n      <span class="icon icon-circle-check"></span>\n      ',n+=i.stringify(t.__("captchaValided")),n+="\n    </div>\n  "):t.validFreq?(n+='\n    <div class="captcha-tips captcha-error">\n      <span class="icon icon-circle-error"></span>\n      ',n+=i.stringify(t.__("captchaValidedFreq")),n+="\n    </div>\n  "):t.setupFreq&&(n+='\n    <div class="captcha-tips captcha-error">\n      <span class="icon icon-circle-error"></span>\n      ',n+=i.stringify(t.__("captchaSetupErr")),n+="\n    </div>\n  "),n+="\n</div>\n",n.trim()},n.footer=function(t,e){var i=this,n="";return n+='<div class="handler-wrap">\n  ',0!==t.currentTabIndex&&t.currentTabIndex<t.tabLength-1&&(n+='\n  <a class="btn btn-lg btn-primary btn-ghost switch-handler" data-action="prev"\n  data-gta="event" data-label="create org prev step">\n    ',n+=i.stringify(t.__("stepPrev")),n+="\n  </a>\n  "),n+="\n  ",t.currentTabIndex<t.tabLength-1?(n+='\n  <a class="btn btn-lg btn-primary switch-handler" data-action="next" data-gta="event" \n  data-label="',n+=i.escape(0===t.currentTabIndex?"create org step one":"create org step two"),n+='">\n    ',n+=i.stringify(t.currentTab==t.createOrgTab?t.__("orgCreate"):t.__("stepNext")),n+="\n  </a>\n  "):(n+='\n  <a class="btn btn-lg btn-primary switch-handler" data-action="last"\n  data-gta="event" data-label="create org step three">\n    ',n+=i.stringify(t.__("stepLast")),n+="\n  </a>\n  "),n+="\n</div>\n",n.trim()},n.header=function(t,e){var i=this,n="";n+='<h4 class="title">\n  ',n+=i.stringify(t.headerTitle),n+='\n</h4>\n<div class="steps">\n  <ul class="step-list">\n    ';for(var r=0;r<t.tabList.length;r++)n+='\n    <li class="step-item',r===t.currentTabIndex&&(n+=" is-current"),n+='">\n      <span class="step-num">',n+=i.stringify(r+1),n+="</span>\n    </li>\n    ";return n+="\n  </ul>\n</div>",n.trim()},n["loading-indicator"]=function(t,e){var i="";return i+='<div class="loading-indicator">\n  <span class="loader-dot"></span>\n  <span class="loader-dot"></span>\n  <span class="loader-dot"></span>\n</div>\n',i.trim()},n.main=function(t,e){var i="";return i+='<div class="create-org">\n  <div class="tab-wrap">\n    <div class="tab-header">\n    </div>\n    <div class="tab-content">\n    </div>\n    <div class="tab-footer">\n    </div>\n  </div>\n</div>\n',i.trim()},n["member-worked"]=function(t,e){var i=this,n="";return n+='<div class="list-group-item member is-worked">\n  <div class="check-box checkbox-handler" data-email="',n+=i.stringify(t.email),n+='">\n    <span class="icon icon-tick"></span>\n  </div>\n  <div class="avatar size24" style="background-image: url(',n+=i.stringify(t.avatarUrl),n+=')"></div>\n  <div class="member-info">\n    <span class="info-name">',n+=i.stringify(t.name),n+='</span>\n    <span class="info-email">(',n+=i.stringify(t.email),n+=")</span>\n  </div>\n</div>\n",n.trim()},n.member=function(t,e){var i=this,n="";return t._id?(n+='\n<div class="list-group-item member ',n+=i.stringify(t.isNew?"is-new":"is-worked"),n+='" data-id="',n+=i.stringify(t._id),n+='" data-email="',n+=i.stringify(t.email),n+='">\n  <div class="avatar size24" ',t.isNew||(n+='style="background-image: url(',n+=i.stringify(t.avatarUrl),n+=')"'),n+='></div>\n  <div class="member-info">\n    ',t.isNew?(n+='\n    <span class="info-email">',n+=i.stringify(t.email),n+="</span>\n    "):(n+='\n    <span class="info-name">',n+=i.stringify(t.name),n+='</span>\n    <span class="info-email">(',n+=i.stringify(t.email),n+=")</span>\n    "),n+="\n  </div>\n  ",t._id!==t._userMeId&&(n+='\n  <div class="handlerset">\n    <a class="btn btn-ghost btn-danger remove-handler">',n+=i.stringify(t.__("tabMembersRemove")),n+="</a>\n  </div>\n  "),n+="\n</div>\n"):(n+='\n<div class="list-group-item is-blank">\n  <div class="avatar size24"></div>\n  <div class="member-info">\n    <div class="info-desc" data-error-email="',n+=i.stringify(t.__("tabMembersErrorEmail")),n+='" data-error-repeat="',n+=i.stringify(t.__("tabMembersErrorRepeat")),n+='">\n      <input class="email-input" placeholder="',n+=i.stringify(t.__("tabMembersBlankTip")),n+='" />\n    </div>\n  </div>\n</div>\n'),n+="\n",n.trim()},n["members-count"]=function(t,e){var i=this,n="";return t.membersLimit!=-1&&(n+="\n  ",t.membersLimit>=t.membersTotal&&t.membersLimit!=t.membersCurrent?(n+="\n    <span>",n+=i.stringify(t.__("membersCountAddRemain",t.gap)),n+="</span>\n  "):(n+="\n    <span>\n      ",t.membersLimit==t.membersTotal?(n+="\n        ",n+=i.stringify(t.__("membersCountUpperLimit")),n+=i.stringify(t.__("comma")),n+="\n      "):(n+="\n        ",n+=i.stringify(t.__("membersCountAddExceed",t.gap)),n+=i.stringify(t.__("comma")),n+="\n      "),n+='\n      <a href="https://pay.teambition.com/confirm_order?_organizationId=',n+=i.stringify(t._id),n+='" target="_blank" class="blue link-add-handler">\n        ',n+=i.stringify(t.__("membersCountUpdatePlan")),n+="\n      </a>\n    </span>\n  "),n+="\n"),n+="\n",n.trim()},n["modal-email"]=function(t,e){var i=this,n="";return n+='<div class="members-email">\n  <form>\n    <textarea class="form-control" rows="13" placeholder="',n+=i.stringify(t.__("tabMembersImportEmailTip")),n+='"></textarea>\n  </form>\n</div>\n',n.trim()},n["modal-worked"]=function(t,e){var i=this,n="",r=function(n,r){return i.render(i.resolve(e,n),i.copy(r,t))};return n+='<div class="view-wrap">\n  <div class="list-group members-list members-worked">\n    ',n+=i.stringify(r("loading-indicator")),n+="\n  </div>\n</div>",n.trim()},n.modal=function(t,e){var i=this,n="";return n+='<div class="modal modal-grey create-org fade" tabindex="-1">\n  <div class="modal-dialog modal-small default-margin">\n    <div class="modal-content">\n      <div class="modal-header">\n        <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a>\n        <h4 class="modal-title">',n+=i.stringify(t.textTitle),n+='</h4>\n      </div>\n      <div class="modal-body">\n      </div>\n      <div class="modal-footer">\n        <span class="members-count"></span>\n        <button type="button" class="btn btn-lg btn-primary" data-action="submit">',n+=i.stringify(t.textSubmit),n+="</button>\n      </div>\n    </div>\n  </div>\n</div>\n",n.trim()},n["no-content"]=function(t,e){var i=this,n="";return n+='<div class="no-content">\n  <span class="icon icon-circle-warning"></span>\n  <p class="tip-text">',n+=i.stringify(t.tipText),n+="</p>\n</div>\n",n.trim()},n["tab-contact"]=function(t,e){var i=this,n="",r=function(n,r){return i.render(i.resolve(e,n),i.copy(r,t))};return n+='<div class="tab-pane tab-contact fade">\n  <form class="form-horizontal">\n    <div class="form-group">\n      <label class="control-label col-sm-2">',n+=i.stringify(t.__("tabContactName")),n+='</label>\n      <div class="col-sm-10">\n        <input type="text" class="form-control is-required" name="contactName" value="',n+=i.stringify(t.name),n+='" placeholder="',n+=i.stringify(t.__("tabContactName")),n+='">\n      </div>\n    </div>\n    <div class="form-group group-vi">\n      <label class="control-label col-sm-2">',n+=i.stringify(t.__("tabContactVerifyImage")),n+='</label>\n      <div class="col-sm-10">\n        <div class="verify-image-wrap">\n          ',n+=i.stringify(r("loading-indicator")),n+='\n        </div>\n      </div>\n    </div>\n    <div class="form-group group-phone">\n      <label class="control-label col-sm-2">',n+=i.stringify(t.__("tabContactPhone")),n+='</label>\n      <div class="col-sm-10">\n        <div class="phone-country form-control">\n          <div class="column-left">\n            <span class="dropdown selectcountry">\n              <a class="dropdown-toggle current-country setcountry zh" data-toggle="dropdown"><span class="country"></span><span class="icon icon-chevron-down"></span></a>\n              <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">\n                ',t.countries.forEach(function(t){n+='\n                  <li><a class="setcountry ',n+=i.stringify(t.abbr),n+='" data-areacode="',n+=i.stringify(t.areaCode),n+='" data-abbr="',n+=i.stringify(t.abbr),n+='" data-reqphone="',n+=i.stringify(t.reqPhone),n+='"><span class="country"></span>',n+=i.stringify(t.name),n+="</a></li>\n                "}),n+='\n              </ul>\n            </span>\n            <span class="span-edit area-plus">+</span>\n            <input type="text" class="span-edit area-code cea-placeholder is-required" name="countryCode" placeholder="',n+=i.stringify(t.__("countrycode")),n+='" value="86" autocomplete="off" />\n          </div>\n          <div class="phone-number-wrap">\n            <input type="text" class="span-edit phone-number cea-placeholder is-required" name="contactPhone" value="',n+=i.stringify(t.phoneForLogin),n+='" placeholder="',n+=i.stringify(t.__("tabContactPhone")),n+='"></input>\n          </div>\n          <a class="send-vc-handler fade in ',n+=t.phoneForLogin?"can-send":"cant-send",n+='">',n+=i.stringify(t.__("tabContactVerifyCodeSend")),n+='</a>\n        </div>\n      </div>\n    </div>\n    <div class="form-group group-vc">\n      <label class="control-label col-sm-2">',n+=i.stringify(t.__("tabContactVerifyCode")),n+='</label>\n      <div class="col-sm-10">\n        <input type="text" class="form-control" name="verifyCode" placeholder="',n+=i.stringify(t.__("tabContactVerifyCode")),n+='">\n        <span class="error-handler"></span>\n      </div>\n    </div>\n    <div class="form-group with-checkbox">\n      <label class="control-label col-sm-2">',n+=i.stringify(t.__("tabContactService")),n+='</label>\n      <div class="col-sm-10">\n        <div class="check-box checkbox-handler" name="provideDemo" value="false">\n          <span class="icon icon-tick"></span>\n        </div>\n        <div class="checkbox-trigger" data-for="provideDemo">\n          ',n+=i.stringify(t.__("tabContactServiceTip")),n+="\n        </div>\n      </div>\n    </div>\n  </form>\n</div>\n",n.trim()},n["tab-info"]=function(t,e){var i=this,n="";return n+='<div class="tab-pane tab-info fade">\n  <form class="form-horizontal">\n    <div class="form-group">\n      <label class="control-label col-sm-2">',n+=i.stringify(t.__("tabInfoOrgName")),n+='</label>\n      <div class="col-sm-10">\n        <input type="text" class="form-control is-required" name="name" placeholder="',n+=i.stringify(t.__("tabInfoOrgNamePlace")),n+='">\n      </div>\n    </div>\n    <div class="form-group">\n      <label class="control-label col-sm-2">',n+=i.stringify(t.__("tabInfoOrgDesc")),n+='</label>\n      <div class="col-sm-10">\n        <input type="text" class="form-control" name="description" placeholder="',n+=i.stringify(t.__("tabInfoOrgDescPlace")),n+='">\n      </div>\n    </div>\n    <div class="form-group">\n      <label class="control-label col-sm-2">',n+=i.stringify(t.__("tabInfoOrgIndustry")),n+='</label>\n      <div class="col-sm-10">\n        <label class="form-control-select">\n          <select class="form-control is-required" name="industry">\n          <option value="" checked> ',n+=i.stringify(t.__("tabInfoOrgIndustryPlace")),n+=' </option>\n          <option value="Restaurant and Food"> ',n+=i.stringify(t.__("tabInfoOrgIndustryFood")),n+=' </option>\n          <option value="Telecommunication"> ',n+=i.stringify(t.__("tabInfoOrgIndustryTelecommunication")),n+=' </option>\n          <option value="law Firms"> ',n+=i.stringify(t.__("tabInfoOrgIndustryLaw")),n+=' </option>\n          <option value="Real Estate"> ',n+=i.stringify(t.__("tabInfoOrgIndustryRealEstate")),n+=' </option>\n          <option value="Apparel & Fashion"> ',n+=i.stringify(t.__("tabInfoOrgIndustryApparel")),n+=' </option>\n          <option value="Management Consulting"> ',n+=i.stringify(t.__("tabInfoOrgIndustryManagement")),n+=' </option>\n          <option value="Marketing & Advertising"> ',n+=i.stringify(t.__("tabInfoOrgIndustryAdvertising")),n+=' </option>\n          <option value="International Trade"> ',n+=i.stringify(t.__("tabInfoOrgIndustryInternationalTrade")),n+=' </option>\n          <option value="Internet"> ',n+=i.stringify(t.__("tabInfoOrgIndustryInternet")),n+=' </option>\n          <option value="Chemistry"> ',n+=i.stringify(t.__("tabInfoOrgIndustryChemistry")),n+=' </option>\n          <option value="Event Services"> ',n+=i.stringify(t.__("tabInfoOrgIndustryEventServices")),n+=' </option>\n          <option value="Manufacture"> ',n+=i.stringify(t.__("tabInfoOrgIndustryManufacture")),n+=' </option>\n          <option value="Furnitures & Building Materials"> ',n+=i.stringify(t.__("tabInfoOrgIndustryFurnitures")),n+=' </option>\n          <option value="Financial Services"> ',n+=i.stringify(t.__("tabInfoOrgIndustryFinancial")),n+=' </option>\n          <option value="Energy"> ',n+=i.stringify(t.__("tabInfoOrgIndustryEnergy")),n+=' </option>\n          <option value="Automotive"> ',n+=i.stringify(t.__("tabInfoOrgIndustryAutomotive")),n+=' </option>\n          <option value="Biotechnology"> ',n+=i.stringify(t.__("tabInfoOrgIndustryBiotechnology")),n+=' </option>\n          <option value="Design"> ',n+=i.stringify(t.__("tabInfoOrgIndustryDesign")),n+=' </option>\n          <option value="Luxury"> ',n+=i.stringify(t.__("tabInfoOrgIndustryTelecommunication")),n+=' </option>\n          <option value="Information Technology"> ',n+=i.stringify(t.__("tabInfoOrgIndustryInformation")),n+=' </option>\n          <option value="Health Care"> ',n+=i.stringify(t.__("tabInfoOrgIndustryHealthCare")),n+=' </option>\n          <option value="Entertainment"> ',n+=i.stringify(t.__("tabInfoOrgIndustryEntertainment")),n+=' </option>\n          <option value="Transportation"> ',n+=i.stringify(t.__("tabInfoOrgIndustryTransportation")),n+=' </option>\n          <option value="Professional Training & Coaching"> ',n+=i.stringify(t.__("tabInfoOrgIndustryCoaching")),n+=" </option>\n          </select>\n        </label>\n      </div>\n    </div>\n  </form>\n</div>\n",n.trim()},n["tab-members"]=function(t,e){var i=this,n="",r=function(n,r){return i.render(i.resolve(e,n),i.copy(r,t))};return n+='<div class="tab-pane tab-members fade">\n  <p class="org-type-tips">',t.membersLimit!=-1&&(n+=i.stringify(t.__("tabMembersOrgInfoTips",t.membersLimit))),n+=i.stringify(t.__("tabMembersOrgInfoTips2")),n+='<a href="https://www.teambition.com/prices" target="_blank" class="blue">',n+=i.stringify(t.__("tabMembersPriceLink")),n+='</a></p>\n  <div class="row import-handlerset">\n    <div class="col-sm-6">\n      <a class="btn btn-lg btn-ghost btn-primary import-email-handler">\n        <span class="icon icon-envelope"></span>\n        ',n+=i.stringify(t.__("tabMembersImportEmail")),n+='\n      </a>\n    </div>\n    <div class="col-sm-6">\n      <a class="btn btn-lg btn-ghost btn-primary import-worked-handler">\n        <span class="icon icon-users"></span>\n        ',n+=i.stringify(t.__("tabMembersImportWorked")),n+='\n      </a>\n    </div>\n  </div>\n  <div class="list-group members-list imported-members">\n    ',n+=i.stringify(r("loading-indicator")),n+="\n  </div>\n</div>\n",n.trim()},t})},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){return function(){return t.apply(e,arguments)}},p=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};i(584),i(351),r=i(401),a=i(581),s=i(586),o=i(579),c=i(588),t.exports=n=function(){function t(t){this.importMembersFormWorked=l(this.importMembersFormWorked,this),this.importMembersFormEmail=l(this.importMembersFormEmail,this),this.options=t,this.name="createOrg",this.userMe=this.options.userMe,this.tabList=this.options.tabList,this.createOrgTab=this.options.createOrgTab,this.membersLimit=this.options.membersLimit,this.defaultTabIndex=0,this.org=this.options.org,this.options.locale&&o.setLocale(this.options.locale),this.captcha={host:this.options.captchaHost,num:5,close:!1,pass:!1},this.countries=[{abbr:"zh",name:o.__("china"),areaCode:"86",reqPhone:!0},{abbr:"hk",name:o.__("hongkong"),areaCode:"852",reqPhone:!1},{abbr:"tw",name:o.__("taiwan"),areaCode:"886",reqPhone:!1},{abbr:"jp",name:o.__("japan"),areaCode:"81",reqPhone:!1},{abbr:"us",name:o.__("unitedstates"),areaCode:"1",reqPhone:!1},{abbr:"other",name:o.__("other"),areaCode:"",reqPhone:!1}],this.renderMain().bindEvents().renderTabs().switchTab().resetCaptcha().validateInputs()}return t.prototype.bindEvents=function(){return this.$el.on("click."+this.name,".switch-handler",function(t){return function(e){return t.onSwitchTab(e)}}(this)).on("click."+this.name,".checkbox-handler",function(t){return function(e){return t.onCheckboxToggle(e)}}(this)).on("click."+this.name,".checkbox-trigger",function(t){return function(e){return t.onCheckboxTrigger(e)}}(this)).on("click."+this.name,".send-vc-handler",function(t){return function(e){return t.onSendVerifyCode(e)}}(this)).on("click."+this.name,".import-email-handler",function(t){return function(e){return t.onOpenImportEmail(e)}}(this)).on("click."+this.name,".import-worked-handler",function(t){return function(e){return t.onOpenImportWorked(e)}}(this)).on("click."+this.name,".remove-handler",function(t){return function(e){return t.onRemoveMember(e)}}(this)).on("click."+this.name,".captcha-image",function(t){return function(e){return t.validCaptcha(e)}}(this)).on("click."+this.name,".captcha-refresh",function(t){return function(e){return t.resetCaptcha(e)}}(this)).on("click."+this.name,"li > .setcountry",function(t){return function(e){return t.onSetCountry(e)}}(this)).on("keydown."+this.name+" focusout."+this.name,":input.email-input",function(t){return function(e){return t.onAddMemberInput(e)}}(this)).on("input."+this.name,":input.email-input",function(t){return function(e){return t.onValidateEmailInput(e)}}(this)).on("input."+this.name,":input.is-required",function(t){return function(e){return t.validateInputs(e)}}(this)).on("input."+this.name,".area-code",function(t){return function(e){return t.onSetAreaCode(e)}}(this)),this},t.prototype.bindEmailEvents=function(){return this.$viewEmail.on("keyup."+this.name+" change."+this.name,"textarea",function(t){return function(e){return t.validateMultiEmail(e)}}(this)),this},t.prototype.bindEmailWorked=function(){return this.$viewWorked.on("click."+this.name,".checkbox-handler",function(t){return function(e){return t.onWorkedCheckboxToggle(e)}}(this)).on("click."+this.name,".member.is-worked",function(t){return function(e){return t.onWorkedMemberToggle(e)}}(this)),this},t.prototype.renderMain=function(){return this.$wrap=this.options.$wrap,this.$el=$(a.render("main")),this.$tabHeader=$(".tab-header",this.$el),this.$tabContent=$(".tab-content",this.$el),this.$tabFooter=$(".tab-footer",this.$el),this.$wrap.append(this.$el),this},t.prototype.renderHeader=function(t){var e;return e=a.render("header",{headerTitle:t,tabList:this.tabList,currentTabIndex:this.currentTabIndex}),this.$tabHeader.html(e),this},t.prototype.renderFooter=function(){var t;return t=a.render("footer",{tabLength:this.tabList.length,currentTabIndex:this.currentTabIndex,currentTab:this.currentTab,createOrgTab:this.createOrgTab}),this.$tabFooter.html(t),this},t.prototype.renderTabs=function(){var t;return t=$.extend({},{countries:this.countries,membersLimit:this.membersLimit},this.userMe),$.each(this.tabList,function(e){return function(i,n){return e.$tabContent.append(a.render("tab-"+n,t))}}(this)),this.$forms=$("form",this.$tabContent),this.$tabPanes=$(".tab-pane",this.$tabContent),this.$sendCodeHandler=$(".send-vc-handler",this.$tabContent),this.$errorVcodeBlock=$(".error-handler",this.$tabContent),this.$groupVerifyCode=$(".group-vc",this.$tabContent),this.$groupVerifyImage=$(".group-vi",this.$tabContent),this.$verifyImageWrap=$(".verify-image-wrap",this.$tabContent),this.$selectIndustry=$(':input[name="industry"]',this.$tabContent),this.$inputVerifyCode=$(':input[name="verifyCode"]',this.$tabContent),this.$inputCountryCode=$(':input[name="countryCode"]',this.$tabContent),this.$inputPhone=$(':input[name="contactPhone"]',this.$tabContent),this.$importedMembers=$(".imported-members",this.$tabContent),this.$currentCountry=$(".current-country",this.$tabContent),this.$phoneCountry=$(".phone-country",this.$tabContent),this.hasBoundPhones=[],this.hasSendPhones=[],this},t.prototype.renderCaptcha=function(){var t;return this.captcha.host&&(t=$.extend({},this.captcha,{imagePrefix:this.captcha.host+"/image?uid="+this.captcha.uid+"&index=",title:o.__("captchaTitle",this.captcha.title)}),this.$verifyImageWrap.html(a.render("captcha",t))),this},t.prototype.validCaptcha=function(t){var e,i,n,s,a,c,l;return l=$(t.target).data("value"),s=this.captcha,i=s.host,n=s.num,c=s.uid,e=i+"/valid?num="+n+"&uid="+c+"&value="+l,a=$.get(e),a.done(function(t){return function(e){return(null!=e?e.valid:void 0)?(t.captcha.pass=!0,t.renderCaptcha()):(r.show({message:o.__("captchaInvalided"),status:"error"}),t.resetCaptcha())}}(this)),a.fail(function(t){return function(){return t.captcha.validFreq=!0,t.renderCaptcha()}}(this)),this},t.prototype.resetCaptcha=function(){var t,e,i,n,r,s;return this.captcha.host?(n=this.captcha,e=n.host,i=n.num,s=n.uid,t=e+"/setup?num="+i+"&uid="+s+"&lang="+o.locale,r=$.get(t),r.done(function(t){return function(e){if(null!=e?e.values:void 0)return t.captcha.values=e.values,t.captcha.title=e.imageName,t.captcha.uid=e.uid,t.renderCaptcha()}}(this)),r.fail(function(t){return function(){return t.captcha.setupFreq=!0,t.renderCaptcha()}}(this))):this.$groupVerifyImage.remove(),this},t.prototype.renderOrgMembers=function(t){switch(t){case"imported":this.options.apiGetOrgMembers(this.org._id).then(function(t){return function(e){var i,n,r,o,s;for(t.$importedMembers.empty(),e.length<5?e[4]="":(t.membersLimit===-1||e.length<t.membersLimit)&&e.push({_id:!1}),s=[],i=n=0,r=e.length;n<r;i=++n)o=e[i],s.push(t.renderOrgMember(t.$importedMembers,o,i));return s}}(this));break;case"recommend":this.options.apiGetOrgWorkedMembers(this.org._id).then(function(t){return function(e){var i,n,r,s,c;if(t.$workedMemberList.empty(),e.length){for(c=[],n=0,r=e.length;n<r;n++)s=e[n],c.push(t.renderOrgMember(t.$workedMemberList,s,0,!1,"member-worked"));return c}return i=a.render("no-content",{tipText:o.__("tabMembersImportWorkedNoContent")}),t.$workedMemberList.html(i)}}(this))}return this},t.prototype.renderOrgMember=function(t,e,i,n,r){var o,s,c;return null==i&&(i=0),null==n&&(n=!0),null==r&&(r="member"),c=$.extend({},e),e?(c._userMeId=this.userMe._id,c.isNew=!c.isActive&&/teambition.com\/logos/.test(c.avatarUrl)&&c._id!==c._userMeId):c._id=!1,s=$(a.render(r,c)),o=$(".is-blank:first",t),o.length?c._id?o.replaceWith(s):void 0:n?setTimeout(function(){return s.css("display","none").appendTo(t).slideDown(218)},120*i):s.appendTo(t)},t.prototype.updateTabInfo=function(){return this.renderHeader(o.__("tabInfo")),this},t.prototype.updateTabContact=function(){return this.renderHeader(o.__("tabContact")),this},t.prototype.updateTabMembers=function(){return this.renderHeader(o.__("tabMembers")),this.renderOrgMembers("imported"),this},t.prototype.switchTab=function(t){switch(this.currentTabIndex=t>=0?t:this.defaultTabIndex,this.currentTab=this.tabList[this.currentTabIndex],this.$currentTab=this.$tabPanes.eq(this.currentTabIndex),this.currentTab){case"info":this.updateTabInfo();break;case"contact":this.updateTabContact();break;case"members":this.updateTabMembers()}return this.renderFooter(),this.switchTabTransition(),this},t.prototype.switchTabTransition=function(){return this.$tabContent.css("min-height",this.$tabPanes.filter(".active").outerHeight()||0).addClass("is-transition"),this.$currentTab.addClass("active"),setTimeout(function(t){return function(){return t.$currentTab.addClass("in")}}(this),0),this.$tabPanes.not(this.$currentTab).filter(".active").one("bsTransitionEnd",function(){return $(this).removeClass("active")}).emulateTransitionEnd(150).removeClass("in"),this.$tabContent.one("bsTransitionEnd",function(t){return function(){return t.$tabContent.removeClass("is-transition")}}(this)).emulateTransitionEnd(300).css("min-height",this.$currentTab.outerHeight()),clearTimeout(this.transitionTimer),this.transitionTimer=setTimeout(function(t){return function(){return t.$tabContent.removeClass("is-transition")}}(this),800),this},t.prototype.onSwitchTab=function(t){var e,i,n,r,o;if(e=$(t.currentTarget),i=e.data("action"),n=e.hasClass("is-disabled"),"next"===i&&this.$currentTab.addClass("try-switched"),!n)switch(i){case"prev":this.switchTab(this.currentTabIndex-1);break;case"next":this.currentTab===(r=this.createOrgTab)&&"info"===r?this.submitCreateOrg(function(t){return function(){return t.switchTab(t.currentTabIndex+1)}}(this)):this.currentTab===(o=this.createOrgTab)&&"contact"===o?this.validateVerifyCode(function(t){return function(){return t.submitCreateOrg(function(){return t.switchTab(t.currentTabIndex+1)})}}(this)):this.switchTab(this.currentTabIndex+1);break;case"last":this.lastAction()}return this.validateInputs(),this},t.prototype.updateVerifyCodeHandler=function(t){var e,i,n,r,s,a;if(i=this.$sendCodeHandler.hasClass("is-cd"),e=["is-retry","is-focus"],n=this.$sendCodeHandler.hasClass("in")?"in":"",s=p.call(e,t)>=0?"can-send "+t:t,s+=" "+n,!i)switch(this.$sendCodeHandler.attr("class","send-vc-handler fade "+s),t){case"is-cd":this.updateVerifyCodeGroup(!0,!0),r=60,a=setInterval(function(t){return function(){if(t.$sendCodeHandler.text(o.__("tabContactVerifyCodeRetryCD",--r)),0===r)return clearInterval(a),t.$sendCodeHandler.removeClass("is-cd"),t.validateInputs()}}(this),1e3);break;case"is-bound":this.updateVerifyCodeGroup(!1),this.$sendCodeHandler.text(o.__("tabContactPhoneBound"));break;case"is-retry":this.updateVerifyCodeGroup(!0),this.$sendCodeHandler.text(o.__("tabContactVerifyCodeRetry"));break;case"is-focus":case"can-send":this.updateVerifyCodeGroup(!1),this.$sendCodeHandler.text(o.__("tabContactVerifyCodeSend"));break;case"cant-send":this.updateVerifyCodeGroup(!1);break;case"is-sending":this.$sendCodeHandler.text(o.__("tabContactVerifyCodeSending"))}return this},t.prototype.validateVerifyCode=function(t){var e,i,n,r,s,a,c;return e=this.$sendCodeHandler.hasClass("can-send"),s=this.$sendCodeHandler.hasClass("in"),a=this.$groupVerifyCode.hasClass("is-open"),n=this.$inputPhone.val().replace(/\s+/g,""),i=this.$inputCountryCode.val().trim(),r=this.$inputVerifyCode.val().trim(),c=i+"-"+n,n!==this.userMe.phoneForLogin&&s?e&&!a?setTimeout(function(t){return function(){return t.updateVerifyCodeHandler("is-focus")}}(this),100):this.options.apiPostVerifyCode(c,{vcode:r,uid:this.captcha.uid}).then(function(){return t()})["catch"](function(t){return function(e){return t.$errorVcodeBlock.text(o.__("tabContactVerifyCodeError")),t.$inputVerifyCode.addClass("validate-error"),$('.btn[data-action="next"]',t.$tabFooter).addClass("disabled")}}(this)):t(),this},t.prototype.updateVerifyCodeGroup=function(t,e){return null==e&&(e=!1),this.$groupVerifyCode[t?"slideDown":"slideUp"](218),this.$groupVerifyCode.toggleClass("is-open",t),this.$inputVerifyCode.toggleClass("is-required",t),e&&this.$inputVerifyCode.focus(),this},t.prototype.validateCountryCode=function(t){var e,i;return i=this.$inputPhone.val().replace(/\s+/g,""),e=this.$inputCountryCode.val().trim(),c.isCountryCode(e)&&c.isPhone(i,e)?(this.$phoneCountry.removeClass("validate-error"),!0):(t&&this.$phoneCountry.addClass("validate-error"),this.updateVerifyCodeHandler("cant-send"),!1)},t.prototype.validatePhone=function(t){var e,i;return i=this.$inputPhone.val().replace(/\s+/g,""),e=parseInt(this.$inputCountryCode.val()),this.validateCountryCode(t)&&c.isPhone(i,e)?p.call(this.hasBoundPhones,i)>=0?this.updateVerifyCodeHandler("is-bound"):p.call(this.hasSendPhones,i)>=0?this.updateVerifyCodeHandler("is-retry"):i!==this.userMe.phoneForLogin?this.updateVerifyCodeHandler("can-send"):this.updateVerifyCodeHandler("cant-send"):(t&&this.$phoneCountry.addClass("validate-error"),this.updateVerifyCodeHandler("cant-send"),!1)},t.prototype.validateInputs=function(t){var e,i,n,r,o;return i=$(":input.is-required",this.$currentTab),e=$('.btn[data-action="next"]',this.$tabFooter),r=this.$currentTab.hasClass("try-switched"),o=[],n=this,i.each(function(){var t,e,i;if(i=$(this).val().trim(),e=!0,""===i)e=!1,r&&($(this).hasClass(".area-code")||$(this).hasClass(".phone-number")?n.$phoneCountry.addClass("validate-error"):$(this).addClass("validate-error"));else{switch(t=$(this).attr("name")){case"name":(i.length<2||i.length>40)&&(e=!1);break;case"description":i.length>200&&(e=!1);break;case"industry":i.length||(e=!1);break;case"countryCode":n.validateCountryCode(r)||(e=!1);break;case"contactPhone":n.validatePhone(r)||(e=!1);break;case"verifyCode":n.$errorVcodeBlock.empty()}e?$(this).removeClass("validate-error"):r&&$(this).addClass("validate-error")}return o.push(e)}),p.call(o,!1)<0?e.removeClass("is-disabled disabled"):(e.addClass("is-disabled"),r&&e.addClass("disabled")),this},t.prototype.validateMembersLimit=function(t){var e;return null==t&&(t=0),e=this.$importedMembers.find(".list-group-item.member").length,!(e+t>this.membersLimit&&this.membersLimit!==-1)||(t&&this.options.cbOverUpperLimit(o.__("tabMembersUpperLimitTip")),!1)},t.prototype.switchReqPhone=function(t){return this.captcha.close=!t,this.renderCaptcha(),this.$sendCodeHandler.toggleClass("in",t),this.$sendCodeHandler.hasClass("is-cd")&&this.updateVerifyCodeGroup(t),this},t.prototype.onSendVerifyCode=function(t){var e,i,n,s;return e=this.$sendCodeHandler.hasClass("can-send"),n=this.$inputPhone.val().replace(/\s+/g,""),i=this.$inputCountryCode.val().trim(),s=i+"-"+n,this.captcha.close||this.captcha.pass||!this.captcha.host?e&&(this.updateVerifyCodeHandler("is-sending"),this.options.apiGetVerifyCode(s,this.captcha.uid).then(function(t){return function(){return t.updateVerifyCodeHandler("is-cd"),t.hasSendPhones.push(n)}}(this))["catch"](function(t){return function(){return t.updateVerifyCodeHandler("can-send")}}(this))):r.show({
message:o.__("captchaTips"),status:"error"}),this},t.prototype.onCheckboxToggle=function(t){var e,i;return t.stopPropagation(),e=$(t.currentTarget),i=e.hasClass("is-checked"),e.attr("value",!i).toggleClass("is-checked",!i),this},t.prototype.onCheckboxTrigger=function(t){var e,i;return i=$(t.currentTarget),e=$("[name='"+i.data("for")+"']"),e.trigger("click"),this},t.prototype.onSetCountry=function(t){var e,i,n,r,o,s,a;return e=$(t.currentTarget),r=e.data("areacode"),i=e.data("abbr"),a=e.data("reqphone"),o=this.$currentCountry.attr("class").split(" "),s=o[o.length-1],this.$inputCountryCode.val(r),this.$currentCountry.removeClass(s).addClass(i),n=this.$inputCountryCode.val(),this.$inputCountryCode.css("width",this.getAreaCodeWidth(n)),this.switchReqPhone(a),this},t.prototype.onSetAreaCode=function(t){var e,i,n,r,o,s,a,c,l,p;for(e=$(t.currentTarget),i="other",p=!1,n=e.val(),r=this.$currentCountry.attr("class").split(" "),o=r[r.length-1],this.$inputCountryCode.css("width",this.getAreaCodeWidth(n)),l=this.countries,a=0,c=l.length;a<c;a++)s=l[a],s.areaCode===n&&(i=s.abbr,p=s.reqPhone);return this.$currentCountry.removeClass(o).addClass(i),this.switchReqPhone(p),this},t.prototype.getAreaCodeWidth=function(t){if(t.length)return 8*t.length+11;switch(o.locale){case"en":return 47;case"ko":return 34;default:return 56}},t.prototype.onOpenImportEmail=function(t){return this.$viewEmail=$(a.render("modal-email")),this.bindEmailEvents(),this.modalEmail=new s({$modalContent:this.$viewEmail,textTitle:o.__("tabMembersImportEmail"),textSubmit:o.__("modalEnter"),model:$.extend(this.org,{membersCount:this.$importedMembers.find(".list-group-item.member").length}),onSubmit:this.importMembersFormEmail}),this},t.prototype.onOpenImportWorked=function(t){return this.$viewWorked=$(a.render("modal-worked")),this.$workedMemberList=$(".members-worked",this.$viewWorked),this.bindEmailWorked(),this.modalWorked=new s({$modalContent:this.$viewWorked,textTitle:o.__("tabMembersImportWorked"),textSubmit:o.__("modalEnter"),model:$.extend(this.org,{membersCount:this.$importedMembers.find(".list-group-item.member").length}),onSubmit:this.importMembersFormWorked}),this.renderOrgMembers("recommend"),this},t.prototype.validateMultiEmail=function(t){var e,i,n;return i=$(t.currentTarget),e=i.closest(".modal-content").find(".modal-footer .btn-primary"),n=i.val(),""!==n&&(n=n.replace(/，/g,",").replace(/；/g,";"),i.val(n),this.convertMultiEmail(n),this.modalEmail.renderMembersCount(this.newEmailList.length)),this},t.prototype.convertMultiEmail=function(t){var e,i,n,r,o,s,a,l;for(l=/[(,|;)\s]+|[(,|;)\s]+/,s=t.trim().split(l),i=[],n=r=0,o=s.length;r<o;n=++r)e=s[n],a=c.isEmail(e),a&&i.push(e);return this.newEmailList=c.uniqArray(i),this},t.prototype.getImportedMembersEmail=function(){var t,e;return t=$(".member",this.$importedMembers),e=[],t.each(function(){return e.push($(this).data("email"))}),e},t.prototype.importMembersFormEmail=function(){var t,e,i,n,r,o,s,a,c,l;if(t=$(".list-group-item",this.$importedMembers),i=[],r=this.getImportedMembersEmail(),this.validateMembersLimit(null!=(a=this.newEmailList)?a.length:void 0)&&(null!=(c=this.newEmailList)?c.length:void 0)){for(l=this.newEmailList,n=o=0,s=l.length;o<s;n=++o)e=l[n],p.call(r,e)<0&&i.push(this.newEmailList[n]);i.length&&this.options.apiPostAddOrgMember(this.org._id,{email:i}).then(function(e){return function(i){var r,o,s,a;for((t.length+1<e.membersLimit||e.membersLimit===-1)&&i.push({_id:!1}),a=[],n=r=0,o=i.length;r<o;n=++r)s=i[n],a.push(e.renderOrgMember(e.$importedMembers,s,n));return a}}(this))}return this},t.prototype.onRemoveMember=function(t){var e,i,n,r;return n=$(t.currentTarget),i=n.closest(".member"),e=$(".list-group-item",this.$importedMembers),r=i.data("id"),n.addClass("disabled"),this.options.apiDeleteOrgMember(this.org._id,r).then(function(){var t;return e.length>5&&e.filter(".is-blank").length?i.slideUp(218,function(){return $(this).remove()}):(t=$(a.render("member",{_id:!1})),i.replaceWith(t))})["catch"](function(){return n.removeClass("disabled")}),this},t.prototype.onWorkedCheckboxToggle=function(t){return this.onCheckboxToggle(t),this.modalWorked.renderMembersCount($(".check-box.is-checked",this.$workedMemberList).length),this},t.prototype.onWorkedMemberToggle=function(t){var e,i;return i=$(t.currentTarget),e=$(".checkbox-handler",i),e.trigger("click"),this},t.prototype.importMembersFormWorked=function(){var t,e;return e=[],t=$(".check-box.is-checked",this.$workedMemberList),this.validateMembersLimit(t.length)&&(t.each(function(i){return e.push(t.eq(i).data("email"))}),this.options.apiPostAddOrgMember(this.org._id,{email:e}).then(function(t){return function(e){var i,n,r,o,s;for(e.push({_id:!1}),s=[],i=n=0,r=e.length;n<r;i=++n)o=e[i],s.push(t.renderOrgMember(t.$importedMembers,o,i));return s}}(this))),this},t.prototype.submitCreateOrg=function(t){var e,i,n,r;return i=$(":input",this.$currentTab),e=$(".btn, .check-box, .selectcountry a",this.$el),n=$('.btn[data-action="next"]',this.$tabFooter),i.prop("readonly",!0),this.$phoneCountry.attr("readonly",!0),e.addClass("disabled"),n.text(o.__("orgCreating")),setTimeout(function(){return n.addClass("disabled is-submitting")},50),r=$.extend({},c.getFormsData(this.$forms),{provideDemo:$('[name="provideDemo"]',this.$el).attr("value")}),this.options.apiPostCreateOrg(r).then(function(i){return function(n){return setTimeout(function(){var r;return e.removeClass("disabled is-submitting"),i.org=$.extend({},n),"function"==typeof(r=i.options).cbCreateSuccessed&&r.cbCreateSuccessed(i.org._id),t()},1e3)}}(this))["catch"](function(t){return function(r){return setTimeout(function(){return e.removeClass("disabled is-submitting"),i.prop("readonly",!1),t.$phoneCountry.attr("readonly",!1),n.text(o.__("orgCreate"))},1e3)}}(this)),this},t.prototype.onValidateEmailInput=function(t){var e,i,n,r;return e=$(t.currentTarget),i=e.parent(),n=e.val().trim(),r=this.getImportedMembersEmail(),c.isEmail(n)?(i.removeClass("is-error-email"),p.call(r,n)>=0?i.addClass("is-error-repeat"):i.removeClass("is-error-repeat")):(""!==n&&i.addClass("is-error-email"),i.removeClass("is-error-repeat")),this.onLastTwoEmailInputs(t),this},t.prototype.onAddMemberInput=function(t){var e,i,n;return e=$(t.currentTarget),i=e.parent(),n=e.val().trim(),("focusout"===t.type||"keydown"===t.type&&13===t.keyCode)&&(i.addClass("try-added"),/is-error/.test(i.attr("class"))||""===n||i.hasClass("is-adding")?i.removeClass("is-adding"):(i.addClass("is-adding"),this.options.apiPostAddOrgMember(this.org._id,{email:n}).then(function(t){var e,n,r;return r=t[0],r.isNew=!r.isActive&&/teambition.com\/logos/.test(r.avatarUrl),n=$(a.render("member",r)),e=i.closest(".is-blank"),e.replaceWith(n)})["catch"](function(){return i.removeClass("is-adding")}))),this},t.prototype.onLastTwoEmailInputs=function(t){var e,i,n,r,o;return r=$(t.currentTarget),e=r.closest(".list-group-item"),i=$(".list-group-item",this.$importedMembers),o=r.val(),""===o&&i.length>5&&i.length-2===e.index()?this.$importedMembers.find(".is-blank:last").slideUp(218,function(){return $(this).remove()}):i.length===e.index()+1&&""!==o&&(i.length<this.membersLimit||this.membersLimit===-1)&&(n=$(a.render("member",{_id:!1})),n.css("display","none").appendTo(this.$importedMembers).slideDown(218)),this},t.prototype.lastAction=function(){var t;return this.destroy(),"function"==typeof(t=this.options).cbLastButtonAction&&t.cbLastButtonAction(this.org),this},t.prototype.destroy=function(){return this.$el.off("."+this.name),this},t}()},function(t,e){},,function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;a=i(351),r=i(582),o=i(587),n=i(579),c=new r({__:n.__}),t.exports=s=function(t){function e(t){this.options=t,this.renderBasic().renderMembersCount().delegateEvents()}return l(e,t),e.prototype.renderBasic=function(){return e.__super__.renderBasic.apply(this,arguments),this.$membersCount=$(".members-count",this.$el),this.$submit=$(".btn-primary",this.$el),this},e.prototype.renderMembersCount=function(t){var e,i;return null==t&&(t=0),e=this.options.model,this.membersCurrent=e.membersCount,this.membersLimit=e.plan.membersCount,this.membersTotal=this.membersCurrent+t,i=Math.abs(this.membersLimit-this.membersTotal),this.$membersCount.html(c.render("members-count",{_id:e._id,membersCurrent:this.membersCurrent,membersTotal:this.membersTotal,membersLimit:this.membersLimit,gap:i})),this.checkStatusOfSubmit(),this},e.prototype.checkStatusOfSubmit=function(){return this.membersLimit===-1||this.membersLimit>=this.membersTotal&&this.membersLimit!==this.membersCurrent?this.$submit.removeClass("disabled"):this.$submit.addClass("disabled")},e}(o)},function(t,e,i){var n,r,o,s;o=i(351),n=i(582),s=new n,t.exports=r=function(){function t(t){this.options=t,this.renderBasic().delegateEvents()}return t.prototype.delegateEvents=function(){return this.$el.on("shown.bs.modal",function(t){return function(){return t.onOpen()}}(this)).on("hidden.bs.modal",function(t){return function(){return t.remove()}}(this)).on("click",".modal-footer .btn",function(t){return function(e){return t.onHandlerset(e)}}(this)),this},t.prototype.renderBasic=function(){var t;return t=s.render("modal",{textTitle:this.options.textTitle,textSubmit:this.options.textSubmit}),this.$body=$("body"),this.$el=$(t),this.$modalBody=$(".modal-body",this.$el),this.$modalContent=this.options.$modalContent,this.$modalContent.appendTo(this.$modalBody),this.$el.appendTo(this.$body),this.modal=this.$el.modal().data("bs.modal"),this},t.prototype.onHandlerset=function(t){var e,i,n,r;if(e=$(t.currentTarget),i=e.data("action"),r=e.hasClass("is-disabled"),!r)switch(i){case"submit":return"function"==typeof(n=this.options).onSubmit&&n.onSubmit(),this.onClose()}},t.prototype.onOpen=function(){return this.$body.one("keydown.grey.modal",function(t){return function(e){if(e.preventDefault(),e.stopPropagation(),27===e.which)return t.onClose()}}(this))},t.prototype.onClose=function(){var t;return null!=(t=this.modal)&&t.hide(),this.$body.off(".grey.modal"),this},t.prototype.remove=function(){return this.$el.remove(),this},t}()},function(t,e,i){var n;n=i(351),t.exports={getFormsData:function(t){var e,i,n,r;for(i={},r=t.serializeArray(),e=0;e<r.length;)n=r[e],i[n.name]=n.value.trim(),e++;return i},random:function(t,e){return null===e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},isCountryCode:function(t){return/^[0-9]{1,7}$/.test(t)},isPhone:function(t,e){return 86===e?/^[0-9]{11}$/.test(t):/^[0-9]{5,15}$/.test(t)},isEmail:function(t){return/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/.test(t)},uniqArray:function(t){return $.grep(t,function(e,i){return $.inArray(e,t)===i})}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S,I,z,P,D,O,N,E,A,L,V,R,F,q,H,B,U,W,J,G,Y;i(617),i(676),i(398).polyfill(),z=i(358),c=i(408),l=i(410),J=i(458),S=i(677),d=i(680),h=i(439),M=i(681),V=i(682),Y=i(530),U=i(678),O=i(679),j=i(683),f=i(437),p=i(784),T=i(686),v=i(785),I=i(786),s=i(789),u=i(1915),x=i(1916),m=i(688),n=i(1923),r=i(1925),C=i(1340),k=i(697),y=i(1926),_=i(1358),w=i(696),g=i(684),o=i(1356),a=i(1927),b=i(1929),p.initialize(),d.initialize(),h.setOptions({breaks:!0,sanitize:!0,smartLists:!0}),window.teambition=U,window.warehouse=Y,window.Socket=T,W=new J,U.ua=W,$("body").addClass(W.getOS().name.toLowerCase()+" "+W.getBrowser().name.toLowerCase()),$("body").on("dragover dragenter drop",function(){return!1}),window._encodeHTML=function(t,e,i){var n,r;return"md"===(null!=e?e.toLowerCase():void 0)?(r=h(z.unescape(t),i).replace(/<em>/g,"<i>").replace(/<\/em>/g,"</i>"),n=$("<div>"+r+"</div>"),n.find("script").remove(),n.find("a").each(function(){var t,e;if(t=$(this),e=$(this).attr("href"),e&&/^javascript:/.test(e.trim()))return t.removeAttr("href").removeAttr("target")}),n.html()):S.escape(t)},U.gta=l,k.prototype.isOverdue=function(){var t,e;return t=g.get(0),null!=(e=t.get(this.get("_organizationId")))?e.isOverdue():void 0},k.prototype.isExpiring=function(){var t,e;return t=g.get(0),null!=(e=t.get(this.get("_organizationId")))?e.isExpiring():void 0};try{U.favico=new c({animation:"popFade"}),P=D=0,Object.defineProperties(U.favico,{chat_count:{get:function(){return P},set:function(t){var e;return P=t,null!=(e=U.favico)?e.badge(P+D):void 0}},inbox_count:{get:function(){return D},set:function(t){var e;return D=t,null!=(e=U.favico)?e.badge(P+D):void 0}}})}catch(L){N=L}R=function(){var t,e,i,n,r;try{return U.user.get("isGhost")?U.gta.event({action:"guest enter teambition",category:"teambition"}):(i={action:"enter teambition",category:"teambition"},(null!=(n=U.user.get("lastEntered"))?n.web:void 0)||(i.type="first session",t=U.user.get("created"),r=document.cookie.match(/utm=(.*?)(?:;|$)/),r&&Date.now()-new Date(t)<6048e5&&(i.utm=decodeURI(r[1]))),U.gta.event(i))}catch(e){N=e}},A=function(t){var e;if(V.error(t),"development"!==U.env)return e=encodeURIComponent(window.location.href),window.location=O.ACCOUNT_HOST+"/login?next_url="+e},q=function(){var t,e;return e=U.user,t=e.getPaymentPlan(),z.delay(function(){if("professional"===t.payType&&t.isOverdue)return(new I).open(b)},500)},E=function(){var t,e;if(U.PREFERENCE.initLanguage(),o.fetch(),U.APP=new s,U.applications=a.get(),U.hook=new u,O.FEATURES.plugins&&!function(){var t;return t=i(1740),t.initMy()}(i),U.router=new j,U.router.start(),$("#bodyloadinglayer").addClass("fading"),setTimeout(function(){return $("#bodyloadinglayer").remove(),$("#loading-style").remove(),$("#loading-script").remove()},318),R(),q(),U.user.get("snapperToken")&&(T.connect(O.PUSH_HOST,{path:"/websocket",token:U.user.get("snapperToken")}),U.user.on("change:snapperToken",function(t,e){return T.options.token=e})),U.ab.hasTest("tb-nps")&&(e=new x(U.user.id),$("body").append(e.$el)),U.ABTest.get("in_app_msg")&&Date.now()-new Date(U.user.get("created"))<2592e5)return t=i(1490),t.getInstance().boot().update({experiments:"in_app_msg"})},H=function(){var t;return t=U.user,U.ab=new n,U.ABTest=new r,U.ABTest.register(["in_app_msg"]),U.PREFERENCE=new y({_userId:t.id}),Promise.all([d.get("permissions"),d.get("roles")]).then(function(e){return v.initialize(e[0]),_.get(0).reset(e[1]),t.get("isGhost")?new Promise(function(t,e){return a.fetch(0,{success:t,error:e})}):Promise.all([new Promise(function(t,e){return w.fetch(0,{success:function(e){return e.joinRooms(),t()},error:e})}),new Promise(function(t,e){return g.fetch(0,{success:t,error:e})}),new Promise(function(t,e){return a.fetch(0,{success:t,error:e})}),new Promise(function(t,e){return U.PREFERENCE.fetch({success:t,error:e})}),U.ab.fetch(t.id),new Promise(function(t,e){return U.ABTest.fetch({success:t,error:t})})])}).then(function(){var e,i,n,r,o;if(!t.get("isGhost")){U.PREFERENCE.initLanguage();try{return e=t.get("created"),i=t.get("email"),o=t.get("locationByIP"),r={userKey:{alias:{fullstory:"userId_str"},value:t.id},name:{wlist:["customer"],value:t.get("name")},email:{wlist:["customer"],value:i},created_at:{alias:{fullstory:"createdAt_date"},value:e},language:{alias:{fullstory:"language_str",tbpanel:"userLanguage"},value:U.PREFERENCE.getLanguage()},env:{alias:{fullstory:"env_str"},value:U.env},version:{alias:{fullstory:"version_str"},value:U.version},daysSinceRegistered:{alias:{fullstory:"daysSinceRegistered_real"},value:function(){var t;return t=Date.now()-new Date(e),t<-864e5?-1:0|Math.ceil(t/864e5)}()},timezone:{alias:{fullstory:"timezone_real"},value:(new Date).getTimezoneOffset()/-60}},o&&(r.city=o.city,r.country=o.country,r.region=o.region),r.org_subscription=g.get(0).any(function(t){var e;return e=t.getPaymentPlan(),"paid"===e.status&&!e.isOverdue}),r.pro_subscription=w.get(0).any(function(t){var e;return e=t.getPaymentPlan(),"paid"===e.status&&!e.isOverdue}),U.ABTest&&(r.experiments=U.ABTest.toGTAProperties()),U.gta.setUser(t.id,r)}catch(n){return A=n,console.error(A.toString())}}}).then(function(){return E()})["catch"](function(t){return console.error(t)})},G=function(){return U.user.fetch({url:"users/me",silentError:!0,success:H,error:H})},U.user=new C,U.socket=T,G(),F=function(t){return z.delay(function(){return U.user.fetch({url:"users/me"}),F(t)},t)},F(864e5),B=M("teambition"),(!B||Date.now()-new Date(B)>1296e6)&&(M.namespace("temp").clearAll(),M("teambition",new Date)),V({host:O.LOGS_HOST,slient:{log:!0,error:!1}}),V.reportInitTime(),V.reportStaticsLoadTime()},function(t,e){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,i){var n=i(455);n.setLocales("zh",{"1day":"1 天","1hour":"1 小时","20mins":"20 分钟","4hours":"4 小时",FRI:"五",MON:"一",SAT:"六",SUN:"日",THU:"四",TUE:"二",WED:"三",add:"添加",added:"已添加",all:"所有分享",archive:"归档",back:"返回",birthday:"生日",bookkeeping:"记账",bound:"立即绑定",by:"by",calendar:"日历",cancel:"取消",clickToEdit:"点击即可编辑",close:"关闭",collapse:"收起",collection:"文件夹",colon:"：",comma:"，",confirm:"确定",connected:"网络已连上，欢迎回来",copyAs:"复制为",copyTo:"复制到",create:"创建",creator:"创建者",day:"天","delete":"删除",disconnected:"网络有异常，请检查网络后再试",done:"完成",draft:"检测到有未保存内容，是否恢复？",edit:"编辑",email:"邮箱",entries:"帐目",entry:"账目",error:"对不起，出错啦！",event:"日程",events:"日程",executor:"执行者",expand:"展开",favorite:"收藏",file:"文件",files:"文件",fullStop:"。",groupchat:"群聊",guest:"访客",hide:"隐藏",inbox:"通知",language:"简体中文",location:"地址",login:"登录",logout:"退出登录",manager:"管理员",me:"我",member:"成员",merge:"merge",mobile:"电话",month:"月",more:"更多",moveTo:"移动到",my:"我的",noRight:"您不能修改",none:"无",open:"开启",organization:"企业",owner:"拥有者",plugin:"应用与插件",position:"职位",post:"分享",posts:"分享",project:"项目",projects:"项目","public":"公开",register:"注册",remove:"移除",renew:"续费",repeat:"重复",reply:"回复",rmb:"元",save:"保存",search:"搜索",setting:"设置",show:"显示",stage:"列表",tags:"标签",task:"任务",tasklist:"任务分组",tasks:"任务",team:"部门",today:"今天",unarchive:"取消归档",unfavorite:"取消收藏",unknown:"未知",unknownDate:"未知日期",updated:"更新于",upgrade:"升级",upload:"上传",view:"查看",website:"网址",week:"周",works:"文件","acitivity.timeline.notif.none.tip":"没有人会收到通知","acitivity.timeline.notif.tip":"人将会收到通知","activity.card.body.checkMore":"查看更多","activity.card.create.headerTips":"创建了项目","activity.card.error.notFound":"没有找到这个%s，或许已经被删掉了。","activity.card.project.title":"任务统计","activity.card.table.doneTasks":"已完成","activity.card.table.placeholder":"最近项目进展情况","activity.card.table.title":"项目进展","activity.card.table.todoTasks":"未完成","activity.card.today.title":"今天的事","activity.card.unassigned.title":"待认领的任务","activity.comment.link.title":"关联内容","activity.destroyer.confirm.delete":"确认希望永久删除这条动态？","activity.destroyer.delete":"删除动态","activity.destroyer.delete.fail":"删除失败，请重试","activity.destroyer.delete.success":"删除成功","activity.download.all.attachments":"下载附件","activity.early.hidden":"显示更早的%s条评论","activity.early.loading":"正在载入更早的评论...","activity.early.shown":"隐藏较早的评论","activity.editor.error":"修改评论失败了","activity.editor.place.holder":"编辑评论...","activity.editor.success":"成功修改了评论","activity.editor.title":"编辑评论","activity.invisible.not.involved.tip1":"该内容为仅参与者可见，%s 还不是参与者，将他 <a class='add-involve'>添加为参与者</a> 后，他将在%s有更新时收到通知。","activity.invisible.not.involved.tip2":"该内容为仅参与者可见，%s 等%s人还不是参与者，将他们 <a class='add-involve'>添加为参与者</a> 后，他将在%s有更新时收到通知。","activity.invisible.not.member.tip1":"该内容为仅参与者可见，你提及的 %s 尚未加入项目，但他会收到通知","activity.invisible.not.member.tip1.addmember":"，你也可以将他 <a class='add-member-involve'>加入项目并添加为参与者</a>。","activity.invisible.not.member.tip2":"该内容为仅参与者可见，你提及的 %s 等%s人尚未加入项目，但他们会收到通知","activity.invisible.not.member.tip2.addmember":"，你也可以将他们 <a class='add-member-involve'>加入项目并添加为参与者</a>。","activity.invisiblea.addmember.success":"已经将成员加入项目","activity.moreAttachments":"等","activity.moreFiles":"个文件","activity.panel.checkAll":"查看所有项目动态","activity.panel.filter.allMember":"所有成员","activity.panel.filter.allType":"所有类型","activity.panel.filter.date":"时间","activity.panel.filter.member":"成员","activity.panel.filter.system":"系统消息","activity.panel.filter.type":"类型","activity.panel.invite":"邀请新成员","activity.panel.menu.calendar":"订阅项目内容至第三方日历","activity.panel.menu.checkArchive":"查看归档","activity.panel.menu.config":"应用与插件","activity.panel.menu.copy":"复制项目","activity.panel.menu.enterOrg":"进入企业","activity.panel.menu.export.tasks":"导出分组内所有任务","activity.panel.menu.share":"分享项目","activity.panel.placeholder.searchMember":"查找成员","activity.panel.title.activities":"项目动态","activity.panel.title.all":"项目菜单","activity.panel.weeker.all":"全部","activity.system.handlers.enterorg":"前往企业：%s","activity.system.handlers.enterproject":"前往项目：%s","activity.system.handlers.openchat":"前往私信：%s","activity.timeline.add.attachment":" 添加附件","activity.timeline.add.emoji":"添加表情","activity.timeline.comment":"@提及他人，按 Enter 快速发布","activity.timeline.comment.ghost":"<a class='login-handler'>登录</a>或<a class='register-handler'>注册</a>后可参与讨论","activity.timeline.like":"点赞","activity.timeline.like.tips.long":"%s人赞了","activity.timeline.like.tips.short":"点个赞","activity.timeline.only.attachment":"仅附件","activity.timeline.only.comment":"仅评论","activity.timeline.remove.like":"取消点赞","activity.timeline.reply":"发布","activity.timeline.reply.enter":"按 Enter 发送消息","activity.timeline.reply.quickly.placeholder":"@提及他人，按 Ctrl+Enter 快速发布","activity.timeline.reply.shortcut":"按 Ctrl+Enter 发送消息","activity.visible.not.involved.tip1":"你提及的 %s 还不是参与者，将他 <a class='add-involve'>添加为参与者</a> 后，他将在%s有更新时收到通知。","activity.visible.not.involved.tip2":"你提及的 %s 等%s人还不是参与者，将他们 <a class='add-involve'>添加为参与者</a> 后，他们将在%s有更新时收到通知。","activity.visible.not.involved.tip3":"你还不是参与者，将你 <a class='add-involve'>添加为参与者</a> 后，你将在%s有更新时收到通知。","activity.visible.not.involved.tip4":"你和 %s 还不是参与者，将你们 <a class='add-involve'>添加为参与者</a> 后，你们将在%s有更新时收到通知。","activity.visible.not.member.tip1":"你提及的 %s 尚未加入项目，但他会收到通知","activity.visible.not.member.tip1.addmember":"，你也可以将他 <a class='add-member'>加入项目</a>。","activity.visible.not.member.tip2":"你提及的 %s 等%s人尚未加入项目，但他们会收到通知","activity.visible.not.member.tip2.addmember":"，你也可以将他们 <a class='add-member'>加入项目</a>。","add.members.by.cooperated":"导入合作过的成员","add.members.by.cooperated.placeholder":"没有找到合作过的成员","add.members.by.emails":"批量输入邮箱","add.members.by.emails.placeholder":"将邮箱粘贴到这里，多个邮箱之间用换行分隔，每次最多添加20个。当前剩余成员名额%s人。","add.members.by.emails.placeholder.unlimit":"将邮箱粘贴到这里，多个邮箱之间用换行分隔，每次最多添加20个。","add.members.error.limit":"超过限制了，最多一次添加20个邮箱。","add.members.error.message":"企业成员数超过上限","add.members.tips.add.exceed":"人数已超出限制","add.members.tips.add.remian":"还可以添加 %s 人","add.success":"添加成功","all.member":"所有成员","all.project":"所有项目","already.inbox.later.message":"已稍后处理","already.inbox.later.message.hint":"将在 %s 再次提醒","app.download":"下载应用","archive.event":"归档日程","archive.file":"归档文件","archive.folder":"归档文件夹","archive.post":"归档分享","archive.tag":"归档标签","archive.task":"归档任务","archive.taskgroup":"归档任务分组","archive.title":"查看归档","archived.event.success":"已成功归档了日程","archived.file.success":"已成功归档了文件","archived.folder.success":"已成功归档了文件夹","archived.post.success":"已成功归档了分享","archived.projects":"已归档的项目","archived.tag.success":"已成功归档了标签","archived.task.success":"已成功归档了任务","archived.taskgroup.success":"已成功归档了任务分组","at.not.involved":"（不在参与者列表）","authority.get.error":"抱歉，您没有访问该内容的权限","authority.get.error.content":"请联系管理员调整访问权限，或邀请您加入项目","board.stage.sortplaceholder":"松开鼠标，任务将进入该阶段","bookkeeping.archived":"账目已归档，不可修改","bookkeeping.home.fields.amount":"金额","bookkeeping.home.fields.category":"类型","bookkeeping.home.fields.content":"内容","bookkeeping.home.fields.creator":"创建者","bookkeeping.home.fields.date":"时间","bookkeeping.home.fields.tags":"标签","bookkeeping.home.header.filter.toggler.title":"筛选和设置","bookkeeping.home.header.filtering":"（已筛选）","bookkeeping.home.tips.header.approve":"当前账目还未设置审批人，只有审批人才能对账目进行审批，<a class='bookkeping-setting-approver'>设置审批人</a>","bookkeeping.home.tips.placeholder":"轻松记录每一笔开支","bookkeeping.home.tips.placeholder.approve":"（只有审批人可以对账目进行审批，记账开始请先<a class='bookkeping-setting-approver'>设置审批人</a>）","bookkeeping.home.total.expense":"总支出","bookkeeping.home.total.expense.filtered":"筛选后支出","bookkeeping.home.total.income":"总收入","bookkeeping.home.total.income.filtered":"筛选后收入","bookkeeping.panel.filter.end.date":"结束时间","bookkeeping.panel.filter.hide.approved":"隐藏已经审核的账目","bookkeeping.panel.filter.start.date":"开始时间","bookkeeping.panel.input.placeholder":"查找相关账目","bookkeeping.panel.title.filter":"筛选","bookkeeping.panel.title.filter.clear":"清空筛选","bookkeeping.panel.title.settings":"记账设置","bookkeeping.settings.approver.member":"审批人","bookkeeping.settings.approver.tips":"只有审批人可以审批账目，您可以设置多个审批人","bookkeeping.settings.approver.title":"审批人设置","bookkeeping.settings.category.edit.placeholder":"分类名称","bookkeeping.settings.category.title":"管理分类","bookkeeping.settings.expense.tips":"支出","bookkeeping.settings.fields.in":"现有字段","bookkeeping.settings.fields.out":"未添加字段","bookkeeping.settings.fields.title":"账目字段设置","bookkeeping.settings.income.tips":"收入","calendar.add.subscriber":"添加关注","calendar.invisivle.event.tip1":"%s等%s人已有安排","calendar.invisivle.event.tip2":"%s已有安排","calendar.search.no.result":"抱歉，没有搜索结果","calendar.search.subscriber":"搜索","calendar.show.event":"日程","calendar.show.task":"任务","calendar.subscriber.display.title.recommend.members":"最近合作过的成员","calendar.subscriber.display.title.self.projects":"个人项目","calendar.subscriber.display.title.starred.projects":"星标项目","calendar.subscriber.is.empty":"点击下方「添加关注」<br />添加你所关心的成员或项目","calendar.subscriber.search.placeholder.member":"搜索成员","calendar.subscriber.search.placeholder.project":"搜索项目","calendar.subscriber.search.placeholder.team":"搜索部门","calendar.subscriber.tab.member":"成员","calendar.subscriber.tab.project":"项目","calendar.subscriber.tab.recommend":"推荐","calendar.subscriber.tab.team":"部门","calendar.subscriber.title":"添加成员和项目日历","calendar.time":"点","cancel.inbox.later.message":"已取消稍后处理","chat.message.at.me":"[有人@我]","chat.message.list.is.empty":"暂时没有私信","chat.message.list.is.error":"获取私信列表失败","chat.message.list.to.refresh":"点击刷新","chat.modal.title":"聊天","chat.nav.popover.new.chat":"发起聊天","chat.room.add.emoji":"添加表情","chat.room.chat.create":"新聊天","chat.room.chat.empty1":"暂无私信消息","chat.room.chat.empty2":"在这里你会收到新私信的消息提示","chat.room.cloesd.room":"群聊已关闭","chat.room.cloesd.room.placeholder":"群聊应用已关闭","chat.room.group.empty1":"还没有群聊消息","chat.room.group.empty2":"项目中的成员都可以在这里参与群聊","chat.room.group.mute":"消息免打扰","chat.room.member.empty1":"暂无成员","chat.room.member.empty2":"邀请你的同伴开始协作吧！","chat.room.new.private.msg":"新私信","chat.room.new.project.msg":"新项目群聊","chat.room.placeholder":"说点什么...","chat.room.send":"发送","chat.room.send.error":"发送私信失败，请重新尝试","chat.room.send.success":"发送私信成功，您可以在收件箱<a class='essage-url url-handler open-inbox-chat' data-id='%s'>私信列表</a>查看","collection.creator.collection.title":"文件夹名称","collection.creator.create.success":"文件夹创建成功","collection.creator.duplication.title":"文件夹名称已存在！","collection.destroyer.confirm.delete":"确认要将 %s 永久删除？","collection.destroyer.delete.fail":"删除失败，点击重试","collection.destroyer.delete.success":"删除成功","collection.destroyer.deleting":"正在删除","collection.destroyer.title":"确认删除","collection.download.title":"下载文件夹","collection.edit.duplication.title":"文件夹名称已存在！","collection.menu.confirm.delete":"您确定要永远删除这个文件夹吗","collection.menu.delete.title":"删除文件夹","collection.menu.title":"文件夹菜单","collection.move.message":"移动文件夹 %s 至","collection.move.title":"移动文件夹","collection.picker.creator.input.tips":"文件夹名称","collection.picker.creator.tips":"创建文件夹","collection.picker.select.collection":"请选择目标文件夹","collection.rename.title":"重命名","confirm.delete":"删除","confirm.unarchive.tip":"确认取消归档？","confirm.unarchive.tip.file":"取消归档后将移动至根目录，确认取消归档？","copy.link":"复制链接","copy.link.failed":"复制失败","copy.link.success":"已复制","create.event":"创建日程","create.event.success":"成功创建日程：","create.post.success":"成功创建分享：","create.task":"创建任务","create.task.success":"成功创建任务：","datetimepicker.date":"日期","datetimepicker.time":"时间","delete.entry":"删除记账","delete.event":"删除日程","delete.file":"删除文件","delete.folder":"删除文件夹","delete.post":"删除分享","delete.success":"删除成功","delete.tag":"删除标签","delete.task":"删除任务","delete.taskgroup":"删除任务分组","desktop.notification":"桌面通知","desktop.notification.desc":"「桌面通知」可以让您更方便地使用通知中心, 提高协作效率","desktop.notification.disable":"关闭桌面通知","desktop.notification.enable":"启用桌面通知","download.failed":"下载失败","draft.discard":"忽略","draft.restore":"恢复","due.date":"截止时间","editor.mode.html":"富文本编辑","enter.organization.guide":"企业向导","enter.organization.guide.text1":"进入","enter.organization.guide.text2":"，了解和配置企业版功能。","entry.amount.unit":"￥","entry.archives.success.unarchive":"成功取消账目的归档","entry.category.title.null":"没有类型","entry.creator.expense.title":"记录支出","entry.creator.income.title":"记录收入","entry.creator.other.add.placeholder":"添加类型","entry.creator.other.category":"更多","entry.creator.placeholder.amount":"金额","entry.creator.placeholder.content":"内容","entry.creator.placeholder.note":"添加备注","entry.detail.cost":"成本","entry.detail.profit":"利润","entry.list.action.approve":"审核","entry.list.action.revoke":"撤销","entry.list.status.approved":"已审核","entry.menu.action.approve":"批准账目","entry.menu.action.archive":"归档账目","entry.menu.action.delete":"删除账目","entry.menu.action.edit":"编辑账目","entry.menu.action.revoke":"撤销账目","entry.menu.confirm.delete":"确认删除该项目吗？","entry.menu.delete.tips":"确定要删除这个账目吗?","entry.menu.success.approve":"成功审核了账目","entry.menu.success.archive":"成功归档了账目","entry.menu.success.revoke":"成功撤销了账目","entry.menu.success.unarchive":"成功取消归档了账目","entry.menu.title":"记账菜单","entry.menu.title.delete":"删除账目","event.all.day.tips":"（全天）","event.confirm.addMember.description":"这是一个重复日程。请问需要将参与者添加到哪些日程中？","event.confirm.addMember.title":"添加参与者","event.confirm.archive.description":"这是一个重复日程。请问需要归档哪些日程？","event.confirm.archive.title":"归档日程","event.confirm.btn.all":"所有日程","event.confirm.btn.current":"当前日程","event.confirm.btn.next":"后续日程","event.confirm.btn.ok":"确定","event.confirm.delete.description":"这是一个重复日程。请问需要删除哪些日程？","event.confirm.delete.title":"删除日程","event.confirm.removeMember.description":"这是一个重复日程。请问需要将参与者从哪些日程移除？","event.confirm.removeMember.title":"移除参与者","event.confirm.update.description":"这是一个重复日程。请问需要将修改保存到哪些日程中？","event.confirm.update.following":"后续日程，此日程及其相关的所有后续日程均会发生更改","event.confirm.update.single":"仅此日程，该系列中的其他所有日程都将保持不变","event.confirm.update.title":"更新重复日程","event.confirm.updateMember.description":"这是一个重复日程。请问需要将参与者更新到哪些日程？","event.confirm.updateMember.title":"更新参与者","event.confirm.updateRepeat.description":"需要将重复规则更新到后续所有日程中？","event.confirm.updateRepeat.title":"更新重复规则","event.creator.all.day":"全天","event.creator.edit.tips":"编辑日程","event.creator.edit.title":"编辑日程","event.creator.end.time":"结束时间","event.creator.end.time.error":"时间格式不正确","event.creator.location.placeholder":"地点","event.creator.save.after":"更新今后","event.creator.save.single":"更新当前","event.creator.start.time":"开始时间","event.creator.tips_1":"添加日程到 ","event.creator.tips_2":"&empty;","event.creator.title.placeholder":"日程标题","event.detail.appearin.tips":"进入 Appearin 视频会议（最多 8 人）","event.detail.archived":"日程已归档，不可修改","event.detail.end.date.tips":"结束时间","event.detail.start.date.tips":"开始时间","event.fork.hint":"参与者和评论不会被复制到新日程","event.menu.confirm.delete":"确认删除日程？","event.menu.copy":"复制日程","event.menu.delete.title":"删除日程","event.menu.edit":"编辑日程","event.menu.fork.fail":"日程复制失败","event.menu.fork.success":"成功复制日程：","event.menu.move":"移动日程","event.menu.move.fail":"日程移动失败","event.menu.move.success":"成功移动日程：","event.menu.title":"日程菜单","event.move.hint":"跨项目移动时，部分参与者信息不会保留","event.placeholder":"目前还没有日程","event.time.picker.placeholder":"输入时间","events.add":"添加日程","events.no.event":"无日程安排","events.past":"过去的日程","events.placeholder":"添加新日程，安排会议或其他活动，添加参与者即可通知其他成员参加。","favorites.all":"所有收藏","favorites.deleted":" 已删除","favorites.invisible":"不可见","favorites.new":"已更新","favorites.not.visible":"无法打开，已删除或没有权限","favorites.placeholder":"当前还没有收藏<br/>你可以收藏有价值的任务、日程、分享、文件和账目。",
"favorites.search":"搜索我的收藏","favorites.unfavorite.success":"取消收藏成功","favorites.update.success":"更新成功","favorites.updated":"已有新内容，点击更新","flagged.projects":"星标项目","fork.to.other.project":"复制到其它项目","future.events":"未来的日程","globalGuide.prefession.goonfree":"继续使用免费版","globalGuide.prefession.paynow":"为专业版续费","globalGuide.profession.account.tip":"专业版已经到期，请续费后继续使用专业版提供的丰富应用与插件及其他功能升级。<br/><br/><span class='star'>*</span> 如选择使用免费版，您的所有数据将不会受到影响，仅升级部分功能无法使用。","globalGuide.version.profession.overdue":"专业版已到期","guide.create.project7.btn":"好的","guide.feature.link.folder.content":"你可以关联整个文件夹，当文件夹内容有更新时都可以接收到动态提醒","guide.feature.link.folder.done":"我知道了","helper.shortcuts":"快捷键","helper.shortcuts.for.board":"任务板的快捷键","helper.shortcuts.for.board.new":"创建新任务","helper.shortcuts.for.event":"日程表的快捷键","helper.shortcuts.for.event.new":"创建新日程","helper.shortcuts.for.global":"全局快捷键","helper.shortcuts.for.global.inbox":"打开收件箱","helper.shortcuts.for.global.myboard":"进入我的控制台","helper.shortcuts.for.global.portal":"回到所有项目","helper.shortcuts.for.global.search":"打开搜索","helper.shortcuts.for.inbox":"通知的快捷键","helper.shortcuts.for.inbox.next":"下一条信息","helper.shortcuts.for.inbox.previous":"上一条信息","helper.shortcuts.for.markdown":"打开Markdown语法帮助","helper.shortcuts.for.taskgroup":"打开任务分组面板","helper.shortcuts.for.wall":"分享墙的快捷键","helper.shortcuts.for.wall.new":"创建新分享","html5audio.not.support":"您的浏览器不支持该音频播放","html5video.not.support":"您的浏览器不支持该视频播放","iCalendar.howto":"查看如何使用","iCalendar.msg1":"手机端：扫描左侧二维码，获取「%s」的订阅链接（不支持微信扫码，请使用其他应用）","iCalendar.msg2":"电脑端：点击以下链接直接订阅「%s」，或将链接复制到日历软件中手动订阅","iCalendar.reset":"重新生成订阅链接","iCalendar.title":"订阅「%s」","inbox.all.message":"通知","inbox.at.me":"[有人@我]","inbox.ated.empty.tip1":"项目内容更新时","inbox.ated.empty.tip2":"你就会在这里收到@你的通知提醒","inbox.clear.messages":"清空已读消息","inbox.clear.messages.desc":"确定要清空所有已读消息吗？","inbox.delete.message":"删除信息","inbox.go.to.entry":"前往记账","inbox.go.to.event":"前往日程表","inbox.go.to.organization":"前往企业：","inbox.go.to.post":"前往分享墙","inbox.go.to.project":"前往项目：","inbox.go.to.task":"前往任务板","inbox.later.empty.tip1":"项目内容更新时","inbox.later.empty.tip2":"你就会在这里收到稍后处理的通知提醒","inbox.later.message":"稍后处理","inbox.later.message.cancel":"取消稍后处理","inbox.message.snoozed.time.picker":"%s后处理","inbox.my.mention":"仅@我的通知","inbox.normal.empty.tip1":"项目内容更新时","inbox.normal.empty.tip2":"你就会在这里收到通知提醒","inbox.preference":"提醒设置","inbox.read.messages":"标记全部已读","integration.placeholder":"抱歉, %s暂无内容","integrations.processon.search.hint":"搜索 ProcessOn 文件","integrations.processon.search.no.result":"无搜索结果","international.inner.title":"中国大陆服务器","international.outer.title":"国际服务器","international.tip.inner.description":"查看存放在中国大陆服务器的数据，在中国境内访问更快。","international.tip.inner.switch":"切换至中国大陆服务器","international.tip.outer.description":"为在海外使用访问更稳定，推荐将数据建立在 Teambition 国际服务器。","international.tip.outer.switch":"切换至国际服务器","jinshuju.data.serial_number":"%s 号数据","jinshuju.detail.search.placeholder":"输入数据序号","jinshuju.entries.search.empty.hint":"无查询结果","jinshuju.form.detail.closed.hint":"目前没有收集到数据。","jinshuju.form.detail.createDate.des":"该表单创建于 %s","jinshuju.form.detail.header":"你可以选择关联以下表单选择","jinshuju.form.detail.hint":"用于查看该数据的详细情况。你可以在金数据后台表单数据中找到对应序号。如需关联多个数据，请用逗号分割。","jinshuju.form.detail.title":"单个数据详情","jinshuju.form.normal.closed.hint":"已手动停止收集, 你需要先开启表单。","jinshuju.form.normal.hint":"关联后，可从关联直接打开表单填写页面。","jinshuju.form.normal.title":"表单填写页","jinshuju.form.result.closed.hint":"您需要先将结果分享设为公开或加密。","jinshuju.form.result.hint":"关联后，可通过关联打开结果分享页面。","jinshuju.form.result.title":"结果分享页","jinshuju.form.search.closed.hint":"您需要先将对外查询设为公开或加密。","jinshuju.form.search.hint":"关联后，可通过关联打开查询页面。","jinshuju.form.search.title":"对外查询页","jinshuju.form.status.semantization":"%s，%s。目前收集到 %s 份数据。","jinshuju.form.title":"《%s》","jinshuju.open.rule.closed.des":"已手动停止收集","jinshuju.open.rule.open.des":"已开启，正在收集","jinshuju.permission.login.des":"仅限金数据用户填写","jinshuju.permission.password.des":"凭密码填写","jinshuju.permission.private.des":"仅我和表单管理员、数据维护员可填","jinshuju.permission.public.des":"所有人可填","jinshuju.rating":"%s星","jinshuju.refresh.token.hint":"金数据授权已过期","language.label":"语言","leave.page.alert":"你所编辑的内容尚未保存","library.and":"和 ","library.author":"创建者","library.collections.count":"%s 个文件夹","library.copy":"复制","library.create.folder":"创建文件夹","library.default.collection":"讨论的附件","library.download":"下载","library.file.update":"更新","library.files.zipname":"%s等%s项_teambition","library.fork.to":"复制 %s 至","library.move":"移动","library.move.to":"移动 %s 至","library.name":"名称","library.placeholder":"文件夹中还没有内容哦","library.placeholder.no.create":"你可以创建文件夹或上传文件","library.size":"大小","library.success.forkTo":"成功复制 %1 至 %2","library.success.moveTo":"成功移动 %1 至 %2","library.title":"文件库","library.update":"更新时间","library.upload.file":"上传文件","library.works.count":"%s 个文件","link.add":"关联内容","link.collection.permission.error":"您没有访问该项目的权限，无法查看文件夹","link.collection.preview.error":"该项目文件已关闭，无法查看文件夹","link.confirm.delete":"确认希望永久删除这个关联？","link.delete":"取消关联","link.delete.fail":"删除失败，请重试","link.delete.success":"删除成功","link.event.title":"关联的日程","link.evernote.title":"Evernote","link.file.title":"关联的文件","link.github.title":"Github","link.jinshuju.title":"金数据","link.menu.title":"关联菜单","link.post.title":"关联的分享","link.task.title":"关联的任务","link.weibo.title":"关联的微博","markdown.helper.A":"链接","markdown.helper.H1":"一级标题","markdown.helper.H2":"二级标题","markdown.helper.H3":"三级标题","markdown.helper.H4":"四级标题","markdown.helper.blank.spaces":"4个空格","markdown.helper.blockquote":"区块引用","markdown.helper.code":"行内代码","markdown.helper.em":"斜体","markdown.helper.hr":"分割线","markdown.helper.img":"图片","markdown.helper.indentation":"缩进","markdown.helper.more.syntax":"· 更多语法请参考：<a href='http://wowubuntu.com/markdown/' target='_blank'>Markdown语法说明</a>","markdown.helper.ol1":"有序列标记1","markdown.helper.ol2":"有序列标记2","markdown.helper.ol3":"有序列标记3","markdown.helper.placeholder":"输入Markdown文档","markdown.helper.pre":"形成代码区块","markdown.helper.preview":"预览","markdown.helper.strong":"粗体","markdown.helper.syntax":"语法","markdown.helper.title":"Markdown","markdown.helper.try":" · 试一试 Markdown！","markdown.helper.ul1":"无序列标记1","markdown.helper.ul2":"无序列标记2","member.bar.input":"搜索成员，或输入邮箱直接邀请","member.bar.title":"项目成员","member.card.detail":"查看成员详情","member.card.inactive.init.password":'帐户待激活，<a class="resend-handler">重发邀请</a>。初始密码：',"member.card.role.setting":"项目权限设置","member.card.submenu.title":"项目权限设置","member.card.task.organization":"企业任务","member.card.task.project":"项目任务","member.finder.sendInvitationMailTo":"发送邀请邮件给：","member.finder.unregistered.phone":"该手机号未被注册","member.info":"个人信息","member.involve":"参与者","member.involve.add":"添加参与者","member.involve.none":"暂无参与者","member.involve.tip":"参与者将会收到评论和任务更新通知","member.menu.all":"所有成员","member.menu.search":"查找成员","member.progress.title.organization":"企业成员数量 · %s/%s","member.progress.title.project":"项目成员数量 · %s/%s","member.remove.from.team":"将成员从部门移除","member.tasks.future.tasks":"未来","member.tasks.recent.tasks":"近期","member.tasks.today.tasks":"今天","memberlatest.actived":"最后登录于 %s","members.manager.add.member":"添加成员","members.manager.all.members":"所有成员","members.manager.new.members":"新加入的成员","members.manager.unassigned.members":"未分配部门的成员","message.system.activity.entry.remove":"无法查看该账目详情","message.system.activity.event.remove":"无法查看该日程详情","message.system.activity.organization.invite.members":"你可以查看该企业所有内容","message.system.activity.organization.remove":"无法查看该企业内容","message.system.activity.organization.remove.member":"无法查看该企业内容","message.system.activity.post.remove":"无法查看该分享详情","message.system.activity.project.archive":"无法查看该项目内容","message.system.activity.project.invite.members":"你可以查看该项目所有内容","message.system.activity.project.remove":"无法查看该项目内容","message.system.activity.project.remove.member":"无法查看该项目内容","message.system.activity.project.unarchive":"你可以查看该项目所有内容","message.system.activity.task.remove":"无法查看该任务详情","message.system.activity.work.remove":"无法查看该文件详情","moment.MMMMYYYY":"YYYY年MM月","more.operations":"更多操作","move.to.other.project":"移动到其它项目","my.btn.personal":"编辑个人资料","my.btn.settings":"设置","my.events":"日程","my.favorites":"收藏","my.notes":"笔记","my.post":"我的分享","my.projects":"个人项目","my.recent":"近期的事","my.recent.today":"今天的事","my.recent.tomorrow":"明天的事","my.recent.week":"最近5天的事","my.task.created":"创建的任务","my.task.dateByAll":"全部","my.task.dateByLastMonth":"最近一个月","my.task.dateByLastTwoWeek":"最近两个星期","my.task.dateByLastWeek":"最近一个星期","my.task.dateByToday":"今天","my.task.dateByYesterday":"昨天","my.task.done":"完成的任务","my.task.joined":"参与的任务","my.task.sortByDueDate":"按截止时间排序","my.task.sortByPriority":"按时间优先排序","my.task.sortByProject":"按项目名称排序","my.task.undone":"未完成的任务","my.tasks":"任务","nav.menu.menu":"菜单","nav.menu.sortandfilter":"排序及筛选","navigation.account.personalCenter":"账号设置","navigation.create.organization":"创建企业","navigation.create.organization.try.now":"立即免费试用","navigation.enterBBS":"进入社区","navigation.event":"日程","navigation.organization":"企业","navigation.project":"项目","navigation.search":"搜索","navigation.sharing":"分享","navigation.task":"任务","navigation.work":"文件","new.ribbon":"新功能","noRight.view":"您没有权限查看链接的对象","note.collapse":"收起备忘","note.delete.confirm":"一旦删除笔记，将无法恢复","note.delete.confirm.title":"确认删除笔记","note.expand":"显示全部","note.placeholder":"当前还没有笔记<br />我的笔记内的内容，只有你自己才能看到。你可以在这里记录内容。","notes.input.note":"内容...","notes.input.title":"标题...","object.picker.event.creator.tips":"创建新日程","object.picker.event.title":"待参加的日程","object.picker.exceed.number":"一次最多选择 10 个关联对象！","object.picker.file.uploader.tips":"上传文件","object.picker.post.creator.tips":"创建新分享","object.picker.search.all":"按「回车」搜索全部","object.picker.task.creator.tips":"创建新任务","open.file":"打开","oragnization.team.order.title.child":"子部门排序","org.guide.next":"下一步","org.guide.team.create":"创建部门","org.reports.all.tips.create":"新增任务数量","org.reports.all.tips.delay":"逾期任务数量","org.reports.all.tips.done":"完成任务数量","org.reports.all.title":"企业整体报告","org.reports.arrowLeft":"上一周","org.reports.arrowRight":"下一周","org.reports.currentWeek":"本周","org.reports.rank.tips.delay":"逾期任务数量排行","org.reports.rank.tips.delayResult":"%s，<span>有%s项任务逾期</span>","org.reports.rank.tips.done":"任务完成数量排行","org.reports.rank.tips.doneResult":"%s，完成了%s项任务","org.reports.states.tips.title":"项目的状态更新","org.reports.tasks.tips.delay":"逾期的任务","org.reports.tasks.tips.done":"完成的任务","organization.avatarCrop.choose":"选择图片","organization.avatarCrop.edit.organization.avatar":"编辑组织头像","organization.avatarCrop.hint":"（最佳尺寸64&times;64，可以上传高质量图片进行裁剪）","organization.avatarCrop.preview":"图片预览","organization.buy.members":"购买成员名额","organization.buy.now":"立即续费","organization.buy.years":"购买年数","organization.check.order":"查看订单","organization.created.key":"创建时间","organization.current.members.limit":"，共 %s 个名额","organization.current.members.number":"%s 位企业成员","organization.current.members.unlimit":"，名额不限","organization.desc":"企业简介","organization.dueday":"%s天试用期","organization.email.sent30":"邮件已发送(30秒后可以重新发送)","organization.exclusive.consultant":"客户成功","organization.exclusive.consultant.mail":"邮箱：%s","organization.exclusive.consultant.phone":"电话：%s","organization.exclusive.consultant.service":"Teambition 用户顾问为你提供一对一专属服务","organization.expired.key":"到期时间","organization.expiring.btn.ok":"确定","organization.expiring.contact.owner":"企业「%s」即将到期，请联系企业拥有者续费。","organization.expiring.content":"企业「%s」即将到期，请尽快续费。","organization.expiring.go.pay.new":"立即购买","organization.expiring.go.pay.renew":"立即续费","organization.expiring.title":"企业即将到期","organization.guide.import.members":"导入成员","organization.guide.import.members.description":"将成员添加到企业，你就可以在企业里管理成员、构建部门、配置权限。我们还提供了企业周报和数据统计功能，助你了解企业成员的工作情况。","organization.guide.import.projects":"迁入项目","organization.guide.import.projects.description":"将个人项目迁入企业，你就可以使用企业版的报告和统计功能，把握项目全局动态，便于统筹管理。","organization.help.description1":"在 Teambition 上创建一个企业，把项目和成员加入其中，即可借助专业的企业功能来统筹管理项目进展和成员工作情况。","organization.help.header":"了解企业版","organization.learn.more":"详细了解企业版","organization.member":"企业成员","organization.member.add":"添加成员至企业","organization.member.assign.team":"添加到部门","organization.member.detail":"成员详情","organization.member.detail.organization":"企业成员详情","organization.member.detail.project":"项目成员详情","organization.member.exceed":"企业成员数达到上限","organization.member.exceed.description":"企业成员已满%s人，增加企业成员名额后可以邀请更多成员","organization.member.menu":"企业成员菜单","organization.member.remove":"从企业移除成员","organization.memberadd.allRecommendInvited":"为你推荐的用户均已加入本企业","organization.memberadd.batch.invite":"批量邀请","organization.memberadd.cooperatedMember":"合作过的成员","organization.memberadd.inviteText":"账号邀请","organization.memberadd.noMemberInviteSomeone":"现在企业中只有你一个，<br>你可以在此邀请你的小伙伴一起协作。","organization.memberadd.searchCantfind":"找不到<wbr>“%s”，<wbr>输入完整邮箱直接将其添加至企业","organization.memberadd.searchTip":"请输入邮箱/手机号","organization.memberadd.title":"添加成员至企业","organization.members.key":"成员数量","organization.name":"企业名称","organization.nav.members":"成员","organization.nav.projects":"项目","organization.nav.reports":"周报","organization.nav.statistics":"统计","organization.overdue":"企业版试用过期","organization.overdue.btn.ok":"确定","organization.overdue.contact":"该企业「%s」已经到期，请尽快续费或联系企业拥有者迁出项目。","organization.overdue.message":"该企业已经到期，请尽快续费。","organization.overdue.renew":"该企业「%s」已经到期，请尽快续费。","organization.overdue.title":"企业已到期","organization.paid":"正常使用","organization.paid.overdue":"已过期","organization.payment.buy":"购买企业版","organization.project.blank.description":"你可以按照部门或者按照季度目标来创建项目。每个项目你都可以配上美观的封面，让你的工作空间更加愉悦。","organization.project.blank.title":"创建项目","organization.projects":"企业项目","organization.report.blank.description":"一周之后会自动为你生成第一份企业周报，从全局了解企业各个项目的进展、成员的工作效率，以及任务完成的情况。","organization.report.blank.title":"企业周报","organization.setting.permission":"企业公开性","organization.setting.private":"私有企业（仅企业成员可见）","organization.setting.public":"公开企业（访客可以查看企业中的公开项目和成员）","organization.settings":"企业设置","organization.settings.add.member.toplimit":"增加企业成员名额","organization.settings.add.members.success":"成功添加 %s 位成员，已向他们发送邀请信","organization.settings.avatar":"企业头像","organization.settings.avatar.upload":"上传新头像","organization.settings.avatar.upload.failed":"更换组织头像失败","organization.settings.avatar.upload.success":"成功更换组织头像","organization.settings.button.delete":"删除","organization.settings.button.transfer":"移交","organization.settings.delete":"删除企业","organization.settings.delete.msg":"一旦你删除了企业，企业内所有项目、部门、成员，项目中所有内容等都将会被永久删除。这是一个不可恢复的操作，请谨慎对待！","organization.settings.delete.success":"成功删除企业","organization.settings.delete.title":"删除企业","organization.settings.desc.placeholder":"介绍一下这个企业","organization.settings.label.belonging":"企业归属","organization.settings.leave":"退出企业","organization.settings.leave.msg":"一旦你退出了该企业，你将不能查看任何关于该企业的信息。退出企业后，如果想重新加入，请联系企业的拥有者或者管理员。","organization.settings.leave.success":"已成功退出企业, 即将返回首页","organization.settings.leave.title":"退出企业","organization.settings.order.teams":"部门排序","organization.settings.roles.and.permissions":"查看权限表","organization.settings.roles.config":"配置权限","organization.settings.roles.onlyread":"查看权限","organization.settings.save.success":"保存成功","organization.settings.search.owner":"查找成员","organization.settings.select.owner":"选择企业拥有者","organization.settings.tab.consultant":"专属顾问","organization.settings.tab.infomation":"企业信息","organization.settings.tab.other":"更多","organization.settings.tab.pay":"付费信息","organization.settings.transfer":"移交企业","organization.settings.transfer.confirm":"确定移交","organization.settings.transfer.success":"企业移交成功","organization.settings.transfer.tips":"选择一个企业成员作为新的企业拥有者，移交后你的角色将变为成员","organization.settings.transfer.warning":"移交企业后，你将不再是企业拥有者，且移交操作不可撤销！","organization.settings.update.plan":"升级方案","organization.settings.upperLimit":"企业成员达到上限","organization.statistics.activeness":"活跃度","organization.statistics.blank.description":"Teambition 需要一周的时间统计第一份数据。企业统计功能将帮助管理者从项目、部门、成员等多个维度对企业状况进行分析。值得一提的是，这些数据在 App 上也可以实时查阅，随时随地都能了解进展、发现问题。","organization.statistics.blank.title":"企业统计","organization.statistics.chartMembers":"成员总数","organization.statistics.chartProjects":"项目总数","organization.statistics.count":"个","organization.statistics.going":"将到期","organization.statistics.membersAmount":"个成员","organization.statistics.membertab.all":"所有成员","organization.statistics.membertab.byDelayRate":"按任务逾期率","organization.statistics.membertab.byDoneRate":"按任务完成率","organization.statistics.membertab.done.undo":"已完成/总任务数","organization.statistics.membertab.name":"姓名","organization.statistics.membertab.new":"新成员","organization.statistics.membertab.noContent":"没有成员统计信息","organization.statistics.membertab.projectsJoined":"参与项目数","organization.statistics.membertab.title":"成员统计","organization.statistics.membertab.undergoing":"进行中的任务","organization.statistics.month":"月","organization.statistics.monthShow":"月","organization.statistics.none":"无","organization.statistics.overdue":"已逾期","organization.statistics.projectsAmount":"个项目","organization.statistics.projecttab.all":"所有项目分组","organization.statistics.projecttab.byActiveness":"按项目活跃度","organization.statistics.projecttab.byDelayRate":"按任务逾期率","organization.statistics.projecttab.byDoneRate":"按任务完成率","organization.statistics.projecttab.doneUndo":"已完成/总任务数","organization.statistics.projecttab.member":"成员","organization.statistics.projecttab.noContent":"无项目统计信息","organization.statistics.projecttab.project":"项目","organization.statistics.projecttab.title":"项目统计","organization.statistics.projecttab.undergoings":"进行中的任务","organization.statistics.projecttab.weeklyActiveness":"周活跃度","organization.statistics.projecttab.weeklyActivenessHint":"项目成员每周在项目中产生的内容","organization.statistics.searchMember":"搜索成员","organization.statistics.searchProject":"搜索项目","organization.statistics.searchResult":"搜索结果","organization.statistics.sorting":"排序","organization.statistics.undergoing":"进行中","organization.statistics.weeklyActiveness":"企业周活跃度","organization.statistics.weeklyActiveness.hint":"企业成员每周在所有项目产生的内容","organization.statistics.year":"年","organization.status.key":"企业状态","organization.switcher.intro.feature.permission":"部门：细分权限，批量管理","organization.switcher.intro.feature.statistics":"规模：更多人数，更大空间","organization.switcher.intro.feature.weekReport":"报告：量化汇总，驱动结果","organization.switcher.intro.title":"企业版高级功能","organization.team.order.title":"部门排序","organization.transfer.project.member.description":"已成功迁入%s个项目，同时添加项目成员到企业","organization.transfer.project.member.search.member":"搜索成员","organization.transfer.project.member.title":"添加项目成员到企业","organization.trial":"试用中","organization.trial.overdue":"试用结束","organization.visible":"企业可见","popover.search.current":"在当前项目里搜索 “%s”","popover.search.whole":"在所有项目里搜索 “%s”","portal.create.project":"创建新项目","portal.enter.organization.home.page":"企业首页","portal.project.notification":"这个项目有新的动态","portal.project.star.bookmark.hint":"请进入项目并使用%1來添加","portal.project.star.bookmark.hint.project":"请使用%1添加","portal.project.star.success":"星标成功，方便以后快速访问项目，可以<a class='show-bookmark-hint' data-gta='event' data-label='add-to-bookmark'>加入浏览器书签</a>","portal.project.un.star.success":"取消星标成功","portal.unarchive.error":"抱歉，我们未能重新激活该项目，请稍后重试.","portal.unarchive.project.description":"重新激活项目后，您就可以正常使用该项目了","portal.unarchive.project.title":"重新激活项目","portal.unarchive.success":"项目已经成功重新激活.","post.attachment.not.visible":"无法打开，已删除或没有权限","post.creator.markdown.tips":"该文档使用 Markdown，<a class='md-help-handler'>语法帮助</a>","post.creator.tips_1":"创建分享至 ","post.creator.tips_2":"&empty;","post.creator.title.placeholder":"输入文档标题","post.detail.archived":"分享已归档，不可修改","post.menu.confirm.delete":"确认删除分享？","post.menu.copy":"复制分享","post.menu.delete.title":"删除分享","post.menu.edit":"编辑分享","post.menu.fork.fail":"分享复制失败","post.menu.fork.global.hint":"参与者和评论不会被复制到新分享","post.menu.fork.success":"成功复制分享：","post.menu.move":"移动分享","post.menu.move.error.hint":"没有权限对分享中的附件进行操作","post.menu.move.error.title":"无法移动分享","post.menu.move.fail":"分享移动失败","post.menu.move.global.hint":"跨项目移动时，部分参与者信息不会保留","post.menu.move.success":"成功移动分享：","post.menu.pin.title":"置顶分享","post.menu.title":"分享菜单","post.menu.unpin.title":"取消置顶","post.placeholder":"目前还没有分享","post.un.title":"无标题","post.update":"更新分享","powerups.add.plugins":"开放平台添加更多插件","powerups.app.close":"关闭应用","powerups.app.close.btn":"确认关闭","powerups.app.confirm.close":"确认需要关闭在<b>%s</b>里的应用<b>%s</b>吗？","powerups.app.confirm.delete":"确认需要删除安装在<b>%s</b>里的应用<b>%s</b>吗？","powerups.app.delete":"删除应用","powerups.app.delete.btn":"确认删除","powerups.appearin.des":"日程表插件，支持最多8人的视频会议，远程办公也一样高效。","powerups.author":"由 %s 提供","powerups.bookkeeping":"记账","powerups.bookkeeping.des":"轻松记录项目每一笔开支。记账可以帮助管理者了解各项目下的收支明细，汇总所有的账目审批。","powerups.events":"日程","powerups.events.des":"日程表可以帮助你安排好你的一整天，与远程的同伴加入视频会议。","powerups.evernote.des":"根据项目需要，启用 Evernote，即可在任务、日程、分享等地方关联你的笔记。","powerups.github.des":"关联 Pull Request、Issue 或 Commits 上内容到 Teambition，在 Teambition 接受动态通知。","powerups.groupchat":"群聊","powerups.groupchat.des":"项目里的所有成员都可以在这里一起聊天，发送语音、图片，分享文件。自由地交流关于项目的各种信息。","powerups.item.close.plugin.tasklist":"关闭任务分组","powerups.item.detail.closed":"%s已关闭","powerups.item.detail.nav.apps.least":"请至少保留一个应用","powerups.item.detail.opened":"%s已开启","powerups.item.detail.tasklist.warning":"该项目中存在多个分组，请整理成一个分组再进行关闭操作","powerups.item.update.hint":"升级使用该插件","powerups.jinshuju":"金数据","powerups.jinshuju.des":"金数据一款操作简单且功能强大的在线表单设计和数据管理平台。通过模板或自定义创建表单，金数据自动为用户建立后端数据平台。","powerups.markdown":"Markdown","powerups.markdown.des":"使用 Markdown 格式撰写的文本，可以使用简单的符号编辑文本样式。在发布评论及任务备注时，支持使用 Markdown 。","powerups.modal.title.detail":"应用详情","powerups.posts":"分享","powerups.posts.des":"沟通想法，共享知识。分享墙帮助你随时与部门分享和讨论。支持添加图片、编辑文本格式和 Markdown。","powerups.powerup.groupApp":"项目应用","powerups.powerup.plugin":"功能插件","powerups.preciseDate":"任务精确时间","powerups.preciseDate.des":"启用后，任务将增加「设置精确时间」的选项，起止时间会同步出现在任务板。","powerups.processon.des":"ProcessOn 是一个在线协作绘图平台，为用户提供最强大、易用的作图工具！支持在线创作流程图、BPMN、UML 图、UI 界面原型设计、iOS 界面原型设计等。","powerups.shimo":"石墨文档","powerups.shimo.des":"第三方云端协同文档，一次关于发布分享的全新体验，授权账号后即刻体验，支持刷新同步完成文档的协同编辑。","powerups.startDate":"任务开始时间","powerups.startDate.des":"给任务设置开始时间，更有效地安排任务，更直观地了解任务进展情况。","powerups.taskUniqueId":"任务 ID","powerups.taskUniqueId.des":"启用后，每创建一个任务都自动产生一个唯一编号，方便成员之间沟通传递。","powerups.taskUniqueId.dialog.confirm":"确认开启","powerups.taskUniqueId.dialog.desc":"请先设置项目编号，编号将作为 ID 前缀，用以区别项目。支持字母，2-4位。","powerups.taskUniqueId.dialog.edit.confirm":"保存","powerups.taskUniqueId.dialog.edit.desc":"设置项目编号，编号将作为 ID 前缀，用以区别项目。支持字母，2-4位。","powerups.taskUniqueId.dialog.edit.title":"任务 ID 设置","powerups.taskUniqueId.dialog.placeholder":"如 Design Team 可以设置为 DT","powerups.taskUniqueId.dialog.submitting":"开启中...","powerups.taskUniqueId.dialog.title":"开启任务 ID","powerups.taskUniqueId.success.edit.tip":"修改任务前缀成功","powerups.taskUniqueId.success.tip":"任务 ID 已开启，请刷新页面后查看","powerups.tasklist":"任务分组","powerups.tasklist.des":"任务分组可以帮助你对任务版进行分类管理，特别适用于研发项目的开发周期迭代，一个市场活动的不同周期等。","powerups.tasks":"任务","powerups.tasks.des":"直观地了解每一个人的工作进展。在任务板上，你可以随时和成员开展讨论，针对每一个任务，你还可以分解子任务、上传附件、设定截止日期。","powerups.weibo":"微博","powerups.weibo.des":"根据项目需要，启用微博，即可在任务、日程、分享等地方关联任意一条微博。","powerups.works":"文件","powerups.works.des":"文件库相当于一个可协作的网盘。它支持图片、doc、PDF、xlsx、MP4 等多种常用文件的在线预览。同时，你可以随时更新文件版本，历史版本均会保存。","powerups.yinxiang.des":"根据项目需要，启用印象笔记，即可在任务、日程、分享等地方关联你的笔记。","powerups.yiqixie":"一起写文档","powerups.yiqixie.des":"第三方云端协同文档，可用于发布支持协同编辑的分享。与 Teambition 无缝整合，无需授权、关联账号，致力于给予极致的协作文档体验。","previewer.archived":"文件已归档，不可修改","previewer.confirm.delete":"确定要永远删除这个文件吗？","previewer.delete.file":"删除文件","previewer.download":"下载","previewer.download.file":"下载文件","previewer.edit":"编辑","previewer.enter.collection":"前往文件夹","previewer.file.deleted":"原文件已删除","previewer.file.translateFail":"文档转换失败了，无法直接预览","previewer.header.folder.tips":"所属文件夹","previewer.header.root.tips":"根目录","previewer.header.temp.tips":"临时目录","previewer.img.turn.left":"向左旋转","previewer.img.turn.right":"向右旋转","previewer.menu.confirm.delete":"确认永久删除该文件？","previewer.menu.delete.title":"删除文件","previewer.menu.title":"文件菜单","previewer.move":"移动","previewer.open":"打开","previewer.open.link":"打开链接","previewer.update":"更新","previewer.updating":"正在更新","priority.high":"紧急","priority.none":"普通","priority.urgent":"非常紧急","processon.cooperated":"与我协作的","processon.myFiles":"我的文件","processon.recent":"最近修改","profession.expired":"专业版已到期","profession.setting.permission.hint":"专业版项目可配置项目管理员，","profession.warning.tip1":"专业版已经到期，请续费后继续使用专业版提供的丰富应用与插件及其他升级功能。您可以联系该项目拥有者进行续费。","profession.warning.tip2":"专业版已经到期，请续费后继续使用专业版提供的丰富应用与插件及其他升级功能。<br/><br/><span class='star'>＊</span> 如选择使用免费版，您的所有数据将不会受到影响，仅升级部分功能无法使用。","project.app.plugin.remove.essage":"插件已被移除","project.at.members.organization":"非项目成员","project.at.members.project":"项目成员","project.belonging.owner":"项目拥有者","project.create.section":"点击添加一个分组","project.creator.belongsTo":"项目归属","project.creator.create.project":"创建项目","project.creator.createFromTemplate":"从模板创建项目","project.creator.creating":"创建中...","project.creator.doneAndCreate":"完成并创建","project.creator.fillTemplate":"完善项目信息","project.creator.intro":"为不同的事务建立各自的项目","project.creator.me":"我","project.creator.nextStep":"下一步","project.creator.owner":"拥有者","project.creator.porject.name.placeholder":"项目名称","project.creator.section":"项目分组","project.creator.teamplate.create":"创建并进入项目","project.creator.teamplate.intro":"正在从模板<span class='template-name'>%s</span>创建新项目","project.creator.template.failed":"模板创建失败，请稍候再试","project.creator.template.feedback":"建议与反馈","project.desc":"项目简介","project.grouping":"项目分组","project.logoCrop.best.size.hint":"（最佳图片比例2:1, 可以上传高质量图片进行裁剪）","project.logoCrop.choose":"选择图片","project.logoCrop.desktop.logo":"桌面端项目封面","project.logoCrop.mobile.logo":"移动端项目封面","project.logoCrop.previews":"图片预览","project.logoCrop.set.project.logo":"编辑项目封面","project.manager.enter":"查看项目","project.manager.filter":"筛选和排序","project.manager.join":"马上加入","project.manager.joining":"加入中...","project.manager.not.member":"你不是这个项目的成员","project.manager.sort.by.name":"按名称排序","project.manager.success.join":"成功加入","project.member":"项目成员","project.memberadd.add":"添加","project.memberadd.addMembersByLink":"通过链接邀请","project.memberadd.addRepetitive":"%s 已是项目成员","project.memberadd.addSuccess":"成功添加成员，已向 %s 发送邀请信","project.memberadd.added":"已加入","project.memberadd.allRecommendInvited":"为你推荐的用户均已加入本项目","project.memberadd.cooperatedMember":"合作过的成员","project.memberadd.header.title":"邀请新成员","project.memberadd.import":"同步","project.memberadd.imported":"已同步","project.memberadd.inviteViaAccount":"帐号邀请","project.memberadd.noMemberInviteSomeone":"现在项目中只有你一个，<br>你可以在此邀请你的小伙伴一起协作。","project.memberadd.orgMember":"企业成员","project.memberadd.orgTeam":"企业部门","project.memberadd.placeholder":"请输入邮箱或手机号，回车确认","project.memberadd.placeholderForOrg":"请输入企业成员/部门名称，或邮箱/手机号","project.memberadd.searchCantfind":"找不到<wbr>“%s”，<wbr>输入完整邮箱直接将其添加至项目","project.menu.copy.fail":"项目复制失败","project.menu.copy.success":"成功复制项目：","project.menu.mail.content":"%s 邀请你查看来自 Teambition 的公开项目「%s」。链接是：%s","project.menu.mail.content.desc":"%s 邀请你查看来自 Teambition 的公开项目「%s」。这个项目是关于 “%s”。链接是：%s","project.menu.mail.title":"分享公开项目 “%s”","project.menu.share.link":"分享链接","project.menu.share.to":"分享到","project.menu.share.to.mail":"通过邮件分享","project.menu.share.to.weibo":"分享到微博","project.menu.weibo.content":"我在 Teambition 上发现了一个有用的公开项目「%s」。","project.menu.weibo.content.desc":"我在 Teambition 上发现了一个有用的公开项目「%s」。这个项目是关于 “%s”。","project.name":"项目名称","project.none.section":"未选择分组","project.owner.search":"查找企业或成员","project.panel.activity.project.add.team.and.members":" 添加了企业部门及部门成员:","project.panel.activity.project.archive":" 归档了项目","project.panel.activity.project.archive.collection":" 归档了文件夹:","project.panel.activity.project.archive.entry":" 归档了记账:","project.panel.activity.project.archive.event":" 归档了日程: %s","project.panel.activity.project.archive.post":" 归档了分享:","project.panel.activity.project.archive.tag":" 归档了标签:","project.panel.activity.project.archive.task":" 归档了任务:","project.panel.activity.project.archive.tasklist":" 归档了任务分组:","project.panel.activity.project.archive.work":" 归档了文件:","project.panel.activity.project.create.collection":" 创建了文件夹:","project.panel.activity.project.create.entry":" 创建了记账:","project.panel.activity.project.create.event":" 创建了日程: %s","project.panel.activity.project.create.post":" 创建了分享:","project.panel.activity.project.create.tag":" 创建了标签:","project.panel.activity.project.create.task":" 创建了任务:","project.panel.activity.project.create.tasklist":" 创建了任务分组:","project.panel.activity.project.create.works":" 上传了文件:","project.panel.activity.project.disable.application":" 关闭了应用:","project.panel.activity.project.disable.plugin":" 关闭了插件:","project.panel.activity.project.enable.application":" 打开了应用:","project.panel.activity.project.enable.plugin":" 打开了插件:","project.panel.activity.project.finish.task":" 完成了任务:","project.panel.activity.project.invite.members":" 邀请 %s 加入项目","project.panel.activity.project.join.as.organization.owner":" 作为企业拥有者加入项目","project.panel.activity.project.join.from.invite.link":" 通过项目链接加入项目","project.panel.activity.project.join.from.qrcode":" 通过二维码加入项目","project.panel.activity.project.join.from.user.invite.link":" 通过 %s 分享的邀请链接加入项目","project.panel.activity.project.join.from.user.qrcode":" 通过 %s 分享的二维码加入项目","project.panel.activity.project.join.from.weixin":" 通过微信平台加入项目","project.panel.activity.project.redo.task":" 重做了任务:","project.panel.activity.project.remove":" 删除了项目","project.panel.activity.project.remove.collection":" 删除了文件夹:","project.panel.activity.project.remove.entry":" 删除了记账:","project.panel.activity.project.remove.event":" 删除了日程: %s","project.panel.activity.project.remove.member":" 移除了成员:","project.panel.activity.project.remove.post":" 删除了分享:","project.panel.activity.project.remove.self":" 退出了项目","project.panel.activity.project.remove.tag":" 删除了标签:","project.panel.activity.project.remove.task":" 删除了任务:","project.panel.activity.project.remove.tasklist":" 删除了任务分组:","project.panel.activity.project.remove.team":" 移除了企业部门 %s，但保留部门成员","project.panel.activity.project.remove.team.and.members":" 移除了企业部门及部门成员:","project.panel.activity.project.remove.work":" 删除了文件:","project.panel.activity.project.transfer.to.organization":" 将项目移交给企业","project.panel.activity.project.transfer.to.user":" 将项目移交给用户","project.panel.activity.project.unarchive":" 取消归档了项目","project.panel.activity.project.unarchive.collection":" 取消归档了文件夹:","project.panel.activity.project.unarchive.entry":" 取消归档了记账:","project.panel.activity.project.unarchive.event":" 取消归档了日程: %s","project.panel.activity.project.unarchive.post":" 取消归档了分享:","project.panel.activity.project.unarchive.tag":" 取消归档了标签:","project.panel.activity.project.unarchive.task":" 取消归档了任务:","project.panel.activity.project.unarchive.tasklist":" 取消归档了任务分组:","project.panel.activity.project.unarchive.work":" 取消归档了文件:","project.panel.activity.project.update.description":" 修改了项目简介:","project.panel.activity.project.update.logo":" 更新了项目封面","project.panel.activity.project.update.name":" 修改了项目名称:","project.panel.activity.project.update.visibility":" 将项目设置为","project.panel.entry.income":"收入 ¥ %s","project.panel.entry.outcome":"支出 ¥ %s","project.remove.team.remain.members":"移除部门，但部门成员仍然留在项目内","project.remove.team.remove.members":"移除部门，并将部门成员从项目移除","project.search":"搜索项目","project.section.down":"下移分组","project.section.name":"新分组名称","project.section.remove":"取消分组","project.section.up":"上移分组","project.select.list.hint":"请选择一个项目","project.setting.defaultrole.help":'项目所在企业的拥有者可新增管理自定义角色，<a class="link-add-handler" href="/applications/permissions/%s" target="_blank">查看权限表</a>',"project.setting.defaultrole.tips":"每添加一个项目成员，该成员权限默认被设置为：","project.setting.handler.transfer":"移交","project.setting.members.exceed.limit":"成员数超出限制","project.setting.members.reach.limit":"成员数已达上限","project.setting.nav.hint":"拖动图标排序。你可以前往<a class='open-powerups'>项目菜单－应用与插件</a>打开或关闭应用。","project.setting.notification.accept":"推送动态提醒（显示标记并以桌面通知的方式进行推送）","project.setting.notification.reject":"不推送动态提醒（只显示标记）","project.setting.notification.tips":"当该项目里有新动态时，以标记或通知的方式提醒，仅对个人","project.setting.notification.title":"项目动态提醒","project.setting.permission.hint":"免费版项目不支持配置权限，","project.setting.reset.error":"重置链接失败，请重试","project.setting.reset.invite":"重置邀请链接后，原链接失效",
"project.setting.transfer.and.quit":"您需要指定一名新的拥有者才能退出该项目","project.setting.visibility.all":"公开项目","project.setting.visibility.info.all":"所有人都可通过链接访问，仅项目成员可编辑","project.setting.visibility.info.organization":"企业内所有成员可见，仅项目成员可编辑","project.setting.visibility.info.project":"仅项目成员可查看和编辑","project.setting.visibility.organization":"企业项目","project.setting.visibility.project":"私有项目","project.settings":"项目设置","project.settings.add.member.repetitive":"%s 已是项目成员","project.settings.add.member.success":"成功添加成员，已向 %s 发送邀请信","project.settings.add.member.through.url.or.qrcode":"扫描二维码加入项目或分享项目链接邀请成员","project.settings.add.member.through.url.or.tip1":"有效日期:","project.settings.add.members.by.emails":"批量邀请","project.settings.archive":"归档","project.settings.archive.error":"未能归档项目，请稍后再试","project.settings.archive.msg":"如果项目已经完成或是暂时中止，你可以先将项目归档。归档的项目可以很容易地再次激活，并且不会有数据丢失","project.settings.archive.success":"已成功归档项目，你可以在首页的底部找到所有已归档的项目","project.settings.button.delete":"删除","project.settings.button.upload.cover":"上传新封面","project.settings.cannot.quit":"无法退出项目","project.settings.cannot.quit.content":"您已作为部门加入项目，不能单独退出","project.settings.cannot.remove":"该成员作为部门加入项目，不能单独移除","project.settings.delete":"删除项目","project.settings.delete.msg":"一旦你删除了项目，所有与项目有关的信息将会被永久删除。这是一个不可恢复的操作，请谨慎对待！","project.settings.delete.success":"已成功删除项目","project.settings.desc.placeholder":"介绍一下这个项目","project.settings.email.sent30":"邮件已发送(30秒后可以重新发送)","project.settings.label.actions":"项目操作","project.settings.label.permission":"新成员默认权限","project.settings.label.project.cover":"项目封面","project.settings.label.sort":"应用排序","project.settings.label.subtitle.actions":"您可以执行以下操作","project.settings.leave":"退出","project.settings.leave.msg":"一旦你退出了该项目，你将不能查看任何关于该项目的信息。退出项目后，如果想重新加入，请联系项目管理员。","project.settings.leave.success":"已成功退出项目","project.settings.logo.crop.image.size.too.large":"图片文件过大，请选择4MB以内的文件!","project.settings.logo.upload.failed":"更换项目封面失败","project.settings.logo.upload.success":"成功更换项目封面","project.settings.member.menu":"成员菜单","project.settings.member.menu.set.role":"新增或管理权限角色","project.settings.member.menu.upgrade.button":"升级获得更多权限角色","project.settings.member.menu.upgrade.description":"管理员、拥有者、自定义权限","project.settings.member.reach.limit":"项目当前成员容量为%s人，升级后可邀请更多成员","project.settings.member.reach.limit.org":"项目当前成员容量为%s人，增加企业成员名额后即可邀请更多成员","project.settings.no.exist.warn":"该项目未能成功转移, 请尝试刷新网页然后重试","project.settings.no.right.warn":"您没有转移该项目的权限","project.settings.over.plan.warn":"请升级新拥有者的项目套餐然后再重试","project.settings.placeholder":"请输入“DELETE”以确认","project.settings.remove.member":"移除成员","project.settings.resend":"重发邀请信（初始密码 %s）","project.settings.save.success":"保存成功","project.settings.select.owner":"请选择新的拥有者","project.settings.tab.activity":"动态推送","project.settings.tab.infomation":"项目信息","project.settings.tab.more":"更多","project.settings.tab.preference":"项目偏好","project.settings.transfer":"移交项目","project.settings.transfer.confirm":"确定移交","project.settings.transfer.members.exceed.2org":"目标企业的项目成员名额为%s人，小于当前项目成员数。请联系企业拥有者增加成员名额，或减少当前项目成员数。","project.settings.transfer.members.exceed.2user":"目标个人的项目成员名额为%s人，小于当前项目成员数。请联系他增加成员名额，或减少当前项目成员数。","project.settings.transfer.roles.change.1":"移交项目后，您将不再是项目拥有者!","project.settings.transfer.roles.change.2":"移交项目后，您将不再是项目拥有者。项目将不能再使用企业版相应功能!","project.settings.transfer.roles.change.3":"移交项目后，您将不再是项目拥有者。项目将不能配置管理员权限，不能继续使用更多丰富插件!","project.settings.transfer.success":"已成功移交项目","project.settings.visibility":"项目公开性","project.switcher.no.result":"抱歉，没有找到该项目","project.switcher.placeholder":"查找项目","project.tags":"标签","project.transfer.success":"迁移成功","project.transferring":"正在迁入","projects.export":"迁出项目","projects.import":"迁入项目","projects.manager.all.project":"所有项目","projects.transfer.to.organization":"迁入个人项目到企业","projects.transfer.to.organization.confirm":"确定迁入","projects.transferIn":"迁入项目","projects.transferIn.btn":"迁入","projects.transferIn.to":"迁入到 :","projects.transferOut":"迁出项目","projects.transferOut.btn":"迁出","projects.transferOut.to":"迁出到 :","quit.success":"退出部门成功","remind.add":"添加提醒","remind.ago":"%s前","remind.close":"关闭提醒","remind.happened":"开始时提醒","remove.success":"移除成功","repeat.add":"添加重复","repeat.description.daily":"每%1天重复","repeat.description.monthly":"每%1月 %2 日重复","repeat.description.weekly":"每%1周 %2 重复","repeat.freq.CUSTOM":"自定义重复","repeat.freq.DAILY":"每天重复","repeat.freq.MONTHLY":"每月重复","repeat.freq.NO":"不重复","repeat.freq.WEEKLY":"每周重复","repeat.freq.WORKDAY":"工作日重复","repeat.freq.YEARLY":"每年重复","repeat.interval":"间隔","resend.success":"发送成功","screen.crop":"截图","scrum.filter.clear":"清除筛选","scrum.filter.hide.done":"隐藏已完成任务","scrum.filter.search":"查找相关任务","scrum.filter.title":"任务筛选","scrum.filter.today.update":"今日更新","scrum.sort.created":"按创建时间排序","scrum.sort.custom":"默认排序（全员同步）","scrum.sort.duedate":"按截止时间排序","scrum.sort.in.save":"正在保存","scrum.sort.priority":"按优先级排序","scrum.sort.save":"保存为全员同步默认排序","scrum.sort.startdate":"按开始时间排序","scrum.sort.title":"任务排序","scrum.sortandfilter.title":"排序及筛选","search.archived":"已归档","search.no.content":"抱歉，没有更多","search.no.result":"抱歉，没有找到与 “%s” 相关的内容","search.placeholder":"快速搜索，查找你所需的内容","search.project":"所属项目","search.result.all.type":"所有类型","set.success":"设置成功","settings.no.permission":"您暂时没有权限修改该处设置。请联系拥有者操作。","simditor.add.link.title":"添加链接","simditor.alignCenter":"居中","simditor.alignLeft":"居左","simditor.alignRight":"居右","simditor.alignment":"水平对齐","simditor.blockquote":"引用","simditor.bold":"加粗文字","simditor.code":"插入代码","simditor.color":"文字颜色","simditor.coloredText":"彩色文字","simditor.deleteColumn":"删除列","simditor.deleteRow":"删除行","simditor.deleteTable":"删除表格","simditor.externalImage":"外链图片","simditor.hr":"分隔线","simditor.image":"插入图片","simditor.imageAlt":"图片描述","simditor.imageSize":"图片尺寸","simditor.imageUrl":"图片地址","simditor.indent":"向右缩进","simditor.insertColumnLeft":"在左边插入列","simditor.insertColumnRight":"在右边插入列","simditor.insertRowAbove":"在上面插入行","simditor.insertRowBelow":"在下面插入行","simditor.italic":"斜体文字","simditor.link":"插入链接","simditor.linkText":"链接文字","simditor.linkUrl":"链接地址","simditor.normalText":"普通文本","simditor.ol":"有序列表","simditor.outdent":"向左缩进","simditor.removeLink":"移除链接","simditor.restoreImageSize":"还原图片尺寸","simditor.selectLanguage":"选择程序语言","simditor.strikethrough":"删除线文字","simditor.table":"表格","simditor.text":"文本","simditor.title":"标题","simditor.ul":"无序列表","simditor.underline":"下划线文字","simditor.upload":"上传","simditor.uploadError":"上传出错了","simditor.uploadFailed":"上传失败了","simditor.uploadImage":"上传图片","simditor.uploading":"正在上传","stage.add.tip":"新建任务列表...","stage.edit.title":"添加或编辑任务列表","stage.menu.add.next.stage.title":"在此后添加新列表","stage.menu.add.stage.hint":"新列表将被添加在当前列表之后","stage.menu.add.title":"添加列表","stage.menu.archive.tasks.title":"归档本列表所有任务","stage.menu.cannot.delete":"请先清空此列表上的任务，然后再删除这个列表","stage.menu.confirm.archive.tasks":"您确定要归档这个列表下的所有任务吗","stage.menu.confirm.delete":"您确定要永远删除这个列表吗","stage.menu.date.picker":"设置本列表所有任务截止时间","stage.menu.date.picker.clear.success":"成功清除截止时间","stage.menu.date.picker.error":"截止时间与开始时间冲突","stage.menu.date.picker.success":"成功设置截止时间","stage.menu.date.picker.title":"选择截止时间","stage.menu.delete.title":"删除列表","stage.menu.edit.title":"编辑列表","stage.menu.lock.stage":"切换至流程模式","stage.menu.lock.stage.msg":"切换至流程模式后，该列表的任务会变成已完成状态，其它列表已完成的任务也会自动进入该列表，即形成了任务流程模式","stage.menu.move.tasks.success":"移动任务成功","stage.menu.move.tasks.title":"移动本列表所有任务","stage.menu.stage.name":"列表名称","stage.menu.title":"列表菜单","stage.menu.toggle.stage.tasks.executor":"设置本列表所有任务执行者","stage.menu.toggle.stage.tasks.executor.success":"成功设置执行者","stage.menu.toggle.stage.tasks.executor.title":"选择执行者","stage.menu.unlock.stage":"切换至自由模式","stage.menu.unlock.stage.msg":"切换至自由模式后，该列表后面可以新增加列表，各列表相互独立，即退出了任务流程模式","stage.selector.changed.tips":"分组信息已改变，请重新选择","stage.selector.tips":"你可以在任务板中添加和修改任务分组及任务列表。","stage.selector.title":"选择位置","submit.post":"立即发布","submit.ticket.chat.with.us":"专属顾问","submit.ticket.email":"请输入你的常用邮箱","submit.ticket.menu.online.classroom":"在线课堂","submit.ticket.menu.support":"帮助中心","submit.ticket.menu.video":"使用视频","submit.ticket.other":"其它意见","submit.ticket.pl.anything":"其他想说的话…","submit.ticket.pl.help":"输入反馈内容","submit.ticket.pl.suggestion":"你有什么建议吗？","submit.ticket.question":"向 Teambition 反馈问题","submit.ticket.send":"发送","submit.ticket.success":"谢谢您的反馈，我们会通过 %s 与您联系","submit.ticket.suggestion":"向 Teambition 提出建议","submit.ticket.title":"帮助","subtask.card.create.input.placeholder":"输入子任务内容...","subtask.card.create.placeholder":"添加子任务","subtask.menu.confirm.delete":"确认删除该子任务?","subtask.menu.confirm.transform":"确定转换该子任务为任务？","subtask.menu.delete.title":"删除子任务","subtask.menu.title":"子任务菜单","subtask.menu.transform.title":"转换为任务","tag.creator.placeholder":"标签名称","tag.creator.title":"新建标签","tag.creator.warning.name.exit":"标签名称已存在！","tag.menu.confirm.delete":"确认删除标签？","tag.menu.delete.title":"删除标签","tag.menu.edit.title":"编辑标签","tag.menu.title":"标签菜单","tag.picker.add":"添加标签","tag.picker.none":"暂无标签","tag.view.create":"新标签","tag.view.entry.info":"%s 个账目","tag.view.event.info":"%s 个日程","tag.view.file.info":"%s 个文件","tag.view.placeholder.info":"你可以通过“新标签”按钮来创建标签。此后，就可以在在这里按照标签来查看项目内容了。","tag.view.placeholder.infoLink":"我们准备了一些实用的标签用法，<a href='https://www.teambition.com/research/best-practices/article?p=research-best-practices&s=&_id=5439058462c0c4b62f57c23c' class='link-add-handler' target='_blank'>立即查看</a>。","tag.view.placeholder.title":"项目中还没有标签","tag.view.post.info":"%s 篇分享","tag.view.task.info":"%s 项任务","target.event.closed":"该项目日程已关闭","target.event.fork.post.denied":"无权限复制到该项目","target.event.move.post.denied":"无权限移动到该项目","target.post.closed":"该项目分享已关闭","target.post.fork.post.denied":"无权限复制到该项目","target.post.move.post.denied":"无权限移动到该项目","target.work.closed":"该项目文件已关闭","target.work.fork.post.denied":"无权限复制到该项目","target.work.move.post.denied":"无权限移动到该项目","task.creator.add":"添加任务","task.creator.content":"任务内容","task.creator.multiple":"创建多条任务","task.creator.multiple.all":"创建 %s 条","task.creator.multiple.desc":"系统检测到你输入了 %s 行内容，你是想创建多条任务吗？","task.creator.multiple.one":"创建一条","task.creator.multiple.too.many":"内容行数太多了","task.creator.multiple.too.many.confirm":"好吧，我知道了","task.creator.multiple.too.many.desc":"内容最多为 %s 行，你当前输入了 %s 行。","task.creator.set.duedate":"设置截止时间","task.creator.set.startdate":"设置开始时间","task.creator.tips":"创建新任务至","task.detail.add.note":"添加备注","task.detail.archived":"任务已归档，不可修改","task.detail.complete":"完成任务","task.detail.due.date":"截止时间","task.detail.executor":"执行者","task.detail.no.executor":"待认领","task.detail.priority":"优先级","task.detail.priority.info":"选择优先级","task.detail.redo":"重做此任务","task.detail.remind":"提醒","task.detail.repeat":"重复","task.detail.repeat.info":"选择重复周期","task.detail.setting.remind":"%s 设置为稍后提醒","task.detail.stage":"任务列表","task.detail.stage.unset":"未设置","task.detail.start.date":"开始时间","task.detail.tasklist":"任务分组","task.detail.time.click.set":"点击设置","task.dueDate.label":"%s 截止","task.group":"分组","task.group2":"任务分组","task.list.belong.to":"属于任务：%s","task.list.no.task":"本周无任务","task.menu.confirm.delete":"确认删除任务？","task.menu.copy":"复制任务","task.menu.copy.check.link":"原任务接收新任务的更新提醒","task.menu.copy.check.linked":"新任务接收原任务的更新提醒","task.menu.copy.fail":"任务复制失败","task.menu.copy.success":"成功复制任务：","task.menu.copy.tips":"标题、子任务、备注将被复制","task.menu.delete.title":"删除任务","task.menu.move":"移动任务","task.menu.move.fail":"任务移动失败","task.menu.move.success":"成功移动任务：","task.menu.move.tips":"跨项目移动时，部分参与者信息不会保留","task.menu.search.project":"查找项目","task.menu.select.group":"选择任务分组","task.menu.select.project":"选择项目","task.menu.select.stage":"选择列表","task.menu.title":"任务菜单","task.menu.warning":"请先选择项目分组和列表","task.placeholder":"目前还没有任务","task.recent.placeholder":"你还没有任务和日程","task.startDate.label":"%s 开始","task.viewl.authority.msg":"由执行者%s设置任务是否完成","tasklist.bar.add.group":"添加任务分组","tasklist.bar.done.tasks":"已完成的任务","tasklist.bar.member.tasks":"成员的任务","tasklist.bar.memberOf.tasks":"%1的任务","tasklist.bar.pin":"固定任务分组栏","tasklist.bar.search.group":"搜索分组","tasklist.bar.smart.group":"智能分组","tasklist.bar.today.tasks":"今天的任务","tasklist.bar.total.tasks":"未完成的任务","tasklist.bar.unassigned.tasks":"待认领的任务","tasklist.bar.unpin":"取消固定任务分组栏","tasklist.creator.new":"新建","tasklist.creator.submit":"创建","tasklist.creator.tasklist.desc":"任务分组描述","tasklist.creator.tasklist.title":"任务分组名称","tasklist.creator.temp":"模板","tasklist.dump.confirm":"确定导出","tasklist.dump.hint":"选择需要导出的任务分组","tasklist.menu.add.templates":"保存为任务分组模板","tasklist.menu.add.templates.desc":"你可以在（任务分组 &gt; 添加 &gt; 模板）中选择使用","tasklist.menu.add.templates.detail":"将当前任务列表保存为模板","tasklist.menu.add.templates.success":"添加 %s 成功","tasklist.menu.confirm.archive":"您确定要归档这个任务分组吗","tasklist.menu.confirm.delete":"此分组内所有阶段和任务将被全部删除。确定删除分组吗？","tasklist.menu.delete.title":"删除任务分组","tasklist.menu.edit.title":"编辑任务分组","tasklist.menu.last.cannot.edit":"抱歉，您不能归档或删除最后一个任务分组","tasklist.menu.tasklist.desc":"任务分组描述","tasklist.menu.tasklist.title":"任务分组名称","tasklist.menu.templates":"自定义模板","tasklist.menu.title":"分组菜单","tasklist.tab.status.done":"已完成","tasklist.tab.status.normal":"近期任务","tasklist.tab.status.overdue":"已逾期","tasklist.tab.status.upcoming":"将到期","tasklist.temp1stage1":"策划","tasklist.temp1stage2":"原型图","tasklist.temp1stage3":"效果图","tasklist.temp1stage4":"审核中","tasklist.temp1stage5":"完成","tasklist.temp1title":"设计","tasklist.temp2stage1":"需求点","tasklist.temp2stage2":"设计中","tasklist.temp2stage3":"研发中","tasklist.temp2stage4":"测试中","tasklist.temp2stage5":"已发布","tasklist.temp2title":"研发","tasklist.temp3stage1":"用户问题","tasklist.temp3stage2":"解决中","tasklist.temp3stage3":"已解决","tasklist.temp3stage4":"反馈用户&问题解决","tasklist.temp3title":"用户支持","tasks.no.task":"无任务安排","team.belongsTo":"隶属于：%s","team.create":"创建部门","team.create.placeholder":"部门名称","team.create.sub":"创建子部门","team.create.sub.placeholder":"子部门名称","team.create.success":"创建部门成功","team.detail":"部门详情","team.mananger.add":"添加到部门","team.mananger.quit":"退出","team.mananger.remove":"移除","team.manger.events":"日程安排","team.manger.no.member":"暂无成员","team.manger.no.project":"还没有参与任何项目","team.manger.project.confirm.remove":"确认移除该项目？","team.manger.project.confirm.title":"移除部门项目","team.manger.tasks":"任务安排","team.member.add":"添加成员至部门","team.member.menu":"部门成员菜单","team.member.remove":"从部门移除成员","team.member.remove.content":"将成员从部门移除后，该成员会自动退出该部门所在的项目","team.member.search.placeholder":"搜索%s","team.member.subteam":"子部门成员","team.member.team":"该部门成员","team.members.count":"%s 名成员","team.menu":"部门菜单","team.menu.confirm.delete":"删除部门会同时删除其子部门，部门中的成员不会被移出企业。","team.menu.delete.title":"删除部门","team.menu.edit.title":"编辑部门","team.name":"%s部门已加入以下项目。","team.projects":"部门项目","team.projects.add":"加入其他项目","team.projects.add.search":"搜索项目","team.projects.add.title":"将部门加入项目","teambition.title":"Teambition · 最好用的团队协作平台","teams.split":"、","this.stage":"这个列表","this.task":"这项任务","time.format.error":"时间格式不正确","time.input.placeholder":"输入时刻","time.setting.error":"截止时间与开始时间冲突","today.events":"今天的日程","token.expired":"会话过期，请重新","token.reauth":"重新授权","total.events.and.tasks":"共 %s 项","unarchived.entry.success":"记账已取消归档","unarchived.event.success":"日程已取消归档","unarchived.file.success":"文件已取消归档","unarchived.folder.success":"文件夹已取消归档","unarchived.post.success":"分享已取消归档","unarchived.tag.success":"标签已取消归档","unarchived.task.success":"任务已取消归档","unarchived.taskgroup.success":"任务分组已取消归档","unarchived.tasklist.tip":"该项目已关闭任务分组功能，请开启任务分组功能后再进行取消归档操作。","update.file":"更新","uploader.error":"文件上传失败","uploader.file.exceed":"文件超过最大限制","uploader.file.exceed.size":"文件 %s 过大，请选择 1GB 以内的文件！","uploader.file.exceed.size.default":"文件 %s 过大，请选择 10M 以内的文件！","uploader.file.exceed.size.free":"文件 %s 过大，请选择 200M 以内的文件！升级后可支持1G大小。","uploader.files.duplicate":"该文件已上传！","uploader.files.exceed.number":"最多一次性上传 %s 个文件！","uploader.not.accept":"不支持该文件类型或者文件大小为 0","uploader.type.no.allowed":"不支持该文件类型(.%s)，请压缩后上传","uploading.tip":"正在上传图片","user.satisfaction.bad":"完全不愿意","user.satisfaction.feedback.0":"感谢评价，你觉得 Teambition 在哪些地方不够好？","user.satisfaction.feedback.1":"感谢评价，你觉得 Teambition 还需要怎样改进？","user.satisfaction.feedback.2":"感谢评价，你最喜欢 Teambition 的哪些功能？","user.satisfaction.good":"非常愿意","user.satisfaction.placeholder":"写一些反馈...","user.satisfaction.recommend":"你有多大意愿向你的朋友推荐 Teambition?","user.satisfaction.send":"发送","user.settings.comment.notice":"评论提醒","user.settings.daily.mail.notice":"每日工作事项邮件提醒","user.settings.mobile":"移动端","user.settings.monthly.mail.notice":"月刊订阅","user.settings.notification.setting":"提醒设置","user.settings.participant.notice":"被添加参与者提醒","user.settings.preference.usePanelTitle":"在任务板中打开任务详情采用侧栏方式","user.settings.receive.event.notice":"收到『新日程』提醒","user.settings.receive.file.notice":"收到『新文件』提醒","user.settings.receive.post.notice":"收到『新分享』提醒","user.settings.receive.task.notice":"收到『新任务』提醒","user.settings.setting":"偏好设置","user.settings.task.file.update.notice":"任务，文件内容更新时提醒","visible.close":"已关闭","visible.mode":"隐私模式","visible.open":"已开启","visible.to.involve":"仅参与者可见","visible.to.member":"所有成员可见","wall.view.create.post":"添加分享","wall.view.html.post":"普通文档","wall.view.markdown.post":"Markdown 文档","wall.view.post.creator.info":"%s发布于","wall.view.post.order.create.time":"按发布时间排序","wall.view.post.order.reply.time":"按回复时间排序","wall.view.shimo.post":"石墨文档","wall.view.shimo.update":"刷新文档","wall.view.yiqixie.post":"一起写文档","wall.yiqixie.default.title":"一起写文档","week.selector.search":"搜索日期","weibo.menu1":"我关注的微博","weibo.menu2":"我发布的微博","weibo.menu3":"@我的微博","weibo.menu4":"好友圈微博","work.copy.message":"复制文件 %s 至","work.copy.success":"成功复制了文件","work.creator.info":"%s上传于","work.creator.tips":"上传文件到 ","work.edit.title":"文件名","work.menu.archive.file":"归档文件","work.menu.confirm.delete":"确定要永远删除这个文件吗","work.menu.copy.file":"复制文件","work.menu.delete.title":"删除文件","work.menu.move.file":"移动文件","work.menu.title":"文件菜单","work.move.message":"移动文件 %s 至","work.move.success":"成功移动了文件","work.move.title":"移动文件","work.picker.from.dropbox":"从Dropbox选择","work.picker.from.library":"从文件库选择","work.picker.from.link":"粘贴下载链接...","work.picker.title":"添加附件","work.picker.uploader":"直接上传","work.rename.title":"重命名","work.versions.current":"当前版本","work.versions.enter.edit":"编辑版本的描述信息","work.versions.title":"历史版本","works.background.uploader.close.confirm":"您有文件正在上传,确认关闭么?","works.background.uploader.close.confirm.title":"确认关闭","works.background.uploader.error":"文件上传失败","works.background.uploader.uploaded":"上传完成","works.background.uploader.uploading":"正在上传 %s/%s","works.uploader.uploading.total":"%s个文件正在上传..."}),n.setLocales("zh_tw",{"1day":"1 天","1hour":"1 小時","20mins":"20 分鐘","4hours":"4 小時",FRI:"五",MON:"一",SAT:"六",SUN:"日",THU:"四",TUE:"二",WED:"三",add:"添加",added:"已添加",all:"所有分享",archive:"歸檔",back:"返回",birthday:"生日",bookkeeping:"記賬",bound:"立即綁定",by:"by",calendar:"日歷",cancel:"取消",clickToEdit:"點擊即可編輯",close:"關閉",collapse:"收起",collection:"文件夾",colon:"：",comma:"，",confirm:"確定",connected:"網絡已連上，歡迎回來",copyAs:"復制為",copyTo:"復制到",create:"創建",creator:"創建者",day:"天","delete":"刪除",disconnected:"網絡有異常，請檢查網絡後再試",done:"完成",draft:"檢測到有未保存內容，是否恢復？",edit:"編輯",email:"郵箱",entries:"Entries",entry:"賬目",error:"對不起，出錯啦！",event:"日程",events:"日程",executor:"執行者",expand:"展開",favorite:"收藏",file:"文件",files:"文件",fullStop:"。",groupchat:"群聊",guest:"訪客",hide:"隱藏",inbox:"收件箱",language:"繁體中文",location:"地址",login:"登錄",logout:"退出登錄",manager:"管理員",me:"我",member:"成員",merge:"merge",mobile:"電話",month:"月",more:"更多",moveTo:"移動到",my:"我的",noRight:"您不能修改",none:"无",open:"開啓",organization:"企業",owner:"擁有者",plugin:"應用與插件",position:"職位",post:"分享",posts:"分享",project:"項目",projects:"項目","public":"公開",register:"注冊",remove:"移除",renew:"續費",repeat:"重復",reply:"回復",rmb:"元",save:"保存",search:"搜索",setting:"設置",show:"顯示",stage:"階段",tags:"標簽",task:"任務",tasklist:"任務分組",tasks:"任務",team:"部門",today:"今天",unarchive:"取消歸檔",unfavorite:"取消收藏",unknown:"未知",unknownDate:"未知日期",updated:"更新於",upgrade:"陞級",upload:"上傳",view:"查看",website:"網址",week:"周",works:"檔案","acitivity.timeline.notif.none.tip":"沒有人會收到通知","acitivity.timeline.notif.tip":"人將會收到通知","activity.card.body.checkMore":"查看更多","activity.card.create.headerTips":"創建了項目","activity.card.error.notFound":"沒有找到這個%s，或許已經被刪掉了。","activity.card.project.title":"任務統計","activity.card.table.doneTasks":"已完成","activity.card.table.placeholder":"最近項目進展情況","activity.card.table.title":"項目進展","activity.card.table.todoTasks":"未完成","activity.card.today.title":"今天的事","activity.card.unassigned.title":"待認領的任務","activity.comment.link.title":"关联内容","activity.destroyer.confirm.delete":"確認希望永久刪除這條動態？","activity.destroyer.delete":"刪除動態","activity.destroyer.delete.fail":"刪除失敗，請重試","activity.destroyer.delete.success":"刪除成功","activity.download.all.attachments":"下載附件","activity.early.hidden":"顯示更早的%s條評論","activity.early.loading":"正在載入更早的評論…","activity.early.shown":"隱藏較早的評論","activity.editor.error":"修改評論失敗了","activity.editor.place.holder":"編輯評論...","activity.editor.success":"成功修改了評論","activity.editor.title":"編輯評論","activity.invisible.not.involved.tip1":"該內容為僅參與者可見，%1 還不是參與者，將他 <a class='add-involve'>添加為參與者</a> 後，他將在%2有更新時收到通知。","activity.invisible.not.involved.tip2":"該內容為僅參與者可見，%1 還不是參與者，將他們 <a class='add-involve'>添加為參與者</a> 後，他將在%2有更新時收到通知。","activity.invisible.not.member.tip1":"該內容為僅參與者可見，你提及的 %s 尚未加入項目，但他會收到通知","activity.invisible.not.member.tip1.addmember":"，你也可以將他 <a class='add-member-involve'>加入項目並添加為參與者</a>。","activity.invisible.not.member.tip2":"該內容為僅參與者可見，你提及的 %s 等%s人尚未加入項目，但他們會收到通知","activity.invisible.not.member.tip2.addmember":"，你也可以將他們 <a class='add-member-involve'>加入項目並添加為參與者</a>。","activity.invisiblea.addmember.success":"已經將成員加入項目","activity.moreAttachments":"等","activity.moreFiles":"個文件","activity.panel.checkAll":"查看所有項目動態","activity.panel.filter.allMember":"所有成員","activity.panel.filter.allType":"所有類型","activity.panel.filter.date":"時間","activity.panel.filter.member":"成員","activity.panel.filter.system":"系統消息","activity.panel.filter.type":"類型","activity.panel.invite":"邀請新成員","activity.panel.menu.calendar":"訂閱項目內容至第三方日歷","activity.panel.menu.checkArchive":"查看歸檔","activity.panel.menu.config":"應用與插件","activity.panel.menu.copy":"復制項目","activity.panel.menu.enterOrg":"進入企業","activity.panel.menu.export.tasks":"匯出分組內所有任務","activity.panel.menu.share":"分享項目","activity.panel.placeholder.searchMember":"查找成員","activity.panel.title.activities":"項目動態","activity.panel.title.all":"項目菜單","activity.panel.weeker.all":"全部","activity.system.handlers.enterorg":"前往企业：%s","activity.system.handlers.enterproject":"前往项目：%s","activity.system.handlers.openchat":"前往私信：%s","activity.timeline.add.attachment":" 添加附件","activity.timeline.add.emoji":"添加表情","activity.timeline.comment":"@提及他人，按 Enter 快速發布","activity.timeline.comment.ghost":"<a class='login-handler'>登錄</a>或<a class='register-handler'>注冊</a>後可參與討論","activity.timeline.like":"點贊","activity.timeline.like.tips.long":"%s人贊了","activity.timeline.like.tips.short":"點個贊","activity.timeline.only.attachment":"僅附件","activity.timeline.only.comment":"僅評論","activity.timeline.remove.like":"取消點贊","activity.timeline.reply":"發布","activity.timeline.reply.enter":"按 Enter 發送消息","activity.timeline.reply.quickly.placeholder":"@提及他人，按 Ctrl+Enter 快速發布","activity.timeline.reply.shortcut":"按 Ctrl+Enter 發送消息","activity.visible.not.involved.tip1":"你提及的 %1 還不是參與者，將他 <a class='add-involve'>添加為參與者</a> 後，他將在%2有更新時收到通知。","activity.visible.not.involved.tip2":"你提及的 %1 等%2人還不是參與者，將他們 <a class='add-involve'>添加為參與者</a> 後，他們將在%3有更新時收到通知。","activity.visible.not.involved.tip3":"你還不是參與者，將你 <a class='add-involve'>添加為參與者</a> 後，你將在%s有更新時收到通知。","activity.visible.not.involved.tip4":"你和 %1 還不是參與者，將你們 <a class='add-involve'>添加為參與者</a> 後，你們將在%2有更新時收到通知。","activity.visible.not.member.tip1":"你提及的 %s 尚未加入項目，但他會收到通知","activity.visible.not.member.tip1.addmember":"，你也可以將他 <a class='add-member'>加入項目</a>。","activity.visible.not.member.tip2":"你提及的 %s 等%s人尚未加入項目，但他們會收到通知","activity.visible.not.member.tip2.addmember":"，你也可以將他們 <a class='add-member-involve'>加入項目</a>。","add.members.by.cooperated":"導入合作過的成員","add.members.by.cooperated.placeholder":"沒有找到合作過的成員","add.members.by.emails":"批量輸入郵箱","add.members.by.emails.placeholder":"將郵箱粘貼到這裡，多個郵箱之間用換行分隔，每次最多添加20個。當前項目剩餘成員名額%s人。","add.members.by.emails.placeholder.unlimit":"將郵箱粘貼到這裡，多個郵箱之間用換行分隔，每次最多添加20個。","add.members.error.limit":"超過限制了，最多一次添加20個郵箱。","add.members.error.message":"企業成員數超過上限","add.members.tips.add.exceed":"已經超出 %s 人","add.members.tips.add.remian":"還可以添加 %s 人","add.success":"添加成功","all.member":"所有成員","all.project":"所有項目","already.inbox.later.message":"已稍後處理","already.inbox.later.message.hint":"將在 %s 再次提醒","app.download":"下載應用","archive.event":"歸檔日程","archive.file":"歸檔文件","archive.folder":"歸檔文件夾","archive.post":"歸檔分享","archive.tag":"歸檔標簽","archive.task":"歸檔任務","archive.taskgroup":"歸檔任務分組","archive.title":"查看歸檔","archived.event.success":"已成功歸檔了日程","archived.file.success":"已成功歸檔了文件","archived.folder.success":"已成功歸檔了文件夾","archived.post.success":"已成功歸檔了分享","archived.projects":"已歸檔的項目","archived.tag.success":"已成功歸檔了標簽","archived.task.success":"已成功歸檔了任務","archived.taskgroup.success":"已成功歸檔了任務分組","at.not.involved":"（不在參與者列表）","authority.get.error":"抱歉，您没有访问该内容的权限","authority.get.error.content":"请联系管理员调整访问权限，或邀请您加入项目","board.stage.sortplaceholder":"鬆開滑鼠，任務將進入該階段","bookkeeping.archived":"此賬目已被歸檔，不可修改","bookkeeping.home.fields.amount":"金額","bookkeeping.home.fields.category":"類型","bookkeeping.home.fields.content":"內容","bookkeeping.home.fields.creator":"創建者","bookkeeping.home.fields.date":"時間","bookkeeping.home.fields.tags":"標簽","bookkeeping.home.header.filter.toggler.title":"篩選和設置","bookkeeping.home.header.filtering":"（已篩選）","bookkeeping.home.tips.header.approve":"當前賬目還未設置審批人，只有審批人才能對賬目進行審批，<a class='bookkeping-setting-approver'>設置審批人</a>","bookkeeping.home.tips.placeholder":"輕松記錄每一筆開支","bookkeeping.home.tips.placeholder.approve":"（只有審批人可以對賬目進行審批，記賬開始請先<a class='bookkeping-setting-approver'>設置審批人</a>）","bookkeeping.home.total.expense":"總支出","bookkeeping.home.total.expense.filtered":"篩選後支出","bookkeeping.home.total.income":"總收入","bookkeeping.home.total.income.filtered":"篩選後收入","bookkeeping.panel.filter.end.date":"結束時間","bookkeeping.panel.filter.hide.approved":"隱藏已經審核的賬目","bookkeeping.panel.filter.start.date":"開始時間","bookkeeping.panel.input.placeholder":"查找相關賬目","bookkeeping.panel.title.filter":"篩選","bookkeeping.panel.title.filter.clear":"清空篩選","bookkeeping.panel.title.settings":"記賬設置","bookkeeping.settings.approver.member":"審批人","bookkeeping.settings.approver.tips":"只有審批人可以審批賬目，您可以設置多個審批人","bookkeeping.settings.approver.title":"審批人設置","bookkeeping.settings.category.edit.placeholder":"分類名稱","bookkeeping.settings.category.title":"管理分類","bookkeeping.settings.expense.tips":"支出","bookkeeping.settings.fields.in":"現有字段","bookkeeping.settings.fields.out":"未添加字段","bookkeeping.settings.fields.title":"賬目字段設置","bookkeeping.settings.income.tips":"收入","calendar.add.subscriber":"添加關注","calendar.invisivle.event.tip1":"%s等%s人已有安排","calendar.invisivle.event.tip2":"%s已有安排","calendar.search.no.result":"抱歉，沒有搜索結果","calendar.search.subscriber":"蒐索","calendar.show.event":"日程","calendar.show.task":"任務","calendar.subscriber.display.title.recommend.members":"最近合作過的成員","calendar.subscriber.display.title.self.projects":"個人項目","calendar.subscriber.display.title.starred.projects":"星標專案","calendar.subscriber.is.empty":"點擊下方「添加關注」<br />添加你所關心的成員或項目","calendar.subscriber.search.placeholder.member":"蒐索成員","calendar.subscriber.search.placeholder.project":"蒐索專案","calendar.subscriber.search.placeholder.team":"蒐索部門","calendar.subscriber.tab.member":"成員","calendar.subscriber.tab.project":"項目","calendar.subscriber.tab.recommend":"推薦","calendar.subscriber.tab.team":"部門","calendar.subscriber.title":"添加成員和項目行事曆","calendar.time":"點","cancel.inbox.later.message":"已取消稍後處理","chat.message.at.me":"[有人@我]","chat.message.list.is.empty":"暫無私信消息","chat.message.list.is.error":"獲取私信清單失敗","chat.message.list.to.refresh":"點擊重繪","chat.modal.title":"聊天","chat.nav.popover.new.chat":"發起聊天","chat.room.add.emoji":"添加表情","chat.room.chat.create":"新聊天","chat.room.chat.empty1":"暫無私信消息","chat.room.chat.empty2":"在這裡你會收到新私信的消息提示","chat.room.cloesd.room":"群聊已關閉","chat.room.cloesd.room.placeholder":"群聊應用已關閉","chat.room.group.empty1":"還沒有群聊消息","chat.room.group.empty2":"項目中的成員都可以在這裡參與群聊","chat.room.group.mute":"提示免打擾","chat.room.member.empty1":"暫無成員","chat.room.member.empty2":"邀請你的同伴開始合作吧！","chat.room.new.private.msg":"私信","chat.room.new.project.msg":"群聊","chat.room.placeholder":"說點什麼…","chat.room.send":"發送","chat.room.send.error":"發送私信失敗，請重新嘗試","chat.room.send.success":"發送私信成功，您可以在收件箱<a class='essage-url url-handler open-inbox-chat' data-id='%s'>私信清單</a>查看","collection.creator.collection.title":"文件夾名稱","collection.creator.create.success":"文件夾創建成功","collection.creator.duplication.title":"文件夾名稱已存在！","collection.destroyer.confirm.delete":"確認要將 %s 永久刪除？","collection.destroyer.delete.fail":"刪除失敗，點擊重試","collection.destroyer.delete.success":"刪除成功","collection.destroyer.deleting":"正在刪除","collection.destroyer.title":"確認刪除","collection.download.title":"下载文件夹","collection.edit.duplication.title":"文件夾名稱已存在！","collection.menu.confirm.delete":"您確定要永遠刪除這個文件夾嗎","collection.menu.delete.title":"刪除文件夾","collection.menu.title":"文件夾菜單","collection.move.message":"移動文件夾 %s 至","collection.move.title":"移動文件夾","collection.picker.creator.input.tips":"文件夾名稱","collection.picker.creator.tips":"創建文件夾","collection.picker.select.collection":"請選擇目標文件夾","collection.rename.title":"重命名","confirm.delete":"刪除","confirm.unarchive.tip":"取消歸檔後將移動至根目錄，確認取消歸檔？","confirm.unarchive.tip.file":"取消歸檔後將移動至根目錄，確認取消歸檔？","copy.link":"復制鏈接","copy.link.failed":"復制失敗","copy.link.success":"已復制","create.event":"創建日程","create.event.success":"成功創建日程：","create.post.success":"成功創建分享：","create.task":"創建任務","create.task.success":"成功創建任務：","datetimepicker.date":"日期","datetimepicker.time":"時間","delete.entry":"刪除記賬","delete.event":"刪除日程","delete.file":"刪除文件","delete.folder":"刪除文件夾","delete.post":"刪除分享","delete.success":"刪除成功","delete.tag":"刪除標簽","delete.task":"刪除任務","delete.taskgroup":"刪除任務分組","desktop.notification":"桌面通知","desktop.notification.desc":"「桌面通知」可以讓您更方便地使用通知中心, 提高協作效率","desktop.notification.disable":"關閉桌面通知","desktop.notification.enable":"啟用桌面通知","download.failed":"下载失败","draft.discard":"忽略","draft.restore":"恢復","due.date":"截止時間","editor.mode.html":"富文本编辑","enter.organization.guide":"企業嚮導","enter.organization.guide.text1":"進入","enter.organization.guide.text2":"，瞭解和配寘企業版功能。","entry.amount.unit":"￥","entry.archives.success.unarchive":"成功取消賬目的歸檔","entry.category.title.null":"沒有類型","entry.creator.expense.title":"記錄支出","entry.creator.income.title":"記錄收入","entry.creator.other.add.placeholder":"添加類型","entry.creator.other.category":"更多","entry.creator.placeholder.amount":"金額","entry.creator.placeholder.content":"內容","entry.creator.placeholder.note":"添加備忘","entry.detail.cost":"成本","entry.detail.profit":"利潤","entry.list.action.approve":"審核","entry.list.action.revoke":"撤銷","entry.list.status.approved":"已審核","entry.menu.action.approve":"批准賬目","entry.menu.action.archive":"歸檔賬目","entry.menu.action.delete":"刪除賬目","entry.menu.action.edit":"編輯賬目","entry.menu.action.revoke":"撤銷賬目","entry.menu.confirm.delete":"確認刪除該項目嗎？","entry.menu.delete.tips":"確定要刪除這個賬目嗎?","entry.menu.success.approve":"成功審核了賬目","entry.menu.success.archive":"成功歸檔了賬目","entry.menu.success.revoke":"成功撤銷了賬目","entry.menu.success.unarchive":"成功取消歸檔了賬目","entry.menu.title":"記賬菜單","entry.menu.title.delete":"刪除賬目","event.all.day.tips":"（全天）","event.confirm.addMember.description":"這是一個重複日程。請問需要將參與者添加到哪些日程中？","event.confirm.addMember.title":"增加參與者","event.confirm.archive.description":"這是一個重複日程。請問需要歸檔哪些日程？","event.confirm.archive.title":"歸檔日程","event.confirm.btn.all":"所有日程","event.confirm.btn.current":"當前日程","event.confirm.btn.next":"後續日程","event.confirm.btn.ok":"確定","event.confirm.delete.description":"這是一個重複日程。請問需要删除哪些日程？","event.confirm.delete.title":"刪除日程","event.confirm.removeMember.description":"這是一個重複日程。請問需要將參與者從哪些日程移除？","event.confirm.removeMember.title":"移除參與者","event.confirm.update.description":"這是一個重複日程。請問需要將修改保存到哪些日程中？","event.confirm.update.following":"後續日程，此日程及其相關的所有後續日程均會發生更改","event.confirm.update.single":"僅此日程，該系列中的其他所有日程都將保持不變","event.confirm.update.title":"更新重複日程","event.confirm.updateMember.description":"這是一個重複日程。請問需要將參與者更新到哪些日程？",
"event.confirm.updateMember.title":"更新參與者","event.confirm.updateRepeat.description":"需要將重複規則更新到後續所有日程中？","event.confirm.updateRepeat.title":"更新重複規則","event.creator.all.day":"全天","event.creator.edit.tips":"編輯日程","event.creator.edit.title":"編輯日程","event.creator.end.time":"結束時間","event.creator.end.time.error":"時間格式不正確","event.creator.location.placeholder":"地點","event.creator.save.after":"更新今後","event.creator.save.single":"更新當前","event.creator.start.time":"開始時間","event.creator.tips_1":"添加日程到 ","event.creator.tips_2":"&empty;","event.creator.title.placeholder":"日程標題","event.detail.appearin.tips":"進入 Appearin 視頻會議（最多 8 人）","event.detail.archived":"日程已歸檔，不可修改","event.detail.end.date.tips":"結束時間","event.detail.start.date.tips":"開始時間","event.fork.hint":"参与者和评论不会被复制到新日程","event.menu.confirm.delete":"確認刪除日程？","event.menu.copy":"复制日程","event.menu.delete.title":"刪除日程","event.menu.edit":"編輯日程","event.menu.fork.fail":"日程复制失败","event.menu.fork.success":"成功复制日程：","event.menu.move":"移动日程","event.menu.move.fail":"日程移动失败","event.menu.move.success":"成功移动日程：","event.menu.title":"日程菜單","event.move.hint":"跨项目移动时，部分参与者信息不会保留","event.placeholder":"目前還沒有日程","event.time.picker.placeholder":"輸入時間","events.add":"添加日程","events.no.event":"無日程安排","events.past":"過去的日程","events.placeholder":"添加新日程，安排會議或其他活動，添加參與者即可通知其他成員參加。","favorites.all":"所有收藏","favorites.deleted":" 已刪除","favorites.invisible":"不可見","favorites.new":"已更新","favorites.not.visible":"無法打開，已刪除或沒有權限","favorites.placeholder":"當前還沒有收藏<br/>你可以收藏有價值的任務、日程、分享、文件和賬目。","favorites.search":"搜索我的收藏","favorites.unfavorite.success":"取消收藏成功","favorites.update.success":"更新成功","favorites.updated":"已有新內容，點擊更新","flagged.projects":"星標項目","fork.to.other.project":"复制到其它项目","future.events":"未來的日程","globalGuide.prefession.goonfree":"繼續使用免費版","globalGuide.prefession.paynow":"為專業版續費","globalGuide.profession.account.tip":"專業版已經到期，請續費後繼續使用專業版提供的豐富應用與挿件及其他陞級功能。<br/><br/><span class='star'>*</span>如選擇使用免費版，您的所有數據將不會受到影響，僅陞級部分功能無法使用。","globalGuide.version.profession.overdue":"專業版已到期","guide.create.project7.btn":"好的","guide.feature.link.folder.content":"你可以关联整个文件夹，当文件夹内容有更新时都可以接收到动态提醒","guide.feature.link.folder.done":"我知道了","helper.shortcuts":"快捷鍵","helper.shortcuts.for.board":"任務板的快捷鍵","helper.shortcuts.for.board.new":"創建新任務","helper.shortcuts.for.event":"日程表的快捷鍵","helper.shortcuts.for.event.new":"創建新日程","helper.shortcuts.for.global":"全局快捷鍵","helper.shortcuts.for.global.inbox":"打開收件箱","helper.shortcuts.for.global.myboard":"進入我的控制台","helper.shortcuts.for.global.portal":"回到所有項目","helper.shortcuts.for.global.search":"打開搜索","helper.shortcuts.for.inbox":"收件箱的快捷鍵","helper.shortcuts.for.inbox.next":"下一條信息","helper.shortcuts.for.inbox.previous":"上一條信息","helper.shortcuts.for.markdown":"打開Markdown語法幫助","helper.shortcuts.for.taskgroup":"打開任務分組面板","helper.shortcuts.for.wall":"分享牆的快捷鍵","helper.shortcuts.for.wall.new":"創建新分享","html5audio.not.support":"您的瀏覽器不支持該音頻播放","html5video.not.support":"您的瀏覽器不支持該視頻播放","iCalendar.howto":"查看如何使用","iCalendar.msg1":"你可以在手機上通過掃描左側的二維碼，獲取「%s」的訂閱鏈接","iCalendar.msg2":"你可以在電腦上點擊以下鏈接直接訂閱「%s」，或者將鏈接復制到日歷軟件手動訂閱","iCalendar.reset":"重新生成訂閱鏈接","iCalendar.title":"訂閱「%s」","inbox.all.message":"通知","inbox.at.me":"[@我]","inbox.ated.empty.tip1":"項目內容更新時","inbox.ated.empty.tip2":"你就會在這裡收到@你的通知提醒","inbox.clear.messages":"清空已讀消息","inbox.clear.messages.desc":"確定要清空所有已讀消息嗎？","inbox.delete.message":"刪除信息","inbox.go.to.entry":"前往記賬","inbox.go.to.event":"前往日程表","inbox.go.to.organization":"前往企業：","inbox.go.to.post":"前往分享牆","inbox.go.to.project":"前往項目：","inbox.go.to.task":"前往任務板","inbox.later.empty.tip1":"項目內容更新時","inbox.later.empty.tip2":"你就會在這裡收到稍後處理的通知提醒","inbox.later.message":"稍後處理","inbox.later.message.cancel":"取消稍後處理","inbox.message.snoozed.time.picker":"%s後處理","inbox.my.mention":"僅@我的消息","inbox.normal.empty.tip1":"項目內容更新時","inbox.normal.empty.tip2":"你就會在這裡收到通知提醒","inbox.preference":"提醒設置","inbox.read.messages":"標記全部已讀","integration.placeholder":"抱歉，「%s」暫無內容","integrations.processon.search.hint":"蒐索 ProcessOn 檔案","integrations.processon.search.no.result":"無搜索結果","international.inner.title":"中国大陆服务器","international.outer.title":"国际服务器","international.tip.inner.description":"查看存放在中国大陆服务器的数据，在中国境内访问更快。","international.tip.inner.switch":"切换至中国大陆服务器","international.tip.outer.description":"为在海外使用访问更稳定，推荐将数据建立在 Teambition 国际服务器。","international.tip.outer.switch":"切换至国际服务器","jinshuju.data.serial_number":"%s 号数据","jinshuju.detail.search.placeholder":"输入数据序号","jinshuju.entries.search.empty.hint":"无查询结果","jinshuju.form.detail.closed.hint":"目前没有收集到数据。","jinshuju.form.detail.createDate.des":"该表单创建于 %s","jinshuju.form.detail.header":"你可以选择关联以下表单选择","jinshuju.form.detail.hint":"用于查看该数据的详细情况。你可以在金数据后台表单数据中找到对应序号。如需关联多个数据，请用逗号分割。","jinshuju.form.detail.title":"单个数据详情","jinshuju.form.normal.closed.hint":"已手动停止收集, 你需要先开启表单。","jinshuju.form.normal.hint":"关联后，可从关联直接打开表单填写页面。","jinshuju.form.normal.title":"表单填写页","jinshuju.form.result.closed.hint":"您需要先将结果分享设为公开或加密。","jinshuju.form.result.hint":"关联后，可通过关联打开结果分享页面。","jinshuju.form.result.title":"结果分享页","jinshuju.form.search.closed.hint":"您需要先将对外查询设为公开或加密。","jinshuju.form.search.hint":"关联后，可通过关联打开查询页面。","jinshuju.form.search.title":"对外查询页","jinshuju.form.status.semantization":"%s，%s。目前收集到 %s 份数据。","jinshuju.form.title":"《%s》","jinshuju.open.rule.closed.des":"已手动停止收集","jinshuju.open.rule.open.des":"已开启，正在收集","jinshuju.permission.login.des":"仅限金数据用户填写","jinshuju.permission.password.des":"凭密码填写","jinshuju.permission.private.des":"仅我和表单管理员、数据维护员可填","jinshuju.permission.public.des":"所有人可填","jinshuju.rating":"%s星","jinshuju.refresh.token.hint":"金数据授权已过期","language.label":"語言","leave.page.alert":"你所編輯的內容尚未保存","library.and":"和 ","library.author":"創建者","library.collections.count":"%s 個文件夾","library.copy":"复制","library.create.folder":"創建文件夾","library.default.collection":"討論的附件","library.download":"下載","library.file.update":"更新","library.files.zipname":"%s等%s项_teambition","library.fork.to":"复制 %s 至","library.move":"移動","library.move.to":"移動 %s 至","library.name":"名稱","library.placeholder":"文件夾中還沒有內容哦","library.placeholder.no.create":"你可以創建文件夾或上傳文件","library.size":"大小","library.success.forkTo":"成功复制 %1 至 %2","library.success.moveTo":"成功移動 %1 至 %2","library.title":"文件庫","library.update":"更新時間","library.upload.file":"上傳文件","library.works.count":"%s 個文件","link.add":"關聯內容","link.collection.permission.error":"您没有访问该项目的权限，无法查看文件夹","link.collection.preview.error":"该项目文件已关闭，无法查看文件夹","link.confirm.delete":"確認希望永久刪除這個關聯？","link.delete":"取消關聯","link.delete.fail":"刪除失敗，請重試","link.delete.success":"刪除成功","link.event.title":"關聯的日程","link.evernote.title":"Evernote","link.file.title":"關聯的檔案","link.github.title":"GitHub","link.jinshuju.title":"金数据","link.menu.title":"關聯菜單","link.post.title":"關聯的分享","link.task.title":"關聯的任務","link.weibo.title":"關聯的微博","markdown.helper.A":"鏈接","markdown.helper.H1":"一級標題","markdown.helper.H2":"二級標題","markdown.helper.H3":"三級標題","markdown.helper.H4":"四級標題","markdown.helper.blank.spaces":"4個空格","markdown.helper.blockquote":"區塊引用","markdown.helper.code":"行內代碼","markdown.helper.em":"斜體","markdown.helper.hr":"分割線","markdown.helper.img":"圖片","markdown.helper.indentation":"縮進","markdown.helper.more.syntax":"· 更多語法請參考：<a href='http://wowubuntu.com/markdown/' target='_blank'>Markdown語法說明</a>","markdown.helper.ol1":"有序列標記1","markdown.helper.ol2":"有序列標記2","markdown.helper.ol3":"有序列標記3","markdown.helper.placeholder":"輸入Markdown文檔","markdown.helper.pre":"形成代碼區塊","markdown.helper.preview":"預覽","markdown.helper.strong":"粗體","markdown.helper.syntax":"語法","markdown.helper.title":"Markdown","markdown.helper.try":" · 試一試 Markdown！","markdown.helper.ul1":"無序列標記1","markdown.helper.ul2":"無序列標記2","member.bar.input":"蒐索成員","member.bar.title":"項目成員","member.card.detail":"查看成員详情","member.card.inactive.init.password":"帳戶待啟動，<a class=“resend-handler”>重發邀請</a>。初始密碼：","member.card.role.setting":"項目許可權設定","member.card.submenu.title":"項目許可權設定","member.card.task.organization":"企業任務","member.card.task.project":"項目任務","member.finder.sendInvitationMailTo":"發送邀請郵件給：","member.finder.unregistered.phone":"該手機號未被注册","member.info":"個人資訊","member.involve":"參與者","member.involve.add":"添加參與者","member.involve.none":"暫無參與者","member.involve.tip":"參與者將會收到評論和任務更新通知","member.menu.all":"所有成員","member.menu.search":"查找成員","member.progress.title.organization":"企業成員數量 · %s/%s","member.progress.title.project":"項目成員數量 · %s/%s","member.remove.from.team":"將成員從部門移除","member.tasks.future.tasks":"未來的任務","member.tasks.recent.tasks":"近期的任務","member.tasks.today.tasks":"今天的任務","memberlatest.actived":"最後登錄於 ","members.manager.add.member":"添加成員","members.manager.all.members":"所有成員","members.manager.new.members":"新成員","members.manager.unassigned.members":"未分配部門的成員","message.system.activity.entry.remove":"无法查看该账目详情","message.system.activity.event.remove":"无法查看该日程详情","message.system.activity.organization.invite.members":"你可以查看该企业所有内容","message.system.activity.organization.remove":"无法查看该企业内容","message.system.activity.organization.remove.member":"无法查看该企业内容","message.system.activity.post.remove":"无法查看该分享详情","message.system.activity.project.archive":"无法查看该项目内容","message.system.activity.project.invite.members":"你可以查看该项目所有内容","message.system.activity.project.remove":"无法查看该项目内容","message.system.activity.project.remove.member":"无法查看该项目内容","message.system.activity.project.unarchive":"你可以查看该项目所有内容","message.system.activity.task.remove":"无法查看该任务详情","message.system.activity.work.remove":"无法查看该文件详情","moment.MMMMYYYY":"YYYY年MM月","more.operations":"更多操作","move.to.other.project":"移动到其它项目","my.btn.personal":"編輯個人資料","my.btn.settings":"設置","my.events":"日程","my.favorites":"收藏","my.notes":"筆記","my.post":"我的分享","my.projects":"個人項目","my.recent":"近期的事","my.recent.today":"今天的事","my.recent.tomorrow":"明天的事","my.recent.week":"最近5天的事","my.task.created":"創建的任務","my.task.dateByAll":"全部","my.task.dateByLastMonth":"最近一個月","my.task.dateByLastTwoWeek":"最近兩個星期","my.task.dateByLastWeek":"最近一個星期","my.task.dateByToday":"今天","my.task.dateByYesterday":"昨天","my.task.done":"完成的任務","my.task.joined":"參與的任務","my.task.sortByDueDate":"按截止時間排序","my.task.sortByPriority":"按時間優先排序","my.task.sortByProject":"按項目名稱排序","my.task.undone":"未完成的任務","my.tasks":"任務","nav.menu.menu":"菜單","nav.menu.sortandfilter":"排序及篩選","navigation.account.personalCenter":"賬號設置","navigation.create.organization":"創建企業","navigation.create.organization.try.now":"立即免費試用","navigation.enterBBS":"進入社區","navigation.event":"日程","navigation.organization":"企業","navigation.project":"項目","navigation.search":"搜索","navigation.sharing":"分享","navigation.task":"任務","navigation.work":"檔案","new.ribbon":"新功能","noRight.view":"您沒有權限查看鏈接的對像","note.collapse":"收起备忘","note.delete.confirm":"一旦刪除筆記，將無法恢復","note.delete.confirm.title":"確認刪除筆記","note.expand":"显示全部","note.placeholder":"當前還沒有筆記<br />我的筆記內的內容，只有你自己才能看到。你可以在這裡記錄內容。","notes.input.note":"內容...","notes.input.title":"標題...","object.picker.event.creator.tips":"創建新日程","object.picker.event.title":"待參加的日程","object.picker.exceed.number":"一次最多選擇 10 個關聯對像！","object.picker.file.uploader.tips":"上傳新文件","object.picker.post.creator.tips":"創建新分享","object.picker.search.all":"按「回車」搜索全部","object.picker.task.creator.tips":"創建新任務","open.file":"打開","oragnization.team.order.title.child":"子部门排序","org.guide.next":"下一步","org.guide.team.create":"新建團隊","org.reports.all.tips.create":"新增任務數量","org.reports.all.tips.delay":"逾期任務數量","org.reports.all.tips.done":"完成任務數量","org.reports.all.title":"企業整體報告","org.reports.arrowLeft":"上一周","org.reports.arrowRight":"下一周","org.reports.currentWeek":"本周","org.reports.rank.tips.delay":"逾期任務數量排行","org.reports.rank.tips.delayResult":"%s，<span>有%s項任務逾期</span>","org.reports.rank.tips.done":"任務完成數量排行","org.reports.rank.tips.doneResult":"%s，完成了%s項任務","org.reports.states.tips.title":"項目的狀態更新","org.reports.tasks.tips.delay":"逾期的任務","org.reports.tasks.tips.done":"完成的任務","organization.avatarCrop.choose":"選擇圖片","organization.avatarCrop.edit.organization.avatar":"編輯組織頭像","organization.avatarCrop.hint":"最佳尺寸64&times;64，可以上傳高質量圖片進行裁剪","organization.avatarCrop.preview":"圖片預覽","organization.buy.members":"購買成員名額","organization.buy.now":"立即續費","organization.buy.years":"購買年數","organization.check.order":"查看訂單","organization.created.key":"創建時間","organization.current.members.limit":"，共%s個名額","organization.current.members.number":"%s比特企業成員","organization.current.members.unlimit":"，名額不限","organization.desc":"企業簡介","organization.dueday":"%s","organization.email.sent30":"郵件已發送(30秒後可以重新發送)","organization.exclusive.consultant":"專屬顧問","organization.exclusive.consultant.mail":"郵箱：%s","organization.exclusive.consultant.phone":"電話：%s","organization.exclusive.consultant.service":"Teambition用戶顧問為你提供一對一專屬服務","organization.expired.key":"到期時間","organization.expiring.btn.ok":"確定","organization.expiring.contact.owner":"企業「%s」即將到期，請聯系企業擁有者續費。","organization.expiring.content":"的企業版即將到期，請及時續費","organization.expiring.go.pay.new":"立即購買","organization.expiring.go.pay.renew":"立即續費","organization.expiring.title":"到期提示","organization.guide.import.members":"導入成員","organization.guide.import.members.description":"將成員添加到企業，你就可以在企業裏管理成員、構建團隊、配寘許可權。我們還提供了企業週報和資料統計功能，助你瞭解企業成員的工作情况。","organization.guide.import.projects":"遷入項目","organization.guide.import.projects.description":"將個人項目遷入企業，你就可以使用企業版的報告和統計功能，把握項目全域動態，便於統籌管理。","organization.help.description1":"在Teambition上創建一個企業，把項目和成員加入其中，即可借助專業的企業功能來統籌管理項目進展和成員工作情况。","organization.help.header":"瞭解企業版","organization.learn.more":"详细了解企业版","organization.member":"企業成員","organization.member.add":"添加成員至企業","organization.member.assign.team":"添加到部門","organization.member.detail":"成員详情","organization.member.detail.organization":"企業成員详情","organization.member.detail.project":"項目成員详情","organization.member.exceed":"企業成員數達到上限","organization.member.exceed.description":"企業成員已滿%s人，新增企業成員名額後可以邀請更多成員","organization.member.menu":"企業成員選單","organization.member.remove":"從企業中移除成員","organization.memberadd.allRecommendInvited":"為你推薦的用戶均已加入本企業","organization.memberadd.batch.invite":"批量邀請","organization.memberadd.cooperatedMember":"合作過的成員","organization.memberadd.inviteText":"帳號邀請","organization.memberadd.noMemberInviteSomeone":"現在項目中只有你一個，<br>你可以在此邀請你的小夥伴一起合作。","organization.memberadd.searchCantfind":"找不到<wbr>“%s”，<wbr>輸入完整郵箱直接將其添加至項目。","organization.memberadd.searchTip":"請輸入郵箱/手機號碼","organization.memberadd.title":"添加成員至企業","organization.members.key":"成員數量","organization.name":"企業名稱","organization.nav.members":"成員","organization.nav.projects":"項目","organization.nav.reports":"報告","organization.nav.statistics":"統計","organization.overdue":"已過期","organization.overdue.btn.ok":"確定","organization.overdue.contact":"該企業「%s」已經到期，請儘快續費或聯系企業擁有者遷出項目。","organization.overdue.message":"該企業已經到期，請盡快續費","organization.overdue.renew":"該企業「%s」已經到期，請盡快續費。","organization.overdue.title":"企業已到期","organization.paid":"正常使用","organization.paid.overdue":"已過期","organization.payment.buy":"購買企業版","organization.project.blank.description":"你可以按照團隊或者按照季度目標來創建項目。每個項目你都可以配上美觀的封面，讓你的工作空間更加愉悅。","organization.project.blank.title":"創建項目","organization.projects":"企業項目","organization.report.blank.description":"Teambition將每週送達一份詳盡的企業報告，從全域瞭解企業各個項目的進展、成員的工作效率，以及任務完成的情况。","organization.report.blank.title":"企業週報","organization.setting.permission":"企業公開性","organization.setting.private":"私有企業（僅企業成員可見）","organization.setting.public":"公開企業（訪客可以查看企業中的公開項目和成員）","organization.settings":"企業設定","organization.settings.add.member.toplimit":"新增企業成員名額","organization.settings.add.members.success":"成功添加 %s 位成員，已向他們發送邀請信","organization.settings.avatar":"企業頭像","organization.settings.avatar.upload":"上傳新頭像","organization.settings.avatar.upload.failed":"更換組織頭像失敗","organization.settings.avatar.upload.success":"成功更換組織頭像","organization.settings.button.delete":"刪除","organization.settings.button.transfer":"移交","organization.settings.delete":"刪除企業","organization.settings.delete.msg":"一旦你刪除了企業，企業內所有項目、團隊、成員，項目中所有內容等都將會被永久刪除。這是一個不可恢復的操作，請謹慎對待！","organization.settings.delete.success":"成功删除企業","organization.settings.delete.title":"刪除企業","organization.settings.desc.placeholder":"介紹一下這個企業","organization.settings.label.belonging":"企業歸屬","organization.settings.leave":"退出企業","organization.settings.leave.msg":"一旦你退出了該企業，你將不能查看任何關於該企業的信息。退出企業後，如果想重新加入，請聯系企業的擁有者或者管理員。","organization.settings.leave.success":"已成功退出企業, 即將返回首頁","organization.settings.leave.title":"退出企業","organization.settings.order.teams":"部门排序","organization.settings.roles.and.permissions":"查看權限表","organization.settings.roles.config":"配置權限","organization.settings.roles.onlyread":"查看權限","organization.settings.save.success":"儲存成功","organization.settings.search.owner":"查找成員","organization.settings.select.owner":"選擇企業擁有者","organization.settings.tab.consultant":"專屬顧問","organization.settings.tab.infomation":"企業信息","organization.settings.tab.other":"更多","organization.settings.tab.pay":"付費資訊","organization.settings.transfer":"移交企業","organization.settings.transfer.confirm":"確認移交","organization.settings.transfer.success":"企業移交成功","organization.settings.transfer.tips":"選擇一個企業成員作為新的企業擁有者，移交後你的角色將變為成員","organization.settings.transfer.warning":"移交企業後，你將不再是企業擁有者，且移交操作不可撤銷！","organization.settings.update.plan":"升級方案","organization.settings.upperLimit":"企業成員達到上限","organization.statistics.activeness":"活躍度","organization.statistics.blank.description":"Teambition需要一周的時間統計第一份數據。企業統計功能將幫助管理者從項目、團隊、成員等多個維度對企業狀況進行分析。值得一提的是，這些數據在App上也可以實时查閱，隨時隨地都能瞭解進展、發現問題。","organization.statistics.blank.title":"企業統計","organization.statistics.chartMembers":"成員總數","organization.statistics.chartProjects":"項目總數","organization.statistics.count":"個","organization.statistics.going":"將到期","organization.statistics.membersAmount":"個成員","organization.statistics.membertab.all":"所有成員","organization.statistics.membertab.byDelayRate":"按任務逾期率","organization.statistics.membertab.byDoneRate":"按任務完成率","organization.statistics.membertab.done.undo":"已完成/總任務數","organization.statistics.membertab.name":"姓名","organization.statistics.membertab.new":"新成員","organization.statistics.membertab.noContent":"沒有成員統計信息","organization.statistics.membertab.projectsJoined":"參與項目數","organization.statistics.membertab.title":"成員統計","organization.statistics.membertab.undergoing":"進行中的任務","organization.statistics.month":"月","organization.statistics.monthShow":"月","organization.statistics.none":"無","organization.statistics.overdue":"已逾期","organization.statistics.projectsAmount":"個項目","organization.statistics.projecttab.all":"所有項目分組","organization.statistics.projecttab.byActiveness":"按項目活躍度","organization.statistics.projecttab.byDelayRate":"按任務逾期率","organization.statistics.projecttab.byDoneRate":"按任務完成率","organization.statistics.projecttab.doneUndo":"已完成/總任務數","organization.statistics.projecttab.member":"成員","organization.statistics.projecttab.noContent":"無項目統計信息","organization.statistics.projecttab.project":"項目","organization.statistics.projecttab.title":"項目統計","organization.statistics.projecttab.undergoings":"進行中的任務","organization.statistics.projecttab.weeklyActiveness":"周活躍度","organization.statistics.projecttab.weeklyActivenessHint":"項目成員每周在項目中產生的內容","organization.statistics.searchMember":"搜索成員","organization.statistics.searchProject":"搜索項目","organization.statistics.searchResult":"搜索結果","organization.statistics.sorting":"排序","organization.statistics.undergoing":"進行中","organization.statistics.weeklyActiveness":"企業周活躍度","organization.statistics.weeklyActiveness.hint":"企業成員每周在所有項目產生的內容","organization.statistics.year":"年","organization.status.key":"企業狀態","organization.switcher.intro.feature.permission":"强大而易管理的許可權配寘","organization.switcher.intro.feature.statistics":"豐富而有意義的資料統計","organization.switcher.intro.feature.weekReport":"每週自動推送的企業週報","organization.switcher.intro.title":"企業版高級功能","organization.team.order.title":"部门排序","organization.transfer.project.member.description":"已成功迁入%s个项目，同时添加项目成员到企业","organization.transfer.project.member.search.member":"搜索成员","organization.transfer.project.member.title":"添加项目成员到企业","organization.trial":"試用中","organization.trial.overdue":"試用結束","organization.visible":"企業可見","popover.search.current":"在當前項目裡搜索 “%s”","popover.search.whole":"在所有項目裡搜索 “%s”","portal.create.project":"創建新項目","portal.enter.organization.home.page":"企業首頁","portal.project.notification":"這個項目有新的動態","portal.project.star.bookmark.hint":"請進入項目並使用%1來添加","portal.project.star.bookmark.hint.project":"請使用%1添加","portal.project.star.success":"星標成功，方便以後快速訪問項目，可以<a class='show-bookmark-hint' data-gta='event' data-label='add-to-bookmark'>加入瀏覽器書簽</a>","portal.project.un.star.success":"取消星標成功","portal.unarchive.error":"抱歉，我們未能重新激活該項目，請稍後重試.","portal.unarchive.project.description":"重新激活項目後，您就可以正常使用該項目了","portal.unarchive.project.title":"重新激活項目","portal.unarchive.success":"項目已經成功重新激活.","post.attachment.not.visible":"无法打开，已删除或没有权限","post.creator.markdown.tips":"該文檔使用 Markdown，<a class='md-help-handler'>語法幫助</a>","post.creator.tips_1":"創建分享至 ","post.creator.tips_2":"&empty;","post.creator.title.placeholder":"輸入文檔標題","post.detail.archived":"分享已歸檔，不可修改","post.menu.confirm.delete":"確認刪除分享？","post.menu.copy":"复制分享","post.menu.delete.title":"刪除分享","post.menu.edit":"编辑分享","post.menu.fork.fail":"分享复制失败","post.menu.fork.global.hint":"参与者和评论不会被复制到新分享","post.menu.fork.success":"成功复制分享：","post.menu.move":"移动分享","post.menu.move.error.hint":"没有权限对分享中的附件进行操作","post.menu.move.error.title":"无法移动分享","post.menu.move.fail":"分享移动失败","post.menu.move.global.hint":"跨项目移动时，部分参与者信息不会保留","post.menu.move.success":"成功移动分享：","post.menu.pin.title":"置頂分享","post.menu.title":"分享菜單","post.menu.unpin.title":"取消置頂","post.placeholder":"目前還沒有分享","post.un.title":"無標題","post.update":"更新分享","powerups.add.plugins":"開放平臺添加更多挿件","powerups.app.close":"關閉應用","powerups.app.close.btn":"確認關閉","powerups.app.confirm.close":"確認需要關閉在<b>%s</b>裏的應用<b>%s</b>嗎？","powerups.app.confirm.delete":"確認需要删除安裝在<b>%s</b>裏的應用<b>%s</b>嗎？","powerups.app.delete":"刪除應用","powerups.app.delete.btn":"確認刪除","powerups.appearin.des":"日程表插件，支持最多8人的視訊會議，遠程辦公也一樣高效。","powerups.author":"由%s提供","powerups.bookkeeping":"記賬","powerups.bookkeeping.des":"輕松記錄項目每一筆開支。記賬可以幫助管理者了解各項目下的收支明細，彙總所有的賬目審批。","powerups.events":"日程","powerups.events.des":"日程表可以幫助你安排好你的一整天，與遠程的同伴加入視訊會議。","powerups.evernote.des":"根據項目需要，啟用印像筆記，即可在任務、日程、分享等地方關聯你的筆記。","powerups.github.des":"關聯 Pull Request 、Issue 或 Commits上內容到 Teambition，在 Teambition 接受動態通知。","powerups.groupchat":"群聊","powerups.groupchat.des":"項目裏的所有成員都可以在這裡一起聊天，發送語音、圖片，分享檔案。自由地交流關於項目的各種資訊。","powerups.item.close.plugin.tasklist":"關閉任務分組","powerups.item.detail.closed":"%s已關閉","powerups.item.detail.nav.apps.least":"請至少保留一個應用","powerups.item.detail.opened":"%s已開啟","powerups.item.detail.tasklist.warning":"該項目中存在多個分組，請整理成一個分組再進行關閉操作","powerups.item.update.hint":"陞級使用該挿件","powerups.jinshuju":"金数据","powerups.jinshuju.des":"金数据一款操作简单且功能强大的在线表单设计和数据管理平台。通过模板或自定义创建表单，金数据自动为用户建立后端数据平台。","powerups.markdown":"Markdown","powerups.markdown.des":"使用 Markdown 格式撰寫的文本，可以使用簡單的符號編輯文本樣式。在發布評論及任務備忘時，支持使用Markdown 。","powerups.modal.title.detail":"應用詳情","powerups.posts":"分享","powerups.posts.des":"溝通想法，共享知識。分享牆幫助你隨時與團隊分享和討論。支持添加圖片、編輯文本格式和 Markdown。","powerups.powerup.groupApp":"項目應用","powerups.powerup.plugin":"功能插件","powerups.preciseDate":"任務精確時間","powerups.preciseDate.des":"啟用後，任務將新增「設定精確時間」的選項，起止時間會同步出現在任務板。","powerups.processon.des":"ProcessOn是一個線上合作繪圖平臺，為用戶提供最强大、易用的作圖工具！支持線上創作流程圖、BPMN、UML圖、UI介面原型設計、iOS介面原型設計等。","powerups.shimo":"石墨文檔","powerups.shimo.des":"第三方雲端協同文檔，一次關於發布分享的全新體驗，授權賬號後即刻體驗，支持刷新同步完成文檔的協同編輯。","powerups.startDate":"任務開始時間","powerups.startDate.des":"給任務設定開始時間，更有效地安排任務，更直觀地瞭解任務進展情况。","powerups.taskUniqueId":"任务 ID","powerups.taskUniqueId.des":"启用后，每创建一个任务都自动产生一个唯一编号，方便成员之间沟通传递。","powerups.taskUniqueId.dialog.confirm":"确认开启","powerups.taskUniqueId.dialog.desc":"请先设置项目编号，编号将作为 ID 前缀，用以区别项目。支持字母，2-4位。","powerups.taskUniqueId.dialog.edit.confirm":"保存","powerups.taskUniqueId.dialog.edit.desc":"设置项目编号，编号将作为 ID 前缀，用以区别项目。支持字母，2-4位。","powerups.taskUniqueId.dialog.edit.title":"任务 ID 设置","powerups.taskUniqueId.dialog.placeholder":"如 Design Team 可以设置为 DT","powerups.taskUniqueId.dialog.submitting":"开启中...","powerups.taskUniqueId.dialog.title":"开启任务 ID","powerups.taskUniqueId.success.edit.tip":"修改任务前缀成功","powerups.taskUniqueId.success.tip":"任务 ID 已开启，请刷新页面后查看","powerups.tasklist":"任務分組","powerups.tasklist.des":"任務分組可以幫助你對任務版進行分類管理，特別適用於研發項目的開發週期反覆運算，一個市場活動的不同週期等。","powerups.tasks":"任務","powerups.tasks.des":"直觀地了解每一個人的工作進展。在任務板上，你可以隨時和成員開展討論，針對每一個任務，你還可以分解子任務、上傳附件、設定截止日期。","powerups.weibo":"微博","powerups.weibo.des":"根據項目需要，啟用微博，即可在任務、日程、分享等地方關聯任意一條微博。","powerups.works":"檔案","powerups.works.des":"文件庫相當於一個可合作的網盤。它支持圖片、doc、PDF、xlsx、MP4等多種常用檔案的線上預覽。同時，你可以隨時更新檔案版本，歷史版本均會保存。","powerups.yinxiang.des":"根據項目需要，啟用印像筆記，即可在任務、日程、分享等地方關聯你的筆記。","powerups.yiqixie":"一起寫文檔","powerups.yiqixie.des":"第三方雲端協同文檔，可用於發布支持協同編輯的分享。與 Teambition 無縫整合，無需授權、關聯賬號，致力於給予極致的協作文檔體驗。","previewer.archived":"文件已歸檔，不可修改","previewer.confirm.delete":"確定要永遠刪除這個文件嗎？","previewer.delete.file":"刪除文件","previewer.download":"下載","previewer.download.file":"下載文件","previewer.edit":"編輯","previewer.enter.collection":"前往文件夾","previewer.file.deleted":"原文件已刪除","previewer.file.translateFail":"文檔轉換失敗了，無法直接預覽","previewer.header.folder.tips":"所屬文件夾","previewer.header.root.tips":"根目錄","previewer.header.temp.tips":"臨時目錄","previewer.img.turn.left":"向左旋轉","previewer.img.turn.right":"向右旋轉","previewer.menu.confirm.delete":"確認永久刪除該文件？","previewer.menu.delete.title":"刪除文件","previewer.menu.title":"文件菜單","previewer.move":"移動","previewer.open":"打開","previewer.open.link":"打開鏈接","previewer.update":"更新","previewer.updating":"正在更新","priority.high":"緊急","priority.none":"普通","priority.urgent":"非常緊急","processon.cooperated":"與我合作的","processon.myFiles":"我的檔案","processon.recent":"最近修改","profession.expired":"專業版已到期","profession.setting.permission.hint":"專業版項目可配置項目管理員，","profession.warning.tip1":"專業版已經到期，請續費後繼續使用專業版提供的豐富應用與挿件及其他陞級功能。您可以聯系該項目擁有者進行續費。","profession.warning.tip2":"專業版已經到期，請續費後繼續使用專業版提供的豐富應用與挿件及其他陞級功能。<br/><br/><span class='star'>＊</span>如選擇使用免費版，您的所有數據將不會受到影響，僅陞級部分功能無法使用。","project.app.plugin.remove.essage":"插件已被移除","project.at.members.organization":"非專案成員","project.at.members.project":"專案成員","project.belonging.owner":"項目擁有者","project.create.section":"點擊添加一個分組","project.creator.belongsTo":"項目歸屬","project.creator.create.project":"創建項目","project.creator.createFromTemplate":"从模板创建项目","project.creator.creating":"創建中...","project.creator.doneAndCreate":"完成並創建","project.creator.fillTemplate":"完善项目信息","project.creator.intro":"為不同的事務建立各自的項目，","project.creator.me":"我","project.creator.nextStep":"下一步","project.creator.owner":"擁有者","project.creator.porject.name.placeholder":"項目名稱","project.creator.section":"項目分組","project.creator.teamplate.create":"创建并进入项目","project.creator.teamplate.intro":"正在从模板<span class='template-name'>%s</span>创建新项目","project.creator.template.failed":"模板创建失败，请稍候再试","project.creator.template.feedback":"建议与反馈","project.desc":"項目簡介","project.grouping":"項目分組","project.logoCrop.best.size.hint":"裁剪尺寸600&times;200, 可以上傳高質量圖片進行裁剪","project.logoCrop.choose":"選擇圖片","project.logoCrop.desktop.logo":"桌面端項目封面","project.logoCrop.mobile.logo":"移動端項目封面","project.logoCrop.previews":"圖片預覽","project.logoCrop.set.project.logo":"編輯項目封面","project.manager.enter":"查看項目","project.manager.filter":"篩選和排序","project.manager.join":"馬上加入","project.manager.joining":"加入中...","project.manager.not.member":"你不是這個項目的成員","project.manager.sort.by.name":"按名稱排序","project.manager.success.join":"成功加入","project.member":"項目成員","project.memberadd.add":"添加","project.memberadd.addMembersByLink":"通過連結邀請","project.memberadd.addRepetitive":"%s已是項目成員","project.memberadd.addSuccess":"成功添加成員，已向%s發送邀請信","project.memberadd.added":"已加入","project.memberadd.allRecommendInvited":"為你推薦的用戶均已加入本項目","project.memberadd.cooperatedMember":"合作過的成員","project.memberadd.header.title":"邀請新成員","project.memberadd.import":"導入","project.memberadd.imported":"已導入","project.memberadd.inviteViaAccount":"帳號邀請","project.memberadd.noMemberInviteSomeone":"現在項目中只有你一個，<br>你可以在此邀請你的小夥伴一起合作。","project.memberadd.orgMember":"企業成員","project.memberadd.orgTeam":"企業團隊","project.memberadd.placeholder":"請輸入郵箱或手機號，回車確認","project.memberadd.placeholderForOrg":"請輸入企業成員/團隊名稱，或郵箱/手機號","project.memberadd.searchCantfind":"找不到<wbr>“%s”，輸入完整郵箱直接將其添加至項目。","project.menu.copy.fail":"項目復制失敗","project.menu.copy.success":"成功復制項目：","project.menu.mail.content":"%s 邀請你查看來自 Teambition 的公開項目「%s」。鏈接是：%s","project.menu.mail.content.desc":"%s 邀請你查看來自 Teambition 的公開項目「%s」。這個項目是關於 “%s”。鏈接是：%s","project.menu.mail.title":"分享公開項目 “%s”","project.menu.share.link":"分享鏈接","project.menu.share.to":"分享到","project.menu.share.to.mail":"通過郵件分享","project.menu.share.to.weibo":"分享到微博","project.menu.weibo.content":"我在 Teambition 上發現了一個有用的公開項目「%s」。","project.menu.weibo.content.desc":"我在 Teambition 上發現了一個有用的公開項目「%s」。這個項目是關於 “%s”。","project.name":"項目名稱","project.none.section":"未選擇分組","project.owner.search":"查找企業或成員","project.panel.activity.project.add.team.and.members":" 添加了企业部门及部门成员:","project.panel.activity.project.archive":" 归档了项目","project.panel.activity.project.archive.collection":" 归档了文件夹:","project.panel.activity.project.archive.entry":" 归档了记账:","project.panel.activity.project.archive.event":" 归档了日程: %s","project.panel.activity.project.archive.post":" 归档了分享:","project.panel.activity.project.archive.tag":" 归档了标签:","project.panel.activity.project.archive.task":" 归档了任务:","project.panel.activity.project.archive.tasklist":" 归档了任务分组:","project.panel.activity.project.archive.work":" 归档了文件:","project.panel.activity.project.create.collection":" 创建了文件夹:","project.panel.activity.project.create.entry":" 创建了记账:","project.panel.activity.project.create.event":" 创建了日程: %s","project.panel.activity.project.create.post":" 创建了分享:","project.panel.activity.project.create.tag":" 创建了标签:","project.panel.activity.project.create.task":" 创建了任务:","project.panel.activity.project.create.tasklist":" 创建了任务分组:","project.panel.activity.project.create.works":" 上传了文件:","project.panel.activity.project.disable.application":" 关闭了应用:","project.panel.activity.project.disable.plugin":" 关闭了插件:","project.panel.activity.project.enable.application":" 打开了应用:","project.panel.activity.project.enable.plugin":" 打开了插件:","project.panel.activity.project.finish.task":" 完成了任务:","project.panel.activity.project.invite.members":" 邀请 %s 加入项目","project.panel.activity.project.join.as.organization.owner":" 作为企业拥有者加入项目","project.panel.activity.project.join.from.invite.link":" 通过项目链接加入项目","project.panel.activity.project.join.from.qrcode":" 通过二维码加入项目","project.panel.activity.project.join.from.user.invite.link":" 通过 %s 分享的邀请链接加入项目","project.panel.activity.project.join.from.user.qrcode":" 通过 %s 分享的二维码加入项目","project.panel.activity.project.join.from.weixin":" 通过微信平台加入项目","project.panel.activity.project.redo.task":" 重做了任务:","project.panel.activity.project.remove":" 删除了项目","project.panel.activity.project.remove.collection":" 删除了文件夹:","project.panel.activity.project.remove.entry":" 删除了记账:","project.panel.activity.project.remove.event":" 删除了日程: %s","project.panel.activity.project.remove.member":" 移除了成员:","project.panel.activity.project.remove.post":" 删除了分享:","project.panel.activity.project.remove.self":" 退出了项目","project.panel.activity.project.remove.tag":" 删除了标签:","project.panel.activity.project.remove.task":" 删除了任务:","project.panel.activity.project.remove.tasklist":" 删除了任务分组:","project.panel.activity.project.remove.team":" 移除了企业部门 %s，但保留部门成员","project.panel.activity.project.remove.team.and.members":" 移除了企业部门及部门成员:","project.panel.activity.project.remove.work":" 删除了文件:","project.panel.activity.project.transfer.to.organization":" 将项目移交给企业","project.panel.activity.project.transfer.to.user":" 将项目移交给用户","project.panel.activity.project.unarchive":" 取消归档了项目","project.panel.activity.project.unarchive.collection":" 取消归档了文件夹:","project.panel.activity.project.unarchive.entry":" 取消归档了记账:","project.panel.activity.project.unarchive.event":" 取消归档了日程: %s","project.panel.activity.project.unarchive.post":" 取消归档了分享:","project.panel.activity.project.unarchive.tag":" 取消归档了标签:","project.panel.activity.project.unarchive.task":" 取消归档了任务:","project.panel.activity.project.unarchive.tasklist":" 取消归档了任务分组:",
"project.panel.activity.project.unarchive.work":" 取消归档了文件:","project.panel.activity.project.update.description":" 修改了项目简介:","project.panel.activity.project.update.logo":" 更新了项目封面","project.panel.activity.project.update.name":" 修改了项目名称:","project.panel.activity.project.update.visibility":" 将项目设置为","project.panel.entry.income":"收入 ¥ %s","project.panel.entry.outcome":"支出 ¥ %s","project.remove.team.remain.members":"移除部門，但部門成員仍然留在項目內","project.remove.team.remove.members":"移除部門，並將部門成員從項目移除","project.search":"搜索项目","project.section.down":"下移分組","project.section.name":"新分組名稱","project.section.remove":"取消分組","project.section.up":"上移分組","project.select.list.hint":"请选择一个项目","project.setting.defaultrole.help":'你可以到 <a class="link-add-handler" href="/applications/permissions/%s" target="_blank">權限設置</a> 頁面添加更多角色',"project.setting.defaultrole.tips":"每添加一個項目成員，該成員權限默認被設置為：","project.setting.handler.transfer":"移交","project.setting.members.exceed.limit":"成員數超出限制","project.setting.members.reach.limit":"成員數已達上限","project.setting.nav.hint":"拖動圖標排序。你可以前往<a class='open-powerups'>項目菜單－應用與插件</a>打開或關閉應用。","project.setting.notification.accept":"推送動態提醒（顯示標記並以桌面通知的方式進行推送）","project.setting.notification.reject":"不推送動態提醒（只顯示標記）","project.setting.notification.tips":"當該項目裡有新動態時，以標記或通知的方式提醒，僅對個人","project.setting.notification.title":"項目動態提醒","project.setting.permission.hint":"免費版項目不支持配寘許可權，","project.setting.reset.error":"重置鏈接失敗，請重試","project.setting.reset.invite":"重置邀請鏈接後，原鏈接失效","project.setting.transfer.and.quit":"您需要指定一名新的擁有者才能退出該項目","project.setting.visibility.all":"公開項目","project.setting.visibility.info.all":"所有人都可通過鏈接訪問，僅項目成員可編輯","project.setting.visibility.info.organization":"所有 Teambition 企業成員可見，僅項目成員可編輯","project.setting.visibility.info.project":"僅項目成員可查看和編輯","project.setting.visibility.organization":"企業項目","project.setting.visibility.project":"私有項目","project.settings":"項目設置","project.settings.add.member.repetitive":"%s 已是項目成員","project.settings.add.member.success":"成功添加成員，已向 %s 發送邀請信","project.settings.add.member.through.url.or.qrcode":"掃描二維碼加入項目或分享項目鏈接邀請成員","project.settings.add.member.through.url.or.tip1":"有效日期:","project.settings.add.members.by.emails":"批量邀請","project.settings.archive":"歸檔","project.settings.archive.error":"未能歸檔項目，請稍後再試","project.settings.archive.msg":"如果項目已經完成或是暫時中止，你可以先將項目歸檔。歸檔的項目可以很容易地再次激活，並且不會有數據丟失","project.settings.archive.success":"已成功歸檔項目，你可以在首頁的底部找到所有已歸檔的項目","project.settings.button.delete":"刪除","project.settings.button.upload.cover":"上傳新封面","project.settings.cannot.quit":"無法退出項目","project.settings.cannot.quit.content":"抱歉！您已作為團隊成員加入項目，無法單獨退出。","project.settings.cannot.remove":"该成员作为团队加入项目，不能单独移除","project.settings.delete":"刪除","project.settings.delete.msg":"一旦你刪除了項目，所有與項目有關的信息將會被永久刪除。這是一個不可恢復的操作，請謹慎對待！","project.settings.delete.success":"已成功刪除項目","project.settings.desc.placeholder":"介紹一下這個項目","project.settings.email.sent30":"郵件已發送(30秒後可以重新發送)","project.settings.label.actions":"項目操作","project.settings.label.permission":"新成員默認許可權","project.settings.label.project.cover":"項目封面","project.settings.label.sort":"應用排序","project.settings.label.subtitle.actions":"您可以執行以下操作","project.settings.leave":"退出","project.settings.leave.msg":"一旦你退出了該項目，你將不能查看任何關於該項目的信息。退出項目後，如果想重新加入，請聯系項目管理員。","project.settings.leave.success":"已成功退出項目","project.settings.logo.crop.image.size.too.large":"圖片文件過大，請選擇4MB以內的文件!","project.settings.logo.upload.failed":"更換項目封面失敗","project.settings.logo.upload.success":"成功更換項目封面","project.settings.member.menu":"成員選單","project.settings.member.menu.set.role":"新增或管理許可權角色","project.settings.member.menu.upgrade.button":"陞級獲得更多許可權角色","project.settings.member.menu.upgrade.description":"管理員、擁有者、自定義許可權","project.settings.member.reach.limit":"項目當前成員容量為%s人，升級後可邀請更多成員","project.settings.member.reach.limit.org":"項目當前成員容量為%s人，新增企業成員名額後即可邀請更多成員","project.settings.no.exist.warn":"該項目未能成功轉移, 請嘗試刷新網頁然後重試","project.settings.no.right.warn":"您沒有轉移該項目的權限","project.settings.over.plan.warn":"請升級新擁有者的項目套餐然後再重試","project.settings.placeholder":"請輸入“DELETE”以確認","project.settings.remove.member":"移除成員","project.settings.resend":"重發邀請信","project.settings.save.success":"儲存成功","project.settings.select.owner":"請選擇新的擁有者","project.settings.tab.activity":"動態推送","project.settings.tab.infomation":"項目信息","project.settings.tab.more":"更多","project.settings.tab.preference":"專案偏好","project.settings.transfer":"移交","project.settings.transfer.confirm":"確認移交","project.settings.transfer.members.exceed.2org":"目標企業的項目成員名額為%s人，小於當前項目成員數。請聯系企業擁有者新增成員名額，或减少當前項目成員數。","project.settings.transfer.members.exceed.2user":"目標個人的項目成員名額為%s人，小於當前項目成員數。請聯系他新增成員名額，或减少當前項目成員數。","project.settings.transfer.roles.change.1":"移交項目後，您將不再是項目擁有者！","project.settings.transfer.roles.change.2":"移交項目後，您將不再是項目擁有者。項目將不能再使用企業版相應功能！","project.settings.transfer.roles.change.3":"移交項目後，您將不再是項目擁有者。項目將不能配寘管理員許可權，不能繼續使用更多豐富挿件！","project.settings.transfer.success":"已成功移交項目","project.settings.visibility":"專案公開性","project.switcher.no.result":"抱歉，沒有找到該項目","project.switcher.placeholder":"查找項目","project.tags":"標籤","project.transfer.success":"遷入成功","project.transferring":"正在遷入","projects.export":"遷出項目","projects.import":"遷入項目","projects.manager.all.project":"所有項目","projects.transfer.to.organization":"迁入个人项目到企业","projects.transfer.to.organization.confirm":"确定迁入","projects.transferIn":"遷入項目","projects.transferIn.btn":"遷入","projects.transferIn.to":"遷入到 :","projects.transferOut":"遷出項目","projects.transferOut.btn":"遷出","projects.transferOut.to":"遷出到 :","quit.success":"退出部門成功","remind.add":"添加提醒","remind.ago":"%s前","remind.close":"關閉提醒","remind.happened":"開始時提醒","remove.success":"移除成功","repeat.add":"添加重復","repeat.description.daily":"每%1天重複.","repeat.description.monthly":"每%1月 %2 日重復.","repeat.description.weekly":"每%1周 %2 重復.","repeat.freq.CUSTOM":"自定義重復","repeat.freq.DAILY":"每天重復","repeat.freq.MONTHLY":"每月重復","repeat.freq.NO":"不重復","repeat.freq.WEEKLY":"每周重復","repeat.freq.WORKDAY":"工作日重復","repeat.freq.YEARLY":"每年重復","repeat.interval":"間隔","resend.success":"發送成功","screen.crop":"截图","scrum.filter.clear":"清除篩選","scrum.filter.hide.done":"隱藏已完成任務","scrum.filter.search":"查找相關任務","scrum.filter.title":"任務篩選","scrum.filter.today.update":"今日更新","scrum.sort.created":"按創建時間排序","scrum.sort.custom":"默認排序（全員同步）","scrum.sort.duedate":"按截止時間排序","scrum.sort.in.save":"正在保存","scrum.sort.priority":"按優先順序最高排序","scrum.sort.save":"保存為全員同步默認排序","scrum.sort.startdate":"按开始时间排序","scrum.sort.title":"任務排序","scrum.sortandfilter.title":"排序及篩選","search.archived":"已歸檔","search.no.content":"抱歉，沒有更多","search.no.result":"抱歉，沒有找到與 “%s” 相關的內容","search.placeholder":"快速搜索，查找你所需的內容","search.project":"所屬項目","search.result.all.type":"所有類型","set.success":"設置成功","settings.no.permission":"您暫時沒有許可權修改該處設定。請聯系擁有者操作。","simditor.add.link.title":"添加链接","simditor.alignCenter":"居中","simditor.alignLeft":"居左","simditor.alignRight":"居右","simditor.alignment":"水平對齊","simditor.blockquote":"引用","simditor.bold":"加粗文字","simditor.code":"插入代碼","simditor.color":"文字顏色","simditor.coloredText":"彩色文字","simditor.deleteColumn":"刪除列","simditor.deleteRow":"刪除行","simditor.deleteTable":"刪除表格","simditor.externalImage":"外鏈圖片","simditor.hr":"分隔線","simditor.image":"插入圖片","simditor.imageAlt":"圖片描述","simditor.imageSize":"圖片尺寸","simditor.imageUrl":"圖片地址","simditor.indent":"向右縮進","simditor.insertColumnLeft":"在左邊插入列","simditor.insertColumnRight":"在右邊插入列","simditor.insertRowAbove":"在上面插入行","simditor.insertRowBelow":"在下面插入行","simditor.italic":"斜體文字","simditor.link":"插入鏈接","simditor.linkText":"鏈接文字","simditor.linkUrl":"地址","simditor.normalText":"普通文本","simditor.ol":"有序列表","simditor.outdent":"向左縮進","simditor.removeLink":"移除鏈接","simditor.restoreImageSize":"還原圖片尺寸","simditor.selectLanguage":"選擇程序語言","simditor.strikethrough":"刪除線文字","simditor.table":"表格","simditor.text":"文本","simditor.title":"標題","simditor.ul":"無序列表","simditor.underline":"下劃線文字","simditor.upload":"上傳","simditor.uploadError":"上傳出錯了","simditor.uploadFailed":"上傳失敗了","simditor.uploadImage":"上傳圖片","simditor.uploading":"正在上傳","stage.add.tip":"新建任務階段...","stage.edit.title":"添加或編輯任務階段","stage.menu.add.next.stage.title":"在此後添加新階段","stage.menu.add.stage.hint":"新階段將被添加在當前階段之後","stage.menu.add.title":"添加階段","stage.menu.archive.tasks.title":"歸檔本階段所有任務","stage.menu.cannot.delete":"請先清空此階段上的任務，然後再刪除這個階段","stage.menu.confirm.archive.tasks":"您確定要歸檔這個階段下的所有任務嗎","stage.menu.confirm.delete":"您確定要永遠刪除這個階段嗎","stage.menu.date.picker":"設置本階段所有任務截止時間","stage.menu.date.picker.clear.success":"成功刪除了截止時間","stage.menu.date.picker.error":"截止時間與開始時間衝突","stage.menu.date.picker.success":"成功設置截止時間","stage.menu.date.picker.title":"選擇截止時間","stage.menu.delete.title":"刪除階段","stage.menu.edit.title":"編輯階段","stage.menu.lock.stage":"切換至流程模式","stage.menu.lock.stage.msg":"切換至流程模式後，該階段的任務會變成已完成狀態，其它階段已完成的任務也會自動進入該階段，即形成了任務流程模式","stage.menu.move.tasks.success":"移動任務成功","stage.menu.move.tasks.title":"移動本階段所有任務","stage.menu.stage.name":"階段名稱","stage.menu.title":"階段菜單","stage.menu.toggle.stage.tasks.executor":"設置本階段所有任務執行者","stage.menu.toggle.stage.tasks.executor.success":"成功設置執行者","stage.menu.toggle.stage.tasks.executor.title":"選擇執行者","stage.menu.unlock.stage":"切換至自由模式","stage.menu.unlock.stage.msg":"切換至自由模式後，該階段後面可以新增加階段，各階段相互獨立，即退出了任務流程模式","stage.selector.changed.tips":"分組資訊已改變，請重新選擇","stage.selector.tips":"你可以在任務板中添加和修改任務分組及任務階段。","stage.selector.title":"選擇位置","submit.post":"立即發布","submit.ticket.chat.with.us":"專屬顧問","submit.ticket.email":"請輸入你的常用郵箱","submit.ticket.menu.online.classroom":"線上課堂","submit.ticket.menu.support":"幫助中心","submit.ticket.menu.video":"使用視頻","submit.ticket.other":"其它意見","submit.ticket.pl.anything":"其他想說的話…","submit.ticket.pl.help":"輸入反饋內容","submit.ticket.pl.suggestion":"你有什麼建議嗎？","submit.ticket.question":"向 Teambition 反饋問題","submit.ticket.send":"發送","submit.ticket.success":"謝謝您的反饋，我們會通過 %s 與您聯繫","submit.ticket.suggestion":"向 Teambition 提出建議","submit.ticket.title":"幫助","subtask.card.create.input.placeholder":"輸入子任務內容...","subtask.card.create.placeholder":"添加子任務","subtask.menu.confirm.delete":"確認刪除該子任務?","subtask.menu.confirm.transform":"確定轉換該子任務為任務？","subtask.menu.delete.title":"刪除子任務","subtask.menu.title":"子任務菜單","subtask.menu.transform.title":"轉換為任務","tag.creator.placeholder":"標簽名稱","tag.creator.title":"新建標簽","tag.creator.warning.name.exit":"標籤名稱已存在！","tag.menu.confirm.delete":"確認刪除標簽？","tag.menu.delete.title":"刪除標簽","tag.menu.edit.title":"編輯標簽","tag.menu.title":"標簽菜單","tag.picker.add":"添加標簽","tag.picker.none":"暫無標簽","tag.view.create":"新標簽","tag.view.entry.info":"%s 個賬目","tag.view.event.info":"%s 個日程","tag.view.file.info":"%s 個文件","tag.view.placeholder.info":"你可以通過“新標簽”按鈕來創建標簽。此後，就可以在在這裡按照標簽來查看項目內容了。","tag.view.placeholder.infoLink":"我們準備了一些實用的標簽用法，<a href='https://www.teambition.com/blog/201410090403' class='link-add-handler' target='_blank'>立即查看</a>。","tag.view.placeholder.title":"項目中還沒有標簽","tag.view.post.info":"%s篇分享","tag.view.task.info":"%s 項任務","target.event.closed":"该项目日程已关闭","target.event.fork.post.denied":"无权限复制到该项目","target.event.move.post.denied":"无权限移动到该项目","target.post.closed":"该项目分享已关闭","target.post.fork.post.denied":"无权限复制到该项目","target.post.move.post.denied":"无权限移动到该项目","target.work.closed":"该项目文件已关闭","target.work.fork.post.denied":"无权限复制到该项目","target.work.move.post.denied":"无权限移动到该项目","task.creator.add":"添加任務","task.creator.content":"任務內容","task.creator.multiple":"創建多條任務","task.creator.multiple.all":"創建 %s 條","task.creator.multiple.desc":"系統檢測到你輸入了 %s 行內容，你是想創建多條任務嗎？","task.creator.multiple.one":"創建一條","task.creator.multiple.too.many":"內容行數太多了","task.creator.multiple.too.many.confirm":"好吧，我知道了","task.creator.multiple.too.many.desc":"內容最多為 %s 行，你當前輸入了 %s 行。","task.creator.set.duedate":"設置截止時間","task.creator.set.startdate":"設置開始時間","task.creator.tips":"創建新任務至","task.detail.add.note":"添加備忘","task.detail.archived":"任務已歸檔，不可修改","task.detail.complete":"完成任務","task.detail.due.date":"截止時間","task.detail.executor":"執行者","task.detail.no.executor":"待認領","task.detail.priority":"優先級","task.detail.priority.info":"選擇優先級","task.detail.redo":"重做此任務","task.detail.remind":"提醒","task.detail.repeat":"重復","task.detail.repeat.info":"選擇重復周期","task.detail.setting.remind":"%s 設置為稍後提醒","task.detail.stage":"任務階段","task.detail.stage.unset":"未設置","task.detail.start.date":"開始時間","task.detail.tasklist":"任務分組","task.detail.time.click.set":"點擊設定","task.dueDate.label":"%s 截止","task.group":"分組","task.group2":"任務分組","task.list.belong.to":"屬於任務：%s","task.list.no.task":"本周無任務","task.menu.confirm.delete":"確認刪除任務？","task.menu.copy":"復制任務","task.menu.copy.check.link":"原任務接收新任務的更新提醒","task.menu.copy.check.linked":"新任務接收原任務的更新提醒","task.menu.copy.fail":"任務復制失敗","task.menu.copy.success":"成功復制任務：","task.menu.copy.tips":"標題、子任務、備忘將被復制","task.menu.delete.title":"刪除任務","task.menu.move":"移動任務","task.menu.move.fail":"任務移動失敗","task.menu.move.success":"成功移動任務：","task.menu.move.tips":"跨項目移動時，任務附件、部分參與者信息不會保留","task.menu.search.project":"查找項目","task.menu.select.group":"選擇任務分組","task.menu.select.project":"選擇項目","task.menu.select.stage":"選擇階段","task.menu.title":"任務菜單","task.menu.warning":"請先選擇項目分組和階段","task.placeholder":"目前還沒有任務","task.recent.placeholder":"你還沒有任務和日程","task.startDate.label":"%s 開始","task.viewl.authority.msg":"由執行者%s設置任務是否完成","tasklist.bar.add.group":"添加任務分組","tasklist.bar.done.tasks":"已完成的任務","tasklist.bar.member.tasks":"成員的任務","tasklist.bar.memberOf.tasks":"%1的任務","tasklist.bar.pin":"固定任務分組欄","tasklist.bar.search.group":"搜索分組","tasklist.bar.smart.group":"智能分組","tasklist.bar.today.tasks":"今天的任務","tasklist.bar.total.tasks":"未完成的任務","tasklist.bar.unassigned.tasks":"待認領的任務","tasklist.bar.unpin":"取消固定任務分組欄","tasklist.creator.new":"新建","tasklist.creator.submit":"創建","tasklist.creator.tasklist.desc":"任務分組描述","tasklist.creator.tasklist.title":"任務分組名稱","tasklist.creator.temp":"模板","tasklist.dump.confirm":"確定匯出","tasklist.dump.hint":"選擇需要匯出的任務分組","tasklist.menu.add.templates":"保存為任務分組模板","tasklist.menu.add.templates.desc":"你可以在（任務分組 &gt; 添加 &gt; 模板）中選擇使用","tasklist.menu.add.templates.detail":"將當前任務階段保存為模板","tasklist.menu.add.templates.success":"添加%s成功","tasklist.menu.confirm.archive":"您確定要歸檔這個任務分組嗎","tasklist.menu.confirm.delete":"您確定要永遠刪除這個任務分組嗎","tasklist.menu.delete.title":"刪除任務分組","tasklist.menu.edit.title":"編輯任務分組","tasklist.menu.last.cannot.edit":"抱歉，您不能歸檔或刪除最後一個任務分組","tasklist.menu.tasklist.desc":"任務分組描述","tasklist.menu.tasklist.title":"任務分組名稱","tasklist.menu.templates":"自定義模板","tasklist.menu.title":"分組菜單","tasklist.tab.status.done":"已完成","tasklist.tab.status.normal":"近期任務","tasklist.tab.status.overdue":"已逾期","tasklist.tab.status.upcoming":"將到期","tasklist.temp1stage1":"策劃","tasklist.temp1stage2":"原型圖","tasklist.temp1stage3":"效果圖","tasklist.temp1stage4":"審核中","tasklist.temp1stage5":"完成","tasklist.temp1title":"設計","tasklist.temp2stage1":"需求點","tasklist.temp2stage2":"設計中","tasklist.temp2stage3":"研發中","tasklist.temp2stage4":"測試中","tasklist.temp2stage5":"已發布","tasklist.temp2title":"研發","tasklist.temp3stage1":"用戶問題","tasklist.temp3stage2":"解決中","tasklist.temp3stage3":"已解決","tasklist.temp3stage4":"反饋用戶&問題解決","tasklist.temp3title":"用戶支持","tasks.no.task":"無任務安排","team.belongsTo":"隸屬於：%s","team.create":"新建部門","team.create.placeholder":"部門名稱","team.create.sub":"创建子部门","team.create.sub.placeholder":"子部门名称","team.create.success":"新建部門成功","team.detail":"部門詳情","team.mananger.add":"添加到部門","team.mananger.quit":"退出","team.mananger.remove":"移除","team.manger.events":"日程安排","team.manger.no.member":"還沒有成員加入","team.manger.no.project":"還沒有參與任何項目","team.manger.project.confirm.remove":"確認移除該項目？","team.manger.project.confirm.title":"移除團隊項目","team.manger.tasks":"任務安排","team.member.add":"添加成員至部門","team.member.menu":"部門成員菜單","team.member.remove":"從部門中移除成員","team.member.remove.content":"将成员从部门移除后，该成员会自动退出该部门所在的项目","team.member.search.placeholder":"搜索%s","team.member.subteam":"子部门成员","team.member.team":"该部门成员","team.members.count":"%s 名成员","team.menu":"部门菜单","team.menu.confirm.delete":"您確定要永遠刪除這個團隊嗎","team.menu.delete.title":"刪除團隊","team.menu.edit.title":"編輯團隊名稱","team.name":"%s部门已加入以下项目。","team.projects":"部门项目","team.projects.add":"添加項目","team.projects.add.search":"搜索項目","team.projects.add.title":"將團隊加入項目","teambition.title":"Teambition · 最好用的團隊協作平台","teams.split":"、","this.stage":"這個階段","this.task":"這項任務","time.format.error":"時間格式不正確","time.input.placeholder":"輸入時間","time.setting.error":"截止时间与开始时间冲突","today.events":"今天的日程","token.expired":"會話過期，請重新","token.reauth":"重新授权","total.events.and.tasks":"共 %s 項","unarchived.entry.success":"已成功解檔了記賬","unarchived.event.success":"已成功解檔了日程","unarchived.file.success":"已成功解檔了文件","unarchived.folder.success":"已成功解檔了文件夾","unarchived.post.success":"已成功解檔了分享","unarchived.tag.success":"已成功解檔了標簽","unarchived.task.success":"已成功解檔了任務","unarchived.taskgroup.success":"已成功解檔了任務分組","unarchived.tasklist.tip":"該項目已關閉任務分組功能，請開啟任務分組功能後再進行取消歸檔操作。","update.file":"更新","uploader.error":"文件上傳失敗","uploader.file.exceed":"檔案超過最大限制","uploader.file.exceed.size":"文件 %s 過大，請選擇 1GB 以內的文件！","uploader.file.exceed.size.default":"檔案%s過大，請選擇10M以內的檔案！","uploader.file.exceed.size.free":"檔案%s過大，請選擇200M以內的檔案！升級後可支持1G大小。","uploader.files.duplicate":"該文件已上傳！","uploader.files.exceed.number":"最多一次性上傳 50 個文件！","uploader.not.accept":"不支持該文件類型或者文件大小為 0","uploader.type.no.allowed":"不支持該文件類型(.%s)，請壓縮後上傳","uploading.tip":"正在上传图片","user.satisfaction.bad":"完全不愿意","user.satisfaction.feedback.0":"感谢评价，你觉得 Teambition 在哪些地方不够好？","user.satisfaction.feedback.1":"感谢评价，你觉得 Teambition 还需要怎样改进？","user.satisfaction.feedback.2":"感谢评价，你最喜欢 Teambition 的哪些功能？","user.satisfaction.good":"非常愿意","user.satisfaction.placeholder":"写一些反馈...","user.satisfaction.recommend":"你有多大意愿向你的朋友推荐 Teambition?","user.satisfaction.send":"发送","user.settings.comment.notice":"評論提醒","user.settings.daily.mail.notice":"每日工作事項郵件提醒","user.settings.mobile":"移動端","user.settings.monthly.mail.notice":"月刊訂閱","user.settings.notification.setting":"提醒設置","user.settings.participant.notice":"被添加參與者提醒","user.settings.preference.usePanelTitle":"在任務板中打開任務詳情采用側欄方式","user.settings.receive.event.notice":"收到『新日程』提醒","user.settings.receive.file.notice":"收到『新文件』提醒","user.settings.receive.post.notice":"收到『新分享』提醒","user.settings.receive.task.notice":"收到『新任務』提醒","user.settings.setting":"偏好設置","user.settings.task.file.update.notice":"任務，文件內容更新時提醒","visible.close":"已關閉","visible.mode":"隱私模式","visible.open":"已開啟","visible.to.involve":"僅參與者可見","visible.to.member":"所有成員可見","wall.view.create.post":"添加分享","wall.view.html.post":"普通文檔","wall.view.markdown.post":"Markdown 文檔","wall.view.post.creator.info":"%s發布於","wall.view.post.order.create.time":"按發布時間排序","wall.view.post.order.reply.time":"按回復時間排序","wall.view.shimo.post":"石墨文檔","wall.view.shimo.update":"刷新文檔","wall.view.yiqixie.post":"一起寫文檔","wall.yiqixie.default.title":"一起寫文檔","week.selector.search":"搜索日期","weibo.menu1":"我關注的微博","weibo.menu2":"我發布的微博","weibo.menu3":"@我的微博","weibo.menu4":"好友圈微博","work.copy.message":"复制文件 %s 至","work.copy.success":"成功复制了文件","work.creator.info":"%s上傳於","work.creator.tips":"上傳文件到 ","work.edit.title":"文件名","work.menu.archive.file":"归档文件","work.menu.confirm.delete":"確定要永遠刪除這個文件嗎","work.menu.copy.file":"复制文件","work.menu.delete.title":"刪除文件","work.menu.move.file":"移动文件","work.menu.title":"文件菜單","work.move.message":"移動文件 %s 至","work.move.success":"成功移动了文件","work.move.title":"移動文件","work.picker.from.dropbox":"從Dropbox選擇","work.picker.from.library":"從文件庫選擇","work.picker.from.link":"粘貼下載鏈接...","work.picker.title":"添加附件","work.picker.uploader":"直接上傳","work.rename.title":"重命名","work.versions.current":"當前版本","work.versions.enter.edit":"編輯版本的描述信息","work.versions.title":"歷史版本","works.background.uploader.close.confirm":"您有文件正在上傳,確認關閉麼?","works.background.uploader.close.confirm.title":"確認關閉","works.background.uploader.error":"文件上傳失敗","works.background.uploader.uploaded":"上傳完成","works.background.uploader.uploading":"正在上傳 %s/%s","works.uploader.uploading.total":"%s個文件正在上傳..."}),n.setLocales("en",{"1day":"1 day","1hour":"1 hour","20mins":"20 mins","4hours":"4 hours",FRI:"Fri",MON:"Mon",SAT:"Sat",SUN:"Sun",THU:"Thu",TUE:"Tue",WED:"Wed",add:"Add",added:"Added",all:"All Posts",archive:"Archive",back:"Back",birthday:"Birthday",bookkeeping:"Bookkeeping",bound:"Connect",by:"by",calendar:"Calendar",cancel:"Cancel",clickToEdit:"Click to edit",close:"Disable",collapse:"Collapse",collection:"Folders",colon:":",comma:", ",confirm:"Confirm",connected:"Network connected, welcome back",copyAs:"Copy",copyTo:"Copy to",create:"Create",creator:"creator",day:"Day","delete":"Delete",disconnected:"Network disconnected, please try again later...",done:"Done",draft:"You have unsaved content.",edit:"Edit",email:"Email",entries:"Entries",entry:"Entry",error:"Sorry, something went wrong!",event:"Meeting",events:"Meetings",executor:"executor",expand:"Expand",favorite:"Favorite ",file:"File",files:"Files",fullStop:".",groupchat:"Group Chat",guest:"Guest",hide:"Hide",inbox:"Alerts",language:"English",location:"Location",login:"Login",logout:"Sign Out",manager:"Administrator",me:"Me",member:"Member",merge:"merge",mobile:"Mobile",month:"Month",more:"More",moveTo:"Move to",my:"Me",noRight:"You can't edit&nbsp;",none:"None",open:"Enable",organization:"Organizations",owner:"Owner",plugin:"Power-ups",position:"Position",post:"Posts",posts:"Posts",project:"Project",projects:"Projects","public":"Public",register:"Register",remove:"Remove",renew:"Renew",repeat:"Repeat",reply:"Reply",rmb:"yuan",save:"Save",search:"Search",setting:"Settings",show:"Show",stage:"Stage",tags:"Tags",task:"Task",tasklist:"Task groups",tasks:"Tasks",team:"Department",today:"Today",unarchive:"Unarchive",unfavorite:"Undo favorite",unknown:"Unknown",unknownDate:"Unknown date",updated:"Updated",upgrade:"Upgrade",upload:"Upload",view:"View",website:"Website",week:"Week",works:"Files","acitivity.timeline.notif.none.tip":"Nobody will get notified","acitivity.timeline.notif.tip":"&nbsp;members will get notified","activity.card.body.checkMore":"More","activity.card.create.headerTips":"create the project","activity.card.error.notFound":"Did not find this %s, perhaps it was deleted.","activity.card.project.title":"Task statistics","activity.card.table.doneTasks":"Completed","activity.card.table.placeholder":"Recent activity in the project","activity.card.table.title":"Project activity","activity.card.table.todoTasks":"On-going","activity.card.today.title":"Today plan","activity.card.unassigned.title":"Unassigned tasks","activity.comment.link.title":"Linked Content","activity.destroyer.confirm.delete":"Are you sure you want to delete this comment permanently?","activity.destroyer.delete":"Delete Comment","activity.destroyer.delete.fail":"Delete failed, click retry","activity.destroyer.delete.success":"Successfully deleted","activity.download.all.attachments":"Download Attachments","activity.early.hidden":"Show all %s comments.","activity.early.loading":"Loading previous comments...","activity.early.shown":"Hide previous comment.","activity.editor.error":"Edit comment failed","activity.editor.place.holder":"Write comment...","activity.editor.success":"Edit comment successfully","activity.editor.title":"Edit comment","activity.invisible.not.involved.tip1":"<a class='add-involve'>Add %1 as a follower to receive notifications from this thread.","activity.invisible.not.involved.tip2":"%1 are not followers. <a class='add-involve'>Add them as followers</a> to receive notifications from this thread.","activity.invisible.not.member.tip1":"This content is only visible to followers. %s is not yet a project member but will be notified for this specific comment.","activity.invisible.not.member.tip1.addmember":", you can also invite <a class='add-member-involve'> to the project and add as follower </a>.","activity.invisible.not.member.tip2":"This content is only visible to followers. %s %s are not yet project members but will be notified for this specific comment","activity.invisible.not.member.tip2.addmember":", you can also invite <a class='add-member-involve'> to the project and add as follower </a>.","activity.invisiblea.addmember.success":"Already added to the project","activity.moreAttachments":"total","activity.moreFiles":"files","activity.panel.checkAll":"View all activities","activity.panel.filter.allMember":"All Members","activity.panel.filter.allType":"All Types","activity.panel.filter.date":"Time","activity.panel.filter.member":"Member","activity.panel.filter.system":"System","activity.panel.filter.type":"Type","activity.panel.invite":"Invite new members","activity.panel.menu.calendar":"Subscribe to Calendar","activity.panel.menu.checkArchive":"Archived Items","activity.panel.menu.config":"Power-ups","activity.panel.menu.copy":"Duplicate projects","activity.panel.menu.enterOrg":"Enter Organization","activity.panel.menu.export.tasks":"Export All Tasks","activity.panel.menu.share":"Share Project","activity.panel.placeholder.searchMember":"Search member","activity.panel.title.activities":"Project Activities","activity.panel.title.all":"Project Menu","activity.panel.weeker.all":"All","activity.system.handlers.enterorg":"Go to organization: %s","activity.system.handlers.enterproject":"Go to project: %s","activity.system.handlers.openchat":"Open chat: %s","activity.timeline.add.attachment":"Attachment","activity.timeline.add.emoji":"add Emoji","activity.timeline.comment":"@ to mention, Enter to reply","activity.timeline.comment.ghost":"<a class='login-handler'>Login</a> or <a class='register-handler'>Register</a> to discuss","activity.timeline.like":"Like","activity.timeline.like.tips.long":"%s person liked.","activity.timeline.like.tips.short":"Like","activity.timeline.only.attachment":"Attachments only","activity.timeline.only.comment":"Comments only","activity.timeline.remove.like":"Unlike","activity.timeline.reply":"Reply","activity.timeline.reply.enter":"Hit Enter to send","activity.timeline.reply.quickly.placeholder":"@ to mention, Ctrl+Enter to reply","activity.timeline.reply.shortcut":"Hit Ctrl+Enter to send","activity.visible.not.involved.tip1":"%s is not in this thread. <a class='add-involve'>Add him as a follower </a> to receive notifications from this thread %s.","activity.visible.not.involved.tip2":"You mentioned %1 %2 but they are not followers yet. <a class='add-involve'>Add them as followers</a> to make them receive further notifications from %3.","activity.visible.not.involved.tip3":"You are not a follower. <a class='add-involve'>Add yourself as a follower</a> to receive further notifications from %s.","activity.visible.not.involved.tip4":"You and %1 are not followers yet.  <a class='add-involve'>Add yourselves as followers</a> to receive further notifications from %2. ","activity.visible.not.member.tip1":"%s is not project member, but can receive this notification","activity.visible.not.member.tip1.addmember":", you can also invite him or her <a class='add-member'> to the project </a>.","activity.visible.not.member.tip2":"%s %s are not project members yet, but will receive this notification","activity.visible.not.member.tip2.addmember":", you can <a class='add-member'> invite them </a> to the project.","add.members.by.cooperated":"Invite people I worked with","add.members.by.cooperated.placeholder":"There’s no cooperated member.","add.members.by.emails":"Invite via email","add.members.by.emails.placeholder":"Paste mailbox here. Separate multiple mailboxes with line break, and add no greater than 20 mailboxes at a time. Currently remaining quota of member is %s.","add.members.by.emails.placeholder.unlimit":"Paste mailbox here. Separate multiple mailboxes with line break, and add no greater than 20 mailboxes at a time.","add.members.error.limit":"Out of limit. You can only batch add 20 email address at most.","add.members.error.message":"You have reached the maximum number of members available in this organization.","add.members.tips.add.exceed":"Member limit exceeded.","add.members.tips.add.remian":"%s license(s) left","add.success":"Successfully added","all.member":"All Members","all.project":"All Projects","already.inbox.later.message":"Snoozed","already.inbox.later.message.hint":"Remind me at %s today","app.download":"Apps","archive.event":"Archive meeting","archive.file":"Archive File","archive.folder":"Archive Folder","archive.post":"Archive Post","archive.tag":"Archive Tag","archive.task":"Archive Task","archive.taskgroup":"Archive Task Group","archive.title":"Archived","archived.event.success":"Successfully archived meeting","archived.file.success":"Successfully archived file","archived.folder.success":"Successfully archived folder","archived.post.success":"Successfully archived post","archived.projects":"Archived Projects","archived.tag.success":"Successfully archived tag","archived.task.success":"Successfully archived task","archived.taskgroup.success":"Successfully archived task group","at.not.involved":"(not a follower)","authority.get.error":"Sorry, you don't have permission to view this content.","authority.get.error.content":"Please contact the administrator to adjust permissions or be invited to join the project.","board.stage.sortplaceholder":"Release to drop here","bookkeeping.archived":"Archived entry can not be edited.","bookkeeping.home.fields.amount":"Amount","bookkeeping.home.fields.category":"Category","bookkeeping.home.fields.content":"Content","bookkeeping.home.fields.creator":"Creator","bookkeeping.home.fields.date":"Date","bookkeeping.home.fields.tags":"Tags","bookkeeping.home.header.filter.toggler.title":"Filter and settings","bookkeeping.home.header.filtering":"(filtering)","bookkeeping.home.tips.header.approve":"Haven't set approvers, the only ones could approve the entry, <a class='bookkeping-setting-approver'>set approvers now</a>.","bookkeeping.home.tips.placeholder":"Record every transaction freely","bookkeeping.home.tips.placeholder.approve":"(Only the approvers can approve the entry, <a class='bookkeping-setting-approver'>set approvers</a> before start)","bookkeeping.home.total.expense":"Total expense","bookkeeping.home.total.expense.filtered":"Expense after filtered","bookkeeping.home.total.income":"Total income","bookkeeping.home.total.income.filtered":"Income after filtered","bookkeeping.panel.filter.end.date":"End date","bookkeeping.panel.filter.hide.approved":"Hide the approved entries","bookkeeping.panel.filter.start.date":"Start date","bookkeeping.panel.input.placeholder":"Filter the entries","bookkeeping.panel.title.filter":"Filter","bookkeeping.panel.title.filter.clear":"Clear filter","bookkeeping.panel.title.settings":"Bookkeeping settings","bookkeeping.settings.approver.member":"Approvers","bookkeeping.settings.approver.tips":"Only the approvers can approve the entry, you can set up multiple.","bookkeeping.settings.approver.title":"Set approvers","bookkeeping.settings.category.edit.placeholder":"Title of category","bookkeeping.settings.category.title":"Manage Categories","bookkeeping.settings.expense.tips":"Expense","bookkeeping.settings.fields.in":"Fields in use","bookkeeping.settings.fields.out":"Fields out of use","bookkeeping.settings.fields.title":"Set fields","bookkeeping.settings.income.tips":"Income","calendar.add.subscriber":"Follow","calendar.invisivle.event.tip1":"%s %s people are unavailable","calendar.invisivle.event.tip2":"%s is unavailable","calendar.search.no.result":"Sorry, no result.","calendar.search.subscriber":"Search","calendar.show.event":"Meeting(s)","calendar.show.task":"Task(s)","calendar.subscriber.display.title.recommend.members":"Recent","calendar.subscriber.display.title.self.projects":"Personal Project","calendar.subscriber.display.title.starred.projects":"Starred Projects","calendar.subscriber.is.empty":"Tap the [Follow] button below<br />to add team members and/or projects you want to follow","calendar.subscriber.search.placeholder.member":"Search members","calendar.subscriber.search.placeholder.project":"Search projects","calendar.subscriber.search.placeholder.team":"Search for department","calendar.subscriber.tab.member":"Members","calendar.subscriber.tab.project":"Projects","calendar.subscriber.tab.recommend":"Recommended","calendar.subscriber.tab.team":"Department","calendar.subscriber.title":"Add Team Members and Projects",
"calendar.time":"&empty;","cancel.inbox.later.message":"Removed from snoozed successfully","chat.message.at.me":"[someone@me]","chat.message.list.is.empty":"No messages yet","chat.message.list.is.error":"Fail to get messages","chat.message.list.to.refresh":"Refresh","chat.modal.title":"Chat","chat.nav.popover.new.chat":"New chat","chat.room.add.emoji":"Emoji","chat.room.chat.create":"new chat","chat.room.chat.empty1":"No chat yet","chat.room.chat.empty2":"You will get notifications here.","chat.room.cloesd.room":"Closed","chat.room.cloesd.room.placeholder":"Chat room is closed","chat.room.group.empty1":"There's no group chat message yet.","chat.room.group.empty2":"Team members can group chat here.","chat.room.group.mute":"Mute","chat.room.member.empty1":"No other members yet","chat.room.member.empty2":"Invite your teammates to work together!","chat.room.new.private.msg":"Chat","chat.room.new.project.msg":"Group Chat","chat.room.placeholder":"Drop a quick line","chat.room.send":"Send","chat.room.send.error":"Failed, try again.","chat.room.send.success":"发送私信成功，您可以在收件箱<a class='essage-url url-handler open-inbox-chat' data-id='%s'>私信列表</a>查看","collection.creator.collection.title":"folder name","collection.creator.create.success":"Folder created","collection.creator.duplication.title":"This folder name already exists!","collection.destroyer.confirm.delete":"Are you sure that you want to permanently delete %s ?","collection.destroyer.delete.fail":"Deletion failed, click to retry","collection.destroyer.delete.success":"Successfully deleted","collection.destroyer.deleting":"Deleting","collection.destroyer.title":"Delete","collection.download.title":"Download Folders","collection.edit.duplication.title":"This folder name already exists!","collection.menu.confirm.delete":"Are you sure you want to delete this folder permanently","collection.menu.delete.title":"Delete Folder","collection.menu.title":"Folder Menu","collection.move.message":"Move folder %s to","collection.move.title":"Move Folder","collection.picker.creator.input.tips":"Folder name","collection.picker.creator.tips":"Create new folder","collection.picker.select.collection":"Please select a folder","collection.rename.title":"Rename Folder","confirm.delete":"Delete","confirm.unarchive.tip":"Are you sure to archive?","confirm.unarchive.tip.file":"Once unarchived, files will be transferred to the root directory. Are you sure you want to unarchive?","copy.link":"Copy to clipboard","copy.link.failed":"Copy failed","copy.link.success":"Copied","create.event":"Add new meeting","create.event.success":"Your meeting has been created:","create.post.success":"Your post has been created: ","create.task":"Add new task","create.task.success":"Your task has been created: ","datetimepicker.date":"Date","datetimepicker.time":"Time","delete.entry":"Delete","delete.event":"Delete meeting","delete.file":"Delete File","delete.folder":"Delete Folder","delete.post":"Delete Post","delete.success":"Successfully deleted","delete.tag":"Delete Tag","delete.task":"Delete Task","delete.taskgroup":"Delete Task group","desktop.notification":"Desktop Notification","desktop.notification.desc":"Desktop Notifications help you get more visible alerts","desktop.notification.disable":"Disable desktop notifications","desktop.notification.enable":"Enable desktop notifications","download.failed":"Failed to download","draft.discard":"Discard","draft.restore":"Restore","due.date":"Due Date","editor.mode.html":"Rich text","enter.organization.guide":"Organization Guide","enter.organization.guide.text1":"Open","enter.organization.guide.text2":"to learn more about enterprise features","entry.amount.unit":"￥","entry.archives.success.unarchive":"Unarchived successfully","entry.category.title.null":"Null Category","entry.creator.expense.title":"Record expense","entry.creator.income.title":"Record income","entry.creator.other.add.placeholder":"Add category","entry.creator.other.category":"More","entry.creator.placeholder.amount":"Amount","entry.creator.placeholder.content":"Content","entry.creator.placeholder.note":"Add note","entry.detail.cost":"Cost","entry.detail.profit":"Profit","entry.list.action.approve":"Approve","entry.list.action.revoke":"Revoke","entry.list.status.approved":"Approved","entry.menu.action.approve":"Approve entry ","entry.menu.action.archive":"Archive entry","entry.menu.action.delete":"Delete entry","entry.menu.action.edit":"Edit entry","entry.menu.action.revoke":"Revoke entry","entry.menu.confirm.delete":"Are you sure you want to remove this project?","entry.menu.delete.tips":"Confirm to delete this entry?","entry.menu.success.approve":"Approved successfully","entry.menu.success.archive":"Archived successfully","entry.menu.success.revoke":"Revoked successfully","entry.menu.success.unarchive":"Unarchived successfully","entry.menu.title":"Entry menu","entry.menu.title.delete":"Delete entry","event.all.day.tips":"(All Day)","event.confirm.addMember.description":"This is a recurring meeting. Add followers to:","event.confirm.addMember.title":"Add followers","event.confirm.archive.description":"This is a recurring meeting. Which ones would you like to archive?","event.confirm.archive.title":"Archive meeting","event.confirm.btn.all":"All","event.confirm.btn.current":"Current","event.confirm.btn.next":"Future","event.confirm.btn.ok":"Confirm","event.confirm.delete.description":"This is a recurring meeting. What would you like to delete?","event.confirm.delete.title":"Delete","event.confirm.removeMember.description":"This is a recurring meeting. Remove followers from:","event.confirm.removeMember.title":"Remove followers","event.confirm.update.description":"This is a recurring meeting. Choose to save to the following meetings:","event.confirm.update.following":"Change this and all future meetings","event.confirm.update.single":"Change only this meeting","event.confirm.update.title":"Update Meeting Recurrence","event.confirm.updateMember.description":"This is a recurring meeting. Change followers for:","event.confirm.updateMember.title":"Change followers","event.confirm.updateRepeat.description":"Do you want to change the recurring setting for all upcoming events?","event.confirm.updateRepeat.title":"Updating recurring setting","event.creator.all.day":"All Day","event.creator.edit.tips":"Edit meeting","event.creator.edit.title":"Edit meeting","event.creator.end.time":"End Time","event.creator.end.time.error":"the format of date incorrect ","event.creator.location.placeholder":"Location","event.creator.save.after":"Change all future meetings","event.creator.save.single":"Change only this meeting","event.creator.start.time":"Start Time","event.creator.tips_1":"Create a meeting to ","event.creator.tips_2":"&empty;","event.creator.title.placeholder":"Meeting title","event.detail.appearin.tips":"Join appear.in video conference(up to 8 people)","event.detail.archived":"Archived meeting can not be edited.","event.detail.end.date.tips":"End Time","event.detail.start.date.tips":"Start Time","event.fork.hint":"Participants and comments will not be copied to new schedule","event.menu.confirm.delete":"Do you want to delete this meeting?","event.menu.copy":"Copy meetting","event.menu.delete.title":"Delete meeting","event.menu.edit":"Edit meeting","event.menu.fork.fail":"Failed to copy schedule!","event.menu.fork.success":"Meetting copied successfully:","event.menu.move":"Move meetting","event.menu.move.fail":"Failed to move schedule!","event.menu.move.success":"Meetting moved successfully:","event.menu.title":"Meeting menu","event.move.hint":"When moving tasks between projects,  some followers will not be moved.","event.placeholder":"No meeting","event.time.picker.placeholder":"Input time","events.add":"New meeting","events.no.event":"No meeting","events.past":"Previous meetings","events.placeholder":"Arrange your meetings here","favorites.all":"All Favorites","favorites.deleted":"deleted","favorites.invisible":"invisible","favorites.new":"updated","favorites.not.visible":"Deleted or not allowed","favorites.placeholder":"You have no favorites yet<br/>Flag items as favorites to make them appear.","favorites.search":"Search","favorites.unfavorite.success":"Successfully undo favorite","favorites.update.success":"Successfully updated","favorites.updated":"Got new content, click to update","flagged.projects":"Starred Projects","fork.to.other.project":"Copy to another project","future.events":"Upcoming","globalGuide.prefession.goonfree":"Continue to use the free version","globalGuide.prefession.paynow":"Renew the pro account","globalGuide.profession.account.tip":"Pro account is expired, please renew to continue using our applications, extensions and other upgraded functions that Pro account offers. <br/><br/><span class='star'>*</span> If you choose free version, all of your data will not be affected, but upgraded functions cannot be used.","globalGuide.version.profession.overdue":"Pro account expired","guide.create.project7.btn":"Thanks!","guide.feature.link.folder.content":"You can choose to link the entire folder, and receive notifications for any activity of this particular folder","guide.feature.link.folder.done":"Got it!","helper.shortcuts":"Shortcuts","helper.shortcuts.for.board":"Tasks Shortcuts","helper.shortcuts.for.board.new":"New Task","helper.shortcuts.for.event":"Shortcuts","helper.shortcuts.for.event.new":"New meeting","helper.shortcuts.for.global":"Global Shortcuts","helper.shortcuts.for.global.inbox":"Open Alerts","helper.shortcuts.for.global.myboard":"Open My Dashboard","helper.shortcuts.for.global.portal":"Back to Portal","helper.shortcuts.for.global.search":"Open Search","helper.shortcuts.for.inbox":"Alerts Shortcuts","helper.shortcuts.for.inbox.next":"Next Message","helper.shortcuts.for.inbox.previous":"Previous Message","helper.shortcuts.for.markdown":"Open Markdown Helper","helper.shortcuts.for.taskgroup":"Open Task Group Panel","helper.shortcuts.for.wall":"Posts Shortcuts","helper.shortcuts.for.wall.new":"New Post","html5audio.not.support":"Your browser does not support this audio","html5video.not.support":"Your browser does not support this video","iCalendar.howto":"How to subscribe","iCalendar.msg1":"Scan this QR code on your phone to get subscription link for「%s」.","iCalendar.msg2":"Click the link below to subscribe「%s」. Or copy and add it to your calendar.","iCalendar.reset":"Regenerate iCalender URL","iCalendar.title":"Subscribe「%s」","inbox.all.message":"All","inbox.at.me":"[Someone @me]","inbox.ated.empty.tip1":"When a project is updated, ","inbox.ated.empty.tip2":"you will receive mentions here.","inbox.clear.messages":"Clear all read","inbox.clear.messages.desc":"Are you sure you want to clear all the read alerts?","inbox.delete.message":"Delete Message","inbox.go.to.entry":"Go to Entries","inbox.go.to.event":"Go to Meetings","inbox.go.to.organization":"Go to organization: ","inbox.go.to.post":"Go to Posts","inbox.go.to.project":"Go to project: ","inbox.go.to.task":"Go to Tasks","inbox.later.empty.tip1":"When project is updated, ","inbox.later.empty.tip2":"you will receive snoozed alerts here","inbox.later.message":"Snoozed","inbox.later.message.cancel":"Remove from snoozed","inbox.message.snoozed.time.picker":"Remind %s later","inbox.my.mention":"Only mentions","inbox.normal.empty.tip1":"When project is updated, ","inbox.normal.empty.tip2":"you will receive notifications","inbox.preference":"Alerts Settings","inbox.read.messages":"Mark all as read","integration.placeholder":"Sorry,  '%s' has no content yet.","integrations.processon.search.hint":"Click here to search ProcessOn","integrations.processon.search.no.result":"Sorry, no result.","international.inner.title":"Mainland China server","international.outer.title":"International server","international.tip.inner.description":"Access data saved on servers in Mainland China for faster browsing in China.","international.tip.inner.switch":"Switch to China","international.tip.outer.description":"To browse more reliably overseas, we recommend storing data on Teambition international region.","international.tip.outer.switch":"Switch to International","jinshuju.data.serial_number":"Serial No. %s","jinshuju.detail.search.placeholder":"Input serial no.","jinshuju.entries.search.empty.hint":"No results","jinshuju.form.detail.closed.hint":"No data","jinshuju.form.detail.createDate.des":"Created: %s","jinshuju.form.detail.header":"You can select the following options.","jinshuju.form.detail.hint":"Use this to view details. You can find the corresponding numbers on in the gold data back end tables. If you link more than one datasheet, use commas to separate them.","jinshuju.form.detail.title":"Details","jinshuju.form.normal.closed.hint":"Collection has been manually stopped. You have to open the form first.","jinshuju.form.normal.hint":"When selected, you can directly open forms and edit pages.","jinshuju.form.normal.title":"Fill out forms","jinshuju.form.result.closed.hint":"You must first set share results to public or set up a password","jinshuju.form.result.hint":"When selected, you can use links share results.","jinshuju.form.result.title":"Share results","jinshuju.form.search.closed.hint":"You have to set up a password or set status as public first.","jinshuju.form.search.hint":"When this is selected, you can use links to open search pages.","jinshuju.form.search.title":"Allow outside searches","jinshuju.form.status.semantization":"%s, %s. %s have been collected so far.","jinshuju.form.title":"%s","jinshuju.open.rule.closed.des":"Collection has already been manually stopped.","jinshuju.open.rule.open.des":"Already opened, gathering data.","jinshuju.permission.login.des":"Only gold data users can edit","jinshuju.permission.password.des":"Requires password","jinshuju.permission.private.des":"Only the administrator, the moderator, and I can edit this.","jinshuju.permission.public.des":"Everyone can edit","jinshuju.rating":"%s stars","jinshuju.refresh.token.hint":"Gold data permission expired","language.label":"Language","leave.page.alert":"Your draft has not been saved","library.and":" and ","library.author":"Author","library.collections.count":"%s folder(s)","library.copy":"Copy","library.create.folder":"New Folder","library.default.collection":"Attachments in discussion","library.download":"Download","library.file.update":"Update","library.files.zipname":"%s_total_%s_files_teambition","library.fork.to":"Copy %s to","library.move":"Move","library.move.to":"move %s to","library.name":"Name","library.placeholder":"This folder is empty!","library.placeholder.no.create":"You can create a folder or upload a file","library.size":"Size","library.success.forkTo":"%1successfully copied to %2","library.success.moveTo":"Move %1 to %2 successfully.","library.title":"File Library","library.update":"Last Update","library.upload.file":"Upload Files","library.works.count":"%s file(s)","link.add":"Add content","link.collection.permission.error":"Sorry, no permission to access this folder","link.collection.preview.error":"File application has been turned off. Failed to access folder","link.confirm.delete":"Are you sure you want to delete this object link permanently?","link.delete":"Delete Object Link","link.delete.fail":"Delete failed, click retry","link.delete.success":"Successfully deleted","link.event.title":"Linked meetings","link.evernote.title":"Evernote","link.file.title":"Linked files","link.github.title":"Github","link.jinshuju.title":"Gold Data","link.menu.title":"Link Menu","link.post.title":"Linked posts","link.task.title":"Linked tasks","link.weibo.title":"Linked Weibo posts","markdown.helper.A":"hyperlink","markdown.helper.H1":"Heading 1","markdown.helper.H2":"Heading 2","markdown.helper.H3":"Heading 3","markdown.helper.H4":"Heading 4","markdown.helper.blank.spaces":"4 projects","markdown.helper.blockquote":"blockquotes","markdown.helper.code":"computer code","markdown.helper.em":"Italic","markdown.helper.hr":"thematic break","markdown.helper.img":"image","markdown.helper.indentation":"Indent","markdown.helper.more.syntax":" · More syntax refer to: <a href='http://daringfireball.net/projects/markdown/syntax/' target='_blank'>Markdown: Syntax</a>","markdown.helper.ol1":"ordered list 1","markdown.helper.ol2":"ordered list 2","markdown.helper.ol3":"ordered list 3","markdown.helper.placeholder":"Input Markdown","markdown.helper.pre":"define preformatted text","markdown.helper.preview":"Preview","markdown.helper.strong":"Bold","markdown.helper.syntax":"Syntax","markdown.helper.title":"Markdown","markdown.helper.try":" · Try Markdown!","markdown.helper.ul1":"unordered list 1","markdown.helper.ul2":"unordered list 2","member.bar.input":"Search members","member.bar.title":"Project member","member.card.detail":"View member profile","member.card.inactive.init.password":'The account is not yet activated，<a class="resend-handler">click here</a> to resend an invitation. Temporary password：',"member.card.role.setting":"Manage project permissions","member.card.submenu.title":"Manage project permissions","member.card.task.organization":"Organization tasks","member.card.task.project":"Tasks in this project","member.finder.sendInvitationMailTo":"Send an invitation to:","member.finder.unregistered.phone":"The phone number is not registered","member.info":"Member profile","member.involve":"Followers","member.involve.add":"Add followers","member.involve.none":"No follower yet.","member.involve.tip":"Followers will receive alerts for future updates","member.menu.all":"All Members","member.menu.search":"Search member","member.progress.title.organization":"Organization member · %s/%s","member.progress.title.project":"Project member · %s/%s","member.remove.from.team":"Remove member from deparment","member.tasks.future.tasks":"Upcoming","member.tasks.recent.tasks":"Recent","member.tasks.today.tasks":"Today","memberlatest.actived":"Latest actived (log in) at ","members.manager.add.member":"Add","members.manager.all.members":"All Members","members.manager.new.members":"New members","members.manager.unassigned.members":"Unassigned members","message.system.activity.entry.remove":"Cannot view details of this entry.","message.system.activity.event.remove":"Cannot view details of this event.","message.system.activity.organization.invite.members":"You can view all of this organization's content.","message.system.activity.organization.remove":"Cannot view organization content.","message.system.activity.organization.remove.member":"Cannot view organization content.","message.system.activity.post.remove":"Cannot view post details.","message.system.activity.project.archive":"Cannot view project content.","message.system.activity.project.invite.members":"You can view all of this project's content.","message.system.activity.project.remove":"Cannot view project content.","message.system.activity.project.remove.member":"Cannot view project content.","message.system.activity.project.unarchive":"You can view all of this project's content.","message.system.activity.task.remove":"Cannot view task details.","message.system.activity.work.remove":"Cannot view file details.","moment.MMMMYYYY":"MMMM YYYY","more.operations":"More operations","move.to.other.project":"Move to another project","my.btn.personal":"Edit personal profile","my.btn.settings":"Setting","my.events":"Meetings","my.favorites":"Favorites","my.notes":"Notes","my.post":"Posts","my.projects":"Personal Projects","my.recent":"Agenda","my.recent.today":"Today","my.recent.tomorrow":"Tomorrow","my.recent.week":"Upcoming","my.task.created":"Created by me","my.task.dateByAll":"All","my.task.dateByLastMonth":"Last month","my.task.dateByLastTwoWeek":"Last two weeks","my.task.dateByLastWeek":"Last week","my.task.dateByToday":"Today","my.task.dateByYesterday":"Yesterday","my.task.done":"Completed tasks","my.task.joined":"Following tasks","my.task.sortByDueDate":"Sort by Due Date","my.task.sortByPriority":"Sort by Priority","my.task.sortByProject":"Sort by Project","my.task.undone":"Uncompleted tasks","my.tasks":"Tasks","nav.menu.menu":"Menu","nav.menu.sortandfilter":"Sort and filter","navigation.account.personalCenter":"Account Settings","navigation.create.organization":"New organization","navigation.create.organization.try.now":"Try now","navigation.enterBBS":"Community","navigation.event":"Meeting","navigation.organization":"Organization","navigation.project":"Project","navigation.search":"Search","navigation.sharing":"Post","navigation.task":"Task","navigation.work":"File","new.ribbon":"NEWS","noRight.view":"You cant't view the link object","note.collapse":"Collapse note","note.delete.confirm":"Once delete the note, you can not restore it","note.delete.confirm.title":"Confirm deleting note","note.expand":"Expand all","note.placeholder":"You haven't left any notes yet.<br />Notes is visible to you only. You can take notes here.","notes.input.note":"note...","notes.input.title":"title...","object.picker.event.creator.tips":"Create new meeting","object.picker.event.title":"Meetings","object.picker.exceed.number":"Up to 10 objects each time!","object.picker.file.uploader.tips":"Upload Files","object.picker.post.creator.tips":"Create new post","object.picker.search.all":"Enter to search all","object.picker.task.creator.tips":"Create new task","open.file":"Open","oragnization.team.order.title.child":"Sub-Team Order","org.guide.next":"Next","org.guide.team.create":"Create a team","org.reports.all.tips.create":"New Tasks","org.reports.all.tips.delay":"Delayed Tasks","org.reports.all.tips.done":"Compeleted Tasks","org.reports.all.title":"Weekly Report","org.reports.arrowLeft":"Last Week","org.reports.arrowRight":"Next Week","org.reports.currentWeek":"This Week","org.reports.rank.tips.delay":"Rank of delayed tasks","org.reports.rank.tips.delayResult":"%s, <span> has %s delayed task(s).</span>","org.reports.rank.tips.done":"Rank of compeleted tasks","org.reports.rank.tips.doneResult":"%s, compeleted %s task(s).","org.reports.states.tips.title":"Project States","org.reports.tasks.tips.delay":"Delayed Tasks","org.reports.tasks.tips.done":"Compeleted Tasks","organization.avatarCrop.choose":"Select a picture","organization.avatarCrop.edit.organization.avatar":"Edit organization profile","organization.avatarCrop.hint":"A picture at least 64 pixels in width and height is recommended.","organization.avatarCrop.preview":"Preview","organization.buy.members":"Add members","organization.buy.now":"Renew now","organization.buy.years":"Renew","organization.check.order":"View orders","organization.created.key":"Registration","organization.current.members.limit":", %s in total","organization.current.members.number":"%s organization members","organization.current.members.unlimit":", unlimited members count.","organization.desc":"Organization Description","organization.dueday":"%s free trial","organization.email.sent30":"Sent (Try again after 30s)","organization.exclusive.consultant":"Exclusive","organization.exclusive.consultant.mail":"Email: %s","organization.exclusive.consultant.phone":"Tel: %s","organization.exclusive.consultant.service":"Get in touch with the Teambition Customer Success team to get the help you need.","organization.expired.key":"Expiration","organization.expiring.btn.ok":"OK","organization.expiring.contact.owner":"This organization 「%s」 soon will be overdue, please contact organization owner(s) renew.","organization.expiring.content":"%s's business version soon will be overdue, please renew your payment plan","organization.expiring.go.pay.new":"Buy now","organization.expiring.go.pay.renew":"Renew now","organization.expiring.title":"Overdue Notice","organization.guide.import.members":"Adding members","organization.guide.import.members.description":"Add members to assign them tasks, share posts and files, invite to meetings and chat with.","organization.guide.import.projects":"Transfer Projects","organization.guide.import.projects.description":"Transfer existing personal projects to your organization, and get permission management, include them in your dashboards and weekly reports.","organization.help.description1":"Teambition organizations gives you better control ever what happens in your company.","organization.help.header":"Introducing Organizations","organization.learn.more":"Read more of Teambition Enterprise ","organization.member":"Organization Members","organization.member.add":"Invite to organization","organization.member.assign.team":"Add to department","organization.member.detail":"Member profile","organization.member.detail.organization":"Profile","organization.member.detail.project":"Profile","organization.member.exceed":"The number of members exceeds the limit.","organization.member.exceed.description":"You have reached the license limit of %s. Purchase more to invite new members","organization.member.menu":"Member menu","organization.member.remove":"Remove from organization","organization.memberadd.allRecommendInvited":"You have added all recommended users into the organization","organization.memberadd.batch.invite":"Bulk invite","organization.memberadd.cooperatedMember":"People you have worked with","organization.memberadd.inviteText":"Invite","organization.memberadd.noMemberInviteSomeone":"You are the only one in this organization! <br>Invite your teammates and start collaborating.","organization.memberadd.searchCantfind":'Cannot locate <wbr>"%s". <wbr>Please enter the complete email address.',"organization.memberadd.searchTip":"Enter an email or phone number.","organization.memberadd.title":"Add people to work with","organization.members.key":"Members","organization.name":"Name","organization.nav.members":"Members","organization.nav.projects":"Projects","organization.nav.reports":"Report","organization.nav.statistics":"Dashboards","organization.overdue":"Your free trial expired","organization.overdue.btn.ok":"OK","organization.overdue.contact":"This organization 「%s」 is overdue, please renew your payment plan or contact organization owner(s) renew.","organization.overdue.message":"This organization is overdue, please renew your payment plan","organization.overdue.renew":"This organization 「%s」 is overdue, please renew your payment plan.","organization.overdue.title":"Organization Overdue","organization.paid":"In normal use","organization.paid.overdue":"Expired","organization.payment.buy":"Purchase Business version","organization.project.blank.description":"Organize your projects by team, objective, quarters and clients, etc. You can customize everything, from their looks to member permissions.","organization.project.blank.title":"Let's fill in projects","organization.projects":"Organization projects","organization.report.blank.description":"Teambition will deliver a detailed report weekly, enabling a better understanding on how things are going, from individual members's status to projects' progress, helping you focus on the big picture.","organization.report.blank.title":"Weekly Reports","organization.setting.permission":"Organization visibility","organization.setting.private":"Private (only organization's member can view)","organization.setting.public":"Public (anyone could view the public porjects and members)","organization.settings":"Organization settings","organization.settings.add.member.toplimit":"Add quota","organization.settings.add.members.success":"You have added %s member(s). They will receive your invitation letter soon.","organization.settings.avatar":"Organization logo","organization.settings.avatar.upload":"Upload a new logo","organization.settings.avatar.upload.failed":"Failed","organization.settings.avatar.upload.success":"Failed","organization.settings.button.delete":"Delete","organization.settings.button.transfer":"Transfer","organization.settings.delete":"Delete Organization","organization.settings.delete.msg":"Be aware that this action will delete all project data permanently. This cannot be undone.","organization.settings.delete.success":"The organization has been successfully deleted","organization.settings.delete.title":"Delete Organization","organization.settings.desc.placeholder":"Enter a description here","organization.settings.label.belonging":"Organization owner","organization.settings.leave":"Leave Organization","organization.settings.leave.msg":"By leaving this project, you will be denied access to its content. To access it again, please contact the owner.","organization.settings.leave.success":"You have left this organization and now will be navigated to portal","organization.settings.leave.title":"Leave Organization","organization.settings.order.teams":"Team Order","organization.settings.roles.and.permissions":"View and manage permissions","organization.settings.roles.config":"Permissions","organization.settings.roles.onlyread":"View and manage permissions","organization.settings.save.success":"Saved successfully","organization.settings.search.owner":"Search member","organization.settings.select.owner":"Select organization owner","organization.settings.tab.consultant":"Support","organization.settings.tab.infomation":"Organization info","organization.settings.tab.other":"More","organization.settings.tab.pay":"Billing","organization.settings.transfer":"Transfer organization ownership","organization.settings.transfer.confirm":"Confirm transferring organization ownership","organization.settings.transfer.success":"Organization ownership transferred successfully","organization.settings.transfer.tips":"Choose another organization member as the new owner; upon transferring you will become a regular organization member","organization.settings.transfer.warning":"Upon transferring, you will no longer be the organization owner; action cannot be revoked!","organization.settings.update.plan":"Upgrade plan","organization.settings.upperLimit":"Organization members reached the limit","organization.statistics.activeness":"Value","organization.statistics.blank.description":"Teambition needs at least one week's data to generate your own statistics dashboard. Filter by projects, teams and members to gain insights into how things are going on different fronts. You can access statistics on Teambition apps as well.","organization.statistics.blank.title":"Organization Statistics","organization.statistics.chartMembers":"Members","organization.statistics.chartProjects":"Projects","organization.statistics.count":"&empty;","organization.statistics.going":"Upcoming","organization.statistics.membersAmount":"members","organization.statistics.membertab.all":"All members","organization.statistics.membertab.byDelayRate":"Sort by overdued","organization.statistics.membertab.byDoneRate":"Sort by completion","organization.statistics.membertab.done.undo":"Done/All","organization.statistics.membertab.name":"Member name","organization.statistics.membertab.new":"New members","organization.statistics.membertab.noContent":"No content","organization.statistics.membertab.projectsJoined":"Joined projects","organization.statistics.membertab.title":"Members","organization.statistics.membertab.undergoing":"Task status","organization.statistics.month":"&empty;","organization.statistics.monthShow":"/","organization.statistics.none":"No","organization.statistics.overdue":"Overdue","organization.statistics.projectsAmount":"projects","organization.statistics.projecttab.all":"All sections","organization.statistics.projecttab.byActiveness":"Sort by engagement","organization.statistics.projecttab.byDelayRate":"Sort by overdued","organization.statistics.projecttab.byDoneRate":"Sort by completion","organization.statistics.projecttab.doneUndo":"Done/All","organization.statistics.projecttab.member":"Members","organization.statistics.projecttab.noContent":"No content","organization.statistics.projecttab.project":"Project name","organization.statistics.projecttab.title":"Projects","organization.statistics.projecttab.undergoings":"Task status","organization.statistics.projecttab.weeklyActiveness":"Engagement","organization.statistics.projecttab.weeklyActivenessHint":"content generated by week in this project",
"organization.statistics.searchMember":"Search members","organization.statistics.searchProject":"Search projects","organization.statistics.searchResult":"&nbsp;results","organization.statistics.sorting":"&empty;","organization.statistics.undergoing":"Undergoing","organization.statistics.weeklyActiveness":"Engagement","organization.statistics.weeklyActiveness.hint":"content generated by week in this organization","organization.statistics.year":"/","organization.status.key":"Status","organization.switcher.intro.feature.permission":"Customizable Permissions","organization.switcher.intro.feature.statistics":"Detailed Dashboards","organization.switcher.intro.feature.weekReport":"Weekly Reports","organization.switcher.intro.title":"Exclusive enterprise features","organization.team.order.title":"Team Order","organization.transfer.project.member.description":"%s has been transferred successfully. The project members have also been transferred to the organization.","organization.transfer.project.member.search.member":"Search members","organization.transfer.project.member.title":"Add project members to organization.","organization.trial":"Trial","organization.trial.overdue":"Trial ended","organization.visible":"Organization Visible","popover.search.current":'Search "%s" in current project',"popover.search.whole":'Search "%s" in all projects',"portal.create.project":"Create new project","portal.enter.organization.home.page":"Organization","portal.project.notification":"This project has new activities.","portal.project.star.bookmark.hint":"Try %1 to quick add in projects","portal.project.star.bookmark.hint.project":"Try %1 to quick add","portal.project.star.success":"You have starred this project. you can also <a class='show-bookmark-hint' data-gta='event' data-label='add-to-bookmark'>add it to bookmarks</a>","portal.project.un.star.success":"You have unstarred this project.","portal.unarchive.error":"Sorry, we couldn't activate the project now, please try again later.","portal.unarchive.project.description":"After activation, the project will be moved back and ready to use again.","portal.unarchive.project.title":"Activate Project","portal.unarchive.success":"Successfully activated project.","post.attachment.not.visible":"Deleted or not allowed","post.creator.markdown.tips":"The document used Markdown, <a class='md-help-handler'>Markdown Syntax</a>","post.creator.tips_1":"Create a post in ","post.creator.tips_2":"&empty;","post.creator.title.placeholder":"Post title","post.detail.archived":"Archived post can not be edited.","post.menu.confirm.delete":"Do you want to delete this post?","post.menu.copy":"Copy Post","post.menu.delete.title":"Delete Post","post.menu.edit":"Edit Post","post.menu.fork.fail":"Failed to copy post!","post.menu.fork.global.hint":"Participants and comments will not be copied to new post","post.menu.fork.success":"Post copied successfully:","post.menu.move":"Move Post","post.menu.move.error.hint":"You do not have permission to manipulate attachments in posts.","post.menu.move.error.title":"Cannot move post","post.menu.move.fail":"Failed to move post!","post.menu.move.global.hint":"When moving tasks between projects,  some followers will not be moved.","post.menu.move.success":"Post moved successfully:","post.menu.pin.title":"Pin Post","post.menu.title":"Post Menu","post.menu.unpin.title":"Unpin Post","post.placeholder":"No Post","post.un.title":"Untitled Post","post.update":"Update Post","powerups.add.plugins":"Create your own plug-ins","powerups.app.close":"Disable","powerups.app.close.btn":"Disable","powerups.app.confirm.close":"Turn off <b>%s</b> in <b>%s</b>?","powerups.app.confirm.delete":"Delete <b>%s</b> in <b>%s</b>?","powerups.app.delete":"Delete applications","powerups.app.delete.btn":"Delete confirmed","powerups.appearin.des":"Video conferencing with up to 8 participants.","powerups.author":"Powered by %s","powerups.bookkeeping":"Bookkeeping","powerups.bookkeeping.des":"Get it done. Bookkeeping helps financial managers get their entries registered fast and easy.","powerups.events":"Meetings","powerups.events.des":"Keep everyone together with meetings, using our built-in video conferencing tool.","powerups.evernote.des":"Link your Evernote notes to your tasks, posts and meetings.","powerups.github.des":"Shows up-to-date pull requests、issues and commits in Teambition.","powerups.groupchat":"Group Chat","powerups.groupchat.des":"All team members of this project can chat as a group, exchange ideas, share pictures, files and voice recordings.","powerups.item.close.plugin.tasklist":"Close Task Group","powerups.item.detail.closed":"%s turned off","powerups.item.detail.nav.apps.least":"You must keep one feature on file","powerups.item.detail.opened":"%s turned on","powerups.item.detail.tasklist.warning":"The project is divided into several groups, please form a group and turn off operation","powerups.item.update.hint":"Upgrade to use this extension","powerups.jinshuju":"Gold Data","powerups.jinshuju.des":"Gold data is a simple but powerful way to control data through an online platform. You can create custom tables or use templates. Gold data will automatically create back end tables for clients.","powerups.markdown":"Markdown","powerups.markdown.des":"Markdown is a simple way to format your notes, tasks, comments or posts by annotating them.","powerups.modal.title.detail":"Application details","powerups.posts":"Post","powerups.posts.des":"Turn on Markdown to easily format your posts and notes.","powerups.powerup.groupApp":"Features","powerups.powerup.plugin":"Power-ups","powerups.preciseDate":"Precise Time","powerups.preciseDate.des":"Enabling this will add a precise time field to tasks, in addition to date. Effective for both start and end of tasks.","powerups.processon.des":"ProcessOn is a powerful diagram editing tool to create BPMN, UML, UI maps or even iOS interface designs!","powerups.shimo":"Shimo","powerups.shimo.des":"A collaborative writing tool to easily edit documents with others.","powerups.startDate":"Task starting time","powerups.startDate.des":"Set a starting time for your task to better manage your day. Greater visibility makes greater efficiency.","powerups.taskUniqueId":"Task ID","powerups.taskUniqueId.des":"After this is activated, every time you create a task, a serial number will be created. This will make communication and data transfer more convenient.","powerups.taskUniqueId.dialog.confirm":"Confirm","powerups.taskUniqueId.dialog.desc":"First set up a task number. The task number will appear as an identifying prefix so that one task can be distinguished from another. Supports numbers and letters (2-4 characters).","powerups.taskUniqueId.dialog.edit.confirm":"Save","powerups.taskUniqueId.dialog.edit.desc":"First set up a task number. The task number will appear as an identifying prefix so that one task can be distinguished from another. Supports numbers and letters (2-4 characters).`","powerups.taskUniqueId.dialog.edit.title":"Task ID Setup","powerups.taskUniqueId.dialog.placeholder":"For example, the Design Team can be marked as DT.","powerups.taskUniqueId.dialog.submitting":"Submitting...","powerups.taskUniqueId.dialog.title":"Set Task ID","powerups.taskUniqueId.success.edit.tip":"Task prefix edited successfully!","powerups.taskUniqueId.success.tip":"Task ID has been setup. You will see it after refreshing the page.","powerups.tasklist":"Task Group","powerups.tasklist.des":"Task group can help you perform categorized management, especially during periodic fluctuation of  developing projects, and different periods of a market.","powerups.tasks":"Tasks","powerups.tasks.des":"Track everyone's progress using to-do lists.","powerups.weibo":"Weibo","powerups.weibo.des":"Link Weibo content to your tasks, posts and meetings.","powerups.works":"File","powerups.works.des":"File Library is equivalent to a collaborative network disk. It allows you to preview image, doc, PDF, xlsx, MP4, and other commonly used filed online. It also allows you to update files while retaining all previous versions.","powerups.yinxiang.des":"Link your Evernote notes to your tasks, posts, and meetings.","powerups.yiqixie":"Yiqixie","powerups.yiqixie.des":"Collaborative writing tool. Working on the same document with colleagues in Teambition, without redirecting to third-party services.","previewer.archived":"Archived file can not be edited.","previewer.confirm.delete":"Are you sure that you want to delete this file permanently?","previewer.delete.file":"Delete File","previewer.download":"Download","previewer.download.file":"Download File","previewer.edit":"Edit","previewer.enter.collection":"Go to collection","previewer.file.deleted":"The file has been deleted.","previewer.file.translateFail":"Cannot preview the file","previewer.header.folder.tips":"Belong to ","previewer.header.root.tips":"Root","previewer.header.temp.tips":"Temporary directory","previewer.img.turn.left":"Rotate Left","previewer.img.turn.right":"Rotate Right","previewer.menu.confirm.delete":"Do you want to permanently delete this file?","previewer.menu.delete.title":"Delete file","previewer.menu.title":"File Menu","previewer.move":"Move","previewer.open":"Open","previewer.open.link":"Open Link","previewer.update":"Update","previewer.updating":"Updating","priority.high":"High","priority.none":"Default","priority.urgent":"Urgent","processon.cooperated":"I collaborated on","processon.myFiles":"I created","processon.recent":"Recently modified","profession.expired":"Pro account expired","profession.setting.permission.hint":"Project admin can be assigned in Pro account,","profession.warning.tip1":"Pro account is expired, please renew to continue using the abundant applications, extensions and other upgraded functions that Pro account offers. You can contact the owner of this project to renew Pro account.","profession.warning.tip2":"Pro account is expired, please renew to continue using the abundant applications, extensions and other upgraded functions that Pro account offers. <br/><span class='star'>*</span> If you choose free version, all of your data will not be affected, but upgraded functions cannot be used.","project.app.plugin.remove.essage":"Plugin has been removed.","project.at.members.organization":"Not Project Member","project.at.members.project":"Project Member","project.belonging.owner":"Project owner","project.create.section":"Click here to add a section","project.creator.belongsTo":"Ownership","project.creator.create.project":"New Project","project.creator.createFromTemplate":"Create project from template","project.creator.creating":"Creating...","project.creator.doneAndCreate":"Create","project.creator.fillTemplate":"Fill template","project.creator.intro":"To get examples of how to set up projects,","project.creator.me":"Me","project.creator.nextStep":"Next Step","project.creator.owner":"Owner","project.creator.porject.name.placeholder":"Project name","project.creator.section":"Section","project.creator.teamplate.create":"Create and enter project","project.creator.teamplate.intro":"Creating new project from template: <span class='template-name'>%s</span>","project.creator.template.failed":"Failed to create project, please try again later","project.creator.template.feedback":"Advice and Feedback","project.desc":"Project Description","project.grouping":"Section","project.logoCrop.best.size.hint":"Pictures will be compressed by 600&times;200. Support high definition picture upload.","project.logoCrop.choose":"Select a picture","project.logoCrop.desktop.logo":"Project cover for web","project.logoCrop.mobile.logo":"Project cover for mobile","project.logoCrop.previews":"preview","project.logoCrop.set.project.logo":"Edit project cover","project.manager.enter":"Enter","project.manager.filter":"Filter And Sort","project.manager.join":"Join now","project.manager.joining":"Joining...","project.manager.not.member":"You are not in this project","project.manager.sort.by.name":"Sort by name","project.manager.success.join":"Joined successfully","project.member":"Project member","project.memberadd.add":"Add","project.memberadd.addMembersByLink":"Invite via link","project.memberadd.addRepetitive":"%s has been successfully invited","project.memberadd.addSuccess":"You have successfully invited %s","project.memberadd.added":"Added","project.memberadd.allRecommendInvited":"The people recommended to you have all joined this project already.","project.memberadd.cooperatedMember":"People I worked with","project.memberadd.header.title":"Invite new members","project.memberadd.import":"Sync","project.memberadd.imported":"Synced","project.memberadd.inviteViaAccount":"Account invitation","project.memberadd.noMemberInviteSomeone":"You are currently the only member of this project, <br>you can invite a partner to collaborate.","project.memberadd.orgMember":"Company members","project.memberadd.orgTeam":"Company teams","project.memberadd.placeholder":"Email or phone number, press Enter","project.memberadd.placeholderForOrg":"Enter a company email or phone number, then press Enter","project.memberadd.searchCantfind":'Not results for<wbr>"%s", <wbr>enter an email or phone number to invite.',"project.menu.copy.fail":"Fail to copy this project","project.menu.copy.success":"You have copied this project: ","project.menu.mail.content":"%s has invited you to check out Teambition public project 「%s」 through URL %s","project.menu.mail.content.desc":"%s has invited you to check out Teambition public project 「%s」 through URL %s. It's about: %s.","project.menu.mail.title":"%s shared public project '%s'","project.menu.share.link":"Share URL","project.menu.share.to":"Share to","project.menu.share.to.mail":"Email","project.menu.share.to.weibo":"Share on Weibo","project.menu.weibo.content":"I found this public project 「%s」 on Teambition very helpful.","project.menu.weibo.content.desc":"I found this public project 「%s」 on Teambition very helpful. It's about: %s.","project.name":"Project Name","project.none.section":"No section selected","project.owner.search":"Search organization member","project.panel.activity.project.add.team.and.members":" added team and team members:","project.panel.activity.project.archive":" archived project","project.panel.activity.project.archive.collection":" archived folder:","project.panel.activity.project.archive.entry":" archived the entry:","project.panel.activity.project.archive.event":" archived the event: %s","project.panel.activity.project.archive.post":" archived post:","project.panel.activity.project.archive.tag":" archived tag:","project.panel.activity.project.archive.task":" archived task:","project.panel.activity.project.archive.tasklist":" archived task list:","project.panel.activity.project.archive.work":" archived file:","project.panel.activity.project.create.collection":" created folder:","project.panel.activity.project.create.entry":" created entry:","project.panel.activity.project.create.event":" created event: %s","project.panel.activity.project.create.post":" created post:","project.panel.activity.project.create.tag":" created tag:","project.panel.activity.project.create.task":" created task:","project.panel.activity.project.create.tasklist":" created task list:","project.panel.activity.project.create.works":" uploaded the file:","project.panel.activity.project.disable.application":" closed app:","project.panel.activity.project.disable.plugin":" closed plugin:","project.panel.activity.project.enable.application":" opened app:","project.panel.activity.project.enable.plugin":" opened plugin:","project.panel.activity.project.finish.task":" completed task:","project.panel.activity.project.invite.members":" invited %s to the project.","project.panel.activity.project.join.as.organization.owner":" joined project as organization owner","project.panel.activity.project.join.from.invite.link":" joined project via link:","project.panel.activity.project.join.from.qrcode":" joined project via QR Code.","project.panel.activity.project.join.from.user.invite.link":" joined project via %s's shared invite link.","project.panel.activity.project.join.from.user.qrcode":" joined project via %s's shared QR Code.","project.panel.activity.project.join.from.weixin":" joined project via Wechat.","project.panel.activity.project.redo.task":" started redoing the task.","project.panel.activity.project.remove":" deleted the project.","project.panel.activity.project.remove.collection":" deleted folder:","project.panel.activity.project.remove.entry":" deleted the entry.","project.panel.activity.project.remove.event":" deleted the event: %s.","project.panel.activity.project.remove.member":" removed member:","project.panel.activity.project.remove.post":" deleted the post.","project.panel.activity.project.remove.self":" left the project","project.panel.activity.project.remove.tag":" deleted the tag.","project.panel.activity.project.remove.task":" deleted task:","project.panel.activity.project.remove.tasklist":" deleted task list:","project.panel.activity.project.remove.team":" deleted team %s, but retained member","project.panel.activity.project.remove.team.and.members":" deleted team and team members:","project.panel.activity.project.remove.work":" deleted file:","project.panel.activity.project.transfer.to.organization":" transferred project to organization","project.panel.activity.project.transfer.to.user":" transferred project to user","project.panel.activity.project.unarchive":" unarchived project","project.panel.activity.project.unarchive.collection":" unarchived folder:","project.panel.activity.project.unarchive.entry":" unarchived entry:","project.panel.activity.project.unarchive.event":" unarchived event: %s","project.panel.activity.project.unarchive.post":" unarchived post:","project.panel.activity.project.unarchive.tag":" unarchived tag:","project.panel.activity.project.unarchive.task":" unarchived task:","project.panel.activity.project.unarchive.tasklist":" unarchived task list:","project.panel.activity.project.unarchive.work":" unarchived file:","project.panel.activity.project.update.description":" changed project description:","project.panel.activity.project.update.logo":" updated project logo.","project.panel.activity.project.update.name":" changed the project's name:","project.panel.activity.project.update.visibility":" set project as:","project.panel.entry.income":"income ¥ %s","project.panel.entry.outcome":"expenses ¥ %s","project.remove.team.remain.members":"Remove department while keeping department members","project.remove.team.remove.members":"Remove department and all department members","project.search":"Search Projects","project.section.down":"Move Down","project.section.name":"New Section","project.section.remove":"Cancel Section","project.section.up":"Move Up","project.select.list.hint":"Select a project","project.setting.defaultrole.help":'Create your own roles in <a class="link-add-handler" href="/applications/permissions/%s" target="_blank">Permission Setting</a>.',"project.setting.defaultrole.tips":"The permission of new members added is as follows:","project.setting.handler.transfer":"Transfer","project.setting.members.exceed.limit":"The number of members exceeds the limit.","project.setting.members.reach.limit":"The number of project members is at the limit.","project.setting.nav.hint":"Rearrange by dragging icons. Turn apps and plugins on and off in <a class='open-powerups'>Project settings – Apps and plugins</a>","project.setting.notification.accept":"Badge & banner","project.setting.notification.reject":"Only badge","project.setting.notification.tips":"The badge on your project cover signals new activity.","project.setting.notification.title":"Project badge","project.setting.permission.hint":"Free version does not support authority configuration","project.setting.reset.error":"Error, please try again","project.setting.reset.invite":"Only current invitation link is valid after reset","project.setting.transfer.and.quit":"You have to set a new owner to quit the project","project.setting.visibility.all":"Public","project.setting.visibility.info.all":"This project is visible to anyone with direct link. Only members can edit it.","project.setting.visibility.info.organization":"This project is visible to members. Only members can edit it.","project.setting.visibility.info.project":"Only people added to the board can view and edit it.","project.setting.visibility.organization":"Organization projects","project.setting.visibility.project":"Private","project.settings":"Project Settings","project.settings.add.member.repetitive":"%s already is a project member","project.settings.add.member.success":"You have added this member. %s will receive your invitation email soon.","project.settings.add.member.through.url.or.qrcode":"Share the below link to invite people to your project","project.settings.add.member.through.url.or.tip1":"Period of validity:","project.settings.add.members.by.emails":"Batch invite","project.settings.archive":"Archive","project.settings.archive.error":"We are unable to archive this project, please try again later.","project.settings.archive.msg":"Archive a project when it is finished or blocked, you can always activate the project later without losing any data.","project.settings.archive.success":"Project Archived, you can find it at the bottom of this page.","project.settings.button.delete":"Delete","project.settings.button.upload.cover":"Upload a new cover","project.settings.cannot.quit":"Cannot leave the project!","project.settings.cannot.quit.content":"Sorry! You've already joined this project as a team member. You can't leave by yourself.","project.settings.cannot.remove":"该成员作为团队加入项目，不能单独移除","project.settings.delete":"Delete Project","project.settings.delete.msg":"Once you delete this project, all its content will be erased permanently and can not be recovered, please be cautious!","project.settings.delete.success":"Project deleted","project.settings.desc.placeholder":"Please describe your project briefly","project.settings.email.sent30":"Sent (Try again after 30s)","project.settings.label.actions":"Actions","project.settings.label.permission":"Default permission","project.settings.label.project.cover":"Project cover","project.settings.label.sort":"Tabs","project.settings.label.subtitle.actions":"Action with caution","project.settings.leave":"Leave","project.settings.leave.msg":"Once you leave this project, you will not be able to view any of its content. If you want to join it again, please contact the admin.","project.settings.leave.success":"You have left the project","project.settings.logo.crop.image.size.too.large":"File too large. Please select files within 4 MB!","project.settings.logo.upload.failed":"Failed to update project cover","project.settings.logo.upload.success":"Project cover has been updated","project.settings.member.menu":"Member menu","project.settings.member.menu.set.role":"Add or manage members with authority","project.settings.member.menu.upgrade.button":"Upgrade to gain more roles","project.settings.member.menu.upgrade.description":"Admin, owner and custom roles","project.settings.member.reach.limit":"The current number of members is %s, upgrade to invite more members","project.settings.member.reach.limit.org":"Current capacity of the number of members is %s. Increase the quota of organization members to invite more members","project.settings.no.exist.warn":"Sorry, but there is a problem, please try later","project.settings.no.right.warn":"Sorry, you do not have the permission to transfer this project, please confirm and try again","project.settings.over.plan.warn":"Please upgrade your payment plan and try again","project.settings.placeholder":"Enter &quot;DELETE&quot; to confirm","project.settings.remove.member":"Remove","project.settings.resend":"Resend invitation email","project.settings.save.success":"Saved successfully","project.settings.select.owner":"Select a new owner","project.settings.tab.activity":"Project activity","project.settings.tab.infomation":"Project details","project.settings.tab.more":"More","project.settings.tab.preference":"Project settings","project.settings.transfer":"Transfer projects","project.settings.transfer.confirm":"Confirm transferring project","project.settings.transfer.members.exceed.2org":"The quota of project members of the company is %s, less than the current number of project members. Please contact the organization owner to increase the quota of members, or reduce the current number of project members.","project.settings.transfer.members.exceed.2user":"The quota of project members of the target individual is %s, less than the current number of project members. Please contact the him(her) to increase the quota of members, or reduce the current number of project members.","project.settings.transfer.roles.change.1":"After transferring the project, you will no longer be its owner","project.settings.transfer.roles.change.2":"After transferring the project, you will no longer be its owner. The project will not be able to use the relevant functions of pro account any more!","project.settings.transfer.roles.change.3":"After transferring the project, you will no longer be its owner. The project will not be able to configure admin authority, an not continue to use extensions!","project.settings.transfer.success":"Successfully transferred project","project.settings.visibility":"Visible as","project.switcher.no.result":"Sorry, No search results","project.switcher.placeholder":"Search projects","project.tags":"Tags","project.transfer.success":"Transfered","project.transferring":"Transferring","projects.export":"Export projects","projects.import":"Import projects","projects.manager.all.project":"All projects","projects.transfer.to.organization":"Move spaces to organization.","projects.transfer.to.organization.confirm":"Confirm Transfer","projects.transferIn":"Import projects","projects.transferIn.btn":"Import","projects.transferIn.to":"Import to","projects.transferOut":"Export Projects","projects.transferOut.btn":"Export","projects.transferOut.to":"Export to","quit.success":"You have successfully exited the department","remind.add":"Reminder","remind.ago":"Before %s","remind.close":"Turn alerts off","remind.happened":"At the time of meeting","remove.success":"Done","repeat.add":"Recurrence","repeat.description.daily":"Recur every %1 days","repeat.description.monthly":"Meeting will recur on %2 every %1 months","repeat.description.weekly":"Meeting will occur on %2 every %1 weeks","repeat.freq.CUSTOM":"Customization","repeat.freq.DAILY":"Every day","repeat.freq.MONTHLY":"Every month","repeat.freq.NO":"No repeat","repeat.freq.WEEKLY":"Every week","repeat.freq.WORKDAY":"Every weekday","repeat.freq.YEARLY":"Every year","repeat.interval":"Interval","resend.success":"Successfully resent","screen.crop":"Screencap","scrum.filter.clear":"Clear Filter","scrum.filter.hide.done":"View uncompleted tasks","scrum.filter.search":"Search","scrum.filter.title":"Task Filter","scrum.filter.today.update":"View tasks updated today","scrum.sort.created":"Newest","scrum.sort.custom":"Default","scrum.sort.duedate":"Deadline","scrum.sort.in.save":"Save","scrum.sort.priority":"Priority","scrum.sort.save":"Save and apply to everyone","scrum.sort.startdate":"Sort by start time.","scrum.sort.title":"Sort by:","scrum.sortandfilter.title":"Sort and filter","search.archived":"Archived","search.no.content":"No content","search.no.result":"Sorry, we can't find anything about '%s'","search.placeholder":"Quick Search, find what you need","search.project":"Project","search.result.all.type":"All Types","set.success":"Successfully set","settings.no.permission":"No editing permission granted. Please contact project owner for editing permission.","simditor.add.link.title":"Add Hyperlink","simditor.alignCenter":"Align Center","simditor.alignLeft":"Align Left","simditor.alignRight":"Align Right","simditor.alignment":"Alignment","simditor.blockquote":"Block Quote","simditor.bold":"Bold","simditor.code":"Code","simditor.color":"Text Color","simditor.coloredText":"Colored Text","simditor.deleteColumn":"Delete Column","simditor.deleteRow":"Delete Row","simditor.deleteTable":"Delete Table","simditor.externalImage":"External Image","simditor.hr":"Horizontal Line","simditor.image":"Insert Image","simditor.imageAlt":"Alt","simditor.imageSize":"Size","simditor.imageUrl":"Url","simditor.indent":"Indent","simditor.insertColumnLeft":"Insert Column Left","simditor.insertColumnRight":"Insert Column Right","simditor.insertRowAbove":"Insert Row Above","simditor.insertRowBelow":"Insert Row Below","simditor.italic":"Italic","simditor.link":"Insert Link","simditor.linkText":"Link Text","simditor.linkUrl":"Link Url","simditor.normalText":"Text","simditor.ol":"Ordered List","simditor.outdent":"Outdent","simditor.removeLink":"Remove Link","simditor.restoreImageSize":"Restore Origin Size","simditor.selectLanguage":"Select Language","simditor.strikethrough":"Strikethrough","simditor.table":"Table","simditor.text":"Text","simditor.title":"Title","simditor.ul":"Unordered List","simditor.underline":"Underline","simditor.upload":"Upload","simditor.uploadError":"Error occurs during upload","simditor.uploadFailed":"Upload failed","simditor.uploadImage":"Upload Image","simditor.uploading":"Uploading","stage.add.tip":"New list","stage.edit.title":"Add or edit stage","stage.menu.add.next.stage.title":"Add new list","stage.menu.add.stage.hint":"The new list will be added next to the current one","stage.menu.add.title":"Add List","stage.menu.archive.tasks.title":"Archive all tasks in this list","stage.menu.cannot.delete":"Please clean all tasks on this list and then delete it","stage.menu.confirm.archive.tasks":"all tasks in this list will be archived,you can view archived cards and bring them back at 'Archived items'","stage.menu.confirm.delete":"Are you sure you want to delete this stage permanently","stage.menu.date.picker":"Set up due date for all the tasks at the list","stage.menu.date.picker.clear.success":"Due date cleared","stage.menu.date.picker.error":"Conflicting starting time and due time","stage.menu.date.picker.success":"Due date added","stage.menu.date.picker.title":"Due date","stage.menu.delete.title":"Delete List","stage.menu.edit.title":"Edit List","stage.menu.lock.stage":"Switch to workflow mode","stage.menu.lock.stage.msg":"In workflow mode, all the tasks in this stage will become tasks done. And all the completed tasks in other stages will be added to this stage automatically to form the task flow","stage.menu.move.tasks.success":"successfully moved all tasks.","stage.menu.move.tasks.title":"Move all tasks in this list","stage.menu.stage.name":"List Name","stage.menu.title":"List Menu","stage.menu.toggle.stage.tasks.executor":"Assign this list","stage.menu.toggle.stage.tasks.executor.success":"Successfully select executor","stage.menu.toggle.stage.tasks.executor.title":"assign","stage.menu.unlock.stage":"Switch to free mode","stage.menu.unlock.stage.msg":"In free mode, you can add new lists after the current one. You will quit the task flow mode and all the lists are independent","stage.selector.changed.tips":"Group message has changed, please choose again","stage.selector.tips":"You can change group or list of task in the scrume.","stage.selector.title":"Select Location","submit.post":"Post","submit.ticket.chat.with.us":"Live Chat","submit.ticket.email":"Type your email address","submit.ticket.menu.online.classroom":"Online course","submit.ticket.menu.support":"Support","submit.ticket.menu.video":"Tutorials","submit.ticket.other":"Other","submit.ticket.pl.anything":"Anything else you want to see","submit.ticket.pl.help":"Type here","submit.ticket.pl.suggestion":"Any suggestions?","submit.ticket.question":"Question","submit.ticket.send":"Send","submit.ticket.success":"Awesome! We get your feedback, and you will have our reponse shortly via %s","submit.ticket.suggestion":"Suggestions","submit.ticket.title":"Support",
"subtask.card.create.input.placeholder":"Type in content...","subtask.card.create.placeholder":"Add a subtask","subtask.menu.confirm.delete":"Do you want to delete this subtask?","subtask.menu.confirm.transform":"Confirm transform to task?","subtask.menu.delete.title":"Delete Subtask","subtask.menu.title":"Subtask Menu","subtask.menu.transform.title":"Convert to a task","tag.creator.placeholder":"Tag name","tag.creator.title":"New Tag","tag.creator.warning.name.exit":"This tag already exists!","tag.menu.confirm.delete":"Are you sure you want to delete this tag permanently?","tag.menu.delete.title":"Delete Tag","tag.menu.edit.title":"Edit Tag","tag.menu.title":"Tag Menu","tag.picker.add":"Add a tag","tag.picker.none":"No tag yet.","tag.view.create":"New Tag","tag.view.entry.info":"%s entries","tag.view.event.info":"%s meetings","tag.view.file.info":"%s files","tag.view.placeholder.info":"Click 'New Tag' to create tags. It is a different way of managing your project.","tag.view.placeholder.infoLink":"Here are some tips of using tags. <a href='https://www.teambition.com/research/best-practices/article?p=research-best-practices&s=&_id=5439058462c0c4b62f57c23c' class='link-add-handler' target='_blank'>Learn Now</a>.","tag.view.placeholder.title":"No tag in the project","tag.view.post.info":"%s posts","tag.view.task.info":"%s tasks","target.event.closed":"This project's schedule has already been closed.","target.event.fork.post.denied":"You don't have permission to copy to this project.","target.event.move.post.denied":"You don't have permission to move to this project.","target.post.closed":"This project's post has already been closed.","target.post.fork.post.denied":"You don't have permission to copy to this project.","target.post.move.post.denied":"You don't have permission to move to this project.","target.work.closed":"This project's files have been closed.","target.work.fork.post.denied":"You don't have permission to copy to this project.","target.work.move.post.denied":"You don't have permission to move to this project.","task.creator.add":"New Task","task.creator.content":"Task","task.creator.multiple":"Create Multiple Tasks","task.creator.multiple.all":"Create %s tasks","task.creator.multiple.desc":"You have entered %s lines. If you want, the system can create a task for every new line.","task.creator.multiple.one":"Create one task","task.creator.multiple.too.many":"Too many lines","task.creator.multiple.too.many.confirm":"Okay, I know...","task.creator.multiple.too.many.desc":"Limited number of content up to %s lines, you have entered a total of %s lines.","task.creator.set.duedate":"Set due time","task.creator.set.startdate":"Set start Time","task.creator.tips":"Create a task to","task.detail.add.note":"Add a note","task.detail.archived":"Archived task can not be edited.","task.detail.complete":"Completed the task","task.detail.due.date":"Due date","task.detail.executor":"Assigned to","task.detail.no.executor":"Not Assigned","task.detail.priority":"Priority","task.detail.priority.info":"Priority","task.detail.redo":"Redo the task","task.detail.remind":"Alert","task.detail.repeat":"Repeat","task.detail.repeat.info":"Repeat","task.detail.setting.remind":"Snoozed %s","task.detail.stage":"On List","task.detail.stage.unset":"Unset","task.detail.start.date":"Starting time","task.detail.tasklist":"In Group ","task.detail.time.click.set":"Click here","task.dueDate.label":"Due %s","task.group":"Group","task.group2":"Task Group","task.list.belong.to":"Belong to task: %s","task.list.no.task":"No task in this week","task.menu.confirm.delete":"Do you want to delete the task?","task.menu.copy":"Copy","task.menu.copy.check.link":"Former task will receive converted task's activity notificaition","task.menu.copy.check.linked":"Coverted task will receive former task's activity notification","task.menu.copy.fail":"The task copy failed","task.menu.copy.success":"Your task has been copied: ","task.menu.copy.tips":"Task content, subtask, note will be copied","task.menu.delete.title":"Delete Task","task.menu.move":"Move","task.menu.move.fail":"The task move failed","task.menu.move.success":"Your task has been moved: ","task.menu.move.tips":"When moving tasks between projects,  some followers will not be moved.","task.menu.search.project":"Search project","task.menu.select.group":"Select task group","task.menu.select.project":"Select project","task.menu.select.stage":"Select list","task.menu.title":"Task Menu","task.menu.warning":"Please select a task group and list","task.placeholder":"No Task","task.recent.placeholder":"You don't have any task or meeting yet","task.startDate.label":"Starting %s","task.viewl.authority.msg":"Only %s can change the completion status","tasklist.bar.add.group":"Add task group","tasklist.bar.done.tasks":"Done","tasklist.bar.member.tasks":"By member","tasklist.bar.memberOf.tasks":"%1's tasks","tasklist.bar.pin":"Pin the task group bar","tasklist.bar.search.group":"Search task group","tasklist.bar.smart.group":"Smart Group","tasklist.bar.today.tasks":"For today","tasklist.bar.total.tasks":"All","tasklist.bar.unassigned.tasks":"Unassigned","tasklist.bar.unpin":"Unpin the task group bar","tasklist.creator.new":"Create New","tasklist.creator.submit":"Create","tasklist.creator.tasklist.desc":"Task Group Description","tasklist.creator.tasklist.title":"Task Group Title","tasklist.creator.temp":"Templates","tasklist.dump.confirm":"Confim Export","tasklist.dump.hint":"Select the task group that need to be exported","tasklist.menu.add.templates":"Save as a template","tasklist.menu.add.templates.desc":"You can use it in (task group &gt; create &gt; templates)","tasklist.menu.add.templates.detail":"Save current lists as a template","tasklist.menu.add.templates.success":"Added %s successfully","tasklist.menu.confirm.archive":"Are you sure that you want to archive this task group","tasklist.menu.confirm.delete":"Are you sure that you want to delete this task group permanently","tasklist.menu.delete.title":"Delete Task Group","tasklist.menu.edit.title":"Edit Task Group","tasklist.menu.last.cannot.edit":"Sorry, you can't archive or delete the last task group","tasklist.menu.tasklist.desc":"Task Group Description","tasklist.menu.tasklist.title":"Task Group Title","tasklist.menu.templates":"Name this template","tasklist.menu.title":"Task Group Menu","tasklist.tab.status.done":"Done","tasklist.tab.status.normal":"Recent","tasklist.tab.status.overdue":"Overdue","tasklist.tab.status.upcoming":"Upcoming","tasklist.temp1stage1":"Planning","tasklist.temp1stage2":"Prototype","tasklist.temp1stage3":"Rendering","tasklist.temp1stage4":"Review","tasklist.temp1stage5":"Completed","tasklist.temp1title":"Design","tasklist.temp2stage1":"Demand","tasklist.temp2stage2":"Designing","tasklist.temp2stage3":"Researching","tasklist.temp2stage4":"Testing","tasklist.temp2stage5":"Published","tasklist.temp2title":"Research","tasklist.temp3stage1":"User question","tasklist.temp3stage2":"Solving","tasklist.temp3stage3":"Solved","tasklist.temp3stage4":"Feedback&Solved problems","tasklist.temp3title":"User support","tasks.no.task":"No tasks scheduled.","team.belongsTo":"Belongs to: %s","team.create":"New department","team.create.placeholder":"Name","team.create.sub":"Sub-department","team.create.sub.placeholder":"Name","team.create.success":"Department created successfully","team.detail":"Department details","team.mananger.add":"Add to department","team.mananger.quit":"Exit","team.mananger.remove":"Remove","team.manger.events":"Meetings","team.manger.no.member":"No one has joined here","team.manger.no.project":"This team hasn't joined any projects yet.","team.manger.project.confirm.remove":"Are you sure you want to remove this project?","team.manger.project.confirm.title":"Remove project from team","team.manger.tasks":"Tasks","team.member.add":"Add member to department","team.member.menu":"Department  Menu","team.member.remove":"Remove from department","team.member.remove.content":"This member will also be removed from department projects after this","team.member.search.placeholder":"Search %s","team.member.subteam":"Sub-department members","team.member.team":"Department members","team.members.count":"%s members","team.menu":"Department","team.menu.confirm.delete":"Are you sure you want to delete this team permanently","team.menu.delete.title":"Delete","team.menu.edit.title":"Edit","team.name":"%s department have participated in the following projects.","team.projects":"Department projects","team.projects.add":"Add other projects","team.projects.add.search":"Search projects","team.projects.add.title":"Add team into project","teambition.title":"Teambition · Best collaboration tool","teams.split":"/","this.stage":"this list","this.task":"this task","time.format.error":"Wrong format","time.input.placeholder":"Time","time.setting.error":"Conflicting starting time and due time","today.events":"Today","token.expired":"Token expired, please ","token.reauth":"Reauthorize","total.events.and.tasks":"%s in total","unarchived.entry.success":"Done","unarchived.event.success":"Successfully unarchived meeting","unarchived.file.success":"Successfully unarchived file","unarchived.folder.success":"Successfully unarchived folder","unarchived.post.success":"Successfully unarchived post","unarchived.tag.success":"Successfully unarchived tag","unarchived.task.success":"Successfully unarchived task","unarchived.taskgroup.success":"Successfully unarchived task group","unarchived.tasklist.tip":"The project has closed the function of task group, please open task group function and cancel automatic operation.","update.file":"Update","uploader.error":"file uploading failed","uploader.file.exceed":"This size of this document is at the limit","uploader.file.exceed.size":"The file %s has exceeded the limit of 1GB!","uploader.file.exceed.size.default":"The document is oversized, please select a document within 10M!","uploader.file.exceed.size.free":"The document %s is oversized, please select a document within 200M! 1G documents will be supported after upgrade.","uploader.files.duplicate":"The file has already been uploaded!","uploader.files.exceed.number":"Up to %s files each time!","uploader.not.accept":"File type is not supported, or file size is 0","uploader.type.no.allowed":"File type(.%s)is not supported, you can compress it before uploading","uploading.tip":"Uploading","user.satisfaction.bad":"完全不愿意","user.satisfaction.feedback.0":"感谢评价，你觉得 Teambition 在哪些地方不够好？","user.satisfaction.feedback.1":"感谢评价，你觉得 Teambition 还需要怎样改进？","user.satisfaction.feedback.2":"感谢评价，你最喜欢 Teambition 的哪些功能？","user.satisfaction.good":"非常愿意","user.satisfaction.placeholder":"写一些反馈...","user.satisfaction.recommend":"你有多大意愿向你的朋友推荐 Teambition?","user.satisfaction.send":"发送","user.settings.comment.notice":"Comment notice","user.settings.daily.mail.notice":"Daily email notification for works","user.settings.mobile":"Mobile","user.settings.monthly.mail.notice":"Monthly newsletter","user.settings.notification.setting":"Notification","user.settings.participant.notice":"Participant notice","user.settings.preference.usePanelTitle":"Open tasks in the sidebar","user.settings.receive.event.notice":"Received meeting notice","user.settings.receive.file.notice":"Received file notice","user.settings.receive.post.notice":"Received post notice","user.settings.receive.task.notice":"Received task notice","user.settings.setting":"Preferences","user.settings.task.file.update.notice":"Received notice when task or file update","visible.close":"Closed","visible.mode":"Privacy mode","visible.open":"On","visible.to.involve":"Visible to followers","visible.to.member":"Visible to project members","wall.view.create.post":"New Post","wall.view.html.post":"Regular Document","wall.view.markdown.post":"Markdown Document","wall.view.post.creator.info":"Posted by %s at ","wall.view.post.order.create.time":"Last posted","wall.view.post.order.reply.time":"Last replied to","wall.view.shimo.post":"Shimo Docs","wall.view.shimo.update":"Refresh Doc","wall.view.yiqixie.post":"CoWrite Docs","wall.yiqixie.default.title":"CoWrite Default Titile","week.selector.search":"Search","weibo.menu1":"Following","weibo.menu2":"My Weibo","weibo.menu3":"@me","weibo.menu4":"Friends' Circle","work.copy.message":"Copy file: %s to","work.copy.success":"File copied successfully!","work.creator.info":"Uploaded by %s at ","work.creator.tips":"Upload files to ","work.edit.title":"File Name","work.menu.archive.file":"Archive File","work.menu.confirm.delete":"Are you sure you want to delete this file permanently","work.menu.copy.file":"Copy File","work.menu.delete.title":"Delete File","work.menu.move.file":"Move File","work.menu.title":"File Menu","work.move.message":"Move file %s to","work.move.success":"File moved successfully!","work.move.title":"Move File","work.picker.from.dropbox":"Choose from Dropbox","work.picker.from.library":"Choose from files","work.picker.from.link":"Download link...","work.picker.title":"Add Attachments","work.picker.uploader":"Choose from computer","work.rename.title":"Rename File","work.versions.current":"Current version","work.versions.enter.edit":"Edit description of this version.","work.versions.title":"Versions","works.background.uploader.close.confirm":"We are uploading your files, do you want to close it?","works.background.uploader.close.confirm.title":"Close","works.background.uploader.error":"files uploading failed","works.background.uploader.uploaded":"files uploaded","works.background.uploader.uploading":"uploading files %s/%s","works.uploader.uploading.total":"%s file(s) are uploading..."}),n.setLocales("ja",{"1day":"1日","1hour":"1時間","20mins":"20分","4hours":"4時間",FRI:"金曜日",MON:"月曜日",SAT:"土曜日",SUN:"日曜日",THU:"木曜日",TUE:"火曜日",WED:"水曜日",add:"追加",added:"已添加",all:"全部",archive:"アーカイブ",back:"戻る",birthday:"誕生日",bookkeeping:"記帳",bound:"立即绑定",by:"by",calendar:"カレンダー",cancel:"キャンセル",clickToEdit:"押して編集する",close:"閉める",collapse:"折る",collection:"フォルダ",colon:"：",comma:"、",confirm:"確認",connected:"ネットワークに接続しました。お帰りなさい",copyAs:"コピーを",copyTo:"コピー先を次の場所に指定",create:"作成",creator:"作成者",day:"天","delete":"削除",disconnected:"ネットワークに接続できません。再度お試しください",done:"完成",draft:"コンテンツが保存されていない場合.",edit:"編集",email:"メール",entries:"帐目",entry:"エントリー",error:"エラーが発生しました",event:"予定",events:"予定",executor:"担当者",expand:"展開",favorite:"お気に入り",file:"ファイル",files:"ファイル",fullStop:"。",groupchat:"群聊",guest:"ゲスト",hide:"非表示",inbox:"受信トレイ",language:"日本語",location:"所在地",login:"ログイン",logout:"ログアウト",manager:"管理者",me:"私",member:"メンバー",merge:"merge",mobile:"携帯",month:"月",more:"もっと",moveTo:"移動する。場所は",my:"自分",noRight:"権限なし",none:"无",open:"開ける",organization:"組織",owner:"オーナー",plugin:"应用与插件",position:"職位",post:"ポスト",posts:"ポスト",project:"プロジェクト",projects:"プロジェクト","public":"公开",register:"登録",remove:"削除",renew:"续费",repeat:"重复",reply:"返信",rmb:"元",save:"保存",search:"検索",setting:"設定",show:"表示",stage:"ステージ",tags:"タグ",task:"タスク",tasklist:"任務パケット",tasks:"タスク",team:"部門",today:"今日",unarchive:"アーカイブを解除",unfavorite:"お気に入りから外す",unknown:"未知",unknownDate:"日付なし",updated:"に更新されました",upgrade:"升级",upload:"アップロード",view:"チェックする",website:"ウエブサイト",week:"週",works:"文件","acitivity.timeline.notif.none.tip":"通知を受け取る人はいません","acitivity.timeline.notif.tip":"人通知を受けることになります","activity.card.body.checkMore":"もっと見る","activity.card.create.headerTips":"作成プロジェクト","activity.card.error.notFound":"%sが見つかりませんでした。すでに削除された可能性があります。","activity.card.project.title":"任务统计","activity.card.table.doneTasks":"終了","activity.card.table.placeholder":"最近のプロジェクトの進捗状況","activity.card.table.title":"タスク統計","activity.card.table.todoTasks":"進行中","activity.card.today.title":"今日の計画","activity.card.unassigned.title":"タスクの担当から外れる","activity.comment.link.title":"关联内容","activity.destroyer.confirm.delete":"このコメントを完全に削除しますか？","activity.destroyer.delete":"コメントを削除","activity.destroyer.delete.fail":"削除できません、再度お試しください","activity.destroyer.delete.success":"削除しました","activity.download.all.attachments":"添付ファイル","activity.early.hidden":"显示更早的%s条评论","activity.early.loading":"正在载入更早的评论...","activity.early.shown":"隐藏较早的评论","activity.editor.error":"編集に失敗しました","activity.editor.place.holder":"コメントを編集…","activity.editor.success":"編集完了","activity.editor.title":"コメントを編集","activity.invisible.not.involved.tip1":"このコンテンツは参加者のみ表示することが可能です。 %1 はまだ参加者ではありません。<a class='add-involve'> 参加者に追加する</a>と、%2に更新があった際に通知を受けて取れるようになります。","activity.invisible.not.involved.tip2":"このコンテンツは参加者のみ表示することが可能です。 %1 はまだ参加者ではありません。 <a class='add-involve'>参加者に追加する</a>と、 %2に更新があった際に通知を受けて取れるようになります。","activity.invisible.not.member.tip1":"この内容はメンバーのみに公開され、指定した %sはまだ項目に追加されていませんが、お知らせされます","activity.invisible.not.member.tip1.addmember":" 、<a class='add-member-involve'>を項目に追加し参加者と指定できます</a>。","activity.invisible.not.member.tip2":"この内容はメンバーのみに公開され、指定した %sなど%s人はまだ項目に追加されていませんが、お知らせされます","activity.invisible.not.member.tip2.addmember":"、<a class='add-member-involve'>を項目に追加し参加者と指定できます</a>。","activity.invisiblea.addmember.success":"メンバーを項目に追加しました","activity.moreAttachments":"全部で","activity.moreFiles":"つのファイル","activity.panel.checkAll":"プロジェクトの動向を全て確認する","activity.panel.filter.allMember":"全メンバー","activity.panel.filter.allType":"すべて種類","activity.panel.filter.date":"時間","activity.panel.filter.member":"メンバー","activity.panel.filter.system":"システムメッセージ","activity.panel.filter.type":"タイプ","activity.panel.invite":"新メンバーに要請を送りました","activity.panel.menu.calendar":"プロジェクトの購読","activity.panel.menu.checkArchive":"アーカイブをチェック","activity.panel.menu.config":"应用与插件","activity.panel.menu.copy":"プロジェクトコピーする","activity.panel.menu.enterOrg":"グループを作成しました。今すぐ同僚を招待しましょう。","activity.panel.menu.export.tasks":"导出分组内所有任务","activity.panel.menu.share":"プロジェクトをシェアする","activity.panel.placeholder.searchMember":"メンバー検索","activity.panel.title.activities":"プロジェクトの活動","activity.panel.title.all":"プロジェクト・メニュー","activity.panel.weeker.all":"すべて","activity.system.handlers.enterorg":"前往企业：%s","activity.system.handlers.enterproject":"前往项目：%s","activity.system.handlers.openchat":"前往私信：%s","activity.timeline.add.attachment":"添付ファイル","activity.timeline.add.emoji":"絵文字の新規","activity.timeline.comment":"他のメンバーを＠できる。「Enter」：投稿する","activity.timeline.comment.ghost":"<a class='login-handler'>ログイン</a>または<a class='register-handler'>登録</a>後にコメント可能になります","activity.timeline.like":"いいね！","activity.timeline.like.tips.long":" %s人が「いいね！」と言っています。","activity.timeline.like.tips.short":" 「いいね！」と言っています。","activity.timeline.only.attachment":"添付のみ","activity.timeline.only.comment":"コメントのみ","activity.timeline.remove.like":"「いいね！」を取り消す。","activity.timeline.reply":"返信","activity.timeline.reply.enter":"Enterで発送","activity.timeline.reply.quickly.placeholder":"他のメンバーを＠できる。「Ctrl+Enter」を押して返信","activity.timeline.reply.shortcut":" Ctrl+Enter で発送","activity.visible.not.involved.tip1":"言及した %1 はまだ参加者ではありません。 <a class='add-involve'>参加者に追加 </a>すれば、%2に更新があった際に通知がこのユーザーに送られます。","activity.visible.not.involved.tip2":"言及した %1ら %2人はまだ参加者ではありません。<a class='add-involve'>全員を参加者に追加</a>すれば%3に更新があった際に通知がこのユーザー全員に送られます。","activity.visible.not.involved.tip3":"あなたはまだ参加者ではありません。 <a class='add-involve'>参加者として加わる</a>と、 %sに更新があった際に通知を受け取ることができます。","activity.visible.not.involved.tip4":"あなたと %1 はまだ参加者ではありません。  <a class='add-involve'>参加者として加わる</a>と %2に更新があった際に通知を受け取ることができます。","activity.visible.not.member.tip1":"指定した %sはまだ項目に追加されていませんが、お知らせされます","activity.visible.not.member.tip1.addmember":"， <a class='add-member'>を項目に追加できます</a>。","activity.visible.not.member.tip2":"指定した %sはまだ項目に追加されていませんが、お知らせされます","activity.visible.not.member.tip2.addmember":"， <a class='add-member'>を項目に追加できます</a>。","add.members.by.cooperated":"協力メンバーを追加","add.members.by.cooperated.placeholder":"協力したメンバーはまだいません","add.members.by.emails":"メールでメンバーを一括インポート","add.members.by.emails.placeholder":"将邮箱粘贴到这里，多个邮箱之间用换行分隔，每次最多添加20个。当前项目剩余成员名额%s人。","add.members.by.emails.placeholder.unlimit":"将邮箱粘贴到这里，多个邮箱之间用换行分隔，每次最多添加20个。","add.members.error.limit":"リミットを超えました。一度に追加できるメールアドレスは２０個までです。","add.members.error.message":"企業メンバーは上限に超えている","add.members.tips.add.exceed":"ライセンスが %s 足りません","add.members.tips.add.remian":"ライセンスが残り %s","add.success":"追加しました","all.member":"全メンバー","all.project":"すべてのプロジェクト","already.inbox.later.message":"後で処理する","already.inbox.later.message.hint":"%s で改めてお知らせします","app.download":"アプリ・ダウンロード","archive.event":"予定をアーカイブ","archive.file":"ファイルをアーカイブ","archive.folder":"フォルダーをアーカイブ","archive.post":"ポストをアーカイブ","archive.tag":"タグをアーカイブ","archive.task":"タスクをアーカイブ","archive.taskgroup":"タスクグループをアーカイブ","archive.title":"チェックする","archived.event.success":"予定がアーカイブされました","archived.file.success":"ファイルがアーカイブされました","archived.folder.success":"フォルダーがアーカイブされました","archived.post.success":"ポストをアーカイブしました","archived.projects":"アーカイブしたプロジェクト","archived.tag.success":"タグをアーカイブしました","archived.task.success":"タスクをアーカイブしました","archived.taskgroup.success":"タスクグループをアーカイブしました","at.not.involved":"は参加者ではありません","authority.get.error":"すみません、この内容にアクセスする権限がありません","authority.get.error.content":"管理員に連絡し訪問権限を調整し、或は追加してもらってください","board.stage.sortplaceholder":"マウスのボタンを離し、タスクをその段階に","bookkeeping.archived":"このエントリをアーカイブしました","bookkeeping.home.fields.amount":"金額","bookkeeping.home.fields.category":"カテゴリー","bookkeeping.home.fields.content":"内容","bookkeeping.home.fields.creator":"作成者","bookkeeping.home.fields.date":"時間","bookkeeping.home.fields.tags":"タグ","bookkeeping.home.header.filter.toggler.title":"フィルターと設定","bookkeeping.home.header.filtering":"（フィルター中）","bookkeeping.home.tips.header.approve":"承認者をまだ設定していません。承認者のみ記帳入力を承認できます。<a class='bookkeping-setting-approver'>今すぐ承認者を設定しましょう</a>。","bookkeeping.home.tips.placeholder":"毎回の支出を記録できます","bookkeeping.home.tips.placeholder.approve":"（承認者のみ記帳入力を承認できます。<a class='bookkeping-setting-approver'>帳簿をつける前に承認者を設定してください</a>。）","bookkeeping.home.total.expense":"総支出","bookkeeping.home.total.expense.filtered":"フィルター後の支出項目","bookkeeping.home.total.income":"総収入","bookkeeping.home.total.income.filtered":"フィルター後の収入項目","bookkeeping.panel.filter.end.date":"終了日","bookkeeping.panel.filter.hide.approved":"承認済みの帳簿を非表示","bookkeeping.panel.filter.start.date":"開始日","bookkeeping.panel.input.placeholder":"帳簿項目をフィルター","bookkeeping.panel.title.filter":"フィルター","bookkeeping.panel.title.filter.clear":"フィルターをクリアする","bookkeeping.panel.title.settings":"帳簿設定","bookkeeping.settings.approver.member":"承認者","bookkeeping.settings.approver.tips":"承認者のみ帳簿を承認できます。複数の承認者を設定することが出来ます。","bookkeeping.settings.approver.title":"承認者設定","bookkeeping.settings.category.edit.placeholder":"カテゴリー名","bookkeeping.settings.category.title":"カテゴリー設定","bookkeeping.settings.expense.tips":"支出","bookkeeping.settings.fields.in":"使用中のフィールド","bookkeeping.settings.fields.out":"未使用のフィールド","bookkeeping.settings.fields.title":"帳簿フィールド設定","bookkeeping.settings.income.tips":"収入","calendar.add.subscriber":"添加关注","calendar.invisivle.event.tip1":"%sら%s人はすでにアサインされています","calendar.invisivle.event.tip2":"%sはすでにアサインされています","calendar.search.no.result":"検索に一致する結果は見つかりませんでした。","calendar.search.subscriber":"搜索","calendar.show.event":"日程","calendar.show.task":"任务","calendar.subscriber.display.title.recommend.members":"最近協力したメンバー","calendar.subscriber.display.title.self.projects":"個人項目","calendar.subscriber.display.title.starred.projects":"星標項目","calendar.subscriber.is.empty":"点击下方「添加关注」<br />添加你所关心的成员或项目","calendar.subscriber.search.placeholder.member":"メンバーを探す","calendar.subscriber.search.placeholder.project":"項目を探す","calendar.subscriber.search.placeholder.team":"部門を探す","calendar.subscriber.tab.member":"成员","calendar.subscriber.tab.project":"项目","calendar.subscriber.tab.recommend":"推荐","calendar.subscriber.tab.team":"部門","calendar.subscriber.title":"添加成员和项目日历","calendar.time":"時","cancel.inbox.later.message":"後で処理することをキャンセルしました","chat.message.at.me":"[誰か私に@]","chat.message.list.is.empty":"メッセージはありません","chat.message.list.is.error":"メッセージリストを取得できません","chat.message.list.to.refresh":"クリックで更新する","chat.modal.title":"チャット","chat.nav.popover.new.chat":"チャットを作成する","chat.room.add.emoji":"添加表情","chat.room.chat.create":"新聊天","chat.room.chat.empty1":"暂无私信消息","chat.room.chat.empty2":"在这里你会收到新私信的消息提示","chat.room.cloesd.room":"群聊已关闭","chat.room.cloesd.room.placeholder":"群聊应用已关闭","chat.room.group.empty1":"还没有群聊消息","chat.room.group.empty2":"项目中的成员都可以在这里参与群聊","chat.room.group.mute":"お知らせを閉める","chat.room.member.empty1":"暂无成员","chat.room.member.empty2":"邀请你的同伴开始协作吧！","chat.room.new.private.msg":"私信","chat.room.new.project.msg":"群聊","chat.room.placeholder":"说点什么...","chat.room.send":"发送","chat.room.send.error":"发送私信失败，请重新尝试","chat.room.send.success":"发送私信成功，您可以在收件箱<a class='essage-url url-handler open-inbox-chat' data-id='%s'>私信列表</a>查看","collection.creator.collection.title":"フォルダ名","collection.creator.create.success":"フォルダが作成されました","collection.creator.duplication.title":"フォルダ名が既に存在します","collection.destroyer.confirm.delete":"%sを完全に削除するのかを確認してください","collection.destroyer.delete.fail":"削除できませんでしたので、再度お試しください","collection.destroyer.delete.success":"削除しました","collection.destroyer.deleting":"削除しています","collection.destroyer.title":"削除","collection.download.title":"下载文件夹","collection.edit.duplication.title":"フォルダー名が既に存在します","collection.menu.confirm.delete":"このフォルダを完全に削除するのかを確認してください","collection.menu.delete.title":"フォルダを削除","collection.menu.title":"フォルダメニュー","collection.move.message":"フォルダ%sの移動先を次の場所に指定：","collection.move.title":"フォルダを移動","collection.picker.creator.input.tips":"ファイル名","collection.picker.creator.tips":"フォルダを作る","collection.picker.select.collection":"目標フォルダを選択してください","collection.rename.title":"フォルダー名を変更","confirm.delete":"削除","confirm.unarchive.tip":"キャンセルして後に移動ルートディレクトリ、確認取り消しにする？","confirm.unarchive.tip.file":"取消归档后将移动至根目录，确认取消归档？","copy.link":"リンクをコピー","copy.link.failed":"コピー失敗","copy.link.success":"コピーする","create.event":"予定を作成します","create.event.success":"予定を作成しました：","create.post.success":"ポストを作成しました：","create.task":"タスクを作成します","create.task.success":"タスクを作成しました：","datetimepicker.date":"日期","datetimepicker.time":"时间","delete.entry":"削除記帳","delete.event":"日程を削除","delete.file":"ファイルを削除","delete.folder":"フォルダを削除","delete.post":"ポストを削除","delete.success":"削除しました","delete.tag":"タグを削除する","delete.task":"タスクを削除","delete.taskgroup":"タスクグループを削除","desktop.notification":"デスクトップ通知を有効に","desktop.notification.desc":"デスクトップ通知を有効にすると受信トレイをもっと有効に使えます。コラボレーションのさらなる効率化が可能になります","desktop.notification.disable":"デスクトップ通知を無効に","desktop.notification.enable":"デスクトップ通知を有効に","download.failed":"下载失败","draft.discard":"破棄","draft.restore":"復元","due.date":"期限","editor.mode.html":"富文本编辑","enter.organization.guide":"企业向导","enter.organization.guide.text1":"进入","enter.organization.guide.text2":"，了解和配置企业版功能。","entry.amount.unit":"¥","entry.archives.success.unarchive":"エントリーのアーカイブをキャンセルしました。","entry.category.title.null":"カテゴリーなし","entry.creator.expense.title":"支出記録","entry.creator.income.title":"収入記録","entry.creator.other.add.placeholder":"タイプの追加","entry.creator.other.category":"更に","entry.creator.placeholder.amount":"金額","entry.creator.placeholder.content":"内容","entry.creator.placeholder.note":"メモの追加","entry.detail.cost":"コスト","entry.detail.profit":"収益","entry.list.action.approve":"承認","entry.list.action.revoke":"撤回","entry.list.status.approved":"承認済","entry.menu.action.approve":"帳簿の承認","entry.menu.action.archive":"アーカイブしたエントリー","entry.menu.action.delete":"帳簿の削除","entry.menu.action.edit":"帳簿の編集","entry.menu.action.revoke":"帳簿の撤回","entry.menu.confirm.delete":"削除の確認プロジェクトですか？","entry.menu.delete.tips":"この帳簿を削除するのを確認してください。","entry.menu.success.approve":"承認済","entry.menu.success.archive":"エントリーのアーカイブを成功した。","entry.menu.success.revoke":"撤回済","entry.menu.success.unarchive":"エントリのアーカイブを解除しました","entry.menu.title":"帳簿メニュー","entry.menu.title.delete":"帳簿の削除","event.all.day.tips":"終日","event.confirm.addMember.description":"重複したスケジュールです。参加者を選択し、スケジュールに追加しください","event.confirm.addMember.title":"参加者を追加する","event.confirm.archive.description":"重複したスケジュールです。保存するスケジュールを選んでください","event.confirm.archive.title":"スケジュールを保存する","event.confirm.btn.all":"全てのスケジュール","event.confirm.btn.current":"現在のスケジュール","event.confirm.btn.next":"以降のスケジュール","event.confirm.btn.ok":"確認する","event.confirm.delete.description":"重複したスケジュールです。削除したいスケジュールを選んでください","event.confirm.delete.title":"スケジュールを削除する","event.confirm.removeMember.description":"重複したスケジュールです。削除したい参加者を選んでください","event.confirm.removeMember.title":"参加者を削除する","event.confirm.update.description":"重複したスケジュールです。保存したい変更を指定してください","event.confirm.update.following":"明日以降の全ての予定を変更しますか？","event.confirm.update.single":"この予定だけを変更しますか？","event.confirm.update.title":"重複したスケジュールを更新する","event.confirm.updateMember.description":"重複したスケジュールです。更新したい参加者を指定してください","event.confirm.updateMember.title":"参加者を更新する","event.confirm.updateRepeat.description":"重複したルールを以後のスケジュールに追加しますか？","event.confirm.updateRepeat.title":"重複したルールを更新する","event.creator.all.day":"終日","event.creator.edit.tips":"予定を編集","event.creator.edit.title":"予定を編集","event.creator.end.time":"終了時間","event.creator.end.time.error":"時間フォーマットが不正です","event.creator.location.placeholder":"場所","event.creator.save.after":"今後の予定を更新","event.creator.save.single":"今回の予定のみを更新","event.creator.start.time":"開始時間","event.creator.tips_1":"予定をここに追加します ","event.creator.tips_2":"&empty;","event.creator.title.placeholder":"予定のタイトル","event.detail.appearin.tips":"Appearinビデオ会議（8 人まで）","event.detail.archived":"このイベントをアーカイブ","event.detail.end.date.tips":"終了","event.detail.start.date.tips":"開始","event.fork.hint":"参与者和评论不会被复制到新日程","event.menu.confirm.delete":"この予定を削除するのかを確認してください","event.menu.copy":"复制日程","event.menu.delete.title":"予定削除","event.menu.edit":"予定編集","event.menu.fork.fail":"日程复制失败","event.menu.fork.success":"成功复制日程：","event.menu.move":"移动日程","event.menu.move.fail":"日程移动失败","event.menu.move.success":"成功移动日程：","event.menu.title":"予定メニュー","event.move.hint":"跨项目移动时，部分参与者信息不会保留","event.placeholder":"予定なし","event.time.picker.placeholder":"入力時間","events.add":"予定を追加","events.no.event":"予定なし","events.past":"以前の予定","events.placeholder":"会議などの予定を追加する","favorites.all":"すべてお気に入り","favorites.deleted":"削除済み","favorites.invisible":"隠し要素","favorites.new":"更新済み","favorites.not.visible":"削除できません","favorites.placeholder":"お気に入り項目がないです。<br/>タスクや、予定、投稿、ファイルと会計項目をお気に入りにすることができます。","favorites.search":"お気に入りから検索","favorites.unfavorite.success":"お気に入りから外しました","favorites.update.success":"更新しました","favorites.updated":"新しいコンテンツが追加されました。クリックでビューをリフレッシュ","flagged.projects":"スターがついたプロジェクト","fork.to.other.project":"复制到其它项目","future.events":"次の予定","globalGuide.prefession.goonfree":"继续使用免费版","globalGuide.prefession.paynow":"为专业版续费","globalGuide.profession.account.tip":"プロバージョンは期限切れました、更新費用を支払った後アプリとブラグインと更新された機能を続いて使用することができます。<br/><br/><span class='star'>*</span>無料バージョンを使用したら、データに影響を及ぼしませんが、ある部分のアップデート機能を使用できません。","globalGuide.version.profession.overdue":"专业版已到期","guide.create.project7.btn":"好的","guide.feature.link.folder.content":"你可以关联整个文件夹，当文件夹内容有更新时都可以接收到动态提醒","guide.feature.link.folder.done":"我知道了","helper.shortcuts":"ショートカットキー","helper.shortcuts.for.board":"タスクのショートカットキー","helper.shortcuts.for.board.new":"新しいタスク","helper.shortcuts.for.event":"日程のショートカットキー","helper.shortcuts.for.event.new":"新しい日程","helper.shortcuts.for.global":"グローバルショートカットキー","helper.shortcuts.for.global.inbox":"受信トレイを開く","helper.shortcuts.for.global.myboard":"私のダッシュボードを開く","helper.shortcuts.for.global.portal":"ホームへ戻る","helper.shortcuts.for.global.search":"検索","helper.shortcuts.for.inbox":"受信トレイのショートカットキー","helper.shortcuts.for.inbox.next":"次のメッセージ","helper.shortcuts.for.inbox.previous":"前のメッセージ","helper.shortcuts.for.markdown":"マークダウンヘルパーを開く","helper.shortcuts.for.taskgroup":"タスクグループのパネルをオープン","helper.shortcuts.for.wall":"ポストのショートカットキー","helper.shortcuts.for.wall.new":"新しいポスト","html5audio.not.support":"ブラウザはこのオーディオをサポートしません","html5video.not.support":"ブラウザはこのビデオをサポートしません","iCalendar.howto":"使い方をチェック","iCalendar.msg1":"QRコードをスキャンして「%s」購読リンクを取得","iCalendar.msg2":"リンクをクリックして「%s」を直接に購読する。またはカレンダーアプリの中でコピーして手動で購読を追加する","iCalendar.reset":"購読リンクを再生成","iCalendar.title":"「%s」の購読","inbox.all.message":"お知らせ","inbox.at.me":"[自分]","inbox.ated.empty.tip1":"プロジェクトに更新があった際","inbox.ated.empty.tip2":"あなたについてのコメント言及があった際にこちらに通知が表示されます。",
"inbox.clear.messages":"すべてのチェックしたメッセージをクリアする","inbox.clear.messages.desc":"すべてのチェックしたメッセージを完全にクリアするのを確認してください","inbox.delete.message":"メッセージを削除する","inbox.go.to.entry":"エントリーへ移動","inbox.go.to.event":"予定画面に行く","inbox.go.to.organization":"組織画面へ行く：","inbox.go.to.post":"ポスト画面に行く","inbox.go.to.project":"プロジェクト画面に行く","inbox.go.to.task":"タスク画面に行く","inbox.later.empty.tip1":"プロジェクトに更新があった際","inbox.later.empty.tip2":"後で処理する事項のメッセージをこちらで受け取ることができます。","inbox.later.message":"後で処理する","inbox.later.message.cancel":"後で処理することをキャンセルする","inbox.message.snoozed.time.picker":"%s後で処理する","inbox.my.mention":"＠自分","inbox.normal.empty.tip1":"プロジェクトに更新があった際","inbox.normal.empty.tip2":"こちらで通知を受けとることができます","inbox.preference":"お知らせ設定","inbox.read.messages":"すべてを既読にする","integration.placeholder":"抱歉,「%s」暂无内容","integrations.processon.search.hint":" ProcessOn ドキュメントを探す","integrations.processon.search.no.result":"ドキュメントを見つけません","international.inner.title":"中国大陆服务器","international.outer.title":"国际服务器","international.tip.inner.description":"查看存放在中国大陆服务器的数据，在中国境内访问更快。","international.tip.inner.switch":"切换至中国大陆服务器","international.tip.outer.description":"为在海外使用访问更稳定，推荐将数据建立在 Teambition 国际服务器。","international.tip.outer.switch":"切换至国际服务器","jinshuju.data.serial_number":"%s番データ","jinshuju.detail.search.placeholder":"データのコード番号を入力してください","jinshuju.entries.search.empty.hint":"検索結果なし","jinshuju.form.detail.closed.hint":"現在集めたデータがありません","jinshuju.form.detail.createDate.des":"このフォームは%sで作成しました","jinshuju.form.detail.header":"下記のフォームにリンクすることができます","jinshuju.form.detail.hint":"データの詳細情報をチェックします。金数拠のバックエンドデータで対応するコード番号をチェックすることができます。多数のデータをリンクする必要の場合、コンマで分けてください。","jinshuju.form.detail.title":"シングルデータの詳細","jinshuju.form.normal.closed.hint":"集めることを停止しました、まずフォームを開いてください。","jinshuju.form.normal.hint":"リンクした後、リンクでフォームを開いて記入することができます。","jinshuju.form.normal.title":"フォームの記入ページ","jinshuju.form.result.closed.hint":"結果共有のセキュリティを設定してください","jinshuju.form.result.hint":"リンクした後、リンクで結果共有ページを開くことができます。","jinshuju.form.result.title":"結果共有ページ","jinshuju.form.search.closed.hint":"お問い合わせのセキュリティを設定してください","jinshuju.form.search.hint":"リンクした後、リンクでお問い合わせページを開くことができます","jinshuju.form.search.title":"お問い合わせページ","jinshuju.form.status.semantization":"%s、%s。現在%s個データを集めました","jinshuju.form.title":"《%s》","jinshuju.open.rule.closed.des":"集めることを停止しました","jinshuju.open.rule.open.des":"オンにしています、集めています","jinshuju.permission.login.des":"金数拠のユーザーのみ記入可能","jinshuju.permission.password.des":"パスワードによって記入する","jinshuju.permission.private.des":"私とフォーム管理員、データメインテナーのみ記入可能","jinshuju.permission.public.des":"誰でも記入可能","jinshuju.rating":"%星","jinshuju.refresh.token.hint":"金数拠の権限は期限きれました","language.label":"言語","leave.page.alert":"你所编辑的内容尚未保存","library.and":"　と　","library.author":"作者","library.collections.count":"%sフォルダ","library.copy":"复制","library.create.folder":"フォルダ作成","library.default.collection":"検討中の添付ファイル","library.download":"ダウンロード","library.file.update":"更新","library.files.zipname":"%s等%s项_teambition","library.fork.to":"复制 %s 至","library.move":"移動","library.move.to":"%sを次の場所へ移動：","library.name":"ネーム","library.placeholder":"フォルダに何も入っていません","library.placeholder.no.create":"ファイルの作成またアップロードができます","library.size":"サイズ","library.success.forkTo":"成功复制 %1 至 %2","library.success.moveTo":" %1 を %2にいどうしました","library.title":"ファイル","library.update":"更新","library.upload.file":"アップロードファイル","library.works.count":"%s ファイル","link.add":"リンクの追加","link.collection.permission.error":"您没有访问该项目的权限，无法查看文件夹","link.collection.preview.error":"该项目文件已关闭，无法查看文件夹","link.confirm.delete":"リンクを削除してもよろしいですか？","link.delete":"リンクの削除","link.delete.fail":"削除ができません。再度お試しください。","link.delete.success":"削除しました。","link.event.title":"リンクしたスケジュール","link.evernote.title":"Evernote","link.file.title":"リンクしたドキュメント","link.github.title":"Github","link.jinshuju.title":"金数拠","link.menu.title":"関連のメニュー","link.post.title":"リンクした共有項目","link.task.title":"リンクしたタスク","link.weibo.title":"リンクしたWeibo","markdown.helper.A":"リンク","markdown.helper.H1":"H1タグ","markdown.helper.H2":"H2タグ","markdown.helper.H3":"H3タグ","markdown.helper.H4":"H4タグ","markdown.helper.blank.spaces":"4つのスペース","markdown.helper.blockquote":" ブロック引用要素","markdown.helper.code":"コード","markdown.helper.em":"斜体","markdown.helper.hr":"枠線","markdown.helper.img":"写真","markdown.helper.indentation":"インデント減","markdown.helper.more.syntax":"詳しいシンタックスは<a href='http://daringfireball.net/projects/markdown/syntax/' target='_blank'>Markdown: Syntax</a>を参照してください","markdown.helper.ol1":"順序付きリスト１","markdown.helper.ol2":"順序付きリスト２","markdown.helper.ol3":"順序付きリスト３","markdown.helper.placeholder":"マークダウンを使う","markdown.helper.pre":"フォーマット済みのテキスト","markdown.helper.preview":"プレビュー","markdown.helper.strong":"太字","markdown.helper.syntax":"シンタックス","markdown.helper.title":"マークダウン","markdown.helper.try":"マークダウンを試す","markdown.helper.ul1":"無順序リスト１","markdown.helper.ul2":"無順序リスト２","member.bar.input":"搜索成员","member.bar.title":"项目成员","member.card.detail":"メンバー情報をチェックする","member.card.inactive.init.password":'アカウントはまだ確認されていません<a class="resend-handler">確認メールを再送信</a>。最初のパスワード：',"member.card.role.setting":"項目の権限設定","member.card.submenu.title":"項目の権限設定","member.card.task.organization":"企業タスク","member.card.task.project":"項目タスク","member.finder.sendInvitationMailTo":"发送邀请邮件给：","member.finder.unregistered.phone":"该手机号未被注册","member.info":"個人情報","member.involve":"参加者","member.involve.add":"メンバーを追加する","member.involve.none":"参加者なし","member.involve.tip":"参加者はコメントとタスク更新を知らせられます","member.menu.all":"メンバー全員","member.menu.search":"メンバー検索","member.progress.title.organization":"企業メンバー数 · %s/%s","member.progress.title.project":"項目メンバー数 · %s/%s","member.remove.from.team":"メンバーを部門から削除する","member.tasks.future.tasks":"未来のタスク","member.tasks.recent.tasks":"最近のタスク","member.tasks.today.tasks":"今日のタスク","memberlatest.actived":"最終ログイン","members.manager.add.member":"添加メンバー","members.manager.all.members":"メンバー全員","members.manager.new.members":"新メンバー","members.manager.unassigned.members":"まだ部門に配置されていないメンバー","message.system.activity.entry.remove":"无法查看该账目详情","message.system.activity.event.remove":"无法查看该日程详情","message.system.activity.organization.invite.members":"你可以查看该企业所有内容","message.system.activity.organization.remove":"无法查看该企业内容","message.system.activity.organization.remove.member":"无法查看该企业内容","message.system.activity.post.remove":"无法查看该分享详情","message.system.activity.project.archive":"无法查看该项目内容","message.system.activity.project.invite.members":"你可以查看该项目所有内容","message.system.activity.project.remove":"无法查看该项目内容","message.system.activity.project.remove.member":"无法查看该项目内容","message.system.activity.project.unarchive":"你可以查看该项目所有内容","message.system.activity.task.remove":"无法查看该任务详情","message.system.activity.work.remove":"无法查看该文件详情","moment.MMMMYYYY":"YYYY年MM月","more.operations":"更に操作","move.to.other.project":"移动到其它项目","my.btn.personal":"編集者の個人情報","my.btn.settings":"設置","my.events":"私の予定","my.favorites":"お気に入り","my.notes":"私のノート","my.post":"私のポスト","my.projects":"私のプロジェクト","my.recent":"最近の事","my.recent.today":"今日の事","my.recent.tomorrow":"明日のことは","my.recent.week":"最近5日のこと","my.task.created":"創建の任務","my.task.dateByAll":"全部","my.task.dateByLastMonth":"最近1ヶ月","my.task.dateByLastTwoWeek":"最近2週間","my.task.dateByLastWeek":"最近の一週間","my.task.dateByToday":"今日","my.task.dateByYesterday":"昨日","my.task.done":"クリアしたクエスト","my.task.joined":"参加の任務","my.task.sortByDueDate":"押し締め切りソート","my.task.sortByPriority":"時間どおりには優先順位","my.task.sortByProject":"種目別名称ソート","my.task.undone":"未完成の任務","my.tasks":"私のタスク","nav.menu.menu":"メニュー","nav.menu.sortandfilter":"ソートと選別","navigation.account.personalCenter":"アカウントの設定","navigation.create.organization":"創建組織","navigation.create.organization.try.now":"今無料で試します","navigation.enterBBS":"コミュニティに入る","navigation.event":"スケジュール","navigation.organization":"組織","navigation.project":"プロジェクト","navigation.search":"搜索","navigation.sharing":"シェアする","navigation.task":"タスク","navigation.work":"文件","new.ribbon":"新機能","noRight.view":"リンク見る権限がありません。","note.collapse":"收起备忘","note.delete.confirm":"本当にノートを削除しますか？","note.delete.confirm.title":"ノート削除の確認","note.expand":"显示全部","note.placeholder":"ノートなし","notes.input.note":"ノート...","notes.input.title":"題名...","object.picker.event.creator.tips":"新しいスケジュールを作成する","object.picker.event.title":"参加していない日程","object.picker.exceed.number":"1回に最多10つの関連対象を選択できます。","object.picker.file.uploader.tips":"新しいファイルをアップロード","object.picker.post.creator.tips":"新しい共有作成","object.picker.search.all":"「リターンキー」で全てを検索","object.picker.task.creator.tips":"新しいタスクを作成","open.file":"打开","oragnization.team.order.title.child":"子部门排序","org.guide.next":"次へ","org.guide.team.create":"チームの新規作成","org.reports.all.tips.create":"新規クエスト数","org.reports.all.tips.delay":"期限超過のタスク","org.reports.all.tips.done":"完了したタスク数","org.reports.all.title":"グループ全体の報告","org.reports.arrowLeft":"先週","org.reports.arrowRight":"来週","org.reports.currentWeek":"今週","org.reports.rank.tips.delay":"期限超過タスクランキング","org.reports.rank.tips.delayResult":"%s<span>が%s期限が過ぎております</span>","org.reports.rank.tips.done":"タスク完了ランキング","org.reports.rank.tips.doneResult":"%s<span>は%sのタスクを完了しました</span>","org.reports.states.tips.title":"プロジェクトの状態","org.reports.tasks.tips.delay":"期限超過のタスク","org.reports.tasks.tips.done":"完了済みのタスク","organization.avatarCrop.choose":"イメージファイルを選択","organization.avatarCrop.edit.organization.avatar":"組織を表すイメージを選択","organization.avatarCrop.hint":"ベストサイズ64&times;64，高解像度の画像をアップロードして編集することも可能","organization.avatarCrop.preview":"イメージをプレビュー","organization.buy.members":"购买成员名额","organization.buy.now":"立即续费","organization.buy.years":"购买年数","organization.check.order":"查看订单","organization.created.key":"创建时间","organization.current.members.limit":"，共 %s 个名额","organization.current.members.number":"%s 位企业成员","organization.current.members.unlimit":"，定員の上限なし","organization.desc":"組織の概要","organization.dueday":"%s","organization.email.sent30":"メール送信しました（30秒後再送信できます）","organization.exclusive.consultant":"专属顾问","organization.exclusive.consultant.mail":"邮箱：%s","organization.exclusive.consultant.phone":"电话：%s","organization.exclusive.consultant.service":"Teambition 用户顾问为你提供一对一专属服务","organization.expired.key":"到期时间","organization.expiring.btn.ok":"確認","organization.expiring.contact.owner":"企業「%s」は間もなく期限切れ、企業にオーナーに連絡し更新費用を支払ってください","organization.expiring.content":"使用期限が切れになるためライセンス更新をお願いします","organization.expiring.go.pay.new":"今購入します","organization.expiring.go.pay.renew":"今更新費用を支払います","organization.expiring.title":"ライセンス期限切れのご注意","organization.guide.import.members":"导入成员","organization.guide.import.members.description":"将成员添加到企业，你就可以在企业里管理成员、构建团队、配置权限。我们还提供了企业周报和数据统计功能，助你了解企业成员的工作情况。","organization.guide.import.projects":"迁入项目","organization.guide.import.projects.description":"将个人项目迁入企业，你就可以使用企业版的报告和统计功能，把握项目全局动态，便于统筹管理。","organization.help.description1":"在 Teambition 上创建一个企业，把项目和成员加入其中，即可借助专业的企业功能来统筹管理项目进展和成员工作情况。","organization.help.header":"了解企业版","organization.learn.more":"详细了解企业版","organization.member":"企業メンバー","organization.member.add":"メンバーを企業に追加する","organization.member.assign.team":"部門に追加する","organization.member.detail":"メンバー情報","organization.member.detail.organization":"企業メンバー情報","organization.member.detail.project":"項目メンバー情報","organization.member.exceed":"企業のメンバー数は上限に上限に達している","organization.member.exceed.description":"企業メンバーは%s人に達しています、定員数を増加してもっとメンバーを招待することができます","organization.member.menu":"企業メンバーメニュー","organization.member.remove":"メンバーを企業から削除する","organization.memberadd.allRecommendInvited":"お勧めしたユーザーは全部本企業に追加しました","organization.memberadd.batch.invite":"大量招待する","organization.memberadd.cooperatedMember":"協力したメンバー","organization.memberadd.inviteText":"アカウントで招待する","organization.memberadd.noMemberInviteSomeone":"企業のメンバーはあなた一人だけ、<br>ここで友達を招待するのができます。","organization.memberadd.searchCantfind":"<wbr>“%s”を見つけません、<wbr>完全なメールアドレスを入力し企業に追加してください","organization.memberadd.searchTip":"メールアドレス/携帯番号を入力してください","organization.memberadd.title":"メンバーを企業に追加する","organization.members.key":"成员数量","organization.name":"組織名","organization.nav.members":"メンバー","organization.nav.projects":"プロジェクト","organization.nav.reports":"報告","organization.nav.statistics":"統計","organization.overdue":"ライセンス期限終了","organization.overdue.btn.ok":"確認","organization.overdue.contact":"企業「%s」は期限きれました、更新費用を支払ってください。または企業オーナーに連絡し項目をキャンセルしてください。","organization.overdue.message":"この組織のチームビションライセンスの有効期限は終了しました。ライセンスの更新をお願いします","organization.overdue.renew":"企業「%s」は期限切れました、更新費用を支払ってください。","organization.overdue.title":"この組織のチームビションライセンスの有効期限が過ぎました。ライセンスの更新をお願いします","organization.paid":"正常使用","organization.paid.overdue":"已过期","organization.payment.buy":"购买企业版","organization.project.blank.description":"你可以按照团队或者按照季度目标来创建项目。每个项目你都可以配上美观的封面，让你的工作空间更加愉悦。","organization.project.blank.title":"创建项目","organization.projects":"組織に所属するプロジェクト","organization.report.blank.description":"Teambition 将每周送达一份详尽的企业报告，从全局了解企业各个项目的进展、成员的工作效率，以及任务完成的情况。","organization.report.blank.title":"企业周报","organization.setting.permission":"組織の公開性","organization.setting.private":"私有組織（組織メンバーのみが見える）","organization.setting.public":"公開組織（全てのビジターが見える）","organization.settings":"企業設定","organization.settings.add.member.toplimit":"增加企业成员名额","organization.settings.add.members.success":" %s 人を招待しました。招待メールが各メンバーのメールボックスに送られました","organization.settings.avatar":"企業のアイコン","organization.settings.avatar.upload":"新しいアイコンをアップロードする","organization.settings.avatar.upload.failed":"組織のイメージ画像の変更に失敗しました","organization.settings.avatar.upload.success":"組織のイメージ画像を変更しました","organization.settings.button.delete":"削除","organization.settings.button.transfer":"引き渡す","organization.settings.delete":"組織を削除する","organization.settings.delete.msg":"組織を削除すると、組織に関連するプロジェクト情報とメンバー設定がすべて削除されます。削除後復原はできないのでご注意ください","organization.settings.delete.success":"企業の削除に成功しました","organization.settings.delete.title":"組織を削除する","organization.settings.desc.placeholder":"企業を紹介する","organization.settings.label.belonging":"企業の所属","organization.settings.leave":"組織を抜ける","organization.settings.leave.msg":"組織を抜けると、組織の情報が見えなくなります。再び参加したいなら、組織のオーナーまた管理者に連絡してください","organization.settings.leave.success":"組織を抜けました。今すぐトップページへ戻る","organization.settings.leave.title":"組織を抜ける","organization.settings.order.teams":"部门排序","organization.settings.roles.and.permissions":"チェックと管理権限","organization.settings.roles.config":"権限設定","organization.settings.roles.onlyread":"権限をチェックする","organization.settings.save.success":"保存に成功しました","organization.settings.search.owner":"メンバー探し","organization.settings.select.owner":"企業オーナーを選ぶ","organization.settings.tab.consultant":"専属するコンサルタント","organization.settings.tab.infomation":"企業のお知らせ","organization.settings.tab.other":"もっと","organization.settings.tab.pay":"料金情報","organization.settings.transfer":"企業を引き渡す","organization.settings.transfer.confirm":"引き渡すを確認する","organization.settings.transfer.success":"企業を引き渡すことに成功しました","organization.settings.transfer.tips":"企業メンバー一人を新しいオーナーに指定し、その後あなたはメンバーとなります","organization.settings.transfer.warning":"企業を引き渡した後、あなたは企業オーナーではなくなり、キャンセルすることができません！","organization.settings.update.plan":"プランを更新","organization.settings.upperLimit":"組織メンバー数が上限に達しました","organization.statistics.activeness":"アクティブレベル","organization.statistics.blank.description":"Teambition 需要一周的时间统计第一份数据。企业统计功能将帮助管理者从项目、团队、成员等多个维度对企业状况进行分析。值得一提的是，这些数据在 App 上也可以实时查阅，随时随地都能了解进展、发现问题。","organization.statistics.blank.title":"企业统计","organization.statistics.chartMembers":"メンバー数","organization.statistics.chartProjects":"プロジェクト数","organization.statistics.count":"個","organization.statistics.going":"迫っている","organization.statistics.membersAmount":"メンバー","organization.statistics.membertab.all":"全メンバー","organization.statistics.membertab.byDelayRate":"締切順に並べる","organization.statistics.membertab.byDoneRate":"完成率で並べる","organization.statistics.membertab.done.undo":"完成済み/総タスク数","organization.statistics.membertab.name":"名前","organization.statistics.membertab.new":"新メンバー","organization.statistics.membertab.noContent":"データがありません","organization.statistics.membertab.projectsJoined":"参加中のプロジェクト数","organization.statistics.membertab.title":"メンバー統計","organization.statistics.membertab.undergoing":"遂行中のタスク","organization.statistics.month":"月","organization.statistics.monthShow":"月","organization.statistics.none":"ありません","organization.statistics.overdue":"期限切れた","organization.statistics.projectsAmount":"個のプロジェクト","organization.statistics.projecttab.all":"個のプロジェクトセクション","organization.statistics.projecttab.byActiveness":"アクティブレベルで並べる","organization.statistics.projecttab.byDelayRate":"締切順に並べる","organization.statistics.projecttab.byDoneRate":"完成率で並べる","organization.statistics.projecttab.doneUndo":"完成済み/総タスク数","organization.statistics.projecttab.member":"メンバー","organization.statistics.projecttab.noContent":"データがありません","organization.statistics.projecttab.project":"プロジェクト","organization.statistics.projecttab.title":"プロジェクト統計","organization.statistics.projecttab.undergoings":"遂行中のタスク","organization.statistics.projecttab.weeklyActiveness":"週間アクティブレベル","organization.statistics.projecttab.weeklyActivenessHint":"各週このプロジェクトのメンバーが作った<br>コンテンツ数/プロジェクトメンバー数","organization.statistics.searchMember":"検索のメンバー","organization.statistics.searchProject":"プロジェクトを検索する","organization.statistics.searchResult":"結果を検索する","organization.statistics.sorting":"並び替え","organization.statistics.undergoing":"遂行中","organization.statistics.weeklyActiveness":"組織のアクティブレベル","organization.statistics.weeklyActiveness.hint":"各週この組織のメンバーが作った<br>コンテンツ数/プロジェクトメンバー数","organization.statistics.year":"年","organization.status.key":"企业状态","organization.switcher.intro.feature.permission":"强大而易管理的权限配置","organization.switcher.intro.feature.statistics":"丰富而有意义的数据统计","organization.switcher.intro.feature.weekReport":"每周自动推送的企业周报","organization.switcher.intro.title":"企业版高级功能","organization.team.order.title":"部门排序","organization.transfer.project.member.description":"已成功迁入%s个项目，同时添加项目成员到企业","organization.transfer.project.member.search.member":"搜索成员","organization.transfer.project.member.title":"添加项目成员到企业","organization.trial":"试用中","organization.trial.overdue":"试用结束","organization.visible":"企业可见","popover.search.current":"現プロジェクト内で “%s” を検索します","popover.search.whole":"すべてのプロジェクトで “%s” を検索します","portal.create.project":"新規プロジェクト","portal.enter.organization.home.page":"組織","portal.project.notification":"このプロジェクトには更新情報があります","portal.project.star.bookmark.hint":"に入ってください。使用してプロジェクト%1足を付ける","portal.project.star.bookmark.hint.project":"ご使用ください%1添加","portal.project.star.success":"星に成功し、便利以降急速に訪問プロジェクトは、<a class='show-bookmark-hint' data-gta='イベント' data-label='add-to-bookmark' >加入ブラウザブックマーク</a>","portal.project.un.star.success":"スターを外しました。","portal.unarchive.error":"申し訳ございません。プロジェクトを再アクティブできないですので、再度お試しください","portal.unarchive.project.description":"再アクティブすると、プロジェクトを使えるようになります","portal.unarchive.project.title":"プロジェクトを再アクティブする","portal.unarchive.success":"プロジェクトを再アクティブしました","post.attachment.not.visible":"无法打开，已删除或没有权限","post.creator.markdown.tips":"このドキュメントはMarkdownを使っています。<a class='md-help-handler'>シンタクッス・ガイド</a>","post.creator.tips_1":"ポストを作成","post.creator.tips_2":"&empty;","post.creator.title.placeholder":"ポストタイトルを編集","post.detail.archived":"このポストをアーカイブ","post.menu.confirm.delete":"ポストを削除するのかを確認してください","post.menu.copy":"复制分享","post.menu.delete.title":"ポスト削除","post.menu.edit":"编辑分享","post.menu.fork.fail":"分享复制失败","post.menu.fork.global.hint":"参与者和评论不会被复制到新分享","post.menu.fork.success":"成功复制分享：","post.menu.move":"移动分享","post.menu.move.error.hint":"没有权限对分享中的附件进行操作","post.menu.move.error.title":"无法移动分享","post.menu.move.fail":"分享移动失败","post.menu.move.global.hint":"跨项目移动时，部分参与者信息不会保留","post.menu.move.success":"成功移动分享：","post.menu.pin.title":"ポストをトップに","post.menu.title":"ポストメニュー","post.menu.unpin.title":"ポストのピンを外す","post.placeholder":"フォルダなし","post.un.title":"題名なし","post.update":"ポスト更新","powerups.add.plugins":"プラットホームを解放してブラグインを追加する","powerups.app.close":"アプリを終了します","powerups.app.close.btn":"終了するを確認","powerups.app.confirm.close":"<b>%s</b>中のアプリ<b>%s</b>を終了してよろしいでしょうか？","powerups.app.confirm.delete":"<b>%s</b>にインストールされたアプリ<b>%s</b>を削除してよろしいでしょうか？","powerups.app.delete":"アプリを削除する","powerups.app.delete.btn":"削除するを確認","powerups.appearin.des":"日程表插件，支持最多8人的视频会议，远程办公也一样高效。","powerups.author":" %s より提供される","powerups.bookkeeping":"记账","powerups.bookkeeping.des":"轻松记录项目每一笔开支。记账可以帮助管理者了解各项目下的收支明细，汇总所有的账目审批。","powerups.events":"日程","powerups.events.des":"日程表可以帮助你安排好你的一整天，与远程的同伴加入视频会议。","powerups.evernote.des":"根据项目需要，启用印象笔记，即可在任务、日程、分享等地方关联你的笔记。","powerups.github.des":"关联 Pull Request、Issue 或 Commits 上内容到 Teambition，在 Teambition 接受动态通知。","powerups.groupchat":"群聊","powerups.groupchat.des":"项目里的所有成员都可以在这里一起聊天，发送语音、图片，分享文件。自由地交流关于项目的各种信息。","powerups.item.close.plugin.tasklist":"关闭任务分组","powerups.item.detail.closed":"%s已关闭","powerups.item.detail.nav.apps.least":"请至少保留一个应用","powerups.item.detail.opened":"%s已开启","powerups.item.detail.tasklist.warning":"该项目中存在多个分组，请整理成一个分组再进行关闭操作","powerups.item.update.hint":"升级使用该插件","powerups.jinshuju":"金数拠","powerups.jinshuju.des":"金数拠はオンラインフォームデザインとデータ管理を簡単で処理するプラットホーム、型板或は自定義でフォームを作成し、金数拠は自動的にユーザーにバックエンドデータプラットホームを作成します。","powerups.markdown":"Markdown","powerups.markdown.des":"使用 Markdown 格式撰写的文本，可以使用简单的符号编辑文本样式。在发布评论及任务备忘时，支持使用 Markdown 。","powerups.modal.title.detail":"アプリ情報","powerups.posts":"分享","powerups.posts.des":"沟通想法，共享知识。分享墙帮助你随时与团队分享和讨论。支持添加图片、编辑文本格式和 Markdown。","powerups.powerup.groupApp":"项目应用","powerups.powerup.plugin":"功能插件","powerups.preciseDate":"任务精确时间","powerups.preciseDate.des":"启用后，任务将增加「设置精确时间」的选项，起止时间会同步出现在任务板。","powerups.processon.des":"ProcessOnはオンライン製図プラットホームです。ユーザーに一番強力でやさしく使える製図道具です！オンライン流れ図、BPMN、UML 图、UI \n試作インタフェースデザイン、iOS試作インタフェースデザインなどをサポートする。","powerups.shimo":"石墨文档","powerups.shimo.des":"第三方云端协同文档，一次关于发布分享的全新体验，授权账号后即刻体验，支持刷新同步完成文档的协同编辑。","powerups.startDate":"タスクの開始時間","powerups.startDate.des":"タスクの開始時間を設定し、効率を高めて、タスクの進度を直接確認できます","powerups.taskUniqueId":"任务 ID","powerups.taskUniqueId.des":"启用后，每创建一个任务都自动产生一个唯一编号，方便成员之间沟通传递。","powerups.taskUniqueId.dialog.confirm":"确认开启","powerups.taskUniqueId.dialog.desc":"请先设置项目编号，编号将作为 ID 前缀，用以区别项目。支持字母，2-4位。","powerups.taskUniqueId.dialog.edit.confirm":"保存","powerups.taskUniqueId.dialog.edit.desc":"设置项目编号，编号将作为 ID 前缀，用以区别项目。支持字母，2-4位。","powerups.taskUniqueId.dialog.edit.title":"任务 ID 设置","powerups.taskUniqueId.dialog.placeholder":"如 Design Team 可以设置为 DT","powerups.taskUniqueId.dialog.submitting":"开启中...","powerups.taskUniqueId.dialog.title":"开启任务 ID","powerups.taskUniqueId.success.edit.tip":"修改任务前缀成功","powerups.taskUniqueId.success.tip":"任务 ID 已开启，请刷新页面后查看","powerups.tasklist":"任务分组","powerups.tasklist.des":"任务分组可以帮助你对任务版进行分类管理，特别适用于研发项目的开发周期迭代，一个市场活动的不同周期等。","powerups.tasks":"任务","powerups.tasks.des":"直观地了解每一个人的工作进展。在任务板上，你可以随时和成员开展讨论，针对每一个任务，你还可以分解子任务、上传附件、设定截止日期。","powerups.weibo":"微博","powerups.weibo.des":"根据项目需要，启用微博，即可在任务、日程、分享等地方关联任意一条微博。","powerups.works":"文件","powerups.works.des":"文件库相当于一个可协作的网盘。它支持图片、doc、PDF、xlsx、MP4 等多种常用文件的在线预览。同时，你可以随时更新文件版本，历史版本均会保存。","powerups.yinxiang.des":"項目により、印象ノートを起動して、タスク、スケジュール、共有などでノートをリンクできます","powerups.yiqixie":"一起写文档","powerups.yiqixie.des":"第三方云端协同文档，可用于发布支持协同编辑的分享。与 Teambition 无缝整合，无需授权、关联账号，致力于给予极致的协作文档体验。","previewer.archived":"このファイルはアーカイブされました","previewer.confirm.delete":"このファイルを完全に削除するのかを確認してください","previewer.delete.file":"ファイル削除","previewer.download":"ダウンロード","previewer.download.file":"ファイルダウンロード","previewer.edit":"編集","previewer.enter.collection":"フォルダへ","previewer.file.deleted":"このファイルは削除されました","previewer.file.translateFail":"ファイル変換に失敗して、素直にプレビュー","previewer.header.folder.tips":"所属フォルダ","previewer.header.root.tips":"目録","previewer.header.temp.tips":"臨時目録","previewer.img.turn.left":"左へ回転","previewer.img.turn.right":"右へ回転","previewer.menu.confirm.delete":"このファイルを削除しますか？","previewer.menu.delete.title":"ファイルの削除","previewer.menu.title":"ファイルのメニュー","previewer.move":"移動","previewer.open":"打开","previewer.open.link":"リンクを開く","previewer.update":"更新","previewer.updating":"で更新している","priority.high":"中","priority.none":"低","priority.urgent":"高","processon.cooperated":"私と協力したもの","processon.myFiles":"私のドキュメント","processon.recent":"最近の変更","profession.expired":"专业版已到期","profession.setting.permission.hint":"专业版项目可配置项目管理员，","profession.warning.tip1":"专业版已经到期，请续费后继续使用专业版提供的丰富应用与插件及其他升级功能。您可以联系该项目拥有者进行续费。","profession.warning.tip2":"专业版已经到期，请续费后继续使用专业版提供的丰富应用与插件及其他升级功能。<br/><br/><span class='star'>＊</span> 如选择使用免费版，您的所有数据将不会受到影响，仅升级部分功能无法使用。","project.app.plugin.remove.essage":"プラッグインは削除されました","project.at.members.organization":"項目メンバー以外","project.at.members.project":"項目メンバー","project.belonging.owner":"項目オーナー","project.create.section":"グループを追加するには、ここをクリックしてください","project.creator.belongsTo":"项目归属","project.creator.create.project":"新プロジェクト","project.creator.createFromTemplate":"从模板创建项目","project.creator.creating":"作成している","project.creator.doneAndCreate":"完成并创建","project.creator.fillTemplate":"完善项目信息","project.creator.intro":"为不同的事务建立各自的项目，","project.creator.me":"私","project.creator.nextStep":"下一步","project.creator.owner":"オーナー","project.creator.porject.name.placeholder":"プロジェクト名","project.creator.section":"プロジェクトグループ","project.creator.teamplate.create":"创建并进入项目","project.creator.teamplate.intro":"正在从模板<span class='template-name'>%s</span>创建新项目","project.creator.template.failed":"模板创建失败，请稍候再试","project.creator.template.feedback":"建议与反馈","project.desc":"プロジェクト要約","project.grouping":"プロジェクトグループ","project.logoCrop.best.size.hint":"画像は600&times;200にトリミングされます。高い解像度の画像ファイルにも対応しています。","project.logoCrop.choose":"画像を選択してください","project.logoCrop.desktop.logo":"デスクトップビューの際のプロジェクトのカバー画像","project.logoCrop.mobile.logo":"モバイルビューの際のプロジェクトカバー画像","project.logoCrop.previews":"プレビュー","project.logoCrop.set.project.logo":"プロジェクトカバーを編集する","project.manager.enter":"入る","project.manager.filter":"スクリーニングと整列","project.manager.join":"参加","project.manager.joining":"参加しています","project.manager.not.member":"プロジェクトメンバーなし","project.manager.sort.by.name":"名前順ソート","project.manager.success.join":"参加しました","project.member":"项目成员","project.memberadd.add":"添加","project.memberadd.addMembersByLink":"通过链接邀请","project.memberadd.addRepetitive":"%s 已是项目成员","project.memberadd.addSuccess":"成功添加成员，已向 %s 发送邀请信","project.memberadd.added":"已加入","project.memberadd.allRecommendInvited":"为你推荐的用户均已加入本项目","project.memberadd.cooperatedMember":"合作过的成员","project.memberadd.header.title":"邀请新成员","project.memberadd.import":"导入","project.memberadd.imported":"已导入","project.memberadd.inviteViaAccount":"帐号邀请","project.memberadd.noMemberInviteSomeone":"现在项目中只有你一个，<br>你可以在此邀请你的小伙伴一起协作。","project.memberadd.orgMember":"企业成员","project.memberadd.orgTeam":"企业团队","project.memberadd.placeholder":"请输入邮箱或手机号，回车确认","project.memberadd.placeholderForOrg":"请输入企业成员/团队名称，或邮箱/手机号","project.memberadd.searchCantfind":"找不到<wbr>“%s”，<wbr>输入完整邮箱直接将其添加至项目","project.menu.copy.fail":"プロジェクトのコピーが失敗しました。","project.menu.copy.success":"プロジェクトをコピーしました：","project.menu.mail.content":"%sはあなたをTeambitionパブリック・プロジェクトの 「%s」に招待しました。こちらのリンクから参加できます%s","project.menu.mail.content.desc":"%sはあなたをTeambitionパブリック・プロジェクトの 「%s」に招待しました。このプロジェクトは「%s」に関連するものです。こちらのリンクから参加できます%s","project.menu.mail.title":"%sはパブリック・プロジェクト 「%s」を共有しました","project.menu.share.link":"リンクをシェアする","project.menu.share.to":"次の場所で共有：","project.menu.share.to.mail":"メールでシェア","project.menu.share.to.weibo":"分享到微博","project.menu.weibo.content":"私はTeambitionで「%s」という使えそうなパブリック・プロジェクトを見つけました。","project.menu.weibo.content.desc":"私はTeambitionで「%s」という使えそうなパブリック・プロジェクトを見つけました。このプロジェクトは「%s」に関連するものです。","project.name":"プロジェクト","project.none.section":"未選択パケット","project.owner.search":"企業或はメンバー探し","project.panel.activity.project.add.team.and.members":" 添加了企业部门及部门成员:","project.panel.activity.project.archive":" 归档了项目","project.panel.activity.project.archive.collection":" 归档了文件夹:","project.panel.activity.project.archive.entry":" 归档了记账:","project.panel.activity.project.archive.event":" 归档了日程: %s","project.panel.activity.project.archive.post":" 归档了分享:","project.panel.activity.project.archive.tag":" 归档了标签:","project.panel.activity.project.archive.task":" 归档了任务:","project.panel.activity.project.archive.tasklist":" 归档了任务分组:","project.panel.activity.project.archive.work":" 归档了文件:","project.panel.activity.project.create.collection":" 创建了文件夹:","project.panel.activity.project.create.entry":" 创建了记账:","project.panel.activity.project.create.event":" 创建了日程: %s","project.panel.activity.project.create.post":" 创建了分享:","project.panel.activity.project.create.tag":" 创建了标签:","project.panel.activity.project.create.task":" 创建了任务:","project.panel.activity.project.create.tasklist":" 创建了任务分组:","project.panel.activity.project.create.works":" 上传了文件:","project.panel.activity.project.disable.application":" 关闭了应用:","project.panel.activity.project.disable.plugin":" 关闭了插件:","project.panel.activity.project.enable.application":" 打开了应用:","project.panel.activity.project.enable.plugin":" 打开了插件:","project.panel.activity.project.finish.task":" 完成了任务:","project.panel.activity.project.invite.members":" 邀请 %s 加入项目","project.panel.activity.project.join.as.organization.owner":" 作为企业拥有者加入项目","project.panel.activity.project.join.from.invite.link":" 通过项目链接加入项目","project.panel.activity.project.join.from.qrcode":" 通过二维码加入项目","project.panel.activity.project.join.from.user.invite.link":" 通过 %s 分享的邀请链接加入项目","project.panel.activity.project.join.from.user.qrcode":" 通过 %s 分享的二维码加入项目","project.panel.activity.project.join.from.weixin":" 通过微信平台加入项目","project.panel.activity.project.redo.task":" 重做了任务:","project.panel.activity.project.remove":" 删除了项目","project.panel.activity.project.remove.collection":" 删除了文件夹:","project.panel.activity.project.remove.entry":" 删除了记账:","project.panel.activity.project.remove.event":" 删除了日程: %s","project.panel.activity.project.remove.member":" 移除了成员:","project.panel.activity.project.remove.post":" 删除了分享:","project.panel.activity.project.remove.self":" 退出了项目","project.panel.activity.project.remove.tag":" 删除了标签:","project.panel.activity.project.remove.task":" 删除了任务:","project.panel.activity.project.remove.tasklist":" 删除了任务分组:","project.panel.activity.project.remove.team":" 移除了企业部门 %s，但保留部门成员","project.panel.activity.project.remove.team.and.members":" 移除了企业部门及部门成员:","project.panel.activity.project.remove.work":" 删除了文件:","project.panel.activity.project.transfer.to.organization":" 将项目移交给企业","project.panel.activity.project.transfer.to.user":" 将项目移交给用户","project.panel.activity.project.unarchive":" 取消归档了项目","project.panel.activity.project.unarchive.collection":" 取消归档了文件夹:","project.panel.activity.project.unarchive.entry":" 取消归档了记账:","project.panel.activity.project.unarchive.event":" 取消归档了日程: %s","project.panel.activity.project.unarchive.post":" 取消归档了分享:","project.panel.activity.project.unarchive.tag":" 取消归档了标签:","project.panel.activity.project.unarchive.task":" 取消归档了任务:","project.panel.activity.project.unarchive.tasklist":" 取消归档了任务分组:","project.panel.activity.project.unarchive.work":" 取消归档了文件:","project.panel.activity.project.update.description":" 修改了项目简介:","project.panel.activity.project.update.logo":" 更新了项目封面","project.panel.activity.project.update.name":" 修改了项目名称:","project.panel.activity.project.update.visibility":" 将项目设置为","project.panel.entry.income":"收入 ¥ %s","project.panel.entry.outcome":"支出 ¥ %s","project.remove.team.remain.members":"部門を削除して、部門メンバーを項目に残す","project.remove.team.remove.members":"部門を削除して、部門メンバーを項目から削除する","project.search":"搜索项目","project.section.down":"下の分類グループに移す","project.section.name":"新グループ名","project.section.remove":"グループをキャンセル","project.section.up":"グループを上に","project.select.list.hint":"请选择一个项目","project.setting.defaultrole.help":'君が<a class="link-add-handler" href="/applications/permissions/%s" target="_blank"＞権限設置</a>ページ増える役',"project.setting.defaultrole.tips":"ごとに1つのプロジェクトメンバー添加、同メンバーの権限はデフォルト設定され：","project.setting.handler.transfer":"引き渡す","project.setting.members.exceed.limit":"成员数超出限制","project.setting.members.reach.limit":"成员数已达上限","project.setting.nav.hint":"拖动图标排序。你可以前往<a class='open-powerups'>项目菜单－应用与插件</a>打开或关闭应用。","project.setting.notification.accept":"バッジとバナー","project.setting.notification.reject":"バッジのみ","project.setting.notification.tips":"プロジェクトに更新があった際にバッジで知らせます","project.setting.notification.title":"プロジェクトのバッジ","project.setting.permission.hint":"免费版项目不支持配置权限，",
"project.setting.reset.error":"リセットできません、再度お試しください","project.setting.reset.invite":"リセット後、現在の招待リンクのみ有効になります","project.setting.transfer.and.quit":"このプロジェクトを脱退する前に新しいオーナークラスのユーザーを指定する必要があります","project.setting.visibility.all":"公開プロジェクト","project.setting.visibility.info.all":"すべての人がすべてを通じてリンクを訪問して、プロジェクトのメンバーだけ編集","project.setting.visibility.info.organization":"すべてのTeambition企業のメンバーを見て、ただプロジェクトメンバー編集","project.setting.visibility.info.project":"プロジェクトメンバーだけがチェックと編集","project.setting.visibility.organization":"企業プロジェクト","project.setting.visibility.project":"私有プロジェクト","project.settings":"プロジェクト設定","project.settings.add.member.repetitive":"%s はすでにプロジェクトメンバーです","project.settings.add.member.success":"%s に招待状を送信しました","project.settings.add.member.through.url.or.qrcode":" QR codeを使って新プロジェクトに参加したりまたは新メンバーを追加したりできます。","project.settings.add.member.through.url.or.tip1":"有効期限:","project.settings.add.members.by.emails":"バッチ招待","project.settings.archive":"アーカイブ","project.settings.archive.error":"アーカイブに失敗しました。もう一度お試し下さい。","project.settings.archive.msg":"プロジェクトが終了もしくはブロックされた場合アーカイブして保存することができます。後でプロジェクトを再開する場合、アーカイブした情報をそのまま使えます。","project.settings.archive.success":"アーカイブしたプロジェクトはこのページの下にあります","project.settings.button.delete":"削除","project.settings.button.upload.cover":"新しい表紙をアップロードする","project.settings.cannot.quit":"无法退出项目","project.settings.cannot.quit.content":"您已作为团队加入项目，不能单独退出","project.settings.cannot.remove":"该成员作为团队加入项目，不能单独移除","project.settings.delete":"削除","project.settings.delete.msg":"プロジェクトを削除すると、プロジェクトについての情報をすべて完全に削除します。復元はできませんのでご注意ください","project.settings.delete.success":"プロジェクトが削除されました","project.settings.desc.placeholder":"プロジェクトについての簡単な説明を記入して下さい","project.settings.email.sent30":"メール送信済み（届かない場合30秒後に再送信可能）","project.settings.label.actions":"項目操作","project.settings.label.permission":"新しいメンバーのデフォルト権限","project.settings.label.project.cover":"項目表紙","project.settings.label.sort":"アプリのソート","project.settings.label.subtitle.actions":"以下の操作を実施できます","project.settings.leave":"抜ける","project.settings.leave.msg":"プロジェクトを脱退すると、プロジェクトの情報を参照できなくなります。再び参加したいなら、プロジェクトのオーナーまた管理者に連絡してください","project.settings.leave.success":"プロジェクトを脱退しました","project.settings.logo.crop.image.size.too.large":"イメージファイルのサイズが大きすぎます。4MB以下のファイルをお使いください!","project.settings.logo.upload.failed":"プロジェクトカバーの変更に失敗しました","project.settings.logo.upload.success":"プロジェクトカバーを変更しました","project.settings.member.menu":"成员菜单","project.settings.member.menu.set.role":"新增或管理权限角色","project.settings.member.menu.upgrade.button":"升级获得更多权限角色","project.settings.member.menu.upgrade.description":"管理员、拥有者、自定义权限","project.settings.member.reach.limit":"项目当前成员容量为%s人，升级后可邀请更多成员","project.settings.member.reach.limit.org":"项目当前成员容量为%s人，增加企业成员名额后即可邀请更多成员","project.settings.no.exist.warn":"プロジェクトを引き継ぐことができません。再度お試しください","project.settings.no.right.warn":"プロジェクトを引き継ぐ権限がありません。","project.settings.over.plan.warn":"ライセンスをアップグレードして再度お試しください","project.settings.placeholder":'"DELETE"を入力して確認してください',"project.settings.remove.member":"削除","project.settings.resend":"招待メッセージを再送信","project.settings.save.success":"保存に成功しました","project.settings.select.owner":"新しいオーナーを選択してください","project.settings.tab.activity":"動きプッシュ","project.settings.tab.infomation":"項目お知らせ","project.settings.tab.more":"もっと","project.settings.tab.preference":"項目の優先順位","project.settings.transfer":"プロジェクトの引き継ぎ","project.settings.transfer.confirm":"プロジェクトの引き継ぎを確認","project.settings.transfer.members.exceed.2org":"目标企业的项目成员名额为%s人，小于当前项目成员数。请联系企业拥有者增加成员名额，或减少当前项目成员数。","project.settings.transfer.members.exceed.2user":"目标个人的项目成员名额为%s人，小于当前项目成员数。请联系他增加成员名额，或减少当前项目成员数。","project.settings.transfer.roles.change.1":"移交项目后，您将不再是项目拥有者!","project.settings.transfer.roles.change.2":"移交项目后，您将不再是项目拥有者。项目将不能再使用企业版相应功能!","project.settings.transfer.roles.change.3":"移交项目后，您将不再是项目拥有者。项目将不能配置管理员权限，不能继续使用更多丰富插件!","project.settings.transfer.success":"プロジェクトの引き継ぎが終了しました","project.settings.visibility":"項目権限","project.switcher.no.result":"このプロジェクトに関連する検査結果は見つかりませんでした","project.switcher.placeholder":"プロジェクトの検索","project.tags":"标签","project.transfer.success":"移動しました","project.transferring":"移動中","projects.export":"プロジェクトをエクスポート","projects.import":"プロジェクトをインポート","projects.manager.all.project":"すべてのプロジェクト","projects.transfer.to.organization":"迁入个人项目到企业","projects.transfer.to.organization.confirm":"确定迁入","projects.transferIn":"入居プロジェクト","projects.transferIn.btn":"転入","projects.transferIn.to":"入居まで：","projects.transferOut":"転出プロジェクト","projects.transferOut.btn":"転出","projects.transferOut.to":"転出まで：","quit.success":"部門から退出することに成功しました","remind.add":"リマインダーを追加","remind.ago":"%s以前","remind.close":"リマインダーを取り消す","remind.happened":"リマインド開始","remove.success":"削除成功","repeat.add":"リピート設定","repeat.description.daily":"每%1天重复","repeat.description.monthly":"每%1月 %2 日重复","repeat.description.weekly":"每%1周 %2 重复","repeat.freq.CUSTOM":"自定义重复","repeat.freq.DAILY":"毎日繰り返す","repeat.freq.MONTHLY":"毎月繰り返す","repeat.freq.NO":"リピートなし","repeat.freq.WEEKLY":"毎週繰り返す","repeat.freq.WORKDAY":"工作日重复","repeat.freq.YEARLY":"每年重复","repeat.interval":"间隔","resend.success":"送信しました","screen.crop":"截图","scrum.filter.clear":"はっきり","scrum.filter.hide.done":"完成したタスクを非表示にする","scrum.filter.search":"キーワードでフィルターを掛ける","scrum.filter.title":"タスクフィルター","scrum.filter.today.update":"今日の更新","scrum.sort.created":"作成時間でソート","scrum.sort.custom":"デフォルトでソート（全員シンクロナイズする）","scrum.sort.duedate":"締め切りでソート","scrum.sort.in.save":"保存しています","scrum.sort.priority":"優先順位ででソート","scrum.sort.save":"全員デフォルトでソートを保存する","scrum.sort.startdate":"按开始时间排序","scrum.sort.title":"タスクソート","scrum.sortandfilter.title":"ソートと選別","search.archived":"アーカイブ","search.no.content":"申し訳ありませんが、結果がない","search.no.result":"'%s' に一致する結果は見つかりませんでした。","search.placeholder":"クイック検索で欲しい情報を見つけましょう","search.project":"プロジェクト","search.result.all.type":"すべて種類","set.success":"設定しました","settings.no.permission":"設定の変更に権限がありません。オーナーに連絡してください。","simditor.add.link.title":"添加链接","simditor.alignCenter":"文字を中央に揃える","simditor.alignLeft":"文字を左に揃える","simditor.alignRight":"文字を右に揃える","simditor.alignment":"文字を両端に揃える","simditor.blockquote":"引用","simditor.bold":"太字","simditor.code":"コードを挿入する","simditor.color":"フォントの色","simditor.coloredText":"カラーテキスト","simditor.deleteColumn":"列の削除","simditor.deleteRow":"行の削除","simditor.deleteTable":"表の削除","simditor.externalImage":"ファイルからの画像","simditor.hr":"罫線","simditor.image":"画像の挿入","simditor.imageAlt":"画像の説明","simditor.imageSize":"画像のサイズ","simditor.imageUrl":"画像のURL","simditor.indent":"インデントを増やす","simditor.insertColumnLeft":"左に列を挿入する","simditor.insertColumnRight":"右に列を挿入する","simditor.insertRowAbove":"上に行を挿入する","simditor.insertRowBelow":"下に行を挿入する","simditor.italic":"斜体","simditor.link":"リンクの挿入","simditor.linkText":"リンクのテキスト","simditor.linkUrl":"所在地","simditor.normalText":"普通のテイスト","simditor.ol":"順序ありのリスト","simditor.outdent":"インデントを減す","simditor.removeLink":"リンクの削除","simditor.restoreImageSize":"画像元のサイズに戻す","simditor.selectLanguage":"言語の選択","simditor.strikethrough":"取り消し線","simditor.table":"表","simditor.text":"テキスト","simditor.title":"タイトル","simditor.ul":"順序なしのリスト","simditor.underline":"アンダーライン","simditor.upload":"アップロード","simditor.uploadError":"アップロードエラー","simditor.uploadFailed":"アップロード失敗","simditor.uploadImage":"画像のアップロード","simditor.uploading":"アップロードしている","stage.add.tip":"新規クエスト段階…","stage.edit.title":"ステージを追加するまたは編集する","stage.menu.add.next.stage.title":"この後に新ステージを追加","stage.menu.add.stage.hint":"ステージの次に新ステージが追加されます","stage.menu.add.title":"ステージを追加する","stage.menu.archive.tasks.title":"このステージのタスクをアーカイブする","stage.menu.cannot.delete":"このステージにあるタスクを全て削除してからステージを削除して下さい","stage.menu.confirm.archive.tasks":"このステージのタスクをアーカイブしますか？","stage.menu.confirm.delete":"このステージを完全に削除しますか","stage.menu.date.picker":"このステージすべてのタスクの期限を設定","stage.menu.date.picker.clear.success":"締め切りの削除に成功しました","stage.menu.date.picker.error":"締め切りと開始時間が重ねました","stage.menu.date.picker.success":"期限を設定しました","stage.menu.date.picker.title":"時間を選択してください","stage.menu.delete.title":"ステージを削除","stage.menu.edit.title":"ステージを編集","stage.menu.lock.stage":"ワークフローモードに切換え","stage.menu.lock.stage.msg":"ワークフローモードに切り換えれば、当ステージは最後のステージになり、当ステージのタスクは「完成した」状態になります。","stage.menu.move.tasks.success":"移動しました","stage.menu.move.tasks.title":"当ステージのタスクをすべて移動する","stage.menu.stage.name":"ステージタイトル","stage.menu.title":"ステージメニュー","stage.menu.toggle.stage.tasks.executor":"このステージにおけるすべてのタスクの担当者を設定する","stage.menu.toggle.stage.tasks.executor.success":"担当者をアサインしました","stage.menu.toggle.stage.tasks.executor.title":"担当者を選択する","stage.menu.unlock.stage":"フリーモードに切換え","stage.menu.unlock.stage.msg":"フリーモードに切り替えれば、現在のステージの後は新しいステージを追加できます。タスクフローモードから離れ、全てのステージは独立した状態になります。","stage.selector.changed.tips":"分组信息已改变，请重新选择","stage.selector.tips":"タスクのグループまたはステージを変更できます","stage.selector.title":"場所を選択。","submit.post":"ポスト","submit.ticket.chat.with.us":"専属するコンサルタント","submit.ticket.email":"请输入你的常用邮箱","submit.ticket.menu.online.classroom":"オンラインレッスン","submit.ticket.menu.support":"ヘルプセンター","submit.ticket.menu.video":"ビデオを使用","submit.ticket.other":"網","submit.ticket.pl.anything":"其他想说的话…","submit.ticket.pl.help":"输入反馈内容","submit.ticket.pl.suggestion":"你有什么建议吗？","submit.ticket.question":"問題","submit.ticket.send":"送信","submit.ticket.success":"あなたのフィードバックを提出し、私たちはすぐにあなた","submit.ticket.suggestion":"提案","submit.ticket.title":"助ける","subtask.card.create.input.placeholder":"サブタスクの内容を入力する","subtask.card.create.placeholder":"サブタスクを追加する","subtask.menu.confirm.delete":"このサブタスクを削除しますか","subtask.menu.confirm.transform":"サブタスクをタスクに変更しますか？","subtask.menu.delete.title":"サブタスクを削除する","subtask.menu.title":"サブタスクメニュー","subtask.menu.transform.title":"サブタスクをタスクに変更","tag.creator.placeholder":"タグ名","tag.creator.title":"タグの新規作成","tag.creator.warning.name.exit":"标签名称已存在！","tag.menu.confirm.delete":"タグを削除するのをもう一度確認してください。","tag.menu.delete.title":"タグの削除","tag.menu.edit.title":"タグの編集","tag.menu.title":"タグメニュー","tag.picker.add":"タグの追加","tag.picker.none":"タグなし","tag.view.create":"新規タグ","tag.view.entry.info":"%s 個エントリー","tag.view.event.info":"予定数：%s","tag.view.file.info":"ファイル数：%s","tag.view.placeholder.info":"「新規タグ」ボタンをクリックしてタグを作成すれば、タグでプロジェクトの内容をチェックできるようになります。","tag.view.placeholder.infoLink":"タグの使い方の説明はこちら。<a href='https://www.teambition.com/research/best-practices/article?p=research-best-practices&s=&_id=5439058462c0c4b62f57c23c' class='link-add-handler' target='_blank'>今すぐチェックしましょう</a>。","tag.view.placeholder.title":"プロジェクトにタグがありません","tag.view.post.info":"ポストの数：%s","tag.view.task.info":"タスクの数：%s 项任务","target.event.closed":"该项目日程已关闭","target.event.fork.post.denied":"无权限复制到该项目","target.event.move.post.denied":"无权限移动到该项目","target.post.closed":"该项目分享已关闭","target.post.fork.post.denied":"无权限复制到该项目","target.post.move.post.denied":"无权限移动到该项目","target.work.closed":"该项目文件已关闭","target.work.fork.post.denied":"无权限复制到该项目","target.work.move.post.denied":"无权限移动到该项目","task.creator.add":"タスクを追加する","task.creator.content":"タスク内容","task.creator.multiple":"複数タスクを新規作成","task.creator.multiple.all":" %s 個のタスクを新規作成する","task.creator.multiple.desc":" %s 行の内容が入力されました。行ごとにタスクを作成しますか。","task.creator.multiple.one":"タスクを一個だけ新規作成する","task.creator.multiple.too.many":"入力した内容の行数が多すぎます","task.creator.multiple.too.many.confirm":"確認しました","task.creator.multiple.too.many.desc":"最大入力可能行数は %s 行。今入力した行数は %s 行。","task.creator.set.duedate":"締め切りを設定する","task.creator.set.startdate":"開始時間を設定する","task.creator.tips":"タスクから添加","task.detail.add.note":"タスクのメモを追加する","task.detail.archived":"このタスクはアーカイブされました","task.detail.complete":"タスクが完成された","task.detail.due.date":"期限","task.detail.executor":"担当者：","task.detail.no.executor":"担当者なし","task.detail.priority":"優先度","task.detail.priority.info":"優先度の選択","task.detail.redo":"タスクをやり直す","task.detail.remind":"リマインダー","task.detail.repeat":"繰り返し","task.detail.repeat.info":"繰り返す周期の選択","task.detail.setting.remind":"%s 後ほどお知らせを設定する","task.detail.stage":"タスクステージ","task.detail.stage.unset":"設定なし","task.detail.start.date":"開始時間","task.detail.tasklist":"タスクグループ","task.detail.time.click.set":"設定をクリックする","task.dueDate.label":"%s締め切り","task.group":"グループ","task.group2":"タスクグループ","task.list.belong.to":"担当タスク%s","task.list.no.task":"今週はタスクがありません","task.menu.confirm.delete":"このタスクを削除するのかを確認してください","task.menu.copy":"タスクのコピー","task.menu.copy.check.link":"元タスクに新しいタスクのアップデート通知を受ける","task.menu.copy.check.linked":"新しいタスクに元タスクのアップデート通知を受ける","task.menu.copy.fail":"タスクのコピーが失敗しました","task.menu.copy.success":"タスクをコピーしました：","task.menu.copy.tips":"タスクの題名、サブタスクとメモがコピーされます","task.menu.delete.title":"このタスクを削除する","task.menu.move":"タスクの移動","task.menu.move.fail":"タスクの移動が失敗しました","task.menu.move.success":"タスクを移動しました：","task.menu.move.tips":"プロジェクト間移動する場合、タスクの添付ファイルと一部の参加者情報が保存できません","task.menu.search.project":"プロジェクトの検索","task.menu.select.group":"プロジェクトグループの選択","task.menu.select.project":"プロジェクトの選択","task.menu.select.stage":"階段の選択","task.menu.title":"タスクメニュー","task.menu.warning":"まずタスクグループとステージを選択して下さい","task.placeholder":"タスクなし","task.recent.placeholder":"あなたがまだ任務とスケジュール","task.startDate.label":"%s 開始","task.viewl.authority.msg":"%s だけ完成状態を変更できます","tasklist.bar.add.group":"添加任務パケット","tasklist.bar.done.tasks":"完了したタスク","tasklist.bar.member.tasks":"メンバータスク","tasklist.bar.memberOf.tasks":"%1の任務","tasklist.bar.pin":"タスクグループバーを固定する","tasklist.bar.search.group":"検索パケット","tasklist.bar.smart.group":"スマートグループ","tasklist.bar.today.tasks":"今日のタスク","tasklist.bar.total.tasks":"完成してないタスク","tasklist.bar.unassigned.tasks":"担当者が未定のタスク","tasklist.bar.unpin":"タスクグループバーの固定を解除","tasklist.creator.new":"新規作成","tasklist.creator.submit":"作成","tasklist.creator.tasklist.desc":"タスクグループの要約","tasklist.creator.tasklist.title":"タスクグループ名","tasklist.creator.temp":"テンプレート","tasklist.dump.confirm":"确定导出","tasklist.dump.hint":"选择需要导出的任务分组","tasklist.menu.add.templates":"テンプレートとして保存","tasklist.menu.add.templates.desc":"(タスクグループ &gt; 作成 &gt; テンプレート)で使えます","tasklist.menu.add.templates.detail":"当ステージをテンプレートとして追加する","tasklist.menu.add.templates.success":"%sが追加された","tasklist.menu.confirm.archive":"このタスクグループを本当にアーカイブしますか","tasklist.menu.confirm.delete":"このタスクグループを完全に削除するのかを確認してください","tasklist.menu.delete.title":"タスクグループを削除する","tasklist.menu.edit.title":"タスクグループを編集する","tasklist.menu.last.cannot.edit":"最後のタスクグループを削除できません","tasklist.menu.tasklist.desc":"タスクグループの要約","tasklist.menu.tasklist.title":"タスクグループ名","tasklist.menu.templates":"カスタムテンプレート","tasklist.menu.title":"パケットメニュー","tasklist.tab.status.done":"完了","tasklist.tab.status.normal":"近日","tasklist.tab.status.overdue":"期限超過","tasklist.tab.status.upcoming":"迫っている","tasklist.temp1stage1":"プランニング","tasklist.temp1stage2":"プロトタイプ","tasklist.temp1stage3":"レンダリング","tasklist.temp1stage4":"査定中","tasklist.temp1stage5":"完成","tasklist.temp1title":"デザイン","tasklist.temp2stage1":"要件定義","tasklist.temp2stage2":"デザイン","tasklist.temp2stage3":"研究開発","tasklist.temp2stage4":"テスト","tasklist.temp2stage5":"リリースした","tasklist.temp2title":"調査","tasklist.temp3stage1":"ユーザ問題","tasklist.temp3stage2":"解決中","tasklist.temp3stage3":"解決した","tasklist.temp3stage4":"フィードバック＆解決","tasklist.temp3title":"ユーザサポート","tasks.no.task":"タスクなし","team.belongsTo":"所属：%s","team.create":"部門を作成する","team.create.placeholder":"部門の名前","team.create.sub":"サブ部門を作成する","team.create.sub.placeholder":"サブ部門の名前","team.create.success":"部門の作成に成功しました","team.detail":"部門情報","team.mananger.add":"部門に追加しました","team.mananger.quit":"退出","team.mananger.remove":"削除する","team.manger.events":"予定","team.manger.no.member":"まだメンバー加入","team.manger.no.project":"プロジェクトなし","team.manger.project.confirm.remove":"このプロジェクトを外しても大丈夫ですか？","team.manger.project.confirm.title":"チームをプロジェクトから外しました","team.manger.tasks":"タスクのスケジューリング","team.member.add":"メンバーを部門に追加する","team.member.menu":"部門メンバーメニュー","team.member.remove":"メンバーを部門から削除する","team.member.remove.content":"メンバーが部門から削除された後、自動的にその部門の項目から退出される","team.member.search.placeholder":"%sを探す","team.member.subteam":"サブ部門メンバー","team.member.team":"部門メンバー","team.members.count":"%s人のメンバー","team.menu":"部門メニュー","team.menu.confirm.delete":"このチームを削除してもよろしいですか？","team.menu.delete.title":"チーム削除","team.menu.edit.title":"チーム名編集","team.name":"%s部門は以下の項目に追加しました","team.projects":"部門項目","team.projects.add":"追加項目","team.projects.add.search":"検索項目","team.projects.add.title":"添加チームが参加したプロジェクト","teambition.title":"Teambition · もっとも使いやすいコラボレーションプラットフォーム","teams.split":"、","this.stage":"このステージ","this.task":"このタスク","time.format.error":"時間の形式が正しくありません","time.input.placeholder":"入力時間","time.setting.error":"締め切りと開始時間が重ねました","today.events":"今日の日程","token.expired":"トークンの期限が切れています","token.reauth":"権限を再度与えます","total.events.and.tasks":"合計で %s","unarchived.entry.success":"成功した記帳解枠","unarchived.event.success":"日程のアーカイブを解除","unarchived.file.success":"ファイルのアーカイブを解除","unarchived.folder.success":"フォルダーのアーカイブを解除","unarchived.post.success":"アーカイブを解除しました","unarchived.tag.success":"タグのアーカイブを解除","unarchived.task.success":"タスクのアーカイブを解除","unarchived.taskgroup.success":"タスクグループのアーカイブを解除","unarchived.tasklist.tip":"该项目已关闭任务分组功能，请开启任务分组功能后再进行取消归档操作。","update.file":"更新","uploader.error":"アップロード失敗","uploader.file.exceed":"文件超过最大限制","uploader.file.exceed.size":"ファイル %s　サイズが大きすぎます。1GB以下のファイルを選んでください","uploader.file.exceed.size.default":"文件 %s 过大，请选择 10M 以内的文件！","uploader.file.exceed.size.free":"文件 %s 过大，请选择 200M 以内的文件！升级后可支持1G大小。","uploader.files.duplicate":"このファイルはすでにアップロードされています","uploader.files.exceed.number":"1回の操作で最大 50 ファイルまでです","uploader.not.accept":"サポートされていないファイルタイプまたはファイルデータにエラーの可能性があります。","uploader.type.no.allowed":"(.%s)はサポートされていないファイルタイプです。圧縮後アップロードして下さい。","uploading.tip":"正在上传图片","user.satisfaction.bad":"完全不愿意","user.satisfaction.feedback.0":"感谢评价，你觉得 Teambition 在哪些地方不够好？","user.satisfaction.feedback.1":"感谢评价，你觉得 Teambition 还需要怎样改进？","user.satisfaction.feedback.2":"感谢评价，你最喜欢 Teambition 的哪些功能？","user.satisfaction.good":"非常愿意","user.satisfaction.placeholder":"写一些反馈...","user.satisfaction.recommend":"你有多大意愿向你的朋友推荐 Teambition?","user.satisfaction.send":"发送","user.settings.comment.notice":"コメント通知","user.settings.daily.mail.notice":"当日の仕事通知を自動メールで受け取る","user.settings.mobile":"移動端","user.settings.monthly.mail.notice":"月間マガジンを購読","user.settings.notification.setting":"通知の設定","user.settings.participant.notice":"参加者への通知","user.settings.preference.usePanelTitle":"サイドパネルを使ってタスクの詳細を表示する","user.settings.receive.event.notice":"「新しい予定」の通知を受けました","user.settings.receive.file.notice":"「新しいファイル」の通知を受けました","user.settings.receive.post.notice":"「新しいポスト」の通知を受けました","user.settings.receive.task.notice":"「新しいタスク」の通知を受けました","user.settings.setting":"設定","user.settings.task.file.update.notice":"タスクとファイルが更新された場合通知を受けとる","visible.close":"オフ","visible.mode":"プライバシーのモード","visible.open":"を開けるのは","visible.to.involve":"参加者だけに表示","visible.to.member":"メンバーに表示","wall.view.create.post":"ポストを追加する","wall.view.html.post":"一般ドキュメント","wall.view.markdown.post":"Markdownドキュメント","wall.view.post.creator.info":"%sが発表した。時間：","wall.view.post.order.create.time":"作成時日順で表示する","wall.view.post.order.reply.time":"返信時日順で表示する","wall.view.shimo.post":"石墨ドキュメント","wall.view.shimo.update":"ドキュメントを更新","wall.view.yiqixie.post":"ドキュメントを一緒に作成する","wall.yiqixie.default.title":"一緒にドキュメントを作成する","week.selector.search":"検索の期日","weibo.menu1":"我关注的微博","weibo.menu2":"我发布的微博","weibo.menu3":"@我的微博","weibo.menu4":"好友圈微博","work.copy.message":"复制文件 %s 至","work.copy.success":"成功复制了文件","work.creator.info":"%sがアップロードした。時間：","work.creator.tips":"アップロードファイル ","work.edit.title":"ファイル名","work.menu.archive.file":"归档文件","work.menu.confirm.delete":"このファイルを完全に削除しますか？","work.menu.copy.file":"复制文件","work.menu.delete.title":"ファイルを削除する","work.menu.move.file":"移动文件","work.menu.title":"ファイルメニュー","work.move.message":"ファイル%sを移動します。場所：","work.move.success":"成功移动了文件","work.move.title":"ファイルを移動","work.picker.from.dropbox":"Dropboxから選ぶ","work.picker.from.library":"ファイルから選ぶ","work.picker.from.link":"ダウンロードリンク","work.picker.title":"ファイルを添付する","work.picker.uploader":"パソコンから選ぶ","work.rename.title":"ファイル名を編集","work.versions.current":"現在バージョン","work.versions.enter.edit":"このバージョンの説明情報を編集","work.versions.title":"バージョン","works.background.uploader.close.confirm":"ファイルをアップロード中です。終了してもよろしいですか？","works.background.uploader.close.confirm.title":"閉じてもよろしいですか？","works.background.uploader.error":"ファイルのアップロードができませんでした。","works.background.uploader.uploaded":"ファイルをアップロードしました","works.background.uploader.uploading":"ファイルをアップロード中 %s/%s","works.uploader.uploading.total":"%s ファイルをアップロード中"}),n.setLocales("ko",{"1day":"1일 ","1hour":"1시간","20mins":"20분","4hours":"4시간",FRI:"금요일",MON:"월요일",SAT:"토요일",SUN:"일요일",THU:"목요일",TUE:"화요일",WED:"수요일",add:"추가",added:"추가됨",all:"모든 포스트",archive:"아카이브",back:"뒤로",birthday:"생년월일",bookkeeping:"부기",bound:"즉시 연동",by:"by",calendar:"캘린더",cancel:"취소",clickToEdit:"클릭하여 편집하기",close:"닫기",collapse:"접다",collection:"폴더",colon:":",comma:"，",confirm:"확인",connected:"네트워크 연결되어 돌아오신 것을 환영합니다",copyAs:"%s(으)로 복제하기",copyTo:"에 복사하기",create:"만들기",creator:"설립자",day:"날","delete":"삭제",disconnected:"네트워크가 문제 생겼으니 체크하고 재시도해 주세요.",done:"완료",draft:"보존되지 않은 문서가 있어 회복하시겠습니까?",edit:"편집",email:"메일",entries:"帐目",entry:"어카운트",error:"죄송합니다만, 에러가 생겼습니다!",event:"일정",events:"일정",executor:"집행자",expand:"전개",favorite:"즐겨찾기",file:"파일",files:"파일",fullStop:".",groupchat:"群聊",guest:"게스트",hide:"숨기기",inbox:"수신함",language:"한국어",location:"위치",login:"로그인",logout:"로그아웃",manager:"관리자",me:"나",member:"멤버",merge:"merge",mobile:"전화번호",month:"월",more:"더 보기",moveTo:"(으)로 옮기기",my:"나의",noRight:"변경하실 수 없습니다",none:"无",open:"열기",organization:"기업",owner:"소유자",plugin:"어플과 플러그",position:"직위",post:"포스트",posts:"포스트",project:"프로젝트",projects:"프로젝트","public":"공개",register:"등록하기",remove:"제거",renew:"续费",repeat:"반복",reply:"회신",rmb:"위안",save:"완료",search:"검색",setting:"설정",show:"표시",stage:"단계",tags:"태그",task:"태스크",tasklist:"태스크 패킷",tasks:"태스크",team:"부서",today:"오늘",unarchive:"아카이브 취소",unfavorite:"즐겨찾기 취소",unknown:"미지",unknownDate:"미지 일정",updated:"에 업데이트함",upgrade:"升级",upload:"업로드",view:"보기",website:"웹사이트",week:"주",works:"文件","acitivity.timeline.notif.none.tip":"모든 사람이 알림을 받을 수 없습니다","acitivity.timeline.notif.tip":"사람이 알림을 받을 수 있습니다","activity.card.body.checkMore":"더 보기","activity.card.create.headerTips":"프로젝트를 만들었습니다","activity.card.error.notFound":"%s를 찾을 수 없습니다. 이미 삭제될 수도 있습니다","activity.card.project.title":"태스크 통계","activity.card.table.doneTasks":"완성","activity.card.table.placeholder":"프로젝트 최근 전개 상황","activity.card.table.title":"프로젝트 전개","activity.card.table.todoTasks":"미완","activity.card.today.title":"오늘의 일","activity.card.unassigned.title":"가져가지 않은 태스크","activity.comment.link.title":"关联内容","activity.destroyer.confirm.delete":"이 소식을 영원히 삭제하시겠습니까?","activity.destroyer.delete":"소식을 삭제하기","activity.destroyer.delete.fail":"삭제 실패","activity.destroyer.delete.success":"삭제돠었습니다","activity.download.all.attachments":"첨부 다운로드하기","activity.early.hidden":"显示更早的%s条评论","activity.early.loading":"正在载入更早的评论...","activity.early.shown":"隐藏较早的评论","activity.editor.error":"코멘트 변경 실패","activity.editor.place.holder":"코멘트 변집하기","activity.editor.success":"코멘트 설정되었습니다.","activity.editor.title":"코멘트 변집하기","activity.invisible.not.involved.tip1":"해당내용은 참여자만 볼 수 있습니다. %1는(은) 아직 멤버가 아니기 때문에 <a class='add-involve'>참여자로 추가한 </a> 후，%2에서 알림을 업데이트할 수 있습니다.","activity.invisible.not.involved.tip2":"해당내용은 참여자만 볼 수 있습니다. %1는(은) 아직 멤버가 아니기 때문에 <a class='add-involve'>참여자로 추가한 </a> 후，%2에서 알림을 업데이트할 수 있습니다.","activity.invisible.not.member.tip1":"이 내용은 참여자만 볼 수 있으며, 당신이 언급한 %s이 아직  프로젝트에 가입하지 않았지만 그들은 알림을 받을 수 있음","activity.invisible.not.member.tip1.addmember":", 당신도 그를 <a class='add-member-involve'> 프로젝트에 가입시키고 참여자로 추가할 수 있음</a>.","activity.invisible.not.member.tip2":"이 내용은 참여자만 볼 수 있으며 당신이 언급한 %s등 %s사람들은 아직 프로젝트에 가입하지 않았지만 그들은 알림을 받을  수 있음","activity.invisible.not.member.tip2.addmember":", 당신도 그를 <a class='add-member-involve'> 프로젝트에 가입시키고 참여자로 추가할 수 있음</a>.","activity.invisiblea.addmember.success":"멤버가 프로젝트에 가입됨","activity.moreAttachments":"등","activity.moreFiles":"개의 파일","activity.panel.checkAll":"모든 프로젝트 동향 보기","activity.panel.filter.allMember":"모든 멤버","activity.panel.filter.allType":"모든 유형","activity.panel.filter.date":"시간","activity.panel.filter.member":"멤버","activity.panel.filter.system":"시스템 메시지","activity.panel.filter.type":"유형","activity.panel.invite":"새 멤버 초대","activity.panel.menu.calendar":"프로젝트를 구독하기","activity.panel.menu.checkArchive":"아카이브 검색하기","activity.panel.menu.config":"어풀과 플러그","activity.panel.menu.copy":"프로젝트 복사","activity.panel.menu.enterOrg":"기업에 들어가기","activity.panel.menu.export.tasks":"导出分组内所有任务","activity.panel.menu.share":"프로젝트를 공유하기","activity.panel.placeholder.searchMember":"멤버 찾기","activity.panel.title.activities":"프로젝트 동향","activity.panel.title.all":"프로젝트 메뉴","activity.panel.weeker.all":"전부","activity.system.handlers.enterorg":"前往企业：%s","activity.system.handlers.enterproject":"前往项目：%s","activity.system.handlers.openchat":"前往私信：%s","activity.timeline.add.attachment":"첨부 추가","activity.timeline.add.emoji":"스티커 추가","activity.timeline.comment":"@언급타인, 'Enter'스피드 게시","activity.timeline.comment.ghost":"<a class=‘login-handler’>로그인</a> 또한<a class='register-handler'>등록한</a>후에 토론에 참여하실 수 있습니다.","activity.timeline.like":"좋아요","activity.timeline.like.tips.long":"좋아요 %s명","activity.timeline.like.tips.short":"좋아요","activity.timeline.only.attachment":"첨부만","activity.timeline.only.comment":"코멘트만","activity.timeline.remove.like":"취소","activity.timeline.reply":"게시","activity.timeline.reply.enter":"Enter을 누르고 메시지 발송","activity.timeline.reply.quickly.placeholder":"@언급타인, 'Ctrl+Enter' 누르고 게시하기","activity.timeline.reply.shortcut":"Ctrl+Enter을 누르고 메시지 발송","activity.visible.not.involved.tip1":"당신이 언급한 %1는(은) 아직 멤버가 아닙니다. <a class='add-involve'>참여자로 추가한 </a>후, 그는 %2에 업데이트 알림을 받을 수 있습니다.","activity.visible.not.involved.tip2":"당신이 언급한 %1등 %2인이 아직 멤버가 아닙니다. <a class='add-involve'>참여자로 추가한 </a>후, 그들은 %3에 업데이트 알림을 받을 수 있습니다.","activity.visible.not.involved.tip3":"당신이 참여자가 아닙니다. <a class='add-involve'>참여자로 추가한 </a> 후，%s에서 알림을 업데이트할 수 있습니다.","activity.visible.not.involved.tip4":"%1와(과) 당신은 참여자가 아닙니다. <a class='add-involve'>참여자로 추가한 </a> 후，%2에서 알림을 업데이트할 수 있습니다.","activity.visible.not.member.tip1":"당신이 언급한 %s이 아직  프로젝트에 가입하지 않았지만 그들은 알림을 받을 수 있음","activity.visible.not.member.tip1.addmember":", 당신도 그를 <a class='add-member'>프로젝트에 가입시킬 수 있음</a>.","activity.visible.not.member.tip2":"당신이 언급한 %s 등 %s 사람들이 아직  프로젝트에 가입하지 않지았만 그들은 알림을 받을 수 있음","activity.visible.not.member.tip2.addmember":", 당신도 그들을 <a class='add-member'>프로젝트에 가입시킬 수 있음</a>.","add.members.by.cooperated":"협동한 적 있는 멤버 가져오기","add.members.by.cooperated.placeholder":"협동한 적 있는 멤버가 없습니다","add.members.by.emails":"메일주소 대량 입력","add.members.by.emails.placeholder":"将邮箱粘贴到这里，多个邮箱之间用换行分隔，每次最多添加20个。当前项目剩余成员名额%s人。","add.members.by.emails.placeholder.unlimit":"将邮箱粘贴到这里，多个邮箱之间用换行分隔，每次最多添加20个。","add.members.error.limit":"제한을 초과했습니다. 매번에 20개의 메일주소만 추가할 수 있습니다.","add.members.error.message":"기업 멤버수가 상한을 초과함","add.members.tips.add.exceed":"이미 %s명 초과했습니다","add.members.tips.add.remian":"%s명 더 추가할 수 있습니다","add.success":"추가되었습니다","all.member":"모든 멤버","all.project":"모든 프로젝트","already.inbox.later.message":"이미 나중 처리하였음","already.inbox.later.message.hint":" %s후 다시 알림","app.download":"앱 다운로드","archive.event":"일정을 아카이브하기","archive.file":"파일을 아카이브하기","archive.folder":"폴더를 아카이브하기","archive.post":"포스트를 아카이브하기","archive.tag":"태그를 아카이브하기","archive.task":"태스크 아카이브하기","archive.taskgroup":"태스크 패킷을 아카이브하기","archive.title":"아카이브 검색하기","archived.event.success":"일정 아카이브되었습니다","archived.file.success":"파일 아카이브되었습니다","archived.folder.success":"폴더 아카이브되었습니다","archived.post.success":"포스트 아카이브되었습니다","archived.projects":"아카이브된 프로젝트","archived.tag.success":"태그 아카이브되었습니다","archived.task.success":"태스크 아카이브되었습니다","archived.taskgroup.success":"태스크 패킷 아카이브되었습니다","at.not.involved":"(참여자 리스트에 없음)","authority.get.error":"죄송합니다, 관련 접근 권한이 없습니다.","authority.get.error.content":"관리자에세 연락하여 접근 권한을 조정하거나 당신에게 프로젝트 가입을 초청합니다.  ","board.stage.sortplaceholder":"마우스를 놓고 미션이 심사 단계에 진입합니다","bookkeeping.archived":"이 어카운트 이미 아카이브되었기 때문에 수정할 수 없습니다.","bookkeeping.home.fields.amount":"금액","bookkeeping.home.fields.category":"유형","bookkeeping.home.fields.content":"내용","bookkeeping.home.fields.creator":"설립자","bookkeeping.home.fields.date":"시간","bookkeeping.home.fields.tags":"태그","bookkeeping.home.header.filter.toggler.title":"선별과 설치","bookkeeping.home.header.filtering":"（선별됨）","bookkeeping.home.tips.header.approve":"해당 어카운트는 결재권자가 없습니다. 결재권자만 어카운트에 선별할 수 있습니다. <a class=‘bookkeping-setting-approver'>결재권자 설정하기</a>","bookkeeping.home.tips.placeholder":"간편하게 일계를 기록하시기","bookkeeping.home.tips.placeholder.approve":"（결재권자만 어카운트에 선별할 수 있습니다. 일계를 기록하기 전에 먼저<a class='bookkeping-setting-approver'>결재권자 설정해 주세요.</a>）","bookkeeping.home.total.expense":"총지출","bookkeeping.home.total.expense.filtered":"선별한 후의 지출","bookkeeping.home.total.income":"총수입","bookkeeping.home.total.income.filtered":"선별한 후의 수입","bookkeeping.panel.filter.end.date":"종료 시간","bookkeeping.panel.filter.hide.approved":"선별된 어카운트 숨기기","bookkeeping.panel.filter.start.date":"사작 사간","bookkeeping.panel.input.placeholder":"관련된 어카운트 감색","bookkeeping.panel.title.filter":"선별","bookkeeping.panel.title.filter.clear":"전체 삭제","bookkeeping.panel.title.settings":"어카운트 설치","bookkeeping.settings.approver.member":"결재권자","bookkeeping.settings.approver.tips":"결재권자만 어카운트에 선별할 수 있습니다. 한 명 이상의 결재권자를 설정 가능합니다.","bookkeeping.settings.approver.title":"결재권자 설정하기","bookkeeping.settings.category.edit.placeholder":"분류명칭","bookkeeping.settings.category.title":"분류 관리","bookkeeping.settings.expense.tips":"지출","bookkeeping.settings.fields.in":"기존 필드","bookkeeping.settings.fields.out":"미추가 필드","bookkeeping.settings.fields.title":"기존 필드 설정하기","bookkeeping.settings.income.tips":"수입","calendar.add.subscriber":"添加关注","calendar.invisivle.event.tip1":"%s등 %s명이 이미 배정되었습니다","calendar.invisivle.event.tip2":"%s이미 배정되었습니다","calendar.search.no.result":"검색 결과가 없습니다","calendar.search.subscriber":"搜索","calendar.show.event":"日程","calendar.show.task":"任务","calendar.subscriber.display.title.recommend.members":"최근 협력 멤버","calendar.subscriber.display.title.self.projects":"개인 프로젝트","calendar.subscriber.display.title.starred.projects":"스타 프로젝트","calendar.subscriber.is.empty":"点击下方「添加关注」<br />添加你所关心的成员或项目","calendar.subscriber.search.placeholder.member":"멤버 검색","calendar.subscriber.search.placeholder.project":"프로젝트 검색","calendar.subscriber.search.placeholder.team":"부서 검색","calendar.subscriber.tab.member":"成员","calendar.subscriber.tab.project":"项目","calendar.subscriber.tab.recommend":"推荐","calendar.subscriber.tab.team":"부서","calendar.subscriber.title":"添加成员和项目日历","calendar.time":"시","cancel.inbox.later.message":"나중 처리 이미 취소","chat.message.at.me":"[누가 나를@리트윗함]","chat.message.list.is.empty":"일시 개인 채팅 없음","chat.message.list.is.error":"개인 채팅 리스트 획득 실패","chat.message.list.to.refresh":"클릭하여 리프레시","chat.modal.title":"채팅","chat.nav.popover.new.chat":"채팅 제기","chat.room.add.emoji":"添加表情","chat.room.chat.create":"新聊天","chat.room.chat.empty1":"暂无私信消息","chat.room.chat.empty2":"在这里你会收到新私信的消息提示","chat.room.cloesd.room":"群聊已关闭","chat.room.cloesd.room.placeholder":"群聊应用已关闭","chat.room.group.empty1":"还没有群聊消息","chat.room.group.empty2":"项目中的成员都可以在这里参与群聊","chat.room.group.mute":"메시지 음소거","chat.room.member.empty1":"暂无成员","chat.room.member.empty2":"邀请你的同伴开始协作吧！","chat.room.new.private.msg":"私信","chat.room.new.project.msg":"群聊","chat.room.placeholder":"说点什么...","chat.room.send":"发送","chat.room.send.error":"发送私信失败，请重新尝试","chat.room.send.success":"发送私信成功，您可以在收件箱<a class='essage-url url-handler open-inbox-chat' data-id='%s'>私信列表</a>查看","collection.creator.collection.title":"폴더명","collection.creator.create.success":"새 폴더 작성되었습니다","collection.creator.duplication.title":"이 폴더명 더 이상 이용할 수 없습니다","collection.destroyer.confirm.delete":"%s 를 영원히 삭제하시겠습니까?","collection.destroyer.delete.fail":"삭제 실패. 재시도해 주세요.","collection.destroyer.delete.success":"삭제되었습니다","collection.destroyer.deleting":"삭제 중","collection.destroyer.title":"확인","collection.download.title":"下载文件夹","collection.edit.duplication.title":"사용할 수 없는 폴더명입니다","collection.menu.confirm.delete":"이 폴더를 영원히 삭제하시겠습니까?","collection.menu.delete.title":"폴더 삭제","collection.menu.title":"폴더 메뉴","collection.move.message":"폴더 %s 으로 옮기기","collection.move.title":"폴더 옮기기","collection.picker.creator.input.tips":"폴더명","collection.picker.creator.tips":"폴더 만들기","collection.picker.select.collection":"목적 폴더를 선택해 주세요.",
"collection.rename.title":"리네임","confirm.delete":"삭제","confirm.unarchive.tip":"아카이브를 취소하면 루트 디렉트리에 옮겨집니다. 취소하겠습니까?","confirm.unarchive.tip.file":"取消归档后将移动至根目录，确认取消归档？","copy.link":"링크 복제","copy.link.failed":"복제 실패","copy.link.success":"복제했습니다","create.event":"일정 만들기","create.event.success":"일정을 성공하게 만들었습니다","create.post.success":"작성된 새로운 공유:","create.task":"태스크 만들기","create.task.success":"작성된 새로운 태스크：","datetimepicker.date":"日期","datetimepicker.time":"时间","delete.entry":"부기를 삭제하기","delete.event":"일정 삭제","delete.file":"파일 삭제","delete.folder":"폴더 삭제","delete.post":"포스트 삭제","delete.success":"삭제되었습니다","delete.tag":"태그 삭제되었습니다","delete.task":"태스크 삭제하기","delete.taskgroup":"태스크 패킷 삭제","desktop.notification":"데스크탑 알림","desktop.notification.desc":"「데스크탑 알림」은 편하게 알림을 이용하고 효율을 높일 수 있습니다","desktop.notification.disable":"데스크탑 알림 끄기","desktop.notification.enable":"데스크탑 알림 키기","download.failed":"下载失败","draft.discard":"소홀","draft.restore":"회복","due.date":"마감일","editor.mode.html":"富文本编辑","enter.organization.guide":"企业向导","enter.organization.guide.text1":"进入","enter.organization.guide.text2":"，了解和配置企业版功能。","entry.amount.unit":"￥","entry.archives.success.unarchive":"어카운트 아카이브 취소되었습니다","entry.category.title.null":"해당된 유형이 없습니다","entry.creator.expense.title":"지출을 기록하기","entry.creator.income.title":"수입을 기록하기","entry.creator.other.add.placeholder":"유형을 추가하기","entry.creator.other.category":"더 보기","entry.creator.placeholder.amount":"금액","entry.creator.placeholder.content":"내용","entry.creator.placeholder.note":"노트를 추가하기","entry.detail.cost":"자본금","entry.detail.profit":"이윤","entry.list.action.approve":"심사","entry.list.action.revoke":"취소","entry.list.status.approved":"선별됨","entry.menu.action.approve":"어카운트 허가하기","entry.menu.action.archive":"어카운트 아카이브하기","entry.menu.action.delete":"어카운트 삭제","entry.menu.action.edit":"어카운트 변경하기","entry.menu.action.revoke":"어카운트 삭제하기","entry.menu.confirm.delete":"이 프로젝트를 삭제하시겠습니까?","entry.menu.delete.tips":"이 어카운트 삭제하시겠습니까?","entry.menu.success.approve":"어카운트 선별되었습니다.","entry.menu.success.archive":"어카운트 아카이브되었습니다.","entry.menu.success.revoke":"어카운트 삭제되었습니다.","entry.menu.success.unarchive":"어카운트 아카이브 취소되었습니다","entry.menu.title":"어카운트 메뉴","entry.menu.title.delete":"어카운트 삭제","event.all.day.tips":"（하루 종일）","event.confirm.addMember.description":"이것은 중복된 일정입니다. 참여자를 어떤 일정에 추가하시겠습니까?","event.confirm.addMember.title":"참여자 추가","event.confirm.archive.description":"이것은 중복된 일정입니다.  어떤 일정의 파일링이 필요하십니까?","event.confirm.archive.title":"파일링 일정","event.confirm.btn.all":"모든 일정","event.confirm.btn.current":"현재 일정","event.confirm.btn.next":"후속 일정","event.confirm.btn.ok":"확인","event.confirm.delete.description":"이것은 중복된 일정입니다.  어떤 일정을 삭제하시겠습니까?","event.confirm.delete.title":"일정 삭제","event.confirm.removeMember.description":"이것은 중복된 일정입니다.  참여자를 어떤 일정에서 제거하시겠습니까?","event.confirm.removeMember.title":"참여자 제거","event.confirm.update.description":"이것은 중복된 일정입니다.  어떤 일정을 수정하여 저장하시겠습니까?","event.confirm.update.following":"후속 일정, 또한 해당된 일정에 관련된 후속 일정이 다 변경될 것입니다.","event.confirm.update.single":"이 일정만, 패킷에 다른 일정이 변경되지 않겠습니다.","event.confirm.update.title":"중복 일정 업데이트","event.confirm.updateMember.description":"이것은 중복된 일정입니다. 참여자를 어떤 일정으로 업데이트 하시겠습니까?","event.confirm.updateMember.title":"참여자 업데이트","event.confirm.updateRepeat.description":"중복된 규칙을 후속 모든 일정으로 업데이트하시겠습니까?","event.confirm.updateRepeat.title":"중복된 규칙 업데이트","event.creator.all.day":"하루 종일","event.creator.edit.tips":"일정 편집","event.creator.edit.title":"일정을 편집하기","event.creator.end.time":"종료 시간","event.creator.end.time.error":"시간 격식 정확하지 않습니다","event.creator.location.placeholder":"장소","event.creator.save.after":"나중에 업데이트","event.creator.save.single":"지금 업데이트","event.creator.start.time":"시작 시간","event.creator.tips_1":"일정을","event.creator.tips_2":"에 추가하기","event.creator.title.placeholder":"일정 제목","event.detail.appearin.tips":"Appearin동영상 회의에 들어가기(최대 8인)","event.detail.archived":"이 일정 이미 아카이브되었기 때문에 수정할 수 없습니다.","event.detail.end.date.tips":"종료일","event.detail.start.date.tips":"시작 시간","event.fork.hint":"参与者和评论不会被复制到新日程","event.menu.confirm.delete":"이 일정 삭제하시겠습니까?","event.menu.copy":"复制日程","event.menu.delete.title":"일정 삭제","event.menu.edit":"일정 편집하기","event.menu.fork.fail":"日程复制失败","event.menu.fork.success":"成功复制日程：","event.menu.move":"移动日程","event.menu.move.fail":"日程移动失败","event.menu.move.success":"成功移动日程：","event.menu.title":"일정 메뉴","event.move.hint":"跨项目移动时，部分参与者信息不会保留","event.placeholder":"일정이 없습니다.","event.time.picker.placeholder":"시간 입력하기","events.add":"일정 추가하기","events.no.event":"일정이 없습니다.","events.past":"과거의 일정","events.placeholder":"회의나 다른 행사를 마련하기 위해 새 일정을 추가할 때 참여자를 추가한 후 멤버에게 알림을 보낼 수 있습니다.","favorites.all":"모든 즐겨찾기","favorites.deleted":"삭제됨","favorites.invisible":"볼 수 없음","favorites.new":"업데이트됨","favorites.not.visible":"열릴 수 없어 이미 삭제되거나 권한이 없습니다","favorites.placeholder":"<br/>를(을) 아직 즐겨찾기에 넣지 않았습니다. 가치 있는 태스크, 일정, 포스트, 파일과 어카운트를 즐겨찾기에 넣을 수 있습니다","favorites.search":"나의 즐겨찾기에서 검색하기","favorites.unfavorite.success":"즐겨찾기 취소 성공","favorites.update.success":"업데이트 성공","favorites.updated":"새로운 내용이 생겼습니다. 클릭해서 업데이트하기","flagged.projects":"별표 프로젝트","fork.to.other.project":"复制到其它项目","future.events":"미래의 일정","globalGuide.prefession.goonfree":"继续使用免费版","globalGuide.prefession.paynow":"为专业版续费","globalGuide.profession.account.tip":"전문 버전이 이미 마감되었으며,  비용 납부 후  전문 버전을 계속 사용하여 풍부한 앱과 플러그 인을 제공하며 기타 기능을 업데이트합니다. <br/><br/><span class='star'>*</span> 무료 버전을 선택해 사용하면 당신의 모든 데이터가 영향을 받지 않으며, 업데이트 부분 기능만 사용할 수 없습니다.","globalGuide.version.profession.overdue":"专业版已到期","guide.create.project7.btn":"확인","guide.feature.link.folder.content":"你可以关联整个文件夹，当文件夹内容有更新时都可以接收到动态提醒","guide.feature.link.folder.done":"我知道了","helper.shortcuts":"쇼트커트","helper.shortcuts.for.board":"태스크의 쇼트커트","helper.shortcuts.for.board.new":"새 태스크 만들기","helper.shortcuts.for.event":"일정표의 쇼트커트","helper.shortcuts.for.event.new":"새 일정 만들기","helper.shortcuts.for.global":"전체 쇼트커트","helper.shortcuts.for.global.inbox":"수신함 열기","helper.shortcuts.for.global.myboard":"내 대시보드 열기","helper.shortcuts.for.global.portal":"전체 프로젝트로 돌아오기","helper.shortcuts.for.global.search":"검색 열기","helper.shortcuts.for.inbox":"수신함의 쇼트커트","helper.shortcuts.for.inbox.next":"다음 메시지","helper.shortcuts.for.inbox.previous":"이전 메시지","helper.shortcuts.for.markdown":"Markdown신택스 설명 열기","helper.shortcuts.for.taskgroup":"태스크 패킷 열기","helper.shortcuts.for.wall":"포스트의 쇼트커트","helper.shortcuts.for.wall.new":"새 포스트 만들기","html5audio.not.support":"현재 사용하는 브라우저로 이 음성 파일을 방송할 수 없습니다.","html5video.not.support":"현재 사용하는 브라우저로 이 비디오 파일을 방송할 수 없습니다.","iCalendar.howto":"도움 보기","iCalendar.msg1":"「%s」구독 신청 링크를 받으려면 QR코드 스캔하세요 ","iCalendar.msg2":"「%s」클릭하고 구독할 수 있습니다. 또한 링크를 캘린더 앱으로 복사해서 구독할 수 있습니다.","iCalendar.reset":"구독 신청 링크 다시 생기기","iCalendar.title":"구독「%s」","inbox.all.message":"알림 설정","inbox.at.me":"[@나]","inbox.ated.empty.tip1":"프로젝트 내용 업데이트할 때","inbox.ated.empty.tip2":"여기서 언급된 알림을 받을 수 있습니다","inbox.clear.messages":"읽음 삭제하기","inbox.clear.messages.desc":"읽음 다 삭제하시겠습니까?","inbox.delete.message":"메시지 삭제","inbox.go.to.entry":"결제로 가기","inbox.go.to.event":"일정으로 가기","inbox.go.to.organization":"기업로 가기：","inbox.go.to.post":"포스트로 가기","inbox.go.to.project":"프로젝트로 가기：","inbox.go.to.task":"태스크로 가기","inbox.later.empty.tip1":"프로젝트 내용 업데이트할 때","inbox.later.empty.tip2":"잠시후 여기서 처리할 알림을 받을 수 있습니다.","inbox.later.message":"잠시후 처리하기","inbox.later.message.cancel":"나중 처리 취소","inbox.message.snoozed.time.picker":"%s후 처리","inbox.my.mention":"@나","inbox.normal.empty.tip1":"프로젝트 내용 업데이트할 때","inbox.normal.empty.tip2":"여기서 알림을 받을 수 있습니다","inbox.preference":"알림 설정","inbox.read.messages":"모두 읽음으로 표시하기","integration.placeholder":"抱歉,「%s」暂无内容","integrations.processon.search.hint":"ProcessOn 파일 검색","integrations.processon.search.no.result":"검색 결과 없음","international.inner.title":"中国大陆服务器","international.outer.title":"国际服务器","international.tip.inner.description":"查看存放在中国大陆服务器的数据，在中国境内访问更快。","international.tip.inner.switch":"切换至中国大陆服务器","international.tip.outer.description":"为在海外使用访问更稳定，推荐将数据建立在 Teambition 国际服务器。","international.tip.outer.switch":"切换至国际服务器","jinshuju.data.serial_number":"%번 데이터","jinshuju.detail.search.placeholder":"데이터 번호을 입력함","jinshuju.entries.search.empty.hint":"검색 결과 없음","jinshuju.form.detail.closed.hint":"현재 데이터를 수집할 수 없습니다.","jinshuju.form.detail.createDate.des":"이 리스트는 %s에 생성됨","jinshuju.form.detail.header":"당신은 아래 리스트의 연동 선택을 선택할 수 있습니다.","jinshuju.form.detail.hint":"이 데이터의 상세 상황 보기에 사용합니다. 당신은 골드 데이터 뒤 플랫폼 리스트에서 해당 번호를 찾을 수 있습니다. 여러 개의 데이터와 관련되면 쉼표로 분할해 주십시오.","jinshuju.form.detail.title":"단일 데이터의 상세 상황","jinshuju.form.normal.closed.hint":"수집이 수동으로 정지되었고, 먼저 리스트 열기가 필요합니다.","jinshuju.form.normal.hint":"관련 후, 관련 리스트 입력 페이지를 직접 열 수 있습니다. ","jinshuju.form.normal.title":"리스트 입력 페이지","jinshuju.form.result.closed.hint":"당신은 결과 공유에 대한 공개 혹은 암호화 설정이 필요합니다.","jinshuju.form.result.hint":"관련 후, 관련을 통해 결과 공유 페이지를 열 수 있습니다.","jinshuju.form.result.title":"결과 공유 페이지","jinshuju.form.search.closed.hint":"당신은 먼저 내외 검색에 대한 공개 혹은 암호화 설정이 필요합니다.","jinshuju.form.search.hint":"관련 후, 관련을 통해 검색 페이지를 열 수 있습니다.","jinshuju.form.search.title":"내외 검색 페이지","jinshuju.form.status.semantization":"%s, %s. 현재 %s 데이터가 수집되었습니다.","jinshuju.form.title":"《%s》","jinshuju.open.rule.closed.des":"수집이 수동으로 정지됨","jinshuju.open.rule.open.des":"이미 열고 수집하는 중","jinshuju.permission.login.des":"골드 데이터 유저만 입력할 수 있음","jinshuju.permission.password.des":"비밀번로에 따라 입력","jinshuju.permission.private.des":"본인, 리스트 관리자, 데이터 보수 인원만 입력할 수 있음","jinshuju.permission.public.des":"모든 사람이 입력할 수 있음","jinshuju.rating":"%s성","jinshuju.refresh.token.hint":"골드 데이터의 권한 부여 시간이 초과됨","language.label":"언어","leave.page.alert":"편집한 내용은 아직 저장되지 않았습니다.","library.and":" 및 ","library.author":"설립자","library.collections.count":"%s 개의 폴더","library.copy":"复制","library.create.folder":"폴더 만들기","library.default.collection":"검토 중인 첨부 파일","library.download":"다운로드","library.file.update":"更新","library.files.zipname":"%s等%s项_teambition","library.fork.to":"复制 %s 至","library.move":"옮기기","library.move.to":"파일을 이동하겠습니다","library.name":"이름","library.placeholder":"빈 폴더","library.placeholder.no.create":"폴더 만들거나 업로드하기","library.size":"사이즈","library.success.forkTo":"成功复制 %1 至 %2","library.success.moveTo":"%1를(을) %2에 이동했습니다.","library.title":"파일","library.update":"업데이트 시간","library.upload.file":"파일 업로드","library.works.count":"%s 개의 파일","link.add":"관련","link.collection.permission.error":"您没有访问该项目的权限，无法查看文件夹","link.collection.preview.error":"该项目文件已关闭，无法查看文件夹","link.confirm.delete":"이 관련을 영원히 삭제하시겠습니까?","link.delete":"관련 취소","link.delete.fail":"삭제 실패, 다시 시도해 주세요.","link.delete.success":"삭제 성공","link.event.title":"관련 일정","link.evernote.title":"Evernote","link.file.title":"관련 파일","link.github.title":"Github","link.jinshuju.title":"골드 데이터","link.menu.title":"관련 메뉴","link.post.title":"관련 공유","link.task.title":"관련 미션","link.weibo.title":"관련 웨이보","markdown.helper.A":"링크","markdown.helper.H1":"H1제목","markdown.helper.H2":"H2제목","markdown.helper.H3":"H3제목","markdown.helper.H4":"H4제목","markdown.helper.blank.spaces":"스페이스 4개","markdown.helper.blockquote":"블록 인용 요소","markdown.helper.code":"코드","markdown.helper.em":"이탤릭체","markdown.helper.hr":"분할선","markdown.helper.img":"그림","markdown.helper.indentation":"들여쓰기","markdown.helper.more.syntax":"· <a href='http://wowubuntu.com/markdown/' target='_blank'>Markdown 신택스 설명</a> 더 보기","markdown.helper.ol1":"순서 표기1","markdown.helper.ol2":"순서 표기2","markdown.helper.ol3":"순서 표기3","markdown.helper.placeholder":"Markdown 서류를 입력하기","markdown.helper.pre":"코드구역 형성","markdown.helper.preview":"미리보기","markdown.helper.strong":"볼드체","markdown.helper.syntax":"신택스","markdown.helper.title":"Markdown","markdown.helper.try":" Markdown 한번 해 보세요！","markdown.helper.ul1":"무순서 표기1","markdown.helper.ul2":"무순서 표기2","member.bar.input":"멤버를 검색하기","member.bar.title":"프로젝트 멤버","member.card.detail":"멤버 상세 정보 알아보기","member.card.inactive.init.password":'계정 활성화를 기다려 <a class="resend-handler">를 다시 초청합니다</a>。초기 비밀 번호: ',"member.card.role.setting":"프로젝트 권한 설정","member.card.submenu.title":"프로젝트 권한 설정","member.card.task.organization":"기업 미션","member.card.task.project":"프로젝트 미션","member.finder.sendInvitationMailTo":"发送邀请邮件给：","member.finder.unregistered.phone":"该手机号未被注册","member.info":"개인 정보","member.involve":"참여자","member.involve.add":"참여자 추가","member.involve.none":"참여자가 없습니다.","member.involve.tip":"참여자는 댓글과 미션 업데이트 공지를 획득할 수 있음","member.menu.all":"모든멤버","member.menu.search":"멤버 찾기","member.progress.title.organization":"기업 멤버수 · %s/%s","member.progress.title.project":"현재 프로젝트 멤버수 · %s/%s","member.remove.from.team":"부서에서 멤버 제거","member.tasks.future.tasks":"미래의 태스크","member.tasks.recent.tasks":"최근 태스크","member.tasks.today.tasks":"오늘의 태스크","memberlatest.actived":"마지막 로그인은  ","members.manager.add.member":"멤버 추가","members.manager.all.members":"모든멤버","members.manager.new.members":"새 멤버","members.manager.unassigned.members":"부서를 배치하지 않는 멤버","message.system.activity.entry.remove":"无法查看该账目详情","message.system.activity.event.remove":"无法查看该日程详情","message.system.activity.organization.invite.members":"你可以查看该企业所有内容","message.system.activity.organization.remove":"无法查看该企业内容","message.system.activity.organization.remove.member":"无法查看该企业内容","message.system.activity.post.remove":"无法查看该分享详情","message.system.activity.project.archive":"无法查看该项目内容","message.system.activity.project.invite.members":"你可以查看该项目所有内容","message.system.activity.project.remove":"无法查看该项目内容","message.system.activity.project.remove.member":"无法查看该项目内容","message.system.activity.project.unarchive":"你可以查看该项目所有内容","message.system.activity.task.remove":"无法查看该任务详情","message.system.activity.work.remove":"无法查看该文件详情","moment.MMMMYYYY":"YYYY년 MM월","more.operations":"더 하기","move.to.other.project":"移动到其它项目","my.btn.personal":"회원정보 편집하기","my.btn.settings":"설정","my.events":"일정","my.favorites":"즐겨찾기","my.notes":"노트","my.post":"나의 포스트","my.projects":"개인 프로젝트","my.recent":"최근의 일","my.recent.today":"오늘의 일","my.recent.tomorrow":"내일의 일","my.recent.week":"최근 5일의 일","my.task.created":"추가된 태스크","my.task.dateByAll":"전부","my.task.dateByLastMonth":"최근 한 달","my.task.dateByLastTwoWeek":"최근 2주","my.task.dateByLastWeek":"최근 1주","my.task.dateByToday":"오늘","my.task.dateByYesterday":"어제","my.task.done":"완성된 태스크","my.task.joined":"참여한 태스크","my.task.sortByDueDate":"마감시간 순서대로 배열하기","my.task.sortByPriority":"게시한 시간에 따라 순서를 배열하기","my.task.sortByProject":"프로젝트 이름대로 배열하기","my.task.undone":"미완성 태스크","my.tasks":"태스크","nav.menu.menu":"메뉴","nav.menu.sortandfilter":"배열 및 선별","navigation.account.personalCenter":"계정 설치","navigation.create.organization":"기업를 만들기","navigation.create.organization.try.now":"즉시 무료 시험 사용","navigation.enterBBS":"커뮤니티","navigation.event":"일정","navigation.organization":"기업","navigation.project":"프로젝트","navigation.search":"검색","navigation.sharing":"포스트","navigation.task":"태스크","navigation.work":"文件","new.ribbon":"새로운 기능","noRight.view":"링크의 대상을 확인할 수 없습니다.","note.collapse":"收起备忘","note.delete.confirm":"이 노트를 삭제하시겠습니까? 다시 회복할 수 었습니다.","note.delete.confirm.title":"확인","note.expand":"显示全部","note.placeholder":"노트가 없습니다.<br />노트 내의 내용은 다른 회원님이 볼 수 없습니다.","notes.input.note":"내용...","notes.input.title":"제목…","object.picker.event.creator.tips":"새 일정 만들기","object.picker.event.title":"참여할 일정","object.picker.exceed.number":"한번에 최대 10 개 관련 대상을 선댁할 수 있습니다.","object.picker.file.uploader.tips":"파일 업로드","object.picker.post.creator.tips":"새 포스트 만들기","object.picker.search.all":"리턴 키를 눌러 모두 검색하기","object.picker.task.creator.tips":"새 태스크 만들기","open.file":"打开","oragnization.team.order.title.child":"子部门排序","org.guide.next":"다음","org.guide.team.create":"새 단체 만들기","org.reports.all.tips.create":"새 태스크 수량","org.reports.all.tips.delay":"만료된 태스크 수량","org.reports.all.tips.done":"완성된 태스크 수량","org.reports.all.title":"전체 리포트","org.reports.arrowLeft":"저번 주","org.reports.arrowRight":"다음 주","org.reports.currentWeek":"이번 주","org.reports.rank.tips.delay":"만료된 태스크 수량 랭킹","org.reports.rank.tips.delayResult":"%s，<span>%s개의 태스크가 만료되었습니다</span>","org.reports.rank.tips.done":"완성된 태스크 수량 랭킹","org.reports.rank.tips.doneResult":"프로젝트의 상태 갱신","org.reports.states.tips.title":"만료된 태스크","org.reports.tasks.tips.delay":"완선된 태스크","org.reports.tasks.tips.done":"리포트","organization.avatarCrop.choose":"그림 선택","organization.avatarCrop.edit.organization.avatar":"단체 프사 편집","organization.avatarCrop.hint":"최선치수가 64&times;64고, 고품질 사진을 업로드해서 편집할 수 있습니다","organization.avatarCrop.preview":"그림 프리뷰","organization.buy.members":"购买成员名额","organization.buy.now":"立即续费","organization.buy.years":"购买年数","organization.check.order":"查看订单","organization.created.key":"创建时间","organization.current.members.limit":"，共 %s 个名额","organization.current.members.number":"%s 位企业成员","organization.current.members.unlimit":", 정원 제한 없음","organization.desc":"기업 소개","organization.dueday":"%s","organization.email.sent30":"이메일이 발송됨 (30초 후 다시 발송할 수 있음)","organization.exclusive.consultant":"专属顾问","organization.exclusive.consultant.mail":"邮箱：%s","organization.exclusive.consultant.phone":"电话：%s","organization.exclusive.consultant.service":"Teambition 用户顾问为你提供一对一专属服务","organization.expired.key":"到期时间","organization.expiring.btn.ok":"확인","organization.expiring.contact.owner":"기업「%s」이 곧 마감되니, 기업 소유자에게 연락하여 비용을 납부해 주십시오.","organization.expiring.content":"기업판 이용 기한이 가까워져 기간 안에 연장해 주시기를 바랍니다.","organization.expiring.go.pay.new":"즉시 구매","organization.expiring.go.pay.renew":"즉시 비용 납부","organization.expiring.title":"만료 알림","organization.guide.import.members":"导入成员","organization.guide.import.members.description":"将成员添加到企业，你就可以在企业里管理成员、构建团队、配置权限。我们还提供了企业周报和数据统计功能，助你了解企业成员的工作情况。","organization.guide.import.projects":"迁入项目","organization.guide.import.projects.description":"将个人项目迁入企业，你就可以使用企业版的报告和统计功能，把握项目全局动态，便于统筹管理。","organization.help.description1":"在 Teambition 上创建一个企业，把项目和成员加入其中，即可借助专业的企业功能来统筹管理项目进展和成员工作情况。","organization.help.header":"了解企业版","organization.learn.more":"详细了解企业版","organization.member":"기업 멤버","organization.member.add":"기업 멤버 추가","organization.member.assign.team":"부서에 추가","organization.member.detail":"멤버 상세 정보","organization.member.detail.organization":"기업 멤버 상세 정보","organization.member.detail.project":"프로젝트 멤버 상세 정보","organization.member.exceed":"기업 멤버수가 상한에 이르렀음","organization.member.exceed.description":"기업 멤버가 %s인이 되었고, 기업 멤버 정원 추가 후, 더 많은 멤버를 초청할 수 있습니다","organization.member.menu":"기업 멤버 메뉴","organization.member.remove":"기업에서 멤버 제거","organization.memberadd.allRecommendInvited":"당신이 추천한 모든 유저가 본 기업에 가입됩니다","organization.memberadd.batch.invite":"일괄 초청","organization.memberadd.cooperatedMember":"제휴했던 멤버","organization.memberadd.inviteText":"계정 초청","organization.memberadd.noMemberInviteSomeone":"현재 기업에 당신만이 있으므로 <br>당신의 파트너를 초청하여 함께 일할 수 있습니다.","organization.memberadd.searchCantfind":"<wbr>“%s”를 찾을 수 없으며, <wbr>완전한 이메일 주소를 입력해 직접 기업에 추가할 수 있음","organization.memberadd.searchTip":"이메일 주소 / 핸드폰 번호를 입력해 주십시오","organization.memberadd.title":"기업 멤버 추가","organization.members.key":"成员数量","organization.name":"기업명","organization.nav.members":"멤버","organization.nav.projects":"프로젝트","organization.nav.reports":"리포트","organization.nav.statistics":"통계","organization.overdue":"만료됨","organization.overdue.btn.ok":"확인","organization.overdue.contact":"이 기업「%s」은 이미 마감되었므로, 최대한 빨리 비용을 납부하거나 기업 소유자에게 연락하여 프로젝트를 이전해 주십시오.","organization.overdue.message":"기업의 만료일이 지났습니다. 연장해 주시기를 바랍니다.","organization.overdue.renew":"이 기업「%s」은 이미 마감되었으니, 최대한 빨리 비용을 납부해 주십시오.","organization.overdue.title":"기업가 만료되었습니다.","organization.paid":"正常使用","organization.paid.overdue":"已过期","organization.payment.buy":"购买企业版","organization.project.blank.description":"你可以按照团队或者按照季度目标来创建项目。每个项目你都可以配上美观的封面，让你的工作空间更加愉悦。","organization.project.blank.title":"创建项目","organization.projects":"기업 프로젝트","organization.report.blank.description":"Teambition 将每周送达一份详尽的企业报告，从全局了解企业各个项目的进展、成员的工作效率，以及任务完成的情况。","organization.report.blank.title":"企业周报","organization.setting.permission":"공개성","organization.setting.private":"사적 기업(기업 멤버만 방문 가능)","organization.setting.public":"공개 기업(게스트가 기업내에 공개 프로젝트 및 멤머를 볼 수 있음)","organization.settings":"기업 설정","organization.settings.add.member.toplimit":"增加企业成员名额","organization.settings.add.members.success":"%s명 멤버를 추가해서 초대했습니다","organization.settings.avatar":"기업 프로필","organization.settings.avatar.upload":"새로운 프로필 업로드","organization.settings.avatar.upload.failed":"단체 프사 변경 실패","organization.settings.avatar.upload.success":"단체 프사 변경했습니다","organization.settings.button.delete":"삭제","organization.settings.button.transfer":"이전","organization.settings.delete":"기업 삭제하기","organization.settings.delete.msg":"기업를 삭제하면 해당 프로젝트, 팀, 멤버, 내용 등 다 삭제될 것입니다. 다시 회복할 수 없으니까 신중하게 해 주세요.","organization.settings.delete.success":"기업 삭제 성공","organization.settings.delete.title":"기업 삭제","organization.settings.desc.placeholder":"이 기업을 소개해 주십시오","organization.settings.label.belonging":"기업 귀속","organization.settings.leave":"기업에서 나가기","organization.settings.leave.msg":"기업에서 퇴거되면 해당된 정보를 볼 수 없겠습니다. 다시 가입하려면 관리자 또는 소유자에게 연학해 주세요.","organization.settings.leave.success":"기업에서 나갔습니다. 홈페이지로 돌아가겠습니다.","organization.settings.leave.title":"기업에서 나가기","organization.settings.order.teams":"部门排序","organization.settings.roles.and.permissions":"보기와 관리 권한","organization.settings.roles.config":"권한 배치","organization.settings.roles.onlyread":"권한 알아보기","organization.settings.save.success":"저장 성공","organization.settings.search.owner":"멤버 찾기","organization.settings.select.owner":"기업 소유자를 선택함","organization.settings.tab.consultant":"전문 컨설팅","organization.settings.tab.infomation":"기업 정보","organization.settings.tab.other":"더 많음","organization.settings.tab.pay":"유료 정보","organization.settings.transfer":"기업 이전","organization.settings.transfer.confirm":"이전 확인","organization.settings.transfer.success":"기업 이전 성공","organization.settings.transfer.tips":"한 기업 멤버를 선택해 새로운 기업 소유자가 되며, 이전 후 당신의 역할이 멤버로 변함","organization.settings.transfer.warning":"기업 이전 후, 당신은 기업 소유자가 더 이상 아니며 인도 조작을 취소할 수 없습니다!","organization.settings.update.plan":"제한된 멤버 수량에 도달했습니다","organization.settings.upperLimit":"제한된 멤버 수량을 초과했습니다","organization.statistics.activeness":"활성도","organization.statistics.blank.description":"Teambition 需要一周的时间统计第一份数据。企业统计功能将帮助管理者从项目、团队、成员等多个维度对企业状况进行分析。值得一提的是，这些数据在 App 上也可以实时查阅，随时随地都能了解进展、发现问题。","organization.statistics.blank.title":"企业统计","organization.statistics.chartMembers":"멤버 총수량","organization.statistics.chartProjects":"프로젝트 총수량","organization.statistics.count":"개","organization.statistics.going":"만료일 가까워짐","organization.statistics.membersAmount":"명 멤버","organization.statistics.membertab.all":"모든 멤버","organization.statistics.membertab.byDelayRate":"태스크만료율로","organization.statistics.membertab.byDoneRate":"태스크완성율로","organization.statistics.membertab.done.undo":"완성된/총 태스크 수량","organization.statistics.membertab.name":"이름","organization.statistics.membertab.new":"새 멤버","organization.statistics.membertab.noContent":"멤버 통계 정보가 없음","organization.statistics.membertab.projectsJoined":"참여프로젝트 수량","organization.statistics.membertab.title":"멤버 통계","organization.statistics.membertab.undergoing":"진행중인 태스크","organization.statistics.month":"월","organization.statistics.monthShow":"월","organization.statistics.none":"무","organization.statistics.overdue":"만료됨","organization.statistics.projectsAmount":"개의 프로젝트","organization.statistics.projecttab.all":"모든 프로젝트 패킷","organization.statistics.projecttab.byActiveness":"프로젝트 활성도로","organization.statistics.projecttab.byDelayRate":"태스크 만료율로","organization.statistics.projecttab.byDoneRate":"태스크 완성율로","organization.statistics.projecttab.doneUndo":"완성됨/총 태스크 수","organization.statistics.projecttab.member":"멤버","organization.statistics.projecttab.noContent":"프로젝트 통계정보 없음","organization.statistics.projecttab.project":"프로젝트","organization.statistics.projecttab.title":"프로젝트 통계","organization.statistics.projecttab.undergoings":"진행중인 태스크","organization.statistics.projecttab.weeklyActiveness":"주간 활성도","organization.statistics.projecttab.weeklyActivenessHint":"프로젝트 멤버가 주마다 제품의 내용","organization.statistics.searchMember":"멤버를 검색하기","organization.statistics.searchProject":"프로젝트 검색","organization.statistics.searchResult":"결과 검색","organization.statistics.sorting":"배열","organization.statistics.undergoing":"진행중","organization.statistics.weeklyActiveness":"단체 활성도","organization.statistics.weeklyActiveness.hint":"단체 멤버가 주마다 모든 프로젝트생산한 내용","organization.statistics.year":"년","organization.status.key":"企业状态","organization.switcher.intro.feature.permission":"强大而易管理的权限配置","organization.switcher.intro.feature.statistics":"丰富而有意义的数据统计","organization.switcher.intro.feature.weekReport":"每周自动推送的企业周报","organization.switcher.intro.title":"企业版高级功能","organization.team.order.title":"部门排序","organization.transfer.project.member.description":"已成功迁入%s个项目，同时添加项目成员到企业","organization.transfer.project.member.search.member":"搜索成员","organization.transfer.project.member.title":"添加项目成员到企业","organization.trial":"试用中","organization.trial.overdue":"试用结束","organization.visible":"企业可见","popover.search.current":"현재 프로젝트 안에서 검색“%s”","popover.search.whole":"모든 프로젝트 안에서 검색“%s”","portal.create.project":"새 프로젝트 만들기","portal.enter.organization.home.page":"기업","portal.project.notification":"프로젝트 보기","portal.project.star.bookmark.hint":"프로젝트에 들어와 %1(으)로 추가하기","portal.project.star.bookmark.hint.project":"%1(으)로 추가하기","portal.project.star.success":"별표 성공, 앞으로 빨리 이 항목을 방문하기 위해 <a class='show-bookmark-hint' data-gta='event' data-label='add-to-bookmark'>브라우저 마크에 저장하기</a>","portal.project.un.star.success":"별표 취소되었습니다","portal.unarchive.error":"죄송합니다만 이 프로젝트를 재작동 실패했습니다, 나중에 시도해 주세요.","portal.unarchive.project.description":"재작동된 후 이 프로젝트를 이용할 수 있습니다.","portal.unarchive.project.title":"프로젝트 재작동","portal.unarchive.success":"프로젝트가 재작동되었습니다.","post.attachment.not.visible":"无法打开，已删除或没有权限","post.creator.markdown.tips":"이 파일은 Markdown，<a class='md-help-handler'>신택스 설명을 썼습니다.</a>","post.creator.tips_1":"포스트를","post.creator.tips_2":"에 추가하기","post.creator.title.placeholder":"제목을 입력해 주세요.","post.detail.archived":"이 포스트가 아카이브되었기 때문에 수정할 수 없습니다.","post.menu.confirm.delete":"이 포스트를 삭제하시겠습니까?","post.menu.copy":"复制分享","post.menu.delete.title":"포스트 삭제","post.menu.edit":"编辑分享","post.menu.fork.fail":"分享复制失败","post.menu.fork.global.hint":"参与者和评论不会被复制到新分享","post.menu.fork.success":"成功复制分享：","post.menu.move":"移动分享","post.menu.move.error.hint":"没有权限对分享中的附件进行操作","post.menu.move.error.title":"无法移动分享","post.menu.move.fail":"分享移动失败","post.menu.move.global.hint":"跨项目移动时，部分参与者信息不会保留","post.menu.move.success":"成功移动分享：","post.menu.pin.title":"핀 포스트","post.menu.title":"포스트 메뉴","post.menu.unpin.title":"핀 포스트 취소","post.placeholder":"현재 포스트가 없습니다.","post.un.title":"제목 없음","post.update":"포스트 업데이트하기","powerups.add.plugins":"플랫폼을 오픈하고 더 많은 플러그 인을 추가함","powerups.app.close":"앱 닫음","powerups.app.close.btn":"닫기 확인","powerups.app.confirm.close":"<b>%s</b>내의 앱을 <b>%s</b> 닫으시겠습니까?","powerups.app.confirm.delete":"<b>%s</b>내의 앱을 <b>%s</b>삭제하시겠습니까?","powerups.app.delete":"앱 삭제","powerups.app.delete.btn":"삭제 확인","powerups.appearin.des":"일정표 플러그, 8명의 동영상 회의를 지지합니다. 리모트 회의지만 효율이 떨어지지 않습니다.","powerups.author":"%s에게 제공됨","powerups.bookkeeping":"부기","powerups.bookkeeping.des":"부기는 프로젝트의 지출을 쉽게 기록할 수 있게 해 줍니다. 동시에 관리자가 프로젝트의 각종 수입과 지출을 확인할 수 있고 모든 어카운트를 심사할 수 있습니다.","powerups.events":"일정","powerups.events.des":"일정표는 하루를 배정해 줄 것이고 리모트의 동반과의 동영상회의에도 참여할 수 있습니다.","powerups.evernote.des":"프로젝트의 수요에 따라 에버노트를 사용하면, 태스크, 일정, 포스트 등에 노트를 관련할 수 있습니다.","powerups.github.des":"Pull Request, issue, 혹은 Commits의 내용을 Teambition에 관련시킬 때 Teambition에서 동태알림을 받을 수 있습니다.","powerups.groupchat":"群聊","powerups.groupchat.des":"项目里的所有成员都可以在这里一起聊天，发送语音、图片，分享文件。自由地交流关于项目的各种信息。","powerups.item.close.plugin.tasklist":"关闭任务分组","powerups.item.detail.closed":"%s 이미 껴져 있습니다","powerups.item.detail.nav.apps.least":"최소한 한 어플을 보유하세요.","powerups.item.detail.opened":"%s 이미 켰습니다.","powerups.item.detail.tasklist.warning":"该项目中存在多个分组，请整理成一个分组再进行关闭操作","powerups.item.update.hint":"升级使用该插件","powerups.jinshuju":"골드 데이터 ","powerups.jinshuju.des":"골드 데이터는 조작이 간단하고 기능이 강한 온라인 리스트 디자인과 데이터로 플랫폼을 관리합니다. 템플릿이나 자체 정의로 리스트를 생성하며 골드 데이터는 유저에게 뒷면의 데이터 플랫폼을 자동으로 생성함.","powerups.markdown":"마크다운","powerups.markdown.des":"마크다운 형식으로 글을 작성하면, 간단한 부호로 텍스트 양식을 편집할 수 있습니다. 코멘트와 태스크 비고를 게시할 때 마크다운을 사용하세요!","powerups.modal.title.detail":"앱 상세 정보","powerups.posts":"포스트","powerups.posts.des":"지식의 공유와 소통을 위해 포스트는 팀과 공유와 토론하는 것을 도와 줍니다. 그림 추가, 텍스트 격식 편집과 마크다운을 지지합니다.","powerups.powerup.groupApp":"프로젝트 어플","powerups.powerup.plugin":"기능 플러그","powerups.preciseDate":"任务精确时间","powerups.preciseDate.des":"启用后，任务将增加「设置精确时间」的选项，起止时间会同步出现在任务板。","powerups.processon.des":"ProcessOn는 온라인 협력 제도 플랫폼이며 유저에게 가장 강력하고 쉽게 사용할 수 있는 도구를 제공합니다! 흐름도, BPMN, UML 도, UI 인터페이스 원형 디자인, iOS 인터페이스 원형 디자인 등의 온라인 창조를 지원함.","powerups.shimo":"Shimo문서","powerups.shimo.des":"제3자 클라우드 협동파일은 포스트 게시의 새로운 체험입니다. 계정에 권한을 부여한 후에 즉시 체험할 수 있습니다. 파일의 협동편집을 완성하는 과정과 실시간 리프레시를 지지합니다.","powerups.startDate":"미션 시작 시간","powerups.startDate.des":"미션 시작 시간을 설정해 더욱 효과적으로 미션을 배치하고 또한  더 직관적으로 미션 진행 상황을 볼 수 있습니다.","powerups.taskUniqueId":"任务 ID","powerups.taskUniqueId.des":"启用后，每创建一个任务都自动产生一个唯一编号，方便成员之间沟通传递。","powerups.taskUniqueId.dialog.confirm":"确认开启","powerups.taskUniqueId.dialog.desc":"请先设置项目编号，编号将作为 ID 前缀，用以区别项目。支持字母，2-4位。","powerups.taskUniqueId.dialog.edit.confirm":"保存","powerups.taskUniqueId.dialog.edit.desc":"设置项目编号，编号将作为 ID 前缀，用以区别项目。支持字母，2-4位。","powerups.taskUniqueId.dialog.edit.title":"任务 ID 设置","powerups.taskUniqueId.dialog.placeholder":"如 Design Team 可以设置为 DT","powerups.taskUniqueId.dialog.submitting":"开启中...","powerups.taskUniqueId.dialog.title":"开启任务 ID","powerups.taskUniqueId.success.edit.tip":"修改任务前缀成功","powerups.taskUniqueId.success.tip":"任务 ID 已开启，请刷新页面后查看","powerups.tasklist":"任务分组","powerups.tasklist.des":"任务分组可以帮助你对任务版进行分类管理，特别适用于研发项目的开发周期迭代，一个市场活动的不同周期等。","powerups.tasks":"태스크","powerups.tasks.des":"직관적으로 모든 사람의 작업진도를 알아볼 수 있습니다. 태스크판에는 언제라도 멤버와 토론을 할 수 있고 태스크에 서브태스크와 마감일을 설치할 수 있으며, 첨부파일 업로드할 수 있습니다.","powerups.weibo":"웨이보","powerups.weibo.des":"프로젝트의 수요에 따라 웨이보를 사용하면, 태스크, 일정, 포스트 등에 웨이보를 관련할 수 있습니다.","powerups.works":"文件","powerups.works.des":"文件库相当于一个可协作的网盘。它支持图片、doc、PDF、xlsx、MP4 等多种常用文件的在线预览。同时，你可以随时更新文件版本，历史版本均会保存。","powerups.yinxiang.des":"프로젝트 필요에 따라  인상 노트를 사용해 미션, 일정, 공유 등에 당신의 노트를 연동할 수 있습니다.","powerups.yiqixie":"같이 문서 쓰기","powerups.yiqixie.des":"제3자 클라우드 협동파일은 협동편집을 할 수 있는 포스트를 게시할 수 있는 곳이고, 권한부여, 계정연동을 할 필요없이 Teambition과 함께 최고의 작문체험을 시도합니다.","previewer.archived":"이 파일 이미 아카이브되었기 때문에 수정할 수 없습니다.","previewer.confirm.delete":"이 파일을 영원히 삭제하시겠습니까?","previewer.delete.file":"파일 삭제하기","previewer.download":"다운로드","previewer.download.file":"파일 다운로드하기","previewer.edit":"편집","previewer.enter.collection":"폴더로 가기","previewer.file.deleted":"원본 파일을 삭제했습니다.","previewer.file.translateFail":"파일 전환이 실팼습니다. 직접 미리보기 불가능합니다.","previewer.header.folder.tips":"소속된 폴더","previewer.header.root.tips":"루트 디렉트리","previewer.header.temp.tips":"임시 디렉터리","previewer.img.turn.left":"왼쪽으로 돌리기","previewer.img.turn.right":"오른쪽으로 돌리기","previewer.menu.confirm.delete":"이 파일을 삭제하시겠습니까?","previewer.menu.delete.title":"파일 삭제","previewer.menu.title":"파일 메뉴","previewer.move":"옮김","previewer.open":"打开","previewer.open.link":"링크 열기","previewer.update":"업데이트","previewer.updating":"업데이트 중","priority.high":"긴급","priority.none":"보통","priority.urgent":"매우 긴급","processon.cooperated":"나와 협력하는","processon.myFiles":"내 파일","processon.recent":"최근 수정","profession.expired":"专业版已到期","profession.setting.permission.hint":"专业版项目可配置项目管理员，","profession.warning.tip1":"专业版已经到期，请续费后继续使用专业版提供的丰富应用与插件及其他升级功能。您可以联系该项目拥有者进行续费。","profession.warning.tip2":"专业版已经到期，请续费后继续使用专业版提供的丰富应用与插件及其他升级功能。<br/><br/><span class='star'>＊</span> 如选择使用免费版，您的所有数据将不会受到影响，仅升级部分功能无法使用。","project.app.plugin.remove.essage":"플러그 인이 이미 삭제됨","project.at.members.organization":"비 프로젝트 멤버","project.at.members.project":"프로젝트 멤버","project.belonging.owner":"프로젝트 소유자","project.create.section":"클릭해서 새 패킷 추가","project.creator.belongsTo":"项目归属","project.creator.create.project":"프로젝트 만들기","project.creator.createFromTemplate":"从模板创建项目","project.creator.creating":"생성중...","project.creator.doneAndCreate":"完成并创建","project.creator.fillTemplate":"完善项目信息","project.creator.intro":"为不同的事务建立各自的项目，","project.creator.me":"나","project.creator.nextStep":"下一步","project.creator.owner":"소유자","project.creator.porject.name.placeholder":"프로젝트명",
"project.creator.section":"프로젝트 패킷","project.creator.teamplate.create":"创建并进入项目","project.creator.teamplate.intro":"正在从模板<span class='template-name'>%s</span>创建新项目","project.creator.template.failed":"模板创建失败，请稍候再试","project.creator.template.feedback":"建议与反馈","project.desc":"프로젝트 소개","project.grouping":"프로젝트 패킷","project.logoCrop.best.size.hint":"자른 크기600&times;200, 고화질 그림을 업로드해서 자를 수 있음","project.logoCrop.choose":"그림 선택","project.logoCrop.desktop.logo":"데스크탑 프로젝트 커버","project.logoCrop.mobile.logo":"모바일 프로젝트 커버","project.logoCrop.previews":"그림 미리보기","project.logoCrop.set.project.logo":"프로젝트 커버 편집","project.manager.enter":"단체를 만들고 프로젝트를 인계했습니다","project.manager.filter":"선별과 배열","project.manager.join":"가입하기","project.manager.joining":"가입중...","project.manager.not.member":"이 프로젝트의 멤버가 아닙니다.","project.manager.sort.by.name":"이름대로 배열하기","project.manager.success.join":"가입하셨습니다.","project.member":"项目成员","project.memberadd.add":"添加","project.memberadd.addMembersByLink":"通过链接邀请","project.memberadd.addRepetitive":"%s 已是项目成员","project.memberadd.addSuccess":"成功添加成员，已向 %s 发送邀请信","project.memberadd.added":"已加入","project.memberadd.allRecommendInvited":"为你推荐的用户均已加入本项目","project.memberadd.cooperatedMember":"合作过的成员","project.memberadd.header.title":"邀请新成员","project.memberadd.import":"导入","project.memberadd.imported":"已导入","project.memberadd.inviteViaAccount":"帐号邀请","project.memberadd.noMemberInviteSomeone":"现在项目中只有你一个，<br>你可以在此邀请你的小伙伴一起协作。","project.memberadd.orgMember":"企业成员","project.memberadd.orgTeam":"企业团队","project.memberadd.placeholder":"请输入邮箱或手机号，回车确认","project.memberadd.placeholderForOrg":"请输入企业成员/团队名称，或邮箱/手机号","project.memberadd.searchCantfind":"找不到<wbr>“%s”，<wbr>输入完整邮箱直接将其添加至项目","project.menu.copy.fail":"프로젝트 복사 실패","project.menu.copy.success":"프로젝트가 복사되었습니다","project.menu.mail.content":"%s 님께서 Teambition에서 나온 공개 프로젝트「%s」를 살펴보도록 초대합니다. 링크：%s","project.menu.mail.content.desc":"%s  님께서 Teambition에서 나온 공개 프로젝트「%s」를 살펴보도록 초대합니다. 프로젝트 요강: “%s” 링크：%s","project.menu.mail.title":"공개 프로젝트 “%s” 를 공유하기","project.menu.share.link":"링크를 공유하기","project.menu.share.to":"에 공유하기","project.menu.share.to.mail":"메일로 공유하기","project.menu.share.to.weibo":"웨이보로 공유하기","project.menu.weibo.content":"나는 Teambition에서 도움이 되는 공개 프로젝트「%s」를 찾았습니다.","project.menu.weibo.content.desc":"Teambition에서 도움이 되는 공개 프로젝트「%s」를 찾았습니다. 프로젝트 요강: “%s”。","project.name":"프로젝트명","project.none.section":"미선택 패킷","project.owner.search":"기업 혹은 멤버 찾기","project.panel.activity.project.add.team.and.members":" 添加了企业部门及部门成员:","project.panel.activity.project.archive":" 归档了项目","project.panel.activity.project.archive.collection":" 归档了文件夹:","project.panel.activity.project.archive.entry":" 归档了记账:","project.panel.activity.project.archive.event":" 归档了日程: %s","project.panel.activity.project.archive.post":" 归档了分享:","project.panel.activity.project.archive.tag":" 归档了标签:","project.panel.activity.project.archive.task":" 归档了任务:","project.panel.activity.project.archive.tasklist":" 归档了任务分组:","project.panel.activity.project.archive.work":" 归档了文件:","project.panel.activity.project.create.collection":" 创建了文件夹:","project.panel.activity.project.create.entry":" 创建了记账:","project.panel.activity.project.create.event":" 创建了日程: %s","project.panel.activity.project.create.post":" 创建了分享:","project.panel.activity.project.create.tag":" 创建了标签:","project.panel.activity.project.create.task":" 创建了任务:","project.panel.activity.project.create.tasklist":" 创建了任务分组:","project.panel.activity.project.create.works":" 上传了文件:","project.panel.activity.project.disable.application":" 关闭了应用:","project.panel.activity.project.disable.plugin":" 关闭了插件:","project.panel.activity.project.enable.application":" 打开了应用:","project.panel.activity.project.enable.plugin":" 打开了插件:","project.panel.activity.project.finish.task":" 完成了任务:","project.panel.activity.project.invite.members":" 邀请 %s 加入项目","project.panel.activity.project.join.as.organization.owner":" 作为企业拥有者加入项目","project.panel.activity.project.join.from.invite.link":" 通过项目链接加入项目","project.panel.activity.project.join.from.qrcode":" 通过二维码加入项目","project.panel.activity.project.join.from.user.invite.link":" 通过 %s 分享的邀请链接加入项目","project.panel.activity.project.join.from.user.qrcode":" 通过 %s 分享的二维码加入项目","project.panel.activity.project.join.from.weixin":" 通过微信平台加入项目","project.panel.activity.project.redo.task":" 重做了任务:","project.panel.activity.project.remove":" 删除了项目","project.panel.activity.project.remove.collection":" 删除了文件夹:","project.panel.activity.project.remove.entry":" 删除了记账:","project.panel.activity.project.remove.event":" 删除了日程: %s","project.panel.activity.project.remove.member":" 移除了成员:","project.panel.activity.project.remove.post":" 删除了分享:","project.panel.activity.project.remove.self":" 退出了项目","project.panel.activity.project.remove.tag":" 删除了标签:","project.panel.activity.project.remove.task":" 删除了任务:","project.panel.activity.project.remove.tasklist":" 删除了任务分组:","project.panel.activity.project.remove.team":" 移除了企业部门 %s，但保留部门成员","project.panel.activity.project.remove.team.and.members":" 移除了企业部门及部门成员:","project.panel.activity.project.remove.work":" 删除了文件:","project.panel.activity.project.transfer.to.organization":" 将项目移交给企业","project.panel.activity.project.transfer.to.user":" 将项目移交给用户","project.panel.activity.project.unarchive":" 取消归档了项目","project.panel.activity.project.unarchive.collection":" 取消归档了文件夹:","project.panel.activity.project.unarchive.entry":" 取消归档了记账:","project.panel.activity.project.unarchive.event":" 取消归档了日程: %s","project.panel.activity.project.unarchive.post":" 取消归档了分享:","project.panel.activity.project.unarchive.tag":" 取消归档了标签:","project.panel.activity.project.unarchive.task":" 取消归档了任务:","project.panel.activity.project.unarchive.tasklist":" 取消归档了任务分组:","project.panel.activity.project.unarchive.work":" 取消归档了文件:","project.panel.activity.project.update.description":" 修改了项目简介:","project.panel.activity.project.update.logo":" 更新了项目封面","project.panel.activity.project.update.name":" 修改了项目名称:","project.panel.activity.project.update.visibility":" 将项目设置为","project.panel.entry.income":"收入 ¥ %s","project.panel.entry.outcome":"支出 ¥ %s","project.remove.team.remain.members":"부서를 제거했지만 부서 멤버가 여전히 프로젝트에 남겨둠","project.remove.team.remove.members":"부서를 제거하고, 부서 멤버를 프로젝트에서 제거함","project.search":"搜索项目","project.section.down":"패킷을 아래로 옮기기","project.section.name":"신규 패킷 명","project.section.remove":"패킷을 취소하기","project.section.up":"패킷을 위로 옮기기","project.select.list.hint":"请选择一个项目","project.setting.defaultrole.help":'<a class="link-add-handler" href="/applications/permissions/%s" target="_blank">권한 설치</a> 사이트에서 더 많은 캐릭터를 추가할 수 있습니다.',"project.setting.defaultrole.tips":"프로젝트에 멤버를 추가할 때마다 해당 멤버의 권한을 기본적으로 %s(으)로 설치되어 있습니다.","project.setting.handler.transfer":"이전","project.setting.members.exceed.limit":"成员数超出限制","project.setting.members.reach.limit":"成员数已达上限","project.setting.nav.hint":"아이콘을 끌면 <a class='open-powerups'> 프로젝트메뉴-어플과 플러그</a>에 이동하며 어플을 끄거나 킬 수 있습니다.","project.setting.notification.accept":"동향 알림 푸시(마크하고 데스크탑탑의 방식으로 푸시하기)","project.setting.notification.reject":"동향 알림 푸시 안 함(마크만 표시))","project.setting.notification.tips":"해당 프로젝트에 새 동향이 있을 때 마크 혹은 통고의 방식으로 알림하기 ","project.setting.notification.title":"프로젝트 동향 알림","project.setting.permission.hint":"免费版项目不支持配置权限，","project.setting.reset.error":"링크 재설정 살패. 재시도해 주세요.","project.setting.reset.invite":"링크 재설정한 후 원래 링크가 즉시 무효될 것입니다.","project.setting.transfer.and.quit":"새로운 소유자를 임명해서 이 프로젝트에서 나갈 수 있습니다","project.setting.visibility.all":"공개 프로젝트","project.setting.visibility.info.all":"모든 사람이 링크로 방문할 수 있지만 프로젝트 멤버만 편집할 수 있습니다","project.setting.visibility.info.organization":"모든 Teambition 멤버에게 공개되어 있지만 프로젝트 멤버만 편집할 수 있습니다","project.setting.visibility.info.project":"프로젝트 멤버만 보고 편집할 수 있음","project.setting.visibility.organization":"기업 프로젝트","project.setting.visibility.project":"사적 프로젝트","project.settings":"프로젝트 설정","project.settings.add.member.repetitive":"%s 이미 프로젝트의 멤버입니다.","project.settings.add.member.success":"멤버 추가 성공.  %s 님께 초대메일을 보냈습니다.","project.settings.add.member.through.url.or.qrcode":"QR 코드를 스캔하거나 프로젝트 링크를 공유해서 멤버를 초대하세요","project.settings.add.member.through.url.or.tip1":"유효기간","project.settings.add.members.by.emails":"대량 초대","project.settings.archive":"아카이브","project.settings.archive.error":"프로젝트 아카이브 실패. 재시도해 주세요.","project.settings.archive.msg":"프로잭트의 상태가 완성되거나 일시정지라면 먼저 프로젝트 아카이브할 수 있습니다. 아카이브된 프로젝트는 쉽게 재작동할 수 있으며 데이터를 잃어버리지 않을 것입니다.","project.settings.archive.success":"프로젝트가 아카이브되었습니다. 홈페이지 밑에  아카이브된 프로젝트를 찾아볼 수 있습니다.","project.settings.button.delete":"삭제","project.settings.button.upload.cover":"새로운 표지 업로드","project.settings.cannot.quit":"无法退出项目","project.settings.cannot.quit.content":"您已作为团队加入项目，不能单独退出","project.settings.cannot.remove":"该成员作为团队加入项目，不能单独移除","project.settings.delete":"삭제","project.settings.delete.msg":"프로젝트를 삭제하면 안의 정보가 다 삭제될 것입니다. 다시 회복할 수 없으니까 신중하게 해 주세요.","project.settings.delete.success":"프로젝트가 삭제되었습니다.","project.settings.desc.placeholder":"이 프로젝트를 소개해 주세요.","project.settings.email.sent30":"메일를 발송되었습니다(30초 뒤에 다시 보낼 수 있음)","project.settings.label.actions":"프로젝트 조작","project.settings.label.permission":"새 멤버 디폴트 권한","project.settings.label.project.cover":"프로젝트 표지","project.settings.label.sort":"앱 배열","project.settings.label.subtitle.actions":"당신은 아래 조작을 진행할 수 있습니다","project.settings.leave":"나가기","project.settings.leave.msg":"프로젝트에서 나가면 해당 정보를 볼 수 없을 것입니다. 다시 가입하려면 관리자 또는 소유자한테 연학해 주세요.","project.settings.leave.success":"프로젝트에서 나갔습니다.","project.settings.logo.crop.image.size.too.large":"그림이 너무 큽니다. 4MB이내의 파일을 선택하세요!","project.settings.logo.upload.failed":"프로젝트 커버 변경 실패","project.settings.logo.upload.success":"프로젝트 거커 변경 성공","project.settings.member.menu":"成员菜单","project.settings.member.menu.set.role":"新增或管理权限角色","project.settings.member.menu.upgrade.button":"升级获得更多权限角色","project.settings.member.menu.upgrade.description":"管理员、拥有者、自定义权限","project.settings.member.reach.limit":"项目当前成员容量为%s人，升级后可邀请更多成员","project.settings.member.reach.limit.org":"项目当前成员容量为%s人，增加企业成员名额后即可邀请更多成员","project.settings.no.exist.warn":"프로젝트 옮기기 실패. 재시도해 주세요.","project.settings.no.right.warn":"프로젝트 욺길 권한이 없습니다.","project.settings.over.plan.warn":"새로운 소유자의 프로젝트 패키지를 업데이트하고 재시도해 주세요.","project.settings.placeholder":"확인하느라 “DELETE”를 입력해 주세요.","project.settings.remove.member":"멤버를 제거하기","project.settings.resend":"초대 메일 다시 보내기","project.settings.save.success":"저장 성공","project.settings.select.owner":"새로운 소유자를 선택하기","project.settings.tab.activity":"동태 푸시 ","project.settings.tab.infomation":"프로젝트 정보","project.settings.tab.more":"더 많음","project.settings.tab.preference":"프로젝트 선호","project.settings.transfer":"전이","project.settings.transfer.confirm":"현재 프로젝트 인계하기","project.settings.transfer.members.exceed.2org":"目标企业的项目成员名额为%s人，小于当前项目成员数。请联系企业拥有者增加成员名额，或减少当前项目成员数。","project.settings.transfer.members.exceed.2user":"目标个人的项目成员名额为%s人，小于当前项目成员数。请联系他增加成员名额，或减少当前项目成员数。","project.settings.transfer.roles.change.1":"移交项目后，您将不再是项目拥有者!","project.settings.transfer.roles.change.2":"移交项目后，您将不再是项目拥有者。项目将不能再使用企业版相应功能!","project.settings.transfer.roles.change.3":"移交项目后，您将不再是项目拥有者。项目将不能配置管理员权限，不能继续使用更多丰富插件!","project.settings.transfer.success":"프로젝트를 성공하게 인계했습니다","project.settings.visibility":"프로젝트 공개성","project.switcher.no.result":"죄송합니다, 이 프로젝트가 없습니다.","project.switcher.placeholder":"프로젝트 검색","project.tags":"标签","project.transfer.success":"옮기기 성공","project.transferring":"옮기는 중","projects.export":"프로젝트 엑스포트","projects.import":"프로젝트 임포트","projects.manager.all.project":"모든 프로젝트","projects.transfer.to.organization":"迁入个人项目到企业","projects.transfer.to.organization.confirm":"确定迁入","projects.transferIn":"프로젝트 임포트","projects.transferIn.btn":"옮기다","projects.transferIn.to":"뒷 프로젝트로 옮기기:","projects.transferOut":"프로젝트 엑스포트","projects.transferOut.btn":"엑스포트","projects.transferOut.to":"뒷 프로젝트로 옮기기:","quit.success":"부서 탈퇴 성공","remind.add":"알림 추가","remind.ago":"%s전","remind.close":"알림 닫기","remind.happened":"시작할 때","remove.success":"제거 성공","repeat.add":"중복 추가","repeat.description.daily":"매 %1날 반복","repeat.description.monthly":"매 %1월 %2일 반복","repeat.description.weekly":"매 %1주 %2 반복","repeat.freq.CUSTOM":"자기 정의 반복규칙","repeat.freq.DAILY":"매일 반복","repeat.freq.MONTHLY":"매달 반복","repeat.freq.NO":"반복하지 않음","repeat.freq.WEEKLY":"매주 반복","repeat.freq.WORKDAY":"평일 반복","repeat.freq.YEARLY":"매년 반복","repeat.interval":"간격","resend.success":"보냈습니다","screen.crop":"截图","scrum.filter.clear":"선별 삭제","scrum.filter.hide.done":"완성된 태스크 숨기기","scrum.filter.search":"관련 태스크 찾기","scrum.filter.title":"태스크 선별","scrum.filter.today.update":"오늘 업데이트","scrum.sort.created":"생성 시간에 따라 배열","scrum.sort.custom":"디폴트 순서(전체 멤버 동기화)","scrum.sort.duedate":"마감 시간에 따라 배열","scrum.sort.in.save":"저장 중","scrum.sort.priority":"우선 등급에 따라 배열","scrum.sort.save":"전체 멤버가 디폴트 순서를 동기화한 것으로 저장","scrum.sort.startdate":"按开始时间排序","scrum.sort.title":"미션 순서","scrum.sortandfilter.title":"배열 및 선별","search.archived":"아카이브했습니다","search.no.content":"죄송합니다만 더는 없습니다.","search.no.result":"“%s”에 관련된 내용을 찾을 수 없습니다","search.placeholder":"검색하여 필요한 내용 찾기","search.project":"기업 만들기","search.result.all.type":"모든 유형","set.success":"설정 성공","settings.no.permission":"당신은 이곳의 설정을 수정할 권한이 없습니다. 소유자에게 연락하여 조작하십시오.","simditor.add.link.title":"添加链接","simditor.alignCenter":"가운데 정렬","simditor.alignLeft":"왼쪽 정렬","simditor.alignRight":"오른쪽 정렬","simditor.alignment":"양쪽 정렬","simditor.blockquote":"인용","simditor.bold":"진하게","simditor.code":"코드 입력","simditor.color":"글자 색","simditor.coloredText":"컬러 글자","simditor.deleteColumn":"칸 삭제","simditor.deleteRow":"줄 삭제","simditor.deleteTable":"표 삭제","simditor.externalImage":"외부 링크 그림","simditor.hr":"구분선","simditor.image":"그림 입력","simditor.imageAlt":"그림 묘사","simditor.imageSize":"그림 크기","simditor.imageUrl":"그림 주소","simditor.indent":"오른쪽으로 들여 쓰기","simditor.insertColumnLeft":"왼쪽에서 칸을 추가하기","simditor.insertColumnRight":"오른쪽에서 칸을 추가하기","simditor.insertRowAbove":"위에 줄을 추가하기","simditor.insertRowBelow":"아래 줄을 추가하기","simditor.italic":"기울임","simditor.link":"링크를 입력하기","simditor.linkText":"글자 링크","simditor.linkUrl":"위치","simditor.normalText":"일반 텍스트","simditor.ol":"문단 번호","simditor.outdent":"왼쪽으로 들여 쓰기","simditor.removeLink":"링크 제거","simditor.restoreImageSize":"그림 크기 회복","simditor.selectLanguage":"프로그램 언어 선택","simditor.strikethrough":"취소선","simditor.table":"표","simditor.text":"텍스트","simditor.title":"제목","simditor.ul":"글머리표","simditor.underline":"밑줄","simditor.upload":"업로드","simditor.uploadError":"업로드 에러","simditor.uploadFailed":"업로드 실패","simditor.uploadImage":"그림 업로드","simditor.uploading":"업로딩","stage.add.tip":"태스크 단계 추가","stage.edit.title":"태스크 단계 추가 및 편집","stage.menu.add.next.stage.title":"뒤에 새 단계를 추가해 주세요.","stage.menu.add.stage.hint":"새 단계는 현재 단계 뒤에 추가될 예정입니다.","stage.menu.add.title":"새 단계 추가","stage.menu.archive.tasks.title":"이 단계에 속한 모든 태스크 아카이브하기","stage.menu.cannot.delete":"해당 단계의 태스크를 삭제한 후 이 단계를 삭제할 수 있습니다.","stage.menu.confirm.archive.tasks":"이 단계에 속한 모든 태스크 아카이브하겠습니까?","stage.menu.confirm.delete":"이 단계를 영원히 삭제하시겠습니까?","stage.menu.date.picker":"현 단계의 모든 태스크 마감일 설정","stage.menu.date.picker.clear.success":"마감 시간 클리어 성공","stage.menu.date.picker.error":"마감 시간과 시작 시간이 충돌됨","stage.menu.date.picker.success":"마감일 성공히 설정했습니다","stage.menu.date.picker.title":"마감일 선택","stage.menu.delete.title":"단계 삭제","stage.menu.edit.title":"단계 편집","stage.menu.lock.stage":"프로세스 모델로 바꾸기","stage.menu.lock.stage.msg":"프로세스 모델로 바뀐 후 해당 단계의 태스크는 완성됨으로 표시될 것이고 다른 단계의 왼성된 태스크도 해당 단계에 들어갈 것입니다.","stage.menu.move.tasks.success":"태스크 이동 성공","stage.menu.move.tasks.title":"본 단계의 모든 태스크 옮기기","stage.menu.stage.name":"단계명","stage.menu.title":"단계 메뉴","stage.menu.toggle.stage.tasks.executor":"현 단계의 모든 태스크 집행자 설정","stage.menu.toggle.stage.tasks.executor.success":"집행자 성공히 설정했습니다","stage.menu.toggle.stage.tasks.executor.title":"집행자 선택","stage.menu.unlock.stage":"프리 모델로 바꾸기","stage.menu.unlock.stage.msg":"프리 모델로 바뀐 후 해당 단계 뒤에 새 단계를 열 수 있습니다만 각 단계는 독립 상태(즉, 프로세스 단계에서 나가게 될 것)입니다.","stage.selector.changed.tips":"分组信息已改变，请重新选择","stage.selector.tips":"태스크 패널에 단계 및 패킷을 추가하거나 변경할 수 있습니다.","stage.selector.title":"위치 선택하기","submit.post":"즉시 게시","submit.ticket.chat.with.us":"전문 컨설팅","submit.ticket.email":"자주 사용하는 메일을 입력하세요.","submit.ticket.menu.online.classroom":"온라인 과정","submit.ticket.menu.support":"도움센터","submit.ticket.menu.video":"동영상 사용하기","submit.ticket.other":"기타 의견","submit.ticket.pl.anything":"다른 하고픈 말...","submit.ticket.pl.help":"피드백 내용을 입력하기","submit.ticket.pl.suggestion":"의견이 있습니까?","submit.ticket.question":"Teambition에 질문을 제기합니다","submit.ticket.send":"발송","submit.ticket.success":"당신의 피드백은 이미 제출했습니다. %s(를)을 통해서 연락드리겠습니다.","submit.ticket.suggestion":"Teambition에 의견을 제기합니다","submit.ticket.title":"도움","subtask.card.create.input.placeholder":"서브태스크 내용을 입력합니다...","subtask.card.create.placeholder":"서브태스크 추가","subtask.menu.confirm.delete":"이 서브태스크를 삭제하시겠습니까?","subtask.menu.confirm.transform":"이 서브태스크를 태스크로 바꾸시겠습니까?","subtask.menu.delete.title":"서브태스크 삭제하기","subtask.menu.title":"서브태스크 메뉴","subtask.menu.transform.title":"태스크로 바꾸기","tag.creator.placeholder":"태그명","tag.creator.title":"새 태그","tag.creator.warning.name.exit":"标签名称已存在！","tag.menu.confirm.delete":"이 태그를 삭제하시겠습니까?","tag.menu.delete.title":"태그 삭제","tag.menu.edit.title":"태그 설정하기","tag.menu.title":"태그 메뉴","tag.picker.add":"태그 추가","tag.picker.none":"태그가 없습니다","tag.view.create":"새 태그","tag.view.entry.info":"%s 개의 어카운트","tag.view.event.info":"%s 개의 일정","tag.view.file.info":"%s 개의 파일","tag.view.placeholder.info":"'새 태그' 를 클릭하면 새 태그를 만들 수 있습니다. ","tag.view.placeholder.infoLink":" 상세 방법은 여기 있습니다.<a href='https://www.teambition.com/research/best-practices/article?p=research-best-practices&s=&_id=5439058462c0c4b62f57c23c' class='link-add-handler' target='_blank'>즉시 보기</a>","tag.view.placeholder.title":"프로젝트에 태그가 없습니다.","tag.view.post.info":"%s 개의 포스트","tag.view.task.info":"%s 개의 태스크","target.event.closed":"该项目日程已关闭","target.event.fork.post.denied":"无权限复制到该项目","target.event.move.post.denied":"无权限移动到该项目","target.post.closed":"该项目分享已关闭","target.post.fork.post.denied":"无权限复制到该项目","target.post.move.post.denied":"无权限移动到该项目","target.work.closed":"该项目文件已关闭","target.work.fork.post.denied":"无权限复制到该项目","target.work.move.post.denied":"无权限移动到该项目","task.creator.add":"새 태스크 추가하기","task.creator.content":"태스크 내용","task.creator.multiple":"복수 개의 새 태스크를 추가하기","task.creator.multiple.all":"%s 개 추가","task.creator.multiple.desc":"%s 줄의 내용을 입력하셨는데 복수 개의 신규 태스크를 추가하시겠습니까?","task.creator.multiple.one":"하나만 추가","task.creator.multiple.too.many":"줄을 줄여 주세요.","task.creator.multiple.too.many.confirm":"승인","task.creator.multiple.too.many.desc":"최대 %s 줄이 허용됩니다.  %s 줄을 입력하셨습니다.","task.creator.set.duedate":"마감 시간 설정","task.creator.set.startdate":"시작 시간 설정","task.creator.tips":"새 태스크 추가","task.detail.add.note":"노트 추가","task.detail.archived":"이 태스크가 아카이브되었기 때문에 수정할 수 없습니다.","task.detail.complete":"태스크 완성","task.detail.due.date":"마감일","task.detail.executor":"집행자","task.detail.no.executor":"집해자 없음","task.detail.priority":"우선급","task.detail.priority.info":"우선급 선택","task.detail.redo":"다시 이 태스크를 작성하기","task.detail.remind":"알림","task.detail.repeat":"반복","task.detail.repeat.info":"반복 주기를 선택해 주세요.","task.detail.setting.remind":"%s 잠시 후 처리로 설정했습니다.","task.detail.stage":"태스크 단계","task.detail.stage.unset":"설치 안 함","task.detail.start.date":"시작 시간","task.detail.tasklist":"태스크 리스트","task.detail.time.click.set":"클릭하여 설정","task.dueDate.label":"%s 마감","task.group":"패킷","task.group2":"태스크 패킷","task.list.belong.to":"태스크%s에 속합니다","task.list.no.task":"이번주에 태스크가 없습니다.","task.menu.confirm.delete":"이 태스크를 삭제하시겠습니까?","task.menu.copy":"태스크 복사하기","task.menu.copy.check.link":"원 태스크가 새 태스크 알림 받기","task.menu.copy.check.linked":"새 태스크가 원 태스크 알림을 받기","task.menu.copy.fail":"태스크 복사 실패","task.menu.copy.success":"태스크가 복사되었습니다:","task.menu.copy.tips":"제목, 서브태스크, 노트도 복사될 예정입니다.","task.menu.delete.title":"태스크 삭제하기","task.menu.move":"태스크 옮기기","task.menu.move.fail":"태스크 옮기기 실패","task.menu.move.success":"태스크가 옮기게 되었습니다.","task.menu.move.tips":"프로젝트 간에 옯길 때 태스크 첨부 파일 또는 일부 참여자 정보는 잃게 될 것입니다.","task.menu.search.project":"프로잭트 검색하기","task.menu.select.group":"태스크 패킷 선택하기","task.menu.select.project":"프로젝트 선택하기","task.menu.select.stage":"단계 선택하기","task.menu.title":"태스크 메뉴","task.menu.warning":"请先选择项目分组和阶段","task.placeholder":"태스크가 없습니다","task.recent.placeholder":"아직 태스크와 일정이 없습니다","task.startDate.label":"%s 시작","task.viewl.authority.msg":"집행자%s 님께서 태스크의 완성 상태를 설정할 권한이 있습니다.","tasklist.bar.add.group":"태스크 패킷 추가","tasklist.bar.done.tasks":"완성된 태스크","tasklist.bar.member.tasks":"멤버의 태스크","tasklist.bar.memberOf.tasks":"%1의 태스크","tasklist.bar.pin":"태스크 패킷 바 고정시키기","tasklist.bar.search.group":"태스크 페킷 검색","tasklist.bar.smart.group":"스마트 패킷","tasklist.bar.today.tasks":"오늘의 태스크","tasklist.bar.total.tasks":"미완성 태스크","tasklist.bar.unassigned.tasks":"가져갈 수 있는 태스크","tasklist.bar.unpin":"태스크 패킷 바 고정 취소","tasklist.creator.new":"신규","tasklist.creator.submit":"만들기","tasklist.creator.tasklist.desc":"태스크 패킷 설명","tasklist.creator.tasklist.title":"태스크 패킷명","tasklist.creator.temp":"스텐실","tasklist.dump.confirm":"确定导出","tasklist.dump.hint":"选择需要导出的任务分组","tasklist.menu.add.templates":"태스크 패킷으로 보존하기","tasklist.menu.add.templates.desc":"(태스크 패킷 &gt; 추가 &gt; 스텐실)에 찾을 수 있습니다.","tasklist.menu.add.templates.detail":"해당 태스크 단계는 스텐실로 보존하기","tasklist.menu.add.templates.success":"%s 추가 성공","tasklist.menu.confirm.archive":"이 태스크 패킷을 아카이브하시겠습니까?","tasklist.menu.confirm.delete":"이 태스크 패킷을 영원히 삭제하시겠습니까?","tasklist.menu.delete.title":"태스크 패킷 삭제","tasklist.menu.edit.title":"태스크 패킷을 설정하기","tasklist.menu.last.cannot.edit":"죄송합니다만, 한 개 이상의 태스크를 유지해야 합니다.","tasklist.menu.tasklist.desc":"태스크 패킷 설명","tasklist.menu.tasklist.title":"태스크 패킷명","tasklist.menu.templates":"자기 정의 스텐실","tasklist.menu.title":"패킷 메뉴","tasklist.tab.status.done":"완성","tasklist.tab.status.normal":"최근 태스크","tasklist.tab.status.overdue":"만료","tasklist.tab.status.upcoming":"만료일 가까워짐","tasklist.temp1stage1":"기획","tasklist.temp1stage2":"프로토타입","tasklist.temp1stage3":"렌더링","tasklist.temp1stage4":"심사중","tasklist.temp1stage5":"완성됨","tasklist.temp1title":"디자인","tasklist.temp2stage1":"수요 포인트","tasklist.temp2stage2":"디자인 중","tasklist.temp2stage3":"개발 중","tasklist.temp2stage4":"테스트 중","tasklist.temp2stage5":"게시됨","tasklist.temp2title":"개발","tasklist.temp3stage1":"고객 질문","tasklist.temp3stage2":"해결 중","tasklist.temp3stage3":"해결됨","tasklist.temp3stage4":"피드백& 문제 해결","tasklist.temp3title":"고객 센터","tasks.no.task":"미션 배치 없음","team.belongsTo":"%s에 전속됨","team.create":"부서 생성","team.create.placeholder":"부서 명칭","team.create.sub":"서브 부서 생성","team.create.sub.placeholder":"서브 부서 명칭","team.create.success":"부서 생성 성공","team.detail":"부서 상세 정보","team.mananger.add":"부서 추가","team.mananger.quit":"탈퇴","team.mananger.remove":"제거","team.manger.events":"일정 배포","team.manger.no.member":"아직 가입한 멤버가 없습니다.","team.manger.no.project":"참여한 프로젝트가 없습니다.","team.manger.project.confirm.remove":"이 프로젝트를 삭제하시겠습니까?","team.manger.project.confirm.title":"팀 프로젝트 삭제","team.manger.tasks":"태스크 배포","team.member.add":"멤버를 부서에 추가함","team.member.menu":"부서 멤버 메뉴","team.member.remove":"부서에서 멤버 제거","team.member.remove.content":"부서에서 멤버 제거 후, 해당 멤버는 자동으로 해당 부서가 속한 프로젝트에서 탈퇴됨","team.member.search.placeholder":"검색 %s","team.member.subteam":"서브 부서의 멤버","team.member.team":"해당 부서의 멤버","team.members.count":"%s명 멤버","team.menu":"부서 메뉴","team.menu.confirm.delete":"이 팀을 영원히 삭제하시겠습니까?","team.menu.delete.title":"팀 삭제하기","team.menu.edit.title":"팀 이름 바꾸기","team.name":"%s부서를 아래 프로젝트에 가입함.","team.projects":"부서 프로젝트","team.projects.add":"프로젝트 추가","team.projects.add.search":"프로젝트 검색","team.projects.add.title":"팀을 프로젝트에 추가합니다","teambition.title":"Teambition · 간단하고 효율적인 프로젝트 협동 도구입니다","teams.split":", ","this.stage":"현재 단계","this.task":"이 태스크","time.format.error":"시간 격식 정확하지 않습니다","time.input.placeholder":"시간 입력하기","time.setting.error":"마감 시간과 시작 시간이 충돌됨","today.events":"오늘의 일정","token.expired":"만료돼서 다시","token.reauth":"다시 권한을 부여함","total.events.and.tasks":"총 %s개","unarchived.entry.success":"부기를 성공하게 아카이브 취소했습니다.","unarchived.event.success":"일정을 성공하게 아카이브 취소했습니다.","unarchived.file.success":"파일을 성공하게 아카이브 취소했습니다.","unarchived.folder.success":"폴더를 성공하게 아카이브 취소했습니다.","unarchived.post.success":"포스트를 성공하게 아카이브 취소했습니다.","unarchived.tag.success":"태그를 성공하게 아카이브 취소했습니다.","unarchived.task.success":"태스크를 성공하게 아카이브 취소했습니다.","unarchived.taskgroup.success":"태스크 패킷을 성공하게 아카이브 취소했습니다.","unarchived.tasklist.tip":"该项目已关闭任务分组功能，请开启任务分组功能后再进行取消归档操作。","update.file":"更新","uploader.error":"파일 업로드 실패","uploader.file.exceed":"文件超过最大限制","uploader.file.exceed.size":"파일 %s 허용 용량을 넘었습니다. 1GB 내의 파일을 선택해 주세요.","uploader.file.exceed.size.default":"文件 %s 过大，请选择 10M 以内的文件！","uploader.file.exceed.size.free":"文件 %s 过大，请选择 200M 以内的文件！升级后可支持1G大小。","uploader.files.duplicate":"업로드되었습니다.","uploader.files.exceed.number":"한꺼번에 50개 이내의 파일을 업로드할 수 있습니다.","uploader.not.accept":"이 파일 업도르활 수 없습니다. 다시 확인해 주세요.","uploader.type.no.allowed":"업도르활 수 없는 파일 유형입니다 (.%s). 압축한 후 다시 업로드해 주세요.","uploading.tip":"正在上传图片","user.satisfaction.bad":"完全不愿意","user.satisfaction.feedback.0":"感谢评价，你觉得 Teambition 在哪些地方不够好？","user.satisfaction.feedback.1":"感谢评价，你觉得 Teambition 还需要怎样改进？","user.satisfaction.feedback.2":"感谢评价，你最喜欢 Teambition 的哪些功能？","user.satisfaction.good":"非常愿意","user.satisfaction.placeholder":"写一些反馈...","user.satisfaction.recommend":"你有多大意愿向你的朋友推荐 Teambition?","user.satisfaction.send":"发送","user.settings.comment.notice":"코멘트 알림","user.settings.daily.mail.notice":"메일 작업 사항 메일 알림받기","user.settings.mobile":"이동클라이언트","user.settings.monthly.mail.notice":"월간 구독","user.settings.notification.setting":"알림 설치","user.settings.participant.notice":"참여자 알림이 설치되었습니다","user.settings.preference.usePanelTitle":"태스크판에서 태스크 상세정보를 열릴 때 옆매뉴 방식으로","user.settings.receive.event.notice":"『새로운 일정』알림을 받았습니다.","user.settings.receive.file.notice":"『새로운 파일』알림을 받았습니다.","user.settings.receive.post.notice":"『새로운 공유』알림을 받았습니다.","user.settings.receive.task.notice":"『새로운 태스크』알림을 받았습니다.","user.settings.setting":"선호 설정","user.settings.task.file.update.notice":"태스크, 파일 내용 실시간 알림","visible.close":"닫힘","visible.mode":"프라이버시 모드","visible.open":"이미 켰습니다.","visible.to.involve":"참여자만 방문 가능","visible.to.member":"멤버 방문 가능","wall.view.create.post":"포스트 추가하기","wall.view.html.post":"일반 문서","wall.view.markdown.post":"Markdown 문서","wall.view.post.creator.info":"%s게시됨","wall.view.post.order.create.time":"게시한 시간에 따라 순서를 배열하기","wall.view.post.order.reply.time":"답장한 시간에 따라 순서를 배열하기","wall.view.shimo.post":" Shimo문서","wall.view.shimo.update":"새로 고침 문서","wall.view.yiqixie.post":"같이 문서 쓰기","wall.yiqixie.default.title":"같이 문서 쓰기","week.selector.search":"날짜 검색하기","weibo.menu1":"내가 주목한 웨이보","weibo.menu2":"내가 게시한 웨이보","weibo.menu3":"@내 웨이보","weibo.menu4":"친밀권 웨이보","work.copy.message":"复制文件 %s 至","work.copy.success":"成功复制了文件","work.creator.info":"%s업로드됨","work.creator.tips":"파일 업로드 ","work.edit.title":"파일명","work.menu.archive.file":"归档文件","work.menu.confirm.delete":"이 파일을 영원히 삭제하시겠습니까?","work.menu.copy.file":"复制文件","work.menu.delete.title":"파일 삭제","work.menu.move.file":"移动文件","work.menu.title":"파일 메뉴","work.move.message":"파일을 이동하겠습니다","work.move.success":"成功移动了文件","work.move.title":"파일 옮기기","work.picker.from.dropbox":"Dropbox에서 선택하기","work.picker.from.library":"파일에서 선택하기","work.picker.from.link":"다운로드 링크를 붙이기...","work.picker.title":"첨부 파일 추가하기","work.picker.uploader":"업로드하기","work.rename.title":"리네임","work.versions.current":"현재 버전","work.versions.enter.edit":"버전 설명 편집하기","work.versions.title":"모든 버전","works.background.uploader.close.confirm":"파일이 업로드 중입니다. 취소하시겠습니까?","works.background.uploader.close.confirm.title":"승인","works.background.uploader.error":"업로드 실패","works.background.uploader.uploaded":"업로드 성공","works.background.uploader.uploading":"업로드 중 %s/%s","works.uploader.uploading.total":"%s개의 파일 업로드 중..."}),t.exports=n},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y;y=i(678),v=i(679),c=i(429),n=i(351),g=i(358),a=i(439),c=i(429),l=i(442),f=i(467),d=i(447),o=i(401),s=i(680),r=n(document),p=/^\+?(?:[0-9] ?\-?){6,14}[0-9]$/,h=/^(?:\w+:)?\/\/([^\s\.]+\.\S{2})\S*$/,u=/^https?:\/\/(www.teambition.com|project.ci)/,t.exports=m={formatDate:function(t,e){var i,n,r,o,s,a;return i=c(new Date(t)),i.isValid()?(e&&"en"===tb_i18n.getLanguage()?(a=c().startOf("week"),o=i.unix()<a.unix()?"[Last] ":"",s=i.unix()-a.unix()>=604800?"[Next] ":"",r=i.calendar(null,{lastWeek:o+" ddd",nextWeek:s+" ddd"})):r=i.calendar(),t={dateString:r,dateTimeString:r+" "+i.format("HH:mm"),dateFormatString:i.format("YYYY/MM/DD"),timeFormatString:i.format("HH:mm"),dateClass:"normal"},n=c(),n.startOf("day").isAfter(i)?t.dateClass="overdue":n.endOf("day").isAfter(i)?t.dateClass="today":n.add(7,"days").endOf("day").isAfter(i)&&(t.dateClass="upcoming"),t):{dateString:tb_i18n.get("unknownDate")}},_formatDateTimeString:function(t,e){var i;return i=t.toString(),t<=0?"00":t>e?parseInt(i.slice(-2))<=e?i.slice(-2):"0"+i.slice(-1):0<t&&t<10?"0"+i:i},formatMonthString:function(t){return t+=1,this._formatDateTimeString(t,12)},formatDateString:function(t){return this._formatDateTimeString(t,31)},formatHourString:function(t){return this._formatDateTimeString(t,23)},formatMinuteString:function(t){return this._formatDateTimeString(t,59)},isSameDate:function(t,e){return c(t).isSame(e)},getPriorityDisplay:function(t){var e;return e={0:tb_i18n.get("priority.none"),1:tb_i18n.get("priority.high"),2:tb_i18n.get("priority.urgent")},e[t||0]},removeItem:function(t,e){var i,n,r,o;if(r=0,g.isArray(t))for(i=n=t.length-1;n>=0;i=n+=-1)o=t[i],o===e&&(t.splice(i,1),r+=1);else g.each(t,function(i,n){if(i===e)return delete t[n],r+=1});return r},formatFileSize:function(t){var e,i;if("string"==typeof t&&(t.indexOf("K")!==-1||t.indexOf("M")!==-1))return t;for(i=-1,t/=1024,i++;t>999;)t/=1024,i++;return e=~~(i>0),Math.max(t,.1).toFixed(e)+" "+["KB","MB","GB","TB","PB","EB"][i]},formatPhone:function(t){return"+"!==t.charAt(0)&&(t="+86-"+t),t},memberFilter:function(t,e){var i,n,r,o;return e?(n=function(t){var i,n;return null==t&&(t=""),i=t.toLowerCase().indexOf(e),n=i===-1?0:t.toLowerCase()===e?1e3:900-i},i=function(t){return Math.max(n(t.name),n(t.pinyin),n(t.py))},r=function(t){return i(t)},o=function(t,e){return i(e)-i(t)},t.filter(r).sort(o)):t},isEmail:function(t){return f.isEmail(t)},isPhone:function(t){return l(t).length},isPhoneNum:function(t){return p.test(t)},isId:function(t){return!(!g.isString(t)||!/^[a-zA-Z0-9]{24}$/.test(t))},isUrl:function(t){return h.test(t)},objectId2Num:function(t,e){var i;return i=parseInt(t.slice(0,8),16),i%e},lengthOf:function(t){var e,i;return e=0,"string"==typeof t&&(i=t.replace(/[\u4e00-\u9fa5]/g,function(){return e+=2,""}),e+=i.length),e},escape:function(t){return t=null!=t?""+t:"",/<|\>|\"|\'/.test(t)&&(t=g.escape(t)),t},cutString:function(t,e,i){var n,r,o,s;if("string"!=typeof t)return"";if(this.lengthOf(t)<=e)return t;for(o=0,r=0,s="";r<e;)n=t.charAt(o),/[\u4e00-\u9fa5]/.test(n)?r+=2:r++,s+=n,o++;return s+=i},loadImage:function(t,e){var i;return i=new window.Image,i.onload=function(){return i.onload=null,e(null,i.naturalWidth||i.width,i.naturalHeight||i.height,t)},i.onerror=function(t){return e(t)},i.abort=function(){return i.onload=null,i.onerror=null},i.src=t,i},loadVideo:function(t,e){var i;return i=document.createElement("video"),i.controls="controls",i.preload=!0,n(i).on("loadedmetadata",function(){return e(null,i.videoWidth,i.videoHeight,t)}).on("error",function(t){return e(t)}).on("abort",function(){return n(i).off()}).html("<source src='"+t+"'></source>"+tb_i18n.get("html5video.not.support")),i},loadAudio:function(t,e){var i;return i=document.createElement("audio"),i.controls="controls",i.preload=!0,n(i).on("loadedmetadata",function(){return n(i).off(),e(null,t)}).on("error",function(t){return e(t)}).on("abort",function(){return n(i).off()}).html("<source src='"+t+"'></source>"+tb_i18n.get("html5audio.not.support")),i},parseJSON:function(t){var e,i;try{return JSON.parse(t)}catch(i){e=i,"undefined"!=typeof console&&null!==console&&console.error(e)}return null},parsePost:function(t){var e,i;return g.isObject(t)?(t.html&&"html"===t.postMode&&(t.content=t.html),delete t.html,t.description=t.title,t.description||(i=g.unescape(t.content),"html"!==t.postMode&&(i=a(i)),e=n("<div>"+i+"</div>"),i=e.text().trim(),i||(e=e.find("img:first"),i=e.attr("alt")||e.attr("title")||e.attr("src")),
t.description=this.cutString(i,60,"...")||tb_i18n.get("post.un.title")),t):{}},mousewheel:function(t,e){var i;if(i=t.currentTarget,!(i.scrollHeight<=i.clientHeight))return t.stopPropagation(),!(e>0&&i.scrollTop<2)&&(!(e<0&&i.scrollHeight-i.clientHeight-i.scrollTop<2)&&void 0)},getPriorities:function(){var t;return t=[{_id:0,title:tb_i18n.get("priority.none")},{_id:1,title:tb_i18n.get("priority.high")},{_id:2,title:tb_i18n.get("priority.urgent")}]},message:function(t){var e;if(t)return g.isString(t)&&(t={message:t}),e="<span class='essage-tips'>"+t.tips+"</span><a class='essage-url url-handler' href='"+t.url+"'>"+t.title+"</a>",o.show({message:t.message||e,status:t.status||"success",duration:t.duration||5e3})},matchString:function(t,e){var i,n,r,o,s;for(null==t&&(t=""),null==e&&(e=""),s=!1,o=e.trim().split(/\s/g),n=0,r=o.length;n<r;n++)if(i=o[n],i&&t.indexOf(i)>=0){s=!0;break}return s},distanceString:function(t,e){var i,n,r,o,s,a,c,l,p,u,d,h,m,f;for(i=t.length+1,n=e.length+1,m=[],f=0,r=s=0,p=i;0<=p?s<=p:s>=p;r=0<=p?++s:--s)m[r]=[r];for(r=a=0,u=n;0<=u?a<=u:a>=u;r=0<=u?++a:--a)m[0][r]=r;for(r=c=1,d=i;1<=d?c<=d:c>=d;r=1<=d?++c:--c)for(o=l=1,h=n;1<=h?l<=h:l>=h;o=1<=h?++l:--l)f=t[r-1]===e[o-1]?0:1,m[r][o]=Math.min(m[r-1][o]+1,m[r][o-1]+1,m[r-1][o-1]+f);return m[r-1][o-1]},unifyNewline:function(t){return null==t&&(t=""),"string"!=typeof t?"":t.replace(/(\r\n|\r)/gm,"\n")},isIE:function(){return n("body").hasClass("ie")},compareTask:function(t,e){var i,n;return null==t&&(t={}),null==e&&(e={}),i=t.priority||0,n=e.priority||0,n-i?n-i:(i=new Date(t.dueDate||null).valueOf()||Number.MAX_VALUE,n=new Date(e.dueDate||null).valueOf()||Number.MAX_VALUE,i-n?i-n:(i=new Date(t.startDate||null).valueOf()||Number.MAX_VALUE,n=new Date(e.startDate||null).valueOf()||Number.MAX_VALUE,i-n?i-n:(i=new Date(t.created||null).valueOf()||Number.MAX_VALUE,n=new Date(e.created||null).valueOf()||Number.MAX_VALUE,i-n)))},isAllDayEvent:function(t){var e,i,n,r,o,s,a,c;for(s=[new Date(t.startDate),new Date(t.endDate)],i=0,r=s.length;i<r;i++)for(e=s[i],a=[e.getHours(),e.getMinutes(),e.getSeconds()],n=0,o=a.length;n<o;n++)if(c=a[n],0!==c)return!1;return!0},parseEventDateString:function(t){var e,i,n,r;return t.isAllDay?(t.startDateString=""+m.formatDate(t.startDate).dateString+tb_i18n.get("event.all.day.tips"),e=c(t.endDate).subtract(1,"day"),i=""+m.formatDate(e).dateString+tb_i18n.get("event.all.day.tips"),t.startDateString!==i&&(t.endDateString=i)):(r=m.formatDate(new Date).dateString,n=m.formatDate(new Date(t.startDate)).dateString,n===r?t.startDateString=c(t.startDate).format("LT"):t.startDateString=n+" "+c(t.startDate).format("LT"),t.endDate&&(i=m.formatDate(t.endDate).dateString,i===r?t.endDateString=c(t.endDate).format("LT"):t.endDateString=i+" "+c(t.endDate).format("LT"))),t},getHoliday:function(){var t,e,i,n,r,o,s,a;for(n=[{name:"olympic",start:"2016.06.23",end:"2016.06.23"},{name:"european-cup",start:"2016.06.28",end:"2016.07.11"},{name:"rio-olympic",start:"2016.08.06",end:"2016.08.08"},{name:"chinese-valentines",start:"2016.08.09",end:"2016.08.09"}],t=function(){switch(y.env){case"ga":return 3;case"development":return 14;default:return 2}}(),s=c(),r=0,o=n.length;r<o;r++)if(i=n[r],a=c(i.start,"YYYY.MM.DD").subtract(t,"days"),e=c(i.end,"YYYY.MM.DD").endOf("day"),s.isAfter(a)&&s.isBefore(e))return i.name;return null},isPublicReg:g.once(function(){return u.test(window.location.href)}),getMemberPermissions:function(t,e){var i,n,r,o,s,a;return e=null!=e.toJSON?e.toJSON():e,a=t.hasPermissions("put.member","del.member"),i=a.delMember,s=a.putMember,o=t.getRoleScope(),r=e._id===y.user.id,n="string"==typeof e._roleId?o>=1:o>=1&&o>=e._roleId,{canManageMemberRole:s&&n&&!r,canDeleteMember:i&&n}},getStrikerDownloadConfig:function(){var t;return t=y.user.get("strikerAuth")||"",v.FILE_HOST+"/archive?Signature="+t.split(" ")[1]},getFilesDownloadInfo:function(t,e,i){var n,r,a,c,l,p;return null==i&&(i={}),a=i.collectionIds||[],p=i.workIds||[],n="_collectionIds="+a.join("&_collectionIds="),r="&_workIds="+p.join("&_workIds="),l="projects/"+t+"/download-info?"+n+r,c={zipName:e},i=g.extend({silentError:!0,error:function(t){return o.error({message:tb_i18n.get("download.failed"),hint:t.message})}},i),s.get(l,c,i)}}},function(t,e,i){var n;n=i(679),t.exports={name:"teambition",env:n.env,version:n.version,config:n,language:n.language}},function(t,e){var i,n;n=document.getElementById("teambition-config"),n.parentNode.removeChild(n),i=n.textContent.trim()||"{}",t.exports=JSON.parse(i)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m;n=i(351),p=i(358),u=i(679),r=i(357),a=i(407),l=i(530),c=i(677),s=i(401),o=1e3*p.random(5,10),d=o,h=!0,m=!1,t.exports=p.extend({},r.Events,{initialize:function(){return n(window).on("offline",function(){return s.show({message:tb_i18n.get("disconnected"),status:"error",duration:-1})}).on("online",function(){return s.hide()}),this.on("reconnected",function(){return h||s.show({message:tb_i18n.get("connected"),status:"success"}),d=o,h=!0}),this.on("disconnect",function(){return h&&s.show({message:tb_i18n.get("disconnected"),status:"error",duration:-1}),d=o,h=!1})},wrapSuccess:function(t){return function(e){return function(i){return h||e.trigger("reconnected"),"function"==typeof t?t(i):void 0}}(this)},wrapError:function(t,e){return function(i){var n;return n={message:"",code:"",status:i.status},i.responseJSON?n=p.extend(n,i.responseJSON):p.isObject(i)?(n.message=i.message||i.statusText||n.message||"",n.code=i.code||i.status||1,n.stack=n.stack):n.message=i,console.error(n),e||(306===n.code?c.message({tips:tb_i18n.get("token.expired"),url:u.ACCOUNT_HOST+"/login?next_url="+encodeURIComponent(window.location.href),title:tb_i18n.get("login"),status:"error",duration:-1}):s.show({message:n.message||tb_i18n.get("error"),status:"error"})),"function"==typeof t?t(n):void 0}},wrapForExpireCache:function(t){var e,i,n,r,o,s,c;return r=t.expireCache,e=t.beforeSend||p.noop,c=t.success||p.noop,n=t.url.replace(/_=\d+/,"_="),o=a,r.namespace&&(o=o.namespace(r.namespace,r.expire)),i=o(n),s=null!=i?p.noop:p.partial(o,n),t.beforeSend=function(){if(e.apply(this,arguments),i)return c(i),!1},t.success=function(t){return s(t),c(t)},i},ajax:function(t,e){var i,n,o;return p.isString(t)?e.url||(e.url=u.API_HOST+"/"+t):e=t,i=p.defaults(e,{type:"GET",dataType:"json"}),i.url.indexOf(u.API_HOST+"/")>=0&&(i.xhrFields={withCredentials:!0}),i.success=this.wrapSuccess(e.success),i.error=this.wrapError(e.error,e.silentError),"GET"===i.type&&i.expireCache&&(n=this.wrapForExpireCache(i)),o=i.success||p.noop,i.success=function(t){return t&&t.code?i.error(t):o(t)},new Promise(function(t,o){var s;return s=r.ajax(i),0===s.status&&e.expireCache?t(n):s.then(t,o)})},get:function(t,e,i){return arguments.length<=2?i=e||{}:3===arguments.length&&(i.data=e),i.type="GET",this.ajax(t,i)},put:function(t,e,i){return i||(i={}),i.type="PUT",i.data=e,this.ajax(t,i)},post:function(t,e,i){return i||(i={}),i.type="POST",i.data=e||{},this.ajax(t,i)},del:function(t,e,i){return i||(i={}),i.type="DELETE",i.data=e||{},this.ajax(t,i)}})},function(t,e,i){var n,r,o;n=i(679),o=i(454),t.exports=o.namespace((null!=(r=n.user)?r._id:void 0)||"ghost")},function(t,e,i){var n,r,o,s,a,c;o=i(351),a=i(438),c=i(678),n=1e3,o.ajaxPrefilter(function(t,e,i){var n;return n=Date.now(),i.always(function(){return a.log({"class":"ajax",url:t.url.replace(/(\?|&)_=\d+/,""),type:t.type,status:i.status,time:Date.now()-n})})}),s=a._request,a._request=function(t){var e,i,r;if((t.time>n||"ERROR"===t.LOG_TYPE)&&s(t),t.time>10&&"INFO"===t.LOG_TYPE&&(e=window._ga))return r=t.url||t.name||t.fileKey||t.file,e("send","timing",t["class"],r,t.time,(null!=(i=c.user)?i.id:void 0)||"unknown")},a.reportInitTime=function(){var t,e,i;return i=a.timing,e=Date.now(),t={"class":"init",name:"teambition",dns:i.domainLookupEnd-i.domainLookupStart||0,con:i.connectEnd-i.connectStart||0,time:e-(i.fetchStart||e)},a.log(t),a.reportInitTime=function(){}},r=/google-analytics\.com|piwik\.teambition|logs\.teambition|baidu\.com|segment\.com/,a.reportStaticsLoadTime=function(){return a.getEntries().map(function(t){if(!r.test(t.name))return a.log({"class":"static",name:t.name.replace(/^https?:\/\//,""),type:t.initiatorType,time:t.duration})}),a.reportStaticsLoadTime=function(){}},t.exports=a},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h=function(t,e){function i(){this.constructor=t}for(var n in e)m.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},m={}.hasOwnProperty,f=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};p=i(358),d=i(678),u=i(679),n=i(357),o=i(684),a=i(696),l=i(681),s=i(783).PLUGIN_URL,r={wall:"posts",board:"tasks",library:"works"},t.exports=c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.routes={"projects(/*paramString)":"enterPortal","project/:_projectId":"enterProject","project/:_projectId/:appName(/*paramString)":"enterProject","organization/:_organizationId(/*paramString)":"enterOrganization","*paramString":"home"},e.prototype.start=function(){return n.history.start({pushState:!0}),this},e.prototype.home=function(){return this.navigate("projects",{trigger:!0})},e.prototype.enterPortal=function(t){var e,i,n;return d._global={},n=d.user.toJSON(),n.isGhost&&this.gotoLogin(),i=this.splitParamString(t),this.paramString=i.paramString,e={params:this.analyzeParams(i.paramString),attrs:this.analyzeParams(i.paramString),routeString:i.routeString},this.doGtaBeforeEnter("/projects","portal"),d.APP.enterPortal(e),this},e.prototype.enterProject=function(t,e,i){var n,o;return d._global={_projectId:t},o=this.splitParamString(i),this.paramString=o.paramString,n=e,e=r[e]||e,a.fetchOne(0,t,{success:function(i){return function(r){var a,c,l;return a=r.get("applications"),e&&f.call(p.pluck(a,"name").concat(s),e)>=0||(e=r.getFirstApp()),n!==e&&(l=d.router.getUrl().replace("/"+n,""),l+="/"+e,d.router.navigate(l,{trigger:!1})),c={_projectId:t,projectModel:r,routeString:o.routeString,params:i.analyzeParams(o.paramString),attrs:i.analyzeParams(o.paramString)},i.doGtaBeforeEnter("/project/"+t+"/"+e,e),d.APP.enterProject(r,e,c)}}(this),error:function(t){return function(){return t.home()}}(this)})},e.prototype.enterOrganization=function(t,e){var i;return d._global={_organizationId:t},i=this.splitParamString(e),this.paramString=i.paramString,o.fetchOne(0,t,{success:function(e){return function(n){var r;return r={organizationModel:n,_organizationId:t,params:e.analyzeParams(i.paramString),attrs:e.analyzeParams(i.paramString),routeString:i.routeString},d.APP.enterOrganization(n,r)}}(this),error:function(t){return function(){return t.home()}}(this)}),this},e.prototype.gotoTeambition=function(){return window.location=u.HOST,this},e.prototype.gotoLogin=function(){var t;return l.clear(),t=encodeURIComponent(window.location.href),window.location=u.ACCOUNT_HOST+"/login?next_url="+t,this},e.prototype.gotoRegister=function(){var t;return t=encodeURIComponent(window.location.href),window.location=u.ACCOUNT_HOST+"/signup?next_url="+t,this},e.prototype.doGtaBeforeEnter=function(t,e){return d.gta.pageview({page:t,title:e})},e.prototype.splitParamString=function(t){var e,i;return e={routeString:"",paramString:""},t?(~t.indexOf("?")?(i=t.split("?"),e.routeString=i[0],e.paramString=i[1]):~t.indexOf("=")?(e.routeString="",e.paramString=t):(e.routeString=t,e.paramString=""),e):e},e.prototype.analyzeParams=function(t){var e,i,n,r,o,s;if(!t)return{};for(r={},e=t.split(","),i=0,n=e.length;i<n;i++)s=e[i],~s.indexOf("=")&&(o=s.split("="),r[o[0]]=o[1]);return r},e.prototype.routeToHandler=function(t){var e,i,n,r,o,s;e=function(t,e,i,n){return function(r){var o;return o=n._extractParameters(i,r),e[t].apply(e,o)}},s=t.routes,t.handlers=[],n=[];for(o in s)i=s[o],r=this._routeToRegExp(o),n.push(t.handlers.push({routeString:o,route:r,callback:e(i,t,r,this)}));return n},e.prototype.checkRoute=function(t,e){var i,n,r,o,s;for(null!=(o=d.APP)&&o.dynamicTitle(),this.routeToHandler(e),s=e.handlers,n=0,r=s.length;n<r;n++)if(i=s[n],i.route.test(t))return i.callback(t)},e.prototype.getUrl=function(){return n.history.getFragment()},e.prototype.loadUrl=function(t){return n.history.loadUrl(t)},e.prototype.getPrefix=function(){var t,e,i;switch(e="",i=this.getUrl(),t=i.split("/"),t[0]){case"organizations":e="organizations";break;case"projects":e="projects";break;case"organization":e=t.slice(0,2).join("/");break;case"project":e=t.slice(0,2).join("/")}return e},e}(n.Router)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(358),n=i(685),o=i(687),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.name="organizations",e.prototype.model=o,e.prototype.comparator=function(t){return t.get("name")},e.prototype.getOrganizationsByRight=function(t){return this.where({_roleId:t})},e.prototype.getOrganizationsByIds=function(t){var e;return e=[],s.each(t,function(t){return function(i){var n;if(n=t.find(function(t){return t.id===i}))return e.push(n.toJSON())}}(this)),e},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;c=i(358),p=i(678),l=i(679),n=i(357),o=i(680),s=i(686),a=i(530),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.synced=!1,e.prototype.listened=!1,e.prototype.orderBy="latest-created",e.prototype.initialize=function(t,e){if(this.pageIndex=0,this._boundToObjectId=(null!=e?e._boundToObjectId:void 0)||0,null!=(null!=e?e.boundToObjectType:void 0)&&(this.boundToObjectType=e.boundToObjectType),"activities"===this.name)return this.listen()},e.prototype.add=function(t,i){return i||(i={}),i.merge=!0,e.__super__.add.apply(this,arguments)},e.prototype.set=function(t,i){return i||(i={}),i.parse=!0,i.merge=!0,e.__super__.set.apply(this,arguments)},e.prototype.sync=function(t,i,n){var r,s,a,u;switch(n.url||(n.url=this.name),n.xhrFields={withCredentials:!0},n.success=o.wrapSuccess(n.success),n.error=o.wrapError(n.error,n.silentError),u=n.success||function(){},t){case"read":a=n.attrs||("function"==typeof this.getParams?this.getParams(t,n):void 0)||{},this.pageNum&&!a.all&&(a.noPagination||(a.count=this.pageNum,a.page=++this.pageIndex)),!n.skipBoundToObjectType&&this.boundToObjectType&&(a[s="_"+this.boundToObjectType+"Id"]||(a[s]=a._boundToObjectId||this._boundToObjectId)),p.user.get("isGhost")&&(a=c.extend(a,p._global)),n.data=a,r=function(t){return function(e){return t.synced=!0,t.pageNum&&(t.hasMore=t.checkHasMore(e)),u(e),t.listen()}}(this);break;case"one":n.type="GET",n.processData=!0,n.url+="/"+n._modelId,r=function(t){return function(e){return t.update(e),u(t.get(e._id))}}(this)}return n.url=l.API_HOST+"/"+n.url,null==n.cache&&(n.cache=!1),n.success=function(t){return(null!=t?t.code:void 0)?n.error(t):(r||u)(t)},e.__super__.sync.apply(this,arguments)},e.prototype.listen=function(){var t;if(!this.listened)return this.listened=!0,t=this.name,this._boundToObjectId&&(t+="/"+this._boundToObjectId),"projects"!==this.name&&this.on("change:isArchived",function(t){return function(e,i){if(i)return t.remove(e)}}(this)),s.on(":new:"+t,function(t){return function(e){return t.add(e)}}(this)),s.on(":change:"+t,function(t){return function(e){return t.set(e)}}(this)),s.on(":refresh:"+t,function(t){return function(e){var i;return e?(i=t.model.get(e),"members"===t.name&&i.set({_memberId:e}),i.fetch({success:function(e){return t.add(e)}})):t.refresh?t.refresh():t.fetch()}}(this)),s.on(":remove:"+t,function(t){return function(e){return t.remove(e)}}(this)),s.on(":remove:"+this.name,function(t){return function(e){return t.remove(e)}}(this)),s.on(":quit:"+this.name,function(t){return function(e){return t.remove(e)}}(this)),this},e.prototype.last=function(){return 0===this.length?{}:this.at(this.length-1)},e.prototype.comparator=function(t){var e;switch(this.orderBy){case"latest-created":return-new Date(t.get("created")||0).getTime();case"earliest-created":return new Date(t.get("created")||0).getTime();case"latest-updated":return-new Date(t.get("updated")||0).getTime();case"earliest-updated":return new Date(t.get("updated")||0).getTime()}if(this.orderBy)return e=t.get(this.orderBy),(null!=e&&"function"==typeof e.toLowerCase?e.toLowerCase():void 0)||e},e.prototype.updateSort=function(t,e){var i;return t&&t.length?(i=function(i){return t.indexOf(i)+1||(e?0:9999)},this.models.sort(function(t,e){return i(t.id)-i(e.id)}),this):this},e.prototype.update=function(t,e){return e||(e={}),e.remove=!1,this.set(t,e)},e.prototype.checkHasMore=function(t){var e,i;return e=null!=(null!=(i=t.results)?i.length:void 0)?t.results.length:t.length,e>0},e.prototype.loadMore=function(t){var e;if(this.hasMore)return t||(t={}),t.remove=!1,e=t.error||function(){},t.error=function(t){return function(){return e.apply(t,arguments)}}(this),this.fetch(t)},e.prototype.fetchOne=function(t,e){return e||(e={}),e._modelId=t,this.sync("one",this,e)},e.prototype.resetSoft=function(){return this.pageIndex=0,this.synced=!1,this.hasMore=!1},e.prototype.reset=function(){return this.resetSoft(),e.__super__.reset.apply(this,arguments)},e}(n.Collection),t.exports=a.bindToCollection(r)},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;s=i(358),l=i(678),n=i(357),r=i(453),a=i(680),c=[],o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.onopen=function(){if("development"===l.env)return console.info("--- WebSocket Opened ---")},e.prototype.onmessage=function(t){var e,i,n,r,o;if("request"!==t.type)return this.onerror(new Error("It is not a request: "+JSON.stringify(t.data)));for(o=[];t.data.params.length;)try{e=JSON.parse(t.data.params.shift()),"ga"!==(r=l.env)&&"development"!==r||this.pushMessage(e),e&&"string"==typeof e.e?o.push(this.trigger(e.e,e.d)):o.push(this.onerror(new Error("Unprocessable entity: "+JSON.stringify(e))))}catch(n){i=n,o.push(this.onerror(i))}return o},e.prototype.pushMessage=function(t){if(c.unshift(t),c.length>1e3)return c.pop()},e.prototype.getMessage=function(t){return null==t&&(t=0),t?c.slice(0,t):c.slice(0)},e.prototype.getToken=function(){return l.user.checkSnapperToken(),l.user.get("snapperToken")},e.prototype._join=function(t,e){return l.consumerId=e,a.post(t+"/subscribe",{consumerId:e})},e}(r),s.extend(o.prototype,n.Events),t.exports=new o},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;l=i(358),r=i(688),c=i(677),a=i(686),s=i(689),n=[i(690),i(691),i(692),i(693),i(694),i(695)],t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.name="organization",e.prototype.urlRoot="organizations",e.prototype.backgrounds=["bg-01","bg-02","bg-03","bg-04","bg-05"],e.prototype.defaults={objectType:"organization",teamsCount:0,membersCount:0,projectsCount:0,plan:{days:999},_roleId:-2,dividers:[],projectIds:[]},e.prototype.parse=function(t){return t=l.extend(this.toJSON(),t),c.isUrl(t.logo)||(t.logo=this.getLogo(t._id)),t},e.prototype.getLogo=function(t){var e;return e=c.objectId2Num(t,6),n[e]||n[0]},e.prototype.sync=function(t,i,n){var r;switch(r=n.success,t){case"create":n.success=function(t){return t.isNew=!0,"function"==typeof r?r(t):void 0}}return e.__super__.sync.apply(this,arguments)},e.prototype.getBackground=function(){var t;return t=this.get("background")||this.backgrounds[0],{url:t,isDefault:this.backgrounds.indexOf(t)>-1}},e.prototype.getAllBackgrounds=function(){var t,e;return t=this.get("background")||this.backgrounds[0],e=this.backgrounds.map(function(t){return{url:t,isDefault:!0}}),this.backgrounds.indexOf(t)===-1&&e.push({url:t,isDefault:!1}),e},e.prototype.getRecommendMembers=function(t){return t.url=this.url()+"/recommendMembers",t.expireCache={namespace:"organization_"+this.id+"_recommend_members",expire:300},this.sync("read",this,t),this},e.prototype.getStatistic=function(t){return t||(t={}),t.url=this.url()+"/statistic",t.expireCache={namespace:"organization_members",expire:300},this.sync("read",this,t),this},e.prototype.getTeamsStatistic=function(t){return t||(t={}),t.url=this.url()+"/statistic",t.expireCache={namespace:"organization_teams",expire:300},t.attrs||(t.attrs={}),t.attrs.base="team",this.sync("read",this,t),this},e.prototype.getProjectsStatistic=function(t){return t||(t={}),t.url=this.url()+"/statistic",t.expireCache={namespace:"organization_projects",expire:300},t.attrs||(t.attrs={}),t.attrs.base="project",this.sync("read",this,t),this},e.prototype.fetchChartsData=function(t){return t.url=this.url()+"/dataforchart/",this.sync("read",this,t),this},e.prototype.fetchMembersData=function(t,e){return e.attrs=l.extend({type:"delay",team:"all",page:1,count:30},t),e.url=this.url()+"/statisticformembers",this.sync("read",this,e),this},e.prototype.fetchMembers=function(t){return t.url=this.url()+"/members",t.attrs={fields:"_id,name,pinyin,py,avatarUrl"},this.sync("read",this,t),this},e.prototype.fetchMember=function(t,e){return e.url=this.url()+"/statisticformembers/"+t,this.sync("read",this,e),this},e.prototype.fetchProjectsData=function(t,e){return e.attrs=l.extend({type:"delay",index:-1,page:1,count:30},t),e.url=this.url()+"/statisticforprojects",this.sync("read",this,e),this},e.prototype.fetchProjects=function(t){return t.attrs||(t.attrs={}),t.attrs.all=1,t.url=this.url()+"/projects",this.sync("read",this,t),this},e.prototype.fetchProject=function(t,e){return e.url=this.url()+"/statisticforprojects/"+t,this.sync("read",this,e),this},e.prototype.fetchGroupsData=function(t){return t.url=this.url()+"/teams/",this.sync("read",this,t),this},e.prototype.isOverdue=function(){return this.getPaymentPlan().isOverdue},e.prototype.isExpiring=function(){return this.getPaymentPlan().isExpiring},e.prototype.getPaymentPlan=function(){return s.organizationPaymentPlan(this.get("plan"))},e.prototype.joinRoom=function(){if(!this.subscribed&&this.get("_roleId")>-1)return a.join(this.url()),this.subscribed=!0},e.prototype.quit=function(t){return t||(t={}),t.url=this.url()+"/quit",t.attrs={},this.sync("update",this,t),this},e.prototype.saveSection=function(t,e,i){return i||(i={}),i.url=this.url()+"/"+t,i.attrs={},i.attrs[t]=e,this.sync("update",this,i),this},e.prototype.transfer=function(t,e){var i;return null==e&&(e={}),e.url=this.url()+"/transfer",e.attrs={_id:this.id,_toUserId:t},i=e.success,e.success=function(t){return function(){return t.fetch(),"function"==typeof i?i():void 0}}(this),"function"==typeof e.beforeSend&&e.beforeSend(),this.sync("update",this,e),this},e}(r)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty,m=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};l=i(358),u=i(678),p=i(679),n=i(357),o=i(680),s=i(686),c=i(530),a=i(681),r=function(t){function e(t,i){null==i&&(i={}),i.parse=!0,e.__super__.constructor.call(this,t,i)}return d(e,t),e.prototype.idAttribute="_id",e.prototype.listened=!1,e.prototype.initialize=function(t,e){var i;return(null!=e?e.bindByMatrix:void 0)!==!1&&this.listen(),i=("_id"===this.idAttribute||"_cid"===this.idAttribute)&&(null!=e?e.bindByMatrix:void 0)!==!1,null!=this.id&&i?c.bindByMatrix(this):i&&this.on("change:"+this.idAttribute,function(t){return c.bindByMatrix(t)}),this.initSubscribe(),this},e.prototype.sync=function(t,i,n){var r;switch(n.url||(n.url=this.url()),n.url=p.API_HOST+"/"+n.url,n.xhrFields={withCredentials:!0},n.success=o.wrapSuccess(n.success),n.error=o.wrapError(n.error,n.silentError),n.expireCache&&"read"===t&&o.wrapForExpireCache(n),r=n.success||function(){},null==n.cache&&(n.cache=!1),n.success=function(t){return function(e){return(null!=e?e.code:void 0)?n.error(e):(r(e),t.listen())}}(this),t){case"read":n.attrs&&(n.data=n.attrs),u.user.get("isGhost")&&(n.data=l.extend(n.data||{},u._global));break;case"delete":n.attrs&&(n.url=n.url+"?"+$.param(n.attrs))}return e.__super__.sync.apply(this,arguments)},e.prototype.saveAttr=function(t,e,i){var n;return i||(i={}),i.url=this.url()+"/"+t,i.attrs||(i.attrs={}),null!=e&&(i.attrs[t]=e),n=i.success||function(){},i.success=function(t){return function(e){return t.set(e),n(t)}}(this),i.wait||this.set(i.attrs),this.sync("update",this,i)},e.prototype.clone=function(t){return null==t&&(t=!1),new this.constructor(this.attributes,{bindByMatrix:t})},e.prototype.destroyWithoutSync=function(t){var e;return null==t&&(t={}),e=this,e.stopListening(),e.trigger("destroy",e,e.collection,t)},e.prototype.listen=function(){if(!this.listened&&this.id)return this.listened=!0,this._socketHandle=function(t){return function(e){return t.set(t.parse(e))}}(this),s.on(":change:"+this.name+"/"+this.id,this._socketHandle),s.on(":destroy:"+this.name+"/"+this.id,this.destroyWithoutSync.bind(this)),this},e.prototype.reset=function(t,e){var i,n;e||(e={}),e.silent||this.trigger("reset",this,e),this.listened=!1,this._socketHandle&&s.off(":change:"+this.name+"/"+this.id,this._socketHandle),this.stopListening(),this.off(),i=this.collection,i&&m.call(i.models,this)>=0&&i.remove(this);for(n in this.attributes)n!==this.idAttribute&&delete this.attributes[n];return e.parse&&(t=this.parse(t,e)),t=l.defaults({},t,l.result(this,"defaults")),this.set(t,e),this.initialize(t,e),null!=i&&i.add(this),this},e.prototype.archive=function(t){var e;return t||(t={}),t.url=this.url()+"/archive",t.attrs={},e=t.success||function(){},t.success=function(t){return function(i){var n;return null!=(n=t.collection)&&n.remove(t),t.set(i),e(t)}}(this),this.sync("create",this,t),this},e.prototype.unarchive=function(t){var e;return t||(t={}),t.url=this.url()+"/archive",t.attrs={},e=t.success||function(){},t.success=function(t){return function(i){return t.set(i),e(t)}}(this),this.sync("delete",this,t),this},e.prototype.thumbUp=function(t,e,i){return i||(i={}),i.url=this.url()+"/"+t,i.attrs||(i.attrs={}),this.sync(e,this,i),this},e.prototype.getLike=function(t){return this.thumbUp("like","read",t),this},e.prototype.doLike=function(t){return this.thumbUp("like","create",t),this},e.prototype.unLike=function(t){return this.thumbUp("like","delete",t),this},e.prototype.doFavorite=function(t){return this.thumbUp("favorite","create",t),this},e.prototype.unFavorite=function(t){return this.thumbUp("favorite","delete",t),this},e.prototype.initSubscribe=function(){return this},e.prototype.setMemCache=function(t){return a[this.id+"-cache"]=t,this},e.prototype.getMemCache=function(t){var e;return e=a[this.id+"-cache"],t?(e||{})[t]:e},e.prototype.clearMemCache=function(){return delete a[this.id+"-cache"],this},e.prototype.checkIsVisible=function(){var t,e,i;return e="involves"===this.get("visible"),t=(null!=(i=this.get("involveMembers"))?i.indexOf(u.user.id):void 0)>=0,!e||t},e}(n.Model),t.exports=c.bindToModel(r)},function(t,e){var i,n,r,o,s,a;i=36500,n=9999,s=function(t){var e,i,n,o,s,c;return s="organization"===(null!=t?t.objectType:void 0)?r(t):a(t),o=s.payType,n=s.membersLimit,c=s.restDays,i=s.isOverdue,e="free"===o?209715200:1073741824,{payType:o,membersLimit:n,fileSizeLimit:e,restDays:c,isOverdue:i,isExpiring:0<c&&c<=7}},r=function(t){var e,i;return i=o(t.expired),e=!(new Date(t.expired).getTime()-(new Date).getTime()>0),{payType:"organization",status:t.status,expired:t.expired,membersLimit:t.membersCount,restDays:i,isOverdue:e,isExpiring:0<i&&i<=7}},a=function(t){var e,n,r,s;return"paid"===(null!=t?t.status:void 0)?(r="professional",n=t.membersCount,s=o(t.expired),e=!(new Date(t.expired).getTime()-(new Date).getTime()>0)):"trial"===(null!=t?t.status:void 0)?(r="free",n=t.membersCount,s=i,e=!1):(r="free",n=10,s=i,e=!1),{payType:r,membersLimit:n,restDays:s,isOverdue:e,isExpiring:0<s&&s<=14}},o=function(t){var e,i,n;return e=new Date(t).getTime(),i=(new Date).getTime(),n=Math.ceil((e-i)/864e5)},t.exports={projectPaymentPlan:s,organizationPaymentPlan:r,userPaymentPlan:a,UNLIMIT_DAYS:i,UNLIMIT_MEMBERS:n}},function(t,e,i){t.exports=i.p+"images/logo0.2bacc028.jpg"},function(t,e,i){t.exports=i.p+"images/logo1.a6464e9c.jpg"},function(t,e,i){t.exports=i.p+"images/logo2.cfdc05ac.jpg"},function(t,e,i){t.exports=i.p+"images/logo3.c69aba1a.jpg"},function(t,e,i){t.exports=i.p+"images/logo4.7c405e5c.jpg"},function(t,e,i){t.exports=i.p+"images/logo5.a07a0ef0.jpg"},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;a=i(358),c=i(678),n=i(685),o=i(697),s=i(686),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.name="projects",e.prototype.model=o,e.prototype.initialize=function(){return a.delay(function(t){return function(){var i;return i=t._boundToObjectId||c.user.id,s.on(":new:projects/"+i,function(e){return t.add(e)}),t.on("add",function(t){var i,n;if(i=t.get("_organizationId"),i&&!t.get("isArchived"))return null!=(n=e.find(i))?n.add(t.toJSON()):void 0})}}(this)),e.__super__.initialize.apply(this,arguments)},e.prototype.getSelfProject=function(){return this.filter(function(t){return null==t.get("_organizationId")})},e.prototype.getSelfProjectCount=function(){return this.where({_organizationId:null}).length},e.prototype.getSelfOwnProjectCount=function(){return this.where({_organizationId:null,_creatorId:c.user.id}).length},e.prototype.getStarProjects=function(){return this.filter(function(t){return t.get("isStar")})},e.prototype.getInvolvedStarProjects=function(){return this.filter(function(t){return t.get("isStar")&&(t.get("_roleId")>=-1||"string"==typeof t.get("_roleId"))})},e.prototype.getOrganizationProjects=function(){return this.filter(function(t){return null!=t.get("_organizationId")})},e.prototype.getInvolvedOrganizationProjects=function(){return this.filter(function(t){return null!=t.get("_organizationId")&&(t.get("_roleId")>=-1||"string"==typeof t.get("_roleId"))})},e.prototype.groupByOrganization=function(t,e){var i,n,r,o;return null==e&&(e=null),n=this.groupBy(function(t){return t.get("_organizationId")}),r=this.getStarProjects(),o=[],r.length&&(o.push({type:"groupBy",groupName:tb_i18n.get("flagged.projects")}),a.each(r,function(t){var i;return i=t.toJSON(),e&&(i.disabledHint=t.getCopyOrMoveStatus(e)),o.push(i)})),i=a.keys(n),i=a.map(i,function(e){var i,n;return i=(null!=(n=t.get(e))?n.toJSON():void 0)||{name:""},{_id:e,name:i.name,pinyin:i.pinyin||i.name}}),i=a.sortBy(i,function(t){return t.pinyin}),a.each(i,function(t){return o.push({type:"groupBy",groupName:t.name||tb_i18n.get("my.projects")}),a.each(n[t._id],function(t){var i;return i=t.toJSON(),e&&(i.disabledHint=t.getCopyOrMoveStatus(e)),o.push(i)})}),o},e.prototype.comparator=function(t){return t.get("pinyin")||t.get("name")},e.prototype.joinRooms=function(){if(!this.subscribed)return this.subscribed=!0,s.join("projects"),this.on("add",function(t){return t.joinRoom()}),this.on("remove",function(t){return t.leaveRoom()})},e}(n),o.Collection=r,t.exports=r},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f=function(t,e){function i(){this.constructor=t}for(var n in e)g.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},g={}.hasOwnProperty,v=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;
return-1};d=i(358),m=i(678),h=i(679),o=i(688),s=i(429),u=i(686),p=i(698),r=i(699),a=i(689),n=i(680),c=i(701),t.exports=l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.name="project",e.prototype.urlRoot="projects",e.prototype.defaults={_organizationId:null,objectType:"project",category:"media",description:"",recent:[0,0,0,0,0],_roleId:-2,_orgRoleId:-2,task:{total:0,done:0,undone:0,today:0,outdate:0,unassigned:0}},e.prototype.listen=function(){if(!this.listenedLock&&this.id)return this.listenedLock=!0,u.off(":refresh:projects/"+this.id),u.on(":refresh:projects/"+this.id,function(t){return function(){var e;return t.fetch(),null!=(e=r.get(t.id))?e.synced=!1:void 0}}(this)),u.off(":change:statistic/"+this.id),u.on(":change:statistic/"+this.id,function(t){return function(e){var i,n,r,o,s;if(e.task){o=d.clone(t.get("task")),r=e.task;for(i in r)s=r[i],o[i]+=s;return t.set("task",o),e.task.done>0?(n=d.clone(t.get("recent")),n[4]+=e.task.done,t.set("recent",n)):void 0}}}(this)),e.__super__.listen.apply(this,arguments)},e.prototype.parse=function(t){return t=d.extend(this.toJSON(),t),t.role&&new p(t.role),t},e.prototype.sync=function(t,i,n){var r;switch(r=n.success,t){case"create":n.success=function(t){return t.isNew=!0,"function"==typeof r?r(t):void 0}}return e.__super__.sync.apply(this,arguments)},e.prototype.getRecommendMembers=function(t){return t.url=this.url()+"/recommendMembers",t.expireCache={namespace:"project_"+this.id+"_recommend_members",expire:60},this.sync("read",this,t),this},e.prototype.getStatistic=function(t){var e;return null==t&&(t={}),t.url=this.url()+"/statistic",t.attrs={today:s().endOf("day").toISOString()},t.expireCache={namespace:"project_"+this.id+"_statistic_datas",expire:10},e=t.success||function(){},t.success=function(t){return function(i){return t.set(i),e(i)}}(this),this.sync("read",this,t),this},e.prototype.getFirstApp=function(){return d.sortBy(d.filter(this.get("applications"),function(t){return 1===t.type}),"order")[0].name},e.prototype.transfer=function(t,i){var n,r,o;return null==i&&(i={}),i.url=this.url()+"/transfer",i.attrs={_id:this.id},"user"===i.ownerType?i.attrs._userId=t:i.attrs._organizationId=t,o=i.success||function(){},r=this.get("_organizationId"),n=e.Collection,i.success=function(t){return function(e){var i,s,a,c;return i=n.get(0),r&&(a=n.get(r,{boundToObjectType:"organization"})),c=n.get(e._organizationId,{boundToObjectType:"organization"}),s=(null!=a?a.get(t.id):void 0)||i.get(t.id),null!=a&&a.remove(s),s.set(e),null!=c&&c.add(s.toJSON(),{merge:!0}),s.getRoleScope()>=-1&&i.add(s.toJSON(),{merge:!0}),o(e)}}(this),"function"==typeof i.beforeSend&&i.beforeSend(),this.sync("update",this,i),this},e.prototype.quit=function(t){return t||(t={}),t.url=this.url()+"/quit",t.attrs||(t.attrs={}),this.sync("update",this,t),this},e.prototype.fetchInvitelink=function(t){var e;return t||(t={}),t.url=this.url()+"/invitelink",e=t.success||function(){},t.success=function(t){return function(i){return t.set(i),e(i)}}(this),this.sync("read",this,t),this},e.prototype.fetchCallink=function(t){var e;return t||(t={}),t.url=this.url()+"/callink",e=t.success||function(){},t.success=function(t){return function(i){return t.set(i),e(i)}}(this),this.sync("read",this,t),this},e.prototype.resetInvite=function(t){var e;return t||(t={}),t.url=this.url()+"/invitelink",t.attrs={},e=t.success||function(){},t.success=function(t){return function(i){return t.set(d.pick(i,"mobileInviteLink","inviteLink")),e(i)}}(this),this.sync("update",this,t),this},e.prototype.setNavigation=function(t,e){var i;return null==t&&(t={}),null==e&&(e={}),e.url=this.url()+"/navigation",e.attrs={navigation:t},i=e.success,e.success=function(){return"function"==typeof i?i(arguments):void 0},this.sync("update",this,e),this},e.prototype.copy=function(t){return t.url=this.url()+"/copy",this.sync("create",this,t),this},e.prototype.join=function(t){return t||(t={}),t.url="v2/"+this.url()+"/join",t.attrs={},this.sync("create",this,t),this},e.prototype.joinRoom=function(){if(!this.subscribed&&this.get("_roleId")>-1)return u.join(this.url()),this.subscribed=!0},e.prototype.setUniqueIdPrefix=function(t){return t||(t={}),t.url=this.url()+"/unique-id-prefix",this.sync("update",this,t)},e.prototype.leaveRoom=function(){if(!this.debounceLock)return this.debounceLock=!0,n.del(this.url()+"/subscribe",{consumerId:m.consumerId}).then(function(t){return function(){return t.subscribed=!1}}(this))},e.prototype.toggleStar=function(t){var e;return t.url=this.url()+"/star",t.attrs={},e=this.get("isStar")?"delete":"update",this.sync(e,this,t),this},e.prototype.getAllUnreadCount=function(){return this.get("unreadCount")},e.prototype.clearUnreadCount=function(t){var e;if(null==t&&(t={}),this.get("unreadCount"))return t.url=this.url()+"/unreadCount",e=t.success||function(){},t.success=function(t){return function(){return t.set("unreadCount",0),e.apply(null,arguments)}}(this),this.sync("update",this,t),this},e.prototype.clearUnreadMessageCount=function(t){if(null==t&&(t={}),t.roomId)return t.url="rooms/"+t.roomId+"/unreadCount",t.attrs={},this.sync("update",this,t),this},e.prototype.putPushStatus=function(t,e){var i;return null==e&&(e={}),e.url=this.url()+"/pushStatus",e.attrs={pushStatus:t},i=e.success||function(){},e.success=function(e){return function(){return e.set("pushStatus",t),i.apply(null,arguments)}}(this),this.sync("update",this,e),this},e.prototype.putDefaultRole=function(t,e){var i;return null==e&&(e={}),e.url=this.url()+"/_defaultRoleId",e.attrs={_roleId:t},i=e.success||function(){},e.success=function(e){return function(){return e.set("_defaultRoleId",t),i.apply(null,arguments)}}(this),this.sync("update",this,e),this},e.prototype.getNavigations=function(){var t,e,i,n;return i=m.applications.getNavApps(),e=function(){var e,n,r;for(r=[],e=0,n=i.length;e<n;e++)t=i[e],r.push(t.get("name"));return r}(),n={},d.each(e,function(e){return function(i){return t=d.find(e.get("applications"),{name:i}),n[i]=null!=t?t.order:-1}}(this)),n},e.prototype.getIntegrations=function(){var t,e,i;return i=c.getIntegrations(),t=d.pluck(d.where(this.get("applications"),{type:2}),"name"),e=d.map(i,function(e){var i,n;switch(e.enable=(i=e.type,v.call(t,i)>=0),e.type){case"evernote":n="evernote_international";break;case"yinxiang":n="evernote";break;default:n=e.type}return e.bindUrl=h.ACCOUNT_HOST+"/"+n+"/bind?next_url="+window.location.href,e})},e.prototype.getIntegrationTypes=function(){return d.pluck(c.getIntegrations(),"type")},e.prototype.createIntegrations=function(t,e){return null==e&&(e={}),e.url="integrations/"+t,e.contentType="application/json",e.data=JSON.stringify(e.data),Object.getPrototypeOf(this).sync("create",this,e),this},e.prototype.getPlugins=function(){var t,e,i,n;return i=m.applications.getPlugins(),e=function(){var e,n,r;for(r=[],e=0,n=i.length;e<n;e++)t=i[e],r.push(t.get("name"));return r}(),n={},d.each(e,function(t){return function(e){var i;return i=d.find(t.get("applications"),{name:e}),n[e]=null!=i}}(this)),n},e.prototype.pluginToggle=function(t,e){var i,n,r;return null==e&&(e={}),t&&(d.extend(e,{url:this.url()+"/applications/"}),i=m.applications.find(function(e){return e.get("name")===t}),n=null!=i?i.id:void 0,e.enable?(e.attrs={_applicationId:n},r="create"):(e.url+=n,e.attrs={},r="delete"),this.sync(r,this,e)),this},e.prototype.isAppEnabled=function(t){var e;return"preciseDate"===t||(e=d.pluck(this.get("applications"),"name"),d.contains(e,t)&&m.applications.checkIsAppOnline(t))},e.prototype.isAppChanged=function(t){var e,i,n,r,o,s,a;for(n=!1,a=t.split(" "),r=0,o=a.length;r<o;r++)if(s=a[r],e=d.find(this.get("applications"),{name:s}),i=d.find(this.previous("applications"),{name:s}),(null!=e?e.order:void 0)!==(null!=i?i.order:void 0)){n=!0;break}return n},e.prototype.isNavAppChanged=function(){var t,e,i,n,r,o,s;for(i=!1,s=m.applications.getNavApps(),n=0,r=s.length;n<r;n++)if(o=s[n],t=d.find(this.get("applications"),{name:o.get("name")}),e=d.find(this.previous("applications"),{name:o.get("name")}),(null!=t?t.order:void 0)!==(null!=e?e.order:void 0)){i=!0;break}return i},e.prototype.getCopyOrMoveStatus=function(t){var e,i;return e={posts:"post.post",events:"event.post",works:"work.post"},i=null,this.isAppEnabled(t)?this.hasPermission(e[t])||(i="denied"):i="closed",i},e.prototype.getPaymentPlan=function(){var t,e;return t=(null!=(e=this.get("organization"))?e.plan:void 0)||this.get("plan"),a.projectPaymentPlan(t)},e.prototype.getCanQuit=function(){var t,e;return t=this.get("_roleId"),e=!(null===this.get("_organizationId")&&2===t)&&("string"==typeof t||t>=0)},e}(o)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(688),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.name="role",e.prototype.urlRoot="roles",e.prototype.defaults={name:"",permissions:[]},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;c=i(358),l=i(678),n=i(685),o=i(700),s=i(686),a=i(677),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.name="members",e.prototype.model=o,e.prototype.boundToObjectType="project",e.prototype.listen=function(){if(!this.listened)return s.on(":remove:members/"+this._boundToObjectId,function(t){return function(e){var i;return i=c.find(t.models,function(t){return t.get("_memberId")===e}),t.remove(i)}}(this)),e.__super__.listen.apply(this,arguments)},e.prototype.sync=function(t,i,n){var r;switch(n||(n={}),n.url||(n.url="v2/"+this.boundToObjectType+"s/"+this._boundToObjectId+"/members"),r=n.success||function(){},t){case"search":n.url="users",n.type="GET",n.processData=!0;break;case"create":n.success=function(t){return function(e){return t.update(e,n),r(e)}}(this)}return e.__super__.sync.apply(this,arguments)},e.prototype.comparator=function(t,e){var i,n;return n=l.user.id,t.get("_id")===n?-1:e.get("_id")===n?1:(i=e.getRoleScope()-t.getRoleScope(),i||(t.get("pinyin")>e.get("pinyin")?i=1:t.get("pinyin")<e.get("pinyin")&&(i=-1)),i)},e.prototype.getParams=function(t,e){var i;if("read"===t)return i={boundToObjectType:e.boundToObjectType||this.boundToObjectType,_boundToObjectId:this._boundToObjectId}},e.prototype.search=function(t,e,i){return i||(i={}),i.data={},i.data[t]=e,this.sync("search",this,i)},e.prototype.getMemberIds=function(){return this.pluck("_id")},e.prototype.addMember=function(t,e){return e||(e={}),e.attrs=t,this.sync("create",this,e)},e.prototype.removeMember=function(t,e){return null==e&&(e={}),e.url=this.boundToObjectType+"s/"+this._boundToObjectId+"/members/"+t,e.wait=!0,this.sync("delete",this,e)},e.prototype.findMember=function(t){return this.findWhere({_userId:t})},e.prototype.getOrganizationMembers=function(){return this.filter(function(t){return null!=t.get("_organizationId")})},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;l=i(358),r=i(688),o=i(429),a=i(698),p=i(678),c=i(686),s=i(689),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.name="member",e.prototype.urlRoot="members",e.prototype.defaults={objectType:"member",name:"",title:"",avatar:"",isOnline:!0,isQuited:!1,birthday:null},e.prototype.initialize=function(t,i){return i||(i={}),i.bindByMatrix=!1,this.listen(),e.__super__.initialize.apply(this,arguments)},e.prototype.listen=function(){if(!this.listened)return c.on(":change:member/"+this.get("_memberId"),function(t){return function(e){return t.set(t.parse(e))}}(this)),e.__super__.listen.apply(this,arguments)},e.prototype.url=function(){return"members/"+this.get("_memberId")},e.prototype.parse=function(t){var e;return t=l.extend(this.toJSON(),t),t._userId||(t._userId=t._id),t.isNew=o(t.joined).isAfter(o().subtract(1,"month")),(null!=t?t.website:void 0)?(e=t.website,"string"==typeof e&&""!==e.replace(/\s/g,"")?/^[http:|https:|ftp:]/.test(e)||(e="http://"+e):e=null,t.website=e,t):t},e.prototype.initSubscribe=function(){return this.get("_userId")===p.user.id&&this.subscribeTo(this.get("_userId"),"change",function(t){return function(e){return t.set(e.pick("name","email","avatarUrl","website","title","pinyin","py","phone","birthday","location"))}}(this)),this},e.prototype.getBirthdayString=function(){var t,e,i;if(e=this.get("birthday"))return t=new Date(e),i=t.getFullYear()+".\n"+(t.getMonth()+1)+".\n"+t.getDate()},e.prototype.getRole=function(){var t,e;return e=a.get(this.get("_roleId")),t=e.get("name")||"guest",t=function(){switch(t){case"owner":return tb_i18n.get("owner");case"admin":return tb_i18n.get("manager");case"member":return tb_i18n.get("member");case"guest":return tb_i18n.get("guest");default:return t}}()},e.prototype.getPaymentPlan=function(){return s.userPaymentPlan(this.get("plan"))},e.prototype.getTasksCount=function(t){var e,i,n,r;return e=t.memberId,n=t.projectId,i=t.organizationId,r="users/"+e+"/taskscount?_projectId="+n,i&&(r+="&_organizationId="+i),this.sync("read",this,{url:r,success:t.success})},e.prototype.fetchMemberTasks=function(t){return t.url="members/"+this.get("_memberId")+"/undonetasks",this.sync("read",this,t),this},e.prototype.fetchMemberSubtasks=function(t){return t.url="members/"+this.get("_memberId")+"/undonesubtasks",this.sync("read",this,t),this},e.prototype.fetchMemberDoneTasks=function(t){return t.attrs=l.extend({page:1,count:30},t.attrs),t.url="members/"+this.get("_memberId")+"/donetasks",this.sync("read",this,t),this},e.prototype.fetchMemberDoneSubtasks=function(t){return t.attrs=l.extend({page:1,count:30},t.attrs),t.url="members/"+this.get("_memberId")+"/donesubtasks",this.sync("read",this,t),this},e.prototype.fetchMemberEvents=function(t){return t.url="members/"+this.get("_memberId")+"/events",this.sync("read",this,t),this},e}(r)},function(t,e,i){var n,r,o;n=i(358),o=i(678),r=function(){return{tasks:{type:"tasks",name:tb_i18n.get("powerups.tasks"),className:"icon icon-board",des:tb_i18n.get("powerups.tasks.des"),poster:i(702),video:"https://dn-site.oss.aliyuncs.com/videos/support/support_board.mp4?response-content-type=video/mp4",imgs:[i(703),i(704),i(705)]},posts:{type:"posts",name:tb_i18n.get("powerups.posts"),className:"wall",des:tb_i18n.get("powerups.posts.des"),poster:i(706),video:"https://dn-site.oss.aliyuncs.com/videos/support/support_posts.mp4?response-content-type=video/mp4",imgs:[i(707),i(708),i(709)]},events:{type:"events",name:tb_i18n.get("powerups.events"),className:"calendar",des:tb_i18n.get("powerups.events.des"),poster:i(710),video:"https://dn-site.oss.aliyuncs.com/videos/support/support_events.mp4?response-content-type=video/mp4",imgs:[i(711),i(712),i(713)]},works:{type:"works",name:tb_i18n.get("powerups.works"),className:"file4",des:tb_i18n.get("powerups.works.des"),poster:i(714),video:"https://dn-site.oss.aliyuncs.com/videos/support/support_files.mp4?response-content-type=video/mp4",imgs:[i(715),i(716),i(717)]},groupchat:{type:"groupchat",name:tb_i18n.get("powerups.groupchat"),className:"chat-group",des:tb_i18n.get("powerups.groupchat.des"),poster:i(718),video:"",imgs:[i(719),i(720),i(721)]},bookkeeping:{type:"bookkeeping",name:tb_i18n.get("powerups.bookkeeping"),className:"bookkeeping-logo",des:tb_i18n.get("powerups.bookkeeping.des"),poster:i(722),video:"https://dn-st.teambition.net/teambition/videos/bookkeeping.6c5d2049.mp4?response-content-type=video/mp4",imgs:[i(723),i(724),i(725)]},startDate:{type:"startDate",name:tb_i18n.get("powerups.startDate"),des:tb_i18n.get("powerups.startDate.des"),poster:i(726),video:"http://dn-site.oss-cn-hangzhou.aliyuncs.com/videos/starttime_ee8c4bd7c1105ca08120926bd8d702d1d184f5b7.mp4?response-content-type=video/mp4",imgs:[i(727),i(728),i(729)]},markdown:{type:"markdown",name:tb_i18n.get("powerups.markdown"),des:tb_i18n.get("powerups.markdown.des"),poster:i(730),video:"https://dn-st.teambition.net/teambition/videos/markdown.5e2dbc09.mp4?response-content-type=video/mp4",imgs:[i(731),i(732),i(733)]},preciseDate:{type:"preciseDate",name:tb_i18n.get("powerups.preciseDate"),des:tb_i18n.get("powerups.preciseDate.des"),poster:i(734),imgs:[i(735),i(736),i(737)]},yiqixie:{type:"yiqixie",name:tb_i18n.get("powerups.yiqixie"),des:tb_i18n.get("powerups.yiqixie.des"),poster:i(738),imgs:[i(739),i(740),i(741)]},shimo:{type:"shimo",name:tb_i18n.get("powerups.shimo"),des:tb_i18n.get("powerups.shimo.des"),poster:i(742),imgs:[i(743),i(744),i(745)]},appearin:{type:"appearin",name:"appear.in",des:tb_i18n.get("powerups.appearin.des"),poster:i(746),imgs:[i(747),i(748),i(749)]},tasklist:{type:"tasklist",name:tb_i18n.get("powerups.tasklist"),des:tb_i18n.get("powerups.tasklist.des"),poster:i(750),video:i(751),imgs:[i(752),i(753),i(754)]},taskUniqueId:{type:"taskUniqueId",name:tb_i18n.get("powerups.taskUniqueId"),des:tb_i18n.get("powerups.taskUniqueId.des"),poster:i(755),imgs:[i(756),i(757),i(758)]},evernote:{type:"evernote",name:"Evernote",des:tb_i18n.get("powerups.evernote.des"),poster:i(759),video:"https://dn-st.teambition.net/teambition/videos/evernote.3f3fb281.mp4?response-content-type=video/mp4",imgs:[i(760),i(761),i(762)],isIntegration:!0},yinxiang:{type:"yinxiang",name:"印象笔记",des:tb_i18n.get("powerups.yinxiang.des"),poster:i(763),video:"http://dn-site.oss-cn-hangzhou.aliyuncs.com/videos/powerups_yinxiang_v7.5.mp4?response-content-type=video/mp4",imgs:[i(764),i(765),i(766)],isIntegration:!0},weibo:{type:"weibo",name:tb_i18n.get("powerups.weibo"),des:tb_i18n.get("powerups.weibo.des"),poster:i(767),video:"https://dn-st.teambition.net/teambition/videos/weibo.5716de0a.mp4?response-content-type=video/mp4",imgs:[i(768),i(769),i(770)],isIntegration:!0},github:{type:"github",name:"GitHub",des:tb_i18n.get("powerups.github.des"),poster:i(771),video:"https://dn-st.teambition.net/teambition/videos/github.d0c2e692.mp4?response-content-type=video/mp4",imgs:[i(772),i(773),i(774)],isIntegration:!0},processon:{type:"processon",name:"ProcessOn",des:tb_i18n.get("powerups.processon.des"),poster:i(775),video:"http://dn-site.oss-cn-hangzhou.aliyuncs.com/videos/processon_9a5814295017f8ba545ca024ef5669267f3167f6.mp4?response-content-type=video/mp4",imgs:[i(776),i(777),i(778)],isIntegration:!0},jinshuju:{type:"jinshuju",name:tb_i18n.get("powerups.jinshuju"),des:tb_i18n.get("powerups.jinshuju.des"),poster:i(779),video:"https://dn-site.oss-cn-hangzhou.aliyuncs.com/videos/jinshuju_c229e724a326a0dca3d4373e8766af179bf275e6.mp4?response-content-type=video/mp4",imgs:[i(780),i(781),i(782)],isIntegration:!0}}},t.exports={getItems:function(){var t,e,i;return t=r(),i=o.applications.getOnlineAppNames(),e=n.difference(n.keys(t),i),n.chain(t).omit(e).mapObject(function(t,e){return t.isPremium=o.applications.checkIsPremiumApp(e),t}).value()},getIntegrations:function(){return n.filter(r(),function(t){return t.isIntegration})}}},function(t,e,i){t.exports=i.p+"images/tasks-poster.7974347f.png"},function(t,e,i){t.exports=i.p+"images/tasks-0.62a66f43.png"},function(t,e,i){t.exports=i.p+"images/tasks-1.10b8130a.png"},function(t,e,i){t.exports=i.p+"images/tasks-2.f60591e1.png"},function(t,e,i){t.exports=i.p+"images/posts-poster.ae43943c.png"},function(t,e,i){t.exports=i.p+"images/posts-0.e554609e.png"},function(t,e,i){t.exports=i.p+"images/posts-1.06a6c08c.png"},function(t,e,i){t.exports=i.p+"images/posts-2.37e2b368.png"},function(t,e,i){t.exports=i.p+"images/events-poster.5512030e.png"},function(t,e,i){t.exports=i.p+"images/events-0.1ef2345e.png"},function(t,e,i){t.exports=i.p+"images/events-1.7deb80a3.png"},function(t,e,i){t.exports=i.p+"images/events-2.bd3e0c5a.png"},function(t,e,i){t.exports=i.p+"images/works-poster.f13f0ad0.png"},function(t,e,i){t.exports=i.p+"images/works-0.a08cc52d.png"},function(t,e,i){t.exports=i.p+"images/works-1.7f8bfdf2.png"},function(t,e,i){t.exports=i.p+"images/works-2.bea8d2e2.png"},function(t,e,i){t.exports=i.p+"images/groupchat-poster.916cfde8.png"},function(t,e,i){t.exports=i.p+"images/groupchat-0.f6691785.png"},function(t,e,i){t.exports=i.p+"images/groupchat-1.3a9ab585.png"},function(t,e,i){t.exports=i.p+"images/groupchat-2.1c62bfc7.png"},function(t,e,i){t.exports=i.p+"images/bookkeeping-poster.bd9e3736.png"},function(t,e,i){t.exports=i.p+"images/bookkeeping-0.5b40c2ea.png"},function(t,e,i){t.exports=i.p+"images/bookkeeping-1.b80e2ba4.png"},function(t,e,i){t.exports=i.p+"images/bookkeeping-2.62f95d82.png"},function(t,e,i){t.exports=i.p+"images/startdate-poster.08240b76.png"},function(t,e,i){t.exports=i.p+"images/startdate-0.50552cb1.png"},function(t,e,i){t.exports=i.p+"images/startdate-1.968916c9.png"},function(t,e,i){t.exports=i.p+"images/startdate-2.040bfbea.png"},function(t,e,i){t.exports=i.p+"images/markdown-poster.37be7bfa.png"},function(t,e,i){t.exports=i.p+"images/markdown-0.59fc2514.png"},function(t,e,i){t.exports=i.p+"images/markdown-1.02194107.png"},function(t,e,i){t.exports=i.p+"images/markdown-2.388ddad9.png"},function(t,e,i){t.exports=i.p+"images/preciseDate-poster.cb8cae86.png"},function(t,e,i){t.exports=i.p+"images/preciseDate-0.7ffc4796.png"},function(t,e,i){t.exports=i.p+"images/preciseDate-1.d37215dd.png"},function(t,e,i){t.exports=i.p+"images/preciseDate-2.5009e2cb.png"},function(t,e,i){t.exports=i.p+"images/yiqixie-poster.1fbe67d6.png"},function(t,e,i){t.exports=i.p+"images/yiqixie-0.2a3943a8.png"},function(t,e,i){t.exports=i.p+"images/yiqixie-1.6e293f6f.png"},function(t,e,i){t.exports=i.p+"images/yiqixie-2.d66a7075.png"},function(t,e,i){t.exports=i.p+"images/shimo-poster.2c64b1e5.png"},function(t,e,i){t.exports=i.p+"images/shimo-0.d147b17f.png"},function(t,e,i){t.exports=i.p+"images/shimo-1.a61d0526.png"},function(t,e,i){t.exports=i.p+"images/shimo-2.f0e70f23.png"},function(t,e,i){t.exports=i.p+"images/appearin-poster.17715f20.png"},function(t,e,i){t.exports=i.p+"images/appearin-0.c4ceb8df.png"},function(t,e,i){t.exports=i.p+"images/appearin-1.03560f6b.png"},function(t,e,i){t.exports=i.p+"images/appearin-2.53151972.png"},function(t,e,i){t.exports=i.p+"images/tasklist-poster.544c2a3e.png"},function(t,e,i){t.exports=i.p+"videos/tasklist-tutorial.87c97553.mp4"},function(t,e,i){t.exports=i.p+"images/tasklist-0.f6e1c97f.png"},function(t,e,i){t.exports=i.p+"images/tasklist-1.822e356e.png"},function(t,e,i){t.exports=i.p+"images/tasklist-2.c063ea4a.png"},function(t,e,i){t.exports=i.p+"images/taskUniqueId-poster.aea3d387.png"},function(t,e,i){t.exports=i.p+"images/taskUniqueId-0.19699e04.png"},function(t,e,i){t.exports=i.p+"images/taskUniqueId-1.bd9d681e.png"},function(t,e,i){t.exports=i.p+"images/taskUniqueId-2.89faa534.png"},function(t,e,i){t.exports=i.p+"images/evernote-poster.427bc4de.png"},function(t,e,i){t.exports=i.p+"images/evernote-0.2fdf37ac.png"},function(t,e,i){t.exports=i.p+"images/evernote-1.f479fe93.png"},function(t,e,i){t.exports=i.p+"images/evernote-2.6969a648.png"},function(t,e,i){t.exports=i.p+"images/yinxiang-poster.964146fd.png"},function(t,e,i){t.exports=i.p+"images/yinxiang-0.d737da3d.png"},function(t,e,i){t.exports=i.p+"images/yinxiang-1.081093c9.png"},function(t,e,i){t.exports=i.p+"images/yinxiang-2.f8023a2f.png"},function(t,e,i){t.exports=i.p+"images/weibo-poster.7dd4ed89.png"},function(t,e,i){t.exports=i.p+"images/weibo-0.aa94ef68.png"},function(t,e,i){t.exports=i.p+"images/weibo-1.69f0d6d8.png"},function(t,e,i){t.exports=i.p+"images/weibo-2.1d5fa1ad.png"},function(t,e,i){t.exports=i.p+"images/github-poster.aa7b9124.png"},function(t,e,i){t.exports=i.p+"images/github-0.af8b42fd.png"},function(t,e,i){t.exports=i.p+"images/github-1.c83d7ebd.png"},function(t,e,i){t.exports=i.p+"images/github-2.48fdd893.png"},function(t,e,i){t.exports=i.p+"images/processon-poster.e73d00cf.png"},function(t,e,i){t.exports=i.p+"images/processon-0.71363a19.png"},function(t,e,i){t.exports=i.p+"images/processon-1.d0e3201d.png"},function(t,e,i){t.exports=i.p+"images/processon-2.b693e8fe.png"},function(t,e,i){t.exports=i.p+"images/jinshuju-poster.34c54e84.png"},function(t,e,i){t.exports=i.p+"images/jinshuju-0.40d51ae0.png"},function(t,e,i){t.exports=i.p+"images/jinshuju-1.5ed9cab5.png"},function(t,e,i){t.exports=i.p+"images/jinshuju-2.88f98e84.png"},function(t,e){e.SOCKET_NAMESPACE="appConfigs",e.EVENT_NAMESPACE="plugin",e.PLUGIN_URL="plugin",e.CACHE_NAME="plugin",e.CACHE_TIME=3600},function(t,e,i){var n,r,o,s,a;s=i(351),r=$(document),n=$("body"),o=function(t){return"<div class='arrow'></div>\n<p class='message'>"+t+"</p>"},a=function(){var t;return this.$el=$('<div class="hint"></div>'),t=function(t){return function(e){var i,s,a,c,l;i=$(e.currentTarget),s=+i.data("hinted-delay"),s>=0||(s=370),a=function(){var s,a,c,l,p,u,d,h,m,f,g,v;if(null!=i&&i.off(".hint"),g=i.outerWidth(),d=i.parent().outerWidth(),g>d&&(g=d),f={$el:i,message:i.data("title"),offset:{top:i.offset().top,left:i.offset().left},size:{height:i.outerHeight(),width:g}},i.hasClass("hint-content")){if(!(i.get(0).scrollWidth>i.width()))return;f.message||(f.message=i.text())}if(!i.hasClass("auto-hint")||i.width()>i.parent().width()){if(t.$el.html(o(f.message)),n.append(t.$el),u={height:t.$el.outerHeight(),width:t.$el.outerWidth()},v={width:window.innerWidth,height:window.innerHeight},m=document.documentElement.scrollTop||window.pageYOffset,l=function(){return u.top=f.offset.top+f.size.height+10,u.left=f.offset.left+.5*f.size.width-.5*u.width,u.arrowPosition="top"},s=function(){return u.top=f.offset.top-u.height-10,u.left=f.offset.left+.5*f.size.width-.5*u.width,u.arrowPosition="bottom"},a=function(){return u.top=f.offset.top+.5*f.size.height-.5*u.height,u.left=f.offset.left+f.size.width+10,u.arrowPosition="left"},c=function(){return u.top=f.offset.top+.5*f.size.height-.5*u.height,u.left=f.offset.left-u.width-10,u.arrowPosition="right"},p=$(e.currentTarget).data("direction"),!p||"left"!==p&&"right"!==p&&"bottom"!==p&&"top"!==p)s(),u.left+u.width>v.width&&f.offset.left-u.width-10>0?c():u.top<0?f.offset.left+f.size.width+u.width+10<v.width?a():l():u.left<0&&a();else switch(p){case"left":a();break;case"right":c();break;case"top":l();break;case"bottom":s()}t.$el.css({top:u.top+"px",left:u.left+"px"}),t.$el.children(".arrow").prop("class","arrow "+u.arrowPosition),t.$el.addClass("on"),h=function(){var e;return t.$el.css({top:"50%",left:"50%"}).removeClass("on").remove(),null!=(e=f.$el)&&e.off(".hint"),r.off(".hint")},r.one("scroll.hint",h),f.$el.one("mouseleave click",h).on("mousedown.hint",function(){return r.one("mousemove.hint",h)}).on("mouseup.hint",function(){return r.off("mousemove.hint")}).on("remove.hint",h)}},c=setTimeout(a,s),l=function(){return clearTimeout(c),null!=i?i.off(".hint"):void 0},i.one("mouseleave click",l).on("mousedown.hint",function(){return r.one("mousemove.hint",l)}).on("mouseup.hint",function(){return r.off("mousemove.hint")}).on("remove.hint",l)}}(this),r.on("mouseenter",".hinted",t)},t.exports={initialize:a}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v=[].slice;u=i(358),g=i(678),n=i(688),c=i(698),a=i(697),r=i(687),s=Object.create(null),p=["task.put.executor","task.put","task.put.startDate","task.put.dueDate","task.put.note","task.put.status","task.put.move"],l=["subtask.put.executor","subtask.put","subtask.put.dueDate","subtask.put.status","subtask.put.transform"],o=function(){function t(e,i,n){var r;if(null==e||!i)throw new Error("_boundToObjectId and boundToObjectType is required");this._boundToObjectId=e,this.boundToObjectType=i,this.object=null,this.root=null,r=f(i),this.permissionKeys=function(){switch(i){case"organization":return t.organizationPermissionKeys.slice();case"project":return t.projectPermissionKeys.slice();default:return u.filter(t.defaultPermissionKeys,function(t){return m(t)?r:0===t.indexOf(i+".")})}}(),this.objectListener=function(t){return function(){return t.updatePermissions(t.object)}}(this),this.updatePermissions(n)}return t.prototype.findPermissions=function(t){var e,i;return e={},i=c.find(t),i&&u.each(i.get("permissions"),function(t){return e[t]=!0}),e},t.prototype.hasPermission=function(t){var e;return/^(post|put|get|del)/.test(t)&&!s[t]&&(t=this.boundToObjectType+"."+t),e=this._hasPermission(t)},t.prototype._hasPermission=function(e){var i,n,r,o,s;if(f(this.boundToObjectType)&&0===e.indexOf(this.boundToObjectType)&&(i=e.replace(this.boundToObjectType,"object"),m(i)))return this._hasPermission(i);if(o=!!this.permissions[e],!o&&this.object&&this.permissionKeys.indexOf(e)>=0)switch(this.boundToObjectType){case"stage":r=t.get(this.object.get("_tasklistId"),"tasklist"),(null!=(s=r.object)?s.isOwner():void 0)&&(o=!0);break;case"task":this.object.get("_executorId")===g.user.id&&p.indexOf(e)>=0&&(o=!0);break;case"subtask":this.object.get("_executorId")===g.user.id&&l.indexOf(e)>=0&&(o=!0),!o&&(n=t.get(this.object.get("_taskId"),"task").object)&&(n.isOwner()?o=!0:n.get("_executorId")===g.user.id&&l.indexOf(e)>=0&&(o=!0))}return!o&&this.root&&(o=this.root._hasPermission(e)),o},t.prototype.mergePermissions=function(t){return u.each(this.permissionKeys,function(e){return function(i){return t===!0?e.permissions[i]=!0:"boolean"==typeof t[i]?e.permissions[i]=t[i]:void 0}}(this)),this},t.prototype.updatePermissions=function(e){var i,n;if(this.permissions=Object.create(t.defaultPermissions),!e)return this;switch(this.object&&this.object.off(null,this.objectListener),this.object=e,this.boundToObjectType){case"organization":this.mergePermissions(this.findPermissions(e.get("_roleId")));break;case"project":e.get("_organizationId")&&(i=e.get("_organizationId"),this.root=t.get(i,"organization",r.find(i))),this.mergePermissions(this.findPermissions(e.get("_roleId")));break;default:if(e.get("_organizationId")?(i=e.get("_organizationId"),this.root=t.get(i,"organization",r.find(i))):e.get("_projectId")?(n=e.get("_projectId"),this.root=t.get(n,"project",a.find(n))):"activity"===this.boundToObjectType&&(this.root=t.get(e.get("_boundToObjectId"),e.get("boundToObjectType"))),this.object.isOwner())switch(this.mergePermissions(!0),this.boundToObjectType){case"post":this.permissions["post.put.pin"]=!1;break;case"entry":this.permissions["entry.put.approve"]=!1}}return this.object.on("change:_roleId chang:_organizationId chang:_projectId",this.objectListener),this},t}(),h=function(t){return t.replace(/\.([a-z])/g,function(t,e){return e.toUpperCase()})},f=function(t){return/^(task|post|event|work|entry)$/.test(t)},m=function(t){return o.objectPermissionKeys.indexOf(t)>=0},o.cache=d={},o.get=function(t,e,i){return d[t]||(d[t]=new o(t,e,i)),d[t]},o.initialize=function(t){return o.defaultPermissionKeys=t,o.organizationPermissionKeys=[],o.projectPermissionKeys=[],o.objectPermissionKeys=[],o.defaultPermissions={},u.each(t,function(t){if(o.defaultPermissions[t]=!1,/^(organization|team|role)\./.test(t)?o.organizationPermissionKeys.push(t):o.projectPermissionKeys.push(t),/^object\./.test(t)&&o.objectPermissionKeys.push(t),0===t.indexOf("post."))return s[t]=!0}),n.prototype.getPermissions=function(){var t,e;return t=null!=this.id?this.id:"new",e="archive"===this.name?this.get("boundToObjectType"):this.name,o.get(t,e,this)},n.prototype.hasPermission=function(t){return this.getPermissions().hasPermission(t)},n.prototype.hasPermissions=function(){var t,e,i;return t=1<=arguments.length?v.call(arguments,0):[],i={},e=this.getPermissions(),u.each(t,function(t){return i[h(t)]=e.hasPermission(t)}),i},n.prototype.updatePermissions=function(){return this.getPermissions().updatePermissions(this),this},n.prototype.isOwner=function(){switch(this.name){case"organization":case"project":return 2===this.get("_roleId");default:return g.user.id===this.get("_creatorId")}},n.prototype._getRoleId=function(){var t;return t=function(){var t,e;
switch(this.name){case"organization":case"project":case"member":return this.get("_roleId");default:if(this.get("_projectId"))return null!=(t=a.find(this.get("_projectId")))?t._getRoleId():void 0;if(this.get("_organizationId"))return null!=(e=r.find(this.get("_organizationId")))?e._getRoleId():void 0}}.call(this),null!=t?t:-2},n.prototype.getRoleScope=function(){var t;return t=this._getRoleId(),24===t.length?0:t>-2?+t:-2}},t.exports=o},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;r=i(787),o=i(677),s=i(788),c=[],n=$("body"),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="WindowView",e.prototype.className="modal fade",e.prototype.hotkeys={esc:function(t){return t.preventDefault(),this.close()}},e.prototype.events={scroll:"onscroll"},e.prototype.initialize=function(t){return this.options=null!=t?t:{},this.options.cssClass&&this.$el.addClass(this.options.cssClass),this},e.prototype.delegateModalEvents=function(){return this.$el.on("shown.bs.modal",function(t){return function(){return t.onOpen()}}(this)),this.$el.on("hidden.bs.modal",function(t){return function(){var e;return"function"==typeof(e=t.options).onRemove&&e.onRemove(),t.remove()}}(this)),this},e.prototype.open=function(t,e){var i,o;return null==e&&(e={}),o=c[0],c.unshift(this),this.$el.one("showing.bs.modal",function(t){return function(e){var i,n,r,s;if(o&&(s=parseInt(o.$el.css("z-index"),10)+1,i=$(e.target).data("bs.modal"),null!=(n=i.$backdrop)&&n.css("z-index",s-1),t.$el.css("z-index",s)),null!=t.options.cssClass)return null!=(r=$(e.target).data("bs.modal").$backdrop)?r.addClass(t.options.cssClass).one("click",function(){return t.close()}):void 0}}(this)),e.parentView=this,this.currentView=this.requestSubView(t,e),this.renderDialog?this.renderDialog(this.currentView):this.$el.html(this.currentView.$el),e.isAnimation===!1&&this.$el.removeClass("fade"),this.delegateModalEvents(),n.addClass("modals-open"),i=null==(null!=e?e.backdrop:void 0)||e.backdrop,this.modal=this.$el.modal({keyboard:!1,backdrop:i}).data("bs.modal"),r.add(this),this},e.prototype.onscroll=function(t){var e;return"function"==typeof(e=this.currentView).onscroll?e.onscroll(t):void 0},e.prototype.close=function(){var t;return null!=(t=this.modal)&&t.hide(),this},e.prototype.onOpen=function(){var t,e,i;return $(document).off("focusin.bs.modal"),null!=(t=this.currentView)&&"function"==typeof t.onOpen&&t.onOpen(),null!=(e=this.currentView)&&null!=(i=e.options)&&"function"==typeof i.onOpen&&i.onOpen(),this},e.prototype.remove=function(){var t,i,s,a;return null!=(t=this.modal)&&t.removeBackdrop(),null!=(i=this.currentView)&&"function"==typeof i.onClose&&i.onClose(),null!=(s=this.currentView)&&null!=(a=s.options)&&"function"==typeof a.onClose&&a.onClose(),o.removeItem(c,this),r.remove(this),c.length||($(".modal-backdrop").remove(),n.removeClass("modals-open modal-open")),e.__super__.remove.apply(this,arguments)},e}(s)},function(t,e,i){var n,r,o,s,a,c,l,p=[].slice;o=i(358),r=i(440),n=$("body").data("hotkeys",{}),c={},l=function(){},r.stopCallback=function(t,e,i){return"esc"!==i&&("INPUT"===e.tagName||"SELECT"===e.tagName||"TEXTAREA"===e.tagName||e.contentEditable&&"true"===e.contentEditable)},s=function(t,e){var i,o;for(i=c[e][0];!i.data("hotkeys");)c[e].shift(),i=c[e][0];return o=i.data("hotkeys")[e],o?o(t,e):i===n?r.unbind(e):void 0},t.exports=a={add:function(t){var e,i;return t||t.hotkeys?(i=o.clone(t.hotkeys),e=t.$el||n,o.each(t.preventHotkeys,function(t){return i[t]=l}),o.each(i,function(a,l){var p,u;if(null==(p=t.currentView)||null==(u=p.hotkeys)||!u[l])return o.isFunction(a)||(a=t[a]),a&&o.isFunction(a)?(a=o.bind(a,t),l=l.split("|"),o.each(l,function(t){if(i[t]=a,r.bind(t,s),c[t]||(c[t]=[n]),e!==n)return c[t]=o.without(c[t],e),c[t].unshift(e)})):delete i[l]}),e===n?o.extend(n.data("hotkeys"),i):e.data("hotkeys",i),this):this},remove:function(){var t,e,i,r,s;return e=arguments[0],r=2<=arguments.length?p.call(arguments,1):[],e?(s=!r.length,t=e.$el||n,i=t.data("hotkeys"),s&&(r=o.keys(e.hotkeys||{})),i&&o.each(r,function(e){if(delete i[e],s&&t!==n)return c[e]=o.without(c[e],t)}),this):this},reset:function(){return r.reset(),n.data("hotkeys",{}),c={},this}}},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty,h=[].slice;l=i(358),p=i(678),n=i(357),s=i(787),c=i(677),a=function(){return'<div class="loading-indicator">\n  <span class="loader-dot"></span>\n  <span class="loader-dot"></span>\n  <span class="loader-dot"></span>\n</div>'},o=function(){return'<div class="end-point-wrapper">\n  <span class="end-point"></span>\n</div>'},t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.hotkeys={},e.prototype.routes={},e.prototype.setupHotKey=function(){return s.add(this),this},e.prototype.removeHotKey=function(){return s.remove(this),this},e.prototype.requestSubView=function(t,e){var i,n;return e||(e={}),i=t.Constructor||t,n=new i(e),n.parentView=this,"function"==typeof n.setupHotKey&&n.setupHotKey(),this.subViews||(this.subViews=[]),this.subViews.push(n),n},e.prototype.removeSubViews=function(){var t,e,i;if(t=1<=arguments.length?h.call(arguments,0):[],i=this.subViews){for(l.each(t,function(t){return c.removeItem(i,t)});i.length;)null!=(e=i.pop())&&e.remove();this.subViews=t}return this},e.prototype.resetView=function(){return this._resetView(),this},e.prototype._resetView=function(){var t;return this.stopListening(),"function"==typeof this.removeSubViews&&this.removeSubViews(),null!=(t=this.$el)&&t.empty(),this},e.prototype.remove=function(){var t;return this.$el?(p.hook.removeLog(this),this.removeHotKey(),this.deregisterAsResponsive(),this._resetView(),this.$el&&this._removeElement(),(null!=(t=this.parentView)?t.subViews:void 0)&&c.removeItem(this.parentView.subViews,this),l.each(this,function(t){return function(e,i){return t[i]=null}}(this)),this):this},e.prototype.registerAsResponsive=function(){return p.APP.responsiveViews[this.cid]=this,this},e.prototype.deregisterAsResponsive=function(){return delete p.APP.responsiveViews[this.cid],this},e.prototype.delegateEventsOnElement=function(t,e){var i;return e&&(this.$el=e),i=n.View.prototype.delegateEvents.apply(this,arguments),e&&(this.$el=$(this.el)),i},e.prototype.undelegateEventsOnElement=function(t){var e;return t&&(this.$el=t),e=n.View.prototype.undelegateEvents.apply(this,arguments),t&&(this.$el=$(this.el)),e},e.prototype.setupPlaceholder=function(t,e){var i;return i=function(i){return function(){return t.length?i.$placeholder?i.hidePlaceholder(e):void 0:i.showPlaceholder(e)}}(this),this.listenTo(t,"add remove",i),l.delay(function(){return i()})},e.prototype.showPlaceholder=function(t){var e;return this.$el.addClass("empty"),null!=(e=this.$placeholder)&&e.remove(),this.$placeholder=$("<div class='no-"+t+"-placeholder placeholder'></div>").appendTo(this.$el)},e.prototype.hidePlaceholder=function(){var t;return this.$el.removeClass("empty"),null!=(t=this.$placeholder)&&t.remove(),delete this.$placeholder},e.prototype.showLoadingIndicator=function(t,e){var i;return null==t&&(t=this.$el),i=(null!=e?e.isPrepend:void 0)?"prependTo":"appendTo",this.hasOwnProperty("$loadingIcons")||(this.$loadingIcons=[]),this.$loadingIcons.push($(a())[i](t)),this},e.prototype.hideLoadingIndicator=function(t,e){var i;return(null!=t?t.find:void 0)?i=[t.find(".loading-indicator")]:(e=t,this.hasOwnProperty("$loadingIcons")&&(i=this.$loadingIcons)),(null!=e?e.animated:void 0)?l.each(i,function(t){return t.animate({opacity:0,height:0},function(){return null!=t?t.remove():void 0})}):l.each(i,function(t){return t.remove()}),this},e.prototype.showEndPoint=function(t){var e;return null==t&&(t=this.$el),null!=(e=this.$endPoint)&&e.remove(),this.$endPoint=$(o()).appendTo(t),this},e.prototype.triggerHook=function(t){return p.hook.trigger(this.viewName+"_"+t,this)},e}(n.View)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S,I,z,P,D,O,N,E,A,L,V,R,F,q,H,B,U=function(t,e){function i(){this.constructor=t}for(var n in e)W.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},W={}.hasOwnProperty,J=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};L=i(358),o=i(357),B=i(678),V=i(679),u=i(787),S=i(686),v=i(790),O=i(788),D=i(677),c=i(401),A=i(792),y=i(794),M=i(982),m=i(699),f=i(1295),k=i(684),x=i(696),I=i(1053),P=i(994),p=i(1297),d=i(1298),h=i(1049),g=i(1455),C=i(1501),b=i(1795),j=i(1902),N=i(786),E=i(1907),z=i(1909),T=i(1910),l=i(1911),a=i(1912),H=i(1913),R=i(1914),_=i(783).PLUGIN_URL,s=i(1305),w={task:z,post:T,event:l,entry:a},n=$(window),F=RegExp(window.location.host+"/(projects|project/|organizations|organization/)"),q=RegExp(V.ACCOUNT_HOST+"/login"),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return U(e,t),e.prototype.viewName="AppView",e.prototype.el=$("body"),e.prototype.responsiveViews={},e.prototype.hotkeys={h:"backToPortal","shift+m":"openMdHelper",backspace:function(t,e){return t.preventDefault()}},e.prototype.events={"click .open-inbox-chat":"onOpenChatWindow","click .readable a, a.url-handler, .routeLinks a, .url":"linkHandler","click .show-bookmark-hint":"showBookmarkEssage"},e.prototype.initialize=function(){var t;return this.$content=$("#content"),this.setup(),this.tbClientSupport(),this.projectsCollection=x.get(0),this.messagesCollection=f.get(B.user.id),this.messagesCollection.listen(),this.listen(),t=L.throttle(function(t){return function(){return t.layout()}}(this),500),n.resize(t),t(),u.add(this),this},e.prototype.setup=function(){return this.navigation=this.requestSubView(g),this.renderWorksBgUploader()},e.prototype.tbClientSupport=function(){if(null!=window.WebExtensionWin10)return window.clientEvents=L.extend({},o.Events),window.tbClientHandlers={gotoMessage:function(t){return function(e){var i,n;return n=JSON.parse(e),"function"==typeof(i=t.getNotificationCallback(n))?i():void 0}}(this)}},e.prototype.reset=function(){return this.removeSubViews(),this.panelView=null,this.navigation=null,this.activityPanel=null,this.worksBgUploader=null,this.currentView=null,this.projectModel=null,this.organizationModel=null,this.currentAppName="",this.setup()},e.prototype.listen=function(){var t;return t=":new:notifications",S.off(t),S.on(t,function(t){return function(e){var i,n,r;if("alarm"===e.icon?e.icon=H:D.isUrl(e.icon)||(e.icon=R),r=B.PREFERENCE.get("screenedMessages")||[],n=e._messageId,!(J.call(r,n)>=0))return null!=window.WebExtensionWin10?"function"==typeof(i=window.WebExtensionWin10).showNotification?i.showNotification(JSON.stringify(e)):void 0:v.show(e,t.getNotificationCallback(e))}}(this)),this.listenTo(this.projectsCollection,"remove",function(t){return function(e){if(t._projectId===e.id)return t.backToPortal()}}(this)),this},e.prototype.getNotificationCallback=function(t){return function(e){return function(){var i,n,r;if(window.focus(),t._messageId&&"pm"===t.msgType?s.open({hasRequested:!1,activeMessageId:t._messageId}):s.close(),t._messageId&&"pm"!==t.msgType&&(r=t.isLater?"later":"normal",i={_messageId:t._messageId,_type:r},null!=(n=B.APP.Float)&&n.open(d,i)),!t._messageId)return"user"===t.objectType?B.router.navigate("project/"+t._projectId,{trigger:!0}):e.openObjectPreviewer(t._objectId,t.objectType)}}(this)},e.prototype.resetBeforeEnter=function(t){var e;if(this.removeSubViews(this.navigation,this.worksBgUploader,this.currentView),this.Float=this.requestSubView(p),this.projectModel&&(this.lastProjectModel=this.projectModel),this.projectModel=null,this.organizationModel=null,this.setDataCategory(this.currentAppName),!t)return null!=(e=this.currentView)&&e.remove(),this.currentView=null},e.prototype.enterPortal=function(t){return this.currentAppName="portal",this.resetBeforeEnter(),this.renderCurrentView(j,t)},e.prototype.enterProject=function(t,e,n){var r,o,s,a,c,l;return a=(null!=(c=this.projectModel)?c.id:void 0)===t.id,this.currentAppName=e,this.resetBeforeEnter(a),this.projectModel=t,r=this.projectModel.get("_organizationId"),r&&null!=(l=k.getOne(0,r))&&l.joinRoom(),o=t.get("_roleId"),s=V.FEATURES.plugins&&("string"==typeof o||o>=0),s&&e===_?!function(e){return function(){return e.enterProjectAppPlugin(t.id,n)}}(this)(i):(s&&!function(){var e;return e=i(1740),e.initProject(t.id)}(i),this.showLoadingIndicator(this.$content),this.renderProjectApp(t.id,n))},e.prototype.enterProjectAppPlugin=function(t,e){var n;return n=i(1740),this.showLoadingIndicator(this.$content),n.initProject(t).then(function(i){return function(){return i.renderProjectApp(t,e)}}(this))},e.prototype.renderProjectApp=function(t,e){return this.loadProjectDatas(t).then(function(t){return function(){return t.hideLoadingIndicator(),t.currentView||t.renderCurrentView(C,e),t.currentView.renderApp(t.currentAppName,e),$("body").scrollTop(0)}}(this))["catch"](function(t){return function(e){return console.error(e),t.backToPortal()}}(this))},e.prototype.enterOrganization=function(t,e){var n,r,o,s,a,c;return a=t.id,s=(null!=(c=this.organizationModel)?c.id:void 0)===a,this.currentAppName="organization",this.resetBeforeEnter(s),r=null,e.routeString.indexOf("projects")>=0?r="Org Projects Page":e.routeString.indexOf("members")>=0?r="Org Members Page":e.routeString.indexOf("reports")>=0?r="Org Reports Page":e.routeString.indexOf("statistics")>=0&&(r="Org Dashboards Page"),L.delay(function(){return B.gta.setCurrentPage(r)}),n=t.get("_roleId"),o=V.FEATURES.plugins&&("string"==typeof n||n>=0),this.organizationModel=t,this.organizationModel.joinRoom(),o&&~e.routeString.indexOf(_)?!function(n){return function(){var r;return r=i(1740),r.initOrg(t.id).then(function(){return n.renderCurrentView(b,e)})}}(this)(i):(this.renderCurrentView(b,e),o?!function(){var e;return e=i(1740),e.initOrg(t.id)}(i):void 0)},e.prototype.layout=function(){var t,e,i,r,o;if(null!=(i=this.appSwitcherView)&&i.refreshNavs(),e=n.height(),this.$el.css("min-height",e-50),!L.isEmpty(this.responsiveViews)){r=this.responsiveViews;for(t in r)o=r[t],"function"==typeof o.layout&&o.layout(e);return this}},e.prototype.onOpenChatWindow=function(t){var e,i;if(e=$(t.currentTarget),i=e.data("id"))return t.preventDefault(),e.parent().is(".essage")&&c.hide(),s.open({hasRequested:!1,activeObjectId:i})},e.prototype.linkHandler=function(t){var e,i,n,r;if(n=t.currentTarget,e=$(n),r=n.href||e.data("url"),!$(n).closest(".post-editor-textarea").length&&r)return t.preventDefault(),e.parent().is(".essage")&&c.hide(),F.test(n.href)?(i=n.pathname.split("/").slice(1),"project"===i[0]?x.fetchOne(0,i[1],{success:function(t){return function(){return t.Float.close(),B.router.navigate(n.pathname,{trigger:!0})}}(this),error:function(){return c.show({message:tb_i18n.get("noRight.view"),status:"error"})}}):(this.Float.close(),B.router.navigate(n.pathname,{trigger:!0}))):q.test(n.href)?B.router.gotoLogin():window.open(n.href)},e.prototype.showBookmarkEssage=function(t){var e,i;return e=$("body").hasClass("mac")?" Command + D ":e=" Ctrl + D ",B.gta.event($("body").data("category"),"click","bookmark"),i="portal"===$("body").data("category")?tb_i18n.get("portal.project.star.bookmark.hint",e):tb_i18n.get("portal.project.star.bookmark.hint.project",e),c.hide().show({message:i,status:"success"},5e3),this},e.prototype.backToPortal=function(){if(!B.user.get("isGhost"))return B.router.navigate("projects",{trigger:!0}),!1},e.prototype.renderCurrentView=function(t,e){var i;return e.onError=function(){return B.router.home()},null!=(i=this.currentView)&&i.remove(),this.currentView=this.requestSubView(t,e),this.currentView.$el.appendTo(this.$content),B.router.checkRoute(e.routeString,this.currentView),this},e.prototype.renderWorksBgUploader=function(t){var e;return null!=(e=this.worksBgUploader)&&e.remove(),this.worksBgUploader=this.requestSubView(E,t),this.worksBgUploader.$el.appendTo(this.$el),this},e.prototype.showPanel=function(t,e){var i,n;return(null!=(i=this.panelView)?i.isIn:void 0)?this.panelView.isSame(e)?this.panelView.hide():this.panelView.hide(function(i){return function(){return i.panelView.remove(),i.panelView=i.requestSubView(t,e),i.panelView.show()}}(this)):(null!=(n=this.panelView)&&n.remove(),this.panelView=this.requestSubView(t,e),this.panelView.show())},e.prototype.hidePanel=function(){var t;if(null!=(t=this.panelView)?t.isIn:void 0)return this.panelView.hide(function(t){return function(){return t.panelView=null}}(this))},e.prototype.loadProjectDatas=function(t){return Promise.all([new Promise(function(e,i){return m.fetch(t,{attrs:{users:1},boundToObjectType:"project",success:e})}),new Promise(function(e,i){return I.fetch(t,{success:e})}),new Promise(function(e,i){return P.fetch(t,{success:e})})])},e.prototype.openMdHelper=function(){var t;return null!=(t=this.markdownHelperView)&&t.remove(),this.markdownHelperView=this.requestSubView(N).open(h),this},e.prototype.dynamicTitle=function(){var t,e,i,n,r,o;return e=B.router.getUrl().split("/"),"project"===e[0]&&(o=null!=(i=this.projectsCollection.get(e[1]))?i.get("name"):void 0),o=o?o+" · Teambition":tb_i18n.get("teambition.title"),(null!=(n=B.favico)?n.browser.supported:void 0)||(t=null!=(r=B.user)?r.get("normal"):void 0),document.title=t?"("+t+")"+o:o,this},e.prototype.setDataCategory=function(t){var e,i;return t=t||this.currentAppName,i={portal:"Projects Page",organization:"Organization Page",my:"Me Page",calendar:"Calendar Page",inbox:"Inbox Page",tasks:"Tasks Page",posts:"Posts Page",events:"Events Page",works:"Works Page",tags:"Tags Page",bookkeeping:"Bookkeeping Page"},e=J.call(L.keys(i),t)>=0?i[t]:t,L.delay(function(i){return function(){var n,r;return B.gta.setCurrentPage(e),null!=(n=i.$el)&&n.data("category",t),null!=(r=i.$el)?r.attr("data-category",t):void 0}}(this))},e.prototype.getClosestProject=function(){var t,e,i,n,r;if(r=this.projectModel||this.lastProjectModel,!(r&&r.getRoleScope()>=0))for(n=x.get(0).models,t=0,e=n.length;t<e;t++)if(i=n[t],i.getRoleScope()>=0){r=i;break}return r},e.prototype.openObjectPreviewer=function(t,e,i){var n,r;return null==i&&(i={}),n=w[e],r=B.PREFERENCE.getIsUsePanelToOpenTask(),"work"===e?L.isArray(t)?this.openWorksPreviewer(t[0],t,i):this.openWorksPreviewer(t,[t],i):i.isUsePanel&&r&&n?(i=L.extend({},i,{objectType:e}),L.isObject(t)?(i[e+"Model"]=t,i["_"+e+"Id"]=t.id):i["_"+e+"Id"]=t,this.showPanel(n,i)):(i=L.extend({},i,{isAnimation:!1,objectId:t,objectType:e,fixedModal:!0}),L.isObject(t)&&(i.objectModel=t,i.objectId=t.id),this.requestSubView(N).open(y,i))},e.prototype.openTaskPreviewer=function(t,e){return this.openObjectPreviewer(t,"task",e)},e.prototype.openEventPreviewer=function(t,e){return this.openObjectPreviewer(t,"event",e)},e.prototype.openPostPreviewer=function(t,e){return this.openObjectPreviewer(t,"post",e)},e.prototype.openEntryPreviewer=function(t,e){return this.openObjectPreviewer(t,"entry",e)},e.prototype.openWorksPreviewer=function(t,e,i){var n,r,o;return e||(e=[t]),n=null,r=[],o=e.map(function(e,i){return new Promise(function(o,s){return A.fetch(e,{success:function(e){return r[i]=e,e.id===t&&(n=e),o()},error:s})})}),Promise.all(o).then(function(t){return function(){return i=L.extend({},i,{isAnimation:!1,_projectId:n.get("_projectId"),workModel:n,workModels:r}),t.requestSubView(N).open(M,i)}}(this))},e}(O)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d;s=i(358),n=i(791),o=i(681),l=o.namespace("desktopNotification"),p="disableDesktopNotification",a=[],r=window.Notification||window.webkitNotifications,d=function(){return!!r},c=function(){return r.permission?"granted"===r.permission:0===r.checkPermission()},u=function(t){return r.requestPermission(t)},t.exports={support:function(){return d()},hasPermission:function(){if(d())return!l(p)&&c()},setup:function(t){var e;if(d()&&(t&&a.push(t),null==(e=this.$modal)||!e.closest("body").length))return this.$modal=$(n()).appendTo("body"),this.$modal.find(".request-permission-btn").one("click",function(t){return function(){return l(p,!1),t.$modal.remove(),u(function(t){var e;if("denied"===t)return a.length=0,l(p,!0);for(e=[];a.length;)e.push(a.shift()());return e})}}(this)),this.$modal.find(".cancel-setup-btn").one("click",function(t){return function(){return t.$modal.remove(),a.length=0,l(p,!0)}}(this)),this.$modal.find(".close-modal-btn").one("click",function(t){return function(){return t.$modal.remove()}}(this))},show:function(t,e){if(d())return this.hasPermission()?s.delay(function(){var i,n;if(!t.notificationId||!l(t.notificationId))return i=r.createNotification?r.createNotification(t.icon,t.title,t.content):new r(t.title,{tag:t.notificationId,body:t.content,icon:t.icon}),n=null,i.onclick=function(){return clearTimeout(n),"function"==typeof i.cancel&&i.cancel(),"function"==typeof i.close&&i.close(),"function"==typeof e?e():void 0},"function"==typeof i.show&&i.show(),n=setTimeout(function(){return"function"==typeof i.cancel&&i.cancel(),"function"==typeof i.close?i.close():void 0},4e3),t.notificationId&&l(t.notificationId,!0,2)},3e3*Math.random()):l(p)?void 0:this.setup(function(i){return function(){return i.show(t,e)}}(this))}}},function(t,e){t.exports=function(t){var e='<div class="notification-modal modal"> <div class="modal-dialog card"> <div class="card-header"> <a class="close-modal-btn icon icon-remove pull-right" data-dismiss="modal"></a> <p class="card-title">'+tb_i18n.get("desktop.notification")+'</p> </div> <div class="card-content"> <p class="description">'+tb_i18n.get("desktop.notification.desc")+'</p> <hr> <button class="request-permission-btn btn btn-primary btn-block">'+tb_i18n.get("desktop.notification.enable")+'</button> <button class="cancel-setup-btn btn btn-block">'+tb_i18n.get("desktop.notification.disable")+'</button> </div> </div></div><div class="notification-modal-backdrop modal-backdrop"></div>';return e}},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;c=i(358),l=i(678),n=i(793),r=i(688),o=i(686),s=i(677),a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.name="work",e.prototype.urlRoot="works",e.prototype.intervalTime=6e5,e.prototype.defaults={objectType:"work",activitiesCount:0,description:"",involveMembers:[]},e.prototype.listen=function(){if(!this.listenedLock&&this.id)return this.listenedLock=!0,this.on("change:visible",function(t){var e;if(!t.checkIsVisible())return null!=(e=t.collection)?e.remove(t):void 0}),e.__super__.listen.apply(this,arguments)},e.prototype.parse=function(t){return t=c.extend(this.toJSON(),t),t.fileSize||(t.fileSize=t.size),t.thumbnail||(t.thumbnail=t.thumbnailUrl),t.thumbnailUrl||(t.thumbnailUrl=t.thumbnail),delete t.size,delete t.code,delete t.message,t},e.prototype.createVersion=function(t,e){var i;return null==t&&(t={}),null==e&&(e={}),e||(e={}),e.url=this.url()+"/versions",e.attrs=c.extend({},t,e.attrs),/^http/.test(e.attrs.thumbnailUrl)||(delete e.attrs.thumbnail,delete e.attrs.thumbnailUrl),i=e.success||function(){},e.success=function(t){return function(e){return t.set(e.current),i(t),o.trigger(":new:versions/"+t.get("_id"),e.last)}}(this),e.wait||this.set(e.attrs),this.sync("create",this,e)},e.prototype.intervalFetch=function(t){var e,i;return null==t&&(t={}),e=(new Date).getTime(),i=e-this.lastIntervalFetchTime,i<this.intervalTime?"function"==typeof t.success?t.success(this):void 0:(this.lastIntervalFetchTime=e,this.fetch(t))},e.prototype.forkToCollection=function(t,e){return this.forkOrMoveToCollection(t,"fork",e)},e.prototype.moveToCollection=function(t,e){return this.forkOrMoveToCollection(t,"move",e)},e.prototype.forkOrMoveToCollection=function(t,e,i){return null==i&&(i={}),i.url=this.url()+"/"+e,i.attrs={_parentId:t._boundToObjectId},this.sync("update",this,i)},e.prototype.getParent=function(t){var e;return e=this.get("_parentId"),e?n.fetch(e,{success:t,error:function(){return t(null)}}):t(null)},e.prototype.getFormatData=function(){var t;return t=this.toJSON(),t=e.formatWork(t)},e}(r),a.formatWork=function(t){var e,i;return null==t&&(t={}),t=c.extend({},t,{isCreator:t._creatorId===l.user.id,fileSizeFix:s.formatFileSize(t.fileSize||0),fileNameFix:(null!=(e=t.fileName)?e.replace(/\.[^.]*$/,""):void 0)||""}),t.thumbnail||(t.thumbnail=t.thumbnailUrl),t.thumbnailText=t.fileType,/link/.test(t.fileCategory)&&(t.thumbnailText="link"),(null!=(i=t.thumbnailText)?i.length:void 0)>4&&(t.thumbnailText="<h3>"+t.thumbnailText.substr(0,1).toUpperCase()+"</h3>"),t},t.exports=a},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=i(358),r=i(688),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.name="collection",e.prototype.urlRoot="collections",e.prototype.defaults={objectType:"collection",_projectId:"",_creatorId:"",created:"",updated:"",title:"",color:"blue",description:"",workCount:0,collectionType:"",recentWorks:[]},e.prototype.parse=function(t){return t=o.extend(this.toJSON(),t),"default"===t.collectionType&&(t.title=tb_i18n.get("library.default.collection")),"root"===t.collectionType&&(t.title=tb_i18n.get("library.title")),t.subCount=t.workCount+(t.collectionCount||0),t},e.prototype.getParent=function(t){var i;return i=this.get("_parentId"),i||i!==this.get("_projectId")?e.fetch(i,{success:t,error:function(){return t(null)}}):t(null)},e.prototype.moveToCollection=function(t,e){var i;return i=this.collection,this.saveAttr("move",null,{attrs:{_parentId:t._boundToObjectId},beforeSend:function(){return null!=e&&"function"==typeof e.beforeSend?e.beforeSend():void 0},success:function(n){return function(r){return null!=i&&i.remove(n),t.add(n),null!=e&&"function"==typeof e.success?e.success():void 0}}(this),error:function(){return null!=e&&"function"==typeof e.error?e.error():void 0}})},e}(r)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_=function(t,e){function i(){this.constructor=t}for(var n in e)j.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},j={}.hasOwnProperty;b=i(358),k=i(678),v=i(788),c=i(688),w=i(530),o=i(401),n=i(795),s=i(1228),u=i(1277),m=i(1285),y=i(982),f=i(803),a=i(817),d=i(1042),r=i(1265),h=i(696),l=i(1294),g={task:m,event:s,post:u,work:y,entry:n},p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return _(e,t),e.prototype.viewName="ObjectModalView",e.prototype.className="object-modal-view modal-dialog card",e.prototype.events={"click .close-handler":"remove"},e.prototype.initialize=function(t){return null==t&&(t={}),this.options=t,this.parseOptions(t),this.renderDetail(),t.fixedModal&&this.$el.addClass("fixed"),this},e.prototype.renderDetail=function(){var t;return t=this.options.success||function(){},this.options.success=function(e){return function(i){return b.delay(function(){if(e.$el)return e.$detail.find(".detail-content").append('<a class="close-handler icon icon-remove"></a>'),e.$detail.find(".hack-render-bug").removeClass("hack-render-bug"),e.renderNav(),t(i)})}}(this),this.options.error=function(t){return function(e){return delete w.getData().models[t.objectId],delete w.getData().matrix[t.objectId],o.show({message:tb_i18n.get("authority.get.error"),hint:tb_i18n.get("authority.get.error.content"),status:"error"})}}(this),this.detailSubView=this.requestSubView(this.DetailView,this.options),this.$detail=this.detailSubView.$el.addClass("modal-detail"),"work"===this.objectType?this.$el=this.$detail:this.$el.append(this.$detail),this},e.prototype.renderNav=function(){if(this.options.hasLink!==!1)return this.fetchObjectModel({success:function(t){return function(e){var i,n,r,o,s;if(t.$el&&(n=e.get("_projectId"),s="/project/"+n,r=h.get(0).get(n))){switch(o=r.get("name")||"",i=[{url:""+s,title:""+tb_i18n.get("inbox.go.to.project")+o}],t.objectType){case"task":i.push({url:s+"/tasks/scrum/"+e.get("_tasklistId"),title:tb_i18n.get("inbox.go.to.task")});break;case"post":i.push({url:s+"/posts/post/"+e.id,title:tb_i18n.get("inbox.go.to.post")});break;case"event":i.push({url:s+"/events",title:tb_i18n.get("inbox.go.to.event")});break;case"entry":i.push({url:s+"/bookkeeping",title:tb_i18n.get("inbox.go.to.entry")})}return t.$el.prepend(l(i))}}}(this)}),this},e.prototype.parseOptions=function(t){var e,i,n,r,o;return null==t&&(t={}),i=t.objectModel,i?(e=t.objectId||i.id,n=t.objectType||i.get("objectType"),r=t._projectId||i.get("_projectId")):(e=t.objectId,n=t.objectType),this.DetailView=t.DetailView||g[n],this.objectId=e,this.objectType=n,o=b.omit(t,"_projectId","objectType","objectId","DetailView"),o["_"+t.objectType+"Id"]=e,o[t.objectType+"Model"]=i,o.where=t.where||"object-modal",this.options=o,this},e.prototype.fetchObjectModel=function(t){var e,i;switch(i=this.objectType,e=this.objectId,i){case"task":return f.fetch(e,t);case"event":return a.fetch(e,t);case"post":return d.fetch(e,t);case"entry":return r.fetch(e,t);default:return c.fetch(e,t)}},e.prototype.remove=function(){var t,i;return"WindowView"===(null!=(i=this.parentView)?i.viewName:void 0)&&(this.parentView.close?this.parentView.close():"function"==typeof(t=this.parentView).remove&&t.remove()),e.__super__.remove.apply(this,arguments)},e}(v),e.Constructor=p},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M=function(t,e){return function(){return t.apply(e,arguments)}},C=function(t,e){function i(){this.constructor=t}for(var n in e)x.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},x={}.hasOwnProperty;T=i(678),r=i(796),_=i(677),j=i(788),c=i(1264),f=i(1265),b=i(697),l=i(1266),u=i(1267),d=i(1268),n=i(809),m=i(1270),g=i(1229),y=i(1021),p=i(983),k=i(1151),a=i(1275),v=i(1276),s=i(1185),w=i(1188),o=i(1186),t.exports=h=function(t){function e(){return this._innerPinBarHandler=M(this._innerPinBarHandler,this),e.__super__.constructor.apply(this,arguments)}return C(e,t),e.prototype.viewName="EntryDetailView",e.prototype.tagName="div",e.prototype.className="entry-detail-view thin-scroll fade",e.prototype.events={"click .menu-handler":"toggleMenu","mousewheel .detail-content":_.mousewheel,"click .unarchive-handler":"openUnarchiveMenu","click .remove-handler":"deleteModelObject"},e.prototype.initialize=function(t){if(!(null!=t?t._entryId:void 0))throw new Error("wrong options");return this.options=t,this._entryId=t._entryId,this.load().then(function(t){return function(){var e;return t.$el.addClass("in"),t.renderBasic(),t.listen(),t.renderHeader(),t.renderInfos(),t.renderArchivedBadge(),t.renderActivities(),t.renderActivitiyCreator(),"function"==typeof(e=t.options).success?e.success(t):void 0}}(this))["catch"](function(t){return function(e){var i;return"function"==typeof(i=t.options).error&&i.error(t),t.close(),console.error(e)}}(this))},e.prototype.load=function(){return this.showLoadingIndicator(),new Promise(function(t){return function(e,i){return f.fetch(t._entryId,{success:function(i){return t.entryModel=i,t._projectId=t.entryModel.get("_projectId"),e()},error:i})}}(this)).then(function(t){return function(){return new Promise(function(e,i){return l.fetch(t._projectId,{success:function(i){return t.bookkeepingModel=i.models[0],t.displayFields=t.bookkeepingModel.getDisplayFields(),e()},error:i})})}}(this)).then(function(t){return function(){return new Promise(function(e,i){return d.fetch(t._projectId,{success:function(i){return t.entryCategoriesCollection=i,e()},error:i})});
}}(this)).then(function(t){return function(){return t.hideLoadingIndicator()}}(this))},e.prototype.listen=function(){var t;return this.stopListening(),this.options.onEventDelete&&this.listenTo(this.entryModel,"remove",this.options.onEventDelete),this.options.onEventChange&&this.listenTo(this.entryModel,"change",this.options.onEventChange),this.listenTo(this.entryModel,"remove destroy",function(t){return function(){var e;return"function"==typeof(e=t.options).onUnfavorite&&e.onUnfavorite(t.entryModel.get("_id")),t.close()}}(this)),t="change:content change:category change:date change:amount",this.listenTo(this.entryModel,t,this.renderHeader),this.listenTo(this.entryModel,"change:isArchived",this.renderArchivedBadge),this.listenTo(this.entryModel,"change:status",function(){return this.renderInfos(),this.renderActivities()}),this},e.prototype.renderBasic=function(){return this.$el.html(a()),this.$activityCreator=this.$(".activity-creator-wrapper"),this.$detailContent=this.$(".detail-content"),this},e.prototype.renderHeader=function(){var t,e,i;return e=this.entryModel.toJSON(),e.approveRight=this.bookkeepingModel.get("approveRight"),e.permissions=this.entryModel.hasPermissions("put","put.archive","put.visible","del"),e.category=this.entryCategoriesCollection.getCategory(e._entryCategoryId).toJSON(),e.creator||(e.creator={}),e.dateStr=(null!=(i=_.formatDate(e.date))?i.dateString:void 0)||"",t=this.$(".entry-detail-header-wrap"),t.html(v(e)),this},e.prototype.renderArchivedBadge=function(){var t;return t={isArchived:this.entryModel.get("isArchived"),text:tb_i18n.get("bookkeeping.archived"),cancel:tb_i18n.get("unarchive"),deleted:tb_i18n.get("entry.menu.action.delete"),permissions:this.entryModel.hasPermissions("put.archive","del")},this.$(".archived-wrapper").html(s(t)),this.$el[t.isArchived?"addClass":"removeClass"]("archived"),this},e.prototype.renderInfos=function(){var t;return t={objectModel:this.entryModel,boundToObjectType:"entry",infos:["note","link","tag"]},"approved"===this.entryModel.get("status")&&(t.disabledItems=["note","tag"]),this.infosView=this.requestSubView(p,t),this.$(".entry-detail-infos-wrap").html(this.infosView.$el),this.$detailContent.off("scroll",this._innerPinBarHandler).on("scroll",this._innerPinBarHandler),this},e.prototype._innerPinBarHandler=function(){return k.trigger("noteEditorToolBarScroll",this.$detailContent)},e.prototype.renderActivities=function(){return this.activityTimelineView=this.requestSubView(r,{boundToObjectType:"entry",_projectId:this._projectId,objectModel:this.entryModel,$scrollFrame:this.$(".detail-content"),where:this.options.where,disableMemberActions:"approved"===this.entryModel.get("status"),success:function(t){return function(){return t.activityCreatorView.show()}}(this)}),this.listenTo(this.activityTimelineView,"toggleOnlyCommentsBtn",function(t){return function(e){var i;return null!=(i=t.activityCreatorView)?i.toggleOnlyCommentsBtn(e):void 0}}(this)),this.$(".detail-activities-wrap").html(this.activityTimelineView.$el),this},e.prototype.renderActivitiyCreator=function(){return this.activityCreatorView=this.requestSubView(n,{_projectId:this._projectId,where:this.options.where,boundToObjectType:"entry",objectModel:this.entryModel}),this.listenTo(this.activityCreatorView,"filterActivities",function(t){return function(e){var i;return null!=(i=t.activityTimelineView)?i.filterActivities(e):void 0}}(this)),this.$(".activity-creator-wrapper").html(this.activityCreatorView.$el),this},e.prototype.toggleMenu=function(t){var e;return e=$(t.currentTarget),e.data("bs.popover")||this.requestSubView(m,{$toggler:e,entryModel:this.entryModel,bookkeepingModel:this.bookkeepingModel,onShown:function(t){return function(){return t.$el.addClass("active")}}(this),onHidden:function(t){return function(){return t.$el.removeClass("active")}}(this),onUnfavorite:this.options.onUnfavorite}).show(),this},e.prototype.openUnarchiveMenu=function(t){var e;return e=$(t.currentTarget),this.requestSubView(w,{$toggler:e,title:tb_i18n.get("unarchive"),currentModel:this.entryModel,msg:tb_i18n.get("unarchived.entry.success")}).show()},e.prototype.deleteModelObject=function(t){var e;return e=$(t.currentTarget),e.data("bs.popover")||this.requestSubView(o,{$toggler:e,title:tb_i18n.get("delete.entry"),confirmDelete:tb_i18n.get("entry.menu.confirm.delete"),currentModel:this.entryModel}).show(),this},e.prototype.close=function(){var t,e;return"EntryDetailPanelView"===(null!=(e=this.parentView)?e.viewName:void 0)?"function"==typeof(t=this.parentView).back&&t.back():this.remove(),this},e.prototype.remove=function(){var t,i,n;return null!=(t=this.$activityCreator)&&t.remove(),this.entryModel&&(n=T.router.getUrl().replace("/entry/"+this.entryModel.id,""),T.router.navigate(n,{trigger:!1})),"ObjectModalView"===(null!=(i=this.parentView)?i.viewName:void 0)&&this.parentView.remove(),e.__super__.remove.apply(this,arguments)},e}(j)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S=function(t,e){function i(){this.constructor=t}for(var n in e)I.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},I={}.hasOwnProperty;T=i(358),x=i(678),b=i(797),w=i(788),g=i(429),k=i(798),u=i(401),j=i(792),o=i(799),f=i(699),v=i(801),y=i(696),_=i(786),p=i(805),s=i(809),c=i(975),m=i(1002),l=i(1261),d=i(1262),h=i(1263),r=3,n=20,C=function(t){var e;return(null!=t&&null!=(e=t.get("action"))?e.indexOf("activity.comment"):void 0)>=0},M=function(t,e){var i;for(e++;e<t.length;)if(i=t[e++],C(i))return!0;return!1},a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return S(e,t),e.prototype.viewName="ActivityTimelineView",e.prototype.tagName="div",e.prototype.className="activities-timeline",e.prototype.events={"click .tab-handler":"switchTabs","click .like-toggler-handler":"toggleLike","click .like-group":"toggleGroup","click .reply-activity-handler":"mentionBuddy","click .add-involve":"addInvolve","click .add-member":"addMember","click .add-member-involve":"addMemberInvolve","click .activity-early-handler":"switchHasMore","mouseover .activities-list-wrap":"showOnlyComments","mouseleave .activities-list-wrap":"hideOnlyComments"},e.prototype.initialize=function(t){return!!((null!=t?t._projectId:void 0)&&t.objectModel&&t.boundToObjectType)&&(this.options=t,this._projectId=t._projectId,this.objectModel=t.objectModel,this.hasMore=!0,this.renderBasic(),this.setupScroll(t.$scrollFrame||this.$activitiesList),this.load().then(function(t){return function(){var e;if(t.renderActivities(),t.initInvolve(),t.getLike(),t.listen(),"function"==typeof(e=t.options).success&&e.success(t),"inbox"===t.options.where||"search"===t.options.where||"activity-comment"===t.options.where)return T.delay(function(){if(t.$el)return t.scrollToBottom()},500)}}(this))["catch"](function(t){return console.error(t)}),this)},e.prototype.load=function(){var t;return t=this.objectModel.id.split("_")[0],this.showLoadingIndicator(this.$activitiesList,{isPrepend:!0}),this.collection=o.get(t,{boundToObjectType:this.options.boundToObjectType}),new Promise(function(e){return function(i,s){return o.fetch(t,{boundToObjectType:e.options.boundToObjectType,success:function(t){var o;return e.$el&&(e.collection=t,o=T.filter(e.collection.models,function(t){return C(t)&&g().isSame(t.get("created"),"day")}).length,o>n?e.activity_count=n:o<=n&&o>r?e.activity_count=o:e.activity_count=r),i()},error:s})}}(this)).then(function(t){return function(){return new Promise(function(e,i){return t.objectModel.getRoleScope()>=-1?f.fetch(t._projectId,{success:function(i){return t.membersCollection=i,e()},error:i}):e()})}}(this)).then(function(t){return function(){return t.hideLoadingIndicator()}}(this))},e.prototype.listen=function(){return this.listenTo(this.collection,"add",function(t){return function(e){var i;if(i=t.isScrollToBottom(e),t.renderActivity(e,t.collection.at(t.collection.length-2)),i)return t.scrollToBottom()}}(this)),this.listenTo(this.objectModel,"change:likesCount",this.getLike),this},e.prototype.renderBasic=function(){return this.$el.html(l({user:x.user.toJSON()})),this.$activitiesList=this.$(".activities-list"),this},e.prototype.initInvolve=function(){var t;return t=this.$(".activities-timeline-involve-set"),this.membersCollection&&this.requestSubView(m,{_projectId:this._projectId,objectModel:this.objectModel,membersCollection:this.membersCollection,saveOnHidden:!0,undeletable:!1,dropArea:t,where:"activity",disabled:this.options.disableMemberActions}).$el.prependTo(t),this},e.prototype.renderActivities=function(){var t,e,i;return t=this.calculateRestCount(),this.$el.removeClass("early-hidden early-shown early-loading"),this.$(".activity-early-hidden").text(tb_i18n.get("activity.early.hidden",t)),this.$el.addClass(this.hasMore?"early-hidden":"early-shown"),null!=(i=this.$activitiesList)&&i.empty(),this.collection.sort(),e=T.clone(this.collection.models).reverse().filter(this.getEarlyFilter()).reverse(),this.hasMore&&e.length===this.collection.length&&this.$el.removeClass("early-hidden"),e.forEach(function(t){return function(e){return t.renderActivity(e)}}(this)),this},e.prototype.renderActivity=function(t){var e;return t?(e=this.requestSubView(c,{activityModel:t,_projectId:this.options._projectId,objectModel:this.objectModel}),e.$el.appendTo(this.$activitiesList),this):this},e.prototype.rednerActivityLine=function(t,e){var i,n;if(n=g(t.get("created")).startOf("day").valueOf(),i=this.$(".activity-line[data-time="+n+"]"),!i.length)return e.before(h(n))},e.prototype.showOnlyComments=function(t){if(this.collection.where({action:"activity.comment"}).length>0)return this.trigger("toggleOnlyCommentsBtn",!0),this},e.prototype.hideOnlyComments=function(t){return this.debounceHide||(this.debounceHide=T.debounce(function(t){return function(e){var i;return i=$(e.toElement||e.relatedTarget),(null!=i?i.closest(".only-comments-btn").length:void 0)?t:t.trigger("toggleOnlyCommentsBtn",!1)}}(this),100)),this.debounceHide(t),this},e.prototype.getLike=function(){var t,e;if(t=this.getLikeLastTime,this.getLikeLastTime=e=(new Date).getTime(),!(e-t<200))return this.objectModel.getLike({attrs:{all:1},success:function(t){return function(e){return t.likeData=e,t.renderLike()}}(this)}),this},e.prototype.renderLike=function(){var t,e,i,n,r,o,s,a,c;if(t=this.$(".like-toggler-handler"),i=T.extend({likesGroup:[]},this.likeData,{language:tb_i18n.getLanguage(),oldItems:[],newItems:[],user:x.user.toJSON()}),!t||!i)return this;for(t[i.isLike?"addClass":"removeClass"]("active"),t.data("title",i.isLike?tb_i18n.get("activity.timeline.remove.like"):tb_i18n.get("activity.timeline.like")),a=this.oldLikeData||i,this.oldLikeData=i,c=i.likesGroup,n=0,o=c.length;n<o;n++)r=c[n],s=T.filter(a.likesGroup,function(t){return t._id===r._id}),s.length?i.oldItems.push(r):i.newItems.push(r);return e=this.$(".activities-timeline-like"),e.find(".like-group-wrap").remove(),e.find(".like-toggler-tips").remove(),e.append(d(i)),this},e.prototype.toggleLike=function(t){var e;return this.likeData?(e=this.likeData.isLike,this.objectModel[e?"unLike":"doLike"]({success:function(t){return function(){return t.getLike()}}(this)}),this):this},e.prototype.toggleGroup=function(t){var e;return e=$(t.currentTarget),e.toggleClass("expanding"),this},e.prototype.mentionBuddy=function(t){var e,i,n,r,o,s,a;if(e=$(t.currentTarget),o=e.closest(".activity").data("id"),r=this.collection.get(o),s=this.membersCollection.get(null!=r?r.get("_creatorId"):void 0),n=this.parentView.activityCreatorView,s&&n)return i=n.$textareaset,a=i.val(),n.checkIsAlreadyAt(s.id)?i.val(a).focusAtEnd():(i.val(a+" @"+s.get("name")+" ").focusAtEnd(),"function"==typeof n.selectAt&&n.selectAt(s.id,s.toJSON()),this)},e.prototype.addInvolve=function(t){var e;if(this.involve)return e=T.uniq(this.objectModel.get("involveMembers").slice().concat(T.keys(this.involve))),this.objectModel.saveAttr("involveMembers",e),this.$(".involve-tip-wrap").empty(),this},e.prototype.addMember=function(t){var e,i;if(this.member)return e=T.uniq(T.keys(this.member)),this.projectModel=y.getOne(0,this._projectId),i=[],f.fetch(this.projectModel.get("_organizationId"),{boundToObjectType:"organization",success:function(t){return T.filter(t.toJSON()||[],function(t){if(T.indexOf(e,t._id)>=0)return i.push(t.email)})}}),this.checkMembersFull()?this.showMemberExceed():this.membersCollection.addMember({email:i},{success:function(){return u.success({message:tb_i18n.get("activity.invisiblea.addmember.success")}),this.$(".member-tip-wrap").empty()}}),this},e.prototype.addMemberInvolve=function(t){var e;if(this.addMember(t),this.notProjectMembers)return e=T.uniq(this.objectModel.get("involveMembers").slice().concat(T.keys(this.notProjectMembers))),this.objectModel.saveAttr("involveMembers",e),this.$(".member-tip-wrap").empty(),this},e.prototype.checkMembersFull=function(){var t,e;return t=this.membersCollection.length,e=this.projectModel.getPaymentPlan().membersLimit,t>=e},e.prototype.showMemberExceed=function(){var t,e,i,n,r;return t=this.projectModel.get("_organizationId"),r=this.projectModel.getPaymentPlan().membersLimit,n=tb_i18n.get("project.settings.member.reach.limit.org",r),i=tb_i18n.get("organization.settings.add.member.toplimit"),e=k.pay.orgAddMember(t),this.requestSubView(_).open(p,{title:tb_i18n.get("project.setting.members.reach.limit"),content:n,confirmText:i,confirmHref:e}),this},e.prototype.filterActivities=function(t){var e,i;return i=["on-only-comments","on-only-attachments"],e=this.$el.removeClass(i.join(" ")),t.isOnlyComments&&e.addClass(i[0]),t.isOnlyAttachments&&e.addClass(i[1]),this},e.prototype.scrollToBottom=function(){return T.delay(function(t){return function(){return t.slideTo()}}(this)),this},e.prototype.isScrollToBottom=function(t){var e,i,n,r;return r=!1,C(t)&&t.get("_creatorId")===x.user.id&&(r=!0),C(t)&&!r&&(i=this.options.$scrollFrame,e=this.$(".activities-place-bottom"),n=e.offset().top-(i.offset().top+i.height()),r=n<100),r},e.prototype.switchHasMore=function(){var t,e,i,n,r;return t=this.options.$scrollFrame||this.$activitiesList,r=t.scrollTop(),n=t[0].scrollHeight,e=n-r,this.hasMore=!this.hasMore,this.renderActivities(),i=t[0].scrollHeight,this.hasMore?t.scrollTop(r):t.scrollTop(i-e)},e.prototype.getEarlyFilter=function(){var t,e,i,n;return n=this.hasMore?this.activity_count:Number.MAX_VALUE,t=0,i=!1,e=!1,function(i,r,o){var s;return t>=n?!e:C(i)?(s=r,e=M(o,r),t++<n):(s=r,!0)}},e.prototype.calculateRestCount=function(){var t,e;return e=this.getEarlyFilter(),t=0,this.collection.each(function(i,n,r){if(!e(i,n,r)&&C(i))return t++}),t},e.prototype.remove=function(){var t;return null!=(t=this.$activityCreator)&&t.off(".activity"),e.__super__.remove.apply(this,arguments)},e}(w),T.extend(a.prototype,b),e.Constructor=a},function(t,e,i){var n,r,o,s;s=i(358),n=$("body"),r=$(window),t.exports=o={scrollTo:function(t,e,i){var r;return this.$scrollFrame!==n&&(r=n.scrollTop()),i||(i=0),this.$scrollFrame.scrollTop(this._getScrollposition(t,e)-i),null!=r&&n.scrollTop(r),this},slideTo:function(t,e,i,n){if(this.$scrollFrame)return i||(i=0),this.$scrollFrame.stop(!0),this.$scrollFrame.animate({scrollTop:this._getScrollposition(t,e)-i},"fast",null,function(){return"function"==typeof n?n():void 0})},_getScrollposition:function(t,e){var i,o,s;return t&&this.$scrollFrame!==t?(s=t[0].getBoundingClientRect(),this.$scrollFrame===n?o=e===!0?s.top-170:s.bottom-r.height()+170:(i=this.$scrollFrame[0].getBoundingClientRect(),o=e===!0?s.top-i.top-20:s.bottom-i.bottom+20),o+=this.$scrollFrame.scrollTop()):(o=this.$scrollFrame[0].scrollHeight,o-=this.$scrollFrame===n?r.height():this.$scrollFrame.height()),o},setupScroll:function(t,e){var i;if(e||(e={}),null!=(i=this.$scrollFrame)&&i.scrollTop(0).off("scroll"),this.$scrollFrame=t||n,e.shadow&&(this.$scrollFrame.on("scroll",function(t){return function(){return t._updateScrollStyle()}}(this)),this._updateScrollStyle()),this.loadMore)return this.setupLoadMore()},_updateScrollStyle:function(){var t;return null!=(t=this.$el)?t.toggleClass("overflow-top",!!this.$scrollFrame.scrollTop()):void 0},setupLoadMore:function(t,e){var i,o,a;if(a="scroll.loadmore",i=this.$scrollFrame===n?$(document):this.$scrollFrame,null!=i&&i.off(a),t!==!1)return t||(t=200),(o=function(n){return function(){if(n.$el)return null!=i?i.on(a,function(c){var l,p;return n.$el?(p=i.scrollTop(),l=n.$scrollFrame[0].scrollHeight-p,l-=c.currentTarget.body?r.height():n.$scrollFrame.height(),e&&p<=0||!e&&l<=t&&p>=0?(null!=i&&i.off(a),s.delay(function(){return n.loadMore(o,e&&p<=0)},300)):void 0):null!=i?i.off(a):void 0}):void 0}}(this))()}}},function(t,e,i){var n;n=i(679),t.exports={bbs:{root:n.BBS_URL},blog:{zh:{updates:n.BLOG_URL+"/zh/updates",ceoLetter:n.BLOG_URL+"/zh/ceoletter"},en:{updates:n.BLOG_URL+"/en/updates",ceoLetter:n.BLOG_URL+"/en/ceoletter"}},pay:{plans:n.PAY_HOST+"/plans",userNew:n.PAY_HOST+"/orders/new?payType=user-new",userRenew:n.PAY_HOST+"/orders/new?payType=user-renew",orgOrder:function(t){return n.PAY_HOST+"/organizations/"+t+"/orders"},orgNew:function(t){return n.PAY_HOST+"/organizations/"+t+"/orders/new?payType=organization-new"},orgRenew:function(t){return n.PAY_HOST+"/organizations/"+t+"/orders/new?payType=organization-renew"},orgOldRenew:function(t){return n.PAY_HOST+"/organizations/"+t+"/orders/new?payType=organization-old-renew"},orgAddMember:function(t){return n.PAY_HOST+"/organizations/"+t+"/orders/new?payType=organization-addmember"},confirmOrder:function(t,e,i){return e?n.PAY_HOST+"/organizations/"+t+"/orders/new?payType=organization-new":n.PAY_HOST+"/organizations/"+t+"/orders/new?payType=organization-new"},organizationAddMembers:function(t){}},permissions:function(t){return"/applications/permissions/"+t}}},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;r=i(800),o=i(685),s={entry:"entries"},t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.name="activities",e.prototype.model=r,e.prototype.orderBy="earliest-created",e.prototype.url=function(){var t;return t=s[this.boundToObjectType]||this.boundToObjectType+"s",t+"/"+this._boundToObjectId+"/activities"},e.prototype.sync=function(t,i,n){return null==n&&(n={}),n.url=this.url(),e.__super__.sync.apply(this,arguments)},e.prototype.create=function(t,i){return null==i&&(i={}),i.url=this.url(),e.__super__.create.apply(this,arguments)},e}(o)},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(358),r=i(688),o=i(686),s=i(677),a=i(792),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.name="activity",e.prototype.urlRoot="activities",e.prototype.defaults={objectType:"activitiy",action:"",_boundToObjectId:"",boundToObjectType:"",comment:"",content:{},_creatorId:"",created:"",updated:"",mentions:[],attachments:[],involveMembers:[],title:"",creator:{_id:"",name:""}},e.prototype.parse=function(t){var e,i,n;return null==t&&(t={}),n=t.locales||{},i=n[tb_i18n.getLanguage()],e=c.extend({},this.get("content"),t.content),t.content=c.omit(e,"comment","attachments","mentions"),c.defaults(t,c.pick(e,"comment","attachments","mentions")),c.extend(this.toJSON(),t,i)},e.prototype.initSubscribe=function(){var t,e,i,n;if(i=this.get("attachments"),i.length&&i[0]._id){for(t=0,e=i.length;t<e;t++)n=i[t],this.subscribeTo(n._id,"change",function(t){return function(e){return t.updateAttachments(e.toJSON())}}(this)),this.subscribeTo(n._id,"destroy",function(t){return function(e){return t.removeAttachments(e)}}(this));return this}},e.prototype.updateAttachments=function(t){var e,i,n,r,o;for(e=this.get("attachments"),r=[],i=0,n=e.length;i<n;i++)o=e[i],t._id===o._id?r.push(t):r.push(o);return this.set("attachments",r),this},e.prototype.removeAttachments=function(t){var e,i,n,r,o;for(e=this.get("attachments"),r=[],i=0,n=e.length;i<n;i++)o=e[i],o._id!==t&&r.push(o);return this.set("attachments",r),this},e.prototype.getAttachmentDatas=function(){var t,e,i,n,r;for(n=[],t=this.get("attachments"),e=0,i=t.length;e<i;e++)r=t[e],n.push(a.formatWork(r));return n},e}(r)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;n=i(685),r=i(802),s={entry:"entries"},t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.name="objectlinks",e.prototype.model=r,e.prototype.orderBy="latest-updated",e.prototype.sync=function(t,i,n){var r;return null==n&&(n={}),r=s[n.objectType]||n.objectType+"s",n.url||(n.url="v2/"+r+"/"+this._boundToObjectId+"/objectlinks"),e.__super__.sync.call(this,t,i,n)},e}(n)},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=i(358),o=i(686),n=i(688),s=i(803),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.name="objectlink",e.prototype.urlRoot="objectlinks",e.prototype.initialize=function(){if(e.__super__.initialize.apply(this,arguments),"collection"===this.get("linkedType")&&this.get("_linkedId"))return o.on(":change:collection/"+this.get("_linkedId"),function(t){return function(e){return e=a.extend({},t.get("data"),e),t.set("data",e)}}(this))},e.prototype.initSubscribe=function(){var t;return t=this.get("_linkedId"),this.subscribeTo(t,"change",function(t){return function(e){var i;return i=a.extend(t.get("data"),e.changed),t.set({data:i}),t.trigger("change",t)}}(this)),this.subscribeTo(t,"destroy",function(t){return function(e){return t.trigger("destroy",t)}}(this)),this},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;l=i(358),p=i(678),n=i(688),r=i(429),o=i(447),c=i(677),s=i(804),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.name="task",e.prototype.urlRoot="tasks",e.prototype.defaults={objectType:"task",isDone:!1,isRedo:!1,content:"",note:"",priority:0,involveMembers:[]},e.prototype.listen=function(){if(!this.listenedLock&&this.id)return this.listenedLock=!0,this.on("change:_executorId change:isDone change:dueDate",function(t){return function(){var e;if(t.get("_id")&&(t.get("_executorId")===p.user.id||t.previous("_executorId")===p.user.id)&&(e=t.get("dueDate")||t.previous("dueDate"))&&r().endOf("day").isAfter(e))return p.user.fetchTodayTasks()}}(this)),this.on("change:visible",function(t){var e;if(!t.checkIsVisible())return null!=(e=t.collection)?e.remove(t):void 0}),e.__super__.listen.apply(this,arguments)},e.prototype.parse=function(t){return t=l.extend(this.toJSON(),t),t._executorId||(t._executorId=""),t.executor&&t.executor._id!==t._executorId&&(t.executor=null),t},e.prototype.markDone=function(){return this.save(null,{attrs:{isDone:!0}}),this},e.prototype.markUndo=function(){return this.save(null,{attrs:{isDone:!1}}),this},e.prototype.editDate=function(t,e,i){var n;return null==i&&(i={}),n=this.get(t),n=n?new Date(n):null,(null!=n?n.toString():void 0)!==(null!=e?e.toString():void 0)?(i.attrs={},i.attrs[t]=e,this.save(null,i)):"function"==typeof i.success?i.success():void 0},e.prototype.updateContent=function(t){return this.save(null,{attrs:{content:t}}),this},e.prototype.updateExecutor=function(t,e){return e||(e={}),e.attrs={_executorId:t},this.save(null,e),this},e.prototype.getScope=function(){var t,e;return this.get("isDone")?"past":(t=r(this.get("dueDate")||null).valueOf(),e=r().endOf("day"),this.get("startOnToday")||t&&t<=e.valueOf()?"today":t&&t<=e.add(7,"days").valueOf()?"recent":"future")},e.prototype.isInvolved=function(t){return l.find(this.get("involveMembers"),function(e){return e===t})},e.prototype.isExecutor=function(t){var e,i;return e=this.get("_executorId")===t,!e&&(i=this.get("subtasks"))&&(e=!!l.find(i,function(e){return e._executorId===t})),e},e.prototype.getRRule=function(){var t,e;return(e=this.get("recurrence"))?(e=e.join("\n"),t={forceset:!0},e.indexOf("DTSTART")===-1&&(t.dtstart=new Date),e&&(e=o.rrulestr(e,t)),e):null},e.prototype.getRepeatTitle=function(){var t,e;return e=s.getRRuleSet(this.get("recurrence")),t=e?"CUSTOM"===s.freq2Label(e)?s.freq2Description(e):s.freq2Title(e):""},e.prototype.getRRuleLabel=function(){var t;return t=this.getRRule(),s.freq2Label(t)},e.prototype.forkOrMove=function(t,e,i){return i||(i={}),i.url=this.url()+"/"+t,i.attrs=l.extend({_stageId:e},i.attrs),this.sync("update",this,i),this},e.prototype.unarchive=function(t){var e;return t||(t={}),t.url=this.url()+"/archive",t.attrs={_stageId:t._stageId},e=t.success||function(){},t.success=function(t){return function(i){return t.set(i),e(t)}}(this),this.sync("delete",this,t),this},e.prototype.datetimeFormatString=function(t,e){var i;return i={date:"dateString",time:"timeFormatString"}[e],t?c.formatDate(t)[i]:""},e.prototype.getDateFormatObj=function(t){var e;if("startDate"===t||"dueDate"===t)return e=this.get(t),{type:t,dateString:this.datetimeFormatString(e,"date"),timeString:this.datetimeFormatString(e,"time")}},e}(n)},function(t,e,i){var n,r,o,s,a;s=i(358),n=i(357),r=i(429),o=i(447),a=i(438),t.exports={getRRuleSet:function(t){var e,i,n;if(n=null,t)try{n=o.rrulestr(t.join("\n"),{forceset:!0})}catch(i){e=i,a.error(e)}return n},getRepeatDates:function(t,e,i){var r,o;return e instanceof Date||(e=new Date(e)),i instanceof Date||(i=new Date(i)),t instanceof n.Model&&(t=t.toJSON()),e.valueOf()>i.valueOf()?void console.error("startTime is after endTime!"):(o=this.getRRuleSet(t.recurrence),o&&(r=o.between(e,i,!0)),r||[])},fakeByModel:function(t,e,i,o){var a,c,l,p,u,d,h,m,f,g;if(e instanceof Date||(e=new Date(e)),i instanceof Date||(i=new Date(i)),t instanceof n.Model&&(t=t.toJSON()),e.valueOf()>i.valueOf())return console.error("startTime is after endTime!"),[];if(h=[],m=this.getRRuleSet(t.recurrence)){for(u=new Date(t.endDate).valueOf()-new Date(t.startDate).valueOf(),d=m.between(e,i,!0),o&&0===(null!=d?d.length:void 0)&&(l=m.after(e),l&&d.push(l)),c=0,p=d.length;c<p;c++)f=d[c],g=new Date(f).valueOf(),a=s.clone(t),a._id=t._id+"_"+g,a._originEventId=t._id,a.startDate=r(f).toISOString(),a.endDate=r(f).add(u).toISOString(),h.push(a);h=s.sortBy(h,function(t){return t.startDate})}else h.push(t);return h},fakeByCollection:function(t,e,i,r){return e instanceof Date||(e=new Date(e)),i instanceof Date||(i=new Date(i)),t instanceof n.Collection&&(t=t.models),t=t.map(function(t){return function(n){return t.fakeByModel(n,e,i,r)}}(this)),t=s.union.apply(null,t),t=s.sortBy(t,function(t){return t.startDate})},fakeWeek:function(t,e){var i,n;return n=r().startOf("day"),i=r().add(6,"day").endOf("day"),this.fakeByCollection(t,n,i,e)},fakeMonth:function(t,e){var i,n;return n=r().startOf("day"),i=r().add(1,"month").endOf("day"),this.fakeByCollection(t,n,i,e)},label2RepeatOptions:function(t){var e;return e=function(){switch(t){case"DAILY":return{freq:3,interval:1,byweekday:[],bymonthday:[]};case"WEEKLY":return{freq:2,interval:1,byweekday:[],bymonthday:[]};case"MONTHLY":return{freq:1,interval:1,byweekday:[],bymonthday:[]};case"YEARLY":return{freq:0,interval:1,byweekday:[],bymonthday:[]};case"WORKDAY":return{freq:2,interval:1,byweekday:[0,1,2,3,4],bymonthday:[]};default:return null}}()},rruleSet2recurrence:function(t){var e,i,n,r;return i=null,e=null!=t&&null!=(n=t._rrule)&&null!=(r=n[0])?r.origOptions:void 0,e&&e.freq>=0&&e.interval&&(i=t.valueOf()),i},freq2Label:function(t){var e,i,n,o,a,c,l,p,u,d,h,m,f,g;return u="NO",(d=null!=t&&null!=(h=t._rrule)&&null!=(m=h[0])?m.origOptions:void 0)?(n=d.freq,a=d.interval,i=null!=(f=d.byweekday)?f.map(function(t){return s.isNumber(t)?t:t.weekday}):void 0,e=null!=(g=d.bymonthday)?g.map(function(t){return s.isNumber(t)?t:t.monthday}):void 0,o=!!((null!=i?i.length:void 0)||(null!=e?e.length:void 0)),l=1===(null!=i?i.length:void 0)&&i[0]===r(d.dtstart).day()-1,c=1===(null!=e?e.length:void 0)&&e[0]===r(d.dtstart).date(),p=(null!=i?i.sort().toString():void 0)===[0,1,2,3,4].toString(),u=2===n&&1===a&&p?"WORKDAY":3!==n||1!==a||o?2!==n||1!==a||o&&!l?1!==n||1!==a||o&&!c?0!==n||1!==a||o?1<=n&&n<=3&&o||a>1?"CUSTOM":"NO":"YEARLY":"MONTHLY":"WEEKLY":"DAILY"):u},freq2Title:function(t){var e,i;return e=this.freq2Label(t),i=this.label2Title(e)},freq2Description:function(t){var e,i;return"CUSTOM"===this.freq2Label(t)?(i=this.freq2RepeatOptions(t),e=this.repeatOptions2Description(i)):e="",e},freq2RepeatOptions:function(t){var e,i,n,o,a,c,l;return c=null!=t&&null!=(i=t._rrule)&&null!=(n=i[0])?n.origOptions:void 0,2!==c.freq||2!==c.interval||c.byweekday||(c.byweekday=[r(c.dtstart).day()-1]),l=function(t){return s.isNumber(t)?t:t.weekday},e=function(t){return s.isNumber(t)?t:t.monthday},c.byweekday&&(c.byweekday=null!=(o=c.byweekday)?o.map(l):void 0),c.bymonthday&&(c.bymonthday=null!=(a=c.bymonthday)?a.map(e):void 0),c},repeatOptions2Description:function(t){var e,i,n,o,a,c;return o=t.freq,a=1===t.interval?"":t.interval,i=t.byweekday,e=t.bymonthday,3===o?n=tb_i18n.get("repeat.description.daily",a):2===o?(i=null!=i?i.map(function(t){return s.isNumber(t)?t:t.weekday}):void 0,c=null!=i?i.map(function(t){return r().day(t+1).format("ddd")}).join(", "):void 0,n=tb_i18n.get("repeat.description.weekly",a,c)):1===o?(e=null!=e?e.map(function(t){return s.isNumber(t)?t:t.monthday}):void 0,c=null!=e?e.join(", "):void 0,n=tb_i18n.get("repeat.description.monthly",a,c)):n="",n},label2Title:function(t){var e;return e={NO:tb_i18n.get("repeat.freq.NO"),DAILY:tb_i18n.get("repeat.freq.DAILY"),WEEKLY:tb_i18n.get("repeat.freq.WEEKLY"),MONTHLY:tb_i18n.get("repeat.freq.MONTHLY"),YEARLY:tb_i18n.get("repeat.freq.YEARLY"),WORKDAY:tb_i18n.get("repeat.freq.WORKDAY"),CUSTOM:tb_i18n.get("repeat.freq.CUSTOM")},e[t]},getRepeats:function(t){var e;return null==t&&(t=!1),e=[{_id:"NO",title:tb_i18n.get("repeat.freq.NO")},{_id:"DAILY",title:tb_i18n.get("repeat.freq.DAILY")},{_id:"WEEKLY",title:tb_i18n.get("repeat.freq.WEEKLY")},{_id:"MONTHLY",title:tb_i18n.get("repeat.freq.MONTHLY")},{_id:"YEARLY",title:tb_i18n.get("repeat.freq.YEARLY")},{_id:"WORKDAY",title:tb_i18n.get("repeat.freq.WORKDAY")},{_id:"CUSTOM",title:tb_i18n.get("repeat.freq.CUSTOM")}],t||(e=e.slice(0,-2)),e},updateRRuleSet:function(t,e){return null===e?t._rrule[0]=new o:t._rrule[0]=new o(s.extend(t._rrule[0].origOptions,e)),t}}},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;i(806),s=i(358),o=i(788),n=i(808),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="ConfirmDialogView",e.prototype.className="confirm-dialog-view modal-dialog modal-padding",e.prototype.events={"click .confirm-handler":"onConfirm"},e.prototype.initialize=function(t){return this.options=s.extend({title:"",content:"",confirmText:tb_i18n.get("confirm"),confirmStyle:"primary"},t),this.render()},e.prototype.render=function(){return this.$el.html(n(this.options))},e.prototype.onClose=function(){var t;return"function"==typeof(t=this.parentView).close?t.close():void 0},e.prototype.onConfirm=function(){var t;return"function"==typeof(t=this.options).onConfirm&&t.onConfirm(),this.onClose()},e}(o)},function(t,e){},,function(t,e){t.exports=function(t){var e='<div class="modal-content"> <header class="modal-header"> <h4 class="modal-title text-center">'+t.title+'</h4> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </header> <div class="modal-body"> <p>'+t.content+'</p> <a class="btn btn-'+t.confirmStyle+' confirm-handler" ';
return t.confirmHref&&(e+=' href="'+t.confirmHref+'" target="_blank" '),e+=">"+t.confirmText+"</a> </div></div>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S,I=function(t,e){function i(){this.constructor=t}for(var n in e)z.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},z={}.hasOwnProperty,P=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};M=i(358),S=i(678),C=i(679),g=i(681),y=i(677),b=i(788),c=i(401),k=i(792),n=i(799),p=i(699),h=i(801),f=i(696),m=i(684),j=i(810),v=i(811),a=i(819),T=i(923),w=i(924),_=i(966),s=i(972),u=i(973),o=i(974),d=new RegExp(C.HOST+"/[^\\s<]{3,}?/(task|post|event|work|works)/([0-9a-z]{24})/?"),l=new RegExp(C.HOST+"/[^\\s<]{3,}?/(task|post|event|work|works)/([0-9a-z]{24})/?","g"),x=function(){return{task:tb_i18n.get("navigation.task"),post:tb_i18n.get("navigation.sharing"),work:tb_i18n.get("navigation.work"),event:tb_i18n.get("navigation.event"),entry:tb_i18n.get("bookkeeping")}},t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return I(e,t),e.prototype.viewName="ActivityCreatorView",e.prototype.tagName="div",e.prototype.className="activity-creator",e.prototype.events={"click .reply-handler":"submit","focusin .comment-input":"focusAttachment","focusout .comment-input":"blurAttachment","keydown .comment-input":"quickSubmit","click .reply-menu li a":"changeQuickType","click .add-work-handler":"toggleWorksPicker","click .screen-crop-handler":"openScreenCrop","click .login-handler":"loginHandler","click .register-handler":"registerHandler","click .only-comments-btn a":"filterActivities","mouseleave .only-comments-btn":"hideOnlyCommentsBtn","mousewheel .scrollable":y.mousewheel},e.prototype.initialize=function(t){var e,i,r,o,s,a;if(this.options=t,this._projectId=t._projectId,this.projectModel=f.findOne(0,this._projectId),this.objectModel=t.objectModel,this.collection=n.get(this.objectModel.id.split("_")[0],{boundToObjectType:this.options.boundToObjectType}),this.objectlinksCollection=h.get(this.collection._boundToObjectId,{boundToObjectType:this.options.boundToObjectType}),this.organizationsCollection=m.get(0),this.organizationsCollection&&this.projectModel?(r=this.organizationsCollection.get(this.projectModel.get("_organizationId")),this.isOrganizationMember=(null!=r?r.getRoleScope():void 0)>=0):this.isOrganizationMember=!1,this.isProjectMember=(null!=(o=this.projectModel)?o.getRoleScope():void 0)>=0,this.localCache=g.namespace("temp").namespace("activities_"+t.boundToObjectType),this.localCacheId=this.objectModel.id+"_"+S.user.id,e=this.localCache(this.localCacheId)||{},(null!=(s=this.projectModel)?s.hasPermission("work.post"):void 0)&&(this._defaultCollectionId=this.projectModel.get("_defaultCollectionId"),i=M.filter(e.attachments,function(t){return t.completed!==!1})),this.attachments=new j(i,{boundToObjectType:"collection",_boundToObjectId:this._defaultCollectionId}),this.mentions=e.mentions||{},this.objectlinks=[],this.renderBasic().initUploader().initSortable().initEmoji().listen(),this.$textareaset.val(e.content).flexText(function(t){return function(){return t.cacheActivity()}}(this)),!((null!=(a=this.projectModel)?a.getRoleScope():void 0)<-1))return this.loadData()},e.prototype.loadData=function(t){var e;return null==t&&(t={}),e=[new Promise(function(t){return function(e,i){return p.fetch(t._projectId,{boundToObjectType:"project",success:function(i){return t.projectMembersCollection=i,e()},error:function(t,e){return i(e)}})}}(this))],this.projectModel&&this.projectModel.get("_organizationId")&&this.isProjectMember&&this.isOrganizationMember&&("all"===this.projectModel.get("visibility")||"organization"===this.projectModel.get("visibility"))&&e.push(new Promise(function(t){return function(e,i){return p.fetch(t.projectModel.get("_organizationId"),{boundToObjectType:"organization",success:function(i){return t.organizationsMembersCollection=i,e()},error:function(t,e){return i(e)}})}}(this))),Promise.all(e).then(function(t){return function(){return t.renderSymbol({projectMembers:t.projectMembersCollection,organizationMembers:t.organizationsMembersCollection})}}(this))["catch"](function(t){return console.error(t)})},e.prototype.renderSymbol=function(t){var e;if(this.showNotifTip(t.projectMembers),this.$textareaset.length&&this.initSymbol(t),e=this.$textareaset,"activity-comment"===this.options.where)return M.delay(function(){return e.focus()},500)},e.prototype.renderBasic=function(){var t,e,i;return i=S.user.toJSON(),i.isGhost&&this.$el.addClass("ghost"),i.permissions=(null!=(t=this.projectModel)?t.hasPermissions("work.post"):void 0)||{},this.$el.html(s({user:i,quickReply:S.PREFERENCE.quickReply(),isShowCropBtn:null!=(null!=(e=window.TbScreenshotD)?e.startScreenShot:void 0)})),this.$textareaset=this.$(".comment-input"),this.$attachmentsList=this.$(".attachments-list"),this.$quickCreate=this.$(".quick-create"),this.$submit=this.$(".reply-handler"),this.$enterShortKey=this.$(".enter-short-key"),this.$attachmentsList.css("max-height",Math.max(52*this.attachments.length,100)),this.attachments.each(function(t){return function(e){return t.renderAttachment(e)}}(this)),this},e.prototype.showNotifTip=function(t){var e,i,n,r;return e=M.without(this.objectModel.get("involveMembers"),S.user.id),i=t.filter(function(t){var i;return i=t.id,P.call(e,i)>=0}),n=M.values(this.mentions),r=M.uniq(M.map(i,function(t){return t.get("name")}).concat(n)),this.$(".notif-info").html(u({notifNum:r.length,notifMembNames:r.join(", ")})),this},e.prototype.submitFiles=function(){var t,e;return(null!=(t=this.projectModel)?t.hasPermission("work.post"):void 0)&&this.attachments.length?(e=this.$attachmentsList.find(".work").map(function(){return $(this).data("cid")}).toArray(),this.attachments.comparator=function(t,i){return e.indexOf(t.cid)-e.indexOf(i.cid)},this.attachments.sort(),new Promise(function(t){return function(e,i){return t.attachments.addWorks(t.attachments.toJSON(),{_parentId:t._defaultCollectionId,_projectId:t._projectId,success:e,error:i})}}(this))):Promise.resolve()},e.prototype.parseAutoLink=function(t){var e,i,n,r,o;return(null!=(r=this.projectModel)?r.hasPermission("objectlink.post"):void 0)&&(i=t.match(d))?(n=i[1],e=i[2],e&&e!==this.collection._boundToObjectId?(o=this.objectlinksCollection.where({_linkedId:e}),this.submitAutoLink(e,n,function(){return i[0]!==t||o.length})):Promise.resolve(!0)):Promise.resolve(!0)},e.prototype.parseTaskIdAutoLink=function(t){var e;return t&&t!==this.collection._boundToObjectId?(e=this.objectlinksCollection.where({_linkedId:t}),this.submitAutoLink(t,"task",function(){return!!e.length})):Promise.resolve(!0)},e.prototype.submitAutoLink=function(t,e,i){return"works"===e&&(e="collection"),new Promise(function(i){return function(n,r){return i.objectlinksCollection.create({_parentId:i.collection._boundToObjectId,parentType:i.collection.boundToObjectType,_linkedId:t,linkedType:e},{silentError:!0,wait:!0,success:n,error:function(){return n(!1)}})}}(this)).then(function(t){return S.gta.event({action:"added link",type:e,method:"comment"}),!t||("function"==typeof i?i():void 0)})},e.prototype.submitRecurrenceEventComment=function(t){return new Promise(function(e){return function(i,n){return e.objectModel.commentRecurrence({action:"comment",_creatorId:S.user.id,content:t,mentions:e.mentions,attachments:e.attachments.pluck("_id")},{success:i,error:n})}}(this))},e.prototype.submitVal=function(t){return new Promise(function(e){return function(i,n){return e.collection.create({},{wait:!0,attrs:{content:t,attachments:e.attachments.pluck("_id"),mentions:e.mentions},success:i,error:n})}}(this)).then(function(t){return function(e){var i,n,r,o,s;return i=M.clone(e.get("mentions")),t.isProjectMember&&t.isOrganizationMember&&(s=[],M.each(t.projectMembersCollection.toJSON(),function(t){return s.push(t._id)}),o=M.omit(i,s),t.showNotProjectMember(o)),i[S.user.id]=S.user.get("name"),n=M.omit(i,t.objectModel.get("involveMembers")),r={},M.mapObject(n,function(t,e){if(!M.has(o,e))return r[e]=t}),t.isProjectMember&&t.showNotInvolvedTip(r),e.initialize()}}(this))},e.prototype.submit=function(){var t,e;return(t=this.attachments.getUploadingCount())?void c.show({message:tb_i18n.get("works.uploader.uploading.total",t),status:"warning"}):(e=this.$textareaset.val().trim(),!e&&!this.attachments.length||this.$submit.prop("disabled")?void 0:(this.disableSubmit(!0),Promise.resolve().then(this.submitFiles.bind(this)).then(function(t){return function(){var i,n,r,o,s,a;return s=e.match(l)||[],a=e.replace(/\s+/g,"").length,o=/#[a-z]{2,4}-\d+/gi,r=e.match(o)||[],M.uniq(t.objectlinks,"_id"),n=M.filter(t.objectlinks,function(t){var e,i;return e=f.findOne(0,t._projectId),t.uniqueTaskId=e.get("uniqueIdPrefix")+"-"+t.uniqueId,i=""+t.hash+t.uniqueTaskId,P.call(r,i)>=0}),s.length+n.length>0?new Promise(function(e,i){var r,o,c;if(s.length&&(c=M.pluck(s,"length").reduce(function(t,e){return t+e}),M.each(s,function(i){var n;return("function"==typeof(n=t.objectModel).isRecurrenceEventInstance?n.isRecurrenceEventInstance():void 0)?t.submitRecurrenceEventComment(i):t.parseAutoLink(i).then(function(t){var i;return i=t||a!==c,e(i)})})),r=[],n.length)return M.each(n,function(t){var e;return e="#"+t.uniqueTaskId+t.content,r.push(e)}),o=M.pluck(r,"length").reduce(function(t,e){return t+e}),M.each(n,function(i){return t.parseTaskIdAutoLink(i._id).then(function(t){var i;return i=t||a!==o,e(i)})})}).then(function(i){return i&&t.submitVal(e),Promise.resolve(!0)}):(("function"==typeof(i=t.objectModel).isRecurrenceEventInstance?i.isRecurrenceEventInstance():void 0)?t.submitRecurrenceEventComment(e):t.submitVal(e),Promise.resolve(!0))}}(this)).then(function(t){return function(){if(S.gta.event(null,"submit","add comment"),t.$el)return t.mentions={},t.$attachmentsList.empty(),t.attachments.reset(),t.$textareaset.val(""),t.$textareaset.trigger("change"),t.$el.removeClass("active"),t.localCache.remove(t.localCacheId)}}(this))["catch"](function(t){if(S.gta.event(null,"submit","add comment failed"),t)return c.show({message:t,status:"error"})}).then(function(t){return function(){if(t.$el)return t.disableSubmit(!1),t.$textareaset.focusAtEnd()}}(this)),this))},e.prototype.showNotInvolvedTip=function(t){var e;return e={tipType:"involve",memberList:t},this.showAtTips(e),this},e.prototype.showNotProjectMember=function(t){var e;return e={tipType:"member",memberList:t},this.showAtTips(e),this},e.prototype.showAtTips=function(t){var e,i,n,r,s,a,c,l,p,u,d,h,m,f,g;if(t)return m=t.tipType,r=t.memberList,s=M.values(r),i=s.length,e="involves"!==this.objectModel.get("visible"),i?(g=x(),f=g[this.objectModel.get("objectType")],n=s.join(", "),"involve"===m&&(S.user.id in r?1===i?h=tb_i18n.get("activity.visible.not.involved.tip3",f):(a=M.values(M.omit(r,S.user.id)),n=a.join(", "),h=tb_i18n.get("activity.visible.not.involved.tip4",n,f)):h=1===i?e?tb_i18n.get("activity.visible.not.involved.tip1",n,f):tb_i18n.get("activity.invisible.not.involved.tip1",n,f):e?tb_i18n.get("activity.visible.not.involved.tip2",n,i,f):tb_i18n.get("activity.invisible.not.involved.tip2",n,i,f)),"member"===m&&(h=1===i?e?tb_i18n.get("activity.visible.not.member.tip1",n,f):tb_i18n.get("activity.invisible.not.member.tip1",n,f):e?tb_i18n.get("activity.visible.not.member.tip2",n,i,f):tb_i18n.get("activity.invisible.not.member.tip2",n,i,f),h+=(null!=(p=this.projectModel)?p.hasPermission("post.member"):void 0)?1===i?e?tb_i18n.get("activity.visible.not.member.tip1.addmember"):tb_i18n.get("activity.invisible.not.member.tip1.addmember"):e?tb_i18n.get("activity.visible.not.member.tip2.addmember"):tb_i18n.get("activity.invisible.not.member.tip2.addmember"):tb_i18n.get("fullStop")),null!=(u=this.parentView.activityTimelineView)&&u.$("."+m+"-tip-wrap").html(o({type:m,tip:h})),null!=(d=this.parentView.activityTimelineView)?d[m]=r:void 0):(null!=(c=this.parentView.activityTimelineView)&&c.$("."+m+"-tip-wrap").empty(),null!=(l=this.parentView.activityTimelineView)&&(l[m]=r),this)},e.prototype.disableSubmit=function(t){return this.$submit.prop("disabled",t),this.$enterShortKey.prop("disabled",t),this},e.prototype.changeQuickType=function(t){var e;return e=$(t.currentTarget),e.hasClass("active")||(this.$(".reply-menu li a").removeClass("active"),e.addClass("active"),"only-enter"===e.data("type")?(S.PREFERENCE.quickReply(!0),this.$textareaset.attr("placeholder",tb_i18n.get("activity.timeline.comment"))):(S.PREFERENCE.quickReply(!1),this.$textareaset.attr("placeholder",tb_i18n.get("activity.timeline.reply.quickly.placeholder")))),this.$textareaset.focusAtEnd(),this},e.prototype.quickSubmit=function(t){return(13===t.keyCode&&!(t.ctrlKey||t.metaKey||t.shiftKey)&&S.PREFERENCE.quickReply()||13===t.keyCode&&(t.ctrlKey||t.metaKey||t.shiftKey)&&!S.PREFERENCE.quickReply())&&(t.preventDefault(),this.submit(),S.gta.event({action:"comment",control:"keyboard"})),this},e.prototype.listen=function(){return this.listenTo(this.attachments,"add",this.renderAttachment),this.listenTo(this.attachments,"add change remove",this.cacheActivity),this.listenTo(this.attachments,"add remove reset",function(t){return function(){return t.attachments.length?t.$attachmentsList.css("max-height",Math.max(52*t.attachments.length,100)):t.deactiveAttachment()}}(this)),this.listenTo(this.objectModel,"change:involveMembers",function(t){return function(){return t.showNotifTip(p.get(t._projectId))}}(this)),this},e.prototype.initUploader=function(){var t,e,i;return(null!=(e=this.projectModel)?e.hasPermission("work.post"):void 0)?(null!=(i=this.workuploaderView)&&i.remove(),t={projectModel:this.projectModel,collection:this.attachments,pick:null,dnd:this.options.dragAndDropWrap||this.$el,paste:this.$textareaset},this.workuploaderView=this.requestSubView(w,t),this):this},e.prototype.initSortable=function(){var t;return(null!=(t=this.projectModel)?t.hasPermission("work.post"):void 0)?(this.$attachmentsList.sortable({items:".work",helper:"clone",placeholder:"work-drag-placeholder",tolerance:"pointer",zIndex:2001,axis:"y",scroll:!1}),this):this},e.prototype.initSymbol=function(t){var e,i,n;return i=t.projectMembers.toJSON(),e=M.filter((null!=(n=t.organizationMembers)?n.toJSON():void 0)||[],function(t){return null==M.find(i,{_id:t._id})}),this.symbolPopoverView=this.requestSubView(v,{$inputor:this.$textareaset,at:"@",hash:"#",fixed:!0,_id:this.objectModel.id,membersData:{projectMembers:i,organizationMembers:e},select:function(t){return function(e,i,n){switch(n){case"#":return t.selectLink(e,i);case"@":return t.selectAt(e,i)}}}(this)}),this},e.prototype.selectAt=function(t,e){return this.mentions[t]=e.name,this.cacheActivity(),this},e.prototype.selectLink=function(t,e){return e=M.extend({hash:"#"},e),this.objectlinks.push(e),this},e.prototype.checkIsAlreadyAt=function(t){return this.mentions[t]},e.prototype.toggleWorksPicker=function(t){var e,i;return(null!=(i=this.projectModel)?i.hasPermission("work.post"):void 0)?(e=$(t.currentTarget),e.data("bs.popover")||this.requestSubView(T,{_projectId:this._projectId,collection:this.attachments,$toggler:e,placement:"auto top"}).show(),this):this},e.prototype.openScreenCrop=function(){var t;if(null!=(null!=(t=window.TbScreenshotD)?t.startScreenShot:void 0))return this.$textareaset.focusAtEnd(),window.TbScreenshotD.startScreenShot()},e.prototype.initEmoji=function(){return this.fastEmojiView=this.requestSubView(a,{$toggler:this.$(".comment-box-wrap .open-emoji-handler"),select:function(t){return function(e){return t.insertEmoji(e)}}(this)}),this.fastEmojiView.$el.appendTo(this.$(".activity-creator-fast-emoji")),this.activeEmojiView=this.requestSubView(a,{$toggler:this.$(".activity-handler .open-emoji-handler"),select:function(t){return function(e){return t.insertEmoji(e)}}(this)}),this.activeEmojiView.$el.appendTo(this.$(".activity-creator-active-emoji")),this},e.prototype.insertEmoji=function(t){var e,i,n,r;return e=this.$(".comment-input"),r=e.val().replace(/\n/g,""),i=e[0].selectionStart,r=r.slice(0,i)+t+r.slice(i),r=r.replace(/\r/g,"\r\n"),e.val(r).change(),n=i+t.length,e.selectRange(n,n)},e.prototype.loginHandler=function(t){return S.router.gotoLogin(),this},e.prototype.registerHandler=function(t){return S.router.gotoRegister(),this},e.prototype.renderAttachment=function(t){return this.requestSubView(_,{workModel:t}).$el.appendTo(this.$attachmentsList),this.$attachmentsList.scrollTop(999),this.$(".comment-input").focusAtEnd(),this},e.prototype.cacheActivity=function(){var t,e,i,n;t=this.$textareaset.val().trim(),i=this.mentions;for(e in i)n=i[e],t.indexOf("@"+n)<0&&delete this.mentions[e];return this.localCache(this.localCacheId,{content:t,attachments:this.attachments.toJSON(),mentions:this.mentions}),this.showNotifTip(p.get(this._projectId)),this},e.prototype.focusAttachment=function(){return this.$el.addClass("focus"),this.$el.addClass("active"),this.$el.handleClickOutside(function(t){return function(){return t.deactiveAttachment()}}(this),"click",".works-picker, #atwho-container"),this},e.prototype.blurAttachment=function(){return this.$el.removeClass("focus"),this},e.prototype.deactiveAttachment=function(){return this.attachments.length||this.$textareaset.val().trim()||(this.$textareaset.val(""),this.$textareaset.trigger("change"),this.$el.removeClass("active")),this},e.prototype.hideOnlyCommentsBtn=function(){return this.toggleOnlyCommentsBtn(!1)},e.prototype.toggleOnlyCommentsBtn=function(t){return this.$el[t?"addClass":"removeClass"]("on-only-showing"),this},e.prototype.filterActivities=function(t){var e,i,n,r,o;return o={isOnlyComments:!1,isOnlyAttachments:!1},n=this.filterActivitiesOptions||{},i=this.$(t.currentTarget),i.hasClass("comments-handler")&&(o.isOnlyComments=!n.isOnlyComments),i.hasClass("attachments-handler")&&(o.isOnlyAttachments=!n.isOnlyAttachments),r=["on-only-comments","on-only-attachments"],e=this.$(".only-comments-btn").removeClass(r.join(" ")),o.isOnlyComments&&e.addClass(r[0]),o.isOnlyAttachments&&e.addClass(r[1]),this.filterActivitiesOptions=o,this.trigger("filterActivities",o),this},e.prototype.show=function(){return M.delay(function(t){return function(){var e,i;if(t.$el)return i=t.$el.height(),i>0?(e={display:"block",height:"0px",overflow:"hidden"},t.$el.css(e),t.$el.on("transitionend.activity-creator",function(t){var e;if(e=$(t.target),e.hasClass("activity-creator"))return e.off(".activity-creator"),e.addClass("showing"),e.removeAttr("style")}),M.delay(function(){if(t.$el)return t.$el.height(i)},10)):t.$el.addClass("showing")}}(this),100)},e.prototype.remove=function(){var t;return null!=(t=this.atwho)&&t.shutdown(),e.__super__.remove.apply(this,arguments)},e}(b)},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=i(358),n=i(685),r=i(686),s=i(792),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.name="works",e.prototype.boundToObjectType="parent",e.prototype.model=s,e.prototype.pageNum=50,e.prototype.orderBy="latest-updated",e.prototype.listen=function(){return this.on("change:_parentId",function(t,i){var n;return null!=(n=e.find(i))&&n.add(t),this.remove(t)}),e.__super__.listen.apply(this,arguments)},e.prototype.sync=function(t,i,n){var r;switch(t){case"create":n.remove=!1,r=n.success||function(){},n.success=function(t){return function(i){var n,o,s;return a.each(i,function(e){var i;if(i=e.fileKey?t.findWhere({fileKey:e.fileKey}):t.findWhere({downloadUrl:e.downloadUrl}),i&&!i.get("_id"))return i.set("_id",e._id)}),n=null!=(o=i[0])?o._parentId:void 0,n&&n!==t._boundToObjectId?null!=(s=e.find(n))&&s.add(i,{remove:!1}):t.set(i,{remove:!1}),r(i)}}(this)}return e.__super__.sync.apply(this,arguments)},e.prototype.addWorks=function(t,e){var i;return e||(e={}),i=[],a.each(t,function(t){return function(n){if(!t.get(n._id)&&n.completed)return n._parentId=e._parentId||t._boundToObjectId,/^http/.test(n.thumbnailUrl)||(delete n.thumbnail,delete n.thumbnailUrl),i.push(n)}}(this)),i.length?(e.attrs={works:i},e.attrs._parentId=e._parentId||this._boundToObjectId,e.attrs._projectId=e._projectId||t[0]._projectId,this.sync("create",this,e)):"function"==typeof e.success?e.success(t):void 0},e.prototype.getUploadingCount=function(){return this.where({completed:!1}).length},e.prototype.getSelected=function(){return this.where({_selected_:!0})},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v=function(t,e){function i(){this.constructor=t}for(var n in e)y.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},y={}.hasOwnProperty;m=i(358),f=i(363),g=i(358),n=i(812),o=i(813),a=i(797),d=i(677),h=i(788),l=i(815),s=i(697),c=i(816),u=i(818),r={DOWN:40,UP:38,ESC:27,TAB:9,ENTER:13,HASH:35,AT:64},p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return v(e,t),e.prototype.viewName="SymbolPopoverView",e.prototype.className="symbol-popover-view",e.prototype.popoverTitle="Menu",e.prototype.width=240,e.prototype.events={"click .symbol-item":"select","mouseenter .symbol-item":"activate",mousewheel:d.mousewheel},e.prototype.initialize=function(t){if(!((null!=t?t.$inputor:void 0)&&t.membersData))throw new Error("options should have $inputor and datas");return t=m.extend(t,{trigger:"manual",$toggler:t.$inputor}),this.popoverTitle=tb_i18n.get("activity.comment.link.title"),this.options=t,this.$inputor=t.$inputor,this.membersData=t.membersData,this.allMembers=t.membersData,this.objectlinksCollection=l.get(0),this.listen(),e.__super__.initialize.apply(this,arguments)},e.prototype.listen=function(){return this.$inputor.on("keydown.symbolPopoverView",function(t){return function(e){return t.onKeydown(e)}}(this)),this.$inputor.on("keyup.symbolPopoverView",function(t){return function(e){return t.filter(e)}}(this)),this.$inputor.on("blur.symbolPopoverView",function(t){}),this},e.prototype.render=function(){return this.$el.html(n({membersData:"@"===this.type?this.membersData:void 0,linksData:"#"===this.type?this.linksData:void 0})),"#"===this.type&&this.renderTaskIdLabel(),this.$list=this.$(".symbol-list"),this.setupScroll(this.$list),this},e.prototype.renderTaskIdLabel=function(){return this.$el.find(".link-item").each(function(t){return function(e,i){var n,r,o,a,c;return n=$(i),r=n.data("id"),c=t.objectlinksCollection.get(r),o=c.get("_projectId"),a=s.get(o),t.requestSubView(u,{projectModel:a,uniqueId:c.get("uniqueId")}).bind(n.find(".task-id-placeholder"))}}(this))},e.prototype.fetchLinkContent=function(){var t;return t=this.getHashQuery(),t?this.load({silent:!0,url:"v2/tasks/search",attrs:{uniqueId:t.uniqueId,uniqueIdPrefix:t.uniqueIdPrefix},beforeSend:function(t){return function(){if(!t.linksData||!t.linksData.length)return t.showLoadingIndicator()}}(this),success:function(t){return function(e){var i;if(t.$el)return t.hideLoadingIndicator(),e.map(function(t){var e,i,n;return e=t.get("_projectId"),n=s.get(e),i=n.isAppEnabled("taskUniqueId"),t.set({isAppEnabled:i})}),i=m.filter(t.objectlinksCollection.toJSON(),function(e){return e.isAppEnabled&&e._id!==t.options._id}),t.linksData=i,t.$el.siblings(".popover-header").show(),t.renderList(i)}}(this)}):this.hide()},e.prototype.load=function(t){return null==t&&(t={}),this.objectlinksCollection.reset(),this.objectlinksCollection.fetch(t),this},e.prototype.getInputFilterType=function(){var t,e;return t=this.$inputor.val().replace(/\r\n/g,"\n"),e=this.$inputor.get(0).selectionStart,t=t.substring(0,e),/@$/.test(t)?this.type=this.options.at:/#$/.test(t)?this.type=this.options.hash:void 0},e.prototype.resetDatasList=function(){var t;switch(t=this.type||this.options.at){case"@":return this.getMembersList();case"#":return this._fetchLinkContent||(this._fetchLinkContent=m.debounce(function(t){return function(){return t.fetchLinkContent()}}(this),10)),this._fetchLinkContent()}},e.prototype.getMembersList=function(){var t,e,i;return i=this.filterDataList(this.allMembers.projectMembers),t=i,this.allMembers.organizationMembers&&this.allMembers.organizationMembers.length&&(e=this.filterDataList(this.allMembers.organizationMembers),this.membersData.organizationMembers=e),e&&e.length&&(t=t.concat(e)),e||(e=[]),this.membersData={projectMembers:i,organizationMembers:e},this.$("ul.symbol-list h5").show(),i.length||this.$("h5.project-members").hide(),(null!=e?e.length:void 0)||this.$("h5.not-project-members").hide(),this.$el.siblings(".popover-header").hide(),this.renderList(t)},e.prototype.filter=function(t){var e;if(t.keyCode!==r.ESC&&(e=this.$inputor.val(),!this.inputVal||this.inputVal!==e))return this.inputVal=e,this.getInputFilterType(),this.resetDatasList()},e.prototype.renderList=function(t){if(t&&!(t.length>150)){if(t.length)this.show();else if(this.isShowing)return this.hide();return this.rePosition(),this.activateFirst(),this}},e.prototype.filterDataList=function(t){var e,i;return i=this.getQuery(),""===i?t:i?(e=function(t){return function(e,n,r){var o,s,a;if(t.options.filter)return t.options.filter(e,i);for(r=[],r.push(e.name.toLowerCase()),r.push(e.pinyin.toLowerCase()),r.push(e.py.toLowerCase()),o=0,s=r.length;o<s;o++)if(a=r[o],a.indexOf(i)>=0)return!0;return!1}}(this),m.filter(t,e)):[]},e.prototype.filterLinkDataList=function(t){var e,i;return i=this.getHashQuery(),""===i?t:i?(e=function(t){return function(e,n,r){var o,s,a;if(t.options.filter)return t.options.filter(e,i);for(r=[],r.push(e.name.toLowerCase()),r.push(e.pinyin.toLowerCase()),r.push(e.py.toLowerCase()),o=0,s=r.length;o<s;o++)if(a=r[o],a.indexOf(i)>=0)return!0;return!1}}(this),m.filter(t,e)):[]},e.prototype.activateFirst=function(){var t;return t=this.$(".symbol-item:visible"),t.filter(".active").length||(this.$(".symbol-item.active").removeClass("active"),t.first().addClass("active")),this},e.prototype.getRegExpAt=function(t,e,i){var n,r,o,s,a,c,l,p,u,d;return null==t&&(t=null),null==e&&(e="check"),null==i&&(i=""),s="check"===e,o=this.type||this.options.at,r=function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},t?(n=m.union(m.map(["name","pinyin","py"],function(e){return t[e].toLowerCase()})),l=new RegExp("^"+r(i),"i"),a=m.filter(n,function(t){return l.test(t)}),u=m.map(a,function(t){var e,n,o,a;return e=r(t.slice(0,i.length)),o=[],a=m.map(t.slice(i.length).split(""),function(t){var e,i,n,r,a;if(o.push(t),n=o.join(""),s)return[n];for(a=[],e=i=-1,r=-n.length;-1<=r?i<=r:i>=r;e=-1<=r?++i:--i)a.push(n.slice(e,+n.length+1||9e9));return a}),n=m.map(m.union.apply(m,a).sort(function(t,e){return e.length-t.length}),r),i?"(?:"+e+"(?:"+n.join("|")+")?)":n}),u=m.union(m.flatten(u)).sort(function(t,e){return e.length-t.length}),c="("+(u.join("|")||r(i))+")"+(i?"":"?"),d=s?"[^@]":".",p="gi"+(s?"":"m"),new RegExp("(^|( *))"+o+c+"(?=( *)(?:"+d+"*?)$)",p)):new RegExp(o+"((?:[^\\x00-\\x19\\x40\\x7f])*)$","gi")},e.prototype.getRegExpHash=function(t,e){var i;return null==e&&(e=!1),t=this.type||this.options.hash,t=t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),e&&(t="(?:^|\\s)"+t),i=new RegExp("("+t+")([a-z]{2,4})-([0-9]+)$","i")},e.prototype.getQuery=function(){var t,e,i,n;return t=this.$inputor.val().replace(/\r\n/g,"\n"),i=this.$inputor.get(0).selectionStart,t=t.substring(0,i),e=this.getRegExpAt().exec(t),n=e?e[1]:null,n&&(n=n.toLowerCase()),n},e.prototype.getHashQuery=function(){var t,e,i,n,r,o,s,a;return n=this.$inputor.get(0).selectionStart,t=this.$inputor.val().substring(0,n),o=t.match(this.getRegExpHash()),o?(i=o[0],e=o[1],a=o[2],s=o[3],r={flag:e,uniqueIdPrefix:a,uniqueId:s}):r=null,r},e.prototype.onKeydown=function(t){if(this.isShowing){switch(t.keyCode){case r.UP:t.preventDefault(),this["switch"]("up");break;case r.DOWN:t.preventDefault(),this["switch"]("down");break;case r.ESC:t.preventDefault(),this.hide(t);break;case r.TAB:case r.ENTER:t.preventDefault(),t.stopPropagation(),this.select();break;default:$.noop()}return this}},e.prototype.onShown=function(){return this.isShowing=!0,e.__super__.onShown.apply(this,arguments)},e.prototype.onHidden=function(){return this.isShowing=!1,e.__super__.onHidden.apply(this,arguments)},e.prototype.select=function(t){var e,i,n,r,o;return e=$(null!=t?t.currentTarget:void 0),e.length||(e=this.$(".symbol-item.active")),o=e.data("id"),this.type===this.options.hash?n=m.find(this.linksData,function(t){return t._id===o}):(r=this.membersData.projectMembers,this.membersData.organizationMembers&&this.membersData.organizationMembers.length&&(r=r.concat(this.membersData.organizationMembers)),n=m.find(r,function(t){return t._id===o})),o&&n&&(this.insert(o,n,e,this.type),"function"==typeof(i=this.options).select&&i.select(o,n,this.type),this.hide()),this},e.prototype.insert=function(t,e,i,n){var r,o,s,a,c,l,p;return e?(r=this.$inputor.val().replace(/\r\n/g,"\n"),s=this.$inputor.get(0).selectionStart,n===this.options.at?(a=this.getRegExpAt(e,"check").exec(r.substring(0,s)),c=a[3],o=a.index,r=r.replace(this.getRegExpAt(e,"replace",c),function(t,i,n,r,s,c){var l;return c!==a.index?t:(i=""===i&&""===n?" ":i,s=""===s?" ":"",l=i+"@"+e.name+s,o+=l.length-s.length+1,l)}),this.$inputor.val(r),this.$inputor.is(":focus")||this.$inputor.focusAtEnd(),this.$inputor.change().selectRange(o,o)):(p=r.substring(s),l=r.substring(0,s)+(" "+e.content+" "),this.$inputor.val(l+p),this.$inputor.is(":focus")||this.$inputor.focusAtEnd(),this.$inputor.change().selectRange(l.length,l.length)),this):this},e.prototype.activate=function(t){var e;if(e=$(t.currentTarget),e.length&&!e.hasClass("active"))return e.addClass("active").siblings().removeClass("active"),this},e.prototype["switch"]=function(t){var e,i,n,r,o,s;if(o=(new Date).getTime(),!(o-this.lastSwitchTime<100))return this.lastSwitchTime=o,n=this.$(".symbol-item:visible"),e=n.filter(".active"),r=n.index(e),"down"===t?(s=r+1,s>=n.length&&(s=0)):(s=r-1,s<0&&(s=n.length-1)),i=n.eq(s),n.removeClass("active"),i.addClass("active"),this.slideTo(i),this},e.prototype.rePosition=function(){var t,e,i,n,r,o,s;if(null!=(o=this.$popover)&&o.hasClass("in")&&this.$popover.parent()[0]===document.body)return i=this.$inputor.get(0).selectionStart,e=this.$inputor.val().substring(0,i).length,n=this.getQuery(),null!==n&&(e=e-n.length-1),r=this.$inputor.caret("offset",e),t=20,r.top+this.$popover.height()-$(window).scrollTop()+t>$(window).height()?r.top=r.top-this.$popover.height():r.top=r.top+r.height,r.left+this.$popover.width()+t>$(window).width()&&(r.left=r.left-this.$popover.width()),this.$popover.offset({left:r.left,top:r.top}),this.options.fixed?(s=this.$popover[0].getBoundingClientRect(),this.$popover.css({position:"fixed",top:s.top,left:s.left})):void 0},e.prototype.remove=function(){var t;return null!=(t=this.$inputor)&&t.off("keydown.symbolPopoverView").off("keyup.symbolPopoverView").off("blur.symbolPopoverView"),e.__super__.remove.apply(this,arguments)},e}(o),m.extend(p.prototype,a),t.exports=p},function(t,e){t.exports=function(t){var e='<ul class="symbol-list list-unstyled thin-scroll"> ';if(t.membersData&&t.membersData.organizationMembers.length&&(e+=' <h5 class="project-members">'+tb_i18n.get("project.at.members.project")+"</h5> "),e+=" ",t.membersData&&t.membersData.projectMembers.length){e+=" ";var i=t.membersData.projectMembers;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <li class="symbol-item ',e+=n.notInvolved?"other":"involved",e+='" data-id="'+n._id+'" data-gta="event" data-label="at item"> <a> ',n.avatarUrl&&(e+=' <div class="avatar img-circle" style="background-image:url('+n.avatarUrl+');"></div> '),e+=" "+n.name+'<span class="tip">',n.notInvolved&&(e+=""+tb_i18n.get("at.not.involved")),e+="</span> </a> </li> ";e+=" "}if(e+=" ",t.membersData&&t.membersData.organizationMembers.length){e+=' <h5 class="not-project-members">'+tb_i18n.get("project.at.members.organization")+"</h5> ";var s=t.membersData.organizationMembers;if(s)for(var n,a=-1,c=s.length-1;a<c;)n=s[a+=1],
e+=' <li class="symbol-item not-project-member" data-id="'+n._id+'" data-gta="event" data-label="at item"> <a> ',n.avatarUrl&&(e+=' <div class="avatar img-circle" style="background-image:url('+n.avatarUrl+');"></div> '),e+=" "+n.name+'<span class="tip">',n.notInvolved&&(e+=""+tb_i18n.get("at.not.involved")),e+="</span> </a> </li> ";e+=" "}if(e+=" ",t.linksData&&t.linksData.length){e+=" ";var l=t.linksData;if(l)for(var p,u=-1,d=l.length-1;u<d;)p=l[u+=1],e+=' <li class="symbol-item link-item" data-id="'+p._id+'" data-gta="event" data-label="hash item"> <a> <span class="icon icon-board img-circle"></span> <span class="title">'+p.content+'</span> <span class="task-id-placeholder"></span> </a> </li> ';e+=" "}return e+="</ul>"}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(358),r=i(814),s=i(677),a=i(788),n=$("body"),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="PopoverView",e.prototype.hotkeys={esc:function(t){return t.preventDefault(),this.hide()}},e.prototype.initialize=function(t){if(t.$toggler&&"function"==typeof this.render)return this.options=c.extend({title:this.popoverTitle,html:!0,placement:"bottom",trigger:"click",container:"body",animation:!1,hideDelay:218,template:r(),viewport:{selector:"body",padding:20}},t),t.width&&(this.width=t.width),this.$toggler=$(t.$toggler),this.setup().delegatePopoverEvents(),this},e.prototype.setup=function(){return this.$toggler.popover(this.options),this.popover=this.$toggler.data("bs.popover"),this.$popover=this.popover.tip(),this.$title=this.$popover.find(".popover-title"),this.$content=this.$popover.find(".popover-content"),this.setElement(this.$content),this.width&&this.$popover.width(this.width),this.className&&this.$popover.addClass(this.className),this.$popover.css("z-index",999),this},e.prototype.delegatePopoverEvents=function(){return this.$popover.find(".popover-close-handler").click(function(t){return function(){return t.hide()}}(this)),this.$toggler.on("shown.bs.popover",function(t){return function(){return t.onShown()}}(this)),this.$toggler.on("hidden.bs.popover",function(t){return function(){return t.onHidden()}}(this)),$("[data-toggle=dropdown]").on("click.bs.dropdown",function(t){return function(){return t.hide()}}(this)),this},e.prototype.show=function(){return this.popover.show(),this},e.prototype.onShown=function(){var t;return"function"==typeof this.reset&&this.reset(),this.$popover.handleClickOutside(function(t){return function(e){var i;if(i=t.$toggler[0],e.target!==i&&!$.contains(i,e.target))return c.delay(function(){return t.hide()},t.options.hideDelay)}}(this),"click.popover"),this.$toggler.addClass("open"),this.returnMainMenu(),this.fixPosition(),this.delegateEvents(),"function"==typeof(t=this.options).onShown&&t.onShown(),this.setupHotKey(),this.$(".thin-scroll").on("mousewheel",s.mousewheel),this},e.prototype.setupHotKey=function(){var t;return(null!=(t=this.$popover)?t.is(":hidden"):void 0)||e.__super__.setupHotKey.apply(this,arguments),this},e.prototype.hide=function(){var t;return null!=(t=this.popover)&&t.hide(),this},e.prototype.onHidden=function(){var t,e,i,n;return null!=(e=this.$(".thin-scroll"))&&e.off("mousewheel"),this.removeHotKey(),null!=(i=this.$popover)&&i.detach(),null!=(n=this.$toggler)&&n.removeClass("open"),"function"==typeof(t=this.options).onHidden&&t.onHidden(),this},e.prototype.enterSubMenu=function(t,e){return t=t.trim(),this.$popover.addClass("in-submenu"),t&&this.$title.text(t),this.$popover.find(".popover-back-handler").one("click",function(t){return function(e){return e.stopPropagation(),t.returnMainMenu()}}(this)),e()},e.prototype.returnMainMenu=function(t){var e,i;return this.$popover.removeClass("in-submenu"),i=null!=(e=this.options.title)?e.trim():void 0,i&&this.$title.text(this.options.title),"function"==typeof this.render&&this.render(),this},e.prototype.fixPosition=function(){var t,e,i,n,r,o;return null!=(i=this.$popover)&&i.hasClass("in")&&this.$popover.parent()[0]===document.body?(o=window.innerHeight,n=this.$popover[0].getBoundingClientRect(),r=this.$toggler[0].getBoundingClientRect(),e=document.documentElement.scrollTop||document.body.scrollTop,t=this.options.withChat?n.bottom+62:n.bottom,n.top<=0?(this.$popover.removeClass("top").addClass("bottom"),this.$popover.css("top",e+r.bottom)):t>=o&&!this.options.keepPositionOnBottom&&(this.$popover.removeClass("bottom").addClass("top"),this.$popover.css("top",e+r.top-n.height)),this.options.fixed?(n=this.$popover[0].getBoundingClientRect(),this.$popover.css({position:"fixed",top:n.top,left:n.left})):void 0):this},e.prototype.remove=function(){var t,i,n;return this.$el&&this.onHidden(),null!=(t=this.$popover)&&t.remove(),null!=(i=this.$toggler)&&i.off(".popover"),null!=(n=this.popover)&&n.destroy(),e.__super__.remove.apply(this,arguments)},e}(a)},function(t,e){t.exports=function(t){var e='<div class="popover"> <header class="popover-header"> <a class="popover-back-handler icon icon-chevron-left"></a> <h3 class="popover-title">Popover Title</h3> <a class="popover-close-handler icon icon-remove"></a> </header> <div class="popover-content thin-scroll"></div></div>';return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h=function(t,e){function i(){this.constructor=t}for(var n in e)m.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},m={}.hasOwnProperty,f=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};u=i(358),n=i(351),d=i(429),p=i(677),a=i(804),r=i(685),c=i(816),o=i(817),s=i(696),t.exports=l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.name="search",e.prototype.model=c,e.prototype.pageNum=20,e.prototype.comparator=!1,e.prototype.parse=function(t){var e;return e=[],u.each(t,function(t){return function(i){var n,r,c,l,u,d,h,m,f,g,v,y,b,k;switch(r=s.getOne(0,i._projectId),r&&(i.projectName=r.get("name")),i.type){case"work":null!=i.fileSize&&(i._fileSize=p.formatFileSize(i.fileSize)),i.title=(null!=(c=i.highlight.fileName)?c[0]:void 0)||i.fileName;break;case"task":i.avatarUrl=null!=(l=i.executor)?l.avatarUrl:void 0,i.dueDate&&(i.deadLine=p.formatDate(i.dueDate)),i.accomplished&&(i.doneDate=p.formatDate(i.accomplished)),i.title=(null!=(h=i.highlight.content)?h[0]:void 0)||i.content,i.text=(null!=(m=i.highlight.note)?m[0]:void 0)||i.note,i.subtasks=t.filterMatchedSubtasks(i);break;case"post":i.text=(null!=(f=i.highlight.content)?f[0]:void 0)||i.content,i.avatarUrl=i.creator.avatarUrl,i.title=(null!=(g=i.highlight.title)?g[0]:void 0)||i.title;break;case"event":n=new o(i,{bindByMatrix:!1}),n.isRecurrenceEventInstance()&&(i.freqString=a.freq2Title(n.getRRuleSet())),i.dateStr=t.formatDate(i.startDate),i.eventDateString=t.getEventDateString(i),i.title=(null!=(v=i.highlight.title)?v[0]:void 0)||i.title,i.text=(null!=(y=i.highlight.content)?y[0]:void 0)||i.content,i.location=(null!=(b=i.highlight.location)?b[0]:void 0)||i.location;break;case"entry":i._type===-1&&(i.amount="-"+i.amount),i.title=(null!=(k=i.highlight.content)?k[0]:void 0)||i.content,i.text=(null!=(u=i.highlight.note)?u[0]:void 0)||i.note;break;default:i.avatarUrl=null!=(d=i.executor)?d.avatarUrl:void 0,i.dueDate&&(i.deadLine=p.formatDate(i.dueDate)),i.accomplished&&(i.doneDate=p.formatDate(i.accomplished)),i.title=i.content,i.text=i.note}t.setHighlight(i),e.push(i)}}(this)),e},e.prototype.setHighlight=function(t){var e,i,r;if(u.each(["title","text"],function(e){var i;return i=p.escape(u.unescape(t[e]||"")),t[e]=i.replace(/\&lt;em\&gt;([^\s]+?)\&lt;\/em\&gt;/g,"<em>$1</em>")}),"post"===t.type)try{r=u.unescape(t.text),t.text=n("<div>"+r+"</div>").text()}catch(i){e=i}return this},e.prototype.formatDate=function(t){var e,i,n;return n=d(),i=d(t),e=i.isSame(n,"year")?"en"===tb_i18n.getLanguage()?"MMM D":"MMMDo":"ll",d(t).format(e)},e.prototype.getEventDateString=function(t){var e,i,n;return t.startDate?(i=p.formatDate(new Date(t.startDate)).dateString,n=i+" "+d(t.startDate).format("LT"),t.endDate&&(n+=" -",e=p.formatDate(new Date(t.endDate)).dateString,e!==i&&(n+=" "+e),n+=" "+d(t.endDate).format("LT")),n):""},e.prototype.filterMatchedSubtasks=function(t){var e,i;return i=[],e=[],u.each(t.subtaskIds,function(r){return u.each(t.highlight["subtaskIds.content"]||[],function(t,o){var s,a,c;try{c=n("<div>"+t+"</div>").text()}catch(a){s=a}if(c===r.content&&(r.dueDate&&(r.dueDate=p.formatDate(r.dueDate)),r.accomplished&&(r.accomplished=p.formatDate(r.accomplished)),r.text=t,f.call(e,t)<0))return e.push(t),i.push(r)})}),i},e.prototype.searchForUniqueTask=function(t){return t||(t={}),t.url="v2/tasks/search",this.fetch(t)},e}(r)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(688),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.name="search",e.prototype.urlRoot="search",e.prototype.initialize=function(t,i){return i||(i={}),i.bindByMatrix=!1,e.__super__.initialize.apply(this,arguments)},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h=function(t,e){function i(){this.constructor=t}for(var n in e)m.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},m={}.hasOwnProperty;u=i(358),d=i(678),s=i(688),a=i(429),c=i(447),p=i(677),o=i(680),l=i(804),n=["_projectId","_creatorId","title","location","startDate","endDate","involveMembers","visible","recurrence","reminders"],t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.name="event",e.prototype.urlRoot="events",e.prototype.defaults={objectType:"event",involveMembers:[],content:null,recurrence:null},e.prototype.initialize=function(t,i){return(null!=t?t._startDate:void 0)||this.refreshDate(),e.__super__.initialize.apply(this,arguments)},e.prototype.listen=function(){if(!this.listenedLock&&this.id)return this.listenedLock=!0,this.on("change:visible",function(t){var e;if(!t.checkIsVisible())return null!=(e=t.collection)?e.remove(t):void 0}),e.__super__.listen.apply(this,arguments)},e.prototype.parse=function(t){var e;return null==t&&(t={}),e=u.extend(this.toJSON(),t),e.originStartDate||(e.originStartDate=e.startDate),e.originEndDate||(e.originEndDate=e.endDate),e},e.prototype.getScope=function(){var t,e,i,n;return e=a(this.get("startDate")).valueOf(),t=a(this.get("endDate")||null).valueOf(),i=a().endOf("day").valueOf(),n=a().startOf("day").valueOf(),e>i?"future":n<=e&&e<=i||e<n&&t>i?"today":"past"},e.prototype.getRRuleSet=function(){return l.getRRuleSet(this.get("recurrence"))},e.prototype.refreshDate=function(t){var e,i,n,r;return this.isRecurrenceEventInstance()?(t=new Date(t||a().startOf("day").toISOString()),(r=this.getRRuleSet())?(t=r.after(t))?(i=new Date(this.get("_startDate")||this.get("startDate")),e=new Date(this.get("_endDate")||this.get("endDate")),t.toTimeString()!==i.toTimeString()&&(t.setHours(i.getHours()),t.setMinutes(i.getMinutes()),t.setSeconds(i.getSeconds()),t.setMilliseconds(i.getMilliseconds())),n=new Date(t.valueOf()+e.valueOf()-i.valueOf()),this.attributes._startDate=i.toISOString(),this.attributes._endDate=e.toISOString(),this.attributes.startDate=t.toISOString(),this.attributes.endDate=n.toISOString(),this):this:void 0):this},e.prototype.isRecurrenceEventInstance=function(){var t;return(null!=(t=this.get("recurrence"))?t.length:void 0)>0},e.prototype.upgradeData=function(t,e){return this.set(t),this.reset(e),this},e.prototype.commentRecurrence=function(t){if(this.isRecurrenceEventInstance())return t.timestamp=+new Date(this.get("startDate")),o.post(this.url()+"/comments_repeat_event",t).then(function(t){return function(e){var i;return i=t.eventDetailView,i?(i.resetView(),t.upgradeData(e.repeat,e["new"]),i.options.eventModel=t,i.eventModel=t,i.refreshView()):t.upgradeData(e.repeat,e["new"])}}(this))},e.prototype.doLike=function(t){return this.isRecurrenceEventInstance()?o.post(this.url()+"/like_repeat_event",{timestamp:+new Date(this.get("startDate"))}).then(function(t){return function(e){var i;return i=t.eventDetailView,i?(i.resetView(),t.upgradeData(e.repeat,e["new"]),i.options.eventModel=t,i.eventModel=t,i.refreshView()):t.upgradeData(e.repeat,e["new"])}}(this)):e.__super__.doLike.apply(this,arguments)},e.prototype.updateCurrentRecurrence=function(t){var i;return i=u.extend(this.pick(n),t),delete i.recurrence,this.spliceRecurrence().then(function(){return new Promise(function(t,n){return(new e).save(null,{attrs:i,wait:!0,success:t,error:n})})})},e.prototype.updateNextRecurrence=function(t){var i,r,o;return o=this.getRRuleSet(),(i=!o.before(new Date(this.get("startDate")),!1))?this.updateAllRecurrence(t):(r=u.extend(this.pick(n),t),o=this.getRRuleSet(),l.updateRRuleSet(o,{dtstart:new Date(r.startDate)}),r.recurrence=o.valueOf(),this.sliceRecurrence().then(function(){return new Promise(function(t,i){return(new e).save(null,{attrs:r,wait:!0,success:t,error:i})})}))},e.prototype.updateAllRecurrence=function(t){return new Promise(function(e){return function(i,n){return e.save(null,{attrs:t,wait:!0,success:i,error:n})}}(this))},e.prototype.spliceRecurrence=function(){return new Promise(function(t){return function(e,i){var n,r;return r=t.getRRuleSet(),n=t.get("startDate"),r.exdate(new Date(n)),t.save(null,{wait:!0,attrs:{recurrence:r.valueOf()},success:e,error:i})}}(this))},e.prototype.sliceRecurrence=function(){return new Promise(function(t){return function(e,i){var n,r;return n=t.getRRuleSet(),(r=n.before(new Date(t.get("startDate")),!1))?(l.updateRRuleSet(n,{until:r}),t.save(null,{wait:!0,attrs:{recurrence:n.valueOf()},success:e,error:i})):t.deleteEvent().then(e)["catch"](i)}}(this))},e.prototype.updateEvent=function(t,e){switch(t){case"current":return this.updateCurrentRecurrence(e);case"next":return this.updateNextRecurrence(e);default:return this.updateAllRecurrence(e)}},e.prototype.deleteEvent=function(t){switch(t){case"current":return this.spliceRecurrence();case"next":return this.sliceRecurrence();default:return new Promise(function(t){return function(e,i){return t.destroy({wait:!0,success:e,error:i})}}(this))}},e.prototype.archiveEvent=function(t){return"current"===t||"next"===t?this.updateEvent(t).then(function(t){return new Promise(function(e,i){return t.archive({success:e,error:i})})}):new Promise(function(t){return function(e,i){return t.archive({success:e,error:i})}}(this))},e.prototype.updateEventMember=function(t,e){return"current"===t||"next"===t?this.updateEvent(t).then(function(t){return new Promise(function(i,n){return t.saveAttr("involveMembers",null,{attrs:e,success:i,error:n})})}):new Promise(function(t){return function(i,n){return t.saveAttr("involveMembers",null,{attrs:e,success:i,error:n})}}(this))},e.prototype.checkAllDay=function(){var t,e,i,n,r,o;return n=new Date(this.get("startDate")).valueOf(),e=new Date(this.get("endDate")).valueOf(),o=new Date(2015,0,1).valueOf(),t=864e5,i=(e-n)%t,r=(n-o)%t,0===i&&0===r},e.prototype.forkOrMove=function(t,e,i){return i||(i={}),i.url=this.url()+"/"+t,i.attrs=u.extend({_projectId:e},i.attrs),this.sync("update",this,i),this},e}(s)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;r=i(788),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.viewName="TaskIdLabelView",e.prototype.tagName="span",e.prototype.className="label task-id-label",e.prototype.initialize=function(t){if(this.uniqueId=t.uniqueId,this.projectModel=t.projectModel,this.uniqueId&&this.projectModel)return this.render().listen()},e.prototype.listen=function(){return this.listenTo(this.projectModel,"change:applications",function(t){if(t.isAppChanged("taskUniqueId"))return this.render()}),this.listenTo(this.projectModel,"change:uniqueIdPrefix",this.render)},e.prototype.bind=function(t){if(t&&t.length)return this.$el.replaceAll(t)},e.prototype.render=function(){var t,e,i;return this.projectModel.isAppEnabled("taskUniqueId")&&this.uniqueId?(i=this.projectModel.get("uniqueIdPrefix"),e=this.uniqueId,e>99999&&(this.$el.addClass("hinted").data("title",i+"-"+e),e="99999..."),t=i+"-"+e):t="",this.$el.text(t),this},e}(r)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h=function(t,e){function i(){this.constructor=t}for(var n in e)m.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},m={}.hasOwnProperty;l=i(358),d=i(678),p=i(679),u=i(820),c=i(788),r=i(922),a=i(677),n=u.all,s=32,t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.viewName="EmojiView",e.prototype.className="emoji-view hide",e.prototype.index=0,e.prototype.isShowing=!1,e.prototype.swipeThreshold=15,e.prototype.maxIndex=Math.floor(n.length/s),e.prototype.events={"click a.icon-remove":"hide","click .emoji-cell":"selectEmoji","mouseover .emoji-switcher":"switchIndex",wheel:"swipeIndex",mousewheel:function(t){return t.preventDefault()}},e.prototype.initialize=function(t){return null==t&&(t={}),this.options=t,this.$toggler=this.options.$toggler,this.isMulti=this.options.isMulti,this.renderBasic(),this.switchIndex(),this.delegateEmojiEvents()},e.prototype.renderBasic=function(){var t,e,i,o,a,c;for(e=l.groupBy(n,function(t,e){return Math.floor(e/s)}),t=[],i=a=0,c=this.maxIndex;0<=c?a<=c:a>=c;i=0<=c?++a:--a)t.push(e[i]);return o={userId:d.user.id,emojiGroups:t,lang:d.PREFERENCE.getLanguage()},this.$el.html(r(o)),this.$groups=this.$(".emoji-group"),this.$switchers=this.$(".emoji-switcher"),this},e.prototype._switchTo=function(t){return this.index=function(){switch(!1){case!(t<0):return this.maxIndex;case!(t>this.maxIndex):return 0;default:return t}}.call(this),this.$switchers.removeClass("active").eq(this.index).addClass("active"),this.$groups.addClass("hide").eq(this.index).removeClass("hide")},e.prototype.switchIndex=function(t){var e,i;if(e=$(null!=t?t.currentTarget:void 0),i=+e.data("index"),i!==this.index)return this._switchTo(0|i)},e.prototype.swipeIndex=function(t){if(t.preventDefault(),!(Math.abs(t.originalEvent.deltaX)<this.swipeThreshold))return this.scrollIndexCache?this.scrollIndexCache(t):(this.scrollIndexCache=l.debounce(function(t){return function(e){var i;return i=t.index+(e.originalEvent.deltaX>0?1:-1),t._switchTo(0|i),t.swipeThreshold=1e3,clearTimeout(t.swipeResetId1),clearTimeout(t.swipeResetId2),t.swipeResetId1=l.delay(function(){return t.swipeThreshold=50},160),t.swipeResetId2=l.delay(function(){return t.swipeThreshold=15},600)}}(this),20,!0),this.scrollIndexCache(t))},e.prototype.delegateEmojiEvents=function(){return this.$toggler.on("click.emoji",function(t){return function(){return t.toggle()}}(this)),this},e.prototype.selectEmoji=function(t){var e,i;if(i=$(null!=t?t.currentTarget:void 0).data("content"))return"function"==typeof(e=this.options).select&&e.select(i),this.isMulti?void 0:this.hide()},e.prototype.toggle=function(){return this[this.isShowing?"hide":"show"]()},e.prototype.show=function(){return this.$el.handleClickOutside(function(t){return function(e){var i;if(i=t.$toggler[0],e.target!==i&&!$.contains(i,e.target))return t.hide()}}(this),"click.emoji"),this.$el.removeClass("hide"),this.isShowing=!0,this.setupHotKey()},e.prototype.hide=function(){return this.$el.addClass("hide"),this.isShowing=!1,this.removeHotKey()},e}(c)},function(t,e,i){var n,r,o,s,a,c,l,p;c=i(358),n=[{src:i(821),content:{zh:"[微笑]",en:"[smile]"}},{src:i(822),content:{zh:"[嘻嘻]",en:"[smiley]"}},{src:i(823),content:{zh:"[哈哈]",en:"[laughing]"}},{src:i(824),content:{zh:"[爱你]",en:"[love]"}},{src:i(825),content:{zh:"[挖鼻]",en:"[unamused]"}},{src:i(826),content:{zh:"[吃惊]",en:"[surprised]"}},{src:i(827),content:{zh:"[晕]",en:"[confounded]"}},{src:i(828),content:{zh:"[泪]",en:"[sob]"}},{src:i(829),content:{zh:"[馋嘴]",en:"[yum]"}},{src:i(830),content:{zh:"[抓狂]",en:"[grimacing]"}},{src:i(831),content:{zh:"[哼]",en:"[angry]"}},{src:i(832),content:{zh:"[可爱]",en:"[blush]"}},{src:i(833),content:{zh:"[怒]",en:"[rage]"}},{src:i(834),content:{zh:"[汗]",en:"[sweat]"}},{src:i(835),content:{zh:"[害羞]",en:"[shy]"}},{src:i(836),content:{zh:"[睡]",en:"[sleep]"}},{src:i(837),content:{zh:"[钱]",en:"[money]"}},{src:i(838),content:{zh:"[偷笑]",en:"[giggle]"}},{src:i(839),content:{zh:"[笑cry]",en:"[joy]"}},{src:i(840),content:{zh:"[doge]",en:"[doge]"}},{src:i(841),content:{zh:"[喵喵]",en:"[meow]"}},{src:i(842),content:{zh:"[酷]",en:"[sunglasses]"}},{src:i(843),content:{zh:"[衰]",en:"[unfortunate]"}},{src:i(844),content:{zh:"[闭嘴]",en:"[shutup]"}},{src:i(845),content:{zh:"[鄙视]",en:"[despise]"}},{src:i(846),content:{zh:"[色]",en:"[heart_eyes]"}},{src:i(847),content:{zh:"[鼓掌]",en:"[applaud]"}},{src:i(848),content:{zh:"[悲伤]",en:"[cry]"}},{src:i(849),content:{zh:"[思考]",en:"[pensive]"}},{src:i(850),content:{zh:"[生病]",en:"[sick]"}},{src:i(851),content:{zh:"[亲亲]",en:"[kiss]"}},{src:i(852),content:{zh:"[怒骂]",en:"[curse]"}},{src:i(853),content:{zh:"[太开心]",en:"[grinning]"}},{src:i(854),content:{zh:"[白眼]",en:"[supercilious]"}},{src:i(855),content:{zh:"[右哼哼]",en:"[hum_right]"}},{src:i(856),content:{zh:"[左哼哼]",en:"[hum_left]"}},{src:i(857),content:{zh:"[嘘]",en:"[hiss]"}},{src:i(858),content:{zh:"[委屈]",en:"[apologize]"}},{src:i(859),content:{zh:"[吐]",en:"[vomit]"}},{src:i(860),content:{zh:"[可怜]",en:"[empathy]"}},{src:i(861),content:{zh:"[哈欠]",en:"[yawn]"}},{src:i(862),content:{zh:"[挤眼]",en:"[wink]"}},{src:i(863),content:{zh:"[失望]",en:"[disappointed]"}},{src:i(864),content:{zh:"[顶]",en:"[overwhelmed]"}},{src:i(865),content:{zh:"[疑问]",en:"[confused]"}},{src:i(866),content:{zh:"[困]",en:"[sleepy]"}},{src:i(867),content:{zh:"[感冒]",en:"[cold]"}},{src:i(868),content:{zh:"[拜拜]",en:"[bye]"}},{src:i(869),content:{zh:"[黑线]",en:"[speechless]"}},{src:i(870),content:{zh:"[阴险]",en:"[insidious]"}},{src:i(871),content:{zh:"[打脸]",en:"[pia]"}},{src:i(872),content:{zh:"[傻眼]",en:"[astonished]"}},{src:i(873),content:{zh:"[互粉]",en:"[follow]"}},{src:i(874),content:{zh:"[心]",en:"[heart]"}},{src:i(875),content:{zh:"[伤心]",en:"[broken_heart]"}},{src:i(876),content:{zh:"[猪头]",en:"[pig]"}},{src:i(877),content:{zh:"[熊猫]",en:"[panda_face]"}},{src:i(878),content:{zh:"[兔子]",en:"[rabbit]"}},{src:i(879),content:{zh:"[握手]",en:"[handshake]"}},{src:i(880),content:{zh:"[作揖]",en:"[bow]"}},{src:i(881),content:{zh:"[赞]",en:"[+1]"}},{src:i(882),content:{zh:"[耶]",en:"[v]"}},{src:i(883),content:{zh:"[good]",en:"[thumbsup]"}},{src:i(884),content:{zh:"[弱]",en:"[thumbsdown]"}},{src:i(885),content:{zh:"[NO]",en:"[NO]"}},{src:i(886),content:{zh:"[ok]",en:"[ok]"}},{src:i(887),content:{zh:"[haha]",en:"[haha]"}},{src:i(888),content:{zh:"[来]",en:"[come]"}},{src:i(889),content:{zh:"[拳头]",en:"[fist]"}},{src:i(890),content:{zh:"[威武]",en:"[power]"}},{src:i(891),content:{zh:"[鲜花]",en:"[sunflower]"}},{src:i(892),content:{zh:"[钟]",en:"[bell]"}},{src:i(893),content:{zh:"[浮云]",en:"[cloud]"}},{src:i(894),content:{zh:"[飞机]",en:"[airplane]"}},{src:i(895),content:{zh:"[月亮]",en:"[crescent_moon]"}},{src:i(896),content:{zh:"[太阳]",en:"[sunny]"}},{src:i(897),content:{zh:"[微风]",en:"[leaf]"}},{src:i(898),content:{zh:"[下雨]",en:"[rain]"}},{src:i(899),content:{zh:"[给力]",en:"[geili]"}},{src:i(900),content:{zh:"[神马]",en:"[what?]"}},{src:i(901),content:{zh:"[围观]",en:"[onlookers]"}},{src:i(902),content:{zh:"[话筒]",en:"[microphone]"}},{src:i(903),content:{zh:"[奥特曼]",en:"[Altman]"}},{src:i(904),content:{zh:"[草泥马]",en:"[llama]"}},{src:i(905),content:{zh:"[萌]",en:"[cute]"}},{src:i(906),content:{zh:"[囧]",en:"[jiong]"}},{src:i(907),content:{zh:"[织]",en:"[weave]"}},{src:i(908),content:{zh:"[礼物]",en:"[gift]"}},{src:i(909),content:{zh:"[喜]",en:"[happy]"}},{src:i(910),content:{zh:"[围脖]",en:"[weibo]"}},{src:i(911),content:{zh:"[音乐]",en:"[musical_note]"}},{src:i(912),content:{zh:"[绿丝带]",en:"[ribbon]"}},{src:i(913),content:{zh:"[蛋糕]",en:"[cake]"}},{src:i(914),content:{zh:"[蜡烛]",en:"[candle]"}},{src:i(915),content:{zh:"[干杯]",en:"[beer]"}},{src:i(916),content:{zh:"[男孩儿]",en:"[boy]"}},{src:i(917),content:{zh:"[女孩儿]",en:"[girl]"}},{src:i(918),content:{zh:"[肥皂]",en:"[soap]"}},{src:i(919),content:{zh:"[照相机]",en:"[camera]"}},{src:i(920),content:{zh:"[沙尘暴]",en:"[sandstorm]"}},{src:i(921),content:{zh:"[最右]",en:"[right_right]"}}],p=i(678),a="[",o="]",r="emoji",s="normal",l={},c.each(n,function(t){return c.each(t.content,function(e){return l[e]=t.src})}),t.exports={all:n,replaceMD:function(t){var e;return null==t&&(t=""),e=this.translate(t,!0),e.map(function(t){return t.value}).join("")},replace:function(t){var e;return null==t&&(t=""),e=this.translate(t),e.map(function(t){return t.value}).join("")},translate:function(t,e){var i,n,c,l,p,u;for(l=[],i="",p=s,n=0,c=t.length;n<c;n++)u=t[n],u===a?(this.addToken(l,i),i=u,p=r):u===o&&p===r?(this.addEmoji(l,i+u,e),i="",p=s):p===r?i+=u:this.addToken(l,u);return this.addToken(l,i),l},addToken:function(t,e){var i;if(e)return i=t.pop(),(null!=i?i.isEmoji:void 0)&&t.push(i),i&&!i.isEmoji||(i={isEmoji:!1,value:""}),i.value+=e,t.push(i)},addEmoji:function(t,e,i){var n;return n=this.getEmoji(e,i),n?t.push({isEmoji:!0,value:n}):this.addToken(t,e)},getEmoji:function(t,e){var i;return i=l[t],i&&e?" ![emoji]("+i+") ":i?" <img class='emoji' src='"+i+"' alt='"+t+"' /> ":null}}},function(t,e,i){t.exports=i.p+"images/d_hehe@2x.88af0f23.png"},function(t,e,i){t.exports=i.p+"images/d_xixi@2x.bd53db81.png"},function(t,e,i){t.exports=i.p+"images/d_haha@2x.a602eaba.png"},function(t,e,i){t.exports=i.p+"images/d_aini@2x.de154cf5.png"},function(t,e,i){t.exports=i.p+"images/d_wabishi@2x.9d98ca4b.png"},function(t,e,i){t.exports=i.p+"images/d_chijing@2x.7da3908e.png"},function(t,e,i){t.exports=i.p+"images/d_yun@2x.2584982b.png"},function(t,e,i){t.exports=i.p+"images/d_lei@2x.0554653d.png"},function(t,e,i){t.exports=i.p+"images/d_chanzui@2x.a6ad9090.png"},function(t,e,i){t.exports=i.p+"images/d_zhuakuang@2x.8329a52e.png"},function(t,e,i){t.exports=i.p+"images/d_heng@2x.fca8eaa8.png"},function(t,e,i){t.exports=i.p+"images/d_keai@2x.4ffa52b9.png"},function(t,e,i){t.exports=i.p+"images/d_nu@2x.445325cc.png"},function(t,e,i){t.exports=i.p+"images/d_han@2x.9f9a683f.png"},function(t,e,i){t.exports=i.p+"images/d_haixiu@2x.189449c8.png"},function(t,e,i){t.exports=i.p+"images/d_shuijiao@2x.7744d8ed.png"},function(t,e,i){t.exports=i.p+"images/d_qian@2x.88da484d.png"},function(t,e,i){t.exports=i.p+"images/d_touxiao@2x.428dc764.png"},function(t,e,i){t.exports=i.p+"images/d_xiaoku@2x.8be50968.png"},function(t,e,i){t.exports=i.p+"images/d_doge@2x.606dfef8.png"},function(t,e,i){t.exports=i.p+"images/d_miao@2x.bdfbda8d.png"},function(t,e,i){t.exports=i.p+"images/d_ku@2x.165ca95e.png"},function(t,e,i){t.exports=i.p+"images/d_shuai@2x.4a859d59.png"},function(t,e,i){t.exports=i.p+"images/d_bizui@2x.820d4d78.png"},function(t,e,i){t.exports=i.p+"images/d_bishi@2x.ef899bed.png"},function(t,e,i){t.exports=i.p+"images/d_huaxin@2x.55021c62.png"},function(t,e,i){t.exports=i.p+"images/d_guzhang@2x.266f44da.png"},function(t,e,i){t.exports=i.p+"images/d_beishang@2x.50134c12.png"},function(t,e,i){t.exports=i.p+"images/d_sikao@2x.f6e20744.png"},function(t,e,i){t.exports=i.p+"images/d_shengbing@2x.3741e806.png"},function(t,e,i){t.exports=i.p+"images/d_qinqin@2x.bc4a710a.png"},function(t,e,i){t.exports=i.p+"images/d_numa@2x.4b947581.png"},function(t,e,i){t.exports=i.p+"images/d_taikaixin@2x.2df3912a.png"},function(t,e,i){t.exports=i.p+"images/d_landelini@2x.97288a6b.png"},function(t,e,i){t.exports=i.p+"images/d_youhengheng@2x.54e9b9c9.png"},function(t,e,i){t.exports=i.p+"images/d_zuohengheng@2x.e6013694.png"},function(t,e,i){t.exports=i.p+"images/d_xu@2x.0f5c44a5.png"},function(t,e,i){t.exports=i.p+"images/d_weiqu@2x.f896f216.png"},function(t,e,i){t.exports=i.p+"images/d_tu@2x.c58f4342.png"},function(t,e,i){t.exports=i.p+"images/d_kelian@2x.1b9baad0.png"},function(t,e,i){t.exports=i.p+"images/d_dahaqi@2x.a7289817.png"},function(t,e,i){t.exports=i.p+"images/d_jiyan@2x.fb3ea6f3.png"},function(t,e,i){t.exports=i.p+"images/d_shiwang@2x.e0bea7fe.png"},function(t,e,i){t.exports=i.p+"images/d_ding@2x.65298866.png"},function(t,e,i){t.exports=i.p+"images/d_yiwen@2x.2dee9208.png"},function(t,e,i){t.exports=i.p+"images/d_kun@2x.c7add1ba.png"},function(t,e,i){t.exports=i.p+"images/d_ganmao@2x.db381081.png"},function(t,e,i){t.exports=i.p+"images/d_baibai@2x.fc97e68d.png"},function(t,e,i){t.exports=i.p+"images/d_heixian@2x.3b84a11d.png"},function(t,e,i){t.exports=i.p+"images/d_yinxian@2x.53aa1a1c.png"},function(t,e,i){t.exports=i.p+"images/d_dalian@2x.adcc3d97.png"},function(t,e,i){t.exports=i.p+"images/d_shayan@2x.829236e3.png"},function(t,e,i){t.exports=i.p+"images/f_hufen@2x.3a68c91f.png"},function(t,e,i){t.exports=i.p+"images/l_xin@2x.de831b94.png"},function(t,e,i){t.exports=i.p+"images/l_shangxin@2x.c927bc38.png"},function(t,e,i){t.exports=i.p+"images/d_zhutou@2x.41e95b75.png"},function(t,e,i){t.exports=i.p+"images/d_xiongmao@2x.926d2826.png"},function(t,e,i){t.exports=i.p+"images/d_tuzi@2x.46c623da.png"},function(t,e,i){t.exports=i.p+"images/h_woshou@2x.e22ddbc1.png"},function(t,e,i){t.exports=i.p+"images/h_zuoyi@2x.65707ca6.png"},function(t,e,i){t.exports=i.p+"images/h_zan@2x.5aaff69b.png"},function(t,e,i){t.exports=i.p+"images/h_ye@2x.869451d3.png"},function(t,e,i){t.exports=i.p+"images/h_good@2x.3447c6f6.png"},function(t,e,i){t.exports=i.p+"images/h_ruo@2x.9ed6ac20.png"},function(t,e,i){t.exports=i.p+"images/h_buyao@2x.23c937bd.png"},function(t,e,i){t.exports=i.p+"images/h_ok@2x.d359b632.png"},function(t,e,i){t.exports=i.p+"images/h_haha@2x.af8cbd7d.png"},function(t,e,i){t.exports=i.p+"images/h_lai@2x.fa225edd.png"},function(t,e,i){t.exports=i.p+"images/h_quantou@2x.66a97e52.png"},function(t,e,i){t.exports=i.p+"images/f_v5@2x.d1d81fcc.png"},function(t,e,i){t.exports=i.p+"images/w_xianhua@2x.3fc4de87.png"},function(t,e,i){t.exports=i.p+"images/o_zhong@2x.3cb4e102.png"},function(t,e,i){t.exports=i.p+"images/w_fuyun@2x.4f376755.png"},function(t,e,i){t.exports=i.p+"images/o_feiji@2x.073b5ff0.png"},function(t,e,i){t.exports=i.p+"images/w_yueliang@2x.f261f0db.png"},function(t,e,i){t.exports=i.p+"images/w_taiyang@2x.61286876.png"},function(t,e,i){t.exports=i.p+"images/w_weifeng@2x.69b21221.png"},function(t,e,i){t.exports=i.p+"images/w_xiayu@2x.2ad0f264.png"},function(t,e,i){t.exports=i.p+"images/f_geili@2x.1f82c84e.png"},function(t,e,i){t.exports=i.p+"images/f_shenma@2x.99fc2e91.png"},function(t,e,i){t.exports=i.p+"images/o_weiguan@2x.30cfe0c5.png"},function(t,e,i){t.exports=i.p+"images/o_huatong@2x.bab9667d.png"},function(t,e,i){t.exports=i.p+"images/d_aoteman@2x.480f51ec.png"},function(t,e,i){t.exports=i.p+"images/d_shenshou@2x.38be56a9.png"},function(t,e,i){t.exports=i.p+"images/f_meng@2x.6278f804.png"},function(t,e,i){t.exports=i.p+"images/f_jiong@2x.751f832f.png"},function(t,e,i){t.exports=i.p+"images/f_zhi@2x.13038b9e.png"},function(t,e,i){t.exports=i.p+"images/o_liwu@2x.9b5e4f2f.png"},function(t,e,i){t.exports=i.p+"images/f_xi@2x.0a8c928e.png"},function(t,e,i){t.exports=i.p+"images/o_weibo@2x.b5c7de0b.png"},function(t,e,i){t.exports=i.p+"images/o_yinyue@2x.5d746b3e.png"},function(t,e,i){t.exports=i.p+"images/o_lvsidai@2x.8b490321.png"},function(t,e,i){t.exports=i.p+"images/o_dangao@2x.f768c3d8.png"},function(t,e,i){t.exports=i.p+"images/o_lazhu@2x.bfdcee4e.png"},function(t,e,i){t.exports=i.p+"images/o_ganbei@2x.cd8cb434.png"},function(t,e,i){t.exports=i.p+"images/d_nanhaier@2x.c302f4b7.png"},function(t,e,i){t.exports=i.p+"images/d_nvhaier@2x.ce1e6788.png"},function(t,e,i){t.exports=i.p+"images/d_feizao@2x.babf77a3.png"},function(t,e,i){t.exports=i.p+"images/o_zhaoxiangji@2x.f7f35a92.png"},function(t,e,i){
t.exports=i.p+"images/w_shachenbao@2x.adb63f6e.png"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAmdJREFUeNrs2E1rE0EcBvCZZELEFJJDMEJJwF5yKG1AcqgByWUpUkFPKhEvgkfB+in04CcQX269eO4hNCfRW5DSi4QUoeTUvEjYBJINycZnKykNxurCJF3dZyCXpMz/md/O21aOx2Ph5yYJQAACEIAABCAAAQhAAAIQgAAEIAABCEAAfzX17uVzbZ2VDo6lsZ5YuGjNip37e6VSkel0emaugOYsO0CIefBB7wAhNneAVqu1hCX1BQhZL41+kgsI2bkC2Lb9qtFoXBuNRp+A8NQrAGdzAWEqV/CusaGt0NrKlaPy19pVy7I2lFJbte+D1W/H3eJKYsma5wDN0aVzf0+lUkfVavU0l2maq81msxiPxy3de4CIRCLPMN2KKCLwuYevypgNmYueBbNyYTZkZKFQ+BwMBnPazlUpnTUnBoPBzzUWCIhoNHpw6/qyKwSgLSSXqtfr9nA4PPkDXYWczif9OX2j8FCIZVf9LCqXemis3dQ51d7vli+HQqE9FMs5lywU2seTfOC2Hze5/nQPOJlRpdLMXNr3gGQy+SYcDuew8zrT7TWK3Hi0mTm86D1gVq58Pn+odBbBut1qt9uFXq9n4sh58vh29oMXjkFsdlO5DMM4zaUVoN/vb3e73X2ss/sYfNUr94CzuTD4qVxK49OXnU6ngnP2DqZ83yuDd94DJrkw5X/JJd++2P7n3+j+ZhP8XQsInzcCEIAA/m5qEUVwRH7EzcvVlRsXlj1jPbH5XwDgxUa4ebFx7uq4t9tCJOaejf8WJwABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAL4qP0QYADc8qxEhMvS4QAAAABJRU5ErkJggg=="},function(t,e){t.exports=function(t){var e='<section class="emoji-body"> ',i=t.emojiGroups;if(i)for(var n,r=-1,o=i.length-1;r<o;){n=i[r+=1],e+=' <div class="emoji-group"> ';var s=n;if(s)for(var a,c=-1,l=s.length-1;c<l;)a=s[c+=1],e+=' <div class="emoji-cell" data-content="'+(a.content[t.lang]||a.content.zh)+'"> <img src="'+a.src+'" alt="'+(a.content[t.lang]||a.content.zh)+'"> </div> ';e+=" </div> "}e+='</section><footer class="emoji-footer"> ';var p=t.emojiGroups;if(p)for(var n,c=-1,u=p.length-1;c<u;)n=p[c+=1],e+=' <div class="emoji-switcher" data-index="'+c+'"> <div class="emoji-switcher-circle"></div> </div> ';return e+="</footer>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v=function(t,e){function i(){this.constructor=t}for(var n in e)y.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},y={}.hasOwnProperty;d=i(358),g=i(678),h=i(679),c=i(677),o=i(680),l=i(786),a=i(696),s=i(813),p=i(924),r=i(927),n=i(965),m=window.Dropbox,f=function(t,e,i){switch(t){case"remote":e=JSON.stringify({downloadUrl:e,source:t});break;case"dropbox":e=JSON.stringify({files:d.isArray(e)?e:[e],source:t})}return o.ajax({url:h.FILE_HOST+"/forremote",type:"POST",headers:{authorization:g.user.get("strikerAuth")},contentType:"application/json",dataType:"json",data:e,success:i})},t.exports=u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return v(e,t),e.prototype.viewName="WorksPickerView",e.prototype.popoverTitle="",e.prototype.events={"click .library-picker-handler":"attachFromLibrary","click .dropbox-picker-handler":"attachFromDropbox","click .uploader-handler":"hide","click .remote-picker-handler":"attachFromRemote"},e.prototype.initialize=function(){return this.popoverTitle=tb_i18n.get("work.picker.title"),e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){if(this.options._projectId||this.options.collection)return this._projectId=this.options._projectId||this.options.collection._boundToObjectId,this.projectModel=a.getOne(0,this._projectId),this.membersCollection=this.options.membersCollection,this.$el.html(n({dropbox:!!m,permissions:this.projectModel.hasPermissions("work.post")})),this.projectModel.hasPermission("work.post")&&this.initUploader(),this},e.prototype.initUploader=function(){var t;return null!=(t=this.uploaderView)&&t.remove(),this.uploaderView=this.requestSubView(p,{collection:this.options.collection,projectModel:this.projectModel,pick:{id:this.$(".uploader-handler"),multiple:!0},fileSingleSizeLimit:this.projectModel.getPaymentPlan().fileSizeLimit,onStart:function(t){return function(){return t.hide()}}(this)}),this},e.prototype.attachFromLibrary=function(){var t;return this.hide(),null!=(t=this.picker)&&t.remove(),this.picker=this.requestSubView(l).open(r,{_projectId:this._projectId,multiple:!0,onlyWorks:!0,title:tb_i18n.get("work.picker.from.library"),select:function(t){return function(e){var i,n;return n=d.map(e,function(t){return t.toJSON()}),t.options.collection.add(n,{parse:!0}),t.options.collection.trigger("change:completed"),"function"==typeof(i=t.options).success?i.success(e):void 0}}(this)})},e.prototype.attachFromDropbox=function(){var t;if(m)return this.hide(),t={success:function(t){return function(e){return f("dropbox",e,function(e){var i,n,r,o,s,a;if(!e.works)return"function"==typeof(i=t.options).error?i.error(e.message):void 0;for(s=e.works,r=0,o=s.length;r<o;r++)a=s[r],a.progress=1,a.completed=!0;return t.options.collection.add(e.works,{parse:!0}),t.options.collection.trigger("change:completed"),"function"==typeof(n=t.options).success?n.success(e.works):void 0})}}(this),cancel:function(){},linkType:"preview",multiselect:!0},m.choose(t),this},e.prototype.attachFromRemote=function(t){var e,i,n;if(this.hide(),e=this.$(".remote-input-wrap input"),i=e.val().trim())return n=this.options.collection.add({downloadUrl:i,progress:0},{parse:!0}),f("remote",i,function(t){return function(e){var i,r;return e.message?"function"==typeof(i=t.options).error?i.error(e.message):void 0:(e.progress=1,e.completed=!0,n.set(n.parse(e)),"function"==typeof(r=t.options).success?r.success(e):void 0)}}(this)),this},e}(s)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;p=i(358),u=i(678),n=i(401),r=i(925),s=i(788),a=i(786),l=i(810),o=i(926),t.exports=c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.viewName="WorkUploaderView",e.prototype.initialize=function(t){if(null!=t&&t.projectModel&&(t._parentId||t.collection))return t.collection||(t.collection=new l([],{_boundToObjectId:t._parentId})),this.collection=t.collection,this.options=p.extend({accept:null,onCreate:function(e){return function(i){var n;return e.options.isBackground&&!e.collection.inWorksBgUploader&&u.APP.worksBgUploader.addWorks(e.collection,t),i.progress=0,i.completed=!1,n=e.collection.add(i),n.set("completed",!1),n}}(this),onProgress:function(t,e){return e.set("progress",t)},onComplete:function(t,e){return t.thumbnailUrl&&(t.thumbnail=t.thumbnailUrl),e.set(t),e.set("completed",!0)},onError:function(t){return function(e,i){return t.options.isBackground&&n.show({message:tb_i18n.get("works.background.uploader.error"),status:"error"}),t.collection.remove(i)}}(this),errorHandler:function(e){return function(i,n,r){return t.projectModel&&"F_EXCEED_SIZE"===n?e.requestSubView(a).open(o,{projectModel:t.projectModel,fileName:r.name}):i()}}(this)},t),this.uploader=new r(this.options),this},e.prototype.getData=function(){return this.collection.toJSON()},e.prototype.remove=function(){var t,i,n,r,o;return r=this.uploader,r&&(o=r.uploader,n=o.getStats(),(null!=(i=this.options)?i.isBackground:void 0)&&(n.progressNum||n.queueNum)?(t=p.find(o._widgets,function(t){return"dnd"===t.name}),null!=t&&"function"==typeof t.destroy&&t.destroy(),o.on("uploadFinished",function(){return r.destroy()})):r.destroy()),e.__super__.remove.apply(this,arguments)},e}(s)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};a=i(358),d=i(678),l=i(679),n=i(401),o=i(677),s=i(532),u=i(682),c=/\/.*$/,p=["app"],t.exports=r=function(){function t(t){var e,i,r;i=this.setupOptions(t),e=i.onError,i.onError=null,r=this.uploader=s.create(i),this.setupTokenRefresher(),r.on("beforeFileQueued",function(t){var e,i;if(i=t.ext,h.call(p,i)>=0)return e=t.ext,n.show({message:tb_i18n.get("uploader.type.no.allowed",e),status:"error"}),!1}).on("filesQueued",function(e){return Promise.all(e.map(function(t){var e;return t.retry=0,t.category=t.type.replace(c,""),!t.ext&&~t.type.indexOf("image/")&&(e=t.type.slice(6),e&&(t.name+="."+e)),new Promise(function(e){return r.makeThumb(t,function(n,o){var s;return s=i.onCreate({fileName:t.name,fileSize:t.size,fileType:t.ext,fileCategory:t.category,thumbnail:o,thumbnailUrl:o}),s&&(t.model=s,s.removeFile=function(){return r.cancelFile(t),r.removeFile(t,!0)}),e()})})})).then(function(){return d.user.checkStrikerAuth()}).then(function(){return t.auto!==!1&&r.upload(),"function"==typeof i.onQueued?i.onQueued(e):void 0})}).on("uploadStart",function(t){return t.timestamp=Date.now()}).on("uploadProgress",function(t,e){return i.onProgress(.9*e,t.model)}).on("uploadError",function(t,i){return t.retry<1&&"abort"!==i?(t.retry++,r.retry()):(n.show({message:tb_i18n.get("uploader.error"),status:"error"}),r.removeFile(t),e(i,t.model),u.log({"class":"upload",file:t.name,size:t.size,type:t.type,fileKey:"",status:i,time:Date.now()-t.timestamp}))}).on("uploadSuccess",function(t,e){var n;return i.onProgress(1,t.model),delete e._raw,e=null!=(n=t.model)?n.parse(e):void 0,i.onComplete(e,t.model),u.log({file:t.name,type:e.mimeType,size:t.size,fileKey:e.fileKey,status:"ok",time:Date.now()-t.timestamp})}).on("startUpload",function(){return i.onStart(r)}).on("stopUpload",function(){return i.onStop(r)}).on("uploadFinished",function(){return i.onFinish()}).on("error",function(t,e,r){var o;return o=function(){var e;return e=function(){switch(t){case"Q_EXCEED_NUM_LIMIT":return tb_i18n.get("uploader.files.exceed.number",i.fileNumLimit);case"F_EXCEED_SIZE":return tb_i18n.get("uploader.file.exceed.size",r.name);case"F_DUPLICATE":return tb_i18n.get("uploader.files.duplicate");case"Q_TYPE_DENIED":return tb_i18n.get("uploader.not.accept");default:return t}}(),n.error(e)},i.errorHandler?i.errorHandler(o,t,r):o()})}return t.prototype.setupOptions=function(t){return a.extend({headers:{authorization:d.user.get("strikerAuth")},server:l.FILE_HOST+"/upload",dnd:null,paste:null,pick:{id:null,label:"",multiple:!1},accept:{title:"Images",extensions:"gif,jpg,jpeg,bmp,png",mimeTypes:"image/*"},thumb:{width:200,height:200,quality:100,allowMagnify:!0,crop:!1,preserveHeaders:!1,type:"image/jpeg"},compress:!1,prepareNextFile:!0,chunked:!1,chunkSize:524288,chunkRetry:2,threads:3,formdata:null,fileNumLimit:500,fileSingleSizeLimit:1073741824,duplicate:!1,withCredentials:!0,disableGlobalDnd:!1,onCreate:function(t){},onStart:function(t){},onStop:function(t){},onProgress:function(t,e){},onComplete:function(t,e){},onError:function(t,e){},onFinish:function(){}},t)},t.prototype.setupTokenRefresher=function(){var t;return t=function(){return this.uploader.option("headers",{authorization:d.user.get("strikerAuth")})},d.user.on("change:strikerAuth",t,this)},t.prototype.removeTokenRefresher=function(){return d.user.off(null,null,this)},t.prototype.addFile=function(t){return this.uploader.addFile(t)},t.prototype.upload=function(t){return this.uploader.upload(t)},t.prototype.on=function(){return this.uploader.on.apply(this.uploader,arguments)},t.prototype.destroy=function(){return this.removeTokenRefresher(),this.uploader.destroy()},t.prototype.addButton=function(t){return this.uploader.addButton(t)},t}()},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;s=i(358),c=i(678),n=i(805),a=i(679),o=i(798),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="UploaderWarningView",e.prototype.initialize=function(t){var i,n,r,a;return i=null,t.projectModel?(a=t.projectModel.getPaymentPlan().payType,"free"===a?(r=tb_i18n.get("uploader.file.exceed.size.free",t.fileName),n=tb_i18n.get("upgrade"),i=o.pay.plans):(r=tb_i18n.get("uploader.file.exceed.size",t.fileName),n=tb_i18n.get("confirm")),t=s.extend({title:tb_i18n.get("uploader.file.exceed"),content:r,confirmText:n,confirmHref:i},t),c.gta.event({action:"reach plan limit",control:"file size",type:t.projectModel.get("_organizationId")?"business":"plus"})):t=s.extend({title:tb_i18n.get("uploader.file.exceed"),content:tb_i18n.get("uploader.file.exceed.size.default",t.fileName),confirmText:tb_i18n.get("confirm"),confirmHref:i},t),e.__super__.initialize.apply(this,arguments)},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},v={}.hasOwnProperty,y=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};f=i(358),l=i(401),h=i(788),o=i(793),a=i(928),p=i(684),u=i(696),m=i(810),n=i(929),d=i(930),c=i(931),r=i(964),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.viewName="CollectionPickerView",e.prototype.className="collections-picker modal-dialog flex-fill",e.prototype.events={"click .picker-handler":"selectCollectionsOrWorks","click .cancel-handler":"close","click .confirm-handler":"ensureSelected","click .column":"unselect","click .collection-creator":"initCollectionCreator","keydown .collection-creator-input":"quickCreate","click .submit-creator-handler":"createCollection","click .cancel-creator-handler":"cancelCreate"},e.prototype.initialize=function(t){if(null!=t?t._projectId:void 0)return this.projectModel=u.getOne(0,t._projectId),this.projectsCollection=u.get(0),this._defaultCollectionId=this.projectModel.get("_defaultCollectionId"),this._rootCollectionId=this.projectModel.get("_rootCollectionId"),t.onlyWorks=t.multiple||t.onlyWorks,t.onlyWorks&&t.onlyCollections&&(t.onlyCollections=!1),t.onlyWorks&&t.noWorks&&(t.noWorks=!1),t.onlyCollections&&(t.noWorks=!0),this.options=f.extend({multiple:!1,noWorks:!1,onlyWorks:!1,onlyCollections:!1,exclude:[],select:function(){}},t),this.isForkOrMove=t.isForkOrMove,this._projectId=t._projectId,t._parentId&&t._parentId!==this._defaultCollectionId?this.selectedId=t._parentId:this.selectedId=this._rootCollectionId,t.multiple&&(this.selectedIds=[]),this.cache={},this.renderBasic().retrievalParent(this.selectedId),f.delay(function(t){return function(){return t.$el.addClass("in")}}(this)),this},e.prototype.renderBasic=function(){return this.$el.html(n({title:this.options.title||tb_i18n.get("collection.picker.select.collection"),selected:this.options.multiple?null:this.selectedId,permissions:this.projectModel.hasPermissions("collection.post")})),this.$confirmHandler=this.$(".confirm-handler"),this.$collectionCreator=this.$(".collection-creator"),this.$column=this.$(".picker-column"),this},e.prototype.retrievalParent=function(t){var e,i;return i=[t],e=function(t){return function(n){return n?o.fetch(n,{success:function(r){if(t.$el)return n=r.get("_parentId"),t.cache[r.id]=r,n&&i.unshift(n),e(n)},error:function(){return t.renderColumns(i)}}):t.renderColumns(i)}}(this),e(t),this},e.prototype.loadCollection=function(t){var e;return this.currentCollectionId=t,this.showLoadingIndicator(this.$column),e=[],new Promise(function(i){return function(n,r){return a.fetch(t,{attrs:{all:!0,_parentId:t,_projectId:i._projectId},success:function(t){return t.each(function(t){return i.cache[t.id]=t}),e=e.concat(t.models),n()},error:function(t,e){return r(e)}})}}(this)).then(function(i){return function(){return i.options.noWorks?Promise.resolve():new Promise(function(n,r){return m.fetch(t,{attrs:{all:!0,_parentId:t,_projectId:i._projectId},success:function(t){return t.each(function(t){return i.cache[t.id]=t}),e=e.concat(t.models),n()},error:function(t,e){return r(e)}})})}}(this)).then(function(e){return function(){return new Promise(function(i,n){return o.fetch(t,{success:function(t){return e.cache[t.id]=t,i()},error:function(t,e){return n(e)}})})}}(this)).then(function(t){return function(){return t.$el&&t.hideLoadingIndicator({animated:!0}),f.compact(e)}}(this))["catch"](function(t){return l.show({message:t.message||t,status:"error"}),Promise.reject()})},e.prototype.resetView=function(t){return t?t.nextAll().remove():this.$column.html(""),this},e.prototype.renderColumns=function(t){return this.resetView(),this.options.allProjects?this.renderProjects():this.renderColumn([{_id:this._rootCollectionId,objectType:"collection",title:""+this.projectModel.get("name")}]),f.reduce(t,function(t){return function(e,i){return e.then(function(e){return t.loadCollection(i).then(function(t){return e.push(t),e})})}}(this),Promise.resolve([])).then(function(e){return function(i){return f.each(i,function(i,n){return e.renderColumn(i,t[n])}),e.$confirmHandler.prop("disabled",!e.selectedId)}}(this)),this},e.prototype.renderProjects=function(){var t,e;return t=p.get(0),this.$(".column-projects").remove(),e=this.projectsCollection.groupByOrganization(t,"works"),this.isForkOrMove&&(e=this.getDisabledHint(e)),this.$column.prepend(d({projects:e,selectedId:this.options.onlyWorks?null:this.selectedId}))},e.prototype.getDisabledHint=function(t){return f.map(t,function(t){return function(e){var i;return i=function(){switch(e.disabledHint){case"closed":return tb_i18n.get("target.work.closed");case"denied":if("fork"===this.isForkOrMove)return tb_i18n.get("target.work.fork.post.denied");if("move"===this.isForkOrMove)return tb_i18n.get("target.work.move.post.denied");break;default:return""}}.call(t),e.disabledHint=i}}(this)),t},e.prototype.renderColumn=function(t,e){var i,n;if(e!==this._defaultCollectionId)return n=this.formatModels(t,e),i=this.$column.children(".column:last"),i.find(".picker-handler").removeClass("active"),i.find(".picker-handler[data-id="+n._id+"]").addClass("active"),this.$column.append(c(n)),this.$column.animate({scrollLeft:200*this.$column.children().length-this.$column.width()}),this},e.prototype.refreshColumn=function(t,e){var i,n,r;if(r=this.formatModels(t,e),i=this.$(".column[data-id="+r._id+"]"),i.length)return n=$(c(r)),i.replaceWith(n)},e.prototype.selectCollectionsOrWorks=function(t){var e,i,n,r,o;if(i=t.currentTarget?$(t.currentTarget):t,!i.hasClass("disabled")){if(r=i.data("id"),i.hasClass("collection")){if(y.call(this.options.exclude,r)>=0)return;this.options.onlyWorks||(o=r),i.hasClass("selected")?this.$("li.column[data-id="+r+"]").remove():this.loadCollection(r).then(function(t){return function(e){return t.resetView(i.closest("li.column")),t.renderColumn(e,r)}}(this))}else this.options.onlyCollections||(o=r);return this.selectedId=null,o&&i.toggleClass("selected"),this.options.multiple?(e=i.closest("li.column"),this.$column.find("li.column").not(e).find(".picker-handler.selected").removeClass("selected"),this.selectedIds=[],e.find(".picker-handler.selected").each(function(t){return function(e,i){return t.selectedIds.push($(i).data("id"))}}(this)),n=!this.selectedIds.length):(this.$column.find(".picker-handler.selected").not(i).removeClass("selected"),i.hasClass("selected")&&(this.selectedId=o),n=!this.selectedId),this.$confirmHandler.prop("disabled",n),this.$collectionCreator.prop("disabled",n),this}},e.prototype.unselect=function(t){var e;if(!this.$creator&&!$(t.target).closest(".picker-handler").length)return e=$(t.currentTarget).data("id"),this.selectCollectionsOrWorks(this.$(".picker-handler[data-id="+e+"]")),this},e.prototype.ensureSelected=function(t){var e;return this.options.multiple?(e=[],f.each(this.selectedIds,function(t){return function(i){var n;if(n=t.cache[i])return e.push(n)}}(this)),e.length||(e=null)):e=this.cache[this.selectedId]||null,e&&this.options.select(e),this.close(),this},e.prototype.initCollectionCreator=function(t){var e,i,n,o;if(!$(t.currentTarget).prop("disabled")&&(n=this.currentCollectionId,e=this.$(".column[data-id="+n+"]"),e.length))return null!=(o=this.$creator)&&o.remove(),this.$creator=$(r({collectionId:n})),i=e.find(".group-name[data-type=folder]"),i.length?i.after(this.$creator):(i=e.find(".column-wrap"),i.prepend(this.$creator)),e.scrollTop(0),this.$creator.find("input").focusAtEnd(),this},e.prototype.quickCreate=function(t){if(13===t.keyCode)return t.preventDefault(),this.createCollection()},e.prototype.createCollection=function(){var t,e,i,n;if(this.$creator)return t=this.$creator.find("input"),i=t.val().trim(),i?(n=this.currentCollectionId,e=a.get(n),e.create({title:i,_projectId:this._projectId,_parentId:this.currentCollectionId},{wait:!0,success:function(t){return function(i){var r;if(t.$el)return t.cache[i.id]=i,t.cancelCreate(),t.refreshColumn(e.toJSON(),n),r=t.$(".collection[data-id="+i.id+"]"),r.length?t.selectCollectionsOrWorks(r):void 0}}(this)})):this.cancelCreate()},e.prototype.formatModels=function(t,e){var i,n;return n=[],i=[],f.each(t,function(t){return function(r){var o,s,a;if(o=("function"==typeof r.toJSON?r.toJSON():void 0)||r,!o._projectId||(s=t.projectsCollection.get(o._projectId),o._id!==(null!=s?s.get("_defaultCollectionId"):void 0)))return e||(e=o._parentId),o.disabled=(a=r.id,y.call(t.options.exclude,a)>=0),"collection"===o.objectType?n.push(o):i.push(o)}}(this)),{_id:e,folders:n,files:i,selectedId:this.options.onlyWorks?null:this.selectedId}},e.prototype.cancelCreate=function(){return this.$creator.remove(),f.delay(function(t){return function(){return t.$creator=null}}(this),100)},e.prototype.close=function(t){var e,i,n;return null!=(i=this.options)&&"function"==typeof i.onClosed&&i.onClosed(),"WindowView"===(null!=(n=this.parentView)?n.viewName:void 0)?"function"==typeof(e=this.parentView).remove&&e.remove():this.remove(),this},e}(h)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;n=i(685),o=i(793),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.model=o,e.prototype.boundToObjectType="parent",e.prototype.name="collections",e.prototype.orderBy="latest-updated",e.prototype.getSelected=function(){return this.where({_selected_:!0})},e.prototype.getDefault=function(){return this.find(function(t){return"default"===t.get("collectionType")})},e}(n)},function(t,e){t.exports=function(t){var e='<div class="modal-content col-flex"> <header class="modal-header"> <h4 class="modal-title">'+t.title+'</h4> </header> <section class="modal-body"> <ul class="picker-column horizontal-scroll"></ul> </section> <footer class="modal-footer"> ';return t.permissions.collectionPost&&(e+=' <div class="modal-footer-creator"> <button type="button" class="btn btn-link collection-creator" data-gta="{action: \'add content\', type: \'folder\', control: \'Folder Picker Window\'}"> <span class="icon icon-circle-cross"></span> '+tb_i18n.get("collection.picker.creator.tips")+" </button> </div> "),e+=' <button class="cancel-handler btn btn-link">'+tb_i18n.get("cancel")+'</button> <button class="confirm-handler btn btn-primary" disabled="',e+=(t.selected,"false"),e+='">'+tb_i18n.get("confirm")+"</button> </footer></div>"}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li class="column thin-scroll column-projects"> <ul class="column-wrap"> ',n=t.projects;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=" ","groupBy"==r.type?i+=' <li class="group-name"> <p>'+e(r.groupName)+"</p> </li> ":(i+=' <li class="picker-handler clearfix collection ',(r.disabled||r.disabledHint)&&(i+="disabled"),i+=" ",r._rootCollectionId==t.selectedId&&(i+="selected"),i+='" data-id="'+r._rootCollectionId+'"> <span class="collection-title">'+e(r.name)+"</span> ",r.disabledHint&&(i+=' <span class="icon icon-warning hinted" data-title="'+e(r.disabledHint)+'"></span> '),i+=" </li> "),i+=" ";return i+=" </ul></li>"}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(932),o=r.folderIconT,s=r.fileIconT;n+='<li class="column thin-scroll" data-id="'+t._id+'"> <ul class="column-wrap"> ',t.folders.length&&(n+=' <li class="group-name" data-type="folder"> <p>'+tb_i18n.get("collection")+"</p> </li> "),n+=" ";var a=t.folders;if(a)for(var c,l=-1,p=a.length-1;l<p;)c=a[l+=1],n+=' <li class="picker-handler clearfix collection hinted ',c._id==t.selectedId&&(n+="selected"),n+=" ",c.disabled&&(n+="disabled"),n+='" data-title="'+c.title+'" data-id="'+c._id+'"> '+o(c)+' <span class="collection-title">'+e(c.title)+"</span> </li> ";n+=" ",t.files.length&&(n+=' <li class="group-name" data-type="file"> <p>'+tb_i18n.get("file")+"</p> </li> "),n+=" ";var u=t.files;if(u)for(var c,d=-1,h=u.length-1;d<h;)c=u[d+=1],n+=' <li class="picker-handler clearfix work hinted ',c._id==t.selectedId&&(n+="selected"),n+=" ",c.disabled&&(n+="disabled"),n+='" data-title="'+c.fileName+'" data-id="'+c._id+'"> '+s(c)+' <span class="work-title">'+e(c.fileName)+"</span> </li> ";return n+=" </ul></li>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};i(933),r=i(358),l=i(935),c=i(959),o=i(960),s=i(961),a=i(962),n=["task","event","post","entry"],p=function(t){var e,i;return e=function(){switch(t.fileCategory){case"audio":return"music";case"video":return"video";default:return t.fileType}}(),i=function(){switch(e){case"ttf":return"font";case"tiff":return"font";case"svg":return"photo";case"psd":return"photo";case"woff":return"font";case"eot":return"font";case"pptx":return"ppt";case"docx":return"doc";default:return e}}(),l[i]?i:"others"},e.fileIconT=function(t){var e,i,a;return t.thumbnail||t.thumbnailUrl?c(t):(i=t.fileType,u.call(n,i)>=0?o(t):(a=p(t),e=r.extend({},t,{svgIcon:l[a],svgType:a}),s(e)))},e.folderIconT=function(t){return a(r.extend({},t,{svgIcon:l.folder,svgType:"folder"}))}},function(t,e){},,function(t,e,i){t.exports={ae:i(936),ai:i(940),css:i(941),doc:i(942),folder:i(943),font:i(944),html:i(945),js:i(946),key:i(947),music:i(948),numbers:i(949),others:i(950),pdf:i(951),ppt:i(952),photo:i(953),ps:i(954),sketch:i(955),video:i(956),xml:i(957),zip:i(958)}},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 26 32" id="ae" ><path d="M3.269 0c-.456 0-.874.075-1.254.225A3.04 3.04 0 0 0 .988.901c-.304.3-.545.651-.722 1.052C.09 2.353 0 2.754 0 3.155v25.69c0 .4.089.801.266 1.202.177.4.418.751.722 1.052.304.3.647.525 1.027.676.38.15.798.225 1.254.225h19.462c.456 0 .874-.075 1.254-.225a3.04 3.04 0 0 0 1.027-.676c.304-.3.545-.651.722-1.052.177-.4.266-.801.266-1.202V9l-9-9H3.269z"/><path fill="#000000" fill-opacity=".24" d="M18.997 9A1.998 1.998 0 0 1 17 7.003V0l9 9h-7.003z"/><path fill="#FFFFFF" d="M8.726 17.725c.306-1.063.49-1.743.637-2.46h.05c.147.74.318 1.35.65 2.507l.33 1.17H8.37l.356-1.217zM8.1 14l-2.6 8.369h1.889l.552-1.922h2.882l.54 1.922h1.962L10.713 14H8.1zm10.891 6.47a2.127 2.127 0 0 1-1.52.61c-1.178 0-1.668-.586-1.693-1.648h4.133c.074-.525.086-.86.086-1.206 0-1.647-1.018-2.734-2.784-2.734-2 0-3.25 1.302-3.25 3.486 0 2.328 1.116 3.522 3.3 3.522 1.324 0 1.998-.322 2.538-.752l-.81-1.277zm-1.827-3.617c.724 0 1.067.394 1.092 1.134v.251h-2.441c.024-.788.515-1.385 1.349-1.385z" opacity=".8"/></symbol>';t.exports=n.add(r,"ae")},function(t,e,i){var n=i(938),r=new n;document.body?r.elem=r.render(document.body):document.addEventListener("DOMContentLoaded",function(){r.elem=r.render(document.body)},!1),t.exports=r},function(t,e,i){function n(t){return Array.prototype.slice.call(t,0)}function r(t){return t.replace(/\(|\)/g,"\\$&")}function o(t,e,i){var o=t.querySelectorAll(l);o&&n(o).forEach(function(t){t.attributes&&n(t.attributes).forEach(function(n){var o=n.localName.toLowerCase();if(c.indexOf(o)!==-1){var s=p.exec(t.getAttribute(o));if(s&&0===s[1].indexOf(e)){var a=r(i+s[1].split(e)[1]);t.setAttribute(o,"url("+a+")")}}})})}function s(){var t=document.getElementsByTagName("base")[0],e=window.location.href.split("#")[0],i=t&&t.href;this.urlPrefix=i&&i!==e?e+d:d;var r=new a;r.sniff(),this.browser=r.browser,this.content=[],"ie"!==this.browser.name&&i&&window.addEventListener("spriteLoaderLocationUpdated",function(t){var e=this.urlPrefix,i=t.detail.newUrl.split(d)[0]+d;if(o(this.svg,e,i),this.urlPrefix=i,"firefox"===this.browser.name||"edge"===this.browser.name||"chrome"===this.browser.name&&this.browser.version[0]>=49){var r=n(document.querySelectorAll("use[*|href]"));r.forEach(function(t){var n=t.getAttribute(h);n&&0===n.indexOf(e)&&t.setAttributeNS(m,h,i+n.split(d)[1])})}}.bind(this))}var a=i(939),c=["clipPath","colorProfile","src","cursor","fill","filter","marker","markerStart","markerMid","markerEnd","mask","stroke"],l="["+c.join("],[")+"]",p=/^url\((.*)\)$/,u=function(t){for(var e=t.querySelector("defs"),i=t.querySelectorAll("symbol linearGradient, symbol radialGradient, symbol pattern"),n=0,r=i.length;n<r;n++)e.appendChild(i[n])},d="#",h="xlink:href",m="http://www.w3.org/1999/xlink",f='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="'+m+'"',g="</svg>",v="{content}";s.styles=["position:absolute","width:0","height:0","visibility:hidden"],s.spriteTemplate=f+' style="'+s.styles.join(";")+'"><defs>'+v+"</defs>"+g,s.symbolTemplate=f+">"+v+g,s.prototype.content=null,s.prototype.add=function(t,e){return this.svg&&this.appendSymbol(t),this.content.push(t),d+e},s.prototype.wrapSVG=function(t,e){var i=e.replace(v,t),n=(new DOMParser).parseFromString(i,"image/svg+xml").documentElement;return"ie"!==this.browser.name&&this.urlPrefix&&o(n,d,this.urlPrefix),n},s.prototype.appendSymbol=function(t){var e=this.wrapSVG(t,s.symbolTemplate).childNodes[0];this.svg.querySelector("defs").appendChild(e),"firefox"===this.browser.name&&u(this.svg)},s.prototype.toString=function(){var t=document.createElement("div");return t.appendChild(this.render()),t.innerHTML},s.prototype.render=function(t,e){t=t||null,e="boolean"!=typeof e||e;var i=this.wrapSVG(this.content.join(""),s.spriteTemplate);return"firefox"===this.browser.name&&u(i),t&&(e&&t.childNodes[0]?t.insertBefore(i,t.childNodes[0]):t.appendChild(i)),this.svg=i,i},t.exports=s},function(t,e){!function(e){function i(){var t=this;a.forEach(function(e){t[e]={name:s,version:[],versionString:s}})}function n(t,e,i){o[e].forEach(function(n){var o=n[0],a=n[1],c=i.match(o);c&&(t[e].name=a,c[2]?(t[e].versionString=c[2],t[e].version=[]):c[1]?(t[e].versionString=c[1].replace(/_/g,"."),t[e].version=r(c[1])):(t[e].versionString=s,t[e].version=[]))})}function r(t){return t.split(/[\._]/).map(function(t){return parseInt(t)})}var o={browser:[[/msie ([\.\_\d]+)/,"ie"],[/trident\/.*?rv:([\.\_\d]+)/,"ie"],[/firefox\/([\.\_\d]+)/,"firefox"],[/chrome\/([\.\_\d]+)/,"chrome"],[/version\/([\.\_\d]+).*?safari/,"safari"],[/mobile safari ([\.\_\d]+)/,"safari"],[/android.*?version\/([\.\_\d]+).*?safari/,"com.android.browser"],[/crios\/([\.\_\d]+).*?safari/,"chrome"],[/opera/,"opera"],[/opera\/([\.\_\d]+)/,"opera"],[/opera ([\.\_\d]+)/,"opera"],[/opera mini.*?version\/([\.\_\d]+)/,"opera.mini"],[/opios\/([a-z\.\_\d]+)/,"opera"],[/blackberry/,"blackberry"],[/blackberry.*?version\/([\.\_\d]+)/,"blackberry"],[/bb\d+.*?version\/([\.\_\d]+)/,"blackberry"],[/rim.*?version\/([\.\_\d]+)/,"blackberry"],[/iceweasel\/([\.\_\d]+)/,"iceweasel"],[/edge\/([\.\d]+)/,"edge"]],os:[[/linux ()([a-z\.\_\d]+)/,"linux"],[/mac os x/,"macos"],[/mac os x.*?([\.\_\d]+)/,"macos"],[/os ([\.\_\d]+) like mac os/,"ios"],[/openbsd ()([a-z\.\_\d]+)/,"openbsd"],[/android/,"android"],[/android ([a-z\.\_\d]+);/,"android"],[/mozilla\/[a-z\.\_\d]+ \((?:mobile)|(?:tablet)/,"firefoxos"],[/windows\s*(?:nt)?\s*([\.\_\d]+)/,"windows"],[/windows phone.*?([\.\_\d]+)/,"windows.phone"],[/windows mobile/,"windows.mobile"],[/blackberry/,"blackberryos"],[/bb\d+/,"blackberryos"],[/rim.*?os\s*([\.\_\d]+)/,"blackberryos"]],device:[[/ipad/,"ipad"],[/iphone/,"iphone"],[/lumia/,"lumia"],[/htc/,"htc"],[/nexus/,"nexus"],[/galaxy nexus/,"galaxy.nexus"],[/nokia/,"nokia"],[/ gt\-/,"galaxy"],[/ sm\-/,"galaxy"],[/xbox/,"xbox"],[/(?:bb\d+)|(?:blackberry)|(?: rim )/,"blackberry"]]
},s="Unknown",a=Object.keys(o);i.prototype.sniff=function(t){var e=this,i=(t||navigator.userAgent||"").toLowerCase();a.forEach(function(t){n(e,t,i)})},"undefined"!=typeof t&&t.exports?t.exports=i:(e.Sniffr=new i,e.Sniffr.sniff(navigator.userAgent))}(this)},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 26 32" id="ai" ><path d="M3.269 0c-.456 0-.874.075-1.254.225A3.04 3.04 0 0 0 .988.901c-.304.3-.545.651-.722 1.052C.09 2.353 0 2.754 0 3.155v25.69c0 .4.089.801.266 1.202.177.4.418.751.722 1.052.304.3.647.525 1.027.676.38.15.798.225 1.254.225h19.462c.456 0 .874-.075 1.254-.225a3.04 3.04 0 0 0 1.027-.676c.304-.3.545-.651.722-1.052.177-.4.266-.801.266-1.202V9l-9-9H3.269z"/><path fill="#000000" fill-opacity=".24" d="M18.997 9A1.998 1.998 0 0 1 17 7.003V0l9 9h-7.003z"/><path fill="#FFFFFF" d="M10.765 18.15c.31-1.11.497-1.82.646-2.569h.05c.148.773.322 1.409.658 2.619l.335 1.221h-2.049l.36-1.271zm-.633-3.89L7.5 23h1.912l.559-2.007h2.917L13.435 23h1.986l-2.644-8.74h-2.645zM16.49 23h1.874v-7.045H16.49V23zm-.162-8.878c0 .586.472 1.06 1.068 1.06.633 0 1.105-.474 1.105-1.06 0-.648-.472-1.122-1.105-1.122-.596 0-1.068.474-1.068 1.122z" opacity=".8"/></symbol>';t.exports=n.add(r,"ai")},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 26 32" id="css" ><path d="M3.269 0c-.456 0-.874.075-1.254.225A3.04 3.04 0 0 0 .988.901c-.304.3-.545.651-.722 1.052C.09 2.353 0 2.754 0 3.155v25.69c0 .4.089.801.266 1.202.177.4.418.751.722 1.052.304.3.647.525 1.027.676.38.15.798.225 1.254.225h19.462c.456 0 .874-.075 1.254-.225a3.04 3.04 0 0 0 1.027-.676c.304-.3.545-.651.722-1.052.177-.4.266-.801.266-1.202V9l-9-9H3.269z"/><path fill="#000000" fill-opacity=".24" d="M18.997 9A1.998 1.998 0 0 1 17 7.003V0l9 9h-7.003z"/><path fill="#FFFFFF" d="M4.5 18.573C4.5 20.602 5.364 22 7.577 22c1.245 0 1.976-.447 2.284-.796l-.864-1.049a1.663 1.663 0 0 1-1.286.573c-1.08 0-1.595-.845-1.595-2.252 0-1.525.494-2.214 1.46-2.214.762 0 1.102.35 1.339.621l1.029-1.077c-.196-.204-.834-.796-2.254-.796-2.11 0-3.19 1.417-3.19 3.563zm8.582 2.175c-.874 0-1.502-.525-1.81-.816l-.896 1.223c.247.262 1.111.845 2.5.845 1.832 0 2.728-.99 2.728-2.01 0-2.165-3.314-2-3.314-3.097 0-.34.288-.611.803-.611.761 0 1.173.427 1.348.63l.977-1.096c-.236-.292-.988-.816-2.192-.816-1.492 0-2.541.883-2.541 2.01 0 2.145 3.323 2 3.323 3.077 0 .36-.298.66-.926.66zm5.897 0c-.875 0-1.503-.525-1.811-.816l-.896 1.223c.247.262 1.112.845 2.501.845 1.832 0 2.727-.99 2.727-2.01 0-2.165-3.314-2-3.314-3.097 0-.34.289-.611.803-.611.762 0 1.173.427 1.348.63l.978-1.096c-.237-.292-.988-.816-2.192-.816-1.492 0-2.542.883-2.542 2.01 0 2.145 3.324 2 3.324 3.077 0 .36-.298.66-.926.66z" opacity=".8"/></symbol>';t.exports=n.add(r,"css")},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 26 32" id="doc" ><path d="M3.269 0c-.456 0-.874.075-1.254.225A3.04 3.04 0 0 0 .988.901c-.304.3-.545.651-.722 1.052C.09 2.353 0 2.754 0 3.155v25.69c0 .4.089.801.266 1.202.177.4.418.751.722 1.052.304.3.647.525 1.027.676.38.15.798.225 1.254.225h19.462c.456 0 .874-.075 1.254-.225a3.04 3.04 0 0 0 1.027-.676c.304-.3.545-.651.722-1.052.177-.4.266-.801.266-1.202V9l-9-9H3.269z"/><path fill="#000000" fill-opacity=".24" d="M18.997 9A1.998 1.998 0 0 1 17 7.003V0l9 9h-7.003z"/><path fill="#FFFFFF" d="M4 21.903h2.149c2.52 0 3.213-1.816 3.213-3.553 0-2.175-1.006-3.253-3.233-3.253H4v6.806zm1.485-5.583h.537c1.084 0 1.807.525 1.807 2.165 0 1.311-.4 2.195-1.798 2.195h-.546v-4.36zm6.309 2.127c0-1.69.517-2.214 1.25-2.214.83 0 1.348.602 1.348 2.301 0 1.68-.479 2.233-1.26 2.233-.83 0-1.338-.602-1.338-2.32zm4.14.019c0-2.534-1.103-3.466-2.802-3.466-1.66 0-2.872 1.068-2.872 3.544 0 2.543 1.075 3.456 2.784 3.456 1.67 0 2.89-1.058 2.89-3.534zm.9.107c0 2.029.82 3.427 2.92 3.427 1.181 0 1.875-.447 2.168-.796l-.82-1.049a1.548 1.548 0 0 1-1.221.573c-1.026 0-1.514-.845-1.514-2.252 0-1.525.469-2.214 1.387-2.214.722 0 1.045.35 1.27.621L22 15.806c-.186-.204-.791-.796-2.139-.796-2.002 0-3.028 1.417-3.028 3.563z" opacity=".8"/></symbol>';t.exports=n.add(r,"doc")},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 32 32" id="folder" ><path d="M12.77 3H3.155c-.4 0-.801.087-1.202.262-.4.175-.751.412-1.052.711-.3.3-.525.636-.676 1.01C.075 5.359 0 5.77 0 6.22V25.38c0 .45.075.861.225 1.235.15.375.376.711.676 1.01.3.3.651.537 1.052.712.4.175.801.262 1.202.262h25.69c.4 0 .801-.087 1.202-.262.4-.175.751-.412 1.052-.711.3-.3.525-.636.676-1.01.15-.375.225-.787.225-1.236V9.437c0-.449-.075-.873-.225-1.272a2.28 2.28 0 0 0-.676-.973c-.3-.3-.651-.537-1.052-.711a2.986 2.986 0 0 0-1.202-.262H16L12.77 3z"/></symbol>';t.exports=n.add(r,"folder")},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 26 32" id="font" ><path d="M3.269 0c-.456 0-.874.075-1.254.225A3.04 3.04 0 0 0 .988.901c-.304.3-.545.651-.722 1.052C.09 2.353 0 2.754 0 3.155v25.69c0 .4.089.801.266 1.202.177.4.418.751.722 1.052.304.3.647.525 1.027.676.38.15.798.225 1.254.225h19.462c.456 0 .874-.075 1.254-.225a3.04 3.04 0 0 0 1.027-.676c.304-.3.545-.651.722-1.052.177-.4.266-.801.266-1.202V9l-9-9H3.269z"/><path fill="#000000" fill-opacity=".24" d="M18.997 9A1.998 1.998 0 0 1 17 7.003V0l9 9h-7.003z"/><path fill="#FFFFFF" d="M13.75 22v-7h2.5v1.5h2V13H7.75v3.5h2V15h2v7h-1.5v2h5v-2h-1.5z" opacity=".8"/></symbol>';t.exports=n.add(r,"font")},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 26 32" id="html" ><path d="M3.269 0c-.456 0-.874.075-1.254.225A3.04 3.04 0 0 0 .988.901c-.304.3-.545.651-.722 1.052C.09 2.353 0 2.754 0 3.155v25.69c0 .4.089.801.266 1.202.177.4.418.751.722 1.052.304.3.647.525 1.027.676.38.15.798.225 1.254.225h19.462c.456 0 .874-.075 1.254-.225a3.04 3.04 0 0 0 1.027-.676c.304-.3.545-.651.722-1.052.177-.4.266-.801.266-1.202V9l-9-9H3.269z"/><path fill="#000000" fill-opacity=".24" d="M18.997 9A1.998 1.998 0 0 1 17 7.003V0l9 9h-7.003z"/><path fill="#FFFFFF" d="M5.594 17.639l-.594.61.586.616L8.559 22l1.35-1.217-2.974-3.135-.009 1.227 3.064-3.14L8.658 14.5l-3.064 3.139zm10.416-1.903l3.064 3.139-.009-1.227-2.973 3.135L17.442 22l2.972-3.135.586-.617-.594-.609-3.064-3.139-1.332 1.236zm-2.648-.924l-2.451 6.572 1.727.612 2.451-6.572-1.727-.612z" opacity=".8"/></symbol>';t.exports=n.add(r,"html")},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 26 32" id="js" ><path d="M3.269 0c-.456 0-.874.075-1.254.225A3.04 3.04 0 0 0 .988.901c-.304.3-.545.651-.722 1.052C.09 2.353 0 2.754 0 3.155v25.69c0 .4.089.801.266 1.202.177.4.418.751.722 1.052.304.3.647.525 1.027.676.38.15.798.225 1.254.225h19.462c.456 0 .874-.075 1.254-.225a3.04 3.04 0 0 0 1.027-.676c.304-.3.545-.651.722-1.052.177-.4.266-.801.266-1.202V9l-9-9H3.269z"/><path fill="#000000" fill-opacity=".24" d="M18.997 9A1.998 1.998 0 0 1 17 7.003V0l9 9h-7.003z"/><path fill="#FFFFFF" d="M8 21.71c.134.077.63.29 1.507.29 1.517 0 2.146-.754 2.146-1.77v-5.133h-1.579v5.027c0 .406-.144.59-.609.59-.34 0-.743-.145-.98-.31L8 21.71zm7.472-.986c-.878 0-1.507-.522-1.817-.812l-.898 1.218c.248.26 1.115.841 2.508.841 1.837 0 2.735-.986 2.735-2.001 0-2.156-3.323-1.992-3.323-3.085 0-.338.289-.609.805-.609.764 0 1.176.426 1.352.629l.98-1.093c-.237-.29-.99-.812-2.198-.812-1.496 0-2.549.88-2.549 2.001 0 2.137 3.333 1.992 3.333 3.065 0 .358-.299.658-.928.658z" opacity=".8"/></symbol>';t.exports=n.add(r,"js")},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 26 32" id="keynote" ><path d="M3.269 0c-.456 0-.874.075-1.254.225A3.04 3.04 0 0 0 .988.901c-.304.3-.545.651-.722 1.052C.09 2.353 0 2.754 0 3.155v25.69c0 .4.089.801.266 1.202.177.4.418.751.722 1.052.304.3.647.525 1.027.676.38.15.798.225 1.254.225h19.462c.456 0 .874-.075 1.254-.225a3.04 3.04 0 0 0 1.027-.676c.304-.3.545-.651.722-1.052.177-.4.266-.801.266-1.202V9l-9-9H3.269z"/><path fill="#000000" fill-opacity=".24" d="M18.997 9A1.998 1.998 0 0 1 17 7.003V0l9 9h-7.003z"/><path fill="#FFFFFF" d="M13.742 17.615v5.198c1.413.149 2.477.798 2.477 1.577 0 .89-1.386 1.61-3.097 1.61-1.71 0-3.096-.72-3.096-1.61 0-.753.995-1.385 2.34-1.561v-5.214H6.736c-.495 0-.817-.404-.725-.877l.75-3.86c.094-.485.574-.878 1.063-.878h10.35c.493 0 .971.404 1.063.877l.75 3.86c.094.485-.227.878-.725.878h-5.521z" opacity=".8"/></symbol>';t.exports=n.add(r,"keynote")},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 26 32" id="music" ><path d="M3.269 0c-.456 0-.874.075-1.254.225A3.04 3.04 0 0 0 .988.901c-.304.3-.545.651-.722 1.052C.09 2.353 0 2.754 0 3.155v25.69c0 .4.089.801.266 1.202.177.4.418.751.722 1.052.304.3.647.525 1.027.676.38.15.798.225 1.254.225h19.462c.456 0 .874-.075 1.254-.225a3.04 3.04 0 0 0 1.027-.676c.304-.3.545-.651.722-1.052.177-.4.266-.801.266-1.202V9l-9-9H3.269z"/><path fill="#000000" fill-opacity=".24" d="M18.997 9A1.998 1.998 0 0 1 17 7.003V0l9 9h-7.003z"/><path fill="#FFFFFF" d="M10.657 14.956v6.21c-.706 0-1.209.026-1.799.34-1.172.623-1.684 1.83-1.142 2.693.542.865 1.93 1.06 3.103.436 1.008-.536 1.309-1.519 1.309-2.314v-6.349l4.901-1.13v4.97c-.664 0-1.208.024-1.798.338-1.172.624-1.684 1.83-1.143 2.694.542.864 1.931 1.06 3.103.436 1.009-.536 1.309-1.553 1.309-2.314v-8.174c0-.552-.444-.896-.977-.773l-5.888 1.357c-.54.124-.978.668-.978 1.224v.356z" opacity=".8"/></symbol>';t.exports=n.add(r,"music")},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 26 32" id="numbers" ><path d="M3.269 0c-.456 0-.874.075-1.254.225A3.04 3.04 0 0 0 .988.901c-.304.3-.545.651-.722 1.052C.09 2.353 0 2.754 0 3.155v25.69c0 .4.089.801.266 1.202.177.4.418.751.722 1.052.304.3.647.525 1.027.676.38.15.798.225 1.254.225h19.462c.456 0 .874-.075 1.254-.225a3.04 3.04 0 0 0 1.027-.676c.304-.3.545-.651.722-1.052.177-.4.266-.801.266-1.202V9l-9-9H3.269z"/><path fill="#000000" fill-opacity=".24" d="M18.997 9A1.998 1.998 0 0 1 17 7.003V0l9 9h-7.003z"/><path fill="#FFFFFF" d="M5 17.252c0-.415.341-.752.752-.752h2.496c.415 0 .752.342.752.752v7.496a.755.755 0 0 1-.752.752H5.752A.755.755 0 0 1 5 24.748v-7.496zm6-5c0-.415.341-.752.752-.752h2.496a.75.75 0 0 1 .752.753v12.494a.755.755 0 0 1-.752.753h-2.496a.75.75 0 0 1-.752-.753V12.253zm6 6.997c0-.414.341-.749.752-.749h2.496c.415 0 .752.338.752.75v5.5c0 .415-.341.75-.752.75h-2.496a.752.752 0 0 1-.752-.75v-5.5z" opacity=".8"/></symbol>';t.exports=n.add(r,"numbers")},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 26 32" id="others" ><path d="M3.269 0c-.456 0-.874.075-1.254.225A3.04 3.04 0 0 0 .988.901c-.304.3-.545.651-.722 1.052C.09 2.353 0 2.754 0 3.155v25.69c0 .4.089.801.266 1.202.177.4.418.751.722 1.052.304.3.647.525 1.027.676.38.15.798.225 1.254.225h19.462c.456 0 .874-.075 1.254-.225a3.04 3.04 0 0 0 1.027-.676c.304-.3.545-.651.722-1.052.177-.4.266-.801.266-1.202V9l-9-9H3.269z"/><path fill="#000000" fill-opacity=".24" d="M19.164 9a1.998 1.998 0 0 1-1.997-1.997V0l9 9h-7.003z"/><path fill="#FFFFFF" stroke="#FFFFFF" stroke-width=".5" d="M16.504 15.115a2.158 2.158 0 0 0-2.149-2.149 2.126 2.126 0 0 0-2.135 2.136l.013 4.284-1.223-.004-.013-4.284a3.34 3.34 0 0 1 3.355-3.355 3.39 3.39 0 0 1 3.375 3.375l.016 4.896-1.224-.003-.015-4.896zm-2.75 1.522a.607.607 0 0 1 .611-.61c.338 0 .613.275.614.613l.008 2.754a1.974 1.974 0 0 1-1.983 1.983 2.004 2.004 0 0 1-1.994-1.995l1.223.004a.771.771 0 0 0 .768.767c.423.001.764-.34.762-.762l-.008-2.754zm-4.267 1.065l-.006 2.287a3.546 3.546 0 0 0 3.53 3.53 3.494 3.494 0 0 0 3.508-3.508l1.224.003a4.707 4.707 0 0 1-4.729 4.729 4.779 4.779 0 0 1-4.757-4.757l.006-2.287c0-.338.272-.611.61-.61.34 0 .614.275.614.613z" opacity=".8"/></symbol>';t.exports=n.add(r,"others")},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 26 32" id="pdf" ><path d="M3.269 0c-.456 0-.874.075-1.254.225A3.04 3.04 0 0 0 .988.901c-.304.3-.545.651-.722 1.052C.09 2.353 0 2.754 0 3.155v25.69c0 .4.089.801.266 1.202.177.4.418.751.722 1.052.304.3.647.525 1.027.676.38.15.798.225 1.254.225h19.462c.456 0 .874-.075 1.254-.225a3.04 3.04 0 0 0 1.027-.676c.304-.3.545-.651.722-1.052.177-.4.266-.801.266-1.202V9l-9-9H3.269z"/><path fill="#000000" fill-opacity=".24" d="M18.997 9A1.998 1.998 0 0 1 17 7.003V0l9 9h-7.003z"/><path fill="#FFFFFF" d="M6.914 15H4.5v7h1.54v-2.486h.582c2.063 0 2.757-1.129 2.757-2.437C9.379 15.529 8.343 15 6.914 15zm-.251 1.288c.784 0 1.126.31 1.126.999 0 .539-.221.978-1.247.978h-.503v-1.977h.624zM10.525 22h2.213c2.596 0 3.31-1.867 3.31-3.655 0-2.237-1.036-3.345-3.33-3.345h-2.193v7zm1.53-5.742h.553c1.116 0 1.86.54 1.86 2.227 0 1.348-.412 2.257-1.85 2.257h-.564v-4.484zm6.8 5.742v-2.626h2.273v-1.258h-2.274v-1.858H21.5V15h-4.175v7h1.53z" opacity=".8"/></symbol>';t.exports=n.add(r,"pdf")},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 26 32" id="ppt" ><path d="M3.269 0c-.456 0-.874.075-1.254.225A3.04 3.04 0 0 0 .988.901c-.304.3-.545.651-.722 1.052C.09 2.353 0 2.754 0 3.155v25.69c0 .4.089.801.266 1.202.177.4.418.751.722 1.052.304.3.647.525 1.027.676.38.15.798.225 1.254.225h19.462c.456 0 .874-.075 1.254-.225a3.04 3.04 0 0 0 1.027-.676c.304-.3.545-.651.722-1.052.177-.4.266-.801.266-1.202V9l-9-9H3.269z"/><path fill="#000000" fill-opacity=".24" d="M18.997 9A1.998 1.998 0 0 1 17 7.003V0l9 9h-7.003z"/><path fill="#FFFFFF" d="M7.369 15H5v7h1.51v-2.486h.573c2.023 0 2.704-1.129 2.704-2.437C9.787 15.529 8.771 15 7.37 15zm-.247 1.288c.77 0 1.106.31 1.106.999 0 .539-.218.978-1.224.978H6.51v-1.977h.612zM13.282 15h-2.37v7h1.51v-2.486h.573c2.024 0 2.705-1.129 2.705-2.437C15.7 15.529 14.683 15 13.28 15zm-.247 1.288c.77 0 1.105.31 1.105.999 0 .539-.217.978-1.224.978h-.493v-1.977h.612zM17.772 22h1.51v-5.742H21V15h-4.945v1.258h1.717V22z" opacity=".8"/></symbol>';t.exports=n.add(r,"ppt")},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 26 32" id="photo" ><path d="M3.269 0c-.456 0-.874.075-1.254.225A3.04 3.04 0 0 0 .988.901c-.304.3-.545.651-.722 1.052C.09 2.353 0 2.754 0 3.155v25.69c0 .4.089.801.266 1.202.177.4.418.751.722 1.052.304.3.647.525 1.027.676.38.15.798.225 1.254.225h19.462c.456 0 .874-.075 1.254-.225a3.04 3.04 0 0 0 1.027-.676c.304-.3.545-.651.722-1.052.177-.4.266-.801.266-1.202V9l-9-9H3.269z"/><path fill="#000000" fill-opacity=".24" d="M18.997 9A1.998 1.998 0 0 1 17 7.003V0l9 9h-7.003z"/><path fill="#FFFFFF" d="M6.5 12.991c0-.823.663-1.491 1.491-1.491H18.01c.823 0 1.491.663 1.491 1.491V23.01c0 .823-.663 1.491-1.491 1.491H7.99A1.488 1.488 0 0 1 6.5 23.009V12.99zm5.796 8.181l-1.813-2.46v.037L8 22.346l10 .038-3.221-4.884-2.483 3.672zM9.6 16.6a1 1 0 1 0 0-2 1 1 0 0 0 0 2z" opacity=".8"/></symbol>';t.exports=n.add(r,"photo")},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 26 32" id="ps" ><path d="M3.269 0c-.456 0-.874.075-1.254.225A3.04 3.04 0 0 0 .988.901c-.304.3-.545.651-.722 1.052C.09 2.353 0 2.754 0 3.155v25.69c0 .4.089.801.266 1.202.177.4.418.751.722 1.052.304.3.647.525 1.027.676.38.15.798.225 1.254.225h19.462c.456 0 .874-.075 1.254-.225a3.04 3.04 0 0 0 1.027-.676c.304-.3.545-.651.722-1.052.177-.4.266-.801.266-1.202V9l-9-9H3.269z"/><path fill="#000000" fill-opacity=".24" d="M18.997 9A1.998 1.998 0 0 1 17 7.003V0l9 9h-7.003z"/><path fill="#FFFFFF" d="M10.01 14H7v8.873h1.918v-3.151h.728c2.57 0 3.436-1.43 3.436-3.09 0-1.961-1.292-2.632-3.073-2.632zm-.314 1.633c.978 0 1.404.392 1.404 1.266 0 .683-.276 1.24-1.555 1.24h-.627v-2.506h.778zm7.423 5.253c0 .33-.226.608-.815.608-.853 0-1.542-.52-1.856-.886l-1.128 1.316c.388.418 1.329 1.076 2.884 1.076C18.26 23 19 21.722 19 20.772c0-2.392-3.335-2.013-3.335-3.088 0-.33.275-.557.702-.557.652 0 1.14.38 1.392.67l1.216-1.202c-.464-.544-1.28-1-2.558-1-1.643 0-2.633 1.05-2.633 2.215 0 2.38 3.335 2.038 3.335 3.076z" opacity=".8"/></symbol>';t.exports=n.add(r,"ps")},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 26 32" id="sketch" ><path d="M3.269 0c-.456 0-.874.075-1.254.225A3.04 3.04 0 0 0 .988.901c-.304.3-.545.651-.722 1.052C.09 2.353 0 2.754 0 3.155v25.69c0 .4.089.801.266 1.202.177.4.418.751.722 1.052.304.3.647.525 1.027.676.38.15.798.225 1.254.225h19.462c.456 0 .874-.075 1.254-.225a3.04 3.04 0 0 0 1.027-.676c.304-.3.545-.651.722-1.052.177-.4.266-.801.266-1.202V9l-9-9H3.269z"/><path fill="#000000" fill-opacity=".24" d="M18.997 9A1.998 1.998 0 0 1 17 7.003V0l9 9h-7.003z"/><path fill="#FFFFFF" d="M10.265 16.15h5.486l-2.742 8.35-2.744-8.35zm6.02 0l3.715.016-6.22 7.732 2.506-7.747zm-6.57 0L6 16.167l6.22 7.732-2.506-7.747zm10.18-.566h-3.652L13.662 12h4.064l2.169 3.584zm-13.793.026h3.652l2.581-3.585H8.271L6.102 15.61zm4.304.03h5.173l-2.589-3.625-2.584 3.624z" opacity=".8"/></symbol>';t.exports=n.add(r,"sketch")},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 26 32" id="video" ><path d="M3.269 0c-.456 0-.874.075-1.254.225A3.04 3.04 0 0 0 .988.901c-.304.3-.545.651-.722 1.052C.09 2.353 0 2.754 0 3.155v25.69c0 .4.089.801.266 1.202.177.4.418.751.722 1.052.304.3.647.525 1.027.676.38.15.798.225 1.254.225h19.462c.456 0 .874-.075 1.254-.225a3.04 3.04 0 0 0 1.027-.676c.304-.3.545-.651.722-1.052.177-.4.266-.801.266-1.202V9l-9-9H3.269z"/><path fill="#000000" fill-opacity=".24" d="M18.997 9A1.998 1.998 0 0 1 17 7.003V0l9 9h-7.003z"/><path fill="#FFFFFF" d="M19.182 12a.755.755 0 0 0-.554.242l-2.192 2.228a2.56 2.56 0 0 0-.739 1.798v3.464c0 .67.264 1.315.74 1.798l2.19 2.228c.159.16.344.242.555.242a.8.8 0 0 0 .554-.214.782.782 0 0 0 .264-.617V12.834a.827.827 0 0 0-.818-.834zM6 14.472c0-.823.667-1.49 1.494-1.49h5.702c.825 0 1.494.674 1.494 1.49v6.834c0 .823-.668 1.49-1.494 1.49H7.494A1.497 1.497 0 0 1 6 21.307v-6.834z" opacity=".8"/></symbol>';t.exports=n.add(r,"video")},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 26 32" id="xml" ><path d="M3.269 0c-.456 0-.874.075-1.254.225A3.04 3.04 0 0 0 .988.901c-.304.3-.545.651-.722 1.052C.09 2.353 0 2.754 0 3.155v25.69c0 .4.089.801.266 1.202.177.4.418.751.722 1.052.304.3.647.525 1.027.676.38.15.798.225 1.254.225h19.462c.456 0 .874-.075 1.254-.225a3.04 3.04 0 0 0 1.027-.676c.304-.3.545-.651.722-1.052.177-.4.266-.801.266-1.202V9l-9-9H3.269z"/><path fill="#000000" fill-opacity=".24" d="M18.997 9A1.998 1.998 0 0 1 17 7.003V0l9 9h-7.003z"/><path fill="#FFFFFF" d="M6.1 19.73L7.41 22h1.83L7 18.42l2.12-3.43H7.36l-1.12 2.15H6.2l-1.18-2.15H3.18l2.13 3.43L3.06 22h1.76l1.24-2.27h.04zm7.71-.96l-1.33-3.78h-2.35V22h1.4v-5.19h.06l1.54 4.35h1.26l1.56-4.35h.04V22h1.46v-7.01h-2.29l-1.31 3.78h-.04zm5.28-3.78V22h4.11v-1.26h-2.58v-5.75h-1.53z"/></symbol>';t.exports=n.add(r,"xml")},function(t,e,i){var n=i(937),r='<symbol viewBox="0 0 26 32" id="zip" ><path d="M3.436 0C2.98 0 2.56.075 2.18.225a3.04 3.04 0 0 0-1.026.676c-.304.3-.545.651-.722 1.052-.178.4-.266.801-.266 1.202v25.69c0 .4.088.801.266 1.202.177.4.418.751.722 1.052.304.3.646.525 1.026.676.38.15.799.225 1.255.225h19.462c.456 0 .874-.075 1.254-.225a3.04 3.04 0 0 0 1.026-.676c.304-.3.545-.651.723-1.052.177-.4.266-.801.266-1.202V9l-9-9H3.436z"/><g fill="#FFFFFF" opacity=".8"><path d="M11.167 23h2v2h-2zM13.167 21h2v2h-2zM11.167 19h2v2h-2zM13.167 17h2v2h-2zM11.167 15h2v2h-2zM13.167 13h2v2h-2z"/></g><path fill="#FFFFFF" d="M11.167 26h4v4h-4z" opacity=".8"/><path fill="#000000" fill-opacity=".24" d="M19.164 9a1.998 1.998 0 0 1-1.997-1.997V0l9 9h-7.003z"/></symbol>';t.exports=n.add(r,"zip")},function(t,e){t.exports=function(t){var e="",i=t.thumbnail||t.thumbnailUrl;return e+='<span class="work-icon" icon-type="image" style="background-image: url('+i+');"></span>'}},function(t,e){t.exports=function(t){var e='<span class="work-icon" icon-type="app"> <span class="icon icon-'+t.fileType+'"></span></span>';return e}},function(t,e){t.exports=function(t){var e='<span class="work-icon" icon-type="file"> <svg class="svg-icon on-'+t.svgType+'" aria-hidden="true"> <use xlink:href="'+t.svgIcon+'"></use> </svg></span>';return e}},function(t,e,i){t.exports=function(t){var e="",n=i(963).calculateColor;return e+='<span class="work-icon" icon-type="folder"> <svg class="svg-icon on-'+t.svgType+'" aria-hidden="true" style="fill: '+n(t.color,t.colorRGBA)+'"> <use xlink:href="'+t.svgIcon+'"></use> </svg></span>'}},function(t,e,i){var n;n=i(358),e.COLOR_MAP={red:"#ff5722",yellow:"#ffc107",green:"#bbc34a",blue:"#03a9f4",purple:"#ab47bc",gray:"#a6a6a6"},e.COLORS=n.values(e.COLOR_MAP),e.COLOR_INVERT=n.invert(e.COLOR_MAP),e.calculateColor=function(t,i){return i?"#"+i.slice(0,6):e.COLOR_MAP[t]||e.COLOR_MAP.blue},e.transformToServerColor=function(t){return e.COLOR_INVERT[t]||"blue"}},function(t,e){t.exports=function(t){var e='<li class="clearfix collection collection-creator-wrap row-flex" data-id="'+t.collectionId+'"> <section> <input type="text" class="collection-creator-input form-control" placeholder="'+tb_i18n.get("collection.picker.creator.input.tips")+'" /> </section> <footer> <div class="clearfix"> <button class="btn btn-link btn-small submit-creator-handler">'+tb_i18n.get("confirm")+'</button> <button class="btn btn-link btn-small cancel-creator-handler">'+tb_i18n.get("cancel")+"</button> </div> </footer></li>";return e}},function(t,e,i){t.exports=function(t){var e="",n=i(679),r=n.FEATURES;return e+='<ul class="list works-picker"> ',t.permissions.workPost&&(e+=' <li> <a class="uploader-handler" data-gta="event" data-label="Choose file from computer"> <span class="icon icon-upload"></span>'+tb_i18n.get("work.picker.uploader")+' </a> </li> <li class="list-divider"></li> '),e+=' <li> <a class="library-picker-handler" data-gta="event" data-label="Choose file from library"> <span class="icon icon-folder"></span>'+tb_i18n.get("work.picker.from.library")+" </a> </li> ",t.dropbox&&r.upload_dropbox&&(e+=' <li> <a class="dropbox-picker-handler" data-gta="event" data-label="Choose file from dropbox"> <span class="icon icon-dropbox"></span>'+tb_i18n.get("work.picker.from.dropbox")+" </a> </li> "),e+=" ",t.permissions.workPost&&(e+=' <li class="list-divider"></li> <li class="remote-input-wrap"> <input type="text" placeholder="'+tb_i18n.get("work.picker.from.link")+'" class="form-control pull-left"/> <span class="btn btn-default remote-picker-handler pull-right">'+tb_i18n.get("add")+"</span> </li> "),e+="</ul>"}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(358),n=i(967),r=i(793),o=i(696),s=i(788),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="WorkNewView",e.prototype.tagName="li",e.prototype.className="work creating",e.prototype.events={"click .delete-work-handler":"deleteWork"},e.prototype.initialize=function(t){if(null!=t?t.workModel:void 0)return this.options=t,this.workModel=t.workModel,this.renderBasic().listen(),this},e.prototype.listen=function(){return this.listenTo(this.workModel,"change:_id",this.renderId),this.listenTo(this.workModel,"change:thumbnail",this.renderImage),this.listenTo(this.workModel,"change:progress",this.onProgress),this.listenTo(this.workModel,"change:completed",this.onComplete),this.listenTo(this.workModel,"remove destroy",this.remove),this.listenTo(this.workModel,"change:filename change:downloadUrl",this.renderTitle),this},e.prototype.renderBasic=function(){var t,e,i;return e=this.workModel.getFormatData(),i=this.options.isBackground?"workUploadTo":null,this.$el.html(n(e,i)).attr("data-cid",this.workModel.cid),this.$progressBar=this.$(".progress-bar"),this.workModel.id?this.renderId():this.workModel.get("progress")||(c.delay(function(t){return function(){return t.$progressBar.css({"min-width":"10%"})}}(this),100),this.$el.css("opacity",.7)),this.options.isBackground&&(t=this.workModel.collection._boundToObjectId,r.fetch(t,{success:function(t){return function(e){var i,n;return n=e.get("title"),"root"===e.get("collectionType")&&(i=o.getOne(0,e.get("_projectId")),n=i.get("name")),t.$(".work-item-subtitle").text(n)}}(this)})),this},e.prototype.renderId=function(){return this.$el.data("id",this.workModel.id),this},e.prototype.renderImage=function(){var t,e;return(e=this.workModel.get("thumbnail"))?this.$(".work-thumbnail").attr("class","work-thumbnail image").css("background-image","url("+e+")").empty():(t=this.workModel.getFormatData(),this.$(".work-thumbnail").attr("class","work-thumbnail "+t.fileType).html(t.thumbnailText)),this},e.prototype.renderTitle=function(){var t;return t=this.workModel.get("fileName")||this.workModel.get("downloadUrl"),this.$(".work-filename").text(t),this},e.prototype.onProgress=function(){var t,e;return e=this.workModel.get("progress")||0,t=this.$progressBar,e>=.9?t.css({width:"100%"}):t.css({width:Math.ceil(100*e)+"%"}),this},e.prototype.onComplete=function(){return this.$el.css("opacity",""),this.$progressBar.remove(),this.options.isBackground&&this.$(".delete-work-handler").attr("class","icon icon-tick"),this},e.prototype.deleteWork=function(t){var e,i;return t.stopPropagation(),"function"==typeof(e=this.workModel).removeFile&&e.removeFile(),null!=(i=this.workModel.collection)&&i.remove(this.workModel),this},e}(s)},function(t,e,i){t.exports=function(t){var e="",n=i(968),r=arguments[1];return e+='<div class="work-content"> '+n(t,r)+' <a class="delete-work-handler icon icon-remove"></a></div><div class="progress-bar"></div>'}},function(t,e,i){var n;i(969),n=i(971),t.exports=function(t,e){return n(t,e)}},function(t,e){},,function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(932).fileIconT,o=arguments[1];return n+='<div class="work-item row-flex"> <header class="work-item-icon">'+r(t)+'</header> <section class="work-item-content ',o&&(n+="with-subtitle"),n+='"> <span class="work-item-name">'+e(t.fileName||t.downloadUrl)+"</span> ",o&&(n+="<br>"),n+=' <span class="work-item-subtitle">'+e(t[o]||"")+"</span> </section></div>"}},function(t,e){t.exports=function(t){var e='<div class="activity-creator-wrap ';return t.user.permissions.workPost||(e+="no-attachments-handler"),e+='"> ',t.user.isGhost?e+=" "+tb_i18n.get("activity.timeline.comment.ghost")+" ":(e+=' <div class="activity-creator-fast-emoji"></div> <div class="comment-box-wrap"> <div class="comment-box-icon-wrap"> ',t.isShowCropBtn&&(e+=' <a class="screen-crop-handler icon icon-crop hinted" data-title="'+tb_i18n.get("screen.crop")+'"></a> '),e+=' <a class="open-emoji-handler icon icon-emoji hinted" data-title="'+tb_i18n.get("activity.timeline.add.emoji")+'" data-type="fast" data-gta="event" data-label="activity add emoji"></a> ',t.user.permissions.workPost&&(e+=' <a class="add-work-handler icon icon-paperclip hinted" data-title="'+tb_i18n.get("activity.timeline.add.attachment")+"\" data-gta=\"{action: 'add content', type: 'file', control: 'Comment Attachment'}\"></a> "),e+=' </div> <div class="comment-box-input-wrap"> <textarea type="text" placeholder="',e+=t.quickReply?""+tb_i18n.get("activity.timeline.comment"):""+tb_i18n.get("activity.timeline.reply.quickly.placeholder"),e+='" class="form-control comment-input"></textarea> </div> <ul class="attachments-list scrollable thin-scroll clearfix"></ul> </div> <div class="activity-creator-active-emoji"></div> <div class="activity-handler clearfix"> ',t.user.permissions.workPost&&(e+=' <a class="add-work-handler pull-left hinted" data-title="'+tb_i18n.get("activity.timeline.add.attachment")+"\" data-gta=\"{action: 'add content', type: 'work', control: 'Comment Attachment'}\"> <span class=\"icon icon-paperclip\"></span> </a> "),e+=' <a class="open-emoji-handler pull-left hinted" data-title="'+tb_i18n.get("activity.timeline.add.emoji")+'" data-type="active" data-gta="event" data-label="activity add emoji"> <span class="icon icon-emoji"></span> </a> ',t.isShowCropBtn&&(e+=' <a class="screen-crop-handler pull-left hinted" data-title="'+tb_i18n.get("screen.crop")+'"> <span class="icon icon-crop"></span> </a> '),e+=' <div class="btn-group pull-right reply-btn"> <button type="button" class="btn btn-primary reply-handler" data-gta="{action: \'comment\', control: \'Comment Button\'}"> '+tb_i18n.get("activity.timeline.reply")+' </button> <button type="button" class="btn btn-primary dropdown-toggle enter-short-key" data-toggle="dropdown"> <span class="icon icon-chevron-down"></span> <span class="sr-only">Enter short key toggle dropdown</span> </button> <ul class="dropdown-menu reply-menu" role="menu" aria-labelledby="dLabel"> <li><a class="',t.quickReply&&(e+="active"),e+='" data-type="only-enter"><span>'+tb_i18n.get("activity.timeline.reply.enter")+'</span><i class="icon icon-tick"></i></a></li> <li><a class="',t.quickReply||(e+="active"),e+='" data-type="ctrl-enter"><span>'+tb_i18n.get("activity.timeline.reply.shortcut")+'</span><i class="icon icon-tick"></i></a></li> </ul> </div> <input type="hidden" class="quick-create"> <div class="notif-info pull-right"></div> </div> '),e+=' <div class="only-comments-btn"> <a class="comments-handler" data-gta="event" data-label="hide system activities"> <div class="check-box"> <span class="icon icon-tick"></span> </div> <span>'+tb_i18n.get("activity.timeline.only.comment")+'</span> </a> <a class="attachments-handler" data-gta="event" data-label="only attachments"> <div class="check-box"> <span class="icon icon-tick"></span> </div> <span>'+tb_i18n.get("activity.timeline.only.attachment")+"</span> </a> </div></div>"}},function(t,e){t.exports=function(t){var e="";return e+=t.notifNum>0?' <a class="notif-num hinted" data-title="'+t.notifMembNames+'">'+t.notifNum+'</a> <span class="notif-tip">'+tb_i18n.get("acitivity.timeline.notif.tip")+"</span>":' <span class="notif-tip">'+tb_i18n.get("acitivity.timeline.notif.none.tip")+"</span>"}},function(t,e){t.exports=function(t){var e='<div class="'+t.type+'-tip-inner"> <span class="icon icon-circle-info"></span> <div class="'+t.type+'-tip"> <span class="tip">'+t.tip+"</span> </div></div>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S,I,z,P,D,O=function(t,e){return function(){return t.apply(e,arguments)}},N=function(t,e){function i(){this.constructor=t}for(var n in e)E.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},E={}.hasOwnProperty,A=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};x=i(358),P=i(678),S=i(679),I=i(820),c=i(411),y=i(677),j=i(788),h=i(429),a=i(401),D=i(530),M=i(792),v=i(697),C=i(810),d=i(699),o=i(976),s=i(978),m=i(794),g=i(982),T=i(786),p=i(1190),u=i(1191),f=i(1129),n=i(1260),_=1,w=60,k=100,b=200,z={archive:"icon-archive",unarchive:"icon-unarchive",create:"icon-plus","update.note":"icon-book","update.content":"icon-pencil",linked:"icon-link2","linked.created":"icon-link2","linked.deleted":"icon-link2","linked.canceled":"icon-link2","linked.update.done":"icon-link2","linked.update.redo":"icon-link2","linked.remove.executor":"icon-link2","linked.claim":"icon-link2","linked.update.version":"icon-link2","linked.update.approval":"icon-link2","linked.update.unapproval":"icon-link2","linked.updated":"icon-link2","integration.linked.created":"icon-link2","integration.linked.canceled":"icon-link2","evernote.linked.created":"icon-link2","evernote.linked.canceled":"icon-link2","weibo.linked.created":"icon-link2","weibo.linked.canceled":"icon-link2","github.linked.created":"icon-link2","github.linked.canceled":"icon-link2","processon.linked.created":"icon-link2","processon.linked.canceled":"icon-link2","collection.linked.created":"icon-link2","collection.linked.canceled":"icon-link2",involve:"icon-user","involve.add":"icon-add-user","involve.del":"icon-user","involve.addAndDel":"icon-user","task.claim":"icon-user","task.update.done":"icon-tick","task.update.redo":"icon-checkbox","task.update.tasklist":"icon-th-list","task.update.stage":"icon-stage","task.update.tasklistAndStage":"icon-stage","task.update.executor":"icon-user","task.remove.executor":"icon-user","task.update.priority.normal":"icon-circle color-priority-normal","task.update.priority.high":"icon-circle color-priority-high","task.update.priority.urgent":"icon-circle color-priority-urgent","task.remove.startdate":"icon-calendar2","task.update.startdate":"icon-calendar2","task.remove.duedate":"icon-calendar2","task.update.duedate":"icon-calendar2","task.linked.remove.startdate":"icon-calendar2","task.linked.update.startdate":"icon-calendar2",
"task.linked.remove.duedate":"icon-calendar2","task.linked.update.duedate":"icon-calendar2","task.subtask.create":"icon-ul","task.subtask.remove":"icon-ul","task.subtask.claim":"icon-ul","task.subtask.remove.executor":"icon-ul","task.subtask.update.executor":"icon-ul","task.transform.task.subtask":"icon-convert","task.subtask.remove.duedate":"icon-ul","task.subtask.update.duedate":"icon-ul","task.subtask.update.done":"icon-ul","task.subtask.update.redo":"icon-ul","task.subtask.create.one":"icon-ul","work.linked.created":"icon-link2","work.linked.canceled":"icon-link2","work.update.filename":"icon-pencil","work.update.version":"icon-file","work.update.collection":"icon-file","post.update.pin":"icon-pin","post.update.unpin":"icon-pin","entry.update":"icon-bookkeeping","entry.update.content":"icon-bookkeeping","entry.update.note":"icon-bookkeeping","entry.update.amount":"icon-bookkeeping","entry.update.approval":"icon-bookkeeping","entry.update.unapproval":"icon-bookkeeping","entry.update.entryCategory":"icon-bookkeeping","entry.update.date":"icon-bookkeeping","default":"icon-pencil"},l=["weibo","github","evernote","yinxiang","processon"],t.exports=r=function(t){function e(){return this.voiceEnd=O(this.voiceEnd,this),this.voiceTimeUpdate=O(this.voiceTimeUpdate,this),this.voiceState=O(this.voiceState,this),e.__super__.constructor.apply(this,arguments)}return N(e,t),e.prototype.viewName="ActivityView",e.prototype.tagName="li",e.prototype.className="activity",e.prototype.events={"click .linked-handler":"openLinkPreviewer","click .linked-collection-handler":"enterCollection","click .linked-file-handler":"openFile","click .delete-activity-handler":"showDeleteConfirmModal","click .edit-activity-handler":"showActivityEditor","click .download-attachments-handler":"downloadAttachments","click .previewer-handler":"enterPreviewer","click .activity-content":"toggleOverflow","click .activity-voice-wrapper":"voiceCtrl","click .avatar":"showMemberDetail"},e.prototype.initialize=function(t){var e,i;if(null!=t?t.activityModel:void 0)return this.options=t,this.objectModel=t.objectModel,this.projectModel=v.get(this.options._projectId),this.activityModel=t.activityModel,this.render().listen(),e=this.activityModel.get("attachments"),~this.activityModel.get("action").indexOf("activity.comment")&&this.$el.addClass("comment"),(null!=(i=this.activityModel.get("creator"))?i._id:void 0)===P.user.id&&this.$el.addClass("creator"),e.length&&this.$el.addClass("attachments"),this.objectModel.getRoleScope()>=0||this.$el.addClass("guest"),this.$el.attr("data-id",this.activityModel.id),this},e.prototype.listen=function(){return this.listenTo(this.activityModel,"remove destroy",this.remove),this.listenTo(this.activityModel,"change",this.render),this.listenTo(this.projectModel,"change:applications",function(){if(this.projectModel.isAppChanged("markdown"))return this.render()}),this},e.prototype.render=function(){var t,e,i;return t=this.activityModel.toJSON(),e=t.content,~t.action.indexOf("activity.comment")&&t.comment&&(t.commentMD=I.replaceMD(t.comment),t.commentList=I.translate(t.comment)),this.activityContentProcess(t),t.createdTime=h(t.created).format("LLL"),t.canDownload=this.activityModel.hasPermission("work.get.download"),t.isOwn=this.activityModel.isOwner(),t.iconName=this.getIconName(t.boundToObjectType,t.action),t.attachments=this.activityModel.getAttachmentDatas(),t.isLogedInUser=(null!=(i=this.activityModel.get("creator"))?i._id:void 0)===P.user.id,t.description=this.getDescription(e.content||e.note),t.mdStatus=this.projectModel.isAppEnabled("markdown"),this.$el.html(n(t)),t.content.voice&&!this.audio&&this.voiceInit(),this.$("time").timesince(),this.$("pre code").each(function(){return c.highlightBlock(this)}),this},e.prototype.activityContentProcess=function(t){var e,i,n,r,o;if(e=t.content,r=e.linked,e.linkedCollection?this.formatLinkedCollectionData(t):(null!=r?r.title:void 0)&&!/deleted/.test(t.action)&&(n=t.title.lastIndexOf(r.title),t.titleToStressLeft=t.title.substr(0,n),t.titleToStress=r.title,t.titleToStressRight=t.title.substr(n+r.title.length)),o=null!=r?r.objectType:void 0,A.call(l,o)>=0&&(t.url=r.url),e.voice)return i=e.voice.duration,e.voice.durationFormat=this.voiceDurationFormat(i),e.voice.barWidth=this.getVoiceBarWidth(i)},e.prototype.formatLinkedCollectionData=function(t){return"zh"===P.PREFERENCE.getLanguage()&&t.content.uploadWorks?this.formatLinkedCollectionUploadWorksData(t):this.formatLinkedCollectionCommonData(t)},e.prototype.formatLinkedCollectionCommonData=function(t){var e,i,n,r,o,s,a,c,l,p;return i=t.content,p=t.title,o=i.linkedCollection,a=i.collection||i.work,s=o.title,c=(null!=a?a.title:void 0)||(null!=a?a.fileName:void 0)||"",r=p.length-1,~c.indexOf(s)&&(r-=c.length),n=p.lastIndexOf(s,r),t.titleLeft=p.slice(0,n),t.titleSubFirst=s,e=p.slice(n+s.length),l=e.lastIndexOf(c),t.titleMiddle=e.slice(0,l),t.titleSubSecond=c,t.titleRight=e.slice(l+c.length)},e.prototype.formatLinkedCollectionUploadWorksData=function(t){var e,i,n,r,o,s,a;return s=t.title,a=t.content.uploadWorks,r=t.content.linkedCollection.title,o=s.lastIndexOf(a.length),e=s.slice(0,o),i=s.slice(o),n=e.lastIndexOf(r),t.titleLeft=e.slice(0,n),t.titleSubFirst=r,t.titleMiddle=e.slice(n+r.length),1===a.length?t.titleSubSecond=a[0].fileName||"":t.titleSubSecond=i,t.titleRight=""},e.prototype.getVoiceBarWidth=function(t){var e;return e=t>=w?b:t>_?k+Math.floor((t-_)*(b-k)/(w-_)):k,e+"px"},e.prototype.getDescription=function(t){var e;return"string"==typeof t&&(e=$("<div>"+t+"</div>"),e.find("img").each(function(){return $(this).replaceWith(" "+$(this).attr("alt")+" ")}),t=e.text()),y.cutString(t,100,"...")},e.prototype.getIconName=function(t,e){var i;return i="default",Object.keys(z).some(function(n){return"activity."+n===e?(i=n,!0):"activity."+t+"."+n===e?(i=n,!0):~e.indexOf("linked")?(i="linked",!0):void 0}),z[i]},e.prototype.voiceInit=function(){return this.$progress=this.$(".voice-progress"),this.$playTime=this.$(".play-time"),this.audio=new p({src:this.activityModel.get("content").voice.previewUrl,duration:this.activityModel.get("content").voice.duration,onStateChange:this.voiceState,onTimeUpdate:this.voiceTimeUpdate,onEnd:this.voiceEnd})},e.prototype.voiceCtrl=function(t){var e;return t.preventDefault(),null!=(e=this.audio)&&e.playClick(),this},e.prototype.voiceState=function(t){var e;return e=function(e){return function(){var i,n;return i=0,n=Math.abs(1e3*(t.duration-t.currentTime-i)),e.$progress.animate({width:"100%"},n,"linear")}}(this),this.voiceTimer&&(this.$progress.stop(!0,!0).css({width:0}).fadeIn(0),clearTimeout(this.voiceTimer),this.voiceTimer=null),t.paused?(this.$progress.stop(!0),this.$(".play-ctrl").show(),this.$(".pause-ctrl").hide()):(e(),this.$(".play-ctrl").hide(),this.$(".pause-ctrl").show()),this},e.prototype.voiceTimeUpdate=function(t){return this.$playTime.html(this.voiceDurationFormat(t.currentTime)),this},e.prototype.voiceEnd=function(){var t;return this.$playTime.html(this.voiceDurationFormat(null!=(t=this.activityModel.get("content").voice)?t.duration:void 0)),this.voiceTimer=x.delay(function(t){return function(){return t.$(".play-ctrl").show(),t.$(".pause-ctrl").hide(),t.$progress.stop(!0,!0).fadeOut(218)}}(this),400),this},e.prototype.openLinkPreviewer=function(t){var e,i;if(e=this.activityModel.get("content").linked,e&&"integration"!==e.objectType)return"work"===e.objectType?this.openWork(e._objectId):"collection"===e.objectType?f.enterCollection(e._objectId):(i=x.pick(e,"_objectId","_projectId"),this.requestSubView(T).open(m,{objectType:e.objectType,objectId:e._objectId,fixedModal:!0})),this},e.prototype.openWork=function(t){return M.fetch(t,{silentError:!0,success:function(t){return function(e){var i,n;return i=e.get("_projectId"),e&&i?(n={_projectId:i,workModel:e},t.requestSubView(T).open(g,n)):a.show({status:"error",message:tb_i18n.get("previewer.file.deleted")})}}(this),error:function(t,e){return delete D.getData().models[t.id],delete D.getData().matrix[t.id],401===e.status?a.show({message:tb_i18n.get("authority.get.error"),hint:tb_i18n.get("authority.get.error.content"),status:"error"}):a.show({message:e.message||tb_i18n.get("error"),status:"error"})}})},e.prototype.enterCollection=function(){var t;if(t=this.activityModel.get("content").linkedCollection)return f.enterCollection(t._id)},e.prototype.openFile=function(){var t,e,i,n,r;if(t=this.activityModel.get("content"),n=t.uploadWorks,n&&1===n.length)e=n[0];else if(n)return r=x.pluck(n,"_id"),i={_projectId:this.options._projectId,where:"activity"},P.APP.openWorksPreviewer(r[0],r,i);if(e||(e=t.collection||t.work),e)switch(e.objectType){case"collection":return f.enterCollection(e._id);case"work":return this.openWork(e._id)}},e.prototype.voiceDurationFormat=function(t){var e,i;return t=Math.floor(t),e=parseInt(t/60),i=parseInt(t%60),e<10&&(e="0"+e),i<10&&(i="0"+i),e+":"+i},e.prototype.showDeleteConfirmModal=function(t){return t.stopPropagation(),this.requestSubView(o,{title:tb_i18n.get("activity.destroyer.delete"),description:tb_i18n.get("activity.destroyer.confirm.delete"),onConfirm:function(t){return function(){return t.activityModel.destroy({success:function(){return a.show({message:tb_i18n.get("activity.destroyer.delete.success"),status:"success"})},error:function(t){return a.show({message:tb_i18n.get("activity.destroyer.delete.fail"),status:"error"})}})}}(this)}),this},e.prototype.showActivityEditor=function(t){return t.stopPropagation(),this.requestSubView(T).open(s,{activityModel:this.activityModel}),this},e.prototype.downloadAttachments=function(t){var e,i,n,r,o,s,a;return e=this.activityModel.get("attachments"),e&&e.length?(e.length>1?(i=y.getStrikerDownloadConfig(),r=e[0].fileName,o=r.indexOf("."),a=r.slice(0,o),a=a+"_"+tb_i18n.get("activity.moreAttachments")+"_"+e.length+"_"+tb_i18n.get("activity.moreFiles")+"_teambition",n={httpMethod:"POST"},n.data={zipName:a,downloadUrls:e.map(function(t){return t.downloadUrl})}):e.length&&(i=e[0].downloadUrl,n=""),e.length>1&&null!=(null!=(s=window.WebExtensionWin10)?s.downloadAttachments:void 0)?window.WebExtensionWin10.downloadAttachments(i,JSON.stringify(n.data)):$.fileDownload(i,n),P.gta.event({action:"open detail",type:"work",control:"Comment Attachment",method:"download"})):this},e.prototype.enterPreviewer=function(t){var e,i,n,r,o;if(e=$(null!=t?t.currentTarget:void 0),n=e.data("id"))return i=this.activityModel.get("attachments"),o=x.map(i,function(t){return t._id}),r={_projectId:this.options._projectId,where:"activity"},P.APP.openWorksPreviewer(n,o,r),P.gta.event({action:"open detail",type:"work",control:"Comment Attachment",method:"preview"}),this},e.prototype.showMemberDetail=function(t){var e;if(!(this.projectModel.getRoleScope()<0))return this.isOrgMember=this.projectModel.get("_orgRoleId")>=0,e=[],e.push(new Promise(function(t){return function(e,i){return d.fetch(t.options._projectId,{boundToObjectType:"project",success:function(n){return t.membersCollection=n,t.$el?e():i()},error:function(t,e){return i(e)}})}}(this)),this.isOrgMember?new Promise(function(t){return function(e,i){return d.fetch(t.projectModel.get("_organizationId"),{boundToObjectType:"organization",success:function(n){return t.orgMembersCollection=n,t.$el?e():i()},error:function(t,e){return i(e)}})}}(this)):void 0),Promise.all(e).then(function(e){return function(){var i,n,r;if(i=$(t.currentTarget),n=i.data("id"),e.membersCollection.get(n))return null!=(r=e.memberCardView)&&r.remove(),e.memberCardView=e.requestSubView(u,{$toggler:i,placement:"right",projectModel:e.projectModel,withChat:!0,memberModel:e.membersCollection.get(n),orgMembersCollection:e.isOrgMember?e.orgMembersCollection:null}),e.memberCardView.show()}}(this))["catch"](function(t){if(t)return console.error(t)}),this},e.prototype.toggleOverflow=function(t){return $(t.currentTarget).toggleClass("overflow"),this},e.prototype.remove=function(){var t,i;return null!=(t=this.$clone)&&t.remove(),null!=(i=this.audio)&&i.remove(),e.__super__.remove.apply(this,arguments)},e}(j)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(358),n=i(977),o=i(788),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="confirmView",e.prototype.className="confirm-modal modal fade in",e.prototype.hotkeys={esc:function(t){return t.preventDefault(),this.hide()}},e.prototype.events={"click .cancel-handler":"cancel","click .confirm-handler":"confirm"},e.prototype.initialize=function(t){return this.options=s.extend({title:"",description:"",cancel:tb_i18n.get("cancel"),confirm:tb_i18n.get("confirm"),onCancel:function(){},onConfirm:function(){}},t),this.render().show(),this},e.prototype.render=function(){return this.$el.html(n(this.options)),this},e.prototype.show=function(){return this.$el.appendTo("body"),this.$backdrop=$("<div></div>").addClass("confirm-modal-backdrop fade").insertAfter(this.$el),s.delay(function(t){return function(){return t.$backdrop.addClass("in")}}(this))},e.prototype.hide=function(){var t,e;return null!=(t=this.$el)&&t.removeClass("in"),null!=(e=this.$backdrop)&&e.removeClass("in"),s.delay(function(t){return function(){if(t.$el)return t.$backdrop.remove(),t.remove()}}(this),350)},e.prototype.cancel=function(){return this.options.onCancel(),this.hide()},e.prototype.confirm=function(){return this.options.onConfirm(),this.hide()},e.prototype.remove=function(){var t;return null!=(t=this.$backdrop)&&t.remove(),e.__super__.remove.apply(this,arguments)},e}(o)},function(t,e){t.exports=function(t){var e='<div class="modal-dialog"> <div class="modal-content"> <header class="modal-header"> <h4 class="modal-title">'+t.title+'</h4> </header> <div class="modal-body"> <p>'+t.description+'</p> </div> <div class="modal-footer"> <button class="confirm-handler btn btn-primary pull-right">'+t.confirm+'</button> <button class="cancel-handler btn btn-link pull-right">'+t.cancel+"</button> </div> </div></div>";return e}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(678),o=i(979),n=i(799),a=i(980),s=i(401),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="ActivityEditorView",e.prototype.tagName="div",e.prototype.className="activity-editor-view",e.prototype.modalTitle="",e.prototype.events={"submit form":"submit","keydown .activity-editor-input":"quickSubmit"},e.prototype.initialize=function(t){if(!t.activityModel)throw new Error(this.viewName+":options should have activityModel");return this.modalTitle=tb_i18n.get("activity.editor.title"),this.activityModel=t.activityModel,this.options=t,e.__super__.initialize.apply(this,arguments)},e.prototype.renderMain=function(t){var e;return e=this.activityModel.toJSON(),t.html(o(e)),this.$(".activity-editor-input").flexText(),this.$submit=this.$(".submit-handler")},e.prototype.quickSubmit=function(t){return 13===t.keyCode&&(t.ctrlKey||t.shiftKey||t.metaKey)&&this.submit(t),this},e.prototype.submit=function(t){var e;return t.preventDefault(),(e=this.$(".activity-editor-input").val().trim())?(this.disableSubmit(),this.activityModel.save(null,{parse:!0,wait:!0,attrs:{comment:e},success:function(t){return function(){return s.show({message:tb_i18n.get("activity.editor.success"),status:"success"}),t.close()}}(this),error:function(t){return function(){return t.enableSubmit(),s.show({message:tb_i18n.get("activity.editor.error"),status:"error"})}}(this)}),this):this.$(".activity-editor-input").val("")},e.prototype.disableSubmit=function(){return this.$submit.attr("disabled","disabled"),this},e.prototype.enableSubmit=function(){return this.$submit.removeAttr("disabled"),this},e.prototype.close=function(){var t,e,i;return(null!=(e=this.parentView)?e.close:void 0)?"function"==typeof(t=this.parentView).close&&t.close():null!=(i=this.parentView)&&i.remove(),this},e}(a)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<form class="activity-editor-form clearfix"> <div class="activity-editor-input-wrap"> <textarea class="activity-editor-input clearfix" placeholder="'+tb_i18n.get("activity.editor.place.holder")+'">'+e(t.comment)+'</textarea> </div> <button class="btn btn-primary submit-handler pull-right">'+tb_i18n.get("save")+"</button></form>";return i}},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;n=i(981),o=i(788),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.viewName="MultiModalView",e.prototype.initialize=function(t){if(this.renderMain&&this.modalTitle)return t.title&&(this.modalTitle=t.title),this.$el.html(n()),this.$el.addClass("multi-modal-view modal-dialog modal-padding"),this.$modalBody=this.$(".modal-body"),this.$modalTitle=this.$(".modal-title"),this.returnMainView(),this},e.prototype.enterSubView=function(t,e){return this.$el.addClass("in-subview"),this.$modalTitle.text(t.trim()),this.$(".modal-back-handler").one("click",function(t){return function(){return t.returnMainView()}}(this)),this.$modalBody.empty(),e(this.$modalBody),this},e.prototype.returnMainView=function(){return this.$el.removeClass("in-subview"),this.$modalTitle.text(this.modalTitle.trim()),this.$modalBody.empty(),this.renderMain(this.$modalBody),this},e}(o)},function(t,e){t.exports=function(t){var e='<div class="modal-content"> <header class="modal-header"> <a class="modal-back-handler icon icon-chevron-left"></a> <h4 class="modal-title">Modal Title</h4> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </header> <div class="modal-body"></div></div>';return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S,I,z,P,D,O,N,E,A,L,V,R,F=function(t,e){function i(){this.constructor=t}for(var n in e)q.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},q={}.hasOwnProperty,H=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};E=i(358),R=i(678),L=i(679),g=i(411),v=i(680),x=i(925),S=i(677),I=i(788),w=i(441),h=i(401),l=i(793),P=i(792),k=i(699),T=i(696),N=i(810),r=i(809),o=i(796),p=i(927),u=i(976),d=i(983),b=i(1002),_=i(1172),M=i(1052),z=i(786),O=i(1175),c=i(1180),m=i(1181),f=i(1182),y=i(1183),D=i(1184),a=i(1185),s=i(1186),C=i(1188),n=$(window),V=function(t){var e;return t?(e=t.replace(/(\?|#).*$/,"").replace(/^.*\//,""),e=e.match(/\.(\w+)$/),e?e[1]:""):""},A=function(t,e,i,n){var r,o,s,a,c,l,p;for(n||(n=1),i=4*~~i||4,s=i+1,r=1,a=0,p=t*e,o=t*t*i/n;a<p&&s>=1;)s-=1,a=o/(s*s||1);return s+=1,s=~~(s/2),r=Math.ceil(i/4/s),l=Math.floor(t/s),l*s===t&&(l-=1),c=Math.floor(e/r),{rows:s,columns:r,width:l,height:c}},j=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return F(e,t),e.prototype.viewName="PreviewerView",e.prototype.tagName="div",e.prototype.className="previewer modal-dialog with-cancel-handler",e.prototype.hotkeys={right:"goNext",left:"goPrev"},e.prototype.preventHotkeys=["i","n","h"],e.prototype.events={"click .prev-handler":"goPrev","click .next-handler":"goNext","click .previewer-download-link":"downloadWork","click .download-work-handler":"downloadWork","click .open-work-handler":"openWork","click .move-work-handler":"moveWork","click .edit-work-handler":"enterEditing","click .archive-handler":"archiveWork","click .unarchive-handler":"openUnarchiveMenu","click .delete-handler":"deleteWork","click .remove-handler":"deleteModelObject","click .previewer-map-btn":"goToIndex","click .download-collection-handler":"downloadCollection","click .enter-collection-handler":"enterCollection","click .img-previewer img":"showNaturalImage","keydown .previewer-header-name":"quickSave","focusin .previewer-header-name":"enterEditing","blur .previewer-header-name":"saveFileName","click .menu-handler":"togglePreviewerMenu","click .img-rotate":"imgRotate","mousewheel .detail-content":S.mousewheel},e.prototype.initialize=function(t){if(t._workId||t.workModels||t.workModel)return this.options=t,this.objectlinkIds=t.objectlinkIds||[],t.workModels&&(this.workModels=t.workModels),t.workModel&&!this.workModels&&(this.workModels=[t.workModel]),this.isUpdateUrl=!1,void 0!==this.options.isUpdateUrl&&(this.isUpdateUrl=this.options.isUpdateUrl),t.isChatRoom?t.workModel?this.previewFilesInChatRoomPanel():this.load().then(function(t){return function(){return t.previewFilesInChatRoomPanel()}}(this))["catch"](function(t){return function(e){return t.close(),console.error(e)}}(this)):this.load().then(function(t){return function(){return R.gta.event(null,"click","open previewer"),t.renderBasic(),t.doSwitch()}}(this))["catch"](function(t){return function(e){return t.close(),console.error(e)}}(this))},e.prototype.previewFilesInChatRoomPanel=function(){return this.renderBasic(),null==this.index&&(this.index=this.workModels.indexOf(this.options.workModel)),this.mediaOffLoad(),this.$fileViewer.html(""),this.reset(),this.checkHideOrShow(),this.renderContent(),this.refreshMap(),this.refreshPreviewerUrl(),this},e.prototype.load=function(){return this.showLoadingIndicator(),new Promise(function(t){return function(e,i){var n;return t.options._workId?(n={success:function(i){return t.workModels=[i],e()},error:i},P.fetch(t.options._workId,n)):void e()}}(this)).then(function(t){return function(){if(t.$el)return t._projectId=t.workModels[0].get("_projectId"),new Promise(function(e,i){return t.projectModel=T.fetchOne(0,t._projectId,{success:e,error:i})})}}(this)).then(function(t){return function(){return t.workModels.length>1&&(t.workModels[-1]=t.options.collectionModel||new l),t._imgForComputeList=[],t._videoForComputeList=[],t._audioForComputeList=[],t.index=0,t.options.workModel?t.index=t.workModels.indexOf(t.options.workModel):t.workModels[-1]?t.index=-1:void 0}}(this))},e.prototype.renderBasic=function(){return this.$el.html(c({isChatRoom:this.options.isChatRoom})),this.$thumbnails=this.$(".thumbnails-previewer").hide(),this.$lastView=this.$img=this.$(".img-previewer").hide(),this.$pdfViewer=this.$(".pdf-previewer").hide(),this.$textViewer=this.$(".text-previewer").hide(),this.$videoViewer=this.$(".video-previewer").hide(),this.$audioViewer=this.$(".audio-previewer").hide(),this.$fileViewer=this.$(".work-previewer").hide(),this.$previewerHandlerSet=this.$(".previewer-handler-set"),this.$imgset=this.$(".previewer-content-image-wrapper"),this.$activityContainer=this.$(".activities-container"),this.$activityCreator=this.$(".activity-creator-wrapper"),this.$name=this.$(".file-name"),this.$prev=this.$(".prev-handler"),this.$next=this.$(".next-handler"),this.$previewerMap=this.$(".previewer-map"),this.$workVersionsWrap=this.$(".previewer-versions-wrap"),this.$(".close-previewer-handler").appendTo(this.$el.parent()),this},e.prototype.reset=function(){return this.stopListening(),this.versionModel=null,this.workModel=this.workModels[this.index],this.workModel?(this.index>=0&&(this.listenTo(this.workModel,"change:downloadUrl",function(t){return this.renderContent(t)}),this.listenTo(this.workModel,"change:fileName change:parent change:isArchived",this.renderHeader),this.listenTo(this.workModel,"remove destroy",function(){var t;return"function"==typeof(t=this.options).onUnfavorite&&t.onUnfavorite(this.workModel.get("_id")),this.close()}),this.clientEventsToggle(this.workModel,"bind")),this):this},e.prototype.clientEventsToggle=function(t,e){var i;if(null!=window.WebExtensionWin10)switch(i="fileDownloaded:"+t.get("fileKey"),e){case"bind":this.listenTo(window.clientEvents,i,this.renderHandler);break;case"unbind":this.stopListening(window.clientEvents,i)}return this},e.prototype.onOpen=function(){return this._onOpened=!0,"function"==typeof this._domReadyCallback?this._domReadyCallback():void 0},e.prototype.domReady=function(t){return this._onOpened?t():this._domReadyCallback=t},e.prototype.doSwitch=function(){var t;return this.mediaOffLoad(),this.$fileViewer.html(""),this.reset(),this.checkHideOrShow(),this.refreshMap(),this.refreshPreviewerUrl(),this.index<0?this.renderIndexContent():(this.renderLayout(),t={},this.workModel.intervalFetch(t)),this},e.prototype.renderLayout=function(){return this.renderContent(),this.renderHeader(),this.renderHandler(),this.renderVersions(),this.renderInfos(),this.renderActivityTimeline(),this.renderActivitiyCreator()},e.prototype.renderHeader=function(){var t,e,i,n,r;return t=this.getWorkData(!0),t.roleScope=this.workModel.getRoleScope(),(null!=(i=this.projectModel)?i.get("_defaultCollectionId"):void 0)===t._parentId&&(t._parentId=null),"Root"===(null!=(n=this.workModel.get("parent"))?n.title:void 0)?t.parentName=tb_i18n.get("previewer.header.root.tips"):(e=(null!=(r=l.find(t._parentId))?r.toJSON():void 0)||t.parent,t.parentName=null!=e?e.title:void 0),this.$(".previewer-header-wrap").html(f(t)),this.renderArchivedBadge(),this},e.prototype.renderArchivedBadge=function(){var t;return t={isArchived:this.workModel.get("isArchived"),text:tb_i18n.get("previewer.archived"),cancel:tb_i18n.get("cancel"),deleted:tb_i18n.get("delete"),permissions:this.workModel.hasPermissions("put.archive","del")},this.$(".archived-wrapper").html(a(t)),this.$el[t.isArchived?"addClass":"removeClass"]("archived modal-detail"),this},e.prototype.renderHandler=function(){var t,e;return t=this.getWorkData(),t.isFileLocalExist=null!=(e=window.WebExtensionWin10)&&"function"==typeof e.fileIsExist?e.fileIsExist(t.fileKey):void 0,this.$(".previewer-handler-wrap").show().html(m(t)),this.initUploader(),this},e.prototype.renderVersions=function(){var t;return this.workModel.getRoleScope()>=0?(t=this.$workVersionsWrap,this.workVersionsView=this.requestSubView(O,{_workId:this.workModel.id,_projectId:this.workModel.get("_projectId"),onShown:function(){return t.removeClass("hide")},onHidden:function(){return t.addClass("hide")},onSelect:function(t){return function(e){return"work"===e.name?t.versionModel=null:(t.versionModel=e,t.clientEventsToggle(e,"unbind"),t.clientEventsToggle(e,"bind")),t.renderContent(),t.renderHeader(),t.renderHandler()}}(this)}),t.html(this.workVersionsView.$el),this):this},e.prototype.renderInfos=function(){var t;return null!=(t=this.infosView)&&t.remove(),this.infosView=this.requestSubView(d,{objectModel:this.workModel,boundToObjectType:this.workModel.get("objectType"),infos:["link","tag"]}),this.$(".previewer-infos-wrap").html(this.infosView.$el),this},e.prototype.renderActivityTimeline=function(){var t;return null!=(t=this.activityTimelineView)&&t.remove(),this.activityTimelineView=this.requestSubView(o,{_projectId:this.workModel.get("_projectId"),boundToObjectType:this.workModel.get("objectType"),objectModel:this.workModel,$scrollFrame:this.$(".detail-content"),where:this.options.where,success:function(t){return function(){return t.activityCreatorView.show()}}(this)}),this.listenTo(this.activityTimelineView,"toggleOnlyCommentsBtn",function(t){return function(e){var i;return null!=(i=t.activityCreatorView)?i.toggleOnlyCommentsBtn(e):void 0}}(this)),this.$(".detail-activities-wrap").append(this.activityTimelineView.$el),this},e.prototype.renderActivitiyCreator=function(){return this.activityCreatorView=this.requestSubView(r,{_projectId:this.workModel.get("_projectId"),dragAndDropWrap:this.$activityContainer,boundToObjectType:this.workModel.get("objectType"),objectModel:this.workModel,where:this.options.where}),this.listenTo(this.activityCreatorView,"filterActivities",function(t){return function(e){var i;return null!=(i=t.activityTimelineView)?i.filterActivities(e):void 0}}(this)),this.$(".activity-creator-wrapper").html(this.activityCreatorView.$el),this},e.prototype.resizeActivity=function(t){return this.$el&&this.$activityContainer.css("bottom",t),this},e.prototype.enterEditing=function(t){var e,i,n,r,o;return e=this.$(".previewer-header-name"),!this.workModel.get("isArchived")&&("focusin"===(null!=t?t.type:void 0)?(r=this.versionModel||this.workModel,i=r.get("fileName"),n=r.get("fileType"),n&&(o=new RegExp("\\."+n+"$","i"),e.text(i.replace(o,"")))):e.focus(),this)},e.prototype.quickSave=function(t){return 13===t.keyCode&&(t.preventDefault(),$(t.currentTarget).blur()),this},e.prototype.saveFileName=function(){var t,e,i,n,r,o,s;return t=this.$(".previewer-header-name"),n=this.versionModel||this.workModel,r=t.text(),o=n.get("fileName"),e=n.get("fileType"),e?(s=new RegExp("\\."+e+"$","i"),i=r&&r!==o.replace(s,""),r=r+"."+e):i=r&&r!==o,i?n.save(null,{attrs:{fileName:r},success:function(t){return function(){return t.renderHeader()}}(this)}):t.text(o),this},e.prototype.togglePreviewerMenu=function(t){var e;return e=$(t.currentTarget),e.data("bs.popover")||this.requestSubView(_,{fixed:this.$el.closest(".modal").length,$toggler:e,_projectId:this._projectId,objectModel:this.workModel,where:this.options.where,onUnfavorite:this.options.onUnfavorite}).show(),this},e.prototype.refreshMap=function(){var t,e,i;if(t=this.workModels[-1]?-1:0,e=this.workModels.length,i=[t++],e<=32)for(;t<e;)i.push(t++);else this.index!==i[0]&&i.push(this.index);return this.$previewerMap.html(y({maps:i,index:this.index})),this},e.prototype.renderIndexContent=function(){var t;return t=this.$(".activities-container-wrap"),this.removeNaturalImage(),t.hide(),this.renderThumbnails(),this.$lastView=this.$thumbnails.show(),this},e.prototype.renderContent=function(t,e){var i,n,r,o,s,a,c,l,p;return(null!=(c=this.$lastView)?c.data("videoOrAudio"):void 0)&&this.$lastView.data("videoOrAudio").pause(),i=this.$(".previewer-content-image-wrapper").children(),n=this.$(".activities-container-wrap"),this.$previewerHandlerSet[this.workModel.getRoleScope()>0?"removeClass":"addClass"]("no-right"),r=this.getWorkData(),r.downloadUrl&&(r.downloadUrl=r.downloadUrl.replace(/\?download=[^&]+&/,"?")),"image"===r.fileCategory&&r.downloadUrl||this.removeNaturalImage(),i.hide(),n.show(),this.$thumbnails.hide(),t===!0?(this.renderFile(r,e),this.$lastView=this.$fileViewer.show()):(s=V(r.previewUrl),a=s?r.previewUrl:r.downloadUrl,o=r.thumbnail||r.thumbnailUrl||"svg"===(l=r.fileType)||"ico"===l,this.$lastView="image"===r.fileCategory&&r.fileSize<20971520&&o?(this.$(".img-preview-toolbar").attr("data-rotate",0).addClass("hide"),this.renderImage(),this.$img.show()):("text"===r.fileCategory||this.isSupportLangType(r.fileType))&&r.downloadUrl&&r.fileSize<2097152?(this.renderText(r,this.workModel),this.$textViewer.show()):("pdf"===s||"pdf"===(null!=(p=r.fileType)?p.toLowerCase():void 0))&&r.fileSize<20971520?(this.renderPDF(a,r.fileName),this.$pdfViewer.show()):"video"===r.fileCategory||"mp4"===s?(this.renderVideo(a),this.$videoViewer.show()):"audio"===r.fileCategory||"mp3"===s?(this.renderAudio(a),this.$audioViewer.show()):(this.renderFile(r,e),this.$fileViewer.show())),this},e.prototype.isSupportLangType=function(t){var e;return e={adb:"ada",ads:"ada",sh:"bash",clj:"clojure",cljs:"clojure",coffee:"coffeescript",cpp:"cpp",cs:"cs",css:"css",d:"d",dart:"dart",erl:"erlang",hrl:"erlang",hs:"haskell",lhs:"haskell",f:"fortran","for":"fortran",f90:"fortran",f95:"fortran",fs:"fsharp",fsi:"fsharp",fsx:"fsharp",fsscript:"fsharp",go:"go",groovy:"groovy",ini:"ini",java:"java",js:"javascript",json:"json",lisp:"lisp",lua:"lua",xml:"xml",m:"matlab",md:"markdown",h:"objectivec",mm:"objectivec",C:"objectivec",perl:"perl",php:"php",pl:"prolog",pro:"prolog",p:"prolog",py:"python",q:"q",r:"r",
R:"r",RData:"r",rds:"r",rda:"r",ruby:"ruby",rs:"rust",rlib:"rust",scala:"scala",scm:"scheme",ss:"scheme",scss:"scss",swift:"swift",sql:"sql",vb:"vbnet",vbs:"vbscript",vbe:"vbscript",wsf:"vbscript",wsc:"vbscript",hta:"vbscript",vim:"vim"}[t],H.call(g.listLanguages(),e)>=0},e.prototype.renderPDF=function(t,e){var i;return i=V(e),this.$pdfViewer.html(""),this.domReady(function(e){return function(){return e.pdfViewer=new w({pdfUrl:t,staticHost:L.PDF_VIEWER_URL,download:e.workModel.hasPermission("get.download"),onerror:function(){return"pdf"===i?e.renderContent(!0):e.renderContent(!0,tb_i18n.get("previewer.file.translateFail"))}}).embed(e.$pdfViewer[0]),e.onLoaded()}}(this)),this},e.prototype.renderText=function(t,e){var i;return this.$textViewer.html(""),this.onLoading(),i=function(i){return function(n){var r;return i.onLoaded(),e[t.downloadUrl]=n,r=$("<code></code>").text(n),g.highlightBlock(r[0]),$("<pre></pre>").append(r).appendTo(i.$textViewer)}}(this),e[t.downloadUrl]?i(e[t.downloadUrl]):v.ajax({url:t.downloadUrl,converters:{"text script":!0,"text json":!0,"text xml":!0},success:i}),this},e.prototype.renderImage=function(){var t,e,i,n;return t=this.$img.find(".img-previewer-wrap"),t.html(""),e=this.getWorkData(),(null!=e?e.downloadUrl:void 0)&&(this.onLoading(),n=e.fileKey?e.downloadUrl:e.thumbnailUrl,i=S.loadImage(n,function(e){return function(n,r,o){var s;return e.onLoaded(),S.removeItem(e._imgForComputeList,i),n?e.removeNaturalImage():(s=$(i),t.html(s),t.width(r),e.$(".img-preview-toolbar").removeClass("hide"),e.updateNaturalImage(i))}}(this)),this._imgForComputeList.push(i)),this},e.prototype.renderVideo=function(t){var e,i;return e=this.$videoViewer.find(".video-previewer-wrap").empty(),t&&(this.onLoading(),i=S.loadVideo(t,function(t){return function(n,r,o){var s;return t.onLoaded(),S.removeItem(t._videoForComputeList,i),s=$(i),e.html(s).data("videoOrAudio",i)}}(this)),this._videoForComputeList.push(i)),this},e.prototype.renderAudio=function(t){var e;return this.$audioViewer.html(""),t&&(this.onLoading(),e=S.loadAudio(t,function(t){return function(i,n){return t.onLoaded(),S.removeItem(t._audioForComputeList,e),t.$audioViewer.html($(e)).data("videoOrAudio",e)}}(this)),this._audioForComputeList.push(e)),this},e.prototype.renderThumbnails=function(){var t,e,i;return this.onLoading(),this.$thumbnails.children().remove(),this.$thumbnails.show(),i=this.workModels.length,e=A(this.$thumbnails.width(),this.$thumbnails.height(),i,1.618),t='<li style="width: '+e.width+"px; height: "+e.height+'px;">',i<=e.rows&&this.$thumbnails.width(e.width*i),E.reduce(this.workModels,function(e){return function(i,n,r){var o,s,a,c;return o=$("<div>"),s=$('<div class="previewer-map-btn work" data-map-to="'+r+'">'),c=n.get("thumbnail")||n.thumbnail||"",a=!c,$(t).append(s).appendTo(e.$thumbnails),i.then(new Promise(function(t){return e.getImageProp(c,o,s,!0,function(){var e;return a&&o.addClass("work-thumbnail").text(n.get("fileName")),s.append(o),e=n.get("fileType"),/link/.test(n.get("fileCategory"))&&(e="link"),a&&s.append('<p class="work-title '+n.get("fileType")+'">'+e+"</p>"),o.animate({opacity:1}),t()})}))}}(this),Promise.resolve()).then(function(t){return function(){return t.onLoaded()}}(this)),this},e.prototype.getImageProp=function(t,e,i,n,r){var o;return t?(o=S.loadImage(t,function(s){return function(a,c,l){var p,u,d;return S.removeItem(s._imgForComputeList,o),a?s.onFailed(a):(e.css({"background-image":"url("+t+")",opacity:0}),u=i.width(),p=i.height(),c>u||l>p?(d=c/l>u/p?u+"px auto":"auto "+p+"px",n||e.css({backgroundSize:d,width:"",height:""})):e.css({width:c,height:l}),r())}}(this)),this._imgForComputeList.push(o),this):r("url err!")},e.prototype.mediaOffLoad=function(){return E.each(this._imgForComputeList,function(t){return"function"==typeof t.abort?t.abort():void 0}),this._imgForComputeList=[],E.each(this._videoForComputeList,function(t){return"function"==typeof t.abort?t.abort():void 0}),this._videoForComputeList=[],E.each(this._audioForComputeList,function(t){return"function"==typeof t.abort?t.abort():void 0}),this._audioForComputeList=[],this},e.prototype.renderFile=function(t,e){var i,n,r,o,s,a,c,l;return s=this.workModel.hasPermission("get.download")||this.options.isChatRoom,this.$fileViewer.html(D({download:s,fallTitle:e})),a=t.fileName,i=this.$fileViewer.find(".deleted-info").hide(),r=this.$fileViewer.find(".work-thumbnail"),o=this.$fileViewer.find(".work-title"),t.isDeleted?(i.show(),n.hide(),r.hide(),void o.hide()):(l=t.fileType,/link/.test(t.fileCategory)&&(l="link"),this.$fileViewer.find(".work-title").html(l).addClass(t.fileType),this.$fileViewer.find(".work-name").html(a),n=this.$fileViewer.find(".previewer-download-link"),c="link"===l?tb_i18n.get("previewer.open.link"):tb_i18n.get("previewer.download.file")+" <span>("+S.formatFileSize(t.fileSize||0)+")</span>",n.html(c),this.onLoaded(),this)},e.prototype.initInvolve=function(){var t;return null!=(t=this.involveView)&&t.remove(),this.involveView=this.requestSubView(b,{_projectId:this._projectId,objectModel:this.workModel,membersCollection:this.membersCollection,saveOnHidden:!0,dropArea:this.$el,undeletable:!1}),this.involveView.$el.appendTo(this.$(".involve-set")),this},e.prototype.initTagPicker=function(){var t;return null!=(t=this.tagPickerView)&&t.remove(),this.tagPickerView=this.requestSubView(M,{_projectId:this._projectId,objectModel:this.workModel}),this.tagPickerView.$el.prependTo(this.$(".tags-set")),this},e.prototype.getWorkData=function(t){var e;return t===!0?(e=this.workModel.getFormatData(),this.versionModel&&(e=E.extend(e,this.versionModel.getFormatData()))):(e=this.workModel.toJSON(),this.versionModel&&(e=E.extend(e,this.versionModel.toJSON()))),e.permissions=this.workModel.hasPermissions("get.download","put","put.move","put.version","put.archive","del"),e.isArchived=this.workModel.get("isArchived"),e},e.prototype.onLoading=function(){return this.showLoadingIndicator(this.$imgset,{isPrepend:!0}),this},e.prototype.onLoaded=function(){return this.hideLoadingIndicator({animated:!0}),this},e.prototype.onFailed=function(t){return h.show({message:t.message||t,status:"error"}),this},e.prototype.checkHideOrShow=function(){return this.workModels[this.index+1]?this.$next.css({visibility:"visible"}):this.$next.css({visibility:"hidden"}),this.workModels[this.index-1]?this.$prev.css({visibility:"visible"}):this.$prev.css({visibility:"hidden"}),this},e.prototype.goPrev=function(){if(this.$prev)return this.workModels[this.index-1]&&(this.index--,this.doSwitch()),this},e.prototype.goNext=function(){if(this.$next)return this.workModels[this.index+1]&&(this.index++,this.doSwitch()),this},e.prototype.goToIndex=function(t){var e;if(e=$(t.currentTarget),!e.hasClass("active"))return this.index=+e.data("map-to"),this.doSwitch(),this},e.prototype.downloadWork=function(){var t,e,i;return i=this.versionModel||this.workModel,t=i.toJSON(),e=t.downloadUrl,null!=window.WebExtensionWin10&&(e+="&filekey="+t.fileKey+"&workid="+t._id),$.fileDownload(e),this},e.prototype.openWork=function(){var t,e;return t=this.versionModel||this.workModel,null!=(e=window.WebExtensionWin10)&&"function"==typeof e.openFile&&e.openFile(t.get("fileKey")),this},e.prototype.moveWork=function(t){var e,i,n;return!this.workModel.get("isArchived")&&(null!=(i=this.picker)&&i.remove(),n=this.workModel,e=n.get("fileName"),this.picker=this.requestSubView(z).open(p,{_projectId:n.get("_projectId"),_parentId:n.get("_parentId"),onlyCollections:!0,allProjects:!0,isForkOrMove:"move",title:tb_i18n.get("work.move.message",e),select:function(t){return function(e){var i;if(e.id!==n.get("_parentId"))return i=N.get(e.id),n.moveToCollection(i,{success:function(){return t.close()}})}}(this)}),this)},e.prototype.archiveWork=function(){return this.workModel.archive({success:function(t){return function(){return h.show({message:tb_i18n.get("archived.file.success"),status:"success"}),t.close()}}(this)}),this},e.prototype.unarchiveWork=function(){return this.workModel.unarchive({success:function(t){return function(){return h.show({message:tb_i18n.get("unarchived.file.success"),status:"success"}),t.close()}}(this)}),this},e.prototype.deleteWork=function(){return this.requestSubView(u,{title:tb_i18n.get("previewer.delete.file"),description:tb_i18n.get("previewer.confirm.delete"),onConfirm:function(t){return function(){return t.workModel.destroy({success:function(){return h.show({message:tb_i18n.get("delete.success"),status:"success"}),t.close()}})}}(this)}),this},e.prototype.openUnarchiveMenu=function(t){var e;if(e=$(t.currentTarget),!e.data("bs.popover"))return this.requestSubView(C,{$toggler:e,title:tb_i18n.get("unarchive"),type:"file",currentModel:this.workModel,msg:tb_i18n.get("unarchived.file.success")}).show()},e.prototype.deleteModelObject=function(t){var e;return e=$(t.currentTarget),e.data("bs.popover")||this.requestSubView(s,{$toggler:e,title:tb_i18n.get("previewer.delete.file"),confirmDelete:tb_i18n.get("previewer.confirm.delete"),currentModel:this.workModel}).show(),this},e.prototype.initUploader=function(){var t,e;return t=this.$(".update-work-handler"),this.workModel.get("isArchived")?this:(t.length&&this.index>=0&&(this.endUpdate(),null!=(e=this.uploader)&&e.destroy(),this.uploader=new x({accept:null,model:this.workModel,pick:{id:t,multiple:!1},onCreate:function(t){return function(){return t.workModel}}(this),onStart:function(t){return function(){return t.updating(0)}}(this),onProgress:function(t){return function(e,i){return t.updating(e)}}(this),onComplete:function(t){return function(e,i){return t.endUpdate(),e.version=!0,delete e._id,e.thumbnailUrl||(e.thumbnailUrl=null),e.thumbnail=e.thumbnailUrl,e.previewUrl||(e.previewUrl=null),i.createVersion(e,{wait:!0}),t.onLoaded()}}(this)})),this)},e.prototype.downloadCollection=function(){return this},e.prototype.enterCollection=function(){var t,e;if(t=this.workModel.get("_parentId"))return e="project/"+this._projectId+"/works/"+t,this.close(),R.router.navigate(e,{trigger:!0}),this},e.prototype.refreshPreviewerUrl=function(){var t,e;return this.isUpdateUrl&&(e=this.options.parentUrl||R.router.getUrl(),t="/work/"+(this.index>-1?this.workModel.id:"thumbnails"),~e.indexOf(t)||(e=e.replace(/\/work\/.+/,""),e+=t,R.router.navigate(e,{trigger:!1}))),this},e.prototype.showNaturalImage=function(t){return this.$naturalImageWrap=$("<div>").addClass("natural-image"),this.$naturalImageWrap.appendTo(this.$el),this.updateNaturalImage(t.currentTarget),this},e.prototype.updateNaturalImage=function(t){var e,i,r,o;return this.$naturalImageWrap?(e=$("<img>").attr({src:t.src,height:t.naturalHeight,width:t.naturalWidth,rotate:this.$img.find(".img-previewer-wrap img").attr("rotate")}),o=this.$img.find(".img-preview-toolbar").data("rotate"),i=0,r=0,(t.naturalHeight<n.height()||90===o||o===-90)&&(i="auto"),t.naturalWidth<n.width()&&(r="auto"),e.css("margin",i+" "+r),this.$naturalImageWrap.find("img").off(),this.$naturalImageWrap.html(e),e.one("click",function(t){return function(e){return e.stopPropagation(),t.removeNaturalImage()}}(this)),this):this},e.prototype.updating=function(t){var e,i;return i=Math.ceil(100*t),e=this.$(".previewer-updating").addClass("active"),e.find(".previewer-updating-tips-progress").text(i+"%"),this},e.prototype.endUpdate=function(){return this.$(".previewer-updating").removeClass("active"),this},e.prototype.imgRotate=function(t){var e,i,n,r,o,s,a;switch(n=$(t.currentTarget),r=n.data("fn"),i=n.parent(),o=parseInt(i.attr("data-rotate")),r){case"left":o=(o-90)%450;break;case"right":o=(o+90)%450}return a={"-360":"left360","-270":"left270","-180":"left180","-90":"left90",0:"normal",90:"right90",180:"right180",270:"right270",360:"right360"},s=a[o.toString()],e=this.$img.find(".img-previewer-wrap img"),e.attr("rotate",s),o!==-360&&360!==o||(o=0,E.delay(function(){return e.addClass("transition-ctrl"),e.attr("rotate","normal")},300)),E.delay(function(){return e.removeClass("transition-ctrl")},320),i.attr("data-rotate",o),this},e.prototype.removeNaturalImage=function(){var t;return null!=(t=this.$naturalImageWrap)&&t.remove(),this.$naturalImageWrap=null,this},e.prototype.close=function(t){var e;return null!=(e=this.parentView)&&e.remove(),this},e.prototype.remove=function(){var t,i,n;return null!=(t=this.pdfViewer)&&t.destroy(),null!=(i=this.uploader)&&i.destroy(),"function"==typeof this.mediaOffLoad&&this.mediaOffLoad(),n=R.router.getUrl().replace(/\/work\/.+/,""),R.router.navigate(n,{trigger:!1}),e.__super__.remove.apply(this,arguments)},e}(I),e.Constructor=j},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h=function(t,e){function i(){this.constructor=t}for(var n in e)m.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},m={}.hasOwnProperty,f=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};d=i(678),u=i(788),r=i(984),o=i(1137),a=i(1154),s=i(1156),p=i(1158),l=i(1052),c=i(1162),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.viewName="DetailInfosView",e.prototype.className="detail-infos-view",e.prototype.initialize=function(t){if(null!=t?t.objectModel:void 0)return this.options=t,this.objectModel=t.objectModel,this.disabledItems=t.disabledItems||[],this.infos=t.infos||["link","tag"],this.initViews(),this.renderInfos(),this.listen(),this},e.prototype.listen=function(){return this.listenTo(this.objectModel,"change",function(){if(this.$el)return this.renderInfos()}),this},e.prototype.initViews=function(){var t,e,i,n,l,u;return this.views=[],f.call(this.infos,"note")>=0&&(e=this.requestSubView(o,{objectModel:this.objectModel,boundToObjectType:this.options.boundToObjectType,noteAttribute:this.options.noteAttribute,disabled:this.isViewDisabled("note")}),this.views.push(e)),f.call(this.infos,"repeat")>=0&&(n=this.requestSubView(a,{objectModel:this.objectModel,boundToObjectType:this.options.boundToObjectType}),this.views.push(n)),f.call(this.infos,"reminder")>=0&&(i=this.requestSubView(s,{objectModel:this.objectModel,boundToObjectType:this.options.boundToObjectType}),this.views.push(i)),f.call(this.infos,"subtask")>=0&&(l=this.requestSubView(c,{taskModel:this.objectModel,subtasksCollection:this.options.subtasksCollection,membersCollection:this.options.membersCollection}),this.views.push(l)),f.call(this.infos,"tag")>=0&&this.objectModel.getRoleScope()>=-1&&(u=this.requestSubView(p,{objectModel:this.objectModel,_projectId:this.objectModel.get("_projectId"),disabled:this.isViewDisabled("tag")}),this.listenTo(u,"over",this.renderInfos),this.views.push(u)),f.call(this.infos,"link")>=0&&this.objectModel.getRoleScope()>=-1&&(t=this.requestSubView(r,{objectModel:this.objectModel,_projectId:this.objectModel.get("_projectId"),boundToObjectType:this.options.boundToObjectType}),this.linkAddWrap=t.$el.find(".link-add-wrap"),this.listenTo(t,"over",this.renderInfos),this.views.push(t)),this},e.prototype.isViewDisabled=function(t){return this.disabledItems.indexOf(t)>=0},e.prototype.renderInfos=function(){var t,e,i,n,r,o,s;for(i=this.objectModel.get("isArchived"),o=this.views,e=0,r=o.length;e<r;e++)s=o[e],n=s.isCase(),s.$el[n?"addClass":"removeClass"]("on-case"),i?n?(s.$el.removeClass("hide"),s.$el.find(".child-tree").addClass("hide")):s.$el.addClass("hide"):(s.$el.removeClass("hide"),s.$el.find(".child-tree").removeClass("hide")),n||s.hasPermission()?this.$el.append(s.$el):s.$el.detach();return this.$el.children().removeClass("on-top on-bottom"),this.linkAddWrap&&(t=this.linkAddWrap.parent().hasClass("on-case")||this.linkAddWrap.parent().prev().hasClass("on-case"),this.linkAddWrap[t?"addClass":"removeClass"]("on-top")),this.$el.children().each(function(t,e){var i,n,r;if(i=$(e),i.hasClass("on-case")&&i.addClass("on-top on-bottom"),r=i.prev(),r.length&&!r.hasClass("on-case")||i.addClass("on-top"),n=i.next(),!n.length||n.hasClass("on-case"))return i.addClass("on-bottom")}),this},e}(u),e.Constructor=n},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S,I,z,P,D,O,N,E,A,L,V,R,F,q=function(t,e){function i(){this.constructor=t}for(var n in e)H.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},H={}.hasOwnProperty,B=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};L=i(358),R=i(678),g=i(429),z=i(677),P=i(788),F=i(530),r=i(401),d=i(985),O=i(786),S=i(803),N=i(792),C=i(697),w=i(687),k=i(801),f=i(699),h=i(986),b=i(989),y=i(794),T=i(982),E=i(1122),D=i(1090),l=i(1092),a=i(1094),M=i(1096),u=i(1124),x=i(818),o=i(1126),j=i(1129),n=i(1130),p=i(1131),I=i(1132),c=i(1133),s=i(1134),_=i(1135),A=i(1136),V=function(){return{task:{linkedClass:"link-task",icon:"icon-board",title:tb_i18n.get("link.task.title"),template:I},post:{linkedClass:"link-post",icon:"icon-wall",title:tb_i18n.get("link.post.title"),template:_},event:{linkedClass:"link-event",icon:"icon-calendar",title:tb_i18n.get("link.event.title"),template:s},files:{linkedClass:"link-files",icon:"icon-folder",title:tb_i18n.get("link.file.title"),template:c},weibo:{linkedClass:"link-weibo",icon:"icon-weibo",title:tb_i18n.get("link.weibo.title"),template:D},github:{linkedClass:"link-github",icon:"icon-github",title:tb_i18n.get("link.github.title"),template:l},evernote:{linkedClass:"link-evernote",icon:"icon-evernote",title:tb_i18n.get("link.evernote.title"),template:a},yinxiang:{linkedClass:"link-yinxiang",icon:"icon-evernote",title:"印象笔记",template:A},processon:{linkedClass:"link-processon",icon:"icon-processon",title:"ProcessOn",template:M},jinshuju:{linkedClass:"link-jinshuju",icon:"icon-jinshuju",title:tb_i18n.get("link.jinshuju.title"),template:u}}},v=["weibo","github","evernote","processon","jinshuju"],t.exports=m=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return q(e,t),e.prototype.viewName="LinkView",e.prototype.className="detail-infos-link-view",e.prototype.events={"click .link-menu-handler":"toggleMenu","click .add-link-handler":"toggleObjectPicker","click .link":"enterObjectPreviewer"},e.prototype.initialize=function(t){return null==t&&(t={}),this.options=t,this._projectId=t._projectId,this._objectId=t.objectModel.id.split("_")[0],this.objectModel=t.objectModel,this.projectModel=C.get(this._projectId),this.boundToObjectType=t.boundToObjectType,this.organizationId=C.get(this._projectId).get("_organizationId"),f.fetch(this._projectId,{success:function(t){return function(e){if(t.membersCollection=e,t.renderBasic(),k.fetch(t._objectId,{objectType:t.boundToObjectType,success:function(e){return t.objectlinksCollection=e,t.renderLinks().renderAddIcon().listen(),t.trigger("over")}}),t.objectModel.getRoleScope()<-1)return t.$el.addClass("guest")}}(this)}),this},e.prototype.listen=function(){return this.listenTo(this.objectlinksCollection,"add remove destroy",function(t){return function(){return t.renderLinks(),t.renderAddIcon().trigger("over")}}(this)),this.listenTo(this.objectlinksCollection,"change",function(t){return function(){return t.renderLinks()}}(this)),this},e.prototype.renderBasic=function(){var t;return t=this.objectModel.toJSON(),t.permissions=this.objectModel.hasPermissions("objectlink.post"),this.$el.html(n(t)),this.$linksList=this.$(".links-list"),this},e.prototype.renderLinks=function(){var t,e;return this.$(".link-category").empty().addClass("hide"),e=this.objectlinksCollection.models.map(function(t){var e;return e=t.hasPermissions("objectlink.del"),L.extend(t.toJSON(),e)}),e=L.groupBy(L.sortBy(e,"updated"),"linkedType"),t=L.sortBy(L.union(e.work,e.collection),"updated"),t.length&&(e=L.chain(e).omit("work","collection").extend({files:t}).value()),L.mapObject(e,function(t){return function(e,i){return B.call(v,i)>=0?t.renderOuterLinks(e,i):t.renderInnerLinks(e,i)}}(this)),this},e.prototype.renderInnerLinks=function(t,e){var i;if(i=V()[e]){switch(0===this.$("."+i.linkedClass).children().length&&this.$linksList.find("."+i.linkedClass).append($(p(i))),this.$linksList.find("."+i.linkedClass).removeClass("hide"),e){case"task":t=L.map(t,function(t){return function(e){var i,n,r;return L.extend(e,{dueDates:e.data.dueDate?z.formatDate(e.data.dueDate):void 0}),(i=e.data).executor||(i.executor=null!=(n=t.membersCollection)&&null!=(r=n.get(e.data._executorId))?r.toJSON():void 0),e}}(this));break;case"event":t=L.map(t,function(t){return L.extend(t,{startDateString:z.formatDate(t.data.startDate).dateString,startTimeString:g(t.data.startDate).format("LT"),endDateString:z.formatDate(t.data.endDate).dateString,endTimeString:g(t.data.endDate).format("LT")})});break;case"post":t=L.map(t,function(t){var e;return e=t.data.content.replace(/<.*?>/gi,"").replace(/\&nbsp\;?/g," "),L.extend(t,{createTime:z.formatDate(t.data.created),content:z.cutString(e,90,"...")})});break;case"files":t.data=L.map(t,function(t){var e,i;return"collection"===t.linkedType?t:((e=t.data).thumbnail||(e.thumbnail=t.data.thumbnailUrl),t.data.thumbnailText=t.data.fileType,/link/.test(t.data.fileCategory)&&(t.data.thumbnailText="link"),(null!=(i=t.data.thumbnailText)?i.length:void 0)>4?t.data.thumbnailText=""+t.data.thumbnailText.substr(0,1).toUpperCase():void 0)});break;case"yinxiang":t=L.map(t,function(t){return t.data.created&&(t.createTime=z.formatDate(t.data.created)),t})}return this.renderBasicInnerLink(t,i),"task"===e&&t.forEach(function(t){return function(e){return t.renderTaskIdLabel(e)}}(this)),this}},e.prototype.renderOuterLinks=function(t,e){var i,n;return n=V()[e],i=this.$linksList.find("."+n.linkedClass),0===this.$("."+n.linkedClass).children().length&&i.append($(p(n))),i.removeClass("hide"),i.find(".link-contents").empty().append(this.requestSubView(n.template,{data:t,hasSearch:!1,isSearched:!1}).$el),this},e.prototype.renderTaskIdLabel=function(t){var e,i,n;return i=t._linkedId,n=t.data.uniqueId,e=t.data._projectId,C.fetch(e,{silentError:!0,success:function(t){return function(e){return t.requestSubView(x,{projectModel:e,uniqueId:n}).bind(t.$linksList.find(".link[data-linkedid="+i+"] .task-id-placeholder"))}}(this)})},e.prototype.renderBasicInnerLink=function(t,e){var i,n;return i=e.linkedClass,n=e.template,this.$linksList.find("."+i+" .link-contents").empty().append($(n(t))),this},e.prototype.renderAddIcon=function(){return this.objectlinksCollection.length?this.$(".link-add-wrap .icon-link2").removeClass("icon-link2").addClass("icon-circle-cross"):this.$(".link-add-wrap .icon-circle-cross").removeClass("icon-circle-cross").addClass("icon-link2"),this},e.prototype.toggleMenu=function(t){var e,i;return t.stopPropagation(),e=$(t.currentTarget),i=e.data("id"),e.data("bs.popover")||!i?this:(this.requestSubView(h,{$toggler:e,objectlinkModel:this.objectlinksCollection.get(i)}).show(),this)},e.prototype.toggleObjectPicker=function(t){var e,i;return this.objectModel.getRoleScope()>=0?(i=this.objectlinksCollection,e={_parentId:this._objectId,parentType:this.boundToObjectType},this.requestSubView(O).open(b,{_projectId:this._projectId,exclude:[this._objectId],onSelect:function(t){return function(n){var r;return("function"==typeof(r=t.objectModel).isRecurrenceEventInstance?r.isRecurrenceEventInstance():void 0)?o.saveAttrs(t.objectModel,{}).then(function(t){return i=k.get(t.id),e._parentId=t.id,d.createLinks(i,n,e)}):d.createLinks(i,n,e)}}(this)}),this):this},e.prototype.enterObjectPreviewer=function(t){var e,i,n,r,o,s;return this.$currentTarget=$(t.target),e=this.$currentTarget.closest("li").data("id"),o=this.objectlinksCollection.get(e),s=o.get("linkedType"),B.call(v,s)>=0?this:(r=o.get("linkedType"),R.gta.event({action:"open detail",type:r}),"work"===r?this.showWorksPreviewer(o.get("_linkedId")):"collection"===r?j.enterCollection(o.get("_linkedId")):"yinxiang"===r?this.requestSubView(O).open(E,{data:o.get("data")}):(n=this.objectlinksCollection.get($(t.currentTarget).data("id")),i={objectType:n.get("linkedType"),objectId:n.get("_linkedId"),fixedModal:!0,silentError:!0},this.requestSubView(O).open(y,i)),this)},e.prototype.showWorksPreviewer=function(t){var e,i,n,o,s;return e=null,n=[],i=[],s=L.sortBy(this.objectlinksCollection.where({linkedType:"work"}),function(t){return t.get("created")}),i=s.map(function(t){return t.id}),o=L.map(s,function(r){return new Promise(function(o,s){return N.fetch(r.get("_linkedId"),{silentError:!0,success:function(s){return n.push(s),i.push(r.id),s.id===t&&(e=s),o()},error:function(t,e){return 401===e.status?(delete F.getData().models[t.id],delete F.getData().matrix[t.id],o()):s()}})})}),Promise.all(o).then(function(t){return function(){var o;return e?(o={_projectId:t._projectId,objectlinkIds:i,workModel:e},o.workModels=n,t.requestSubView(O).open(T,o)):r.show({message:tb_i18n.get("authority.get.error"),hint:tb_i18n.get("authority.get.error.content"),status:"error"})}}(this))["catch"](function(t){return console.error(t)}),this},e.prototype.isCase=function(){var t;return null!=(t=this.objectlinksCollection)?t.length:void 0},e.prototype.hasPermission=function(){return this.objectModel.hasPermission("objectlink.post")},e}(P)},function(t,e,i){var n;n=i(358),e.createLinks=function(t,e,i){var r,o;return r=i._parentId,o=i.parentType,n.reduce(e,function(e,i){return e.then(function(){return new Promise(function(e){return t.create({_parentId:r,parentType:o,_linkedId:i._id,linkedType:i.objectType||i.type},{wait:!0,success:e,error:e})})})},Promise.resolve())}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(678),n=i(987),r=i(988),a=i(813),o=i(401),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="link-menu",e.prototype.className="link-menu-view",e.prototype.popoverTitle="",e.prototype.events={"click .delete-handler":"enterDeleteSubMenu","submit .delete-form":"submitDeleteForm"},e.prototype.initialize=function(){return this.popoverTitle=tb_i18n.get("link.menu.title"),e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){return this.$el.html(n({permissions:this.options.objectlinkModel.hasPermissions("del")})),this},e.prototype.enterDeleteSubMenu=function(){return this.enterSubMenu(tb_i18n.get("link.delete"),function(t){return function(){return t.$el.html(r())}}(this)),this},e.prototype.submitDeleteForm=function(t){return t.preventDefault(),this.options.objectlinkModel.destroy({success:function(t){return function(){return o.show({message:tb_i18n.get("link.delete.success"),status:"success"}),t.hide()}}(this),error:function(t){return o.show({message:tb_i18n.get("link.delete.fail"),status:"error"})}}),this},e}(a)},function(t,e){t.exports=function(t){var e='<ul class="list"> ';return t.permissions.del&&(e+=' <li> <a class="delete-handler" data-gta="{action: \'delete link\'}"> <span class="icon icon-remove-link"></span>'+tb_i18n.get("link.delete")+" </a> </li> "),e+="</ul>"}},function(t,e){t.exports=function(t){var e='<form class="delete-form"> <p>'+tb_i18n.get("link.confirm.delete")+'</p> <button class="btn btn-danger" type="submit" data-gta="{action: \'deleted link\'}">'+tb_i18n.get("delete")+"</button></form>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},v={}.hasOwnProperty,y=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};h=i(358),u=i(797),f=i(678),r=i(680),m=i(679),d=i(788),p=i(696),s=i(990),a=i(1084),c=i(1113),n=i(1120),o=i(1121),t.exports=l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.viewName="ObjectPickerView",e.prototype.className="object-picker-view modal-dialog flex-fill",e.prototype.events={"click .cancel-handler":"close","click .confirm-handler":"submitLinks","click .object-nav":"switchObjectType"},e.prototype.initialize=function(t){return this.options=t,this.projectsCollection=p.get(0),this.objectType=this.options.objectType||"task",this.projectModel=this.projectsCollection.get(this.options._projectId),this._projectId=this.options._projectId||this.projectsCollection.at(0).id,this.load({success:function(t){return function(e){return t.tokens=e,t.renderBasic(),t.switchObjectType(t.objectType,!0),t.disableSubmit(!0)}}(this)}),this},e.prototype.load=function(t){return f.user.fetchToken(function(e){return function(i,n){var r,o,s,a,c,l;for(c={},s=e.projectModel.getIntegrationTypes(),r=0,o=s.length;r<o;r++)l=s[r],c[l]=null!=(a=h.find(n,function(t){switch(l){case"evernote":return"evernote_international"===t.refer;case"yinxiang":return"evernote"===t.refer;default:return t.refer===l}}))?a.token:void 0;return"function"==typeof t.success?t.success(c):void 0}}(this))},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$object=this.$(".object-picker-body"),this.$submit=this.$(".confirm-handler"),this.renderObject(this.objectType),this.renderIntegrations(),this},e.prototype.renderIntegrations=function(){var t,e;return t=h.filter(this.projectModel.getIntegrations(),function(t){return t.enable}),null!=(e=this.$(".integration-item"))&&e.remove(),this.$(".object-picker-menu").append(o(t)),this},e.prototype.renderObject=function(t){return this.$el.removeClass("on-search"),"task"===t||"post"===t||"event"===t||"file"===t?this.renderInner():y.call(this.projectModel.getIntegrationTypes(),t)>=0?this.renderOuter():"search"===t?(this.$el.addClass("on-search"),this.renderSearch()):console.error("object type erorr:"+t),this},e.prototype.renderInner=function(){var t,e;return t={objectType:this.objectType,exclude:this.options.exclude,_projectId:this._projectId,onProjectChange:function(t){return function(e){return t._projectId=e}}(this),onSelect:function(t){return function(e){return t.selected=e,t.disableSubmit(0===e.length)}}(this),onCreate:function(t){return function(e){return t.selected=e,t.disableSubmit(0===e.length),t.submitLinks()}}(this)},null!=(e=this.objectView)&&e.remove(),this.objectView=this.requestSubView(s,t),this.$object.html(this.objectView.$el)},e.prototype.renderOuter=function(){var t,e;return t={objectType:this.objectType,exclude:this.options.exclude,tokens:this.tokens,projectModel:this.projectModel,onSelect:function(t){return function(e){return t.selected=e,t.disableSubmit(0===e.length)}}(this)},null!=(e=this.objectView)&&e.remove(),this.objectView=this.requestSubView(a,t),this.$object.html(this.objectView.$el)},e.prototype.renderSearch=function(){var t,e;return t={_projectId:this._projectId,exclude:this.options.exclude||[],onSelect:function(t){return function(e){return t.selected=e,t.disableSubmit(0===e.length)}}(this),query:this.query},null!=(e=this.contentView)&&e.remove(),this.contentView=this.requestSubView(c,t),this.$object.html(this.contentView.$el),this},e.prototype.changeActive=function(t){return t.addClass("active").siblings().removeClass("active")},e.prototype.switchObjectType=function(t){var e,i;return(null!=t?t.currentTarget:void 0)?(e=$(t.currentTarget),i=e.data("type")):(i=t,e=this.$(".object-nav[data-type="+i+"]")),this.changeActive(e.parent()),i!==this.objectType&&(this.objectType=i,this.renderObject(this.objectType)),this},e.prototype.submitLinks=function(){var t,e;if(null!=(e=this.selected)?e.length:void 0)return this.selected[0]._id?(this.options.onSelect(this.selected),this.close(),t={action:"added link",type:this.selected[0].type,projectid:this.projectModel.id,method:"link window"},this.projectModel.get("_organizationId")&&(t=h.extend({organizationid:this.projectModel.get("_organizationId")},t)),f.gta.event(t)):Promise.all(this.selected.map(function(t){return function(e){var i;return i=e.data,new Promise(function(n){return"yinxiang"===t.selected[0].type?r.ajax({url:m.INTEGRATION_HOST+"/yinxiang/note/"+i.data.guid,data:{access_token:t.tokens.yinxiang},dataType:"html",success:function(t){
return i.data.content=t,n(e)}}):n(e)})}}(this))).then(function(t){return function(e){return e.map(function(e){return t.createIntegration(e.type,e.data)})}}(this)),this},e.prototype.createIntegration=function(t,e){return this.projectModel.createIntegrations(t,{data:e,success:function(t){return function(e){var i;return t.options.onSelect([{_id:e._id,type:e.type}]),t.close(),i={action:"use plugin",control:"add link",type:e.type,pluginid:e._id,projectid:t.projectModel.id,organizationid:t.projectModel.get("_organizationId")},f.gta.event(i)}}(this)})},e.prototype.disableSubmit=function(t){return this.$submit.prop("disabled",t),this.$submit[t?"addClass":"removeClass"]("disabled"),this},e.prototype.close=function(t){var e,i,n;return"function"==typeof(null!=(i=this.parentView)?i.close:void 0)?this.parentView.close():"WindowView"===(null!=(n=this.parentView)?n.viewName:void 0)?"function"==typeof(e=this.parentView).remove&&e.remove():this.remove(),this},e}(d),h.extend(l.prototype,u),t.exports=l},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f=function(t,e){function i(){this.constructor=t}for(var n in e)g.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},g={}.hasOwnProperty;m=i(358),d=i(797),h=i(788),l=i(684),u=i(696),c=i(991),a=i(1040),o=i(1062),r=i(1070),n=i(1082),p=i(1083),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.viewName="ObjectPickerInnerView",e.prototype.className="object-picker-inner-view flex-horiz",e.prototype.events={"click .project-item":"switchProject"},e.prototype.initialize=function(t){return this.options=t,this.projectsCollection=u.get(0),this.organizationsCollection=l.get(0),this.objectType=this.options.objectType||"task",this._projectId=this.options._projectId||this.projectsCollection.at(0).id,this.renderBasic(),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$menu=this.$(".object-menu"),this.$content=this.$(".object-content"),this.setupScroll(this.$menu),this.renderProjects(),this.switchProject(this._projectId),this},e.prototype.renderProjects=function(){var t;return t=this.projectsCollection.groupByOrganization(this.organizationsCollection),this.$menu.html(p({projects:t})),this},e.prototype.renderContent=function(){var t,e,i;return e={_projectId:this._projectId,exclude:this.options.exclude||[],onSelect:this.options.onSelect,onCreate:this.options.onCreate},t=function(){switch(this.objectType){case"task":return c;case"post":return a;case"file":return o;case"event":return r}}.call(this),null!=(i=this.contentView)&&i.remove(),this.contentView=this.requestSubView(t,e),this.$content.html(this.contentView.$el),this},e.prototype.changeActive=function(t){return t.addClass("active").siblings().removeClass("active")},e.prototype.switchProject=function(t){var e,i;return(null!=t?t.currentTarget:void 0)?(e=$(t.currentTarget),i=e.data("id")):(i=t,e=this.$(".project-item[data-id="+i+"]:first")),this.changeActive(e.parent()),this._projectId=i,this.options.onProjectChange(this._projectId),this.renderContent(),this},e}(h),m.extend(s.prototype,d),t.exports=s},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j=function(t,e){function i(){this.constructor=t}for(var n in e)T.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},T={}.hasOwnProperty,M=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};w=i(358),_=i(678),y=i(677),b=i(788),s=i(429),r=i(401),c=i(697),o=i(699),u=i(992),g=i(994),v=i(996),l=i(1e3),k=i(786),h=i(818),d=i(1001),n=i(1036),f=i(1037),m=i(1038),p=i(1039),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return j(e,t),e.prototype.viewName="ObjectPickerTasksView",e.prototype.className="object-picker-tasks-view flex-horiz flex-stretch",e.prototype.events={"click .tasklist-normal":"switchTasklist","click .tasklist-smart-today":"showTodayTasks","click .tasklist-smart-total":"showUndoneTasks","click .tasklist-smart-done":"showDoneTasks","click .task":"toggleTask","click .object-picker-creator":"creatorHandler"},e.prototype.initialize=function(t){if(t._projectId)return this.options=t,this._projectId=t._projectId,this.projectModel=c.get(this._projectId),this.listen(),this.tasksCache={},this.selected=[],this.renderBasic(),this.showLoadingIndicator(this.$list),Promise.all([new Promise(function(t){return function(e,i){return g.fetch(t._projectId,{success:e,error:function(t,e){return i(e)}})}}(this)),new Promise(function(t){return function(e,i){return o.fetch(t._projectId,{success:e,error:function(t,e){return i(e)}})}}(this))]).then(function(t){return function(e){if(t.$el)return t.hideLoadingIndicator({animated:!1}),t.tasklistsCollection=e[0],t.membersCollection=e[1],t.tasklistsCollection.updateSort(_.PREFERENCE.tasklistSortInProject(t._projectId),!0),t.renderTasklist()}}(this))["catch"](function(t){if(t)return r.show({message:t.message||t,status:"error"})}),this},e.prototype.loadTasks=function(){var t;return t=this.tasklistModel.id,this.showLoadingIndicator(this.$list),new Promise(function(t){return function(e,i){return u.fetch(t.tasklistModel.id,{success:function(n){return t.$el?e(n):i()},error:function(t,e){return i(e)}})}}(this)).then(function(e){return function(i){if(e.tasklistModel.id===t)return e.stagesCollection=i,w.reduce(e.stagesCollection.pluck("_id"),function(t,i){return t.then(function(t){return new Promise(function(n,r){return v.fetch(i,{attrs:{isDone:!1},success:function(i){return e.$el?(t.push(i),n(t)):r()},error:function(t,e){return r(e)}})})})},Promise.resolve([]))}}(this)).then(function(e){return function(i){if(e.$el&&e.tasklistModel.id===t)return e.hideLoadingIndicator({animated:!1}),e.tasksCollectionArray=i,e.renderStagedTasks(i),e.renderTaskIdLabel()}}(this))["catch"](function(t){if(t)return r.show({message:t.message||t,status:"error"})}),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$list=this.$(".tasks-list"),this.$taskgroup=this.$(".tasklists-list"),this},e.prototype.listen=function(){return this.listenTo(this.projectModel,"change:applications",function(){if(this.projectModel.isAppChanged("tasks"))return this.toggleTaskCreator()}),this},e.prototype.renderTasklist=function(){return this.$taskgroup.html(f({tasklists:this.tasklistsCollection.map(function(t){return t.toJSON()})})),this},e.prototype.renderStagedTasks=function(t,e){var i;return i=[],w.each(t,function(t){return function(n){var r,o;if(r=t.stagesCollection.get(n._stageId),o=t.getTasksData(n.models,e),o.length)return i.push({stageName:r.get("name"),tasks:o})}}(this)),this.$list.html(p({stages:i})),this},e.prototype.renderTasks=function(t,e){return this.$list.html(m({tasks:this.getTasksData(t,e)}))},e.prototype.renderTaskIdLabel=function(){return this.$list.find(".task").each(function(t){return function(e,i){var n,r,o,s,a;return n=$(i),o=n.data("id"),s=t.tasksCache[o],a=s.get("uniqueId"),r=s.get("_projectId"),c.fetch(r,{success:function(e){return t.requestSubView(h,{projectModel:e,uniqueId:a}).bind(n.find(".task-id-placeholder"))}})}}(this))},e.prototype.getTasksData=function(t,e){var i;return i=[],w.each(t,function(t){return function(n){var r,o,s;if(t.tasksCache[n.id]=n,r=n.toJSON(),r.executor=r.executor||(null!=(o=t.membersCollection.get(r._executorId))?o.toJSON():void 0)||{},r.content=y.escape(w.unescape(r.content)),r.dueDate&&(r.dueDate=y.formatDate(r.dueDate)),r.accomplished&&(r.accomplished=y.formatDate(r.accomplished)),r.disabled=(s=n.id,M.call(t.options.exclude,s)>=0),!e||e&&(n.get("content")||"").toLowerCase().indexOf(e)>-1)return i.push(r)}}(this)),i},e.prototype.creatorHandler=function(){var t,e;return t=[],this.requestSubView(k).open(d,{_projectId:this._projectId,_tasklistId:null!=(e=this.tasklistModel)?e.id:void 0,success:function(e){return t.push(e.toJSON())},onAllSuccess:function(e){return function(){return e.options.onCreate(t)}}(this)})},e.prototype.toggleTask=function(t){var e,i;if(e=$(t.currentTarget),!e.hasClass("disabled"))return!e.hasClass("selected")&&this.selected.length>=10?r.show({message:tb_i18n.get("object.picker.exceed.number"),status:"error"}):(e.toggleClass("selected"),i=e.data("id"),e.hasClass("selected")?this.selected.push(i):y.removeItem(this.selected,i),this.options.onSelect(this.selected.map(function(t){return{_id:t,type:"task"}})),this)},e.prototype.switchTasklist=function(t){var e,i;return(null!=t?t.currentTarget:void 0)?(e=$(t.currentTarget),i=e.data("id")):(i=t,e=this.$taskgroup.find(".tasklist-item[data-id="+i+"]")),this.tasklistModel=this.tasklistsCollection.get(i),this.toggleTaskCreator(),e.parent().addClass("active").siblings().removeClass("active"),this.tasksCache={},this.$list.empty(),this.selected=[],this.options.onSelect([]),this.loadTasks(),this},e.prototype.toggleTaskCreator=function(){var t,e;return t=this.tasklistModel&&(null!=(e=this.projectModel)?e.isAppEnabled("tasks"):void 0)?"addClass":"removeClass",this.$el[t]("on-tasklist-selected"),this},e.prototype.loadSmartGroupTasks=function(t){return this.tasksCache={},this.$list.empty(),this.selected=[],this.options.onSelect([]),l.fetch(this._projectId+"_"+t,{_projectId:this._projectId,queryType:t,attrs:this.queryAttrs,beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$list)}}(this),success:function(t){return function(e){return t.hideLoadingIndicator({animated:!1}),t.taskModelsArray=e.map(function(t){return t}),t.renderTasks(t.taskModelsArray),t.renderTaskIdLabel()}}(this)}),this},e.prototype.showTodayTasks=function(t){var e;return this.$el.removeClass("on-tasklist-selected"),e=$(t.currentTarget),e.parent().addClass("active").siblings().removeClass("active"),this.queryAttrs={_projectId:this._projectId,isDone:!1,withTasklist:!0,withTags:!0,dueDate__lt:s().endOf("day").toISOString()},this.loadSmartGroupTasks("today"),this},e.prototype.showUndoneTasks=function(t){var e;return this.$el.removeClass("on-tasklist-selected"),e=$(t.currentTarget),e.parent().addClass("active").siblings().removeClass("active"),this.queryAttrs={_projectId:this._projectId,isDone:!1,withTasklist:!0,withTags:!0},this.loadSmartGroupTasks("todo"),this},e.prototype.showDoneTasks=function(t){var e;return this.$el.removeClass("on-tasklist-selected"),e=$(t.currentTarget),e.parent().addClass("active").siblings().removeClass("active"),this.queryAttrs={_projectId:this._projectId,isDone:!0,withTasklist:!0,withTags:!0},this.loadSmartGroupTasks("done"),this},e.prototype.getTasklistId=function(){var t;return null!=(t=this.tasklistModel)?t.id:void 0},e}(b)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;n=i(685),r=i(686),s=i(993),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.name="stages",e.prototype.model=s,e.prototype.boundToObjectType="tasklist",e.prototype.orderBy=!1,e.prototype.initialize=function(){return this.on("change:isLocked",function(t){return function(e,i){if(i)return t.each(function(t){return r.trigger(":change:tasks/"+t.id+"/locked",{lockedStageId:e.id})})}}(this)),e.__super__.initialize.apply(this,arguments)},e.prototype.getPreviousStage=function(t,e){var i,n;return n=this.get(t),i=n.get("_prevId"),i||(i=e[e.indexOf(t)-1]),this.get(i)},e.prototype.isLocked=function(){return this.last().get("isLocked")},e}(n)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(688),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.name="stage",e.prototype.urlRoot="stages",e.prototype.defaults={name:"",_tasklistId:"",_prevId:""},e.prototype.editDueDate=function(t){return null==t&&(t={}),t.url=this.url()+"/tasks/dueDate",this.sync("update",this,t),this},e.prototype.moveStageTasks=function(t){return null==t&&(t={}),t.url=this.url()+"/tasks/move",this.sync("update",this,t),this},e.prototype.setStageTasksExecutor=function(t){return null==t&&(t={}),t.url=this.url()+"/tasks/executor",this.sync("update",this,t),this},e.prototype.isLast=function(){var t;return(null!=(t=this.collection)?t.last():void 0)===this},e.prototype.archiveTasks=function(t){return t||(t={}),t.url=this.url()+"/tasks/archive",this.sync("update",this,t),this},e}(n)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;n=i(685),o=i(995),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.name="tasklists",e.prototype.model=o,e.prototype.boundToObjectType="project",e.prototype.getTasksPercent=function(t){return 100*t/this.reduce(function(t,e){return Math.max(t,e.get("totalCount"))},t||1)},e}(n)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(688),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.name="tasklist",e.prototype.urlRoot="tasklists",e.prototype.defaults={sortMethod:"custom",objectType:"tasklist",stageIds:[],totalCount:0},e.prototype.setStageIds=function(t,e){return e||(e={}),e.url=this.url()+"/stageIds",e.attrs={stageIds:t},this.sync("update",this,e),this},e.prototype.checkStageIds=function(t,e){var i,n,r,o;if(o=this.get("stageIds"),o.indexOf(t)<0)for(o.push(o[o.length-1]),r=n=o.length-1;n>=0;r=n+=-1){if(i=o[r],e===o[r-1]){o[r]=t;break}o[r]=o[r-1]}return o},e.prototype.hasFilter=function(){var t,e,i,n;return t=this.get("filter"),n=!!t&&((null!=(e=t.tagIds)?e.length:void 0)||(null!=(i=t.executorIds)?i.length:void 0)||t.query||t.isHideDone||t.onlyTodayUpdate),!!n},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;l=i(358),p=i(997).sort,r=i(685),o=i(429),s=i(686),a=i(803),n=i(998),c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.name="tasks",e.prototype.model=a,e.prototype.boundToObjectType="stage",e.prototype.pageNum=20,e.prototype.initialize=function(t,i){return null==i&&(i={}),this._stageId=i._stageId||i._boundToObjectId,l.delay(function(t){return function(){return t.on("change:_stageId",function(i,n){var r;if(24===t._boundToObjectId.length)return t.boundToObjectType&&t._boundToObjectId!==n&&t.remove(i),null!=(r=e.find(n))?r.add(i.toJSON()):void 0}),s.on(":change:tasks/"+t._boundToObjectId+"/locked",function(e){var i;return i=e.lockedStageId,l.each(t.models.slice(),function(e){return e.get("isDone")?e.set("_stageId",i):t._boundToObjectId===i?e.set({isDone:!0,accomplished:(new Date).toISOString()}):void 0})}),s.on(":archive:tasks/"+t._stageId,function(e){var i;return l.each(l.clone(t.models),function(t){return t.set({isArchived:!0,updated:e.updated})}),null!=(i=n.find(e._projectId+"_task"))?i.reset():void 0})}}(this)),e.__super__.initialize.apply(this,arguments)},e.prototype.refresh=function(){return this.fetch({attrs:{isDone:!1,noPagination:!0},success:function(t){return function(e){return t.pageIndex=0,t.fetch({remove:!1,attrs:{isDone:!0}})}}(this)})},e.prototype.sync=function(t,i,n){var r,o;return null==n&&(n={}),r=(null!=(o=n.attrs)?o._stageId:void 0)||this._stageId,n.url=n.url||"stages/"+r+"/tasks",e.__super__.sync.apply(this,arguments)},e.prototype.getDoneTaskCount=function(){return this.where({isDone:!0}).length},e.prototype.comparator=function(t,e){return p(t,e,this.orderBy)},e.prototype.checkHasMore=function(t){return this.pageNum<=t.reduce(function(t,e){return+e.isDone+t},0)},e}(r),a.Collection=c,t.exports=c},function(t,e,i){var n,r,o,s;n=i(358),o=function(t,e){return t=new Date(t).valueOf()||Number.MAX_VALUE,e=new Date(e).valueOf()||Number.MAX_VALUE,t-e},s={isDone:function(t,e,i,n){return t&&e?new Date(n.get("accomplished"))-new Date(i.get("accomplished")):t-e},priority:function(t,e){return e-t},startDate:o,dueDate:o,created:o},r=function(t,e,i){var r,o;return o=0,r=!1,n.some(i,function(i){var n,a,c;return"revert"===i?(r=!0,!1):(a=t.get(i),c=e.get(i),n=s[i],o=n?n(a,c,t,e):a-c,r&&(o=-o,r=!1),0!==o)}),o},e.sort=function(t,i,n){return null==n&&(n="custom"),"function"==typeof e[n]?e[n](t,i):void 0},e.custom=function(t,e){var i;return i=["isDone","pos"],r(t,e,i)},e.priority=function(t,e){var i;return i=["isDone","priority","dueDate","created"],r(t,e,i)},e.startdate=function(t,e){var i;return i=["isDone","startDate","priority","created"],r(t,e,i)},e.duedate=function(t,e){var i;return i=["isDone","dueDate","priority","created"],r(t,e,i)},e.created_asc=function(t,e){var i;return i=["isDone","created"],r(t,e,i)},e.created_desc=function(t,e){var i;return i=["isDone","revert","created"],r(t,e,i)}},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=i(358),n=i(999),o=i(685),s=i(686),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.name="archives",e.prototype.model=n,e.prototype.pageNum=20,e.prototype.boundToObjectType="project",e.prototype.initialize=function(t,i){return this._objectType=i.attrs.objectType,this._projectId=i._projectId,e.__super__.initialize.apply(this,arguments)},e.prototype.parse=function(t){return Array.isArray(t)?a.each(t,this.parse,this):t&&(t._id=t._boundToObjectId+"_archived"),t},e.prototype.sync=function(t,i,n){return n.url="projects/"+this._projectId+"/archives",e.__super__.sync.apply(this,arguments)},e.prototype.listen=function(){var t;if(!this.listened)return this.listened=!0,t=this.name+"/"+this._projectId,this.on("change:isArchived",function(t){return function(e,i){if(!i)return t.remove(e)}}(this)),s.on(":new:"+t,function(t){return function(e){if(e.boundToObjectType===t._objectType)return t.add(e)}}(this)),s.on(":change:"+t,function(t){return function(e){if(e.boundToObjectType===t._objectType)return t.add(e)}}(this)),s.on(":remove:"+t,function(t){return function(e){return t.remove(e+"_archived")}}(this)),s.on(":remove:"+this.name,function(t){return function(e){return t.remove(e+"_archived")}}(this)),this},e}(o)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;r=i(688),s=i(677),o=i(686),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.name="archive",e.prototype.urlRoot="archives",e.prototype.initialize=function(t,e){var i,n,r;return r=t.boundToObjectType,i=t._id.split("_archived")[0],n=t._projectId,"task"!==r&&"post"!==r&&"event"!==r&&"work"!==r&&"entry"!==r&&"tag"!==r&&"collection"!==r&&"tasklist"!==r||o.on(":destroy:"+r+"/"+i,function(){return o.trigger(":remove:archives/"+n,""+i)}),this},e.prototype.getObjectUrl=function(t){var e;return e=function(){switch(this.get("boundToObjectType")){case"task":return"tasks";case"post":return"posts";case"work":return"works";case"event":return"events";case"tag":return"tags";case"tasklist":return"tasklists";case"collection":return"collections";case"entry":return"entries"}}.call(this),e+"/"+this.get("_boundToObjectId")},e.prototype.unarchiveObject=function(t){var e;return t||(t={}),t.url=this.getObjectUrl()+"/archive",t.attrs={_stageId:t._stageId},e=t.success||function(){},t.success=function(t){return function(){var i;return null!=(i=t.collection)&&i.remove(t),e(t)}}(this),this.sync("delete",this,t),this},e.prototype.deleteObject=function(t){var e;return t||(t={}),t.url=""+this.getObjectUrl(),t.attrs={},e=t.success||function(){},t.success=function(t){return function(){var i;return null!=(i=t.collection)&&i.remove(t),e(t)}}(this),this.sync("delete",this,t),this},e}(r),t.exports=n},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;a=i(678),c=i(530),n=i(685),s=i(803),r=i(429),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.name="tasks",e.prototype.model=s,e.prototype.boundToObjectType="project",e.prototype.pageNum=20,e.prototype.queryType="",e.prototype.initialize=function(t,i){return null==i&&(i={}),this.queryType=i.queryType,this._executorId=i._executorId,this._projectId=i._projectId||i.boundToObjectId,e.__super__.initialize.apply(this,arguments)},e.prototype.listen=function(){if(!this.listened)return this.queryType&&(this.listenTo(c,":new:task",function(t){return function(e){if(e.collection!==t)return t.checkModel(e)}}(this)),this.listenTo(c,":change:task",function(t){return function(e){return t.checkModel(e)}}(this)),this.listenTo(c,":destroy:task",function(t){return function(e){if(e.collection!==t)return t.remove(e)}}(this))),e.__super__.listen.apply(this,arguments)},e.prototype.sync=function(t,i,n){return n.url="projects/"+this._projectId+"/tasks",e.__super__.sync.apply(this,arguments)},e.prototype.checkModel=function(t){var e,i,n;if(i=!1,t.get("_projectId")!==this._projectId)return this;if(t.get("_id")&&!t.get("isArchived"))switch(this.queryType){case"today":i=this.checkTodayTask(t);break;case"done":i=this.checkDoneTask(t);break;case"todo":i=!this.checkDoneTask(t);break;case"excutor":i=this.checkExcutorTask(t);break;case"unassigned":i=this.checkUnassignedTask(t)}return e=this.get(t.get("_id")),n=t.checkIsVisible(),!e&&i&&n?this.add(t):!e||i&&n||this.remove(e),this},e.prototype.checkUnassignedTask=function(t){return!t.get("isDone")&&!t.get("_executorId")},e.prototype.checkExcutorTask=function(t){return!t.get("isDone")&&this._executorId===t.get("_executorId")},e.prototype.checkTodayTask=function(t){return!t.get("isDone")&&"today"===t.getScope()},e.prototype.checkDoneTask=function(t){return t.get("isDone")},e.prototype.comparator=function(t,e){var i,n,r,o,s,a;return n=t.get("isDone")?1:0,s=e.get("isDone")?1:0,n-s?n-s:(1===n?(a=t.get("accomplished"),r=e.get("accomplished")):(r=t.get("dueDate"),a=e.get("dueDate")),r&&a?(i=new Date(r),o=new Date(a)):(i=r?0:1,o=a?0:1),i-o)},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S=function(t,e){function i(){this.constructor=t}for(var n in e)I.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},I={}.hasOwnProperty,z=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};C=i(358),x=i(678),r=i(401),T=i(677),M=i(788),s=i(680),f=i(447),y=i(681),w=i(803),l=i(699),m=i(696),_=i(994),v=i(992),j=i(996),a=i(1002),c=i(1005),p=i(1019),u=i(1021),g=i(1024),d=i(1027),k=i(1031),n=i(1033),o=i(1034),h=i(1035),t.exports=b=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return S(e,t),e.prototype.viewName="TaskCreatorView",e.prototype.className="home-task-creator-view creator-view modal-dialog",e.prototype.saveAttrs=["_projectId","_tasklistId","_stageId","content","_executorId","startDate","dueDate","priority","recurrence","involveMembers","visible"],e.prototype.events={"click .creator-location-handler":"showTaskStageSelector","change .task-content-input":"cacheTask","keydown .task-content-input":"quickSubmit","click .task-creator-executor":"showExecutorSelector","click .task-creator-priority":"showPrioritySelector","click .task-creator-repeat":"toggleRepeatSelector","click .creator-visible":"switchVisible","click .submit-handler":"submit","click .involve-view .add-involvement-handler":"gtaSetFollowers"},e.prototype.initialize=function(t){var e;return this.options=t,t._projectId?this.projectModel=m.findOne(0,t._projectId):this.projectModel=x.APP.getClosestProject(),(null!=(e=this.projectModel)?e.isAppEnabled("tasks"):void 0)||(this.projectModel=m.get(0).find(function(t){return t.isAppEnabled("tasks")})),this.projectModel?(this.localCache=y.namespace("temp").namespace("tasks_creator"),this.localCacheId="task_creator_"+this.projectModel.id+"_"+x.user.id,this.load().then(function(t){return function(){if(t.$el)return t.reset(),t.renderBasic(),t.renderContent(),t.renderTitle(),t.renderHandlerSet(),t.renderInvolve(),t.renderVisible()}}(this))["catch"](function(t){return console.error(t),this.close()})):this.close},e.prototype.load=function(){var t;return t=this.localCache(this.localCacheId)||{},new Promise(function(e){return function(i,n){return _.fetch(e.projectModel.get("_id"),{success:function(n){var r,o;return!o&&(r=e.options._tasklistId)&&(o=n.get(r)),!o&&(r=t._tasklistId)&&(o=n.get(r)),o||(o=n.at(0)),e.tasklistModel=o,i()},error:n})}}(this)).then(function(e){return function(){return new Promise(function(i,n){return v.fetch(e.tasklistModel.get("_id"),{success:function(n){var r,o;return!o&&(r=e.options._stageId)&&(o=n.get(r)),!o&&(r=t._stageId)&&(o=n.get(r)),o||(o=n.at(0)),e.stageModel=o,i()},error:n})})}}(this)).then(function(t){return function(){return new Promise(function(e,i){return l.fetch(t.projectModel.get("_id"),{success:e,error:i})})}}(this))},e.prototype.reset=function(){var t;return this.membersCollection=l.find(this.projectModel.id),t=C.extend({_creatorId:x.user.id,_executorId:x.user.id,dueDate:null,priority:0,recurrence:null,involveMembers:[x.user.id],content:""},this.localCache(this.localCacheId),{_projectId:this.projectModel.get("_id"),_tasklistId:this.tasklistModel.get("_id"),_stageId:this.stageModel.get("_id"),dueDate:this.options.dueDate}),t.involveMembers=C.filter(t.involveMembers,function(t){return function(e){return!!t.membersCollection.get(e)}}(this)),this.taskModel=new w(t),this.listen(),this},e.prototype.listen=function(){var t;return this.stopListening(),this.listenTo(this.taskModel,"change",this.cacheTask),this.listenTo(this.taskModel,"change:content",this.renderContent),this.listenTo(this.taskModel,"change:visible",this.renderVisible),this.listenTo(this.taskModel,"change:_tasklistId change:_stageId",this.renderTitle),t="change:startDate change:dueDate change:_executorId change:priority change:recurrence",this.listenTo(this.taskModel,t,this.renderHandlerSet),this.listenTo(this.projectModel,"change:applications",function(){if(this.projectModel.isAppChanged("preciseDate")&&this.renderHandlerSet(),this.projectModel.isAppChanged("tasklist"))return this.renderTitle()}),this.listenTo(this.taskModel,"change:_executorId",function(t,e){var i;if(i=t.get("involveMembers")||[],e&&z.call(i,e)<0)return i.push(e),t.set("involveMembers",i)}),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$title=this.$(".creator-title"),this.$handerWrap=this.$(".creator-flex"),this.$involveWrap=this.$(".creator-involve"),this.$location=this.$(".creator-location"),this.$visibleMembers=this.$(".creator-visible-members"),this.$visibleInvolves=this.$(".creator-visible-involves"),this.$input=this.$(".task-content-input"),this.$input.flexText(),this},e.prototype.renderTitle=function(){var t,e,i,n;return e=this.projectModel.toJSON(),n=this.tasklistModel.toJSON(),i=this.stageModel.toJSON(),t=this.projectModel.isAppEnabled("tasklist")?""+e.name+tb_i18n.get("comma")+n.title+tb_i18n.get("comma")+i.name:""+e.name+tb_i18n.get("comma")+i.name,this.$location.text(t),this},e.prototype.renderContent=function(){return this.$input.val(this.taskModel.get("content")).trigger("change"),this},e.prototype.renderHandlerSet=function(){var t,e,i,n,r,s;return i=this.projectModel.isAppEnabled("startDate"),e=[C.extend(this.taskModel.getDateFormatObj("dueDate"),{title:tb_i18n.get("task.detail.due.date")})],i&&e.unshift(C.extend(this.taskModel.getDateFormatObj("startDate"),{title:tb_i18n.get("task.detail.start.date")})),t=C.extend(this.taskModel.toJSON(),{executor:this.taskModel.get("executor")||(null!=(r=this.membersCollection)&&null!=(s=r.get(this.taskModel.get("_executorId")))?s.toJSON():void 0),priorityTitle:(n=this.taskModel.get("priority"))?T.getPriorityDisplay(n)||"":void 0,repeatTitle:this.taskModel.getRepeatTitle(),preciseDate:this.projectModel.isAppEnabled("preciseDate"),isStartTimeEnable:i,dateItems:e,projectId:this.projectModel.get("_id"),orgId:this.projectModel.get("_organizationId")}),this.$handerWrap.html(o(t)),this.requestSubView(k,{el:this.el,taskModel:this.taskModel,projectModel:this.projectModel,onSelect:function(t){return function(e,i){return t.taskModel.set(e,i)}}(this)}),this},e.prototype.renderInvolve=function(){var t;return t=this.$involveWrap.empty(),this.requestSubView(a,{_projectId:this.projectModel.get("_id"),objectModel:this.taskModel,membersCollection:this.membersCollection,resident:[x.user.id],where:"creator"}).$el.appendTo(t),this},e.prototype.renderVisible=function(){var t;return t=this.taskModel.get("visible"),"involves"===t?(this.$visibleMembers.addClass("hide"),this.$visibleInvolves.removeClass("hide")):(this.$visibleMembers.removeClass("hide"),this.$visibleInvolves.addClass("hide")),this},e.prototype.showTaskStageSelector=function(t){var e;return e=$(t.currentTarget),e.data("bs.popover")||(this.stageSelectorView=this.requestSubView(g,{$toggler:e,projectModel:this.projectModel,tasklistModel:this.tasklistModel,stageModel:this.stageModel,success:function(t){return function(e){return t.projectModel=e.projectModel,t.tasklistModel=e.tasklistModel,t.stageModel=e.stageModel,l.fetch(t.projectModel.get("_id"),{success:function(e){if(t.$el)return t.membersCollection=e,t.reset(),t.cacheTask(),t.renderTitle(),t.renderHandlerSet(),t.renderInvolve()}})}}(this)}).show()),this},e.prototype.showExecutorSelector=function(t){var e,i,n;return e=$(t.currentTarget),i="toggleExecutorSelector",e.data(i)?this:(e.data(i,!0),null!=(n=this.executorSelectorView)&&n.remove(),this.executorSelectorView=this.requestSubView(c,{fixed:this.$el.closest(".panel-view").length,$toggler:e,noAssign:!0,membersCollection:this.membersCollection,selected:[this.taskModel.get("_executorId")],select:function(t){return function(e){var i;return i=e[0],t.taskModel.set("_executorId",i)}}(this)}).show(),this)},e.prototype.showPrioritySelector=function(t){var e,i,n;return e=$(t.currentTarget),i="togglePrioritySelector",e.data(i)?this:(e.data(i,!0),null!=(n=this.prioritySelectorView)&&n.remove(),this.prioritySelectorView=this.requestSubView(u,{$toggler:e,width:170,dataList:T.getPriorities(),selected:this.taskModel.get("priority"),ListTemplate:h,select:function(t){return function(e){return t.taskModel.set("priority",e)}}(this)}).show(),this)},e.prototype.toggleRepeatSelector=function(t){var e,i,n;return e=$(t.currentTarget),i="toggleRepeatSelector",e.data(i)?this:(e.data(i,!0),null!=(n=this.repeatSelectorView)&&n.remove(),this.repeatSelectorView=this.requestSubView(d,{$toggler:e,recurrence:this.taskModel.get("recurrence"),select:function(t){return function(e){return t.taskModel.set("recurrence",e)}}(this)}).show(),this)},e.prototype.switchVisible=function(){var t;return t=this.taskModel.get("visible"),this.taskModel.set("visible","involves"===t?"members":"involves"),this},e.prototype.submit=function(t){var e,i;if(null!=t&&t.preventDefault(),!this.$el.hasClass("submiting"))return e=this.$input.val().trim(),i=C.compact(e.split(/\r\n|\r|\n/)),i.length>1?this.createMultipleTasks(i,e):1===i.length?this.createTask(e):this.focus(),!1},e.prototype.createTask=function(t){var e,i,n;return this.disableSubmit(!0),n=this.taskModel.toJSON(),i=this.options.tasksCollection||this.taskModel.collection,
e=C.pick(n,this.saveAttrs),e.content=t,this.taskModel.clone().save(null,{attrs:e,wait:!0,error:function(t){return function(e,i){return t.disableSubmit(!1),r.show({message:i,status:"error"})}}(this),success:function(t){return function(e){var n,r,o,s;return o=new w(e.toJSON()),"function"==typeof(n=t.options).success&&n.success(o),null!=i&&i.add(o),null!=(s=j.find(o.get("_stageId")))&&s.add(o.toJSON()),t.options.isEssage!==!1&&T.message({tips:tb_i18n.get("create.task.success"),url:"/project/"+o.get("_projectId")+"/tasks/scrum/"+o.get("_tasklistId")+"/task/"+o.id,title:o.get("content")}),t.clearCache(),t.disableSubmit(!1),"function"==typeof(r=t.options).onAllSuccess&&r.onAllSuccess(),t.close(),x.gta.event({action:"added content",type:"task",control:"Global New Task"})}}(this)})},e.prototype.batchCreateTasks=function(t){var e,i;return e=this.options.tasksCollection||this.taskModel.collection,i=C.extend(C.omit(this.taskModel.toJSON(),"content"),{tasks:t}),s.post("tasklists/"+this.taskModel.get("_tasklistId")+"/import_tasks",i).then(function(t){return function(i){var n;return C.each(i,function(t,i){var n,r;return n=new w(t),null!=e&&e.add(n),null!=(r=j.find(n.get("_stageId")))?r.add(n.toJSON()):void 0}),t.clearCache(),t.disableSubmit(!1),"function"==typeof(n=t.options).onAllSuccess&&n.onAllSuccess(),t.close(),x.gta.event({action:"added content",type:"task",control:"Global New Task"})}}(this))["catch"](function(t){return function(e){if(t.disableSubmit(!1),e)return r.error(String(e))}}(this))},e.prototype.createMultipleTasks=function(t,e){var i;return i=50,t.length>i?this.requestSubView(p,{$toggler:this.$input,title:tb_i18n.get("task.creator.multiple.too.many"),description:tb_i18n.get("task.creator.multiple.too.many.desc",i,t.length),cancelStr:tb_i18n.get("task.creator.multiple.too.many.confirm"),onCancel:function(t){return function(){return t.focus()}}(this)}).show():this.requestSubView(p,{$toggler:this.$input,title:tb_i18n.get("task.creator.multiple"),description:tb_i18n.get("task.creator.multiple.desc",t.length),cancelStr:tb_i18n.get("task.creator.multiple.one"),confirmStr:tb_i18n.get("task.creator.multiple.all",t.length),onCancel:function(t){return function(){return t.createTask(e)}}(this),onConfirm:function(e){return function(){return e.batchCreateTasks(t)}}(this)}).show()},e.prototype.disableSubmit=function(t){return this.$el[t?"addClass":"removeClass"]("submiting"),this},e.prototype.focus=function(){var t;return null!=(t=this.$input)&&t.focusAtEnd(),this},e.prototype.quickSubmit=function(t){return 13===t.keyCode&&(t.preventDefault(),this.submit(t)),this},e.prototype.cacheTask=function(){var t,e;return e=(null!=(t=this.taskModel)?t.toJSON():void 0)||{},e.content=this.$input.val().trim(),this.localCache(this.localCacheId,e),this},e.prototype.clearCache=function(){return this.localCache.remove(this.localCacheId),this},e.prototype.onOpen=function(){return this.focus(),this},e.prototype.close=function(){var t,e;return(null!=(t=this.parentView)?t.close:void 0)?this.parentView.close():null!=(e=this.parentView)&&e.remove(),this},e.prototype.remove=function(){var t,i;return null!=(t=this.$datePicker)&&null!=(i=t.data("datepicker"))&&i.picker.remove(),e.__super__.remove.apply(this,arguments)},e.prototype.gtaSetFollowers=function(){return x.gta.event({action:"set followers",control:"Global New Task"})},e}(M)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y=function(t,e){function i(){this.constructor=t}for(var n in e)b.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},b={}.hasOwnProperty,k=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};g=i(358),r=i(1003),o=i(1004),a=i(1005),v=i(429),c=i(1009),l=i(696),u=i(678),d=i(1010),m=i(788),f=i(786),p=i(1012),h=i(1017),n=i(1018),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.viewName="MemberInvolveView",e.prototype.tagName="div",e.prototype.className="involve-view",e.prototype.events={"click .add-involvement-handler":"openMemberMenu","click .remove-member-handler":"quickRemoveMember","mouseover .icon-help":"involveMembersHint"},e.prototype.initialize=function(t){var e;if((null!=t?t.objectModel:void 0)&&t.membersCollection)return this.options=t,this._projectId=t._projectId||t.objectModel.get("_projectId"),this.projectModel=l.getOne(0,this._projectId),this.oldInvolves=[],this.saveOnHidden=!!t.saveOnHidden,this.customPermission=this.options.customPermission,this.renderBasic(),e=function(e){return function(i){return e.objectModel=t.objectModel,e.oldInvolves=e.objectModel.get("involveMembers"),e.membersCollection=t.membersCollection,e.teamsCollection=i,e.setInvolve().render().listen().initDroppable()}}(this),this.projectModel.getRoleScope()>=0&&this.projectModel.get("_organizationId")?d.fetchT(this._projectId,{boundToObjectType:"project"})(function(t,i){return e(i||new d)}):e(new d),this},e.prototype.listen=function(){return this.listenTo(this.objectModel,"change:involveMembers change:_executorId",this.refresh),this.listenTo(this.membersCollection,"change",this.render),this},e.prototype.setInvolve=function(){var t,e;return this.involves=(null!=(t=this.objectModel.get("involveMembers"))?t.slice():void 0)||(null!=(e=this.options.resident)?e.slice():void 0)||[],this},e.prototype.isExperiencedUser=function(){var t;return t=v(u.user.get("created")),t.isBefore(v().subtract(60,"days"))},e.prototype.renderBasic=function(){var t;return t={experiencedUser:this.isExperiencedUser(),disabled:this.options.disabled},this.$el.html(r(t)),this.$list=this.$(".involve-members"),this},e.prototype.render=function(){var t,e,i,n,r,s,a,l,p;if(!this.$el)return this;for(s=[],e=this.objectModel.hasPermission(this.customPermission||"del.involvers"),a=this.involves,i=0,n=a.length;i<n;i++)t=a[i],r=null!=(l=this.membersCollection.get(t))?l.toJSON():void 0,(null!=r?r._id:void 0)&&(r._id===this.objectModel.get("_creatorId")?r.name+=""+tb_i18n.get("comma")+tb_i18n.get("creator"):r._id===this.objectModel.get("_executorId")&&(r.name+=""+tb_i18n.get("comma")+tb_i18n.get("executor")),r.removeable=(e||r._id===u.user.id)&&this.ensurePermission(r._id)&&!this.options.disabled,s.push(r));return this.$list.find(".involve-member").remove(),this.$list.prepend(o({members:s})),this.objectModel.hasPermission(this.customPermission||"put.involvers")||(null!=(p=this.$(".involve-member-add"))&&p.remove(),s.length||this.$list.html(c())),this},e.prototype.involveMembersHint=function(){return u.gta.event({action:"show tips",type:"followers",method:"hover",control:"question mark"}),this},e.prototype.openMemberMenu=function(){var t,e;return null!=(e=this.memberMenu)&&e.remove(),t=g.extend({},this.options,{fixed:this.$el.closest(".panel-view").length,$toggler:this.$(".add-involvement-handler"),multi:!0,selected:this.involves,resident:this.getResidentMembers(),select:function(t){return function(e){if(t.addMembers(e),!t.saveOnHidden)return t.saveInvolve()}}(this),unselect:function(t){return function(e){if(t.removeMembers(e),!t.saveOnHidden)return t.saveInvolve()}}(this),onHidden:function(t){return function(){if(t.saveOnHidden)return t.saveInvolve()}}(this),ensurePermission:this.ensurePermission.bind(this),collection:this.membersCollection,teamsCollection:this.teamsCollection,type:this.options.type}),this.memberMenu=this.requestSubView(a,t).show(),this},e.prototype.getResidentMembers=function(){return this.objectModel.hasPermission(this.customPermission||"del.involvers")?[]:this.objectModel.get("involveMembers")},e.prototype.hideMemberMenu=function(){var t;return null!=(t=this.memberMenu)&&t.hide(),this},e.prototype.refresh=function(t,e){return g.isArray(e)&&e?this.involves=e:this.involves=g.union(this.objectModel.get("involveMembers"),this.involves),this.render(),this},e.prototype.ensurePermission=function(t){var e,i;return e=k.call(this.involves,t)>=0?"unselect":"select",!this.options.uneditable&&(!(t===(null!=(i=this.objectModel)?i.get("_executorId"):void 0)&&k.call(this.objectModel.get("involveMembers"),t)>=0)&&("unselect"!==e||1!==this.involves.length))},e.prototype.addMembers=function(t){return t=t.filter(function(t){return function(e){return t.ensurePermission(e)}}(this)),this.involves=g.union(this.involves,t),this.render(),t.forEach(function(t){return function(e){return t.fadeInAvatar(e)}}(this)),this},e.prototype.removeMembers=function(t){return t=t.filter(function(t){return function(e){return t.ensurePermission(e)}}(this)),this.involves=this.involves.filter(function(e){return!g.contains(t,e)}),t.forEach(function(t){return function(e){return t.fadeOutAvatar(e)}}(this)),this},e.prototype.saveInvolve=function(){var t,e,i,n,r,o,s;if(this.objectModel&&(n=this.involves.slice(),!g.isEqual(n,this.objectModel.get("involveMembers"))))return r=this.objectModel,o=this.objectModel.toJSON(),this.objectModel.set({involveMembers:n}),s=this.oldInvolves,this.oldInvolves=n,this.objectModel.id&&(e={addInvolvers:[],delInvolvers:[]},n.map(function(t){if(k.call(s,t)<0)return e.addInvolvers.push(t)}),s.map(function(t){if(k.call(n,t)<0)return e.delInvolvers.push(t)}),("function"==typeof(i=this.objectModel).isRecurrenceEventInstance?i.isRecurrenceEventInstance():void 0)?(t=this.pickMemberConfirmView(e),this.requestSubView(f).open(t,{onConfirm:function(t){var i;return i=r.eventDetailView,i&&i.resetView(),r.updateEventMember(t,e).then(function(t){if(i)return i.eventModel=i.options.eventModel=t,i.refreshView()})},onCancel:function(){return r.set(o)}})):this.objectModel.saveAttr("involveMembers",null,{attrs:e})),this},e.prototype.pickMemberConfirmView=function(t){var e,i;return e=t.addInvolvers,i=t.delInvolvers,!e.length&&i.length?p:e.length&&!i.length?n:h},e.prototype.fadeInAvatar=function(t){return this.$list.find(".involve-member[data-id="+t+"]").transition({opacity:0},0).transition({opacity:1}),this},e.prototype.fadeOutAvatar=function(t){return this.$list.find(".involve-member[data-id="+t+"]").transition({opacity:0},function(){return $(this).remove()}),this},e.prototype.initDroppable=function(){var t,e;return this.objectModel.hasPermission(this.customPermission||"put.involvers")?(t=this.options.dropArea?this.options.dropArea:this.$list,e=null,t.droppable({hoverClass:"hover",accept:".member",drop:function(t){return function(){if(e)return t.saveInvolve(),e=null}}(this),over:function(t){return function(i,n){if(!(t.involves.indexOf(n.helper.data("id"))>-1))return e=n.helper.data("id"),t.addMember(e)}}(this),out:function(t){return function(i,n){if(e)return t.removeMembers([e]),e=null}}(this)}),this):this},e.prototype.quickRemoveMember=function(t){var e;return e=$(t.currentTarget).parent().data("id"),this.removeMembers([e]),g.delay(function(t){return function(){return t.saveInvolve()}}(this),100),this},e}(m)},function(t,e,i){t.exports=function(t){var e='<div class="involve-header"> <span>'+tb_i18n.get("member.involve")+"</span> ";return t.experiencedUser||(e+=' &nbsp; <span class="icon icon-help hinted" data-title="'+tb_i18n.get("member.involve.tip")+'" data-direction="left"></span> '),e+='</div><ul class="involve-members clearfix"> ',t.disabled||(e+=' <li class="involve-member-add"> <a class="add-involvement-handler clearfix" data-gta="{action: \'set followers\'}"> <span class="icon ',e+="icon-circle-cross",e+=' hinted" data-title="'+tb_i18n.get("member.involve.add")+'"></span> </a> </li> '),e+="</ul>"}},function(t,e){t.exports=function(t){var e="",i=t.members;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+='<li class="involve-member hinted" data-id="'+n._id+'" data-title="'+n.name+'"> <div class="avatar img-circle" style="background-image:url('+n.avatarUrl+');"></div> ',n.removeable&&(e+=' <a class="remove-member-handler">&times;</a> '),e+="</li>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty,h=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};p=i(358),n=i(1006),o=i(1007),a=i(813),c=i(797),l=i(677),s=i(1008),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="MemberMenuView",e.prototype.className="member-menu-view",e.prototype.popoverTitle="Menu",e.prototype.width=245,e.prototype.hotkeys={"up|down|enter":"filterMembers",esc:function(t){var e;return t.preventDefault(),null!=(e=this.$popover)&&e.parent().trigger("click"),this.hide()}},e.prototype.events={"click .one":"toggleMember","click .all":"toggleAllMembers","click .team":"toggleTeamMembers","mouseenter .member-item":"activate","keydown .filter-input":"onkeydown","input .filter-input":"oninput"},e.prototype.initialize=function(t){if(null!=t?t.membersCollection:void 0)return this.resident=t.resident||[],this.excludes=t.excludes||[],this.selected=t.selected||[],this.membersCollection=t.membersCollection,this.teamsCollection=t.teamsCollection,this.members=p.filter(this.membersCollection.toJSON(),function(t){return function(e){var i;return e.isMember=!0,i=e._id,h.call(t.excludes,i)<0}}(this)),this.listen(),e.__super__.initialize.apply(this,arguments),this},e.prototype.listen=function(){return this.listenTo(this.membersCollection,"add remove",this.render),this},e.prototype.render=function(){return this.$el.html(n({searchPlaceholder:tb_i18n.get("member.menu.search")})),this.$list=this.$("ul"),this.renderMembers(this.assembleAll()),this.$("input").focusAtEnd(),this.setupScroll(this.$list),this},e.prototype.renderMembers=function(t){return this.$list.html(o(t)),this.refreshSelected(),this.$list.children().first().addClass("active").siblings().removeClass("active"),this},e.prototype.refreshSelected=function(){return this.$(".member-item").removeClass("selected"),this.$(".member-item").each(function(t){return function(e,i){var n,r,o,s;if(n=$(i),r=n.data("id"),n.hasClass("all")&&t.selected.length===t.members.length)return n.addClass("selected");if(n.hasClass("team")){if(!(o=t.teamsCollection.get(r)))return;if(s=o.get("hasMembers").map(function(t){return t._id}),p.every(s,function(e){return p.contains(t.selected,e)}))return n.addClass("selected")}else if(h.call(t.selected,r)>=0)return n.addClass("selected")}}(this)),this},e.prototype.assembleAll=function(){var t,e,i;return i=[],t={isAll:!0},this.options.noAssign&&i.push({isNoAssign:!0}),this.options.multi&&i.push(t),null!=(e=this.teamsCollection)&&e.each(function(e){var n;if(n=e.toJSON(),n.membersCount>0&&(n.styleName=n.style.split(",")[0],n.styleColor=n.style.split(",")[1],n.belongsTo=s.getTeamBelongsTo(n),n.isTeam=!0,i.push(n),"default"===n.type))return t.isAll=!1}),this.members.slice(0).sort(function(t){return function(e,i){var n,r,o,s,a,c;return r=e._id,n=h.call(t.selected,r)>=0||(o=e._id,h.call(t.resident,o)>=0)?0:1,s=i._id,c=h.call(t.selected,s)>=0||(a=i._id,h.call(t.resident,a)>=0)?0:1,n-c?n-c:e.pinyi>i.pinyi?1:e.pinyi<i.pinyi?-1:0}}(this)).map(function(t){return i.push(t)}),i},e.prototype.toggleMember=function(t){var e,i;return e=$(t.currentTarget),i=e.data("id"),this.options.multi?e.hasClass("selected")?this.unselectMember(i):this.selectMember(i):this.selectSingleMember(i)},e.prototype.selectSingleMember=function(t){return this.selected=[t],this.refreshSelected(),this.options.select([t]),this.hide(),this},e.prototype.selectMember=function(t){var e,i;if(this.ensurePermission(t))return"function"==typeof(i=this.options).select&&i.select([t]),this.selected=p.union(this.selected,[t]),this.query?(this.query="",this.$(".filter-input").val(""),this.renderMembers(this.assembleAll()),e=this.$(".member-item[data-id="+t+"]"),e.addClass("active").siblings().removeClass("active"),this.scrollTo(e)):this.refreshSelected(),this},e.prototype.ensurePermission=function(t){return!p.isFunction(this.options.ensurePermission)||this.options.ensurePermission(t)!==!1},e.prototype.unselectMember=function(t){var e,i;if(!(h.call(this.resident,t)>=0)&&this.ensurePermission(t))return"function"==typeof(i=this.options).unselect&&i.unselect([t]),this.selected=p.without(this.selected,t),this.query?(this.query="",this.$(".filter-input").val(""),this.renderMembers(this.assembleAll()),e=this.$(".member-item[data-id="+t+"]"),e.addClass("active").siblings().removeClass("active"),this.scrollTo(e)):this.refreshSelected(),this},e.prototype.toggleAllMembers=function(t){var e,i,n;return e=$(t.currentTarget),e.hasClass("selected")?(i=this.selected.filter(function(t){return function(e){return t.ensurePermission(e)}}(this)),n=this.selected.filter(function(t){return function(e){return!t.ensurePermission(e)}}(this)),this.options.unselect(i),this.selected=p.union(n,this.resident)):(this.selected=p.pluck(this.members,"_id"),this.options.select(this.selected)),this.refreshSelected(),this},e.prototype.toggleTeamMembers=function(t){var e,i,n,r;if(e=$(t.currentTarget),n=this.teamsCollection.get(e.data("id")))return r=n.get("hasMembers").map(function(t){return t._id}),e.hasClass("selected")?(i=r.filter(function(t){return function(e){return t.ensurePermission(e)}}(this)),this.selected=this.selected.filter(function(t){return!p.contains(i,t)}),this.options.unselect(i)):(this.selected=p.union(this.selected,r),this.options.select(r)),this.refreshSelected(),this},e.prototype.onkeydown=function(t){var e;switch(t.keyCode){case 38:return t.preventDefault(),this.switchActive("up");case 40:return t.preventDefault(),this.switchActive("down");case 13:return e=this.$(".member-item.active"),e.trigger("click")}},e.prototype.oninput=function(t){var e,i;return e=this.$(t.target),i=e.val().trim().toLowerCase(),i?(this.query=i,this.renderMembers(l.memberFilter(this.members,this.query))):this.renderMembers(this.assembleAll()),this},e.prototype.activate=function(t){var e;if(e=$(t.currentTarget),e.length&&!e.hasClass("active"))return e.addClass("active").siblings().removeClass("active"),this},e.prototype.switchActive=function(t){var e,i,n;if(n=(new Date).getTime(),!(n-this.lastSwitchTime<100))return this.lastSwitchTime=n,e=this.$list.find(".active:eq(0)"),"down"===t?(i=e.next(),i.length||(i=this.$list.children().first())):(i=e.prev(),i.length||(i=this.$list.children().last())),i.addClass("active").siblings().removeClass("active"),i.length&&this.slideTo(i),this},e}(a),p.extend(r.prototype,c),t.exports=r},function(t,e){t.exports=function(t){var e="";return t.searchPlaceholder&&(e+='<div class="menu-input"> <input class="filter-input form-control" placeholder="'+t.searchPlaceholder+'"/></div>'),e+='<ul class="list-unstyled thin-scroll"></ul>'}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t;if(n)for(var r,o=-1,s=n.length-1;o<s;)if(r=n[o+=1],i+=" ",r.isNoAssign)i+=' <li class="member-item one" data-id=""> <a> <div class="avatar img-circle no-avatar"></div> '+tb_i18n.get("task.detail.no.executor")+" </a> </li> ";else if(r.isAll)i+=' <li class="member-item all"> <a data-gta="event" data-label="involve all members"> <span class="icon icon-users icon-gray"></span> '+tb_i18n.get("member.menu.all")+" </a> </li> ";else if(r.isTeam){i+=" ";var a=r;i+=' <li class="member-item team hinted" data-id="'+a._id+"\" data-gta=\"{action: 'view team member', control: 'Side Member Menu'}\" data-title=\""+a.name+'"> <a data-gta="event" data-label="involve team members"> <div class="team-avatar avatar pull-left"> <span class="icon ',i+="default"!=a.type&&a.styleName?""+a.styleName:"icon-team-tie",i+='" ',"default"!=a.type&&a.styleColor&&(i+='style="color: '+a.styleColor+'"'),i+=' ></span> </div> <div class="team-info flex-vert flex-center"> <div class="team-name item-name"> <span>'+a.name+"</span>・"+a.hasMembers.length+" </div> ",a.belongsTo&&(i+=' <p class="team-child muted"> '+tb_i18n.get("team.belongsTo",a.belongsTo)+" </p> "),i+=" </div> </a> </li> "}else if(r.isMember){i+=" ";var c=r;i+=' <li class="member-item one hinted" data-id="'+c._id+'" data-title="'+c.name+'"> <a> <div class="avatar img-circle" style="background-image:url('+c.avatarUrl+');"></div> <span>'+e(c.name)+"</span> </a> </li> "}return i}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y;n=i(358),y=i(678),u={all:function(){return tb_i18n.get("members.manager.all.members")},"new":function(){return tb_i18n.get("members.manager.new.members")},unassigned:function(){return tb_i18n.get("members.manager.unassigned.members")}},p="icon-team-tie,#8193ba",v=function(t,e,i){return null==i&&(i=0),e||(e=n.find(t,function(t){return null===t._parentId})),e.children=n.sortBy(t.filter(function(t){return t._parentId===e._id}),"pos"),e.level=i,e.children.forEach(function(n){return n.style||(n.style=e.style||p),n.styleName=n.style.split(",")[0],n.styleColor=n.style.split(",")[1],v(t,n,i+1)}),e},l=function(t,e){var i;return t._id===e?t:(i=null,t.children&&t.children.some(function(t){if(i=l(t,e))return!0}),i)},c=function(t,e,i){return null==i&&(i=[]),e(t)&&i.push(t),t.children.forEach(function(t){return c(t,e,i)}),i},o=function(t,e){return null==e&&(e=[]),e.push(t),t.children.forEach(function(t){return o(t,e)}),e},m=function(t,e,i){var s,a,c;return"all"===t?a=i:"new"===t?a=i.filter(function(t){return t.isNew}):"unassigned"===t?a=i.filter(function(t){return t.teams.length<=1}):(c=l(e,t),s=o(c).map(function(t){return t._id}),a=i.filter(function(t){return n.intersection(s,t.teams).length})),a.sort(r),a},r=function(t,e){var i,n;return n=y.user.id,t._id===n?-1:e._id===n?1:(i=s(e)-s(t),i||(t.pinyin>e.pinyin?i=1:t.pinyin<e.pinyin&&(i=-1)),i)},s=function(t){var e,i;return e=t._roleId,24===e.length?0:i=e>-2?+e:-2},f=function(t,e,i){var n;return n=l(e,t),n||(n={_id:t,name:("function"==typeof u[t]?u[t]():void 0)||"",isFakeTeam:!0}),n.membersCount=m(t,e,i).length,n},d=function(t,e){var i,r;return t.teams?(r=c(e,function(e){return null!==e._parentId&&n.contains(t.teams,e._id)}),i=r.map(function(t){return a(t,r)}),i.forEach(function(t){return t.belongsTo=h(t)}),i):[]},a=function(t,e){return t.parent=n.find(e,function(e){return e._id===t._parentId}),t.parent&&a(t.parent,e),t},h=function(t){var e;for(e=[];t.parent;)e.unshift(t.parent.name),t=t.parent;return e.shift(),e.join(" ＞ ")},g=function(t){for(var e;t.parent&&null!==t.parent._parentId;)t=t.parent;return e=t._parentId?(t.style||p).split(","):["icon-users","#03a9f4"],{styleName:e[0],styleColor:e[1]}},t.exports={parseTree:v,getTeamObject:f,getTeamMembers:m,getMemberTeams:d,getTeamBelongsTo:h,getTeamStyle:g}},function(t,e){t.exports=function(t){var e='<li class="involve-member"> <div class="involve-placeholder">'+tb_i18n.get("member.involve.none")+"</div></li>";return e}},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(358),n=i(685),o=i(1011),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.name="teams",e.prototype.model=o,e.prototype.getNoneDefaultTeams=function(){return this.filter(function(t){return"default"!==t.get("type")})},e.prototype.getTeamById=function(t){return this.find(function(e){return e.get("_id")===t})},e.prototype.isInTeams=function(t){return s.chain(this.toJSON()).map(function(t){return t.hasMembers}).flatten().map(function(t){return t._id}).uniq().contains(t).value()},e}(n)},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;a=i(358),c=i(678),r=i(688),o=i(686),n=i(699),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.name="team",e.prototype.urlRoot="teams",e.prototype.defaults={membersCount:0,projectsCount:0},e.prototype.parse=function(t){var e;return e=a.extend(this.toJSON(),t),null==e.pos&&(e.pos=65536),e},e.prototype.addProject=function(t,e){return e||(e={}),e.url=this.url()+"/projects/"+t,e.attrs||(e.attrs={}),this.sync("update",this,e),this},e.prototype.removeProject=function(t,e){return e||(e={}),e.url=this.url()+"/projects/"+t,e.attrs||(e.attrs={}),this.sync("delete",this,e),this},e.prototype.isMember=function(t){return!!a.find(this.get("hasMembers"),function(e){return e._id===t})},e.prototype.fetchMemberTasks=function(t){return t.url="teams/"+this.get("_id")+"/undonetasks",this.sync("read",this,t),this},e.prototype.fetchMemberSubtasks=function(t){return t.url="teams/"+this.get("_id")+"/undonesubtasks",this.sync("read",this,t),this},e.prototype.fetchMemberDoneTasks=function(t){return t.attrs=a.extend({page:1,count:30},t.attrs),t.url="teams/"+this.get("_id")+"/donetasks",this.sync("read",this,t),this},e.prototype.fetchMemberDoneSubtasks=function(t){return t.attrs=a.extend({page:1,count:30},t.attrs),t.url="teams/"+this.get("_id")+"/donesubtasks",this.sync("read",this,t),this},e.prototype.fetchEvents=function(t){return t.url="teams/"+this.get("_id")+"/events",this.sync("read",this,t),this},e.prototype.move=function(t){return t||(t={}),t.url=this.url()+"/move",this.sync("create",this,t)},e.prototype.quit=function(t){return t||(t={}),t.url=this.url()+"/quit",t.attrs={},this.sync("update",this,t),this},e}(r)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(1013),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.viewName="EventConfirmRemoveMemberView",e.prototype.initialize=function(){var t,i,n;return e.__super__.initialize.apply(this,arguments),n=tb_i18n.get("event.confirm.removeMember.title"),i=tb_i18n.get("event.confirm.removeMember.description"),t=["current","next","all"],this.render({title:n,description:i,btns:t})},e}(n)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;i(1014),o=i(1016),s=i(788),r="select-confirm",t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="EventConfirmView",e.prototype.className="event-confirm clearfix",e.prototype.events={"click button":"selectHandler"},e.prototype.initialize=function(t){return null==t&&(t={}),this.value=null,this.options=t},e.prototype.render=function(t){return this.$el.html(o(t))},e.prototype.selectHandler=function(t){var e,i;return this.value=$(t.currentTarget).data("value"),"function"==typeof(e=this.options).onConfirm&&e.onConfirm(this.value),null!=(i=this.parentView)?i.close():void 0},e.prototype.remove=function(){var t;return this.value||"function"==typeof(t=this.options).onCancel&&t.onCancel(),e.__super__.remove.apply(this,arguments)},e}(s)},function(t,e){},,function(t,e){t.exports=function(t){var e="",i=t.btns||["ok"],n=t.color||"primary";e+='<h5 class="event-confirm-title"> <b>'+t.title+'</b> <a class="icon icon-remove" data-dismiss="modal"></a></h5><p class="event-confirm-description"> '+t.description+'</p><div class="event-confirm-btns with-'+i.length+'"> ';var r=i;if(r)for(var o,s=-1,a=r.length-1;s<a;)o=r[s+=1],e+=' <button type="button" class="btn btn-'+n+'" data-value="'+o+'"> '+tb_i18n.get("event.confirm.btn."+o)+" </button> ";return e+="</div>"}},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(1013),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.viewName="EventConfirmUpdateMemberView",e.prototype.initialize=function(){var t,i,n;return e.__super__.initialize.apply(this,arguments),n=tb_i18n.get("event.confirm.updateMember.title"),i=tb_i18n.get("event.confirm.updateMember.description"),t=["current","next","all"],this.render({title:n,description:i,btns:t})},e}(n)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(1013),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.viewName="EventConfirmAddMemberView",e.prototype.initialize=function(){var t,i,n;return e.__super__.initialize.apply(this,arguments),n=tb_i18n.get("event.confirm.addMember.title"),i=tb_i18n.get("event.confirm.addMember.description"),t=["current","next","all"],this.render({title:n,description:i,btns:t})},e}(n)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;n=i(1020),o=i(813),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.viewName="PopoverConfirmView",e.prototype.className="popover-confirm-view",e.prototype.width=300,e.prototype.events={"click .popover-cancel-handler":"cancel","click .popover-confirm-handler":"confirm"},e.prototype.render=function(){return this.$el.html(n({description:this.options.description,cancelStr:this.options.cancelStr,confirmStr:this.options.confirmStr})),this},e.prototype.cancel=function(){var t;return"function"==typeof(t=this.options).onCancel&&t.onCancel(),this.hide()},e.prototype.confirm=function(){var t;return"function"==typeof(t=this.options).onConfirm&&t.onConfirm(),this.hide()},e.prototype.hide=function(){return this.remove()},e}(o)},function(t,e){t.exports=function(t){var e='<div class="popover-desc ';return t.confirmStr||t.cancelStr||(e+="mute-text"),e+='"> <p>'+t.description+'</p></div><div class="popover-button-group cleaxfix"> ',t.cancelStr&&(e+=' <div class="btn-wrap pull-left',t.confirmStr||(e+=" full-width"),e+='"> <button class="popover-cancel-handler btn btn-default btn-block">'+t.cancelStr+"</button> </div> "),e+=" ",t.confirmStr&&(e+=' <div class="btn-wrap pull-left',t.cancelStr||(e+=" full-width"),e+='"> <button class="popover-confirm-handler btn btn-primary btn-block">'+t.confirmStr+"</button> "),e+="</div>"}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(358),n=i(1022),r=i(1023),s=i(813),a=i(797),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="PopoverMenuView",e.prototype.className="popover-menu-view",e.prototype.popoverTitle="Menu",e.prototype.width=200,e.prototype.hotkeys={"up|down|enter":"filterData",esc:function(t){var e;return t.preventDefault(),null!=(e=this.$popover)&&e.parent().trigger("click"),this.hide()}},e.prototype.events={"click .menu-item":"toggleItem","click .link-add-handler":"addItem","keyup .menu-input input":"filterData"},e.prototype.initialize=function(t){var i;if(null!=t?t.dataList:void 0)return this.multi=t.multi,this.dataList=t.dataList||[],this.selected=t.selected,this.multi&&!c.isArray(this.selected)&&(this.selected=[]),this.ListTemplate=t.ListTemplate||r,this.unselectPermission=(null!=(i=this.options)?i.unselectPermission:void 0)||!0,e.__super__.initialize.apply(this,arguments),this},e.prototype.render=function(){return this.$el.html(n({searchPlaceholder:this.options.searchPlaceholder,addPlaceholder:this.options.addPlaceholder})),this.$ul=this.$("ul"),this.$addInput=this.$(".add-input"),
this.renderItems(this.dataList,this.selected),this.$("input").focusAtEnd(),this.setupScroll(this.$ul),this},e.prototype.renderItems=function(t,e){if(this.$ul)return c.isArray(e)||(e=[e]),c.each(t,function(t){return t.selected=e.indexOf(t._id)>=0}),this.$ul.html(this.ListTemplate({dataList:t})),t!==this.dataList&&this.$ul.find(".menu-item:first").addClass("active"),this},e.prototype.update=function(t,e){return this.dataList=t,null!=e&&(this.selected=e),this.renderItems(this.dataList,this.selected),this},e.prototype.filterData=function(t){var e,i,n,r;switch(null!=t?t.keyCode:void 0){case 38:return t.preventDefault(),this.switchActive("up");case 40:return t.preventDefault(),this.switchActive("down");case 13:if(t.preventDefault(),e=this.$ul.find(".active"),e.length)return e.trigger("click");if(null!=(r=this.$addInput.val())?r.trim():void 0)return this.addItem()}return n=this.$(".menu-input input").val().trim().toLowerCase(),i=n?c.filter(this.dataList,function(t){return(t.title||"").toLowerCase().indexOf(n)>-1||(t.pinyin||"").toLowerCase().indexOf(n)>-1}):this.dataList,this.renderItems(i,this.selected)},e.prototype.toggleItem=function(t){var e,i,n;if(e=$(t.currentTarget),e.length){if(n=e.data("id"),!this.unselectPermission&&e.hasClass("selected"))return;e.hasClass("selected")&&!this.multi||e.toggleClass("selected")}else n=t,e=this.$ul.find(".menu-item[data-id="+n+"]"),e.addClass("selected");return e.hasClass("selected")?this.options.select(n):("function"==typeof(i=this.options).unselect&&i.unselect(n),n=""),this.multi?this.selected=this.$ul.find(".menu-item.selected").map(function(){return $(this).data("id")}).toArray():(this.selected=n,e.siblings().removeClass("selected"),this.hide()),this},e.prototype.addItem=function(){var t,e;if(e=this.$addInput.val().trim())return this.$addInput.val(""),t=c.find(this.dataList,function(t){return t.title===e}),t?this.toggleItem(t._id):this.options.add(e),this},e.prototype.switchActive=function(t){var e,i,n,r,o;return e=this.$ul.find(".active"),"up"===t&&(o=e.removeClass("active").prev(),n=this.$ul.find("li:last"),o.length>0?o.addClass("active"):n.addClass("active")),"down"===t&&(r=e.removeClass("active").next(),i=this.$ul.find("li:first"),r.length>0?r.addClass("active"):i.addClass("active")),this.slideTo(this.$ul.find(".active"))},e.prototype.scrollToSelected=function(t,e){var i;return i=this.$ul.find(".selected"),i.length&&(t?this.slideTo(i,!0,e):this.scrollTo(i,!0,e)),this},e}(s),c.extend(o.prototype,a),t.exports=o},function(t,e){t.exports=function(t){var e="";return t.searchPlaceholder?e+='<div class="menu-input"> <input class="filter-input form-control" placeholder="'+t.searchPlaceholder+'"/></div>':t.addPlaceholder&&(e+='<div class="menu-input add-form"> <input class="add-input form-control" placeholder="'+t.addPlaceholder+'"/> <button class="btn btn-link link-add-handler">'+tb_i18n.get("add")+"</button></div>"),e+='<ul class="list-unstyled thin-scroll ',(t.searchPlaceholder||t.addPlaceholder)&&(e+="with-input"),e+='"></ul>'}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t.dataList;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li class="menu-item ',r.selected&&(i+="selected"),i+='" data-id="'+r._id+'"> <a>'+e(r.title)+"</a></li>";return i}},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;n=i(1021),r=i(813),s=i(1025),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="StageSelectorPopoverView",e.prototype.popoverTitle="",e.prototype.initialize=function(t){return null==t&&(t={}),this.popoverTitle=tb_i18n.get("stage.selector.title"),this.projectModel=t.projectModel,this.tasklistModel=t.tasklistModel,this.stageModel=t.stageModel,this.success=t.success,e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){var t;return null!=(t=this.StageSelectorView)&&t.remove(),this.StageSelectorView=this.requestSubView(s,{projectModel:this.projectModel,tasklistModel:this.tasklistModel,stageModel:this.stageModel,isFrozenProject:this.options.isFrozenProject,success:function(t){return function(e){return"function"==typeof t.success&&t.success(e),t.hide()}}(this)}),this.$el.html(this.StageSelectorView.$el),this},e}(r)},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;o=i(696),a=i(992),c=i(994),r=i(1021),n=i(1026),l=i(788),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="StageSelectorView",e.prototype.className="stage-selector-view",e.prototype.events={"click .select-project":"selectProject","click .select-tasklist":"selectTasklist","click .select-stage":"selectStage","click .submit-handler":"submit"},e.prototype.initialize=function(t){return null==t&&(t={}),this.options=t,this.projectsCollection=o.get(0),this.projectModel=t.projectModel,this.tasklistModel=t.tasklistModel,this.stageModel=t.stageModel,this.success=t.success,this.render(),e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){var t,e,i,r;return t={isFrozenProject:this.options.isFrozenProject,isTasklistEnabled:this.projectModel.isAppEnabled("tasklist"),project:(null!=(e=this.projectModel)?e.toJSON():void 0)||{},tasklist:(null!=(i=this.tasklistModel)?i.toJSON():void 0)||{},stage:(null!=(r=this.stageModel)?r.toJSON():void 0)||{}},this.$el.html(n(t)),this.$submit=this.$(".submit-handler"),this.checkSubmit(),this},e.prototype.checkSubmit=function(){return this.projectModel&&this.tasklistModel&&this.stageModel?this.$submit.removeAttr("disabled"):this.$submit.attr("disabled","disabled"),this},e.prototype.submit=function(){if(this.projectModel&&this.tasklistModel&&this.stageModel)return"function"==typeof this.success&&this.success({projectModel:this.projectModel,tasklistModel:this.tasklistModel,stageModel:this.stageModel}),this},e.prototype.selectProject=function(t){var e,i;return this.options.isFrozenProject?this:(e=$(t.currentTarget),e.data("bs.popover")?void 0:(this.requestSubView(r,{container:this.$el,$toggler:e,searchPlaceholder:tb_i18n.get("task.menu.search.project"),dataList:this.projectsCollection.filter(function(t){return t.getRoleScope()>=0&&t.isAppEnabled("tasks")}).map(function(t){return{_id:t.get("_id"),title:t.get("name"),pinyin:t.get("pinyin")}}),selected:(null!=(i=this.projectModel)?i.id:void 0)||"",select:function(t){return function(e){var i;if(e!==(null!=(i=t.projectModel)?i.id:void 0))return t.projectModel=t.projectsCollection.get(e),t.stageModel=null,t.setTasklistModel(e)}}(this)}).show(),this))},e.prototype.selectTasklist=function(t){var e,i;if(this.projectModel&&(e=$(t.currentTarget),!e.data("bs.popover")))return this.tasklistMenuView=this.requestSubView(r,{container:this.$el,$toggler:e,dataList:[],selected:(null!=(i=this.tasklistModel)?i.id:void 0)||"",select:function(t){return function(e){var i;if(e!==(null!=(i=t.tasklistModel)?i.id:void 0))return t.tasklistModel=t.tasklistsCollection.get(e),t.stageModel=null,t.render()}}(this)}).show(),this.tasklistMenuView.update([]),c.fetch(this.projectModel.id,{success:function(t){return function(e){if(t.$el)return t.tasklistsCollection=e,t.tasklistMenuView.update(e.map(function(t){return{_id:t.get("_id"),title:t.get("title")}}))}}(this)}),this},e.prototype.selectStage=function(t){var e,i;if(this.tasklistModel&&(e=$(t.currentTarget),!e.data("bs.popover")))return this.stageMenuView=this.requestSubView(r,{container:this.$el,$toggler:e,dataList:[],selected:(null!=(i=this.stageModel)?i.id:void 0)||"",select:function(t){return function(e){var i;if(e!==(null!=(i=t.stageModel)?i.id:void 0))return t.stageModel=t.stagesCollection.get(e),t.render()}}(this)}).show(),this.stageMenuView.update([]),a.fetch(this.tasklistModel.id,{success:function(t){return function(e){if(t.$el)return t.stagesCollection=e,t.stageMenuView.update(e.map(function(t){return{_id:t.get("_id"),title:t.get("name")}}))}}(this)}),this},e.prototype.setTasklistModel=function(t){return this.projectModel.isAppEnabled("tasklist")?(this.tasklistModel=null,this.render()):c.fetch(t,{success:function(t){return function(e){if(t.$el)return t.tasklistsCollection=e,t.tasklistModel=e.at(0),t.render()}}(this)}),this},e}(l)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="stage-selector-block"> <span class="stage-selector-label">'+tb_i18n.get("project")+"</span> ";return i+=t.isFrozenProject?' <span class="project-name">'+e(t.project.name||tb_i18n.get("task.menu.select.project"))+"</span> ":' <a class="stage-selector-handler select-project"> <span class="project-name">'+e(t.project.name||tb_i18n.get("task.menu.select.project"))+'</span> <span class="icon icon-chevron-down"></span> </a> ',i+="</div>",t.isTasklistEnabled&&(i+=' <div class="stage-selector-block"> <span class="stage-selector-label">'+tb_i18n.get("task.group")+'</span> <a class="stage-selector-handler select-tasklist"> <span class="tasklist-name">'+e(t.tasklist.title||tb_i18n.get("task.menu.select.group"))+'</span> <span class="icon icon-chevron-down"></span> </a> </div>'),i+='<div class="stage-selector-block"> <span class="stage-selector-label">'+tb_i18n.get("stage")+'</span> <a class="stage-selector-handler select-stage"> <span class="stage-name">'+e(t.stage.name||tb_i18n.get("task.menu.select.stage"))+'</span> <span class="icon icon-chevron-down"></span> </a></div><p class="stage-selector-tips muted">'+e(t.tips||tb_i18n.get("stage.selector.tips"))+'</p><button class="btn btn-primary submit-handler" type="submit">'+tb_i18n.get("confirm")+"</button>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;p=i(358),l=i(677),a=i(447),c=i(804),s=i(813),r=i(1028),n=i(1030),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="PopoverRepeatPickerView",e.prototype.className="popover-repeat-picker-view",e.prototype.popoverTitle="Menu",e.prototype.width=170,e.prototype.events={"click .repeat-picker-item":"selectItem"},e.prototype.initialize=function(t){var i;return p.has(t,"select")?(this.rruleSet=c.getRRuleSet(t.recurrence),this.rruleSet||(i=t.startDate?new Date(t.startDate):new Date,this.rruleSet=new a.RRuleSet,this.rruleSet.rrule(new a({freq:a.WEEKLY,dtstart:i}))),this.selected=c.freq2Label(this.rruleSet),e.__super__.initialize.apply(this,arguments),this):void console.error("select is required!")},e.prototype.render=function(){var t,e;return e="CUSTOM"===this.selected?this.repeatOptions?c.repeatOptions2Description(this.repeatOptions):c.freq2Description(this.rruleSet):null,t={dataList:c.getRepeats(!0),selected:this.selected,description:e},this.$el.html(n(t)),this},e.prototype.selectItem=function(t){var e,i,n,r;return e=$(t.currentTarget),r=e.data("id"),e.addClass("selected").siblings().removeClass("selected"),"CUSTOM"===r?this.enterCustomRepeat():(this.hide(),n=c.label2RepeatOptions(r),this.rruleSet=c.updateRRuleSet(this.rruleSet,n),i=c.rruleSet2recurrence(this.rruleSet),this.options.select(i),this.selected=r,this.repeatOptions=null),this},e.prototype.enterCustomRepeat=function(){var t,e,i;return i=c.freq2RepeatOptions(this.rruleSet),t="CUSTOM"===c.freq2Label(this.rruleSet)?p.pick(i,"freq","interval","byweekday","bymonthday"):null,null!=(e=this.customView)&&e.remove(),this.customView=this.requestSubView(r,{customRepeatOptions:t,select:function(t){return function(e){var i;return t.hide(),t.rruleSet=c.updateRRuleSet(t.rruleSet,e),i=c.rruleSet2recurrence(t.rruleSet),t.options.select(i),t.selected="CUSTOM",t.repeatOptions=e}}(this)}),this.$popover.addClass("custom-repeat"),this.$content.html(this.customView.$el),this},e}(s)},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;p=i(358),c=i(677),a=i(804),l=i(788),o=i(429),s=i(813),n=i(1029),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="CustomRepeatView",e.prototype.className="custom-repeat-view",e.prototype.events={"click .repeat-freq":"selectFreq","click .repeat-interval":"selectInterval","click .toggle-weekday-handle":"toggleWeekday","click .toggle-monthday-handle":"toggleMonthday","click .submit-handler":"submit"},e.prototype.initialize=function(t){var e,i;return p.has(t,"select")?(this.options=t,this.state=p.extend({freq:2,interval:1,byweekday:[],bymonthday:[]},p.pick(this.options.customRepeatOptions,"freq","interval","byweekday","bymonthday")),this.props={freqs:[{_id:3,label:"DAILY",title:a.label2Title("DAILY")},{_id:2,label:"WEEKLY",title:a.label2Title("WEEKLY")},{_id:1,label:"MONTHLY",title:a.label2Title("MONTHLY")}],intervals:[1,2,3,4,5],weekdays:[0,1,2,3,4,5,6].map(function(t){return{_id:t,title:o().day(t+1).format("dd")}}),monthdays:function(){for(i=[],e=1;e<=31;e++)i.push(e);return i}.apply(this)},this.render(),this):void console.error("callback function select is required!")},e.prototype.setState=function(t){return this.state=p.extend({},this.state,t),this.render()},e.prototype.render=function(){var t,e;return e=p.find(this.props.freqs,function(t){return function(e){return e._id===t.state.freq}}(this)).label,t=p.extend({freqTitle:a.label2Title(e),description:a.repeatOptions2Description(this.state)},this.state,this.props),this.$el.html(n(t)),this},e.prototype.selectFreq=function(t){var e,i;return e=$(t.currentTarget),i=e.data("id"),this.setState({freq:i,interval:1,byweekday:[],bymonthday:[]})},e.prototype.selectInterval=function(t){var e,i;return e=$(t.currentTarget),i=e.data("id"),this.setState({interval:i})},e.prototype.toggleArrayItem=function(t,e){return p.contains(t,e)?p.without(t,e):p.union(t,[e]).sort(function(t,e){return t-e})},e.prototype.toggleWeekday=function(t){var e,i;return e=$(t.currentTarget),i=e.data("id"),this.setState({byweekday:this.toggleArrayItem(this.state.byweekday,i)})},e.prototype.toggleMonthday=function(t){var e,i;return e=$(t.currentTarget),i=e.data("id"),this.setState({bymonthday:this.toggleArrayItem(this.state.bymonthday,i)})},e.prototype.submit=function(t){var e;return t.preventDefault(),e=p.omit(this.state,function(t,e,i){return void 0===t}),this.options.select(e)},e}(l)},function(t,e){t.exports=function(t){var e='<form> <div class="form-group"> <label>'+tb_i18n.get("repeat")+':</label> <div class="dropdown"> <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu-repeat-freq" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"> <span>'+t.freqTitle+'</span> <span class="icon icon-chevron-down"></span> </button> <ul class="dropdown-menu" aria-labelledby="dropdownMenu-repeat-freq"> ',i=t.freqs;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <li class="repeat-freq ',t.freq===n._id&&(e+="selected"),e+='" data-id="'+n._id+'"><a>'+n.title+"</a></li> ";e+=' </ul> </div> </div> <div class="form-group"> <label>'+tb_i18n.get("repeat.interval")+':</label> <div class="dropdown"> <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu-repeat-interval" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"> <span>'+t.interval+'</span> <span class="icon icon-chevron-down"></span> </button> <ul class="dropdown-menu" aria-labelledby="dropdownMenu-repeat-interval"> ';var s=t.intervals;if(s)for(var a,r=-1,c=s.length-1;r<c;)a=s[r+=1],e+=' <li class="repeat-interval ',t.interval===a&&(e+="selected"),e+='" data-id='+a+"><a>"+a+"</a></li> ";if(e+=" </ul> </div> ",3===t.freq?e+=" <span>"+tb_i18n.get("day")+"</span> ":2===t.freq?e+=" <span>"+tb_i18n.get("week")+"</span> ":1===t.freq&&(e+=" <span>"+tb_i18n.get("month")+"</span> "),e+=" </div> ",2===t.freq){e+=' <div class="form-group"> <ul class="optional-days"> ';var l=t.weekdays;if(l)for(var p,r=-1,u=l.length-1;r<u;)p=l[r+=1],e+=" <li data-id="+p._id+' class="optional-day ',t.byweekday.indexOf(p._id)>-1&&(e+="active"),e+=' toggle-weekday-handle" >'+p.title+"</li> ";e+=" </ul> </div> "}else if(1===t.freq){e+=' <div class="form-group"> <ul class="optional-days"> ';var d=t.monthdays;if(d)for(var h,r=-1,m=d.length-1;r<m;)h=d[r+=1],e+=" <li data-id="+h+' class="optional-day ',t.bymonthday.indexOf(h)>-1&&(e+="active"),e+=' toggle-monthday-handle">'+h+"</li> ";e+=" </ul> </div> "}return e+=' <div class="form-group"> <p class="repeat-description">'+t.description+'</p> </div> <div class="form-group submit-wrap"> <button type="submit" ',(2===t.freq&&!t.byweekday.length||1===t.freq&&!t.bymonthday.length)&&(e+="disabled"),e+=' class="btn btn-primary submit-handler">'+tb_i18n.get("confirm")+"</button> </div></form>"}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<ul class="list-unstyled"> ',n=t.dataList;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=" ","CUSTOM"===r._id&&(i+=' <li class="divider"></li> '),i+=' <li class="repeat-picker-item ',t.selected===r._id&&(i+="selected"),i+='" data-id="'+r._id+'"> <a>'+e(r.title)+"</a> </li> ","CUSTOM"===r._id&&t.description&&(i+=' <li> <p class="repeat-description">'+t.description+"</p> </li> "),i+=" ";return i+="</ul>"}},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=i(788),r=i(429),n=i(401),s=i(1032),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.events={"click .task-datepicker:not(.ban)":"showDatePicker","click .task-timepicker:not(.ban)":"showTimePicker"},e.prototype.initialize=function(t){this.el=t.el,this.taskModel=t.taskModel,this.projectModel=t.projectModel,this.onSelect=t.onSelect},e.prototype.showDatePicker=function(t){var e,i,n,r,o,s,a;return e=$(t.currentTarget),a=e.data("type"),r=this.datePreProcess(a),s=r.startDate,n=r.endDate,i=r.date,null!=(o=this.$datePicker)&&o.datepicker("remove"),this.$datePicker=e.datepicker({format:"yyyy-mm-dd",language:tb_i18n.getLanguage(),placement:"left",startDate:s,endDate:n,todayHighlight:!0,todayBtn:"linked",tomorrowBtn:"linked",clearBtn:"linked"}).datepicker("update",this.parseDate(i)).datepicker("show").focus().on("changeDate",function(t){return function(i){return t.changeDateHandler(a,i.date,function(){return e.datepicker("hide")})}}(this))},e.prototype.showTimePicker=function(t){var e,i,n,o,a,c,l,p;if(e=$(t.currentTarget),!e.data("showTimePicker"))return e.data("showTimePicker",!0),p=e.data("type"),a=this.datePreProcess(p),c=a.startDate,n=a.endDate,i=a.date,(this.isDateJumped||"startDate"===p)&&c&&(l=new r(c),l.subtract(1,"m"),c=new Date(l.toString())),this.isDateJumped&&n&&(o=new r(n),o.add(1,"m"),n=new Date(o.toString())),this.requestSubView(s,{addPlaceholder:tb_i18n.get("time.input.placeholder"),$toggler:e,currentDate:i,startDate:c,endDate:n,select:function(t){return function(e){return i.setHours(e.hours),i.setMinutes(e.minutes),t.onSelect(p,i)}}(this)}).show(),this},e.prototype.parseDate=function(t){var e;return t instanceof Date||(t=new Date(t)),e=new Date(t.toDateString())},e.prototype.datePreProcess=function(t){var e,i,n,o,s;switch(o=this.taskModel.get("startDate"),i=this.taskModel.get("dueDate"),t){case"startDate":o=null,i?(n=new r(i).subtract(1,"m"),n.isSame(i,"day")?n.add(1,"m"):this.isDateJumped=!0,i=new Date(n.toString())):i=null;break;case"dueDate":i=null,o?(s=new r(o).add(1,"m"),s.isSame(o,"day")?s.subtract(1,"m"):this.isDateJumped=!0,o=new Date(s.toString())):o=null}return e=this.taskModel.get(t),e=e?new Date(e):new Date,{startDate:o,endDate:i,date:e}},e.prototype.timePreProcess=function(t,e){var i,n,o,s,a,c,l,p,u,d;return o=this.taskModel.get("dueDate"),u=this.taskModel.get("startDate"),s=o?new r(o):null,d=u?new r(u):null,n=new r(e),c=function(){switch(t){case"startDate":return n.isSame(s,"day");case"dueDate":return n.isSame(d,"day");default:return!1}}(),i={type:t,startDateMoment:d,endDateMoment:s,defaultDateMoment:n},p=c&&!this.isDateJumped?this.getDefaultMonent(i):this.getDefaultMonentOnAnotherDay(i),e=p.date,a=p.hour,l=p.minute,{date:new Date(e.toString()),hour:a,minute:l}},e.prototype.getDefaultHour=function(t){switch(t){case"startDate":return 9;case"dueDate":return 18}},e.prototype.getDefaultMonentOnAnotherDay=function(t){var e,i,n,r,o;return o=t.type,i=t.defaultDateMoment,e=i,r=0,n=this.getDefaultHour(o),{date:e,hour:n,minute:r}},e.prototype.getDefaultMonent=function(t){var e,i,n,r,o,s,a,c,l,p,u;switch(u=t.type,c=t.startDateMoment,n=t.endDateMoment,i=t.defaultDateMoment,e=i,s=this.getDefaultHour(u),a=0,u){case"startDate":n&&(r=n.hour(),o=n.minute(),r<1||1===r&&0===o?s=0:r<9||9===r&&0===o?(s=r-1,a=o):s=9);break;case"dueDate":c&&(l=c.hour(),p=c.minute(),l<18?s=18:l<22||22===l&&p<=58?(s=l+1,a=p):(l<23||23===l&&p<=58)&&(s=23,a=59))}return{date:e,hour:s,minute:a}},e.prototype.changeDateHandler=function(t,e,i){var o,s,a,c,l,p,u,d,h;return e&&(this.projectModel.isAppEnabled("preciseDate")?this.taskModel.get(t)?(o=new Date(this.taskModel.get(t)),c=o.getHours(),l=o.getMinutes()):(u=this.timePreProcess(t,e),e=u.date,c=u.hour,l=u.minute):(c=0,l=0),e.setHours(c),e.setMinutes(l),d=this.datePreProcess().startDate,s=this.taskModel.get("dueDate")||null,p=new r(e),a=new r(s),h=new r(d),this.isDateJumped&&("startDate"===t&&s?a.add(1,"m"):"dueDate"===t&&d&&h.subtract(1,"m")),"startDate"===t&&s&&!p.isBefore(a)||"dueDate"===t&&d&&!p.isAfter(h))?n.error(tb_i18n.get("time.setting.error")):(i(),this.onSelect(t,e))},e.prototype.remove=function(){var t;return null!=(t=this.$datePicker)&&t.datepicker("remove"),e.__super__.remove.apply(this,arguments)},e}(a)},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(788),n=i(401),r=i(429),o=i(1021),a=i(677),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.initialize=function(t){var e;if(null==t&&(t={}),t.$toggler)return this.options=t,this.$toggler=this.options.$toggler,this.startDate=this.options.startDate?new Date(this.options.startDate):null,this.startDate&&this.startDate.setMilliseconds(0),this.endDate=this.options.endDate?new Date(this.options.endDate):null,this.endDate&&this.endDate.setMilliseconds(0),this.options.currentDate?(this.currentDate=new Date(this.options.currentDate),this.currentDate.setMilliseconds(0),this.selected=60*this.currentDate.getHours()+this.currentDate.getMinutes()):(e=new Date,this.currentDate=new Date(e.getFullYear(),e.getMonth(),e.getDate())),this.adjust=this.options.addPlaceholder?-20:0,this.hourStep=this.options.hourStep||1,this.minuteStep=this.options.minuteStep||15,this.render()},e.prototype.render=function(){return this.popoverMenuView=this.requestSubView(o,{addPlaceholder:this.options.addPlaceholder,$toggler:this.$toggler,width:170,dataList:this.getDataList(),selected:this.selected,select:this.selectTime.bind(this),add:this.addTime.bind(this),onShown:function(t){return function(){return t.popoverMenuView.scrollToSelected(!1,t.adjust)}}(this)}),this},e.prototype.getDataList=function(){var t,e,i,n,o,s,a,c,l,p;for(e=[],p=this.startDate?r(this.startDate):null,i=this.endDate?r(this.endDate):null,t=r(this.currentDate),n=s=0,c=this.hourStep;s<=23;n=s+=c)for(o=a=0,l=this.minuteStep;a<=59;o=a+=l)t.set("hours",n),t.set("minutes",o),p&&!t.isAfter(p)||i&&!t.isBefore(i)||e.push({_id:60*n+o,title:r(t).format("LT")});return e},e.prototype.addTime=function(t){var e,i,o,s,a,c;if(c=/^(([01]?[0-9])|(2[0-3])):[0-5]?[0-9]$/,c.test(t)){if(s=t.split(":")[0],a=t.split(":")[1],this.currentDate.setHours(s),this.currentDate.setMinutes(a),i=r(this.currentDate),this.startDate&&i.isAfter(this.startDate)||this.endDate&&i.isBefore(this.endDate)||!this.startDate&&!this.endDate)return this.popoverMenuView.hide(),"function"==typeof(e=this.options).select?e.select({hours:this.currentDate.getHours(),minutes:this.currentDate.getMinutes()}):void 0;o=tb_i18n.get("time.setting.error")}return o=o||tb_i18n.get("time.format.error"),n.show({message:o,status:"error"}),this.popoverMenuView.render(),this.popoverMenuView.scrollToSelected(!1,this.adjust)},e.prototype.selectTime=function(t){var e,i;if(this.$el)return i=+t,this.currentDate.setHours(Math.floor(i/60)),this.currentDate.setMinutes(i%60),"function"==typeof(e=this.options).select?e.select({hours:this.currentDate.getHours(),minutes:this.currentDate.getMinutes()}):void 0},e.prototype.show=function(){return this.popoverMenuView.show()},e.prototype.hide=function(){return this.popoverMenuView.hide()},e}(c)},function(t,e){t.exports=function(t){var e='<header class="creator-header"> <h4 class="creator-title"> <span class="creator-location-tips">'+tb_i18n.get("task.creator.tips")+'</span> <a class="creator-location-handler" data-gta="{action: \'move content\', type: \'task\', control: \'Global New Task\'}"> <span class="creator-location"></span> <span class="icon icon-chevron-down"></span> </a> </h4> <a class="creator-close pull-right icon icon-remove" data-dismiss="modal"></a></header><section class="creator-body"> <div class="creator-block task-creator-input-wrap thin-scroll"> <textarea class="task-content-input form-control" placeholder="'+tb_i18n.get("task.creator.content")+'" data-gta="{action: edit title, type: task, control: Global New Task}"></textarea> </div> <div class="creator-block no-padding creator-flex"></div> <div class="creator-block creator-involve"></div></section><footer class="creator-footer clearfix"> <a class="creator-visible creator-visible-members hide" data-visible="involves" data-gta="{action: Toggle visibility, control: Global New Task}"> <span class="icon icon-unlock"></span>'+tb_i18n.get("visible.mode")+' <span class="mode-explanation">'+tb_i18n.get("visible.to.member")+'</span> </a> <a class="creator-visible creator-visible-involves hide" data-visible="members"> <span class="icon icon-lock"></span>'+tb_i18n.get("visible.mode")+' <span class="mode-explanation">'+tb_i18n.get("visible.to.involve")+'</span> </a> <div class="btn-wrap submiting"> <button class="btn btn-primary submit-handler"> '+tb_i18n.get("create")+' </button> <div class="btn-layer"></div> </div></footer>';return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="creator-flex-item on-flex"> <h6 class="creator-flex-title">'+tb_i18n.get("task.detail.executor")+'</h6> <div class="creator-flex-body"> ';i+=t.executor?' <a class="task-creator-executor" data-gta="{action: select assignee, control: Global New Task}"> <div class="task-creator-handler-icon avatar img-24 img-circle" style="background-image: url('+t.executor.avatarUrl+')"></div> '+e(t.executor.name)+" </a> ":' <a class="task-creator-executor dirty" data-gta="{action: select assignee, control: Global New Task}"> <div class="task-creator-handler-icon avatar img-24 img-circle no-avatar"></div> '+tb_i18n.get("task.detail.no.executor")+" </a> ",i+=" </div></div>";var n=t.dateItems;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<div class="creator-flex-item on-flex"> <h6 class="creator-flex-title">'+r.title+'</h6> <div class="creator-flex-body task-creator-date"> <a class="task-datepicker" data-type="'+r.type+'" data-gta="{action: edit ',i+="startDate"===r.type?"start ":"due ",i+="date, control: 'Global New Task' ",t.projectId&&(i+=", projectid: '"+t.projectId+"'"),t.orgId&&(i+=", organizationid: '"+t.orgId+"'"),i+='}}"> <span class="icon icon-calendar2"></span> <span>'+(r.dateString||tb_i18n.get("task.detail.time.click.set"))+"</span> </a> ",t.preciseDate&&r.timeString&&(i+=' <a class="task-timepicker" data-type="'+r.type+'" data-gta="{action: \'edit ',i+="startDate"===r.type?"start ":"due ",i+="time', control: 'Global New Task' ",t.projectId&&(i+=", projectid: '"+t.projectId+"'"),t.orgId&&(i+=", organizationid: '"+t.orgId+"'"),i+='}}"> <span>'+r.timeString+"</span> </a> "),i+=" </div></div>";return t.isStartTimeEnable||(i+='<div class="creator-flex-item"> <h6 class="creator-flex-title">'+tb_i18n.get("task.detail.priority")+'</h6> <div class="creator-flex-body"> <a class="task-creator-priority ',t.priorityTitle||(i+="dirty"),i+='" data-gta="{action: select priority, control: Global New Task}"> <span class="icon icon-circle priority-label ',t.priority&&(i+="color-priority-"+t.priority),i+='"></span> '+(t.priorityTitle||tb_i18n.get("priority.none"))+' </a> </div></div><div class="creator-flex-item"> <h6 class="creator-flex-title">'+tb_i18n.get("task.detail.repeat")+'</h6> <div class="creator-flex-body"> <a class="task-creator-repeat ',t.repeatTitle||(i+="dirty"),i+='" data-gta="{action: set repeat, control: Global New Task}"> <span class="icon icon-repeat"></span> '+(t.repeatTitle||tb_i18n.get("repeat.freq.NO"))+" </a> </div></div>"),i}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t.dataList;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li class="creator-priority menu-item ',r.selected&&(i+="selected"),i+='" data-id="'+r._id+'"> <a><span class="icon icon-circle creator-priority-'+r._id+'"></span>'+e(r.title)+"</a></li>";return i}},function(t,e){t.exports=function(t){var e='<ul class="flex-static tasklists-list thin-scroll"></ul><div class="flex-fill flex-vert tasks-list-wrapper"> <a class="flex-static flex-vcenter object-picker-creator link-add-handler"> <span class="icon icon-circle-cross"></span> <span>'+tb_i18n.get("object.picker.task.creator.tips")+'</span> </a> <ul class="flex-fill thin-scroll tasks-list"> </ul></div>';return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li class="group-name"> <p>'+tb_i18n.get("task.group2")+"</p></li>",n=t.tasklists;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li> <a class="tasklist-item tasklist-normal" data-id="'+r._id+'">'+e(r.title)+"</a></li>";return i+='<li class="smart-group group-name"> <p class="tasklist-smart-title">'+tb_i18n.get("tasklist.bar.smart.group")+'</p></li><li class="smart-group"> <a class="tasklist-smart-today tasklist-item" data-gta="event" data-label="smart group today">'+tb_i18n.get("tasklist.bar.today.tasks")+'</a></li><li class="smart-group"> <a class="tasklist-smart-total tasklist-item" data-gta="event" data-label="smart group total">'+tb_i18n.get("tasklist.bar.total.tasks")+'</a></li><li class="smart-group"> <a class="tasklist-smart-done tasklist-item" data-gta="event" data-label="smart group done">'+tb_i18n.get("tasklist.bar.done.tasks")+"</a></li>";
}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t.tasks;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li class="task ',r.disabled&&(i+="disabled"),i+=' hinted" data-id="'+r._id+'" data-title="'+e(r.content)+'"> ',i+=r.executor&&r.executor.avatarUrl?' <div class="avatar img-circle img-24" style="background-image:url('+r.executor.avatarUrl+')"></div> ':' <div class="avatar img-circle img-24 no-avatar"></div> ',i+=' <div class="task-content-wrapper"> <span class="task-content">'+e(r.content)+'</span> </div> <span class="task-id-placeholder"></span></li>';return i}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t.stages;if(n)for(var r,o=-1,s=n.length-1;o<s;){r=n[o+=1],i+=' <li class="stage-name group-name"><p>'+r.stageName+"</p></li> ";var a=r.tasks;if(a)for(var c,l=-1,p=a.length-1;l<p;)c=a[l+=1],i+=' <li class="task ',c.disabled&&(i+="disabled"),i+=' hinted" data-id="'+c._id+'" data-title="'+e(c.content)+'"> ',i+=c.executor&&c.executor.avatarUrl?' <div class="avatar img-circle img-24" style="background-image:url('+c.executor.avatarUrl+')"></div> ':' <div class="avatar img-circle img-24 no-avatar"></div> ',i+=' <div class="task-content-wrapper"> <span class="task-content">'+e(c.content)+'</span> </div> <span class="task-id-placeholder"></span> </li> '}return i}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f=function(t,e){function i(){this.constructor=t}for(var n in e)g.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},g={}.hasOwnProperty,v=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};m=i(358),p=i(797),u=i(677),d=i(788),r=i(401),l=i(697),c=i(1041),h=i(786),s=i(1043),n=i(1060),a=i(1061),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.viewName="ObjectPickerPostsView",e.prototype.className="object-picker-posts-view flex-vert",e.prototype.events={"click .post":"togglePost","click .object-picker-creator":"creatorHandler"},e.prototype.initialize=function(t){if(t._projectId)return this.options=t,this._projectId=t._projectId,this.projectModel=l.get(this._projectId),this.selected=[],this.renderBasic(),this.listen(),this.showLoadingIndicator(this.$list),new Promise(function(t){return function(e,i){return c.fetch(t._projectId,{success:e,error:function(t,e){return i(e)}})}}(this)).then(function(t){return function(e){if(t.$el)return t.hideLoadingIndicator({animated:!1}),t.postsCollection=e,t.renderPosts(t.postsCollection.models),t.setupScroll(t.$list)}}(this))["catch"](function(t){if(console.error(t),t)return r.show({message:t.message||t,status:"error"})}),this},e.prototype.loadMore=function(t){var e,i;return i=e=0,this.postsCollection.loadMore({silent:!0,section:"all",beforeSend:function(t){return function(){return i=(new Date).getTime(),t.showLoadingIndicator(t.$list)}}(this),success:function(n){return function(r,o,s){var a,c;if(n.$el)return e=(new Date).getTime(),c=e-i,a=c<1e3?1e3-c:0,m.delay(function(){if(n.$el)return n.hideLoadingIndicator({animated:!0}),n.renderPosts(o.map(function(t){return n.postsCollection.get(t._id)})),n.postsCollection.hasMore?"function"==typeof t?t():void 0:n.showEndPoint(n.$list)},a)}}(this)}),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this.togglePostCreator(),this.$list=this.$(".posts-list"),this},e.prototype.listen=function(){return this.listenTo(this.projectModel,"change:applications",function(){if(this.projectModel.isAppChanged("posts"))return this.togglePostCreator()}),this},e.prototype.togglePostCreator=function(){var t,e;return t=(null!=(e=this.projectModel)?e.isAppEnabled("posts"):void 0)?"removeClass":"addClass",this.$el[t]("no-creator"),this},e.prototype.renderPosts=function(t){var e;return e=$(a({posts:m.map(t,function(t){return function(e){var i,n;return i=e.toJSON(),i.disabled=(n=e.id,v.call(t.options.exclude,n)>=0),i}}(this))})),this.$list.append(e),this},e.prototype.creatorHandler=function(){return this.requestSubView(h).open(s,{backdrop:"static",_projectId:this._projectId,onsave:function(t){return function(e){return t.options.onCreate([e.toJSON()])}}(this)})},e.prototype.togglePost=function(t){var e,i;if(e=$(t.currentTarget),!e.hasClass("disabled"))return!e.hasClass("selected")&&this.selected.length>=10?r.show({message:tb_i18n.get("object.picker.exceed.number"),status:"error"},2e3):(e.toggleClass("selected"),i=e.data("id"),e.hasClass("selected")?this.selected.push(i):u.removeItem(this.selected,i),this.options.onSelect(this.selected.map(function(t){return{_id:t,type:"post"}})),this)},e}(d),m.extend(o.prototype,p),t.exports=o},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty,c=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};n=i(685),o=i(1042),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.name="posts",e.prototype.model=o,e.prototype.pageNum=20,e.prototype.boundToObjectType="project",e.prototype.order=-1,e.prototype.orderBy="updated",e.prototype.listen=function(){return this.on("change:_projectId",function(t,i){var n;return null!=(n=e.find(i))&&n.add(t),this.remove(t)}),e.__super__.listen.apply(this,arguments)},e.prototype.getType=function(t){var e;return e=["all","my"],c.call(e,t)>=0?t:e[0]},e.prototype.getParams=function(t,e){return{type:"read"===t&&null!=e?e.section:void 0}},e.prototype.comparator=function(t,e){var i;return(i=(e.get("pin")||0)-(t.get("pin")||0))?i:(i=new Date(t.get(this.orderBy))-new Date(e.get(this.orderBy)),i=this.order*i)},e}(n)},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=i(358),n=i(688),o=i(677),s=i(792),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.name="post",e.prototype.urlRoot="posts",e.prototype.defaults={objectType:"post",involveMembers:[],links:[]},e.prototype.listen=function(){if(!this.listenedLock&&this.id)return this.listenedLock=!0,this.on("change:visible",function(t){var e;if(!t.checkIsVisible())return null!=(e=t.collection)?e.remove(t):void 0}),e.__super__.listen.apply(this,arguments)},e.prototype.initialize=function(){return this.on("change",this.initSubscribe),e.__super__.initialize.apply(this,arguments)},e.prototype.parse=function(t){return t=a.extend(this.toJSON(),t),o.parsePost(t)},e.prototype.initSubscribe=function(){var t,e,i,n;for(t=this.get("attachments")||[],e=0,i=t.length;e<i;e++)n=t[e],this.subscribeTo(n._id,"change",function(t){return function(e){return t.updateAttachments(e.toJSON())}}(this)),this.subscribeTo(n._id,"destroy",function(t){return function(e){return t.removeAttachments(e)}}(this));return this},e.prototype.updateAttachments=function(t){var e,i,n,r,o;for(e=this.get("attachments")||[],r=[],i=0,n=e.length;i<n;i++)o=e[i],t._id!==o._id?r.push(o):r.push(t);return this.set("attachments",r),this},e.prototype.removeAttachments=function(t){var e,i,n,r,o;for(e=this.get("attachments")||[],r=[],i=0,n=e.length;i<n;i++)o=e[i],o._id!==t&&r.push(o);return this.set("attachments",r),this},e.prototype.getAttachmentDatas=function(){var t,e,i,n,r;for(n=[],t=this.get("attachments")||[],e=0,i=t.length;e<i;e++)r=t[e],n.push(s.formatWork(r));return n},e.prototype.pin=function(t){return null==t&&(t={}),t.attrs={pin:!0},this.thumbUp("pin","update",t),this},e.prototype.unpin=function(t){return null==t&&(t={}),t.attrs={pin:!1},this.thumbUp("pin","update",t),this},e.prototype.forkOrMove=function(t,e,i){return i||(i={}),i.url=this.url()+"/"+t,i.attrs={_projectId:e},this.sync("update",this,i),this},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T=function(t,e){function i(){this.constructor=t}for(var n in e)M.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},M={}.hasOwnProperty;_=i(358),j=i(678),r=i(401),o=i(439),g=i(681),y=i(677),b=i(788),c=i(1044),h=i(1042),a=i(699),f=i(696),w=i(810),m=i(1041),s=i(1002),u=i(1045),d=i(1048),v=i(1052),k=i(924),l=i(1021),n=i(1059),t.exports=p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return T(e,t),e.prototype.className="post-creator modal-dialog creator-view",e.prototype.events={"click .creator-location-handler":"showLocationSelector","click .submit-handler":"submit","input .post-title-input":"titleInputChangeHandler","change .post-title-input":"cachePost","click .creator-visible":"switchVisible","keydown .post-creator-editor-wrap":"quickSubmit","click .creator-close":"close","click .restore-draft":"restoreDraft","click .discard-draft":"discardDraft"},e.prototype.saveAttrs=["_projectId","_creatorId","involveMembers","content","postMode","title","visible","attachments"],e.prototype.initialize=function(t){var e,i,n,r,o;return this.options=t,this.isEdit=!!t.postModel,e=null!=(n=t.parentView)?n.$el:void 0,e&&e.hasClass("modal")&&e.css("display","block"),this.projectsCollection=f.get(0),this.options._projectId?this.projectModel=this.projectsCollection.get(t._projectId):this.projectModel=j.APP.getClosestProject(),(null!=(r=this.projectModel)?r.isAppEnabled("posts"):void 0)||(this.projectModel=f.get(0).find(function(t){return t.isAppEnabled("posts")})),this.projectModel?(this.isEdit?this.postMode=null!=(o=t.postModel)?o.get("postMode"):void 0:this.postMode=t.postMode,"md"!==this.postMode&&(this.postMode="html"),this.isYiqixie=t.isYiqixie,this.yiqixieUrl=t.yiqixieUrl,this.isYiqixie?this.postType="cowrite":"md"===this.postMode?this.postType="markdown":this.postType="normal",this.localCache=g.namespace("temp").namespace("posts_wall"),this.isEdit||(this.localCacheId="post_creator_"+this.projectModel.id),i=this.localCache(this.localCacheId),!this.isEdit&&i&&i._id&&this.clearCache(),this.load({success:function(t){return function(){return t.reset(),t.renderBasic(),t.isYiqixie||t.initUploader(),t.renderLoaction(),t.isYiqixie||t.renderEditor(),t.renderInvolve(),t.renderVisible(),t.listen(),t.bindRefreshAndCloseAlert(),_.delay(function(){if(t.$el)return t.$footerFixed.addClass("on-fixed")},300)}}(this)}),this):this.close()},e.prototype.load=function(t){var e;return null==t&&(t={}),e=a.find(this.projectModel.id),e?"function"==typeof t.success?t.success():void 0:a.fetch(this.projectModel.id,{success:function(){return"function"==typeof t.success?t.success():void 0},error:function(t,e){return console.error(e),this.close()}})},e.prototype.reset=function(){var t;return this.membersCollection=a.get(this.projectModel.id),this._defaultCollectionId=this.projectModel.get("_defaultCollectionId"),this.isEdit?this.postModel=this.options.postModel.clone():(t=_.extend({_creatorId:j.user.id,involveMembers:[j.user.id],content:"",title:"",visible:"members",attachments:[]},this.localCache(this.localCacheId),{_projectId:this.projectModel.id}),t.involveMembers=_.filter(t.involveMembers,function(t){return function(e){return!!t.membersCollection.get(e)}}(this)),t.postMode!==this.postMode&&(t.content="",t.postMode=this.postMode),this.postModel=new h(t)),this.attachments=new w(this.postModel.get("attachments"),{boundToObjectType:"collection",_boundToObjectId:this._defaultCollectionId}),this.listen()},e.prototype.listen=function(){return this.listenTo(this.attachments,"add change remove",this.cachePost),this.listenTo(this.postModel,"change",this.cachePost),this.listenTo(this.postModel,"change:visible",this.renderVisible),this},e.prototype.renderBasic=function(){return"md"===this.postMode&&this.$el.addClass("markdown-mode"),this.$el.addClass(tb_i18n.getLanguage()),this.$el.html(n({title:this.postModel.get("title")||"",isEdit:this.isEdit,postMode:this.postMode,hasMemCache:this.postModel.getMemCache(),isYiqixie:this.isYiqixie,yiqixieUrl:this.yiqixieUrl})),this.$location=this.$(".creator-location"),this.$submit=this.$(".submit-handler"),this.$titleInput=this.$(".post-title-input"),this.$visibleTitle=this.$(".visible-title"),this.$involveWrap=this.$(".involve-set"),this.$editorWrap=this.$(".post-creator-editor-wrap"),this.$visibleMembers=this.$(".creator-visible[data-visible=members]"),this.$visibleInvolves=this.$(".creator-visible[data-visible=involves]"),this.$footerFixed=this.$(".post-creator-footer-fixed"),this.checkSubmitState(),this},e.prototype.initUploader=function(){return this.requestSubView(k,{projectModel:this.projectModel,collection:this.attachments,pick:null,dnd:this.$editorWrap,paste:this.$editorWrap})},e.prototype.renderLoaction=function(){var t;return t=this.projectModel.toJSON(),this.$location.text(t.name),this},e.prototype.renderEditor=function(){var t,e;return t="md"===this.postMode?d:u,null!=(e=this.postEditorView)&&e.remove(),this.postEditorView=this.requestSubView(t,{_projectId:this.projectModel.id,content:this.postModel.get("content"),attachments:this.attachments,onchange:function(t){return function(e){return t.postModel.set("content",e),t.checkSubmitState()}}(this)}),this.$editorWrap.html(this.postEditorView.$el),this},e.prototype.renderInvolve=function(){return this.requestSubView(s,{_projectId:this.projectModel.id,objectModel:this.postModel,membersCollection:this.membersCollection,resident:[j.user.id]}).$el.prependTo(this.$involveWrap.empty()),this},e.prototype.renderVisible=function(){var t;return t=this.postModel.get("visible"),"involves"===t?(this.$visibleMembers.addClass("hide"),this.$visibleInvolves.removeClass("hide")):(this.$visibleMembers.removeClass("hide"),this.$visibleInvolves.addClass("hide")),this},e.prototype.switchVisible=function(t){var e;return e=this.postModel.get("visible"),this.postModel.set("visible","involves"===e?"members":"involves"),this},e.prototype.showLocationSelector=function(t){var e,i;return e=$(t.currentTarget),e.data("bs.popover")||this.requestSubView(l,{container:this.$el,$toggler:e,searchPlaceholder:tb_i18n.get("task.menu.search.project"),dataList:this.projectsCollection.filter(function(t){return t.getRoleScope()>=0&&t.isAppEnabled("posts")}).map(function(t){return{_id:t.get("_id"),title:t.get("name"),pinyin:t.get("pinyin")}}),selected:(null!=(i=this.projectModel)?i.id:void 0)||"",select:function(t){return function(e){var i,n;if(e!==(null!=(i=t.projectModel)?i.id:void 0))return null!=(n=t.postEditorView)&&n.setProjectId(e),t.projectModel=t.projectsCollection.get(e),a.fetch(t.projectModel.get("_id"),{success:function(e){if(t.$el)return t.reset(),t.cachePost(),t.renderLoaction(),t.renderInvolve()}})}}(this)}).show(),this},e.prototype.restoreDraft=function(){var t;return t=this.postModel.getMemCache()||{},t.title&&this.$titleInput.val(t.title).focusAtEnd(),t.content&&this.postEditorView.set(t.content).focus(),this.postModel.clearMemCache(),this.$(".draft").remove(),this},e.prototype.discardDraft=function(){return this.postModel.clearMemCache(),this.$(".draft").remove(),this},e.prototype.quickSubmit=function(t){return 13===t.keyCode&&(t.ctrlKey||t.shiftKey||t.metaKey)&&(t.preventDefault(),this.submit()),this},e.prototype.submit=function(){var t;if(!this.submitLock){if(t=this.attachments.getUploadingCount())return void r.show({message:tb_i18n.get("works.uploader.uploading.total",t),status:"warning"});if(this.disableSubmit(),this.isYiqixie&&this.yiqixieUrl)this.isEdit?c.updateYiqixieDocument(this.yiqixieUrl,this.postModel).then(function(t){return function(e){var i;return t.postModel.set("content",e),t.enableSubmit(),t.postModel.clearMemCache(),"function"==typeof(i=t.options).onsave&&i.onsave(e),t.close()}}(this)):c.saveYiqixieDocument(this.yiqixieUrl,this.postModel).then(function(t){return function(e){var i,n;return t.enableSubmit(),t.clearCache(),null!=(n=m.find(e.get("_projectId")))&&n.add(e.toJSON()),t.options.isEssage!==!1&&y.message({tips:tb_i18n.get("create.post.success"),url:"/project/"+e.get("_projectId")+"/posts/post/"+e.id,title:e.get("description")}),"function"==typeof(i=t.options).onsave&&i.onsave(e),t.close()}}(this));else{if(!this.postModel.get("content"))return this.postEditorView.focus();this.isEdit?this.updatePost():(j.gta.event({action:"added content",type:"post",control:this.options.gta_from||"Add Post",method:this.postType}),this.createPost())}return this}},e.prototype.createPost=function(){var t;return t=this.getPostAttrs(),this.createAttachments(function(e){return function(i){return t.attachments=i,e.postModel.save(null,{attrs:t,wait:!0,error:function(){return e.enableSubmit(),e.postEditorView.focus()},success:function(t){var i,n;return e.enableSubmit(),e.clearCache(),e.stopListening(),null!=(n=m.find(t.get("_projectId")))&&n.add(t.toJSON()),e.options.isEssage!==!1&&y.message({tips:tb_i18n.get("create.post.success"),url:"/project/"+t.get("_projectId")+"/posts/post/"+t.id,title:t.get("description")}),"function"==typeof(i=e.options).onsave&&i.onsave(t),e.close()}})}}(this)),this},e.prototype.updatePost=function(){var t;return t=this.getPostAttrs(),this.createAttachments(function(e){return function(i){var n;return e.options.postModel.set(t),n=e.options.postModel.changed,n.attachments=i,n.visible&&e.updatePostVisible(n.visible),e.options.postModel.save(null,{wait:!0,attrs:n,success:function(t){var i;return e.enableSubmit(),e.postModel.clearMemCache(),"function"==typeof(i=e.options).onsave&&i.onsave(t),e.close()}})}}(this)),this},e.prototype.updatePostVisible=function(t){return this.options.postModel.saveAttr("visible",t)},e.prototype.createAttachments=function(t){return new Promise(function(t){return function(e,i){return t.attachments.length?t.attachments.addWorks(t.attachments.toJSON(),{_parentId:t._defaultCollectionId,_projectId:t.projectModel.id,success:e,error:function(t,e){return i(e)}}):e()}}(this)).then(function(e){return function(){var i;return i=e.attachments.map(function(t){return t.id}).filter(function(t){return null!=t}),t(i)}}(this))["catch"](function(t){return console.error(t)})},e.prototype.titleInputChangeHandler=function(){return this.checkSubmitState(),this},e.prototype.checkSubmitState=function(){var t,e;if(!this.isYiqixie)return e=this.$titleInput.val().trim(),t=this.postModel.get("content"),e.length&&t.length?this.enableSubmit():this.disableSubmit(),this},e.prototype.disableSubmit=function(){return this.submitLock=!0,this.$submit.prop("disabled",!0),this},e.prototype.enableSubmit=function(){return this.submitLock=!1,this.$submit.prop("disabled",!1),this},e.prototype.getPostAttrs=function(){var t;return t=_.extend(this.postModel.toJSON(),{title:this.$titleInput.val().trim()||this.getTitleFromContent(),content:this.postEditorView.get()}),_.pick(t,this.saveAttrs)},e.prototype.getTitleFromContent=function(){var t,e;return e=this.postModel.get("content"),e="html"===this.postMode?_.unescape(e):o(e),t=$("<div>"+e+"</div>"),e=t.text().trim(),y.cutString(e,120,"...")||tb_i18n.get("post.un.title")},e.prototype.cachePost=function(){var t,e,i,n;return this.localCacheId?(e=_.extend(this.postModel.toJSON(),{title:this.$titleInput.val().trim(),attachments:this.attachments.toJSON()}),this.localCache(this.localCacheId,e)):(t=null!=(i=this.postEditorView)?i.get():void 0,n=this.$titleInput.val(),t===this.options.postModel.get("content")&&n===this.options.postModel.get("title")||this.postModel.setMemCache({content:t,title:this.$titleInput.val()})),this},e.prototype.clearCache=function(){return this.localCacheId&&this.localCache.remove(this.localCacheId),this},e.prototype.windowBeforeunload=function(t){return t||(t=window.event),t.returnValue=tb_i18n.get("leave.page.alert"),t.returnValue},e.prototype.bindRefreshAndCloseAlert=function(){return window.addEventListener("beforeunload",this.windowBeforeunload,!1)},e.prototype.unbindRefreshAndCloseAlert=function(){return window.removeEventListener("beforeunload",this.windowBeforeunload,!1)},e.prototype.onOpen=function(){return this.$titleInput.focusAtEnd(),this},e.prototype.onscroll=function(){var t;return null!=(t=this.postEditorView)&&"function"==typeof t.checkFixed?t.checkFixed():void 0},e.prototype.close=function(){var t,e;return this.$(".on-fixed").hide(),null!=(null!=(t=this.parentView)?t.close:void 0)?this.parentView.close():null!=(e=this.parentView)&&e.remove(),this},e.prototype.remove=function(){var t;return"function"==typeof(t=this.options).oncancel&&t.oncancel(),this.unbindRefreshAndCloseAlert(),e.__super__.remove.apply(this,arguments)},e}(b)},function(t,e,i){var n,r,o,s,a;a=i(678),o=i(696),r=i(1042),n=i(680),s=function(t,e){var i,r,o,s,a,c;return t?(s=e.get("_projectId"),c=t.split("/"),o=c.length,i=c[o-1].replace("?","&").split("&"),o=i.length,r=i[0],a=i[o-1].split("=")[1].replace('"',""),n.get("yiqixie/get/"+r,{},{dataType:"text"}).then(function(t){return t.replace(/^"|\\"|"$/g,"")}).then(function(t){var i,n;return n=$(".post-title-input").val().trim()||tb_i18n.get("wall.yiqixie.default.title"),i=e.toJSON(),new Promise(function(o,a){return e.save(null,{attrs:{_projectId:s,title:n,content:t,source:"yiqixie",_docId:r,involveMembers:i.involveMembers,visible:i.visible},success:function(){return o(e)},error:function(t,e){return a(e)}})})})):void Promise.reject()},t.exports={createYiqixie:function(t){var e,i,r,s;return r=o.getOne(0,t),e={name:r.get("name"),logo:r.get("logo"),_id:t},s={name:a.user.get("name"),avatarUrl:a.user.get("avatarUrl"),_id:a.user.get("_id"),email:a.user.get("email")},i={project:e,creator:s},n.post("yiqixie/create",i,{dataType:"text"})},saveYiqixieDocument:s,updateYiqixieDocument:function(t,e){return s(t,e).then(function(t){return t.get("content")})},get:function(t,e,i,r){var o,s;return null==r&&(r=a.user.id),s=e,"teambition"===i?Promise.reject():t?(o={_id:t,_projectId:e},"shimo"===i&&(o._creatorId=r),n.get(i+"/get",{data:o})):Promise.reject()}}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f=function(t,e){function i(){this.constructor=t}for(var n in e)g.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},g={}.hasOwnProperty;d=i(358),c=i(788),a=i(449),p=i(810),o=i(699),l=i(966),u=i(923),r=i(1046),n=$(window),m=i(1047),h={tabIndent:!1,toolbarFloat:!1,toolbar:["title","bold","italic","underline","strikethrough","color","|","ol","ul","blockquote","code","indent","outdent","alignment","|","link","upload","hr","table"]},t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.viewName="PostEditorView",e.prototype.className="post-editor",e.prototype.tagName="section",e.prototype.events={"click li.work":"clickToInsertImage"},e.prototype.initialize=function(t){return this.options=t,this._projectId=t._projectId,this.attachments=t.attachments||new p,this.renderBasic(),this.initSimditor(),this.renderAttachments(),this.listen()},e.prototype.listen=function(){return this.listenTo(this.attachments,"remove add",this.renderAttachments),this.listenTo(this.attachments,"change:completed",function(t){return function(e,i){if(i)return t.insertImage(e)}}(this)),this.editor.off(".post-editor"),this.editor.on("valuechanged.post-editor",function(t){return function(e){var i;return"function"==typeof(i=t.options).onchange&&i.onchange(t.get()),t.checkFixed()}}(this)),this.editor.on("uploadclick.post-editor",function(t){return function(e){return t.toggleWorksPicker(e)}}(this)),n.off("resize.post-editor"),n.on("resize.post-editor",function(t){return function(e){return t.calculateWith(e)}}(this))},e.prototype.renderBasic=function(){return this.$el.html(r({content:this.options.content})),this.$editorBarWrap=this.$(".editor-bar-wrap"),this.$textarea=this.$(".editor-input"),this.$attachmentsWrap=this.$(".editor-attachments")},e.prototype.initSimditor=function(){var t;return m.setup(),t=d.extend(h,this.options,{textarea:this.$textarea[0]}),this.editor=new a(t),this.editor.body.addClass("readable")},e.prototype.renderAttachments=function(){return this.$attachmentsWrap.empty(),this.attachments.each(function(t){return function(e){return t.addAttachment(e)}}(this))},e.prototype.addAttachment=function(t){var e;return e=this.$attachmentsWrap,this.requestSubView(l,{workModel:t}).$el.prependTo(e)},e.prototype.removeAttachment=function(t){var e,i;return i=this.$attachmentsWrap,e=i.find("li[data-cid="+t.cid+"]"),e.remove()},e.prototype.setProjectId=function(t){return this._projectId=t},e.prototype.toggleWorksPicker=function(t){var e;if(!this.worksPicker||this.worksPicker._projectId!==this._projectId)return null!=(e=this.worksPicker)&&e.remove(),this.worksPicker=this.requestSubView(u,{container:this.$el,_projectId:this._projectId,collection:this.attachments,$toggler:this.$(".toolbar-item-upload"),placement:"bottom"})},e.prototype.saveCaretPos=function(){return this.caretPos=this.$textareaset[0].selectionStart,this},e.prototype.clickToInsertImage=function(t){var e,i;return e=$(t.currentTarget),i=e.data("id")||e.data("cid"),this.insertImage(this.attachments.get(i)),this},e.prototype.insertImage=function(t,e){var i,n;if(n=this.getPreviewUrl(t))return i=this.editor.toolbar.findButton("upload"),i.insertImage(n,t.get("fileName")),this},e.prototype.refreshImage=function(t){var e,i,n;if(n=this.getPreviewUrl(t))return i=t.previous("thumbnailUrl"),n=this.getPreviewUrl(t),e=t.get("fileName"),i&&n?(this.$("img").each(function(){if(this.src===i)return $(this).attr({src:n,alt:e,title:e})}),this.set(this.editor.body.html())):void 0},e.prototype.getPreviewUrl=function(t){var e,i,n,r,o;if(t)return r=t.get("thumbnailUrl")||"",o=t.get("imageWidth"),e=t.get("imageHeight"),n=o<400?200:o<600?400:o<800?600:800,i=Math.ceil(n*e/o),r=r.replace("w/200/h/200","w/"+n+"/h/"+i)},e.prototype.checkFixed=function(){var t,e;return t=this.$(".simditor-toolbar"),e=t.parent()[0],e&&e.getBoundingClientRect().top<0?(t.addClass("on-fixed"),this.calculateWith()):t.removeClass("on-fixed").removeAttr("style")},e.prototype.calculateWith=function(){var t,e;if(t=this.$(".simditor-toolbar"),t.hasClass("on-fixed"))return e=this.$el.width(),t.width(e)},e.prototype.get=function(){return this.editor.getValue()},e.prototype.set=function(t){return this.editor.setValue(t),this},e.prototype.focus=function(){return this.editor.focus(),this},e.prototype.remove=function(){return n.off("resize.post-editor"),this.$el.off(),this.editor.destroy(),e.__super__.remove.apply(this,arguments)},e}(c)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<section class="editor-content-wrap"> <textarea class="editor-input" autofocus>'+e(t.content)+'</textarea></section><footer> <ul class="editor-attachments clearfix"></ul></footer>';return i}},function(t,e,i){var n;n=i(449),t.exports={setup:function(){return n.locale="simditor",n.i18n={simditor:{blockquote:tb_i18n.get("simditor.blockquote"),bold:tb_i18n.get("simditor.bold"),code:tb_i18n.get("simditor.code"),color:tb_i18n.get("simditor.color"),coloredText:tb_i18n.get("simditor.coloredText"),hr:tb_i18n.get("simditor.hr"),image:tb_i18n.get("simditor.image"),externalImage:tb_i18n.get("simditor.externalImage"),uploadImage:tb_i18n.get("simditor.uploadImage"),uploadFailed:tb_i18n.get("simditor.uploadFailed"),uploadError:tb_i18n.get("simditor.uploadError"),imageUrl:tb_i18n.get("simditor.imageUrl"),imageSize:tb_i18n.get("simditor.imageSize"),imageAlt:tb_i18n.get("simditor.imageAlt"),restoreImageSize:tb_i18n.get("simditor.restoreImageSize"),uploading:tb_i18n.get("simditor.uploading"),indent:tb_i18n.get("simditor.indent"),outdent:tb_i18n.get("simditor.outdent"),italic:tb_i18n.get("simditor.italic"),link:tb_i18n.get("simditor.link"),text:tb_i18n.get("simditor.text"),linkTextTitle:tb_i18n.get("simditor.add.link.title"),linkText:tb_i18n.get("simditor.linkText"),linkUrl:tb_i18n.get("simditor.linkUrl"),linkUrlSubmit:tb_i18n.get("confirm"),removeLink:tb_i18n.get("simditor.removeLink"),ol:tb_i18n.get("simditor.ol"),ul:tb_i18n.get("simditor.ul"),strikethrough:tb_i18n.get("simditor.strikethrough"),table:tb_i18n.get("simditor.table"),deleteRow:tb_i18n.get("simditor.deleteRow"),insertRowAbove:tb_i18n.get("simditor.insertRowAbove"),insertRowBelow:tb_i18n.get("simditor.insertRowBelow"),deleteColumn:tb_i18n.get("simditor.deleteColumn"),insertColumnLeft:tb_i18n.get("simditor.insertColumnLeft"),insertColumnRight:tb_i18n.get("simditor.insertColumnRight"),deleteTable:tb_i18n.get("simditor.deleteTable"),title:tb_i18n.get("simditor.title"),normalText:tb_i18n.get("simditor.normalText"),underline:tb_i18n.get("simditor.underline"),alignment:tb_i18n.get("simditor.alignment"),alignCenter:tb_i18n.get("simditor.alignCenter"),alignLeft:tb_i18n.get("simditor.alignLeft"),alignRight:tb_i18n.get("simditor.alignRight"),selectLanguage:tb_i18n.get("simditor.selectLanguage"),upload:tb_i18n.get("simditor.upload")}}}}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h=function(t,e){function i(){this.constructor=t}for(var n in e)m.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},m={}.hasOwnProperty;d=i(358),a=i(788),p=i(810),o=i(699),l=i(966),c=i(786),u=i(923),r=i(1049),n=i(1051),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.viewName="PostMdEditorView",e.prototype.className="post-md-editor",e.prototype.tagName="section",e.prototype.events={"input .editor-input":"handleTextInput","click .editor-input":"saveCaretPos","click .add-work-handler":"toggerWorksPicker","click li.work":"clickToInsertImage","click .md-help-handler":"openMdHelper"},e.prototype.initialize=function(t){return this.options=t,this._projectId=t._projectId,this.attachments=t.attachments||new p,this.renderBasic(),this.renderMD(),this.renderAttachments(),this.listen()},e.prototype.listen=function(){return this.listenTo(this.attachments,"remove add",this.renderAttachments),this.listenTo(this.attachments,"change:completed",function(t){return function(e,i){if(i)return t.insertImage(e)}}(this))},e.prototype.renderBasic=function(){return this.$el.html(n({content:this.options.content||""})),this.$editorBarWrap=this.$(".editor-bar-wrap"),this.$textareaset=this.$(".editor-input"),this.$mdWrap=this.$(".editor-md-wrap"),this.$attachmentsWrap=this.$(".editor-attachments"),this.$textareaset.flexText(function(t){return function(){return t.options.onchange(t.get())}}(this)),this.caretPos=this.get().length},e.prototype.renderMD=function(){return this.$mdWrap.html(window._encodeHTML(this.get(),"MD"))},e.prototype.renderAttachments=function(){var t;return t=this.$attachmentsWrap.empty(),this.attachments.each(function(e){return function(i){return e.requestSubView(l,{workModel:i}).$el.prependTo(t)}}(this))},e.prototype.setProjectId=function(t){return this._projectId=t},e.prototype.toggerWorksPicker=function(t){var e;if(e=$(t.currentTarget),!this.worksPicker||this._projectId!==this.worksPicker._projectId)return this.worksPicker=this.requestSubView(u,{container:this.$el,_projectId:this._projectId,collection:this.attachments,$toggler:e,placement:"auto top"}).show()},e.prototype.openMdHelper=function(){var t;return null!=(t=this.markdownHelperView)&&t.remove(),this.markdownHelperView=this.requestSubView(c).open(r),this},e.prototype.clickToInsertImage=function(t){var e,i;
return e=$(t.currentTarget),i=e.data("id")||e.data("cid"),this.insertImage(this.attachments.get(i)),this},e.prototype.insertImage=function(t){var e,i,n,r;if(r=this.getPreviewUrl(t))return n=t.get("fileName")||r,i=" !["+n+"]("+r+") ",e=this.get().replace(/\r/,""),e=e.slice(0,this.caretPos)+i+e.slice(this.caretPos),this.set(e),this.caretPos+=i.length,this.$textareaset[0].selectionStart=this.caretPos,this.$textareaset[0].selectionEnd=this.caretPos,this},e.prototype.saveCaretPos=function(t){return this.caretPos=this.$textareaset[0].selectionStart,this},e.prototype.handleTextInput=function(t){return this.saveCaretPos(t),this.renderMD(),this},e.prototype.getPreviewUrl=function(t){var e,i,n,r,o;if(t)return r=t.get("thumbnailUrl")||"",o=t.get("imageWidth"),e=t.get("imageHeight"),n=o<400?200:o<600?400:o<800?600:800,i=Math.ceil(n*e/o),r=r.replace("w/200/h/200","w/"+n+"/h/"+i)},e.prototype.get=function(){return this.$textareaset.val().trim()},e.prototype.set=function(t){return this.$textareaset.val(t),this},e.prototype.focus=function(){return d.delay(function(t){return function(){if(t.$el)return t.$textareaset.focusAtEnd()}}(this),100)},e}(a)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;n=i(1050),r=i(439),s=i(788),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="markdownHelperView",e.prototype.className="markdown-helper modal-dialog card",e.prototype.initialize=function(){return this.renderBasic(),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$markdown=this.$(".markdown-textarea").flexText(),this.$preview=this.$(".markdown-preview"),this.$markdown.on("input",function(t){return function(e){var i;return i=r(t.$markdown[0].value||""),t.$preview.html(i)}}(this)),this},e}(s)},function(t,e){t.exports=function(t){var e='<header class="card-header"> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> <p class="markdown-title card-title">'+tb_i18n.get("markdown.helper.title")+'</h4></header><div class="markdown-content"> <h4 class="title">'+tb_i18n.get("markdown.helper.syntax")+" <small>"+tb_i18n.get("markdown.helper.more.syntax")+'</small></h4> <div class="syntax-content clearfix"> <div class="span4"> <p><span class="syntax"># </span>'+tb_i18n.get("markdown.helper.H1")+'</p> <p><span class="syntax">## </span>'+tb_i18n.get("markdown.helper.H2")+'</p> <p><span class="syntax">### </span>'+tb_i18n.get("markdown.helper.H3")+'</p> <p><span class="syntax">#### </span>'+tb_i18n.get("markdown.helper.H4")+'</p> <p><span class="syntax">*</span>'+tb_i18n.get("markdown.helper.em")+'<span class="syntax">*</span></p> <p><span class="syntax">**</span>'+tb_i18n.get("markdown.helper.strong")+'<span class="syntax">**</span></p> </div> <div class="span4"> <p><span class="syntax">___</span>'+tb_i18n.get("markdown.helper.hr")+'</p> <p><span class="syntax">+ </span>'+tb_i18n.get("markdown.helper.ul1")+'</p> <p><span class="syntax">+ </span>'+tb_i18n.get("markdown.helper.ul2")+'</p> <p><span class="syntax">1. </span>'+tb_i18n.get("markdown.helper.ol1")+'</p> <p><span class="syntax">2. </span>'+tb_i18n.get("markdown.helper.ol2")+'</p> <p><span class="syntax">3. </span>'+tb_i18n.get("markdown.helper.ol3")+'</p> </div> <div class="span4"> <p><span class="syntax">&gt; </span>'+tb_i18n.get("markdown.helper.blockquote")+'</p> <p><span class="syntax">[</span>'+tb_i18n.get("markdown.helper.A")+'<span class="syntax">](</span>url.cn<span class="syntax">)</span></p> <p><span class="syntax">![</span>'+tb_i18n.get("markdown.helper.img")+'<span class="syntax">](</span>url.cn/img.png<span class="syntax">)</span></p> <p><span class="syntax">`</span>'+tb_i18n.get("markdown.helper.code")+'<span class="syntax">`</span></p> <p><span class="syntax">``` </span>'+tb_i18n.get("markdown.helper.pre")+'<span class="syntax"> ```</span></p> <p>'+tb_i18n.get("markdown.helper.indentation")+'<span class="syntax">'+tb_i18n.get("markdown.helper.blank.spaces")+"</span>"+tb_i18n.get("markdown.helper.pre")+'</p> </div> </div> <h4 class="title">'+tb_i18n.get("markdown.helper.preview")+" <small>"+tb_i18n.get("markdown.helper.try")+'</small></h4> <div class="preview-content clearfix"> <div class="span6"> <div class="markdown-try"> <textarea class="markdown-textarea" data-gta="event" data-label="try markdown" placeholder="'+tb_i18n.get("markdown.helper.placeholder")+'..."></textarea> </div> </div> <div class="span6"> <div class="markdown-preview"></div> </div> </div> </div></div>';return e}},function(t,e){t.exports=function(t){var e='<header> <div class="editor-bar-wrap"></div></header><section> <div class="editor-content clearfix"> <textarea class="editor-input" autofocus>'+t.content+'</textarea> <div class="editor-md-wrap"></div> </div></section><footer> <div class="post-editor-info"> <a class="add-work-handler pull-left" data-gta="event" data-label="activity add works"> <span class="icon icon-paperclip"></span>'+tb_i18n.get("activity.timeline.add.attachment")+' </a> <span class="post-creator-mdhelper muted pull-right"> '+tb_i18n.get("post.creator.markdown.tips")+' </span> </div> <ul class="editor-attachments clearfix"></ul></footer>';return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f=function(t,e){function i(){this.constructor=t}for(var n in e)g.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},g={}.hasOwnProperty;d=i(358),h=i(963),m=i(678),u=i(788),a=i(696),l=i(1053),s=i(1021),n=i(1055),r=i(1056),o=i(1057),p=i(1058),t.exports=c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.viewName="TagPickerView",e.prototype.className="tag-picker-view",e.prototype.events={"click .add-tag-handler":"openTagMenu","click .remove-tag-handler":"quickRemoveTag"},e.prototype.initialize=function(t){if((null!=t?t.objectModel:void 0)&&(null!=t?t._projectId:void 0))return this.options=t,this._projectId=t._projectId,this.projectModel=a.getOne(0,this._projectId),this.projectModel.getRoleScope()>=0||"all"===this.projectModel.get("visibility")?l.fetch(null!=t?t._projectId:void 0,{boundToObjectType:"project",success:function(e){return function(i){return e.objectModel=t.objectModel,e.tagsCollection=i,e.renderBasic().setTags().render().listen()}}(this)}):d.delay(function(t){return function(){return t.$el.parent().addClass("hide")}}(this)),this},e.prototype.listen=function(){return this.listenTo(this.objectModel,"change:tagIds",this.refresh),this.listenTo(this.tagsCollection,"change",this.render),this},e.prototype.setTags=function(){var t;return this.tags=(null!=(t=this.objectModel.get("tagIds"))?t.slice():void 0)||[],this},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$list=this.$(".tag-picker-list"),this},e.prototype.render=function(){var t,e,i,n,r,s,a;for(a=[],n=this.tags,e=0,i=n.length;e<i;e++)t=n[e],s=null!=(r=this.tagsCollection.get(t))?r.toJSON():void 0,(null!=s?s._id:void 0)&&!s.isArchived&&a.push(s);return this.$list.find(".tag-wrap").remove(),this.$list.prepend(p({tags:a,permissions:this.objectModel.hasPermissions("put")})),this.objectModel.hasPermission("put")||(this.$(".tag-picker-add").remove(),a.length||this.$list.html(o())),this},e.prototype.openTagMenu=function(){var t,e;return null!=(e=this.tagMenu)&&e.remove(),t=d.extend({},this.options,{fixed:this.$el.closest(".panel-view").length,$toggler:this.$(".add-tag-handler"),ListTemplate:r,multi:!0,selected:this.tags,addPlaceholder:tb_i18n.get("tag.picker.add"),select:function(t){return function(e){return t.setTag(e)}}(this),unselect:function(t){return function(e){return t.removeTag(e)}}(this),add:function(t){return function(e){return t.addTag(e)}}(this),onHidden:function(t){return function(){return t.saveTags()}}(this),dataList:this.tagsCollection.map(function(t){return{_id:t.get("_id"),title:t.get("name"),color:t.get("color")}})}),this.tagMenu=this.requestSubView(s,t).show(),this},e.prototype.hideTagMenu=function(){var t;return null!=(t=this.tagMenu)&&t.hide(),this},e.prototype.refresh=function(){return this.setTags().render(),this},e.prototype.addTag=function(t){return this.tagsCollection.create({name:t,_projectId:this._projectId,color:h.transformToServerColor()},{wait:!0,success:function(t){return function(e){if(t.tags=d.union(t.tags,[e.id]),t.tagMenu.update(t.tagsCollection.map(function(t){return{_id:t.get("_id"),title:t.get("name"),color:t.get("color")}}),t.tags.slice()),t.render(),t.fadeIn(e.id),!t.objectModel.id)return t.saveTags()}}(this)}),this},e.prototype.setTag=function(t){return this.tags=d.union(this.tags,[t]),this.render(),this.fadeIn(t),this.objectModel.id||this.saveTags(),this},e.prototype.removeTag=function(t){return this.tags=d.without(this.tags,t),this.fadeOut(t),this.objectModel.id||this.saveTags(),this},e.prototype.saveTags=function(){var t;if(this.objectModel&&(t=this.tags.slice(),!d.isEqual(t,this.objectModel.get("tagIds"))))return this.objectModel.set("tagIds",t),this.objectModel.id&&this.objectModel.saveAttr("tagIds",t),this},e.prototype.fadeIn=function(t){return this.$list.find(".tag-wrap[data-id="+t+"]").transition({opacity:0},0).transition({opacity:1}),this},e.prototype.fadeOut=function(t){return this.$list.find(".tag-wrap[data-id="+t+"]").transition({opacity:0},function(){return $(this).remove()}),this},e.prototype.quickRemoveTag=function(t){var e;return e=$(t.currentTarget).parent().data("id"),this.removeTag(e),d.delay(function(t){return function(){return t.saveTags()}}(this),100),this},e}(u)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(358),n=i(685),r=i(1054),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.name="tags",e.prototype.model=r,e.prototype.boundToObjectType="project",e.prototype.orderBy="latest-updated",e.prototype.getTagsbyIds=function(t){var e;return e=[],s.each(t,function(t){return function(i){var n,r;if(r=null!=(n=t.get(i))?n.toJSON():void 0)return e.push(r)}}(this)),e},e}(n)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(688),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.name="tag",e.prototype.urlRoot="tags",e.prototype._cache=(new Date).valueOf(),e.prototype.defaults={name:"",color:"blue",postsCount:0,tasksCount:0,eventsCount:0,worksCount:0,entriesCount:0},e.prototype.fetchRelation=function(t,e){return e||(e={}),e.url=this.url()+"/"+t,e.expireCache={namespace:"tag_"+t+"_"+this._cache,expire:10},this.sync("read",this,e),this},e.prototype.refreshCache=function(){return this._cache=(new Date).valueOf()},e}(n)},function(t,e){t.exports=function(t){var e='<div class="tag-picker-header"> <span>'+tb_i18n.get("tags")+'</span></div><ul class="tag-picker-list clearfix"> <li class="tag-picker-add child-tree"> <a class="add-tag-handler clearfix" data-gta="event" data-label="add tag"> <span class="icon icon-plus-sign hinted" data-title="'+tb_i18n.get("tag.picker.add")+'"></span> </a> </li></ul>';return e}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(963).calculateColor,o=t.dataList;if(o)for(var s,a=-1,c=o.length-1;a<c;)s=o[a+=1],n+='<li class="menu-item tag-item ',s.selected&&(n+="selected"),n+='" data-id="'+s._id+'"> <a class="tag"> <span class="tag-label" style="background-color: '+r(s.color,s.colorRGBA)+'"></span> <span class="tag-name">'+e(s.title)+"</span> </a></li>";return n}},function(t,e){t.exports=function(t){var e='<li class="tag-wrap"> <div class="tag-placeholder">'+tb_i18n.get("tag.picker.none")+"</div></li>";return e}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(963).calculateColor,o=t.tags;if(o)for(var s,a=-1,c=o.length-1;a<c;)s=o[a+=1],n+='<li class="tag-wrap ',t.permissions.put&&(n+="removeable"),n+='" data-id="'+s._id+'"> <span class="tag label"> <span class="tag-label" style="background-color: '+r(s.color,s.colorRGBA)+'"></span> <span class="tag-name">'+e(s.name)+"</span> </span> ",t.permissions.put&&(n+=' <a class="remove-tag-handler">&times;</a> '),n+="</li>";return n}},function(t,e){t.exports=function(t){var e="";return e+=t.isEdit?'<header class="post-creator-header is-edit"> <input class="form-control post-title-input" type="text" placeholder="'+tb_i18n.get("post.creator.title.placeholder")+'" maxlength="70" value="'+t.title+'"/> <a class="creator-close pull-right icon icon-remove" data-dismiss="modal"></a></header>':'<header class="creator-header"> <h4 class="creator-title"> <span class="creator-location-tips">'+tb_i18n.get("post.creator.tips_1")+'</span> <a class="creator-location-handler" data-gta="{action: \'move content\', type: \'post\', control: \'Global New Post\'}"> <span class="creator-location"></span> <span class="icon icon-chevron-down"></span> </a> <span class="creator-location-tips">'+tb_i18n.get("post.creator.tips_2")+'</span> </h4> <a class="creator-close pull-right icon icon-remove"></a></header><header class="post-creator-header"> <input class="form-control post-title-input" type="text" placeholder="'+tb_i18n.get("post.creator.title.placeholder")+'" maxlength="70" value="'+t.title+'"/></header>',e+='<section class="post-creator-body ',t.isEdit&&(e+="is-edit"),e+='"> ',t.isYiqixie?e+=' <section class="post-creator-editor-wrap"> <iframe src='+t.yiqixieUrl+' width="100%" height="100%" class="iframe-yiqixie"></iframe> </section> ':(e+=' <section class="post-creator-editor-wrap"></section> ',t.hasMemCache&&(e+=' <div class="draft">'+tb_i18n.get("draft")+' <a class="restore-draft">'+tb_i18n.get("draft.restore")+'</a> <a class="discard-draft">'+tb_i18n.get("draft.discard")+"</a> </div> "),e+=" "),e+=' <footer class="involve-set"></footer></section><footer class="post-creator-footer"> <div class="post-creator-footer-fixed"> <a class="creator-visible creator-visible-members hide" data-visible="members" data-gta="{action: \'toggle visibility\', type: \'post\', control: \'New Post\'}"> <span class="icon icon-unlock"></span>'+tb_i18n.get("visible.mode")+' <span class="mode-explanation">'+tb_i18n.get("visible.to.member")+'</span> </a> <a class="creator-visible creator-visible-involves hide" data-visible="involves" data-gta="{action: \'toggle visibility\', type: \'post\', control: \'New Post\'}"> <span class="icon icon-lock"></span>'+tb_i18n.get("visible.mode")+' <span class="mode-explanation">'+tb_i18n.get("visible.to.involve")+'</span> </a> <button class="btn btn-primary submit-handler pull-right"> ',e+=t.isEdit?""+tb_i18n.get("post.update"):""+tb_i18n.get("submit.post"),e+=" </button> </div></footer>"}},function(t,e){t.exports=function(t){var e='<a class="flex-static object-picker-creator link-add-handler"> <span class="icon icon-circle-cross"></span> <span>'+tb_i18n.get("object.picker.post.creator.tips")+'</span></a><ul class="flex-fill posts-list thin-scroll"></ul>';return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t.posts;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li class="post ',r.disabled&&(i+="disabled"),i+='" data-id="'+r._id+'"> <div class="post-content-wrapper"> <span class="post-title" >'+e(r.description)+"</span> </div></li>";return i}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g=function(t,e){return function(){return t.apply(e,arguments)}},v=function(t,e){function i(){this.constructor=t}for(var n in e)y.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},y={}.hasOwnProperty;m=i(358),f=i(678),p=i(677),u=i(788),s=i(401),r=i(928),l=i(696),h=i(810),d=i(1063),a=i(1066),n=i(1068),o=i(1069),t.exports=c=function(t){function e(){return this.getSelects=g(this.getSelects,this),e.__super__.constructor.apply(this,arguments)}return v(e,t),e.prototype.viewName="ObjectPickerFilesView",e.prototype.className="object-picker-files-view flex",e.prototype.events={"click .file-handler.collection":"handleCollectionClick","click .file-handler.work:not(.disabled)":"handleWorkClick","click .object-picker-uploader":"setParentId"},e.prototype.initialize=function(t){if(null!=t?t._projectId:void 0)return this._projectId=t._projectId,this.projectModel=l.getOne(0,this._projectId),this._defaultCollectionId=this.projectModel.get("_defaultCollectionId"),this._rootCollectionId=this.projectModel.get("_rootCollectionId"),this.columns=[],this.options=t,this.renderBasic().renderRoot(),this.listen(),this},e.prototype.listen=function(){return this.listenTo(this.projectModel,"change:applications",function(){if(this.projectModel.isAppChanged("works"))return this.renderColumns()})},e.prototype.listenToCollections=function(t){return this.stopListening(t),this.listenTo(t,"add change:color change:title",function(t){if(this.isCollectionDisplayed(t.get("_parentId")))return this.renderColumns()}),this.listenTo(t,"remove destroy",function(t){var e;if(e=t.get("_id"),this.isCollectionDisplayed(e))return this.columns=m.first(this.columns,this.getCollectionIndex(e)),this.renderColumns()}),this.listenTo(t,"change:_parentId",function(e,i){var n;return t.remove(e.get("_id")),null!=(n=r.find(i))?n.add(e):void 0})},e.prototype.listenToWorks=function(t){return this.stopListening(t),this.listenTo(t,"add",function(t){if(this.isCollectionDisplayed(t.get("_parentId")))return this.renderColumns()}),this.listenTo(t,"remove destroy",function(t){var e,i;if(e=t.get("_parentId"),this.isCollectionDisplayed(e))return i=this.getColumn(e).selected,this.resetSelects(e,i.filter(function(e){return e!==t.get("_id")})),this.renderColumns()}),this.listenTo(t,"change:_parentId",function(e,i){var n;return t.remove(e.get("_id")),null!=(n=h.find(i))?n.add(e):void 0})},e.prototype.initUploader=function(){var t;if(this.isShowUploader())return null!=(t=this.uploader)&&t.remove(),this.uploader=this.requestSubView(d,{projectModel:this.projectModel,_parentId:this._rootCollectionId,isBackground:!0,fileNumLimit:10,gta_from:"link panel",success:function(t){return function(e){var i;return i=e.map(function(t){return{_id:t._id,type:"work"}}),t.options.onCreate(i)}}(this)})},e.prototype.loadCollection=function(t,e){return new Promise(function(e){return function(i,n){return r.fetch(t,{attrs:{all:!0,_parentId:t,_projectId:e._projectId},success:function(t){return e.collectionCollection=t,e.listenToCollections(t),e.$el?i():n()},error:function(t,e){return n(e,null)}})}}(this)).then(function(e){return function(){return e.options.noWorks?Promise.resolve():new Promise(function(i,n){return h.fetch(t,{attrs:{all:!0,_parentId:t,_projectId:e._projectId},success:function(t){return e.listenToWorks(t),e.$el?i():n()},error:function(t,e){return n(e,null)}})})}}(this)).then(function(i){return function(){return i.columns.push({_parentId:t,selected:[],scrollTop:0}),e()}}(this))["catch"](function(t){if(t)return s.show({message:t.message||t,status:"error"})})},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$column=this.$(".files-column"),this},e.prototype.renderRoot=function(){return this.showLoadingIndicator(this.$column),this.loadCollection(this._rootCollectionId,function(t){return function(){return t.initUploader(),t.hideLoadingIndicator(),t.renderColumns(),t.renderGuide()}}(this)),this},e.prototype.renderColumns=function(){var t;return this.$column.children().each(function(t){return function(e,i){var n;return null!=(n=t.columns[e])?n.scrollTop=$(i).scrollTop():void 0}}(this)),this.$column.empty(),this.$frag=$(document.createDocumentFragment()),m.each(this.columns,function(t){return function(e){return t.renderColumn(e)}}(this)),this.$column.html(this.$frag).children().each(function(t){return function(e,i){return $(i).scrollTop(t.columns[e].scrollTop)}}(this)),this.addUploadButton(),t=this.selectedCollectionId?[{_id:this.selectedCollectionId,type:"collection"}]:this.getSelects().map(function(t){return{_id:t,type:"work"}}),this.options.onSelect(t)},e.prototype.renderColumn=function(t){var e,i,n,s,a;return e=t._parentId,a=t.selected,i=t.active,s=r.get(e).models.concat(h.get(e).models),n=m.extend(this.formContent(s),{_id:e,selected:a,active:i,isShowUploader:this.isShowUploader(),selectedCollectionId:this.selectedCollectionId}),this.$frag.append(o(n))},e.prototype.renderGuide=function(){if(this.collectionCollection.length)return this.requestSubView(a).$el.appendTo($(".object-picker-inner-view"))},e.prototype.formContent=function(t){var e,i;return i=[],e=[],m.each(t,function(t){return function(n){var r;if(r=("function"==typeof n.toJSON?n.toJSON():void 0)||n,r._id!==t._defaultCollectionId)return r.disabled=m.contains(t.options.exclude,r._id),"collection"===r.objectType?i.push(r):e.push(r)}}(this)),{folders:i,files:e}},e.prototype.handleCollectionClick=function(t){var e,i,n,r,o;return e=$(t.currentTarget),n=e.data("id"),r=this.$column.children().index(e.closest(".column")),i=this.columns[r]._parentId,o=function(t){return function(){return t.renderColumns(),t.$column.animate({scrollLeft:200*t.$column.children().length-t.$column.width()})}}(this),this.getColumn(i).active!==n?(this.getColumn(i).active=n,this.selectedCollectionId=n,this.clearSelectWorks(),this.columns=m.first(this.columns,this.getCollectionIndex(i)+1),this.loadCollection(n,o)):this.selectedCollectionId===n?this.selectedCollectionId=null:(this.selectedCollectionId=n,this.clearSelectWorks()),o()},e.prototype.handleWorkClick=function(t){var e,i,n,r,o,a;if(e=$(t.currentTarget),i=e.data("id"),o=this.$column.children().index(e.closest(".column")),n=this.columns[o]._parentId,a=this.getColumn(n).selected,r=m.contains(a,i))p.removeItem(a,i);else{if(this.getSelects().length>=10)return s.show({message:tb_i18n.get("object.picker.exceed.number"),status:"error"});this.selectedCollectionId=null,a.push(i)}return this.resetSelects(n,a),this.renderColumns()},e.prototype.getSelects=function(){return m.flatten(m.pluck(this.columns,"selected"))},e.prototype.resetSelects=function(t,e){return this.columns[this.getCollectionIndex(t)].selected=e},e.prototype.clearSelectWorks=function(){return m.each(this.columns,function(t){return t.selected=[]})},e.prototype.isShowUploader=function(){return this.projectModel.hasPermission("work.post")&&this.projectModel.isAppEnabled("works")},e.prototype.addUploadButton=function(){var t;return null!=(t=this.uploader)?t.uploader.addButton({id:this.$column.find(".column .object-picker-uploader"),multiple:!0}):void 0},e.prototype.setParentId=function(t){var e;return null!=(e=this.uploader)?e.options._parentId=$(t.target).closest(".column").data("id"):void 0},e.prototype.isCollectionDisplayed=function(t){return m.some(this.columns,function(e){return e._parentId===t})},e.prototype.getColumn=function(t){return m.find(this.columns,function(e){return e._parentId===t})},e.prototype.getCollectionIndex=function(t){return m.findIndex(this.columns,function(e){return e._parentId===t})},e}(u)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m=function(t,e){function i(){this.constructor=t}for(var n in e)f.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},f={}.hasOwnProperty;d=i(358),h=i(678),n=i(401),r=i(925),s=i(788),u=i(810),l=i(792),c=i(1064),a=i(786),o=i(926),t.exports=p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.viewName="WorkUploaderGlobalView",e.prototype.initialize=function(t){return this.options=t,this.reset()},e.prototype.reset=function(){var t;return this.worksCollection=new u,t=d.extend({auto:!1,accept:null,onCreate:function(t){return function(e){var i;return e.progress=0,e.completed=!1,i=new l(e),t.worksCollection.add(i),i}}(this),onQueued:function(t){return function(e){return t.showWorkCreator()}}(this),onProgress:function(t,e){return e.set("progress",t)},onComplete:function(t,e){return t.thumbnailUrl&&(t.thumbnail=t.thumbnailUrl),e.set(t),e.set("completed",!0)},onError:function(t){return function(e,i){return t.options.isBackground&&n.show({message:tb_i18n.get("works.background.uploader.error"),status:"error"}),t.collection.remove(i)}}(this),errorHandler:function(t){return function(e,i,n){var r;return r=t.options.projectModel||h.APP.getClosestProject(),r&&"F_EXCEED_SIZE"===i?t.requestSubView(a).open(o,{projectModel:r,fileName:n.name}):e()}}(this)},this.options),this.destroyUploader(this.uploader),this.uploader=new r(t)},e.prototype.showWorkCreator=function(){var t;return null!=(t=this.workCreatorView)&&t.remove(),this.workCreatorView=this.requestSubView(a).open(c,{_parentId:this.options._parentId,projectModel:this.options.projectModel,worksCollection:this.worksCollection,gta_from:this.options.gta_from,success:function(t){return function(e){return t.upload(e)}}(this)})},e.prototype.upload=function(t){var e;if(null!=t?t.length:void 0)return this.options.isBackground&&(h.APP.worksBgUploader.addWorks(t,this.options),h.APP.worksBgUploader.renderWorks(t)),this.uploader.upload(),this.reset(),"function"==typeof(e=this.options).onAfterUpload?e.onAfterUpload():void 0},e.prototype.destroyUploader=function(t){var e,i,n,r;if(t)return r=t.uploader,n=r.getStats(),(null!=(i=this.options)?i.isBackground:void 0)&&(n.progressNum||n.queueNum)?(e=d.find(r._widgets,function(t){return"dnd"===t.name}),null!=e&&"function"==typeof e.destroy&&e.destroy(),r.on("uploadFinished",function(){return t.destroy()})):t.destroy()},e.prototype.remove=function(){return this.destroyUploader(this.uploader),e.__super__.remove.apply(this,arguments)},e}(s)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},v={}.hasOwnProperty;f=i(678),p=i(788),l=i(677),d=i(792),r=i(793),m=i(810),a=i(699),c=i(696),s=i(1002),o=i(927),h=i(966),n=i(1065),t.exports=u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.viewName="WorkCreatorView",e.prototype.className="work-creator-view creator-view modal-dialog",e.prototype.events={"click .creator-location-handler":"toggleCollectionPicker","click .submit-handler":"submit"},e.prototype.initialize=function(t){var e,i;return null==t&&(t={}),this.options=t,t._projectId?this.projectModel=c.getOne(0,t._projectId):this.projectModel=f.APP.getClosestProject(),(null!=(e=this.projectModel)?e.isAppEnabled("works"):void 0)||(this.projectModel=c.get(0).find(function(t){return t.isAppEnabled("works")})),this.worksCollection=this.options.worksCollection,this.projectModel&&(null!=(i=this.worksCollection)?i.length:void 0)?this.load({success:function(t){return function(){if(t.$el)return t.reset(),t.renderBasic(),t.renderLoaction(),t.renderWroks(),t.renderInvolve()}}(this)}):this.close},e.prototype.load=function(t){return null==t&&(t={}),a.find(this.projectModel.id)?"function"==typeof t.success?t.success():void 0:a.fetch(this.projectModel.id,{success:function(e){return"function"==typeof t.success?t.success():void 0},error:function(t,e){return console.error(e),this.close()}})},e.prototype.reset=function(){var t;return this.membersCollection=a.find(this.projectModel.id),this._collectionId=(null!=(t=this.collectionModel)?t.id:void 0)||this.options._parentId||this.projectModel.get("_rootCollectionId"),this.worksCollection._boundToObjectId=this._collectionId,this.involveModel||(this.involveModel=new d({_projectId:this.projectModel.id,involveMembers:[f.user.id]})),this.listen()},e.prototype.listen=function(){return this.stopListening(),this.listenTo(this.worksCollection,"add remove",this.renderWroks)},e.prototype.renderBasic=function(){return this.$el.html(n({gta_from:this.options.gta_from})),this.$location=this.$(".creator-location"),this.$involveWrap=this.$(".creator-involve"),this.$worksWrap=this.$(".work-creator-works-wrap"),this.$creatorWrap=this.$(".work-creator-wrap"),this.$pickerWrap=this.$(".work-creator-picker-wrap"),this},e.prototype.renderLoaction=function(){var t,e,i,n;return i=this.projectModel.get("name"),this.$location.text(i),n=function(t){return function(e){if(e.length)return e.unshift(i),t.$location.text(e.join(tb_i18n.get("comma")))}}(this),e=[],t=function(i){return function(o){return o?r.fetch(o,{success:function(n){if(i.$el)return o=n.get("_parentId"),o&&e.unshift(n.get("title")),t(o)},error:function(){return n(e)}}):n(e)}}(this),t(this._collectionId),this},e.prototype.renderWroks=function(){var t;return this.worksCollection.length?(t=this.$worksWrap.empty(),this.worksCollection.each(function(e){return function(i){return e.requestSubView(h,{workModel:i}).$el.appendTo(t)}}(this))):this.close()},e.prototype.renderInvolve=function(){var t;return t=this.$involveWrap.empty(),this.requestSubView(s,{_projectId:this.projectModel.id,objectModel:this.involveModel,membersCollection:this.membersCollection,resident:[f.user.id],where:"creator"}).$el.appendTo(t),this},e.prototype.toggleCollectionPicker=function(){return this.isPicking?this.hideCollectionPicker():this.showCollectionPicker()},e.prototype.showCollectionPicker=function(){var t,e,i;return this.isPicking=!0,this.$el.addClass("on-picking"),i=(null!=(t=this.collectionModel)?t.get("title"):void 0)||this.projectModel.get("name"),null!=(e=this.picker)&&e.remove(),this.picker=this.requestSubView(o,{_projectId:this.projectModel.id,_parentId:this._collectionId,allProjects:!0,onlyCollections:!0,title:tb_i18n.get("work.creator.tips"),select:function(t){return function(e){return t.projectModel=c.getOne(0,e.get("_projectId")),t.collectionModel=e,a.fetch(t.projectModel.id,{success:function(){return t.reset(),t.renderLoaction(),t.renderInvolve()}})}}(this),onClosed:function(t){return function(){return t.hideCollectionPicker()}}(this)}).$el.removeClass("modal-dialog").appendTo(this.$pickerWrap.empty()),this.$pickerWrap.show(),this.$creatorWrap.hide()},e.prototype.hideCollectionPicker=function(){return this.isPicking=!1,this.$el.removeClass("on-picking"),this.$pickerWrap.hide(),this.$creatorWrap.show()},e.prototype.submit=function(){var t;return this.worksCollection.each(function(t){return function(e){return e.set("involveMembers",t.involveModel.get("involveMembers"))}}(this)),"function"==typeof(t=this.options).success&&t.success(this.worksCollection),this.close()},e.prototype.close=function(){var t,e;return(null!=(t=this.parentView)?t.close:void 0)?this.parentView.close():null!=(e=this.parentView)&&e.remove(),this},e}(p)},function(t,e){t.exports=function(t){var e='<header class="creator-header"> <h4 class="creator-title"> <span class="creator-location-tips">'+tb_i18n.get("work.creator.tips")+"</span> <a class=\"creator-location-handler\" data-gta=\"{action: 'move content', type: 'file', control: '"+t.gta_from+'\'}"> <span class="creator-location"></span> <span class="icon icon-chevron-down"></span> </a> </h4> <a class="creator-close pull-right icon icon-remove" data-dismiss="modal"></a></header><div class="work-creator-wrap"> <section class="creator-body"> <ul class="creator-block no-padding work-creator-works-wrap"></ul> <div class="creator-block creator-involve"></div> </section> <footer class="creator-footer clearfix"> <a class="creator-visible creator-visible-members hide" data-visible="involves"> <span class="icon icon-unlock"></span>'+tb_i18n.get("visible.mode")+' <span class="mode-explanation">'+tb_i18n.get("visible.to.member")+'</span> </a> <a class="creator-visible creator-visible-involves hide" data-visible="members"> <span class="icon icon-lock"></span>'+tb_i18n.get("visible.mode")+' <span class="mode-explanation">'+tb_i18n.get("visible.to.involve")+"</span> </a> <div class=\"btn-wrap submiting\"> <button class=\"btn btn-primary submit-handler\" data-gta=\"{action: 'added content', type: 'file', control: '"+t.gta_from+"'}\"> "+tb_i18n.get("upload")+' </button> <div class="btn-layer"></div> </div> </footer></div><div class="work-creator-picker-wrap"></div>';
return e}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;a=i(358),s=i(788),c=i(678),n=i(1067),o="linkCollectionGuide",t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="FeatureGuideView",e.prototype.className="feature-guide-view fade",e.prototype.events={"click .guide-done":"updateGuideDone"},e.prototype.initialize=function(){var t;if(t=c.PREFERENCE.get("tips"),!t[o])return this.$el.html(n()),a.delay(function(t){return function(){return t.$el.addClass("in")}}(this),500),this},e.prototype.updateGuideDone=function(){return c.PREFERENCE.updateFeatureGuide(o),this.remove()},e}(s)},function(t,e){t.exports=function(t){var e='<div class="feature-guide guide-link-folder"> <p class="guide-content"> '+tb_i18n.get("guide.feature.link.folder.content")+' </p> <a class="btn btn-primary guide-done"> '+tb_i18n.get("guide.feature.link.folder.done")+" </a></div>";return e}},function(t,e){t.exports=function(t){var e='<ul class="flex-horiz files-column horizontal-scroll"></ul>';return e}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(932),o=r.fileIconT,s=r.folderIconT;n+='<li class="column thin-scroll flex-static flex-vert" data-id="'+t._id+'"> ',t.isShowUploader&&(n+=' <a class="object-picker-creator object-picker-uploader link-add-handler flex-static"> <span class="icon icon-circle-cross"></span> '+tb_i18n.get("object.picker.file.uploader.tips")+" </a> "),n+=' <ul class="flex-fill column-wrap"> ',t.folders.length&&(n+=' <li class="group-name"> <p>'+tb_i18n.get("collection")+"</p> </li> "),n+=" ";var a=t.folders;if(a)for(var c,l=-1,p=a.length-1;l<p;)c=a[l+=1],n+=' <li class="file-handler clearfix collection hinted ',c.disabled?n+=" disabled ":c._id===t.active&&(n+=" active "),n+=" ",t.selectedCollectionId===c._id&&(n+=" selected"),n+='" data-title="'+c.title+'" data-id="'+c._id+'"> '+s(c)+' <span class="collection-title">'+e(c.title)+"</span> </li> ";n+=" ",t.files.length&&(n+=' <li class="group-name"> <p>'+tb_i18n.get("file")+"</p> </li> "),n+=" ";var u=t.files;if(u)for(var c,d=-1,h=u.length-1;d<h;)c=u[d+=1],n+=' <li class="file-handler clearfix work hinted ',c.disabled&&(n+="disabled"),n+=" ",t.selected.indexOf(c._id)>=0&&(n+="selected"),n+='" data-title="'+c.fileName+'" data-id="'+c._id+'"> '+o(c)+' <span class="work-title">'+e(c.fileName)+"</span> </li> ";return n+=" </ul></li>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b=function(t,e){function i(){this.constructor=t}for(var n in e)k.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},k={}.hasOwnProperty,w=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};f=i(358),c=i(429),u=i(797),d=i(677),h=i(788),m=i(786),r=i(401),y=i(804),p=i(697),o=i(1071),a=i(1079),n=i(1080),s=i(1081),g=function(t,e){var i,n;return n=d.formatDate(t).dateString,e=c(e).subtract(1,"day"),i=d.formatDate(e).dateString,n===i?{startDateString:n}:{startDateString:n,endDateString:i}},v=function(t,e){var i,n,r,o,s;return r="HH:mm",s=d.formatDate(new Date(t)).dateString,n=d.formatDate(new Date(e)).dateString,o=s+" "+c(t).format(r),i=n+" "+c(e).format(r),{startDateString:o,endDateString:i}},l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.viewName="ObjectPickerEventsView",e.prototype.className="object-picker-events-view thin-scroll",e.prototype.events={"click .event":"toggleEvent","click .object-picker-creator":"creatorHandler"},e.prototype.initialize=function(t){if(t._projectId)return this.options=t,this._projectId=t._projectId,this.projectModel=p.get(this._projectId),this.selected=[],this.renderBasic(),this.listen(),this.showLoadingIndicator(this.$list),new Promise(function(t){return function(e,i){return a.fetch(t._projectId,{success:e,error:i})}}(this)).then(function(t){return function(e){if(t.$el)return t.hideLoadingIndicator({animated:!1}),t.eventsCollection=e,t.renderEvents(t.eventsCollection.models),t.setupScroll(t.$list)}}(this))["catch"](function(t){return r.error(String(t))}),this},e.prototype.loadMore=function(t){var e,i;return i=e=0,this.eventsCollection.loadMore({silent:!0,beforeSend:function(t){return function(){return i=(new Date).getTime(),t.showLoadingIndicator(t.$list)}}(this),success:function(n){return function(r,o,s){var a,c;if(n.$el)return e=(new Date).getTime(),c=e-i,a=c<1e3?1e3-c:0,f.delay(function(){if(n.$el)return n.hideLoadingIndicator({animated:!0}),n.renderEvents(o.map(function(t){return n.eventsCollection.get(t._id)})),n.eventsCollection.hasMore?"function"==typeof t?t():void 0:n.showEndPoint(n.$list)},a)}}(this)}),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this.toggleEventCreator(),this.$list=this.$(".events-list"),this},e.prototype.listen=function(){return this.listenTo(this.projectModel,"change:applications",function(){if(this.projectModel.isNavAppChanged())return this.toggleEventCreator()}),this},e.prototype.toggleEventCreator=function(){var t,e;return t=(null!=(e=this.projectModel)?e.isAppEnabled("events"):void 0)?"removeClass":"addClass",this.$el[t]("no-creator"),this},e.prototype.renderEvents=function(t){var e,i,n;return i=(new Date).toDateString(),n=f.chain(t).map(function(t){var e;return e=y.fakeByModel(t,i,i,!0),e.forEach(function(e){return e.isAllDay=t.checkAllDay()}),e}).flatten().value(),e=$(s({events:f.map(n,function(t){return function(e){var i,n;return e.disabled=(n=e._id,w.call(t.options.exclude,n)>=0),i=e.isAllDay?g(e.startDate,e.endDate):v(e.startDate,e.endDate),f.extend(e,i)}}(this))})),this.$list.append(e),this},e.prototype.creatorHandler=function(){return this.requestSubView(m).open(o,{_projectId:this._projectId,success:function(t){return function(e){return t.options.onCreate([e.toJSON()])}}(this)})},e.prototype.toggleEvent=function(t){var e,i;if(e=$(t.currentTarget),!e.hasClass("disabled"))return!e.hasClass("selected")&&this.selected.length>=10?r.show({message:tb_i18n.get("object.picker.exceed.number"),status:"error"}):(e.toggleClass("selected"),i=e.data("id"),e.hasClass("selected")?this.selected.push(i):d.removeItem(this.selected,i),this.options.onSelect(this.selected.map(function(t){return{_id:t,type:"event"}})),this)},e}(h),f.extend(l.prototype,u),t.exports=l},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T=function(t,e){function i(){this.constructor=t}for(var n in e)M.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},M={}.hasOwnProperty;_=i(358),j=i(678),p=i(429),f=i(447),b=i(681),k=i(677),y=i(804),w=i(788),o=i(817),l=i(699),m=i(696),h=i(1072),c=i(1002),s=i(1074),u=i(1021),d=i(1027),n=i(1075),a=i(1076),g=i(1077),v=i(1078),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return T(e,t),e.prototype.viewName="EventCreatorView",e.prototype.className="event-creator-view creator-view modal-dialog",e.prototype.saveAttrs=["_projectId","_creatorId","title","location","startDate","endDate","involveMembers","visible","recurrence","reminders"],e.prototype.events={"click .creator-location-handler":"showLocationSelector","change .event-title-input":"cacheEvent","keydown .event-title-input":"quickSubmit","change .event-location-input":"cacheEvent","click .event-creator-allday-handler":"switchAllDay","click .event-creator-datepicker":"showDatePicker","click .event-creator-timepicker":"showTimePicker","click .event-creator-repeat":"showRepeatSelector","click .event-creator-remind":"showRemindSelector","click .creator-visible":"switchVisible","click .submit-handler":"submit","click .save-handler":"saveEvent"},e.prototype.initialize=function(t){var e;return null==t&&(t={}),this.options=t,this.isEdit=!!t.eventModel,this.projectsCollection=m.get(0),t._projectId?this.projectModel=m.findOne(0,t._projectId):this.projectModel=j.APP.getClosestProject(),(null!=(e=this.projectModel)?e.isAppEnabled("events"):void 0)||(this.projectModel=m.get(0).find(function(t){return t.isAppEnabled("events")})),this.projectModel?(this.localCache=b.namespace("temp").namespace("event_creator"),this.isEdit||(this.localCacheId="event_creator_"+this.projectModel.id+"_"+j.user.id),this.load().then(function(t){return function(){return t.reset(),t.renderBasic(),t.renderLoaction(),t.renderContent(),t.renderHander(),t.renderRepeat(),t.renderRemind(),t.renderInvolve(),t.renderVisible()}}(this))["catch"](function(t){return console.error(t),this.close()})):this.close},e.prototype.load=function(){var t;return t=l.find(this.projectModel.id),t?Promise.resolve():new Promise(function(t){return function(e,i){return l.fetch(t.projectModel.id,{boundToObjectType:"project",success:e,error:i})}}(this))},e.prototype.reset=function(){var t,e,i,n,r,s;return this.stopListening(),this.membersCollection=l.find(this.projectModel.id),this.isEdit?(this.eventModel=this.options.eventModel.clone(),n=this.eventModel.checkAllDay(),n&&(this.eventModel.set("isAllDay",n),t=p(this.eventModel.get("endDate")),this.eventModel.set("endDate",t.subtract(1,"day").toISOString()))):(e=_.extend({_creatorId:j.user.id,involveMembers:[j.user.id],title:"",location:"",visible:"members",allData:!1,recurrence:null,reminders:[],startDate:null,endDate:null},this.localCache(this.localCacheId),{_projectId:this.projectModel.get("_id"),startDate:this.options.startDate,endDate:this.options.endDate,isAllDay:this.options.isAllDay}),e.involveMembers=_.filter(e.involveMembers,function(t){return function(e){return!!t.membersCollection.get(e)}}(this)),e.startDate||(r=new Date,i=new Date(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours()),e.startDate=i.toISOString()),e.endDate||(s=p(e.startDate),e.endDate=s.add(1,"hour").toISOString()),this.eventModel=new o(e)),this.eventModel.isRecurrenceEventInstance()&&(this.rruleSet=this.eventModel.getRRuleSet()),this.rruleSet||(this.rruleSet=new f.RRuleSet,this.rruleSet.rrule(new f({freq:f.WEEKLY,dtstart:new Date(this.eventModel.get("startDate"))}))),this.setTime(),this.listen(),this},e.prototype.listen=function(){return this.listenTo(this.eventModel,"change",this.cacheEvent),this.listenTo(this.eventModel,"change:visible",this.renderVisible),this.listenTo(this.eventModel,"change:startDate change:endDate change:isAllDay",this.renderHander),this.listenTo(this.eventModel,"change:recurrence",this.renderRepeat),this.listenTo(this.eventModel,"change:reminders",this.renderRemind),this},e.prototype.renderBasic=function(){var t;return this.$el.html(n({isEdit:this.isEdit,hasOldRecurrence:null!=(t=this.options.eventModel)?t.isRecurrenceEventInstance():void 0})),this.$location=this.$(".creator-location"),this.$handerWrap=this.$(".date-time-wrap"),this.$repeatWrap=this.$(".repeat-wrap"),this.$remindWrap=this.$(".remind-wrap"),this.$involveWrap=this.$(".creator-involve"),this.$titleInput=this.$(".event-title-input"),this.$locationInput=this.$(".event-location-input"),this.$visibleMembers=this.$(".creator-visible-members"),this.$visibleInvolves=this.$(".creator-visible-involves"),this.$titleInput.flexText(),this.$locationInput.flexText(),this},e.prototype.renderLoaction=function(){var t;return t=this.projectModel.toJSON(),this.$location.text(t.name),this},e.prototype.renderContent=function(){var t;return t=this.eventModel.toJSON(),this.$titleInput.val(_.unescape(t.title)||"").trigger("change"),this.$locationInput.val(_.unescape(t.location)||"").trigger("change"),this},e.prototype.renderHander=function(){var t,e,i;return t=this.eventModel.toJSON(),i=p(t.startDate),e=p(t.endDate),t=_.extend(t,{scope:this.eventModel.getScope(),startDateString:k.formatDate(i).dateString,startTimeString:t.isAllDay?"":p(i).format("LT"),endDateString:k.formatDate(e).dateString,endTimeString:t.isAllDay?"":p(e).format("LT")}),this.$handerWrap.html(a(t)),this},e.prototype.renderRepeat=function(){var t,e;return e=this.eventModel.isRecurrenceEventInstance()?y.freq2Label(this.rruleSet):"NO",t={repeatTitle:"CUSTOM"===e?y.freq2Description(this.rruleSet):y.label2Title(e)},this.$repeatWrap.html(v(t)),this},e.prototype.renderRemind=function(){var t,e,i,n;switch(e=this.eventModel.get("reminders").length?this.eventModel.get("reminders")[0]:{minutes:-1},e.minutes){case-1:i=tb_i18n.get("remind.close");break;case 0:i=tb_i18n.get("remind.happened");break;default:n=p.duration(e.minutes,"minutes").humanize(),i=tb_i18n.get("remind.ago",n)}return t={remindTitle:i},this.$remindWrap.html(g(t)),this},e.prototype.renderInvolve=function(){var t;return t=this.$involveWrap.empty(),this.requestSubView(c,{_projectId:this.projectModel.get("_id"),objectModel:this.eventModel,membersCollection:this.membersCollection,resident:[j.user.id],where:"creator"}).$el.appendTo(t),this},e.prototype.renderVisible=function(){var t;return t=this.eventModel.get("visible"),"involves"===t?(this.$visibleMembers.addClass("hide"),this.$visibleInvolves.removeClass("hide")):(this.$visibleMembers.removeClass("hide"),this.$visibleInvolves.addClass("hide")),this},e.prototype.showLocationSelector=function(t){var e,i;return e=$(t.currentTarget),e.data("bs.popover")||this.projectsSelectView||(this.projectsSelectView=this.requestSubView(u,{container:this.$el,$toggler:e,searchPlaceholder:tb_i18n.get("task.menu.search.project"),dataList:this.projectsCollection.filter(function(t){return t.getRoleScope()>=0&&t.isAppEnabled("events")}).map(function(t){return{_id:t.get("_id"),title:t.get("name"),pinyin:t.get("pinyin")}}),selected:(null!=(i=this.projectModel)?i.id:void 0)||"",select:function(t){return function(e){var i;if(e!==(null!=(i=t.projectModel)?i.id:void 0))return t.projectModel=t.projectsCollection.get(e),l.fetch(t.projectModel.get("_id"),{success:function(e){if(t.$el)return t.reset(),t.cacheEvent(),t.renderHander(),t.renderLoaction(),t.renderInvolve()}})}}(this)}).show()),this},e.prototype.showDatePicker=function(t){var e,i,n,r,o;return e=$(t.currentTarget),n=e.data("key"),e.data("datepicker")?(o=!e.data("showDatepicker"),e.data("showDatepicker",o),e.data("datepicker").picker.toggle(o)):(i=new Date(this.eventModel.get(n)),e.datepicker({language:tb_i18n.getLanguage(),todayHighlight:!0,placement:"left",startDate:"endDate"===n&&(r=this.eventModel.get("startDate"))?new Date(r):null}).datepicker("update",new Date(i.getFullYear(),i.getMonth(),i.getDate())).datepicker("show").focus().on("changeDate",function(t){return function(r){var o;if(t.$el)return e.datepicker("hide"),o=r.date,o?(o.setHours(i.getHours()),o.setMinutes(i.getMinutes()),t.setTime(n,o)):void 0}}(this)).on("hide",function(t){return e.data("showDatepicker",!1)}),e.data("showDatepicker",!0)),this},e.prototype.showTimePicker=function(t){var e,i,n;if(e=$(t.currentTarget),!e.data("EventTimepickerView"))return e.data("EventTimepickerView",!0),n=e.data("key"),i=new Date(this.eventModel.get(n)),this.requestSubView(s,{addPlaceholder:tb_i18n.get("event.time.picker.placeholder"),$toggler:e,currentDate:this.eventModel.get(n),startDate:"endDate"===n?this.eventModel.get("startDate"):null,select:function(t){return function(e){if(t.$el)return i.setHours(e.hours),i.setMinutes(e.minutes),t.setTime(n,i)}}(this)}).show(),this},e.prototype.showRepeatSelector=function(t){var e,i,n;return e=$(t.currentTarget),i="showRepeatSelector",e.data(i)?this:(e.data(i,!0),null!=(n=this.repeatSelectorView)&&n.remove(),this.repeatSelectorView=this.requestSubView(d,{$toggler:e,recurrence:this.eventModel.get("recurrence"),startDate:this.eventModel.get("startDate"),select:function(t){return function(e){return t.rruleSet=y.getRRuleSet(e),t.eventModel.set("recurrence",e)}}(this)}).show(),this)},e.prototype.showRemindSelector=function(t){var e,i,n,r,o,s,a,c,l,u,d;if(e=$(t.currentTarget),o="showRemindSelector",e.data(o))return this;for(e.data(o,!0),n=this.eventModel.get("reminders").length?this.eventModel.get("reminders")[0]:{method:"popup",minutes:-1},i=[],c=[-1,0,5,15,30,60,120,1440],r=0,s=c.length;r<s;r++){switch(a=c[r]){case-1:d=tb_i18n.get("remind.close");break;case 0:d=tb_i18n.get("remind.happened");break;default:u=p.duration(a,"minutes").humanize(),d=tb_i18n.get("remind.ago",u)}i.push({_id:a,title:d})}return null!=(l=this.remindSelectorView)&&l.remove(),this.remindSelectorView=this.requestSubView(h,{$toggler:e,width:170,dataList:i,selected:n.minutes,select:function(t){return function(e){var i;return e===-1?i=[]:(i=_.clone(n),i.minutes=e,i=[i]),t.eventModel.set("reminders",i)}}(this)}).show(),this},e.prototype.switchVisible=function(t){var e;return e=this.eventModel.get("visible"),this.eventModel.set("visible","involves"===e?"members":"involves"),this},e.prototype.switchAllDay=function(t){var e;return e=this.eventModel.get("isAllDay"),this.eventModel.set("isAllDay",!e),this},e.prototype.quickSubmit=function(t){return 13===t.keyCode&&(t.preventDefault(),this.submit(t)),this},e.prototype.submit=function(t){var e;return this.$el.hasClass("submiting")?this:this.$titleInput.val().trim()?(e=$(null!=t?t.currentTarget:void 0).data("type"),this.disableSubmit(t),"single"===e?this.updateRecurrenceInSingleMode():"after"===e?this.updateRecurrenceInAfterMode():this.isEdit?this.updateEvent():this.createEvent(),this):this.$titleInput.focusAtEnd()},e.prototype.createEvent=function(t){var e,i,n;return t||(t=this.getSaveAttrs()),e=this.options.eventsCollection||(null!=(n=this.options.eventModel)?n.collection:void 0),i=new o,i.save(null,{attrs:t,wait:!0,success:function(t){return function(i){var n,r;return r=new o(i.toJSON()),null!=e&&e.add(r),t.enableSubmit(),t.clearCache(),"function"==typeof(n=t.options).success&&n.success(r),t.options.isEssage!==!1&&k.message({tips:tb_i18n.get("create.event.success"),url:"/project/"+r.get("_projectId")+"/events/event/"+r.id,title:r.get("title")}),t.close()}}(this),error:function(t){return function(){return t.enableSubmit()}}(this)}),this},e.prototype.updateEvent=function(){var t,e;return t=this.getSaveAttrs(),(null!=(e=t.recurrence)?e.length:void 0)||delete t.recurrence,this.options.eventModel.save(null,{wait:!0,attrs:t,success:function(t){return function(e){return t.enableSubmit(),t.close()}}(this),error:function(t){return function(e,i){return t.enableSubmit()}}(this)}),this},e.prototype.updateRecurrenceInSingleMode=function(){var t,e,i,n,r,s;return n=this.getSaveAttrs(),e=this.options.eventModel,t=e.collection,i=new Date(e.get("startDate")),s=e.getRRuleSet(),delete n.recurrence,null!=(r=e.eventDetailView)&&r.resetView(),s.exdate(i),e.save(null,{wait:!0,attrs:{recurrence:s.valueOf()},success:function(t){return function(){return t.close(),(new o).save(null,{attrs:n,wait:!0,success:function(t,i){var n;return e.reset(i,{silent:!0}),null!=(n=e.eventDetailView)?n.refreshView():void 0}})}}(this),error:function(t){return function(e,i){return t.enableSubmit()}}(this)})},e.prototype.updateRecurrenceInAfterMode=function(){var t,e,i,n,r,s;return i=this.getSaveAttrs(),e=this.options.eventModel,t=e.collection,r=e.getRRuleSet(),r&&(s=r.before(new Date(e.get("startDate")),!1)),s?(null!=(n=e.eventDetailView)&&n.resetView(),y.updateRRuleSet(r,{until:s}),e.save(null,{attrs:{recurrence:r.valueOf()},success:function(n){return function(){var s;return n.close(),i.recurrence&&(r=i.recurrence.join("\n").replace(/EXDATE[^\s]*\s?/g,"").trim(),s=f.parseString(r.slice(6)),s.dtstart=new Date(i.startDate),i.recurrence=["RRULE:"+f.optionsToString(s)]),(new o).save(null,{attrs:i,success:function(i,n){var r;return null!=t&&t.add(i),e.reset(n,{silent:!0}),null!=(r=e.eventDetailView)?r.refreshView():void 0}})}}(this),error:function(t){return function(e,i){return t.enableSubmit()}}(this)})):e.save(null,{attrs:i,success:function(t){return function(e){return t.close()}}(this),error:function(t){return function(e,i){return t.enableSubmit()}}(this)})},e.prototype.disableSubmit=function(t){var e;if(this.$el)return e=$(null!=t?t.currentTarget:void 0),this.$el.addClass("submiting"),e.closest(".btn-wrap").addClass("submiting"),this},e.prototype.enableSubmit=function(t){if(this.$el)return this.$el.removeClass("submiting"),this.$el.find(".btn-wrap.submiting").removeClass("submiting")},e.prototype.onOpen=function(){var t;return null!=(t=this.$titleInput)&&t.focusAtEnd(),this},e.prototype.setTime=function(t,e){var i,n,r;return r=p(this.eventModel.get("startDate")),n=p(this.eventModel.get("endDate")),i=n-r,"startDate"===t?(r=p(e),n=p(i+r)):"endDate"===t&&(n=p(e)),n.isAfter(r)||(n=p(r).add(1,"hour")),this.eventModel.set({startDate:r.toISOString(),endDate:n.toISOString()}),this},e.prototype.getSaveAttrs=function(){var t,e,i;return e=_.extend(this.eventModel.toJSON(),{title:this.$titleInput.val().trim(),location:this.$locationInput.val().trim()}),this.eventModel.get("isAllDay")&&(i=p(e.startDate),t=p(e.endDate).add(1,"day"),e.startDate=i.startOf("day").toISOString(),e.endDate=t.startOf("day").toISOString()),this.eventModel.isRecurrenceEventInstance()?(y.updateRRuleSet(this.rruleSet,{dtstart:new Date(e.startDate)}),e.recurrence=this.rruleSet.valueOf()):e.recurrence=null,_.pick(e,this.saveAttrs)},e.prototype.cacheEvent=function(){var t;return this.localCacheId&&(t=_.extend(this.eventModel.toJSON(),{title:this.$titleInput.val().trim(),location:this.$locationInput.val().trim()}),this.localCache(this.localCacheId,t)),this},e.prototype.clearCache=function(){return this.localCacheId&&this.localCache(this.localCacheId,null),this},e.prototype.close=function(){var t,e;return(null!=(t=this.parentView)?t.close:void 0)?this.parentView.close():null!=(e=this.parentView)&&e.remove(),this},e.prototype.remove=function(){return this.$(".event-creator-datepicker").each(function(t,e){var i;return null!=(i=$(e).data("datepicker"))?i.picker.remove():void 0}),e.__super__.remove.apply(this,arguments)},e}(w)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(358),o=i(813),n=i(1073),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="PopoverSinglePickerView",e.prototype.className="popover-single-picker-view",e.prototype.popoverTitle="Menu",e.prototype.width=170,e.prototype.events={"click .single-picker-item":"selectItem"},e.prototype.initialize=function(t){return s.has(t,"dataList","select")?(this.dataList=t.dataList,this.selected=t.selected,e.__super__.initialize.apply(this,arguments),this):void console.error("dataList and select is required!")},e.prototype.render=function(){return this.$el.html(n({dataList:this.dataList,selected:this.selected})),this},e.prototype.selectItem=function(t){var e;return e=$(t.currentTarget),this.selected=e.data("id"),e.addClass("selected").siblings().removeClass("selected"),this.options.select(this.selected),this.hide(),this},e}(o)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<ul class="list-unstyled"> ',n=t.dataList;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li class="single-picker-item ',t.selected===r._id&&(i+="selected"),i+='" data-id="'+r._id+'"> <a>'+e(r.title)+"</a> </li> ";return i+="</ul>"}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(788),o=i(429),s=i(1021),a=i(677),n=i(401),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.initialize=function(t){var e;if(null==t&&(t={}),t.$toggler)return this.options=t,this.$toggler=this.options.$toggler,this.startDate=this.options.startDate?new Date(this.options.startDate):null,this.startDate&&this.startDate.setMilliseconds(0),this.endDate=this.options.endDate?new Date(this.options.endDate):null,this.endDate&&this.endDate.setMilliseconds(0),this.options.currentDate?(this.currentDate=new Date(this.options.currentDate),this.currentDate.setMilliseconds(0),this.selected=60*this.currentDate.getHours()+this.currentDate.getMinutes()):(e=new Date,this.currentDate=new Date(e.getFullYear(),e.getMonth(),e.getDate())),this.adjust=this.options.addPlaceholder?-20:0,this.hourStep=this.options.hourStep||1,this.minuteStep=this.options.minuteStep||15,this.render()},e.prototype.render=function(){return this.popoverMenuView=this.requestSubView(s,{addPlaceholder:this.options.addPlaceholder,$toggler:this.$toggler,width:170,dataList:this.getDataList(),selected:this.selected,select:this.selectTime.bind(this),add:this.addTime.bind(this),onShown:function(t){return function(){return t.popoverMenuView.scrollToSelected(!1,t.adjust)}}(this)}),this},e.prototype.getDataList=function(){var t,e,i,n,r,s,a,c,l,p;for(e=[],p=this.startDate?o(this.startDate):null,i=this.endDate?o(this.endDate):null,t=o(this.currentDate),n=s=0,c=this.hourStep;s<=23;n=s+=c)for(r=a=0,l=this.minuteStep;a<=59;r=a+=l)t.set("hours",n),t.set("minutes",r),p&&!t.isAfter(p)||i&&!t.isBefore(i)||e.push({_id:60*n+r,title:o(t).format("LT")});return e},e.prototype.addTime=function(t){var e,i,r,o;return o=/^(([01]?[0-9])|(2[0-3])):[0-5]?[0-9]$/,o.test(t)?(this.popoverMenuView.hide(),i=t.split(":")[0],r=t.split(":")[1],this.currentDate.setHours(i),this.currentDate.setMinutes(r),"function"==typeof(e=this.options).select?e.select({hours:this.currentDate.getHours(),minutes:this.currentDate.getMinutes()}):void 0):(n.show({message:tb_i18n.get("event.creator.end.time.error"),status:"error"}),this.popoverMenuView.render(),this.popoverMenuView.scrollToSelected(!1,this.adjust))},e.prototype.selectTime=function(t){var e,i;if(this.$el)return i=+t,this.currentDate.setHours(Math.floor(i/60)),this.currentDate.setMinutes(i%60),"function"==typeof(e=this.options).select?e.select({hours:this.currentDate.getHours(),minutes:this.currentDate.getMinutes()}):void 0},e.prototype.show=function(){return this.popoverMenuView.show()},e.prototype.hide=function(){return this.popoverMenuView.hide()},e}(c)},function(t,e){t.exports=function(t){var e='<header class="creator-header"> <h4 class="creator-title"> ';return e+=t.isEdit?' <span class="creator-location-tips">'+tb_i18n.get("event.creator.edit.tips")+"</span> ":' <span class="creator-location-tips">'+tb_i18n.get("event.creator.tips_1")+'</span> <a class="creator-location-handler" data-gta="{action: \'move content\', type: \'event\'}"> <span class="creator-location"></span> <span class="icon icon-chevron-down"></span> </a> <span class="creator-location-tips">'+tb_i18n.get("event.creator.tips_2")+"</span> ",e+=' </h4> <a class="creator-close pull-right icon icon-remove" data-dismiss="modal"></a></header><section class="creator-body"> <div class="creator-block no-padding"> <div class="event-input-wrap event-title-input-wrap"> <textarea class="event-title-input" placeholder="'+tb_i18n.get("event.creator.title.placeholder")+"\" data-gta=\"{action: 'edit title', type: 'event', control: '",e+=t.isEdit?"Event Editor":"New Event",e+='\'}"> </textarea> </div> <div class="event-input-wrap"> <textarea class="event-location-input" placeholder="'+tb_i18n.get("event.creator.location.placeholder")+"\" data-gta=\"{action: 'edit location', type: 'event', control: '",e+=t.isEdit?"Event Editor":"New Event",e+='\'}"> </textarea> </div> </div> <div class="creator-block no-padding creator-flex date-time-wrap"></div> <div class="creator-block no-padding creator-flex"> <div class="creator-flex-item on-flex repeat-wrap"></div> <div class="creator-flex-item on-flex remind-wrap"></div> </div> <div class="creator-block creator-involve"></div></section><footer class="creator-footer clearfix"> ',t.isEdit||(e+=" <!-- TODO: 目前编辑日程的时候不支持更新可见性字段 --> <a class=\"creator-visible creator-visible-members hide\" data-visible=\"involves\" data-gta=\"{action: 'toggle visibility', type: 'event', contorl: '",e+=t.isEdit?"Event Editor":"New Event",e+='\'}"> <span class="icon icon-unlock"></span>'+tb_i18n.get("visible.mode")+' <span class="mode-explanation">'+tb_i18n.get("visible.to.member")+"</span> </a> <a class=\"creator-visible creator-visible-involves hide\" data-visible=\"members\" data-gta=\"{action: 'toggle visibility', type: 'event', contorl: '",e+=t.isEdit?"Event Editor":"New Event",e+='\'}"> <span class="icon icon-lock"></span>'+tb_i18n.get("visible.mode")+' <span class="mode-explanation">'+tb_i18n.get("visible.to.involve")+"</span> </a> "),e+=" ",t.hasOldRecurrence?e+=' <div class="btn-wrap"> <button class="btn btn-primary submit-handler hinted" data-title="'+tb_i18n.get("event.confirm.update.following")+'" data-type="after">'+tb_i18n.get("event.creator.save.after")+'</button> <div class="btn-layer"></div> </div> <div class="btn-wrap"> <button class="btn btn-primary submit-handler hinted" data-title="'+tb_i18n.get("event.confirm.update.single")+'" data-type="single">'+tb_i18n.get("event.creator.save.single")+'</button> <div class="btn-layer"></div> </div> ':(e+=' <div class="btn-wrap"> <button class="btn btn-primary submit-handler" ',t.isEdit||(e+="data-gta=\"{action: 'added content', type: 'event'}\""),e+="> ",e+=t.isEdit?" "+tb_i18n.get("save")+" ":" "+tb_i18n.get("create")+" ",e+=' </button> <div class="btn-layer"></div> </div> '),e+="</footer>"}},function(t,e){t.exports=function(t){var e='<div class="creator-flex-item on-flex"> <h6 class="creator-flex-title">'+tb_i18n.get("event.creator.start.time")+"</h6> <div class=\"creator-flex-body\"> <span class=\"event-creator-date-wrap\" data-gta=\"{action: 'set start time', type: 'event', control: '";return e+=t.isEdit?"Event Editor":"New Event",e+='\'}"> <a class="event-creator-datepicker" data-key="startDate">'+t.startDateString+'</a> <a class="event-creator-timepicker" data-key="startDate">'+t.startTimeString+'</a> </span> </div></div><div class="creator-flex-item on-flex"> <h6 class="creator-flex-title">'+tb_i18n.get("event.creator.end.time")+"</h6> <div class=\"creator-flex-body\"> <span class=\"event-creator-date-wrap\" data-gta=\"{action: 'set end time', type: 'event', control: '",e+=t.isEdit?"Event Editor":"New Event",e+='\'}"> <a class="event-creator-datepicker" data-key="endDate">'+t.endDateString+'</a> <a class="event-creator-timepicker" data-key="endDate">'+t.endTimeString+'</a> </span> </div></div><div class="creator-flex-item text-center"> <h6 class="creator-flex-title">'+tb_i18n.get("event.creator.all.day")+'</h6> <div class="creator-flex-body"> <div class="check-box event-creator-allday-handler ',t.isAllDay&&(e+="active"),e+='"> <span class="icon icon-tick"></span> </div> </div></div>'}},function(t,e){t.exports=function(t){var e='<h6 class="creator-flex-title">'+tb_i18n.get("task.detail.remind")+"</h6><div class=\"creator-flex-body\"> <a class=\"event-creator-remind\" data-gta=\"{action: 'set reminder', type: 'event', control: '";return e+=t.isEdit?"Event Editor":"New Event",e+='\'}"> <span class="icon icon-alert-clock"></span> '+t.remindTitle+" </a></div>"}},function(t,e){t.exports=function(t){var e='<h6 class="creator-flex-title">'+tb_i18n.get("repeat")+'</h6><div class="creator-flex-body"> ';return"past"==t.scope?e+=' <span class="dirty"> <span class="icon icon-repeat"></span> '+tb_i18n.get("repeat.freq.NO")+" </span> ":(e+=' <a class="event-creator-repeat ',t.repeatTitle||(e+="dirty"),e+="\" data-gta=\"{action: 'set repeat', type: 'event', control: '",e+=t.isEdit?"Event Editor":"New Event",e+='\'}"> <span class="icon icon-repeat"></span> '+(t.repeatTitle||tb_i18n.get("repeat.freq.NO"))+" </a> "),
e+="</div>"}},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;n=i(685),o=i(817),s=i(429),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.name="events",e.prototype.model=o,e.prototype.boundToObjectType="project",e.prototype.initialize=function(t,i){return null==i&&(i={}),this.fromDate=i.fromDate||s().startOf("day").toISOString(),i.toDate&&(this.toDate=i.toDate),e.__super__.initialize.apply(this,arguments)},e.prototype.listen=function(){return this.on("change:_projectId",function(t,i){var n;return null!=(n=e.find(i))&&n.add(t),this.remove(t)}),e.__super__.listen.apply(this,arguments)},e.prototype.comparator=function(t,e){var i,n,r,o,s,a,c,l;return o=new Date(t.get("startDate")),c=new Date(e.get("startDate")),(l=o-c)?l:(r=new Date(t.get("endDate")),a=new Date(e.get("endDate")),(i=r-a)?i:(n=new Date(t.get("created")),s=new Date(e.get("created")),n-s))},e.prototype.getParams=function(t,e){var i;if("read"===t)return i={boundToObjectType:e.boundToObjectType||this.boundToObjectType,_boundToObjectId:this._boundToObjectId}},e.prototype.checkScope=function(t){return this.each(function(e){return function(i){if(t!==i.getScope())return e.remove(i)}}(this))},e}(n)},function(t,e){t.exports=function(t){var e='<a class="object-picker-creator link-add-handler"> <span class="icon icon-circle-cross"></span> <span>'+tb_i18n.get("object.picker.event.creator.tips")+'</span></a><ul class="events-list"></ul>';return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li class="group-name"> <p>'+tb_i18n.get("object.picker.event.title")+"</p></li>",n=t.events;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li class="event ',r.disabled&&(i+="disabled"),i+='" data-id="'+r._id+'"> <div class="event-time muted"> <time>'+r.startDateString+"</time> ",r.endDateString&&(i+=" - <time>"+r.endDateString+"</time> "),i+=' </div> <div class="event-content-wrapper"> <span class="event-title">'+e(r.title)+"</span> </div></li>";return i}},function(t,e){t.exports=function(t){var e='<ul class="flex-static thin-scroll scrollable object-menu "></ul><div class="flex-fill flex object-content"></div>';return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t.projects;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+="<li ","groupBy"==r.type&&(i+='class="group-name"'),i+="> ",i+="groupBy"==r.type?" <p>"+e(r.groupName)+"</p> ":' <a class="project-item" data-id="'+r._id+'">'+e(r.name)+"</a> ",i+="</li>";return i}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S,I=function(t,e){function i(){this.constructor=t}for(var n in e)z.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},z={}.hasOwnProperty;C=i(358),b=i(797),w=i(677),S=i(678),_=i(788),o=i(401),T=i(1085),d=i(1086),l=i(1087),y=i(1088),x=i(1089).getIntegrationMenus,M=i(786),k=i(1001),s=i(1071),g=i(1043),j=i(1090),p=i(1092),a=i(1094),v=i(1096),c=i(1099),h=i(1103),r=i(1109),n=i(1110),u=i(1111),f=i(1112),m=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return I(e,t),e.prototype.viewName="ObjectPickerOuterView",e.prototype.className="object-picker-outer-view flex-horiz",e.prototype.events={"click .object-menu-item":"switchObjectMenu","click .link":"selectItem","click .github-repo":"switchGithubRepo","click .user-info":"handleWeiboUser"},e.prototype.initialize=function(t){if(this.MENUS=x(),t.onSelect||t.objectType)return this.tokens=t.tokens,this.projectModel=t.projectModel,this.integrationTypes=this.projectModel.getIntegrationTypes(),this.objectType=t.objectType,this.onSelect=t.onSelect,this.cache={},this.integrationTypes.forEach(function(t){return function(e){return t.cache[e]={}}}(this)),this.selected=[],this.renderBasic(),this},e.prototype.renderBasic=function(){var t,e;return e=!!this.tokens[this.objectType],t=C.find(this.projectModel.getIntegrations(),function(t){return function(e){return e.type===t.objectType}}(this)),this.bindUrl=t.bindUrl,this.$el.html(r({isBind:e,integration:t})),this.$menu=this.$(".object-menu"),this.$list=this.$(".item-list"),this.setupScroll(this.$menu),e&&this.renderObjectMenu(),this},e.prototype.renderObjectMenu=function(){switch(this.objectType){case"weibo":this.renderWeiboMenu();break;case"github":this.renderGithubMenu();break;case"evernote":this.renderEvernoteMenu();break;case"yinxiang":this.renderEvernoteMenu();break;case"processon":this.renderProcessonMenu();break;case"jinshuju":this.renderJinshujuPicker()}return this},e.prototype.renderWeiboMenu=function(){return this.showLoadingIndicator(this.$menu),T.getHome({access_token:this.tokens[this.objectType],success:function(t){return function(e){var i,r;if(t.$el)return t.hideLoadingIndicator({animated:!1}),i={objects:t.MENUS[t.objectType]},null!=(r=t.$menu)?r.html(n(i)):void 0}}(this),error:function(t){return function(e){return t.hideLoadingIndicator({animated:!1}),o.show({message:String(e),status:"error"})}}(this),tokenInvalidHandler:function(t){return function(e){return t.hideLoadingIndicator({animated:!1}),o.show({message:String(e),status:"error"}),t.tokenInvalidHandler()}}(this)}),this},e.prototype.renderEvernoteMenu=function(){return this.showLoadingIndicator(this.$menu),this.evernoteSDK||(this.evernoteSDK=new l({token:this.tokens[this.objectType],type:this.objectType})),this.evernoteSDK.getNotebooks({success:function(t){return function(e){var i,r;if(t.$el)return t.hideLoadingIndicator({animated:!1}),i={objects:e.map(function(t){return{id:t.guid,name:t.name}})},null!=(r=t.$menu)?r.html(n(i)):void 0}}(this),error:function(t){return function(e){return t.hideLoadingIndicator({animated:!1})}}(this),tokenInvalidHandler:function(t){return function(e){return t.hideLoadingIndicator({animated:!1}),t.tokenInvalidHandler()}}(this)}),this},e.prototype.renderGithubMenu=function(){var t;return t={objects:this.MENUS[this.objectType]},this.cache.githubRepos?(t.repos=this.cache.githubRepos,t.selectedRepo=this.cache.githubRepos[0],this.$menu.html(u(t))):(this.showLoadingIndicator(this.$menu),d.getRepos({access_token:this.tokens[this.objectType],success:function(e){return function(i){var n;if(e.$el)return!i||i.length<=0?console.error("empty github repos list"):(e.currentGithubRepo=i[0],t.repos=i,t.selectedRepo=i[0],e.hideLoadingIndicator({animated:!1}),null!=(n=e.$menu)&&n.html(u(t)),e.cache.githubRepos=i)}}(this),error:function(t){return function(e){return t.hideLoadingIndicator({animated:!1}),o.show({message:String(e),status:"error"})}}(this),tokenInvalidHandler:function(t){return function(e){return t.hideLoadingIndicator({animated:!1}),o.show({message:String(e),status:"error"}),t.tokenInvalidHandler()}}(this)})),this},e.prototype.renderProcessonMenu=function(){return this.$menu.html(n({objects:this.MENUS[this.objectType]}))},e.prototype.renderJinshujuPicker=function(){return this.jinshujuPickerView=this.requestSubView(h,{token:this.tokens[this.objectType],bindUrl:this.bindUrl,el:this.el,menuEl:this.$menu,detailEl:this.$list,onSelect:this.onSelect})},e.prototype.tokenInvalidHandler=function(){return delete this.tokens[this.objectType],this.renderBasic(),this},e.prototype.switchGithubRepo=function(t){var e,i;return t.preventDefault(),this.$(".github-repo").removeClass("selected"),e=$(t.currentTarget),i=e.data("repo"),e.addClass("selected"),this.$(".selected-repo").html(i),this.currentGithubRepo=C.find(this.cache.githubRepos,function(t){return t.name===i}),this.cache[this.objectType]={},this},e.prototype.findCache=function(t,e){var i,n,r;if(t||e)return e=String(e),n=C.values(this.cache[t]),r=C.union.apply({},n),i=C.find(r,function(t){return t._id===e})},e.prototype.changeActive=function(t){return t.addClass("active").siblings().removeClass("active")},e.prototype.switchObjectMenu=function(t){var e,i;return(null!=t?t.currentTarget:void 0)?(e=$(t.currentTarget),i=e.data("id")):(i=t,e=this.$(".object-menu-item[data-id="+i+"]:first")),this.changeActive(e.parent()),this.menuId=i,this.selected=[],this.renderItems(this.menuId),this},e.prototype.renderItems=function(t){var e,i;return i=function(){switch(this.objectType){case"weibo":return this.renderWeibo.bind(this);case"github":return this.renderGithub.bind(this);case"evernote":return this.renderEvernote.bind(this);case"yinxiang":return this.renderEvernote.bind(this);case"processon":return this.renderProcesson.bind(this);case"jinshuju":return this.renderJinshuju.bind(this)}}.call(this),e=this.cache[this.objectType][t],e?i({menuId:t,items:e}):(this.$list.empty(),this.showLoadingIndicator(this.$list),i({menuId:t,success:function(e){return function(i){return e.cache[e.objectType][t]=i,e.hideLoadingIndicator({animated:!1})}}(this),error:function(t){return function(e){return o.show({message:String(e),status:"error"}),t.hideLoadingIndicator({animated:!1})}}(this)})),this},e.prototype.renderJinshuju=function(t){return this.jinshujuPickerView.renderDetail(t.menuId)},e.prototype.renderProcesson=function(t){var e;return t.items?(this.processon.cacheSet(t.menuId),this.dealProcessonRender(t.items)):(e=t.menuId,this.processon||(this.processon=new y({accessToken:this.tokens[this.objectType]})),this.processon.reset(),this.processon[e](null,{success:function(i){return function(n){if(i.$(".object-menu-item[data-id="+e+"]").parent().hasClass("active"))return"success"===n.status?(t.success(n.data),i.dealProcessonRender(n.data)):(t.error(),i.tokenInvalidHandler())}}(this)}))},e.prototype.dealProcessonRender=function(t){return C.isEmpty(t)?this.emptyHint():this.$list.html(this.requestSubView(v,{data:t,processon:this.processon}).$el)},e.prototype.parseDataWeibo=function(t){return t.map(function(t){return function(e){return{_id:""+e.mid,data:C.extend({src:"http://api.weibo.com/2/statuses/go?access_token="+t.tokens[t.objectType]+"&uid="+e.user.id+"&id="+e.id},e)}}}(this))},e.prototype.renderWeibo=function(t){var e;return t.items?this.$list.html(this.requestSubView(j,{data:t.items}).$el):(e=function(){switch(t.menuId){case this.MENUS[this.objectType][0].id:return T.getHome;case this.MENUS[this.objectType][1].id:return T.getUser;case this.MENUS[this.objectType][2].id:return T.getMentions;case this.MENUS[this.objectType][3].id:return T.getBilateral}}.call(this))({access_token:this.tokens[this.objectType],success:function(e){return function(i){if(e.$(".object-menu-item[data-id="+t.menuId+"]").parent().hasClass("active"))return i=e.parseDataWeibo(i),i.length?(t.success(i),e.$list.html(e.requestSubView(j,{data:i}).$el)):e.emptyHint()}}(this),error:t.error,tokenInvalidHandler:function(e){return function(i){return t.error(i),e.tokenInvalidHandler()}}(this)}),this},e.prototype.renderEvernote=function(t){return this.evernotePickerView=this.requestSubView(c,{bookId:t.menuId,type:this.objectType,token:this.tokens[this.objectType],cache:this.cache}),this.stopListening(this.evernotePickerView),this.listenTo(this.evernotePickerView,"empty",function(t){if(t===this.menuId)return this.emptyHint()}),this.listenTo(this.evernotePickerView,"error",function(t){if(t===this.menuId)return this.tokenInvalidHandler()}),this.$list.html(this.evernotePickerView.$el)},e.prototype.parseDataGithub=function(t){return t.map(function(t){return function(e){return e.repo=t.currentGithubRepo,e.type=t.menuId,"branch"===e.type&&(e.sha=e.type+"_"+e.commit.sha,e.html_url=e.repo.html_url+"/branches"),{_id:""+(e.id||e.sha),data:e}}}(this))},e.prototype.renderGithub=function(t){var e;return t.items?this.$list.html(this.requestSubView(p,{data:t.items}).$el):(e=function(){switch(t.menuId){case this.MENUS[this.objectType][0].id:return d.getPullRequests;case this.MENUS[this.objectType][1].id:return d.getIssues;case this.MENUS[this.objectType][2].id:return d.getCommits;case this.MENUS[this.objectType][3].id:return d.getBranchs}}.call(this))({owner:this.currentGithubRepo.owner.login,repo:this.currentGithubRepo.name,access_token:this.tokens[this.objectType],success:function(e){return function(i){if(e.$(".object-menu-item[data-id="+e.menuId+"]").parent().hasClass("active"))return i=e.parseDataGithub(i),i.length?(t.success(i),e.$list.html(e.requestSubView(p,{data:i}).$el)):e.emptyHint()}}(this),error:t.error,tokenInvalidHandler:function(e){return function(i){return t.error(i),e.tokenInvalidHandler()}}(this)}),this},e.prototype.selectItem=function(t){var e,i;if(e=$(t.currentTarget),!e.hasClass("disabled"))return!e.hasClass("selected")&&this.selected.length>=10?o.show({message:tb_i18n.get("object.picker.exceed.number"),status:"error"}):(e.toggleClass("selected"),i=e.data("id"),e.hasClass("selected")?this.selected.push(i):w.removeItem(this.selected,i),this.onSelect(this.selected.map(function(t){return function(e){return{type:t.objectType,data:t.findCache(t.objectType,e)}}}(this))),this)},e.prototype.handleWeiboUser=function(t){return t.preventDefault(),this},e.prototype.emptyHint=function(){var t;return t=this.$(".object-menu-item[data-id="+this.menuId+"]").data("name"),this.$list.html(f({description:tb_i18n.get("integration.placeholder",t)}))},e}(_),C.extend(m.prototype,b),t.exports=m},function(t,e,i){var n,r,o,s,a,c,l,p;o=i(358),n=i(357),r={home:"https://api.weibo.com/2/statuses/home_timeline.json",user:"https://api.weibo.com/2/statuses/user_timeline.json",mentions:"https://api.weibo.com/2/statuses/mentions.json",bilateral:"https://api.weibo.com/2/statuses/bilateral_timeline.json",singleWeibo:"http://api.weibo.com/2/statuses/go",userInfo:"https://api.weibo.com/2/users/show.json"},a=function(t){return t.access_token||console.error("no access_token"),t.success||t.error||console.error("no callback function"),t.url?n.ajax({method:"GET",url:t.url,jsonp:"callback",dataType:"jsonp",data:{access_token:t.access_token},success:function(e){var i;return e.data.error?21300<=(i=e.data.error_code)&&i<=21399||21501===e.data.error_code?t.tokenInvalidHandler(e.data.error):t.error(e.data.error):t.success(e.data.statuses)},error:function(e){return t.error(e)}}):console.error("no url")},c=function(t){return a(o.extend({url:r.home},t))},p=function(t){return a(o.extend({url:r.user},t))},l=function(t){return a(o.extend({url:r.mentions},t))},s=function(t){return a(o.extend({url:r.bilateral},t))},t.exports={getHome:c,getUser:p,getMentions:l,getBilateral:s}},function(t,e,i){var n,r,o,s,a,c,l,p,u;r=i(358),n=i(680),o=function(t){return t.access_token||console.error("no access_token"),t.success||t.error||console.error("no callback function"),t.url?n.ajax({url:t.url,data:{access_token:t.access_token}}).then(function(e){return t.success(e)})["catch"](function(e){var i;return 409===e.status?t.success([]):401===e.status?t.tokenInvalidHandler(e.responseJSON.message):t.error(null!=(i=e.responseJSON)?i.message:void 0)}):console.error("no url")},u=function(t){var e;return e="https://api.github.com/user/repos?page=1&per_page=100",o(r.extend({url:e},t))},l=function(t){var e;return e="https://api.github.com/repos/"+t.owner+"/"+t.repo+"/issues",o(r.extend({url:e},t))},p=function(t){var e;return e="https://api.github.com/repos/"+t.owner+"/"+t.repo+"/pulls",o(r.extend({url:e},t))},c=function(t){var e;return e="https://api.github.com/repos/"+t.owner+"/"+t.repo+"/commits",o(r.extend({url:e},t))},s=function(t){var e;return e="https://api.github.com/repos/"+t.owner+"/"+t.repo+"/branches",o(r.extend({url:e},t))},a=function(t){var e;return e="https://api.github.com/repos/"+t.owner+"/"+t.repo+"/branches/"+t.branch,o(r.extend({url:e},t))},t.exports={getRepos:u,getIssues:l,getPullRequests:p,getCommits:c,getBranchs:s,getBranchsData:a}},function(t,e,i){var n,r,o,s,a;o=i(358),s=i(679),r=i(680),a=s.INTEGRATION_HOST,t.exports=n=function(){function t(t){this.token=t.token,this.type=t.type,this.bookId=t.bookId||null,this.pageCount=20,this.notePage=0,this.noteHasMore=!0}return t.prototype._get=function(t){return null==t&&(t={}),t.data=o.extend({access_token:this.token,notebookGuid:this.bookId,count:this.pageCount},t.data),r.ajax({url:t.url,data:t.data,silentError:!0}).then(function(e){return function(i){var n,r;return n=i.startIndex,r=i.totalNotes,n&&r&&n+e.pageCount>r&&(e.noteHasMore=!1),"function"==typeof t.success?t.success(i):void 0}}(this))["catch"](function(e){return t.tokenInvalidHandler?"function"==typeof t.tokenInvalidHandler?t.tokenInvalidHandler(e.responseJSON.message):void 0:"function"==typeof t.error?t.error(e.responseJSON.message):void 0})},t.prototype.getNotebooks=function(t){var e;return e=a+"/"+this.type+"/listNotebooks",this._get(o.extend({url:e},t))},t.prototype.getNotes=function(t){var e;return null==t&&(t={}),e=a+"/"+this.type+"/findNotesMetadata",t.data=o.extend({page:++this.notePage},t.data),this._get(o.extend({url:e},t))},t}()},function(t,e,i){var n,r,o,s;o=i(358),s=i(679),n=i(680),t.exports=r=function(){function t(t){this.accessToken=t.accessToken,this.HTTP_PRE=s.INTEGRATION_HOST+"/processon/",this.curPage=0,this.loadMore=!0,this.currentQuery=null}return t.prototype._getInfo=function(t,e,i){var r,s;return null==e&&(e={}),null==i&&(i={}),o.extend(e,{access_token:this.accessToken}),s=function(t){return function(e){return e.data=o.map(e.data,function(t){return{_id:t._id,data:t}}),e.data.length<t.pageSize&&(t.loadMore=!1),"function"==typeof i.success?i.success(e):void 0}}(this),r=function(t){return"function"==typeof i.error?i.error(t):void 0},n.ajax({method:"GET",url:t,data:e,success:s,error:r})},t.prototype.getUserInfo=function(t){var e;return null==t&&(t={}),this.paginateSet(null,null),e="http://open.processon.com/api/user",e=this.HTTP_PRE+"user",this._getInfo(e,null,t)},t.prototype.getMyFiles=function(t,e){var i;return null==t&&(t={}),null==e&&(e={}),this.paginateSet(15,"myFiles"),i="http://open.processon.com/api/diagrams",i=this.HTTP_PRE+"diagrams",t=o.extend({chart_title:null,teamid:null,page_size:this.pageSize,cur_page:++this.curPage,status:null},t),t=o.pick(t,function(t){return null!=t}),this._getInfo(i,t,e)},t.prototype.getRecent=function(t,e){var i;return null==t&&(t={}),null==e&&(e={}),this.paginateSet(null,"recent"),i="http://open.processon.com/api/diagrams/recent",i=this.HTTP_PRE+"diagrams/recent",t=o.extend({count:null},t),t=o.pick(t,function(t){return null!=t}),this._getInfo(i,t,e)},t.prototype.getCooperated=function(t,e){var i;return null==t&&(t={}),null==e&&(e={}),this.paginateSet(5,"cooperated"),i="http://open.processon.com/api/diagrams/colla",i=this.HTTP_PRE+"diagrams/colla",t=o.extend({page_size:this.pageSize,cur_page:++this.curPage},t),t=o.pick(t,function(t){return null!=t}),this._getInfo(i,t,e)},t.prototype.reset=function(){return this.curPage=0,this.loadMore=!0,this.currentQuery=null},t.prototype.paginateSet=function(t,e){return this.pageSize=t,t||(this.loadMore=!1),this.currentQuery=e},t.prototype.cacheSet=function(t){return this.curPage=1,"myFiles"!==t&&"cooperated"!==t||(this.loadMore=!0),this.currentQuery=t},t.prototype.myFiles=function(t,e){return null==t&&(t={}),null==e&&(e={}),this.getMyFiles(t,e)},t.prototype.recent=function(t,e){return null==t&&(t={}),null==e&&(e={}),this.getRecent(t,e)},t.prototype.cooperated=function(t,e){return null==t&&(t={}),null==e&&(e={}),this.getCooperated(t,e)},t}()},function(t,e){t.exports={getIntegrationMenus:function(){return{weibo:[{id:"home",name:tb_i18n.get("weibo.menu1")},{id:"user",name:tb_i18n.get("weibo.menu2")},{id:"mentions",name:tb_i18n.get("weibo.menu3")},{id:"bilateral",name:tb_i18n.get("weibo.menu4")}],github:[{id:"pullRequest",name:"Pull Request"},{id:"issue",name:"Issues"},{id:"commit",name:"Commits"},{id:"branch",name:"Branches"}],evernote:[],yinxiang:[],processon:[{id:"myFiles",name:tb_i18n.get("processon.myFiles")},{id:"recent",name:tb_i18n.get("processon.recent")},{id:"cooperated",name:tb_i18n.get("processon.cooperated")}]}}}},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=i(358),r=i(677),o=i(788),n=i(1091),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.viewName="WeiboLinkView",e.prototype.className="detail-infos-weibo-link",e.prototype.tagName="ul",e.prototype.initialize=function(t){return this.data=t.data,this.render()},e.prototype.render=function(){return a.map(this.data,function(t){var e,i;if((null!=(e=t.data.pic_urls)?e.length:void 0)>1&&a.map(t.data.pic_urls,function(t){return t.thumbnail_pic=t.thumbnail_pic.replace("/thumbnail/","/square/")}),t.data.retweeted_status&&(null!=(i=t.data.retweeted_status.pic_urls)?i.length:void 0)>1&&a.map(t.data.retweeted_status.pic_urls,function(t){return t.thumbnail_pic=t.thumbnail_pic.replace("/thumbnail/","/square/")}),t.data.retweeted_status&&(t.retweetCreateTime=r.formatDate(t.data.retweeted_status.created_at.replace("+","GMT+"))),t.data.created_at)return t.createTime=r.formatDate(t.data.created_at.replace("+","GMT+"))}),this.$el.html(n(this.data))},e}(o)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li class="link" data-id="'+e(r._id)+'" data-linkedid = "'+e(r._linkedId)+'"> <a href="'+r.data.src+'" class="link-out" target="_blank"> </a> <div class="link-head"> <div class="link-title"> <a class="user-info" href="http://weibo.com/'+r.data.user.id+'" target="_blank"> <span class="avatar img-circle img-24" style="background-image:url('+e(r.data.user.avatar_hd)+')"></span> <span class="username WB-username title-name">'+r.data.user.name+'</span> </a> </div> <div class="link-handler-wrap ',r.objectlinkDel&&(i+="canceled"),i+='"> <span class="link-user"> '+r.createTime.dateString+" "+r.createTime.timeFormatString+" </span> ",r.objectlinkDel&&(i+=' <a class="link-menu-handler icon icon-chevron-down" data-id="'+r._id+'"></a> '),i+=' </div> </div> <div class="link-content"> <p class="WB-text">'+r.data.text+"</p> ",r.data.pic_urls&&r.data.pic_urls.length>0&&(i+=' <span class="fakeLink">pic.weibo.com/'+r.data.id+"</span> "),i+=" ",r.data.retweeted_status&&r.data.retweeted_status.user&&(i+=' <div class="WB-feed-expand"> <div class="W-arrow-bor W-arrow-bor-t"> <i class="S-bg1-br"></i> </div> <div class="WB-expand S-bg1"> <div class="link-title"> <span class="username">@'+r.data.retweeted_status.user.name+'</span> </div> <p class="WB-text">'+r.data.retweeted_status.text+"</p> ",r.data.retweeted_status.pic_urls&&r.data.retweeted_status.pic_urls.length>0&&(i+=' <span class="fakeLink">pic.weibo.com/'+r.data.id+"</span> "),i+=" </div> </div> "),i+=" </div></li>";return i}},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=i(358),o=i(677),s=i(788),n=i(1093),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.viewName="GitHubLinkView",e.prototype.className="detail-infos-github-link",e.prototype.tagName="ul",e.prototype.initialize=function(t){return this.data=t.data,this.render()},e.prototype.render=function(){return a.map(this.data,function(t){var e,i,n,r;return t.time=o.formatDate(null!=(e=t.data)?e.updated_at:void 0),t.commitTime=o.formatDate(null!=(i=t.data)&&null!=(n=i.commit)&&null!=(r=n.committer)?r.date:void 0)}),this.$el.html(n(this.data))},e}(s)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],"commit"===r.data.type?(i+='<!-- commit --><li class="link" data-id="'+e(r._id)+'" data-linkedid = "'+e(r._linkedId)+'"> <a class="link-out" href="'+r.data.html_url+'" target="_blank"> </a> <div class="link-head"> <div class="link-title"> <header>Commit:</header> </div> <div class="link-handler-wrap  ',r.objectlinkDel&&(i+="canceled"),i+='"> <span class="link-user">'+r.commitTime.dateString+" "+r.commitTime.timeFormatString+"</span> ",r.objectlinkDel&&(i+=' <a class="link-menu-handler icon icon-chevron-down" data-id="'+r._id+'"></a> '),i+=' </div> </div> <div class="link-title"> <span class="icon icon-git-commit"></span> <span class="title-name">'+r.data.commit.message+'</span> </div> <div class="link-footer"> <div class="link-user-info"> <div class="username Github-username">'+tb_i18n.get("by")+" "+r.data.commit.committer.name+"</div> </div> </div></li>"):"pullRequest"===r.data.type?(i+='<!-- pull request --><li class="link" data-id="'+e(r._id)+'" data-linkedid = "'+e(r._linkedId)+'"> <a class="link-out" href="'+r.data.html_url+'" target="_blank"> </a> <div class="link-head"> <div class="link-title"> <header>Pull Requests:</header> </div> <div class="link-handler-wrap  ',r.objectlinkDel&&(i+="canceled"),i+='"> <span class="link-user">'+r.time.dateString+" "+r.time.timeFormatString+"</span> ",r.objectlinkDel&&(i+=' <a class="link-menu-handler icon icon-chevron-down" data-id="'+r._id+'"></a> '),i+=' </div> </div> <div class="link-title"> <span class="icon icon-git-pull-request"></span> <span class="link-content"> <div class="link-heads">'+r.data.title+'</div> </div> </div> <div class="link-footer"> <div class="link-user-info"> '+r.data.state+" "+tb_i18n.get("by")+' <div class="username Github-username">'+r.data.user.login+'</div> </div> <div class="link-descrip"> '+tb_i18n.get("merge")+' <span class="git-resp">'+r.data.head.ref+'</span> into <span class="git-resp">'+r.data.base.ref+"</span> </div> </div></li>"):"issue"===r.data.type?(i+='<!-- issue --><li class="link" data-id="'+e(r._id)+'" data-linkedid = "'+e(r._linkedId)+'"> <a class="link-out" href="'+r.data.html_url+'" target="_blank"> </a> <div class="link-head"> <div class="link-title"> <header>Issues:</header> </div> <div class="link-handler-wrap  ',r.objectlinkDel&&(i+="canceled"),i+='"> <span class="link-user">'+r.time.dateString+" "+r.time.timeFormatString+"</span> ",r.objectlinkDel&&(i+=' <a class="link-menu-handler icon icon-chevron-down" data-id="'+r._id+'"></a> '),i+=' </div> </div> <div class="link-title"> <span class="icon icon-git-issue"></span> <span class="title-name">'+r.data.title+"</span> </div> ",r.data.body&&(i+=' <div class="link-content"> '+r.data.body+" </div> "),i+=' <div class="link-footer"> <div class="link-user-info"> '+r.data.state+" "+tb_i18n.get("by")+' <div class="username Github-username">'+r.data.user.login+"</div> </div> </div></li>"):"branch"===r.data.type&&(i+='<!-- branch --><li class="link" data-id="'+e(r._id)+'"> ',r.data.repo?(i+=' <a class="link-out" href="'+r.data.html_url+'" target="_blank"> </a> <div class="link-head"> <div class="link-title"> <header>Branches:</header> </div> ',r.objectlinkDel&&(i+=' <div class="link-handler-wrap  ',r.objectlinkDel&&(i+="canceled"),i+='"> <a class="link-menu-handler icon icon-chevron-down" data-id="'+r._id+'"></a> </div> '),i+=' </div> <div class="link-title"> <span class="icon icon-git-fork"></span> <span class="title-name title-branch"> <span class="repo-name">'+r.data.repo.name+'</span> <span class="git-resp">'+r.data.name+"</span> </span> </div> "):i+=' <div class="link-head"> <header>'+r.data.name+"</header> </div> ",i+="</li>");return i}},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=i(358),o=i(677),s=i(788),n=i(1095),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.viewName="EvernoteLinkView",e.prototype.className="detail-infos-evernote-link",e.prototype.tagName="ul",e.prototype.initialize=function(t){return this.data=t.data,this.render()},e.prototype.render=function(){return a.map(this.data,function(t){if(t.data.created)return t.createTime=o.formatDate(t.data.created)}),this.$el.html(n(this.data))},e}(s)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li class="link" data-id="'+e(r._id)+'" data-linkedid = "'+e(r._linkedId)+'"> <div class="link-head"> <a class="link-title link-out" href="'+r.data.shareLink+'" target="_blank"> <span class="evernote-name"> '+e(r.data.title)+' </span> </a> <div class="link-title link-in"> <span class="evernote-name title-name"> '+e(r.data.title)+' </span> </div> <div class="link-handler-wrap ',r.objectlinkDel&&(i+="canceled"),i+='"> <span class="link-user"> '+r.createTime.dateString+" "+r.createTime.timeFormatString+" </span> ",r.objectlinkDel&&(i+=' <a class="link-menu-handler icon icon-chevron-down" data-id="'+r._id+'"> </a> '),i+=" </div> </div></li>";return i}},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;l=i(358),c=i(788),o=i(429),a=i(797),n=i(1097),r=i(1098),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="ProcessonLinkView",e.prototype.className="processon-link-view flex-vert flex-space",e.prototype.events={"input input":"searchItems"},e.prototype.initialize=function(t){return this.items=t.data||[],this.hasSearch=null==t.hasSearch||t.hasSearch,this.isSearched=null==t.isSearched||t.isSearched,this.processon=t.processon,this.renderBasic()},e.prototype.renderBasic=function(){return this.$el.html(n({hasSearch:this.hasSearch})),this.$content=this.$("ul"),this.renderItems(),this.setupScroll(this.$content)},e.prototype.renderItems=function(t,e){var i;return null==e&&(e=!1),t=t||this.items,i=l.map(t,function(t){return l.extend({lastModifyTime:o(t.data.lastModify).format("LLL")},t)}),this.$content[e?"append":"html"](r({items:i,isSearched:this.isSearched})),this.$("time").timesince()},e.prototype.searchItems=function(t){var e;return e=$(t.currentTarget).val(),e=e.toLowerCase(),this.renderItems(l.filter(this.items,function(t){var i;return~(null!=(i=t.data.title)?i.toLowerCase().indexOf(e):void 0)}))},e.prototype.loadMore=function(t){if("function"==typeof t&&t(),this.processon)return this.processon.loadMore&&null!=this.processon[this.processon.currentQuery]?(this.showLoadingIndicator(this.$content),this.processon[this.processon.currentQuery](null,{success:function(t){return function(e){if(t.hideLoadingIndicator(t.$content),t.items=t.items.concat(e.data),t.renderItems(e.data,!0),!t.processon.loadMore)return t.showEndPoint(t.$content)}}(this)})):this.showEndPoint(this.$content)},e}(c),l.extend(s.prototype,a),t.exports=s},function(t,e){t.exports=function(t){var e="";return t.hasSearch&&(e+='<div class="search-wrapper flex-staic"> <input class="form-control" placeholder="'+tb_i18n.get("integrations.processon.search.hint")+'"></div>'),
e+='<ul class="flex-space thin-scroll"></ul>'}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="";if(t.items.length){i+=" ";var n=t.items;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li class="link flex ',r._linkedId&&(i+="link-detail"),i+='" data-id="'+r._id+'" data-linkedid="'+e(r._linkedId)+'"> <div class="link-head flex flex-space flex-vcenter"> <img src="'+r.data.thumb+'"> <p class="link-title title flex-space"> <span ',r._linkedId||(i+=' class="hinted" data-title="'+r.data.title+'" '),i+=">"+r.data.title+'<span> </p> <time class="time-stamp muted ',r._linkedId||(i+="hinted"),i+='" datetime="'+r.data.lastModify+'" ',r._linkedId||(i+=' data-title="'+r.lastModifyTime+" "),i+='"></time> <a class="link-out" href="'+e(r.data.viewUrl)+'" target="_blank"></a> ',r._linkedId&&(i+=' <div class="link-handler-wrap ',r.objectlinkDel&&(i+="canceled"),i+='"> ',r.objectlinkDel&&(i+=' <a class="link-menu-handler icon icon-chevron-down" data-id="'+r._id+'"></a> '),i+=" </div> "),i+=" </div> </li> "}else t.isSearched&&(i+=' <div class="search-empty-hint text-center"> <span class="icon icon-search-warning"></span> <p>'+tb_i18n.get("integrations.processon.search.no.result")+"</p> </div>");return i}},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;l=i(358),c=i(788),s=i(797),r=i(1087),o=i(1100),a=i(1101),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="EvernotePickerView",e.prototype.className="evernote-picker-view flex-space thin-scroll",e.prototype.tagName="ul",e.prototype.initialize=function(t){var e;return this.bookId=t.bookId,this.type=t.type,e=t.token,this.cache=t.cache,this.evernote=new r({token:e,type:this.type,bookId:this.bookId}),this.setupScroll(this.$el),this.load()},e.prototype.load=function(){return this.showLoadingIndicator(this.$el),this.evernote.getNotes({success:function(t){return function(e){var i;return i=t.parseDataEvernote(e.notes),i.length?t.renderItems(i):t.trigger("empty",t.bookId)}}(this),error:function(t){return function(){return t.trigger("error",t.bookId)}}(this)})},e.prototype.renderItems=function(t){return this.hideLoadingIndicator(this.$el),this.cache[this.type][this.bookId]=(this.cache[this.type][this.bookId]||[]).concat(t),this.$el.append(o(t))},e.prototype.loadMore=function(t){return this.showLoadingIndicator(this.$el),this.evernote.getNotes({success:function(e){return function(i){var n;if(n=e.parseDataEvernote(i.notes),e.renderItems(n),e.evernote.noteHasMore)return"function"==typeof t?t():void 0}}(this),error:function(t){return function(){return t.trigger("error",t.bookId)}}(this)})},e.prototype.parseDataEvernote=function(t){return l.chain(t).sortBy("updated").map(function(t){return{_id:""+t.guid,data:t}}).value().reverse()},e.prototype.remove=function(){var t;return null!=(t=this.cache)&&(t[this.type][this.bookId]=[]),e.__super__.remove.apply(this,arguments)},e}(c),l.extend(n.prototype,s),t.exports=n},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li class="link" data-id="'+e(r._id)+'"> <div class="link-head"> <a class="link-title"> <span class="evernote-name"> '+e(r.data.title)+" </span> </a> </div></li>";return i}},function(t,e){},,function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m=function(t,e){function i(){this.constructor=t}for(var n in e)f.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},f={}.hasOwnProperty;h=i(358),d=i(788),u=i(677),l=i(797),r=i(401),s=i(1104),a=i(1105),n=i(1106),p=i(1107),c=i(1108),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.viewName="JinshujuPickerView",e.prototype.className="jinshuju-picker-view",e.prototype.events={"click .jinshuju.check-box:not(.closed)":"selectItem","keyup .detail-search":"searchDataBySerialNumbers","click .search-btn":"searchDataBySerialNumbers"},e.prototype.initialize=function(t){var e;return e=t.token,this.bindUrl=t.bindUrl,this.el=t.el,this.$menuEl=t.menuEl,this.$detailEl=t.detailEl,this.onSelect=t.onSelect,this.jinshuju=new s({accessToken:e}),this.checkedItems=[],this.load(),this.listen()},e.prototype.load=function(){return this.showLoadingIndicator(this.$menuEl),this.jinshuju.getForms({success:function(t){return function(e){return t.hideLoadingIndicator(t.$menuEl),t.renderItems(e)}}(this),error:function(t){return function(e){if(401===e.code)return t.trigger("refreshToken")}}(this)})},e.prototype.listen=function(){return this.listenTo(this,"refreshToken",function(){return this.$el.html(c({bindUrl:this.bindUrl}))}),this.listenTo(this,"onSelect",this.updateSelected)},e.prototype.renderItems=function(t){return this.$menuEl.append(a(t))},e.prototype.renderDetail=function(t){var e,i,r,o,s;if(this.checkedItems=[],this.trigger("onSelect"),this.currentFormToken=t,o=this.getForm(this.currentFormToken))return e=u.formatDate(o.created_at).dateTimeString,i=tb_i18n.get("jinshuju.form.detail.createDate.des",e),r=this.jinshuju.formStatusSemantization(o),s=this.jinshuju.formTypesData(o),this.$detailEl.html(n({createDateDes:i,formStatusDes:r,typesData:s})),this.setupScroll(this.$detailEl),this.$searchInputWrapper=this.$(".search-input-wrapper"),this.$detailSearch=this.$(".detail-search"),this.$detailSearchWrapper=this.$(".detail-search-wrapper")},e.prototype.updateSelected=function(){return this.onSelect(h.map(this.checkedItems,function(t){return{type:"jinshuju",data:t}}))},e.prototype.getForm=function(t){return h.find(this.jinshuju.cache.forms,function(e){return e.token===t})},e.prototype.selectItem=function(t){var e,i,n;return e=$(t.currentTarget),e.toggleClass("checked"),n=e.data("type"),i=e.data("number"),"detail"!==n||i?this.dealCheckedItems(n,i):(this.$searchInputWrapper.toggleClass("hide"),this.$searchInputWrapper.hasClass("hide")?(this.$detailSearch.val(""),this.$detailSearchWrapper.empty(),this.removeCheckedItem("detail")):this.$detailSearch.focusAtEnd(),this.slideTo(this.$searchInputWrapper)),this.trigger("onSelect")},e.prototype.getFormDetail=function(){return new Promise(function(t){return function(e,i){return t.jinshuju.getFormDetail(t.currentFormToken,{success:e,error:function(t){return i(t)}})}}(this))},e.prototype.getItemsBySerialNumbers=function(t){return new Promise(function(e){return function(i,n){return e.jinshuju.getItemsBySerialNumbers(e.currentFormToken,t,{success:i,error:function(t){return n(t)}})}}(this))},e.prototype.getSerialNumbers=function(t){return h.chain(t.trim().split(",")).map(function(t){return t.trim()}).filter(function(t){return/^[1-9]\d*$/.test(t)}).uniq().value()},e.prototype.formatRawEntries=function(t,e,i){var n,r,o;return r=this.jinshuju.getReadableItemsData(t,i),n=this.getForm(e),o=h.map(r,function(t){var e;return e=h.extend({},n,{tb_type:"detail"},t)})},e.prototype.updateCheckedItemsWithEntries=function(t){return this.removeCheckedItem("detail"),this.formEntries=[],h.each(t,function(t){return function(e){var i;return i={_id:e.id,data:e},t.checkedItems.push(i),t.formEntries.push(i)}}(this)),this.trigger("onSelect")},e.prototype.searchDataBySerialNumbers=function(t){var e,i;if((null==t.keyCode||13===t.keyCode)&&(e=this.$detailSearch.val(),i=this.getSerialNumbers(e),i.length))return this.showLoadingIndicator(this.$detailSearchWrapper),this.slideTo(this.$detailSearchWrapper),Promise.all([this.getFormDetail(),this.getItemsBySerialNumbers(i)]).then(function(t){return function(e){var i;return t.hideLoadingIndicator(t.$detailSearchWrapper),i=t.formatRawEntries(e[0],t.currentFormToken,e[1]),h.isEmpty(i)?r.log(tb_i18n.get("jinshuju.entries.search.empty.hint")):(t.$detailSearchWrapper.empty().html(p(i)),t.slideTo(t.$detailSearchWrapper.find("li:last-of-type")),t.updateCheckedItemsWithEntries(i))}}(this))["catch"](function(t){return function(e){if(401===e.code)return t.trigger("refreshToken")}}(this))},e.prototype.dealCheckedItems=function(t,e){return this.queryCheckedItem(t,e)?this.removeCheckedItem(t,e):this.addCheckedItem(t,e)},e.prototype.queryCheckedItem=function(t,e){var i;return i=this.currentFormToken,h.find(this.checkedItems,function(n){var r;return n.data.token===i&&n.data.tb_type===t&&(null!=(r=n.data.entry)?r.serial_number:void 0)===e})},e.prototype.addCheckedItem=function(t,e){var i,n,r,o;return e?i=h.find(this.formEntries,function(t){return t.data.entry.serial_number===e}):(r=this.getForm(this.currentFormToken),o=h.find(this.jinshuju.formTypesData(r),function(e){return e.tb_type===t}),n=h.pick(o,["tb_type","url"]),i={_id:r.id,data:h.extend(n,r)}),this.checkedItems.push(i)},e.prototype.removeCheckedItem=function(t,e){var i;return i=this.currentFormToken,this.checkedItems=h.reject(this.checkedItems,function(n){var r,o;return r=n.data.token===i&&n.data.tb_type===t,e&&(r=r&&(null!=(o=n.data.entry)?o.serial_number:void 0)===e),r})},e}(d),h.extend(o.prototype,l),t.exports=o},function(t,e,i){var n,r,o,s,a=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};o=i(358),s=i(679),n=i(680),t.exports=r=function(){function t(t){this.accessToken=t.accessToken,this.HTTP_PRE=s.INTEGRATION_HOST+"/jinshuju/v4/",this.jinshujuURLRoot="https://jinshuju.net",this.cache={forms:[]}}return t.prototype._get=function(t,e,i){var r,s;return null==e&&(e={}),null==i&&(i={}),o.extend(e,{access_token:this.accessToken}),s=function(t){return"function"==typeof i.success?i.success(t):void 0},r=function(t){return"function"==typeof i.error?i.error(t):void 0},n.ajax({method:"GET",url:t,data:e,success:s,error:r})},t.prototype.getForms=function(t){var e,i,n;return null==t&&(t={}),n=this.HTTP_PRE+"forms",i=t.success,t.success=function(t){return function(e){return t.cache.forms=o.union(t.cache.forms,e),"function"==typeof i?i(e):void 0}}(this),e={per_page:50},this._get(n,e,t)},t.prototype.getFormDetail=function(t,e){var i;return null==e&&(e={}),i=this.HTTP_PRE+"forms/"+t,this._get(i,null,e)},t.prototype.getItemsBySerialNumbers=function(t,e,i){var n,r,o,s;for(null==i&&(i={}),s=this.HTTP_PRE+"forms/"+t+"/entries?",n=0,r=e.length;n<r;n++)o=e[n],s=s+"serial_number[]="+o+"&";return this._get(s,null,i)},t.prototype.formStatusSemantization=function(t){var e,i,n,r;return n={"public":tb_i18n.get("jinshuju.permission.public.des"),login:tb_i18n.get("jinshuju.permission.login.des"),password:tb_i18n.get("jinshuju.permission.password.des"),"private":tb_i18n.get("jinshuju.permission.private.des")},r=n[t.setting.permission],e={open:tb_i18n.get("jinshuju.open.rule.open.des"),closed:tb_i18n.get("jinshuju.open.rule.closed.des")},i=e[t.setting.open_rule],tb_i18n.get("jinshuju.form.status.semantization",r,i,t.entries_count)},t.prototype.formTypesData=function(t){return[{tb_type:"normal",title:tb_i18n.get("jinshuju.form.normal.title"),url:this.jinshujuURLRoot+"/f/"+t.token,isClosed:"closed"===t.setting.open_rule,closedHint:tb_i18n.get("jinshuju.form.normal.closed.hint"),hint:tb_i18n.get("jinshuju.form.normal.hint")},{tb_type:"result",title:tb_i18n.get("jinshuju.form.result.title"),url:t.setting.result_url,isClosed:"closed"===t.setting.result_state,closedHint:tb_i18n.get("jinshuju.form.result.closed.hint"),hint:tb_i18n.get("jinshuju.form.result.hint")},{tb_type:"search",title:tb_i18n.get("jinshuju.form.search.title"),url:t.setting.search_url,isClosed:"closed"===t.setting.search_state,closedHint:tb_i18n.get("jinshuju.form.search.closed.hint"),hint:tb_i18n.get("jinshuju.form.search.hint")},{tb_type:"detail",title:tb_i18n.get("jinshuju.form.detail.title"),url:this.jinshujuURLRoot+"/forms/"+t.token+"/entries",isClosed:!t.entries_count,closedHint:tb_i18n.get("jinshuju.form.detail.closed.hint"),hint:tb_i18n.get("jinshuju.form.detail.hint")}]},t.prototype.getReadableItemsData=function(t,e){return o.chain(e).map(function(e){return function(i){return e.getReadableItemData(t,i)}}(this)).sortBy(function(t){return t.entry.serial_number}).value()},t.prototype.getReadableItemData=function(t,e){var i,n,r,s;return r=this._getSupportTypesWithFns(),s=[],o.mapObject(e,function(e){return function(i,n){var o,a,c;if(/^field_/.test(n)&&(o=e._getValueByField(t,n),a=o.type,c="function"==typeof r[a]?r[a](o,i):void 0))return s.push(c)}}(this)),e.total_price&&s.unshift(e.total_price),i=t.token,n=e.serial_number,{url:this.jinshujuURLRoot+"/forms/"+i+"/entries?serial_number="+n,entry:{serial_number:n,content:s.join(", ")}}},t.prototype._getValueByField=function(t,e){return o.find(t.fields,function(t){return t.api_code===e})},t.prototype._formDetailFieldsFilter=function(t){var e;return null==t&&(t=[]),e=o.keys(this._getSupportTypesWithFns()),o.filter(t,function(t){var i;return i=t.type,a.call(e,i)>=0})},t.prototype._getSupportTypesWithFns=function(){return{phone:this._getDataValue,email:this._getDataSimple,address:this._getDataAddress,geo_location:this._getDataGeoLocation,telephone:this._getDataSimple,single_line_text:this._getDataSimple,paragraph_text:this._getDataSimple,single_choice:this._getDataChoices,multiple_choice:this._getDataChoices,likert:this._getDataLikert,matrix:this._getDataMatrix,number:this._getDataSimple,time:this._getDataTime,date:this._getDataSimple,drop_down:this._getDataChoices,link:this._getDataSimple,rating:this._getDataRating,cascade_drop_down:this._getDataCascadeDropDown,attachment:this._getDataAttachment}},t.prototype._getDataValue=function(t,e){return e.value},t.prototype._getDataAddress=function(t,e){return o.values(e).join(" ")},t.prototype._getDataGeoLocation=function(t,e){return e.address},t.prototype._getDataSimple=function(t,e){return e},t.prototype._getDataChoices=function(t,e){var i;return o.isArray(e)||(e=new Array(e)),i=[],o.each(e,function(e){var n;if(n=o.find(t.choices,function(t){return t.value===e}))return i.push(n.name)}),i.join(",")},t.prototype._getDataLikert=function(t,e){var i,n,r,s,a,c,l,p;for(l=t.statements,n=t.choices,p=[],r=0,a=e.length;r<a;r++)s=e[r],c=o.find(l,function(t){return t.value===s.statement}),i=o.find(n,function(t){return t.value===s.choice}),(null!=c?c.name:void 0)&&(null!=i?i.name:void 0)&&p.push(c.name+":"+i.name);return p.join(",")},t.prototype._getDataMatrix=function(t,e){var i,n,r;return r=t.statements,i=t.dimensions,n=[],o.each(e,function(t){var e,s,a;if(e=o.find(r,function(e){return e.value===t.statement}).name)return s=[],o.mapObject(t.dimensions,function(t,e){var n;if(n=o.find(i,function(t){return t.value===e}).name)return s.push(n+": "+t)}),a=s.join(","),n.push(e+": ("+a+")")}),n.join(",")},t.prototype._getDataTime=function(t,e){return e.hour+":"+e.minute},t.prototype._getDataRating=function(t,e){return tb_i18n.get("jinshuju.rating",e)},t.prototype._getDataCascadeDropDown=function(t,e){var i;return i="",o.each(t.choices,function(t){var n;if(t.value===e.level_1&&(n=o.find(t.sub_choices,function(t){return t.value===e.level_2})))return i=t.name+"-"+n.name}),i},t.prototype._getDataAttachment=function(t,e){return o.pluck(e,"name").join(",")},t}()},function(t,e){t.exports=function(t){var e="",i=t;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+='<li> <a class="object-menu-item" data-id="'+n.token+'">'+n.name+"</a></li>";return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="jinshuju-forms-detail"> <p class="text-hint">'+t.createDateDes+'</p> <p class="text-hint">'+t.formStatusDes+'</p> <div class="body"> <p class="text-hint">'+tb_i18n.get("jinshuju.form.detail.header")+'</p> <ul class="forms"> ',n=t.typesData;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li class="form flex flex-vstart"> <a class="check-box jinshuju ',r.isClosed&&(i+="closed"),i+='" data-type="'+r.tb_type+'"> <span class="icon icon-tick"></span> </a> <div class="flex-space"> <header>'+r.title+" ",!r.isClosed&&r.url&&(i+=' <a href="'+e(r.url)+'" target="_blank" class="view-url"> '+tb_i18n.get("view")+"</a> "),i+=' </header> <p class="text-hint">'+(r.isClosed?r.closedHint:r.hint)+"</p> ","detail"===r.tb_type&&(i+=' <div class="search-input-wrapper hide flex flex-vcenter"> <input type="text" class="form-control detail-search flex-space" placeholder="'+tb_i18n.get("jinshuju.detail.search.placeholder")+'"> <a class="search-btn">'+tb_i18n.get("search")+'</a> </div> <div class="detail-search-wrapper"></div> '),i+=" </div> </li> ";return i+=" </ul> </div></div>"}},function(t,e){t.exports=function(t){var e='<ul class="search-items"> ',i=t;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <li class="search-item flex flex-vcenter"> <a class="check-box jinshuju checked" data-type="'+n.tb_type+'" data-token="'+n.token+'" data-number="'+n.entry.serial_number+'"> <span class="icon icon-tick"></span> </a> <p class="single-data">'+n.entry.serial_number+": "+n.entry.content+"</p> </li> ";return e+="</ul>"}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="bind-hint text-center flex-fill"> <div> <span class="icon img-icon-jinshuju size-lg"></span><br> <p class="muted">'+tb_i18n.get("jinshuju.refresh.token.hint")+'</p> <p><a href="'+e(t.bindUrl)+'">'+tb_i18n.get("token.reauth")+"</a></p> <div></div>";return i}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="";return t.isBind?i+='<ul class="object-menu thin-scroll scrollable flex-static"></ul><div class="object-content flex-fill flex-vert"> <div class="item-list thin-scroll flex-fill flex-vert"></div></div>':(i+='<div class="bind-hint text-center flex-fill"> <div> ',i+="processon"===t.integration.type?' <span class="icon img-icon-processon-lg size-lg"></span><br> ':' <span class="icon img-icon-'+t.integration.type+' size-lg"></span><br> ',i+=' <p class="muted">'+t.integration.des+'</p> <p><a href="'+e(t.integration.bindUrl)+'">'+tb_i18n.get("bound")+" "+e(t.integration.name)+"</a></p> <div></div>"),i}},function(t,e){t.exports=function(t){var e="",i=t.objects;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+='<li> <a class="object-menu-item" data-id="'+n.id+'" data-name="'+n.name+'">'+n.name+"</a></li>";return e}},function(t,e){t.exports=function(t){var e='<div class="dropdown"> <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"> <span class="selected-repo">'+t.selectedRepo.name+'</span> <span class="icon icon-chevron-down"></span> </button> <ul class="dropdown-menu thin-scroll" aria-labelledby="dropdownMenu1"> ',i=t.repos;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <li> <a class="github-repo ',0===r&&(e+="selected"),e+='" data-repo="'+n.name+'">'+n.name+' <span class="icon icon-tick"></span> </a> </li> ';e+=" </ul></div>";var s=t.objects;if(s)for(var a,r=-1,c=s.length-1;r<c;)a=s[r+=1],e+='<li> <a class="object-menu-item" data-id="'+a.id+'" data-name="'+a.name+'">'+a.name+"</a></li>";return e}},function(t,e){t.exports=function(t){var e='<div class="integrations-placeholder muted flex flex-center flex-vcenter"> <div class="placeholder-content text-center"> <span class="icon icon-warning"></span> <p>'+t.description+"</p> </div></div>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j=function(t,e){function i(){this.constructor=t}for(var n in e)T.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},T={}.hasOwnProperty;k=i(358),_=i(678),o=i(429),d=i(797),v=i(677),y=i(788),g=i(1114),p=i(696),r=i(699),m=i(815),c=i(1021),f=i(818),b=i(786),s=i(1115),u=i(1116),h=i(1117),l=i(1118),n=i(1119),w=function(){return{task:tb_i18n.get("navigation.task"),post:tb_i18n.get("navigation.sharing"),work:tb_i18n.get("navigation.work"),event:tb_i18n.get("navigation.event"),entry:tb_i18n.get("bookkeeping")}},a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return j(e,t),e.prototype.viewName="ObjectPickerSearchView",e.prototype.className="object-picker-search-view",e.prototype.events={"keyup .search-input":"searchAll","click .type-item":"filterType","click .type-toggler":"toggleTypeSelector","click .project-toggler":"toggleProjectSelector","click .member-toggler":"toggleMemberSelector","click .result-handler":"toggleResult"},e.prototype.initialize=function(t){return this.options=t||{},this.query=t.query||"",this.attrs={q:this.query,type:t.type},this.collection=m.get(0),this.uniqueTaskCollection=new m([]),this.projectsCollection=p.get(0),this.membersCollection=r.get(0),this.renderBasic().listen(),this.startSearch(),this},e.prototype.renderBasic=function(){return this.$el.html(h()),this.$noresult=$(s()),this.$input=this.$(".search-input"),this.$list=this.$(".search-list"),this},e.prototype.listen=function(){return this.listenTo(this.collection,"reset",function(t){return function(){return t.$list.empty()}}(this)),this},e.prototype.renderResult=function(t){var e,i;return i={tasks:[],posts:[],files:[],events:[]},e=t&&null!=t.length?new m(t):this.collection,e.each(function(t){return function(e){var n;if(n=e.toJSON(),!t.getVisibleUniqueIdTasks().get(n._id))switch(n.disabled=~t.options.exclude.indexOf(n._id),n.type){case"task":return i.tasks.push(n);case"post":return i.posts.push(n);case"work":return i.files.push(n);case"event":return i.events.push(n)}}}(this)),this.$list.append(u(i)),this},e.prototype.renderUniqueIdTasks=function(){var t;return t=this.getVisibleUniqueIdTasks().map(function(t){return function(e){var i;return i=e.toJSON(),i.type="task",i.disabled=~t.options.exclude.indexOf(i._id),i}}(this)),this.$list.append(u({tasks:t})),this.renderTaskIdLabel()},e.prototype.renderTaskIdLabel=function(){return this.getVisibleUniqueIdTasks().each(function(t){return function(e){var i,n,r,o;return n=e.id,i=t.$list.find(".result-handler[data-id="+n+"]"),r=e.get("_projectId"),o=t.projectsCollection.get(r),t.requestSubView(f,{projectModel:o,uniqueId:e.get("uniqueId")}).bind(i.find(".task-id-placeholder"))}}(this))},e.prototype.getVisibleUniqueIdTasks=function(){var t;return t=this.uniqueTaskCollection.filter(function(t){return function(e){var i,n,r,o,s,a,c,l;if(e=e.toJSON(),n=e._projectId,a=t.projectsCollection.get(n),null!=a?a.isAppEnabled("taskUniqueId"):void 0)return c=t.attrs,l=c.type,i=c._creatorId,n=c._projectId,o=!n||e._projectId===n,s=!l||"task"===l,r=!i||i===e.executor._id,o&&s&&r}}(this)).map(function(t){return t.toJSON()}),new m(t,{parse:!1})},e.prototype.searchAll=function(t){var e;return e=$(t.currentTarget),13===t.keyCode&&(e.closest("li").siblings().removeClass("active"),this.query=e.val().trim(),k.extend(this.attrs,{q:this.query.toLowerCase()}),this.startSearch()),this},e.prototype.startSearch=function(){return g.searchForUniqueTask(this.uniqueTaskCollection,this.query).then(function(t){return function(){return t.fetchSearchResults()}}(this))["catch"](function(t){return console.error(t)})},e.prototype.fetchSearchResults=function(){return this.collection.reset(),this.query?(this.load({silent:!0,url:"v2/search",attrs:this.attrs,beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$list)}}(this),success:function(t){return function(e,i){if(t.$el)return t.hideLoadingIndicator(),t.$el.addClass("on-search"),t.renderUniqueIdTasks(),t.renderResult(),t.checkPlaceholder(),t.collection.hasMore&&t.setupScroll(t.$list),_.gta.event(null,"view","search result|start search",t.query.length)}}(this)}),this):this.checkPlaceholder},e.prototype.load=function(t){return this.collection.resetSoft(),this.collection.fetch(t),this},e.prototype.loadMore=function(t){return this.collection.loadMore({silent:!0,url:"v2/search",attrs:this.attrs,beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$list)}}(this),success:function(e){return function(i,n,r){if(e.$el)return e.hideLoadingIndicator({animated:!0}),n.length&&e.renderResult(n),e.collection.hasMore&&"function"==typeof t&&t(),_.gta.event(null,"view","search result|load more",e.pageIndex+1)}}(this)}),this},e.prototype.checkPlaceholder=function(){var t;return this.getVisibleUniqueIdTasks().length||this.collection.length?this.$noresult.remove():this.query.length>0&&(t=this.query,this.$noresult.find(".search-placeholder-content").text(tb_i18n.get("search.no.result",t)),this.$list.html(this.$noresult)),this},e.prototype.toggleResult=function(t){var e,i;if(i=[],e=$(t.currentTarget),!e.hasClass("disabled"))return e.toggleClass("selected"),e.parent().siblings().find(".selected").removeClass("selected"),e.siblings().removeClass("selected"),e.hasClass("selected")&&i.push({_id:e.data("id"),type:e.data("type")}),this.options.onSelect(i),this},e.prototype.toggleTypeSelector=function(t){var e,i;return null!=(e=this.projectPopover)&&e.remove(),null!=(i=this.memberPopover)&&i.remove(),this},e.prototype.toggleProjectSelector=function(t){var e,i;if(e=$(t.currentTarget),!e.data("bs.popover"))return i=[{_id:0,all:!0,title:tb_i18n.get("all.project")}],p.fetch(0,{success:function(t){return function(n){return t.projectPopover=t.requestSubView(c,{container:t.$el,ListTemplate:l,hideDelay:0,$toggler:e,searchPlaceholder:tb_i18n.get("task.menu.search.project"),dataList:i.concat(t.projectsCollection.filter(function(t){return t.getRoleScope()>=0}).map(function(t){return{_id:t.get("_id"),logo:t.get("logo"),title:t.get("name"),pinyin:t.get("pinyin")}})),selected:0,select:function(e){return t.filterProject(e)}}).show()}}(this)})},e.prototype.toggleMemberSelector=function(t){var e,i;if(e=$(t.currentTarget),!e.data("bs.popover"))return i=[{_id:0,all:!0,title:tb_i18n.get("all.member")}],r.fetch(0,{url:"projects/members",success:function(t){return function(r){return t.memberPopover=t.requestSubView(c,{container:t.$el,ListTemplate:n,hideDelay:0,$toggler:e,searchPlaceholder:tb_i18n.get("member.menu.search"),dataList:i.concat(t.membersCollection.map(function(t){return{_id:t.get("_id"),avatarUrl:t.get("avatarUrl"),title:t.get("name"),pinyin:t.get("pinyin")}})),selected:0,select:function(e){return t.filterMember(e)}}).show()}}(this)})},e.prototype.filterSearchResult=function(t){return this.attrs=k.extend(this.attrs,t),this.$list.html(""),this.startSearch(),this},e.prototype.filterType=function(t){var e,i,n;return n=w(),e=$(t.currentTarget),e.siblings("li").removeClass("active"),e.addClass("active"),i=e.data("type")||"",this.$(".active-type").text(i?n[i]:tb_i18n.get("search.result.all.type")),this.filterSearchResult({type:i}),this},e.prototype.filterProject=function(t){var e;if(t){if(e=this.projectsCollection.get(t),!e)return;this.$(".active-project").text(e.get("name"))}else this.$(".active-project").text(tb_i18n.get("all.project"));return this.filterSearchResult({_projectId:t||""}),this},e.prototype.filterMember=function(t){var e;if(t){if(e=this.membersCollection.get(t),!e)return;this.$(".active-member").text(e.get("name"))}else this.$(".active-member").text(tb_i18n.get("all.member"));return this.filterSearchResult({_creatorId:t||""}),this},e}(y),k.extend(a.prototype,d),t.exports=a},function(t,e,i){var n,r,o,s,a;o=i(1053),n=i(696),r=/^([a-z]{2,4})-(\d+)$/i,e.TASK_ID_REGEX=r,a=function(t,e){return new Promise(function(t,i){return o.fetch(e,{success:t,error:i})}).then(function(e){var i;return i=e.getTagsbyIds(t.get("tagIds")).map(function(t){return{name:t.name}}),t.set("tagIds",i,{silent:!0})})},s=function(t,e){return new Promise(function(i,n){return t.searchForUniqueTask({attrs:e,success:i,error:n})})},e.searchForUniqueTask=function(t,e,i){var o,c,l,p,u;return null==i&&(i=!0),c=n.get(0),t.reset(),l=e.match(r),l?(o=l[0],u=l[1],p=l[2],i?s(t,{uniqueIdPrefix:u,uniqueId:p}).then(function(){var e;return e=t.map(function(t){var e,i;return e=t.get("_projectId"),i=c.get(e),i.isAppEnabled("taskUniqueId")?a(t,e):Promise.resolve()}),Promise.all(e)}):s(t,{uniqueIdPrefix:u,uniqueId:p})):Promise.resolve()}},function(t,e){t.exports=function(t){var e='<div class="search-placeholder-wrap muted"> <div> <p> <span class="icon icon-search-warning"></span> </p> <p class="search-placeholder-content">'+tb_i18n.get("search.placeholder")+"</p> </div></div>";return e}},function(t,e,i){t.exports=function(t){var e="",n=i(932).fileIconT,r=i(963).calculateColor;if(t.tasks&&t.tasks.length){e+='<li class="search-result card"> ';var o=t.tasks;if(o)for(var s,a=-1,c=o.length-1;a<c;){s=o[a+=1],e+="  ";var l=s.type;e+=" ";var p="task"===l;e+=" ";var u={task:"board",post:"wall",event:"calendar"};if(e+=' <a class="result-handler '+l+" ",s.disabled&&(e+="disabled"),e+='" data-id="'+s._id+'" data-type="'+l+'"> <div class="result-thumbnail"> ',e+=p?' <span class="icon icon-'+u[l]+'"></span> <div class="avatar no-avatar img-24 img-circle" style="background-image: url('+s.avatarUrl+');"></div> ':"work"===l?" "+n(s)+" ":' <span class="icon icon-'+u[l]+'"></span> ',e+=' </div> <div class="result-content"> <p> <span>'+s.title+"</span> ","event"===l&&(e+=' <time class="event-date">'+s.eventDateString+"</time> "),e+=' <span class="task-id-placeholder"></span> ',s.tagIds&&s.tagIds.length>0){e+=" ";var d=s.tagIds;if(d)for(var h,m=-1,f=d.length-1;m<f;)h=d[m+=1],e+=' <span class="label tag"> <span class="tag-label" style="background-color: '+r(h.color,h.colorRGBA)+'"></span> <span class="tag-name">'+h.name+"</span> </span> ";e+=" "}if(e+=" </p> ",p&&s.subtasks&&s.subtasks.length>0){e+=" <ul> ";var g=s.subtasks;if(g)for(var v,y=-1,b=g.length-1;y<b;)v=g[y+=1],e+=' <li class="subtask"> <span class="icon icon-checkbox"></span> '+(v.content||v.highlight)+" </li> ";e+=" </ul> "}e+=" </div> </a> "}e+="</li>"}if(t.posts&&t.posts.length){e+='<li class="search-result card"> ';var k=t.posts;if(k)for(var w,_=-1,j=k.length-1;_<j;){w=k[_+=1],e+="  ";var l=w.type;e+=" ";var p="task"===l;e+=" ";var u={task:"board",post:"wall",event:"calendar"};if(e+=' <a class="result-handler '+l+" ",w.disabled&&(e+="disabled"),e+='" data-id="'+w._id+'" data-type="'+l+'"> <div class="result-thumbnail"> ',e+=p?' <span class="icon icon-'+u[l]+'"></span> <div class="avatar no-avatar img-24 img-circle" style="background-image: url('+w.avatarUrl+');"></div> ':"work"===l?" "+n(w)+" ":' <span class="icon icon-'+u[l]+'"></span> ',e+=' </div> <div class="result-content"> <p> <span>'+w.title+"</span> ","event"===l&&(e+=' <time class="event-date">'+w.eventDateString+"</time> "),e+=' <span class="task-id-placeholder"></span> ',w.tagIds&&w.tagIds.length>0){e+=" ";var T=w.tagIds;if(T)for(var h,M=-1,C=T.length-1;M<C;)h=T[M+=1],e+=' <span class="label tag"> <span class="tag-label" style="background-color: '+r(h.color,h.colorRGBA)+'"></span> <span class="tag-name">'+h.name+"</span> </span> ";e+=" "}if(e+=" </p> ",p&&w.subtasks&&w.subtasks.length>0){e+=" <ul> ";var x=w.subtasks;if(x)for(var v,y=-1,$=x.length-1;y<$;)v=x[y+=1],e+=' <li class="subtask"> <span class="icon icon-checkbox"></span> '+(v.content||v.highlight)+" </li> ";e+=" </ul> "}e+=" </div> </a> ";
}e+="</li>"}if(t.files&&t.files.length){e+='<li class="search-result card"> ';var S=t.files;if(S)for(var I,z=-1,P=S.length-1;z<P;){I=S[z+=1],e+="  ";var l=I.type;e+=" ";var p="task"===l;e+=" ";var u={task:"board",post:"wall",event:"calendar"};if(e+=' <a class="result-handler '+l+" ",I.disabled&&(e+="disabled"),e+='" data-id="'+I._id+'" data-type="'+l+'"> <div class="result-thumbnail"> ',e+=p?' <span class="icon icon-'+u[l]+'"></span> <div class="avatar no-avatar img-24 img-circle" style="background-image: url('+I.avatarUrl+');"></div> ':"work"===l?" "+n(I)+" ":' <span class="icon icon-'+u[l]+'"></span> ',e+=' </div> <div class="result-content"> <p> <span>'+I.title+"</span> ","event"===l&&(e+=' <time class="event-date">'+I.eventDateString+"</time> "),e+=' <span class="task-id-placeholder"></span> ',I.tagIds&&I.tagIds.length>0){e+=" ";var D=I.tagIds;if(D)for(var h,O=-1,N=D.length-1;O<N;)h=D[O+=1],e+=' <span class="label tag"> <span class="tag-label" style="background-color: '+r(h.color,h.colorRGBA)+'"></span> <span class="tag-name">'+h.name+"</span> </span> ";e+=" "}if(e+=" </p> ",p&&I.subtasks&&I.subtasks.length>0){e+=" <ul> ";var E=I.subtasks;if(E)for(var v,y=-1,A=E.length-1;y<A;)v=E[y+=1],e+=' <li class="subtask"> <span class="icon icon-checkbox"></span> '+(v.content||v.highlight)+" </li> ";e+=" </ul> "}e+=" </div> </a> "}e+="</li>"}if(t.events&&t.events.length){e+='<li class="search-result card"> ';var L=t.events;if(L)for(var V,R=-1,F=L.length-1;R<F;){V=L[R+=1],e+="  ";var l=V.type;e+=" ";var p="task"===l;e+=" ";var u={task:"board",post:"wall",event:"calendar"};if(e+=' <a class="result-handler '+l+" ",V.disabled&&(e+="disabled"),e+='" data-id="'+V._id+'" data-type="'+l+'"> <div class="result-thumbnail"> ',e+=p?' <span class="icon icon-'+u[l]+'"></span> <div class="avatar no-avatar img-24 img-circle" style="background-image: url('+V.avatarUrl+');"></div> ':"work"===l?" "+n(V)+" ":' <span class="icon icon-'+u[l]+'"></span> ',e+=' </div> <div class="result-content"> <p> <span>'+V.title+"</span> ","event"===l&&(e+=' <time class="event-date">'+V.eventDateString+"</time> "),e+=' <span class="task-id-placeholder"></span> ',V.tagIds&&V.tagIds.length>0){e+=" ";var q=V.tagIds;if(q)for(var h,H=-1,B=q.length-1;H<B;)h=q[H+=1],e+=' <span class="label tag"> <span class="tag-label" style="background-color: '+r(h.color,h.colorRGBA)+'"></span> <span class="tag-name">'+h.name+"</span> </span> ";e+=" "}if(e+=" </p> ",p&&V.subtasks&&V.subtasks.length>0){e+=" <ul> ";var U=V.subtasks;if(U)for(var v,y=-1,W=U.length-1;y<W;)v=U[y+=1],e+=' <li class="subtask"> <span class="icon icon-checkbox"></span> '+(v.content||v.highlight)+" </li> ";e+=" </ul> "}e+=" </div> </a> "}e+="</li>"}return e}},function(t,e){t.exports=function(t){var e='<div class="search-wrap"> <span class="icon icon-search"></span> <input class="form-control search-input" placeholder="'+tb_i18n.get("object.picker.search.all")+'" /></div><div class="search-result-header"> <div class="search-result-filter clearfix"> <div class="filter type-filter"> <a class="type-toggler" data-toggle="dropdown"> <span class="active-type">'+tb_i18n.get("search.result.all.type")+'</span> <span class="icon icon-chevron-down"></span> </a> <div class="type-selector dropdown-menu card"> <ul class="type-list"> <li class="type-item active"> <a class="clearfix"> <span class="icon icon-th"></span> '+tb_i18n.get("search.result.all.type")+' </a> </li> <li class="type-item" data-type="task"> <a class="clearfix"> <span class="icon icon-board"></span> '+tb_i18n.get("navigation.task")+' </a> </li> <li class="type-item" data-type="post"> <a class="clearfix"> <span class="icon icon-wall"></span> '+tb_i18n.get("navigation.sharing")+' </a> </li> <li class="type-item" data-type="work"> <a class="clearfix"> <span class="icon icon-file"></span> '+tb_i18n.get("navigation.work")+' </a> </li> <li class="type-item" data-type="event"> <a class="clearfix"> <span class="icon icon-calendar"></span> '+tb_i18n.get("navigation.event")+' </a> </li> </ul> </div> </div> <div class="filter project-filter"> <a class="project-toggler"> <span class="active-project">'+tb_i18n.get("all.project")+'</span> <span class="icon icon-chevron-down"></span> </a> </div> <div class="filter member-filter"> <a class="member-toggler"> <span class="active-member">'+tb_i18n.get("all.member")+'</span> <span class="icon icon-chevron-down"></span> </a> </div> </div></div><ul class="search-list thin-scroll"></ul>';return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t.dataList;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li class="menu-item project-item ',r.selected&&(i+="selected"),i+='" data-id="'+r._id+'"> <a> ',i+=r.all?' <div class="icon icon-project pull-left"></div> ':' <div class="avatar project-logo pull-left" style="background-image:url('+r.logo+')"></div> ',i+=" "+e(r.title)+" </a></li>";return i}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t.dataList;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li class="menu-item member-item ',r.selected&&(i+="selected"),i+='" data-id="'+r._id+'"> <a> ',i+=r.all?' <div class="icon icon-users pull-left"></div> ':' <div class="avatar user-avatar pull-left" style="background-image:url('+r.avatarUrl+')"></div> ',i+=" "+e(r.title)+" </a></li>";return i}},function(t,e){t.exports=function(t){var e='<div class="modal-content col-flex"> <header class="modal-header"> <div class="title"> <span>'+tb_i18n.get("link.add")+'</span> </div> </header> <section class="flex-horiz modal-body flex-stretch"> <ul class="flex-static object-picker-menu thin-scroll"> <li class="group-name"></li> <li> <a class="object-nav" data-type="search" data-gta="{action: \'begin search\', control: \'link panel\'}"> <span class="icon icon-search"></span> <span>'+tb_i18n.get("navigation.search")+'</span> </a> </li> <li> <a class="object-nav" data-type="task" data-gta="{action: \'add link\', type: \'task\'}"> <span class="icon icon-board"></span> <span>'+tb_i18n.get("navigation.task")+'</span> </a> </li> <li> <a class="object-nav" data-type="post" data-gta="{action: \'add link\', type: \'post\'}"> <span class="icon icon-wall"></span> <span>'+tb_i18n.get("navigation.sharing")+'</span> </a> </li> <li> <a class="object-nav" data-type="file" data-gta="{action: \'add link\', type: \'file\'}"> <span class="icon icon-folder"></span> <span>'+tb_i18n.get("navigation.work")+'</span> </a> </li> <li> <a class="object-nav" data-type="event" data-gta="{action: \'add link\', type: \'event\'}"> <span class="icon icon-calendar"></span> <span>'+tb_i18n.get("navigation.event")+'</span> </a> </li> </ul> <div class="flex-fill object-picker-body"></div> </section> <footer class="modal-footer"> <button class="cancel-handler btn btn-link">'+tb_i18n.get("cancel")+'</button> <button class="confirm-handler btn btn-primary">'+tb_i18n.get("confirm")+"</button> </footer></div>";return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="";if(t.length){i+=' <li class="group-name integration-item"><div class="line"></div></li> ';var n=t;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li class="integration-item"> <a class="object-nav" data-type="'+r.type+"\" data-gta=\"{action: 'to use plugin', type: "+r.type+'}"> <span class="icon icon-outer img-icon-'+r.type+' size-ssm"></span> <span class="object-copy">'+e(r.name)+"</span> </a> </li> "}return i}},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;a=i(358),l=i(678),o=i(788),r=i(680),c=i(679),n=i(1123),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="YinxiangDetailView",e.prototype.className="yinxiang-detail-view modal-dialog card object-modal-view fixed",e.prototype.initialize=function(t){return this.options=t,this.renderBasic(),this},e.prototype.renderBasic=function(){var t;return t=a.extend({iframeData:encodeURIComponent(this.options.data.content)},this.options),this.$el.html(n(t))},e}(o)},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(677);return n+='<div class="modal-detail"> <div class="modal-header"> <a class="modal-close icon icon-remove pull-right" data-dismiss="modal"></a> </div> <h2 class="note-title">'+e(t.data.title)+'</h2> <div class="vtop"> <div class="note-updated"> <span>'+tb_i18n.get("updated")+" "+r.formatDate(t.data.updated).dateTimeString+'</span> </div> </div> <div class="divider"></div> <div class="yinxiang-content"> <iframe src="data:text/html;charset=utf-8, '+t.iframeData+'" class="thin-scroll"></iframe> </div></div>'}},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=i(788),n=i(1125),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.viewName="JinshujuLinkView",e.prototype.className="jinshuju-link-view flex-vert",e.prototype.initialize=function(t){return this.items=t.data,this.$el.html(n(this.items))},e}(o)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li class="link flex" data-id="'+r._id+'" data-linkedid="'+e(r._linkedId)+'"> ',i+=r.data.entry?' <a class="flex-space" href="'+e(r.data.url)+'" target="_blank"> <div class="flex form-sub-title"> <span class="flex-space">'+tb_i18n.get("jinshuju.form.title",r.data.name)+'</span> </div> <p class="form-title">'+tb_i18n.get("jinshuju.data.serial_number",r.data.entry.serial_number)+'</p> <p class="form-digest">'+r.data.entry.content+"</p> </a> ":' <a class="link-title flex-space" href="'+e(r.data.url)+'" target="_blank">'+r.title+"</a> ",i+=' <div class="link-handler-wrap ',r.objectlinkDel&&(i+="canceled"),i+='"> ',r.objectlinkDel&&(i+=' <a class="link-menu-handler icon icon-chevron-down" data-id="'+r._id+'"></a> '),i+=" </div></li>";return i}},function(t,e,i){var n,r,o,s,a,c,l,p;o=i(429),l=i(786),c=i(1127),r=i(1074),n=i(1128),a=i(804),s=i(447),e.saveAttrs=function(t,e){return new Promise(function(i,n){var r;return t.isRecurrenceEventInstance()?(r=t.toJSON(),(new l).open(c,{onConfirm:function(r){var o;return o=t.eventDetailView,o&&o.resetView(),t.updateEvent(r,e).then(function(t){return o&&(o.eventModel=o.options.eventModel=t,o.refreshView()),i(t)},n)},onCancel:function(){return t.set(r),t.trigger("cancel")}})):t.save(null,{attrs:e,success:i,error:n})})},e.showDatePicker=function(t,i,n){var r,s,a;return t.data("datepicker")?(a=!t.data("showDatepicker"),t.data("showDatepicker",a),t.data("datepicker").picker.toggle(a)):(r=o(i.get(n)),s="endDate"===n?new Date(i.get("startDate")):null,"endDate"===n&&i.checkAllDay()&&r.subtract(1,"day"),t.datepicker({language:tb_i18n.getLanguage(),todayHighlight:!0,placement:"left",startDate:s}).datepicker("update",new Date(r.startOf("day").valueOf())).datepicker("show").focus().on("changeDate",function(o){var s,a,c;if(t.datepicker("hide"),c=o.date)return c.setHours(r.get("hour")),c.setMinutes(r.get("minute")),a=new Date(i.get(n)),s=p(i,n,c),e.saveAttrs(i,s)}).on("hide",function(e){return t.data("showDatepicker",!1)}),t.data("showDatepicker",!0))},e.showTimePicker=function(t,i,n,o){var s,a;return s=new Date(i.get(n)),a="endDate"===n?i.get("startDate"):null,o.requestSubView(r,{addPlaceholder:tb_i18n.get("event.time.picker.placeholder"),$toggler:t,currentDate:i.get(n),startDate:a,select:function(t){var r,o;if(s.setHours(t.hours),s.setMinutes(t.minutes),o=new Date(i.get(n)),o.valueOf()!==s.valueOf())return r=p(i,n,s),e.saveAttrs(i,r)}}).show()},p=function(t,e,i){var n,r,s,c,l;return l=o(t.get("startDate")),r=o(t.get("endDate")),n=r-l,c=t.getRRuleSet(),"startDate"===e?(l=o(i),r=o(n+l)):"endDate"===e&&(r=o(i)),r.isAfter(l)||(r=o(l).add(1,"hour")),t.checkAllDay()&&(l=l.startOf("day"),r=r.add(1,"day").startOf("day")),t.isRecurrenceEventInstance()&&(s=o(t.get("originStartDate")),l=new Date(l),l.setFullYear(s.get("year")),l.setMonth(s.get("month")),l.setDate(s.get("date")),a.updateRRuleSet(c,{dtstart:l})),{startDate:l.toISOString(),endDate:r.toISOString(),recurrence:null!=c?c.valueOf():void 0}},e.switchAllDay=function(t,i){var n,r,s,a;return s=t.toJSON(),i?(a=o(s.startDate).startOf("day").toISOString(),n=p(t,"startDate",a),n.endDate=o(s.endDate).add(1,"day").startOf("day").toISOString(),e.saveAttrs(t,n)):(r=o(s.startDate).add(1,"hour").toISOString(),e.saveAttrs(t,{endDate:r}))},e.setRepeat=function(t,e){return(new l).open(n,{onConfirm:function(){var i;return i=t.eventDetailView,i&&i.resetView(),t.updateEvent("next",{recurrence:e}).then(function(t){if(i)return i.eventModel=i.options.eventModel=t,i.refreshView()})},onCancel:function(){return t.trigger("cancel")}})}},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(1013),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.viewName="EventConfirmUpdateView",e.prototype.initialize=function(){var t,i,n;return e.__super__.initialize.apply(this,arguments),n=tb_i18n.get("event.confirm.update.title"),i=tb_i18n.get("event.confirm.update.description"),t=["current","next","all"],this.render({title:n,description:i,btns:t})},e}(n)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(1013),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.viewName="EventConfirmUpdateMemberView",e.prototype.initialize=function(){var t,i;return e.__super__.initialize.apply(this,arguments),i=tb_i18n.get("event.confirm.updateRepeat.title"),t=tb_i18n.get("event.confirm.updateRepeat.description"),this.render({title:i,description:t})},e}(n)},function(t,e,i){var n,r,o,s,a,c;a=i(678),r=i(401),c=i(530),n=i(793),s=i(697),t.exports=o={enterCollection:function(t){if(t)return new Promise(function(e){return function(i,r){return n.fetch(t,{silentError:!0,success:function(t){return i(t.get("_projectId"))},error:function(i,n){return e.clearCache(t),r(n)}})}}(this)).then(function(e){return new Promise(function(i){return function(n,o){return s.fetch(e,{silentError:!0,success:function(i){var o;return i.isAppEnabled("works")?(o="project/"+e+"/works/"+t,a.router.navigate(o,{trigger:!0}),n()):r.error({message:tb_i18n.get("link.collection.preview.error")})},error:function(t,n){return i.clearCache(e),o(n)}})}}(this))})["catch"](function(t){var e;if(e=t.message,403===t.status&&(e=tb_i18n.get("link.collection.permission.error")),e)return r.error({message:e})})},clearCache:function(t){return delete c.getData().models[t],delete c.getData().matrix[t]}}},function(t,e){t.exports=function(t){var e='<div class="links-list"> <div class="link-category link-task hide"></div> <div class="link-category link-files hide"></div> <div class="link-category link-event hide"></div> <div class="link-category link-post hide"></div> <div class="link-category link-weibo hide"></div> <div class="link-category link-github hide"></div> <div class="link-category link-evernote hide"></div> <div class="link-category link-yinxiang hide"></div> <div class="link-category link-processon hide"></div> <div class="link-category link-jinshuju hide"></div></div>';return t.permissions.objectlinkPost&&(e+='<div class="link-add-wrap on-bottom"> <span class="icon icon-link2 detail-infos-icon"></span> <a class="add-link-handler" data-gta="event" data-label="activity add links"> '+tb_i18n.get("link.add")+" </a></div>"),e}},function(t,e){t.exports=function(t){var e="<span class='linked-header'> <span class='icon "+t.icon+"'></span> "+t.title+"</span><div class='link-contents on-top on-bottom'></div>";return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li class="link ',r.data.isDone&&(i+="done"),i+='" data-id="'+r._id+'" data-linkedid = "'+r._linkedId+'"> <div class="link-head"> <div class="link-icon-wrap"> <header class="task-header"> <div class="check-box non-checkable"> <span class="icon icon-tick"></span> </div> </header> </div> <div class="link-title"> ',i+=r.data.executor?' <span class="avatar img-circle img-24" style="background-image:url('+e(r.data.executor.avatarUrl)+')"></span> ':' <span class="avatar img-circle img-24 no-avatar"></span> ',i+=' <span class="task-name title-name"> '+e(r.data.content)+' </span> <span class="task-id-placeholder"></span> </div> <div class="link-handler-wrap ',r.objectlinkDel&&(i+="canceled"),i+='"> <span class="link-project">'+e(r.data.project.name)+"</span> ",r.objectlinkDel&&(i+=' <a class="link-menu-handler icon icon-chevron-down" data-id="'+r._id+'"></a> '),i+=' </div> </div> <div class="link-dueTime"> ',r.dueDates&&r.dueDates.dateClass&&(i+=' <span class="label ',"overdue"===r.dueDates.dateClass?i+="label-important":"today"===r.dueDates.dateClass?i+="label-warning":"upcoming"===r.dueDates.dateClass&&(i+="label-info"),i+='"> <span class="icon icon-calendar ',"normal"!==r.dueDates.dateClass&&(i+="icon-white"),i+='"></span> <span>'+r.dueDates.dateString+"</span> <span>"+("00:00"===r.dueDates.timeFormatString?"":r.dueDates.timeFormatString)+"</span> </span> "),i+=" </div> </li>";return i}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(932).fileIconT,o=i(932).folderIconT,s=t;if(s)for(var a,c=-1,l=s.length-1;c<l;)a=s[c+=1],n+=' <li class="link" data-id="'+a._id+'" data-linkedid = "'+a._linkedId+'"> <div class="link-head"> <div class="link-icon-wrap flex flex-vcenter flex-center"> ',n+="collection"===a.linkedType?" "+o(a.data)+" ":" "+r(a.data)+" ",n+=' </div> <div class="link-title">'+e(a.data.title||a.data.fileName)+'</div> <div class="link-handler-wrap ',a.objectlinkDel&&(n+="canceled"),n+='"> <span class="link-project">'+e(a.data.project.name)+"</span> ",a.objectlinkDel&&(n+=' <a class="link-menu-handler icon icon-chevron-down" data-id="'+a._id+'"></a> '),n+=" </div> </div> </li>";return n}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li class="link" data-id="'+r._id+'" data-linkedid = "'+r._linkedId+'"> <div class="link-head"> <div class="link-title"> <span class="title-name">'+e(r.data.title)+'</span> </div> <div class="link-handler-wrap ',r.objectlinkDel&&(i+="canceled"),i+='"> <span class="link-project">'+e(r.data.project.name)+"</span> ",r.objectlinkDel&&(i+=' <a class="link-menu-handler icon icon-chevron-down" data-id="'+r._id+'"></a> '),i+=' </div> </div> <div class="link-footer"> <div class="event-detail-startDate event-time"> <p class="event-detail-handler-content"> <span class="event-detail-datepicker" data-key="startDate">'+r.startDateString+" "+r.startTimeString+'</span> </p> </div> <span class="timeTo">-</span> <div class="event-detail-endDate event-time"> <p class="event-detail-handler-content"> <span class="event-detail-datepicker" data-key="endDate">'+r.endDateString+" "+r.endTimeString+"</span> </p> </div> </div> </li>";return i}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li class="link" data-id="'+r._id+'" data-linkedid = "'+r._linkedId+'"> <div class="link-head"> <div class="link-title"> <span class="avatar img-circle img-24" style="background-image:url('+e(r.data.creator.avatarUrl)+')"></span> <span class="post-name title-name"> '+r.data.title+' </span> </div> <div class="link-handler-wrap ',r.objectlinkDel&&(i+="canceled"),i+='"> <span class="link-project">'+r.data.project.name+"</span> ",r.objectlinkDel&&(i+=' <a class="link-menu-handler icon icon-chevron-down" data-id="'+r._id+'"></a> '),i+=" </div> </div> ",r.content&&(i+=' <div class="link-content"> '+e(r.content)+" </div> "),i+=" </li>";return i}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li class="link" data-id="'+e(r._id)+'" data-linkedid = "'+e(r.data.guid)+'" data-token="'+e(r.data.token)+'"> <div class="link-head"> <div class="link-title"> <span class="yinxiang-name"> '+e(r.data.title)+' </span> </div> <div class="link-handler-wrap ',r.objectlinkDel&&(i+="canceled"),i+='"> <span class="link-user"> '+r.createTime.dateString+" "+r.createTime.timeFormatString+" </span> ",r.objectlinkDel&&(i+=' <a class="link-menu-handler icon icon-chevron-down" data-id="'+r._id+'"> </a> '),i+=" </div> </div></li>";return i}},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;l=i(358),c=i(788),a=i(677),p=i(678),s=i(697),r=i(1138),n=i(1153),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="NoteView",e.prototype.className="detail-infos-note-view",e.prototype.events={"click .note-input, .note-text, .add-note-handler:not(.disabled)":"enterNoteEdit","click .toggle-note-handler":"toggleNoteStatus"},e.prototype.initialize=function(t){if(null==t&&(t={}),null!=t?t.objectModel:void 0)return this.options=t,this.objectModel=t.objectModel,this.projectModel=s.get(this.objectModel.get("_projectId")),this.noteAttribute=t.noteAttribute||"note",this.renderBasic().refreshView().listen(),this},e.prototype.renderBasic=function(){var t;return t=this.objectModel.toJSON(),"note"!==this.noteAttribute&&(t.note=t[this.noteAttribute]),t.permissions={putNote:this.hasPermission(),isArchived:this.objectModel.get("isArchived")},this.$el.html(n(t)),this.$noteContentWrap=this.$(".note-input-wrap"),this.$toggleNoteHandler=this.$(".toggle-note-handler"),this.$noteWrap=this.$(".note-wrap"),this.$noteContainer=this.$(".note-container"),this.$noteTextSet=this.$(".note-text-set"),this},e.prototype.renderNoteEditor=function(){var t;return null!=(t=this.noteEditor)&&t.remove(),this.noteEditor=this.requestSubView(r,{projectModel:this.projectModel,objectModel:this.objectModel,dragAndDropWrap:this.$(".note-input-set"),content:this.htmlString,mdSupport:this.mdSupport,noteAttribute:this.noteAttribute}),this.$noteContentWrap.html(this.noteEditor.$el)},e.prototype.listen=function(){return this.listenTo(this.objectModel,"change:"+this.noteAttribute,this.refreshView),this.listenTo(this.projectModel,"change:applications",function(){if(this.projectModel.isAppChanged("markdown"))return this.refreshView()}),this},e.prototype.refreshView=function(){var t;return this.$el.removeClass("editing"),t=this.objectModel.toJSON(),"note"!==this.noteAttribute&&(t.note=t[this.noteAttribute]),t.note?(this.$(".note-adder-set").addClass("hide"),this.$noteWrap.removeClass("hide")):(this.$(".note-adder-set").removeClass("hide"),this.$noteWrap.addClass("hide")),this.note=t.note,this.mdSupport=this.projectModel.isAppEnabled("markdown")?"md":null,this.htmlString=window._encodeHTML(this.note,"md",{sanitize:!1}),this.$(".note-text").html(this.htmlString),l.delay(function(t){return function(){var e;return e=t.$noteTextSet.height(),t.$noteContainer[e>170?"addClass":"removeClass"]("note-height-control note-padding"),t.$(".note-button")[e>170?"removeClass":"addClass"]("hide"),t.$(".show-all-handler").removeClass("hide"),t.$(".collapse-all-handler").addClass("hide")}}(this)),this},e.prototype.enterNoteEdit=function(t){var e,i,n;if(!$(t.target).attr("href")){try{n=window.getSelection().toString()}catch(i){t=i}return this.objectModel.get("isArchived")?this:(!this.$el.hasClass("editing")&&this.hasPermission()&&(this.$el.addClass("editing"),this.$el[this.objectModel.getMemCache()?"addClass":"removeClass"]("has-draft"),this.renderNoteEditor(),e=this.parentView.parentView.$el,e.find(".detail-content").trigger("scroll")),this)}},e.prototype.toggleNoteStatus=function(t){if(this.$toggleNoteHandler.toggleClass("hide"),this.$noteContainer.toggleClass("note-height-control"),p.gta.event({action:(this.$noteContainer.hasClass("note-height-control")?"collapse":"expand")+" full note"}),!this.$(".note-button").hasClass("hide"))return this.$noteContainer[this.$(".show-all-handler").hasClass("hide")?"addClass":"removeClass"]("note-padding")},e.prototype.isCase=function(){var t;return t=this.objectModel.toJSON(),!!t[this.noteAttribute]},e.prototype.hasPermission=function(){return this.objectModel.hasPermission("task.put.note")||this.objectModel.hasPermission("event.put.content")},e}(c)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j=function(t,e){function i(){this.constructor=t}for(var n in e)T.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},T={}.hasOwnProperty;y=i(358),m=i(788),_=i(678),h=i(677),l=i(449),p=i(1139),d=i(1141),u=i(681),v=i(810),f=i(792),g=i(924),o=i(1126),r=i(1150),c=i(1151),n=$(window),k=u.namespace("temp").namespace("user_edit_habit"),s=10,w=i(1152),b={tabIndent:!1,toolbarFloat:!1,markdown:!1,toolbar:["title","bold","italic","upload","link","ol","ul","blockquote","hr","table","markdown"]},t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return j(e,t),e.prototype.viewName="NoteEditorView",e.prototype.className="note-editor",e.prototype.tagName="section",e.prototype.events={"mousedown .save-note-handler":"onSave","mousedown .cancel-note-handler":"onCancel","mousedown .restore-draft":"restoreDraftNote","mousedown .discard-draft":"discardDraftNote","mousedown .editor-switcher-container":"toggleEditorMode","mousedown .editor-switcher-handler:not(.selected)":"changeMode"},e.prototype.initialize=function(t){return this.options=t,this.projectModel=t.projectModel,this.objectModel=t.objectModel,this.localCacheId=_.user.id,this.attachments=new v,this.mdSupport=this.options.mdSupport,this.objectType=this.options.noteAttribute,this.type=k(this.localCacheId)||"html",this.renderBasic(),this.initSimditor(),this.initUploader(),this.listen()},e.prototype.listen=function(){return this.editor.off(".note-editor"),this.editor.on("uploadclick.note-editor",function(t){return function(e){return $("body").hasClass("firefox")?(t.$(".toolbar-item-upload").attr("id","uploader-button"),t.$("#uploader-button").off("click"),t.$("#uploader-button").click(function(){return t.$(".fake-upload-container input").trigger("click")})):t.triggerUploadImages(e)}}(this)),this.editor.on("blur",function(t){return function(){return t.blurNote()}}(this)),this.$markdownEditorContainer.on("blur",function(t){return function(){return t.blurNote()}}(this)),c.on("noteEditorToolBarScroll",function(t){return function(e){return t.pinBarHandler(e)}}(this))},e.prototype.renderBasic=function(){var t;return t=this.getModeTitle(this.type),this.$el.html(r({modeTitle:t,mdSupport:this.options.mdSupport})),this.$textarea=this.$(".note-input"),this.editorTitle=this.$(".editor-name"),this.$editorSwitchContainer=this.$(".editor-switcher-container"),this.$(".editor-switcher-handler[data-mode="+this.type+"]").addClass("selected")},e.prototype.pinBarHandler=function(t){var e,i;if(this.$el&&"html"===this.type)return i=this.$el.parents(".note-input-set").position().top+s,e=this.$(".editor-content-wrap").height(),t[i<=0?"addClass":"removeClass"]("pin-toolbar"),e+i<=0?t.removeClass("pin-toolbar"):void 0},e.prototype.getModeTitle=function(t){var e;switch(t){case"md":e=tb_i18n.get("markdown.helper.title");break;default:e=tb_i18n.get("editor.mode.html")}return e},e.prototype.initSimditor=function(){var t;if(w.setup(),t=y.extend(b,this.options,{textarea:this.$textarea[0]}),this.editor=new l(t),this.markdownButton=y.find(this.editor.toolbar.buttons,function(t){return t instanceof p}),this.$markdownEditorContainer=this.editor.el.find(".markdown-editor textarea"),this.editor.setValue(this.options.content),this.editor.body.addClass("readable"),y.delay(function(t){return function(){return t.editor.focus()}}(this)),"md"===this.type)return this.markdownButton.command(),this.$(".simditor-toolbar-wrap").addClass("hide"),y.delay(function(t){return function(){return t.markdownButton._autosizeTextarea()}}(this))},e.prototype.initUploader=function(){var t,e,i;if(!this._initedUploader)return this._initedUploader=!0,null!=(e=this.workuploaderView)&&e.remove(),t={projectModel:this.projectModel,collection:this.attachments,pick:{id:this.$(".fake-upload-container"),multiple:!0},dnd:this.$(".simditor-body"),accept:{title:"Images",extensions:"gif,jpg,jpeg,bmp,png",mimeTypes:"image/*"},duplicate:!0,fileSingleSizeLimit:this.projectModel.getPaymentPlan().fileSizeLimit,onComplete:function(t){return function(e){var i;return i=new f(e),t.insertImage(i),t.$(".simditor-body").find("img.loading").eq(0).prev("img").remove()}}(this)},this.workuploaderView=this.requestSubView(g,t),i=this.workuploaderView.uploader.uploader,i.on("beforeFileQueued",function(t){return function(){var e;return e=tb_i18n.get("uploading.tip"),t.insertImage(null,e)}}(this)),this},e.prototype.toggleEditorMode=function(){return this.toggleModeFlag=!0},e.prototype.changeMode=function(t){var e,i,n,r;return i=$(t.currentTarget),this.$(".editor-switcher-handler").removeClass("selected"),
i.addClass("selected"),r=i.data("mode"),this.$(".simditor-toolbar-wrap").toggleClass("hide"),k(this.localCacheId,r),this.type=r,n=this.getModeTitle(r),this.editorTitle.html(n),this.markdownButton.command(),this.editor.trigger("valuechanged"),this.$(".dropdown-menu").toggleClass("open"),e=this.parentView.parentView.parentView.$el,e.find(".detail-content").trigger("scroll"),this.toggleModeFlag=!1,this},e.prototype.parseNote=function(t){var e,i;return"html"===this.type?(i=this.formatNote(this.type),i=d(t,{gfm:!0,converters:[{filter:"br",replacement:function(t,e){switch(!1){case!(e.parentNode instanceof window.HTMLBodyElement):return"<br>";case!(e.parentNode instanceof window.HTMLTableCellElement):return"";case!(e.parentNode instanceof window.HTMLParagraphElement):return 1===e.parentNode.childNodes.length?"<br>":"  \n";default:return"\n"}}}]}),e=$("<div>"+i+"</div>"),e.find("colgroup").remove(),e.html().replace(/^\n/,"")):t},e.prototype.updateNote=function(){var t,e,i,n,r,s;return this.objectModel.getRoleScope()>=0?(i=this.getCurrentModeData(),s=this.parseNote(i),n=this.objectModel.get(this.objectType),s!==n?(t={},t[this.objectType]=s,this.disableSubmit(),("function"==typeof(e=this.objectModel).isRecurrenceEventInstance?e.isRecurrenceEventInstance():void 0)?o.saveAttrs(this.objectModel,t)["catch"](this.enableSubmit):(r={attrs:t,error:this.enableSubmit},this.objectModel.save(null,r))):this.exitNoteEdit(),this):this},e.prototype.disableSubmit=function(){return this.$(".save-note-handler").addClass("disabled")},e.prototype.enableSubmit=function(){return this.$(".save-note-handler").removeClass("disabled")},e.prototype.exitNoteEdit=function(){var t;return t=this.objectModel.get(this.objectType),this.parentView.$el.removeClass("editing"),this},e.prototype.blurNote=function(){var t,e,i;if(!this.toggleModeFlag)return i=this.objectModel.get(this.objectType),e=this.getCurrentModeData(),t=this.parseNote(e),h.unifyNewline(t)!==h.unifyNewline(i)&&this.objectModel.setMemCache({note:t}),this},e.prototype.restoreDraftNote=function(t){var e;return t.preventDefault(),e=this.objectModel.getMemCache("note"),this.setCurrentModeData(e),this.objectModel.clearMemCache(),this.parentView.$el.removeClass("has-draft"),!1},e.prototype.discardDraftNote=function(t){return t.preventDefault(),this.objectModel.clearMemCache(),this.parentView.$el.removeClass("has-draft"),!1},e.prototype.onSave=function(t){return t.preventDefault(),this.updateNote(),this.objectModel.clearMemCache(),!1},e.prototype.onCancel=function(t){return t.preventDefault(),this.exitNoteEdit(),this.objectModel.clearMemCache(),!1},e.prototype.triggerUploadImages=function(t){return t.preventDefault(),this.$(".fake-upload-container").find("input").click()},e.prototype.insertImage=function(t,e){var i,n,r;return r=this.getPreviewUrl(t)||null,i=this.editor.toolbar.findButton("upload"),n=e||t.get("fileName"),i.insertImage(r,n),this},e.prototype.getPreviewUrl=function(t){var e,i,n,r,o;if(t)return r=t.get("thumbnailUrl")||"",o=t.get("imageWidth"),e=t.get("imageHeight"),n=o<400?200:o<600?400:o<800?600:800,i=Math.ceil(n*e/o),r=r.replace("w/200/h/200","w/"+n+"/h/"+i)},e.prototype.formatNote=function(t,e){var i;switch(i=e||this.type){case"html":return window._encodeHTML(t,"md",{sanitize:!1,breaks:!0}).replace(/\n$/,"");case"md":return t}},e.prototype.getCurrentModeData=function(){var t,e;switch(e=this.type){case"html":return this.formatNote(this.editor.getValue());case"md":return t=$(".markdown-editor textarea").val().trim(),this.formatNote(t)}},e.prototype.setCurrentModeData=function(t){var e;switch(e=this.type){case"html":return t=this.formatNote(t,"html"),this.editor.setValue(t);case"md":return $(".markdown-editor textarea").val(t),this.editor.setValue(this.formatNote(t,"html"))}},e.prototype.remove=function(){return n.off("resize.note-editor"),this.$el.off(),this.editor.destroy(),e.__super__.remove.apply(this,arguments)},e}(m)},function(t,e,i){var n,r;!function(o,s){n=[i(1140),i(449),i(1141),i(1149)],r=function(t,e,i,n){return o.SimditorMarkdown=s(t,e,i,n)}.apply(e,n),!(void 0!==r&&(t.exports=r))}(this,function(t,e,i,n){var r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;return r=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return o(r,e),r.prototype.name="markdown",r.prototype.icon="markdown",r.prototype.needFocus=!1,r.prototype._init=function(){if(r.__super__._init.call(this),this.markdownEl=t('<div class="markdown-editor" />').insertBefore(this.editor.body),this.textarea=t("<textarea/>").attr("placeholder",this.editor.opts.placeholder).appendTo(this.markdownEl),this.textarea.on("focus",function(t){return function(e){return t.editor.el.addClass("focus")}}(this)).on("blur",function(t){return function(e){return t.editor.el.removeClass("focus")}}(this)),this.editor.on("valuechanged",function(t){return function(e){if(t.editor.markdownMode)return t._initMarkdownValue()}}(this)),this.markdownChange=this.editor.util.throttle(function(t){return function(){return t._autosizeTextarea(),t._convert()}}(this),200),this.editor.util.support.oninput?this.textarea.on("input",function(t){return function(e){return t.markdownChange()}}(this)):this.textarea.on("keyup",function(t){return function(e){return t.markdownChange()}}(this)),this.editor.opts.markdown)return this.editor.on("initialized",function(t){return function(){return t.el.mousedown()}}(this))},r.prototype.status=function(){},r.prototype.command=function(){var t,e,i,n;for(this.editor.blur(),this.editor.el.toggleClass("simditor-markdown"),this.editor.markdownMode=this.editor.el.hasClass("simditor-markdown"),this.editor.markdownMode?(this.editor.inputManager.lastCaretPosition=null,this.editor.hidePopover(),this.editor.body.removeAttr("contenteditable"),this._initMarkdownValue()):(this.textarea.val(""),this.editor.body.attr("contenteditable","true")),n=this.editor.toolbar.buttons,e=0,i=n.length;e<i;e++)t=n[e],"markdown"===t.name?t.setActive(this.editor.markdownMode):t.setDisabled(this.editor.markdownMode);return null},r.prototype._initMarkdownValue=function(){return this._fileterUnsupportedTags(),this.textarea.val(i(this.editor.getValue(),{gfm:!0,converters:[{filter:"br",replacement:function(t,e){switch(!1){case!(e.parentNode instanceof window.HTMLBodyElement):return"<br>";case!(e.parentNode instanceof window.HTMLTableCellElement):return"";case!(e.parentNode instanceof window.HTMLParagraphElement):return 1===e.parentNode.childNodes.length?"<br>":"  \n";default:return"\n"}}}]})),this._autosizeTextarea()},r.prototype._autosizeTextarea=function(){return this._textareaPadding||(this._textareaPadding=this.textarea.innerHeight()-this.textarea.height()),this.textarea.height(this.textarea[0].scrollHeight-this._textareaPadding)},r.prototype._convert=function(){var t,e;return e=this.textarea.val(),t=n(e).replace(/<em>/g,"<i>").replace(/<\/em>/g,"</i>"),this.editor.textarea.val(t),this.editor.body.html(t),this.editor.formatter.format(),this.editor.formatter.decorate()},r.prototype._fileterUnsupportedTags=function(){return this.editor.body.find("colgroup").remove()},r}(e.Button),e.Toolbar.addButton(r),r})},function(t,e,i){var n,r;/*!
	 * jQuery JavaScript Library v2.1.4
	 * http://jquery.com/
	 *
	 * Includes Sizzle.js
	 * http://sizzlejs.com/
	 *
	 * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors
	 * Released under the MIT license
	 * http://jquery.org/license
	 *
	 * Date: 2015-04-28T16:01Z
	 */
!function(e,i){"object"==typeof t&&"object"==typeof t.exports?t.exports=e.document?i(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return i(t)}:i(e)}("undefined"!=typeof window?window:this,function(i,o){function s(t){var e="length"in t&&t.length,i=nt.type(t);return"function"!==i&&!nt.isWindow(t)&&(!(1!==t.nodeType||!e)||("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t))}function a(t,e,i){if(nt.isFunction(e))return nt.grep(t,function(t,n){return!!e.call(t,n,t)!==i});if(e.nodeType)return nt.grep(t,function(t){return t===e!==i});if("string"==typeof e){if(ut.test(e))return nt.filter(e,t,i);e=nt.filter(e,t)}return nt.grep(t,function(t){return K.call(e,t)>=0!==i})}function c(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function l(t){var e=yt[t]={};return nt.each(t.match(vt)||[],function(t,i){e[i]=!0}),e}function p(){et.removeEventListener("DOMContentLoaded",p,!1),i.removeEventListener("load",p,!1),nt.ready()}function u(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=nt.expando+u.uid++}function d(t,e,i){var n;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(Tt,"-$1").toLowerCase(),i=t.getAttribute(n),"string"==typeof i){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:jt.test(i)?nt.parseJSON(i):i)}catch(r){}_t.set(t,e,i)}else i=void 0;return i}function h(){return!0}function m(){return!1}function f(){try{return et.activeElement}catch(t){}}function g(t,e){return nt.nodeName(t,"table")&&nt.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function v(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function y(t){var e=Rt.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function b(t,e){for(var i=0,n=t.length;i<n;i++)wt.set(t[i],"globalEval",!e||wt.get(e[i],"globalEval"))}function k(t,e){var i,n,r,o,s,a,c,l;if(1===e.nodeType){if(wt.hasData(t)&&(o=wt.access(t),s=wt.set(e,o),l=o.events)){delete s.handle,s.events={};for(r in l)for(i=0,n=l[r].length;i<n;i++)nt.event.add(e,r,l[r][i])}_t.hasData(t)&&(a=_t.access(t),c=nt.extend({},a),_t.set(e,c))}}function w(t,e){var i=t.getElementsByTagName?t.getElementsByTagName(e||"*"):t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&nt.nodeName(t,e)?nt.merge([t],i):i}function _(t,e){var i=e.nodeName.toLowerCase();"input"===i&&$t.test(t.type)?e.checked=t.checked:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}function j(t,e){var n,r=nt(e.createElement(t)).appendTo(e.body),o=i.getDefaultComputedStyle&&(n=i.getDefaultComputedStyle(r[0]))?n.display:nt.css(r[0],"display");return r.detach(),o}function T(t){var e=et,i=Bt[t];return i||(i=j(t,e),"none"!==i&&i||(Ht=(Ht||nt("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement),e=Ht[0].contentDocument,e.write(),e.close(),i=j(t,e),Ht.detach()),Bt[t]=i),i}function M(t,e,i){var n,r,o,s,a=t.style;return i=i||Jt(t),i&&(s=i.getPropertyValue(e)||i[e]),i&&(""!==s||nt.contains(t.ownerDocument,t)||(s=nt.style(t,e)),Wt.test(s)&&Ut.test(e)&&(n=a.width,r=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=i.width,a.width=n,a.minWidth=r,a.maxWidth=o)),void 0!==s?s+"":s}function C(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function x(t,e){if(e in t)return e;for(var i=e[0].toUpperCase()+e.slice(1),n=e,r=Zt.length;r--;)if(e=Zt[r]+i,e in t)return e;return n}function $(t,e,i){var n=Yt.exec(e);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):e}function S(t,e,i,n,r){for(var o=i===(n?"border":"content")?4:"width"===e?1:0,s=0;o<4;o+=2)"margin"===i&&(s+=nt.css(t,i+Ct[o],!0,r)),n?("content"===i&&(s-=nt.css(t,"padding"+Ct[o],!0,r)),"margin"!==i&&(s-=nt.css(t,"border"+Ct[o]+"Width",!0,r))):(s+=nt.css(t,"padding"+Ct[o],!0,r),"padding"!==i&&(s+=nt.css(t,"border"+Ct[o]+"Width",!0,r)));return s}function I(t,e,i){var n=!0,r="width"===e?t.offsetWidth:t.offsetHeight,o=Jt(t),s="border-box"===nt.css(t,"boxSizing",!1,o);if(r<=0||null==r){if(r=M(t,e,o),(r<0||null==r)&&(r=t.style[e]),Wt.test(r))return r;n=s&&(tt.boxSizingReliable()||r===t.style[e]),r=parseFloat(r)||0}return r+S(t,e,i||(s?"border":"content"),n,o)+"px"}function z(t,e){for(var i,n,r,o=[],s=0,a=t.length;s<a;s++)n=t[s],n.style&&(o[s]=wt.get(n,"olddisplay"),i=n.style.display,e?(o[s]||"none"!==i||(n.style.display=""),""===n.style.display&&xt(n)&&(o[s]=wt.access(n,"olddisplay",T(n.nodeName)))):(r=xt(n),"none"===i&&r||wt.set(n,"olddisplay",r?i:nt.css(n,"display"))));for(s=0;s<a;s++)n=t[s],n.style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?o[s]||"":"none"));return t}function P(t,e,i,n,r){return new P.prototype.init(t,e,i,n,r)}function D(){return setTimeout(function(){te=void 0}),te=nt.now()}function O(t,e){var i,n=0,r={height:t};for(e=e?1:0;n<4;n+=2-e)i=Ct[n],r["margin"+i]=r["padding"+i]=t;return e&&(r.opacity=r.width=t),r}function N(t,e,i){for(var n,r=(se[e]||[]).concat(se["*"]),o=0,s=r.length;o<s;o++)if(n=r[o].call(i,e,t))return n}function E(t,e,i){var n,r,o,s,a,c,l,p,u=this,d={},h=t.style,m=t.nodeType&&xt(t),f=wt.get(t,"fxshow");i.queue||(a=nt._queueHooks(t,"fx"),null==a.unqueued&&(a.unqueued=0,c=a.empty.fire,a.empty.fire=function(){a.unqueued||c()}),a.unqueued++,u.always(function(){u.always(function(){a.unqueued--,nt.queue(t,"fx").length||a.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[h.overflow,h.overflowX,h.overflowY],l=nt.css(t,"display"),p="none"===l?wt.get(t,"olddisplay")||T(t.nodeName):l,"inline"===p&&"none"===nt.css(t,"float")&&(h.display="inline-block")),i.overflow&&(h.overflow="hidden",u.always(function(){h.overflow=i.overflow[0],h.overflowX=i.overflow[1],h.overflowY=i.overflow[2]}));for(n in e)if(r=e[n],ie.exec(r)){if(delete e[n],o=o||"toggle"===r,r===(m?"hide":"show")){if("show"!==r||!f||void 0===f[n])continue;m=!0}d[n]=f&&f[n]||nt.style(t,n)}else l=void 0;if(nt.isEmptyObject(d))"inline"===("none"===l?T(t.nodeName):l)&&(h.display=l);else{f?"hidden"in f&&(m=f.hidden):f=wt.access(t,"fxshow",{}),o&&(f.hidden=!m),m?nt(t).show():u.done(function(){nt(t).hide()}),u.done(function(){var e;wt.remove(t,"fxshow");for(e in d)nt.style(t,e,d[e])});for(n in d)s=N(m?f[n]:0,n,u),n in f||(f[n]=s.start,m&&(s.end=s.start,s.start="width"===n||"height"===n?1:0))}}function A(t,e){var i,n,r,o,s;for(i in t)if(n=nt.camelCase(i),r=e[n],o=t[i],nt.isArray(o)&&(r=o[1],o=t[i]=o[0]),i!==n&&(t[n]=o,delete t[i]),s=nt.cssHooks[n],s&&"expand"in s){o=s.expand(o),delete t[n];for(i in o)i in t||(t[i]=o[i],e[i]=r)}else e[n]=r}function L(t,e,i){var n,r,o=0,s=oe.length,a=nt.Deferred().always(function(){delete c.elem}),c=function(){if(r)return!1;for(var e=te||D(),i=Math.max(0,l.startTime+l.duration-e),n=i/l.duration||0,o=1-n,s=0,c=l.tweens.length;s<c;s++)l.tweens[s].run(o);return a.notifyWith(t,[l,o,i]),o<1&&c?i:(a.resolveWith(t,[l]),!1)},l=a.promise({elem:t,props:nt.extend({},e),opts:nt.extend(!0,{specialEasing:{}},i),originalProperties:e,originalOptions:i,startTime:te||D(),duration:i.duration,tweens:[],createTween:function(e,i){var n=nt.Tween(t,l.opts,e,i,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var i=0,n=e?l.tweens.length:0;if(r)return this;for(r=!0;i<n;i++)l.tweens[i].run(1);return e?a.resolveWith(t,[l,e]):a.rejectWith(t,[l,e]),this}}),p=l.props;for(A(p,l.opts.specialEasing);o<s;o++)if(n=oe[o].call(l,t,p,l.opts))return n;return nt.map(p,N,l),nt.isFunction(l.opts.start)&&l.opts.start.call(t,l),nt.fx.timer(nt.extend(c,{elem:t,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function V(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,r=0,o=e.toLowerCase().match(vt)||[];if(nt.isFunction(i))for(;n=o[r++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function R(t,e,i,n){function r(a){var c;return o[a]=!0,nt.each(t[a]||[],function(t,a){var l=a(e,i,n);return"string"!=typeof l||s||o[l]?s?!(c=l):void 0:(e.dataTypes.unshift(l),r(l),!1)}),c}var o={},s=t===je;return r(e.dataTypes[0])||!o["*"]&&r("*")}function F(t,e){var i,n,r=nt.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((r[i]?t:n||(n={}))[i]=e[i]);return n&&nt.extend(!0,t,n),t}function q(t,e,i){for(var n,r,o,s,a=t.contents,c=t.dataTypes;"*"===c[0];)c.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(r in a)if(a[r]&&a[r].test(n)){c.unshift(r);break}if(c[0]in i)o=c[0];else{for(r in i){if(!c[0]||t.converters[r+" "+c[0]]){o=r;break}s||(s=r)}o=o||s}if(o)return o!==c[0]&&c.unshift(o),i[o]}function H(t,e,i,n){var r,o,s,a,c,l={},p=t.dataTypes.slice();if(p[1])for(s in t.converters)l[s.toLowerCase()]=t.converters[s];for(o=p.shift();o;)if(t.responseFields[o]&&(i[t.responseFields[o]]=e),!c&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),c=o,o=p.shift())if("*"===o)o=c;else if("*"!==c&&c!==o){if(s=l[c+" "+o]||l["* "+o],!s)for(r in l)if(a=r.split(" "),a[1]===o&&(s=l[c+" "+a[0]]||l["* "+a[0]])){s===!0?s=l[r]:l[r]!==!0&&(o=a[0],p.unshift(a[1]));break}if(s!==!0)if(s&&t["throws"])e=s(e);else try{e=s(e)}catch(u){return{state:"parsererror",error:s?u:"No conversion from "+c+" to "+o}}}return{state:"success",data:e}}function B(t,e,i,n){var r;if(nt.isArray(e))nt.each(e,function(e,r){i||$e.test(t)?n(t,r):B(t+"["+("object"==typeof r?e:"")+"]",r,i,n)});else if(i||"object"!==nt.type(e))n(t,e);else for(r in e)B(t+"["+r+"]",e[r],i,n)}function U(t){return nt.isWindow(t)?t:9===t.nodeType&&t.defaultView}var W=[],J=W.slice,G=W.concat,Y=W.push,K=W.indexOf,X={},Q=X.toString,Z=X.hasOwnProperty,tt={},et=i.document,it="2.1.4",nt=function(t,e){return new nt.fn.init(t,e)},rt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ot=/^-ms-/,st=/-([\da-z])/gi,at=function(t,e){return e.toUpperCase()};nt.fn=nt.prototype={jquery:it,constructor:nt,selector:"",length:0,toArray:function(){return J.call(this)},get:function(t){return null!=t?t<0?this[t+this.length]:this[t]:J.call(this)},pushStack:function(t){var e=nt.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return nt.each(this,t,e)},map:function(t){return this.pushStack(nt.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return this.pushStack(J.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(i>=0&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:Y,sort:W.sort,splice:W.splice},nt.extend=nt.fn.extend=function(){var t,e,i,n,r,o,s=arguments[0]||{},a=1,c=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[a]||{},a++),"object"==typeof s||nt.isFunction(s)||(s={}),a===c&&(s=this,a--);a<c;a++)if(null!=(t=arguments[a]))for(e in t)i=s[e],n=t[e],s!==n&&(l&&n&&(nt.isPlainObject(n)||(r=nt.isArray(n)))?(r?(r=!1,o=i&&nt.isArray(i)?i:[]):o=i&&nt.isPlainObject(i)?i:{},s[e]=nt.extend(l,o,n)):void 0!==n&&(s[e]=n));return s},nt.extend({expando:"jQuery"+(it+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===nt.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){return!nt.isArray(t)&&t-parseFloat(t)+1>=0},isPlainObject:function(t){return"object"===nt.type(t)&&!t.nodeType&&!nt.isWindow(t)&&!(t.constructor&&!Z.call(t.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?X[Q.call(t)]||"object":typeof t},globalEval:function(t){var e,i=eval;t=nt.trim(t),t&&(1===t.indexOf("use strict")?(e=et.createElement("script"),e.text=t,et.head.appendChild(e).parentNode.removeChild(e)):i(t))},camelCase:function(t){return t.replace(ot,"ms-").replace(st,at)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,i){var n,r=0,o=t.length,a=s(t);if(i){if(a)for(;r<o&&(n=e.apply(t[r],i),n!==!1);r++);else for(r in t)if(n=e.apply(t[r],i),n===!1)break}else if(a)for(;r<o&&(n=e.call(t[r],r,t[r]),n!==!1);r++);else for(r in t)if(n=e.call(t[r],r,t[r]),n===!1)break;return t},trim:function(t){return null==t?"":(t+"").replace(rt,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(s(Object(t))?nt.merge(i,"string"==typeof t?[t]:t):Y.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:K.call(e,t,i)},merge:function(t,e){for(var i=+e.length,n=0,r=t.length;n<i;n++)t[r++]=e[n];return t.length=r,t},grep:function(t,e,i){for(var n,r=[],o=0,s=t.length,a=!i;o<s;o++)n=!e(t[o],o),n!==a&&r.push(t[o]);return r},map:function(t,e,i){var n,r=0,o=t.length,a=s(t),c=[];if(a)for(;r<o;r++)n=e(t[r],r,i),null!=n&&c.push(n);else for(r in t)n=e(t[r],r,i),null!=n&&c.push(n);return G.apply([],c)},guid:1,proxy:function(t,e){var i,n,r;if("string"==typeof e&&(i=t[e],e=t,t=i),nt.isFunction(t))return n=J.call(arguments,2),r=function(){return t.apply(e||this,n.concat(J.call(arguments)))},r.guid=t.guid=t.guid||nt.guid++,r},now:Date.now,support:tt}),nt.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){X["[object "+e+"]"]=e.toLowerCase()});var ct=/*!
	 * Sizzle CSS Selector Engine v2.2.0-pre
	 * http://sizzlejs.com/
	 *
	 * Copyright 2008, 2014 jQuery Foundation, Inc. and other contributors
	 * Released under the MIT license
	 * http://jquery.org/license
	 *
	 * Date: 2014-12-16
	 */
function(t){function e(t,e,i,n){var r,o,s,a,c,l,u,h,m,f;if((e?e.ownerDocument||e:R)!==P&&z(e),e=e||P,i=i||[],a=e.nodeType,"string"!=typeof t||!t||1!==a&&9!==a&&11!==a)return i;if(!n&&O){if(11!==a&&(r=yt.exec(t)))if(s=r[1]){if(9===a){if(o=e.getElementById(s),!o||!o.parentNode)return i;if(o.id===s)return i.push(o),i}else if(e.ownerDocument&&(o=e.ownerDocument.getElementById(s))&&L(e,o)&&o.id===s)return i.push(o),i}else{if(r[2])return Q.apply(i,e.getElementsByTagName(t)),i;if((s=r[3])&&w.getElementsByClassName)return Q.apply(i,e.getElementsByClassName(s)),i}if(w.qsa&&(!N||!N.test(t))){if(h=u=V,m=e,f=1!==a&&t,1===a&&"object"!==e.nodeName.toLowerCase()){for(l=M(t),(u=e.getAttribute("id"))?h=u.replace(kt,"\\$&"):e.setAttribute("id",h),h="[id='"+h+"'] ",c=l.length;c--;)l[c]=h+d(l[c]);m=bt.test(t)&&p(e.parentNode)||e,f=l.join(",")}if(f)try{return Q.apply(i,m.querySelectorAll(f)),i}catch(g){}finally{u||e.removeAttribute("id")}}}return x(t.replace(ct,"$1"),e,i,n)}function i(){function t(i,n){return e.push(i+" ")>_.cacheLength&&delete t[e.shift()],t[i+" "]=n}var e=[];return t}function n(t){return t[V]=!0,t}function r(t){var e=P.createElement("div");try{return!!t(e)}catch(i){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function o(t,e){for(var i=t.split("|"),n=t.length;n--;)_.attrHandle[i[n]]=e}function s(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||J)-(~t.sourceIndex||J);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function a(t){return function(e){var i=e.nodeName.toLowerCase();return"input"===i&&e.type===t}}function c(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function l(t){return n(function(e){return e=+e,n(function(i,n){for(var r,o=t([],i.length,e),s=o.length;s--;)i[r=o[s]]&&(i[r]=!(n[r]=i[r]))})})}function p(t){return t&&"undefined"!=typeof t.getElementsByTagName&&t}function u(){}function d(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function h(t,e,i){var n=e.dir,r=i&&"parentNode"===n,o=q++;return e.first?function(e,i,o){for(;e=e[n];)if(1===e.nodeType||r)return t(e,i,o)}:function(e,i,s){var a,c,l=[F,o];if(s){for(;e=e[n];)if((1===e.nodeType||r)&&t(e,i,s))return!0}else for(;e=e[n];)if(1===e.nodeType||r){if(c=e[V]||(e[V]={}),(a=c[n])&&a[0]===F&&a[1]===o)return l[2]=a[2];if(c[n]=l,l[2]=t(e,i,s))return!0}}}function m(t){return t.length>1?function(e,i,n){for(var r=t.length;r--;)if(!t[r](e,i,n))return!1;return!0}:t[0]}function f(t,i,n){for(var r=0,o=i.length;r<o;r++)e(t,i[r],n);return n}function g(t,e,i,n,r){for(var o,s=[],a=0,c=t.length,l=null!=e;a<c;a++)(o=t[a])&&(i&&!i(o,n,r)||(s.push(o),l&&e.push(a)));return s}function v(t,e,i,r,o,s){return r&&!r[V]&&(r=v(r)),o&&!o[V]&&(o=v(o,s)),n(function(n,s,a,c){var l,p,u,d=[],h=[],m=s.length,v=n||f(e||"*",a.nodeType?[a]:a,[]),y=!t||!n&&e?v:g(v,d,t,a,c),b=i?o||(n?t:m||r)?[]:s:y;if(i&&i(y,b,a,c),r)for(l=g(b,h),r(l,[],a,c),p=l.length;p--;)(u=l[p])&&(b[h[p]]=!(y[h[p]]=u));if(n){if(o||t){if(o){for(l=[],p=b.length;p--;)(u=b[p])&&l.push(y[p]=u);o(null,b=[],l,c)}for(p=b.length;p--;)(u=b[p])&&(l=o?tt(n,u):d[p])>-1&&(n[l]=!(s[l]=u))}}else b=g(b===s?b.splice(m,b.length):b),o?o(null,s,b,c):Q.apply(s,b)})}function y(t){for(var e,i,n,r=t.length,o=_.relative[t[0].type],s=o||_.relative[" "],a=o?1:0,c=h(function(t){return t===e},s,!0),l=h(function(t){return tt(e,t)>-1},s,!0),p=[function(t,i,n){var r=!o&&(n||i!==$)||((e=i).nodeType?c(t,i,n):l(t,i,n));return e=null,r}];a<r;a++)if(i=_.relative[t[a].type])p=[h(m(p),i)];else{if(i=_.filter[t[a].type].apply(null,t[a].matches),i[V]){for(n=++a;n<r&&!_.relative[t[n].type];n++);return v(a>1&&m(p),a>1&&d(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(ct,"$1"),i,a<n&&y(t.slice(a,n)),n<r&&y(t=t.slice(n)),n<r&&d(t))}p.push(i)}return m(p)}function b(t,i){var r=i.length>0,o=t.length>0,s=function(n,s,a,c,l){var p,u,d,h=0,m="0",f=n&&[],v=[],y=$,b=n||o&&_.find.TAG("*",l),k=F+=null==y?1:Math.random()||.1,w=b.length;for(l&&($=s!==P&&s);m!==w&&null!=(p=b[m]);m++){if(o&&p){for(u=0;d=t[u++];)if(d(p,s,a)){c.push(p);break}l&&(F=k)}r&&((p=!d&&p)&&h--,n&&f.push(p))}if(h+=m,r&&m!==h){for(u=0;d=i[u++];)d(f,v,s,a);if(n){if(h>0)for(;m--;)f[m]||v[m]||(v[m]=K.call(c));v=g(v)}Q.apply(c,v),l&&!n&&v.length>0&&h+i.length>1&&e.uniqueSort(c)}return l&&(F=k,$=y),f};return r?n(s):s}var k,w,_,j,T,M,C,x,$,S,I,z,P,D,O,N,E,A,L,V="sizzle"+1*new Date,R=t.document,F=0,q=0,H=i(),B=i(),U=i(),W=function(t,e){return t===e&&(I=!0),0},J=1<<31,G={}.hasOwnProperty,Y=[],K=Y.pop,X=Y.push,Q=Y.push,Z=Y.slice,tt=function(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},et="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",it="[\\x20\\t\\r\\n\\f]",nt="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",rt=nt.replace("w","w#"),ot="\\["+it+"*("+nt+")(?:"+it+"*([*^$|!~]?=)"+it+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+rt+"))|)"+it+"*\\]",st=":("+nt+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ot+")*)|.*)\\)|)",at=new RegExp(it+"+","g"),ct=new RegExp("^"+it+"+|((?:^|[^\\\\])(?:\\\\.)*)"+it+"+$","g"),lt=new RegExp("^"+it+"*,"+it+"*"),pt=new RegExp("^"+it+"*([>+~]|"+it+")"+it+"*"),ut=new RegExp("="+it+"*([^\\]'\"]*?)"+it+"*\\]","g"),dt=new RegExp(st),ht=new RegExp("^"+rt+"$"),mt={ID:new RegExp("^#("+nt+")"),CLASS:new RegExp("^\\.("+nt+")"),TAG:new RegExp("^("+nt.replace("w","w*")+")"),ATTR:new RegExp("^"+ot),PSEUDO:new RegExp("^"+st),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+it+"*(even|odd|(([+-]|)(\\d*)n|)"+it+"*(?:([+-]|)"+it+"*(\\d+)|))"+it+"*\\)|)","i"),bool:new RegExp("^(?:"+et+")$","i"),needsContext:new RegExp("^"+it+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+it+"*((?:-\\d)?\\d*)"+it+"*\\)|)(?=[^-]|$)","i")},ft=/^(?:input|select|textarea|button)$/i,gt=/^h\d$/i,vt=/^[^{]+\{\s*\[native \w/,yt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,bt=/[+~]/,kt=/'|\\/g,wt=new RegExp("\\\\([\\da-f]{1,6}"+it+"?|("+it+")|.)","ig"),_t=function(t,e,i){var n="0x"+e-65536;return n!==n||i?e:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},jt=function(){z()};try{Q.apply(Y=Z.call(R.childNodes),R.childNodes),Y[R.childNodes.length].nodeType}catch(Tt){Q={apply:Y.length?function(t,e){X.apply(t,Z.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}w=e.support={},T=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},z=e.setDocument=function(t){var e,i,n=t?t.ownerDocument||t:R;return n!==P&&9===n.nodeType&&n.documentElement?(P=n,D=n.documentElement,i=n.defaultView,i&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",jt,!1):i.attachEvent&&i.attachEvent("onunload",jt)),O=!T(n),w.attributes=r(function(t){return t.className="i",!t.getAttribute("className")}),w.getElementsByTagName=r(function(t){return t.appendChild(n.createComment("")),!t.getElementsByTagName("*").length}),w.getElementsByClassName=vt.test(n.getElementsByClassName),w.getById=r(function(t){return D.appendChild(t).id=V,!n.getElementsByName||!n.getElementsByName(V).length}),w.getById?(_.find.ID=function(t,e){if("undefined"!=typeof e.getElementById&&O){var i=e.getElementById(t);return i&&i.parentNode?[i]:[]}},_.filter.ID=function(t){var e=t.replace(wt,_t);return function(t){return t.getAttribute("id")===e}}):(delete _.find.ID,_.filter.ID=function(t){var e=t.replace(wt,_t);return function(t){var i="undefined"!=typeof t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}}),_.find.TAG=w.getElementsByTagName?function(t,e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t):w.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;i=o[r++];)1===i.nodeType&&n.push(i);return n}return o},_.find.CLASS=w.getElementsByClassName&&function(t,e){if(O)return e.getElementsByClassName(t)},E=[],N=[],(w.qsa=vt.test(n.querySelectorAll))&&(r(function(t){D.appendChild(t).innerHTML="<a id='"+V+"'></a><select id='"+V+"-\f]' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&N.push("[*^$]="+it+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||N.push("\\["+it+"*(?:value|"+et+")"),t.querySelectorAll("[id~="+V+"-]").length||N.push("~="),t.querySelectorAll(":checked").length||N.push(":checked"),t.querySelectorAll("a#"+V+"+*").length||N.push(".#.+[+~]")}),r(function(t){var e=n.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&N.push("name"+it+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||N.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),N.push(",.*:")})),(w.matchesSelector=vt.test(A=D.matches||D.webkitMatchesSelector||D.mozMatchesSelector||D.oMatchesSelector||D.msMatchesSelector))&&r(function(t){w.disconnectedMatch=A.call(t,"div"),A.call(t,"[s!='']:x"),E.push("!=",st)}),N=N.length&&new RegExp(N.join("|")),E=E.length&&new RegExp(E.join("|")),e=vt.test(D.compareDocumentPosition),L=e||vt.test(D.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},W=e?function(t,e){if(t===e)return I=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i?i:(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&i||!w.sortDetached&&e.compareDocumentPosition(t)===i?t===n||t.ownerDocument===R&&L(R,t)?-1:e===n||e.ownerDocument===R&&L(R,e)?1:S?tt(S,t)-tt(S,e):0:4&i?-1:1)}:function(t,e){if(t===e)return I=!0,0;var i,r=0,o=t.parentNode,a=e.parentNode,c=[t],l=[e];if(!o||!a)return t===n?-1:e===n?1:o?-1:a?1:S?tt(S,t)-tt(S,e):0;if(o===a)return s(t,e);for(i=t;i=i.parentNode;)c.unshift(i);for(i=e;i=i.parentNode;)l.unshift(i);for(;c[r]===l[r];)r++;return r?s(c[r],l[r]):c[r]===R?-1:l[r]===R?1:0},n):P},e.matches=function(t,i){return e(t,null,null,i)},e.matchesSelector=function(t,i){if((t.ownerDocument||t)!==P&&z(t),i=i.replace(ut,"='$1']"),w.matchesSelector&&O&&(!E||!E.test(i))&&(!N||!N.test(i)))try{var n=A.call(t,i);if(n||w.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(r){}return e(i,P,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==P&&z(t),L(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==P&&z(t);var i=_.attrHandle[e.toLowerCase()],n=i&&G.call(_.attrHandle,e.toLowerCase())?i(t,e,!O):void 0;return void 0!==n?n:w.attributes||!O?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,i=[],n=0,r=0;if(I=!w.detectDuplicates,S=!w.sortStable&&t.slice(0),t.sort(W),I){for(;e=t[r++];)e===t[r]&&(n=i.push(r));for(;n--;)t.splice(i[n],1)}return S=null,t},j=e.getText=function(t){var e,i="",n=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=j(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[n++];)i+=j(e);return i},_=e.selectors={cacheLength:50,createPseudo:n,match:mt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(wt,_t),t[3]=(t[3]||t[4]||t[5]||"").replace(wt,_t),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return mt.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&dt.test(i)&&(e=M(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(wt,_t).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=H[t+" "];return e||(e=new RegExp("(^|"+it+")"+t+"("+it+"|$)"))&&H(t,function(t){return e.test("string"==typeof t.className&&t.className||"undefined"!=typeof t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,i,n){return function(r){var o=e.attr(r,t);return null==o?"!="===i:!i||(o+="","="===i?o===n:"!="===i?o!==n:"^="===i?n&&0===o.indexOf(n):"*="===i?n&&o.indexOf(n)>-1:"$="===i?n&&o.slice(-n.length)===n:"~="===i?(" "+o.replace(at," ")+" ").indexOf(n)>-1:"|="===i&&(o===n||o.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,i,n,r){var o="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===r?function(t){return!!t.parentNode}:function(e,i,c){var l,p,u,d,h,m,f=o!==s?"nextSibling":"previousSibling",g=e.parentNode,v=a&&e.nodeName.toLowerCase(),y=!c&&!a;if(g){if(o){for(;f;){for(u=e;u=u[f];)if(a?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;m=f="only"===t&&!m&&"nextSibling"}return!0}if(m=[s?g.firstChild:g.lastChild],s&&y){for(p=g[V]||(g[V]={}),l=p[t]||[],h=l[0]===F&&l[1],d=l[0]===F&&l[2],u=h&&g.childNodes[h];u=++h&&u&&u[f]||(d=h=0)||m.pop();)if(1===u.nodeType&&++d&&u===e){p[t]=[F,h,d];break}}else if(y&&(l=(e[V]||(e[V]={}))[t])&&l[0]===F)d=l[1];else for(;(u=++h&&u&&u[f]||(d=h=0)||m.pop())&&((a?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++d||(y&&((u[V]||(u[V]={}))[t]=[F,d]),u!==e)););return d-=r,d===n||d%n===0&&d/n>=0}}},PSEUDO:function(t,i){var r,o=_.pseudos[t]||_.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return o[V]?o(i):o.length>1?(r=[t,t,"",i],_.setFilters.hasOwnProperty(t.toLowerCase())?n(function(t,e){for(var n,r=o(t,i),s=r.length;s--;)n=tt(t,r[s]),t[n]=!(e[n]=r[s])}):function(t){return o(t,0,r)}):o}},pseudos:{not:n(function(t){var e=[],i=[],r=C(t.replace(ct,"$1"));return r[V]?n(function(t,e,i,n){for(var o,s=r(t,null,n,[]),a=t.length;a--;)(o=s[a])&&(t[a]=!(e[a]=o))}):function(t,n,o){return e[0]=t,r(e,null,o,i),e[0]=null,!i.pop()}}),has:n(function(t){return function(i){return e(t,i).length>0}}),contains:n(function(t){return t=t.replace(wt,_t),function(e){return(e.textContent||e.innerText||j(e)).indexOf(t)>-1}}),lang:n(function(t){return ht.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(wt,_t).toLowerCase(),function(e){var i;do if(i=O?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return i=i.toLowerCase(),i===t||0===i.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===D},focus:function(t){return t===P.activeElement&&(!P.hasFocus||P.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!_.pseudos.empty(t)},header:function(t){return gt.test(t.nodeName)},input:function(t){return ft.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:l(function(){return[0]}),last:l(function(t,e){return[e-1]}),eq:l(function(t,e,i){return[i<0?i+e:i]}),even:l(function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t}),odd:l(function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t}),lt:l(function(t,e,i){for(var n=i<0?i+e:i;--n>=0;)t.push(n);return t}),gt:l(function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t})}},_.pseudos.nth=_.pseudos.eq;for(k in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})_.pseudos[k]=a(k);for(k in{submit:!0,reset:!0})_.pseudos[k]=c(k);return u.prototype=_.filters=_.pseudos,_.setFilters=new u,M=e.tokenize=function(t,i){var n,r,o,s,a,c,l,p=B[t+" "];if(p)return i?0:p.slice(0);for(a=t,c=[],l=_.preFilter;a;){n&&!(r=lt.exec(a))||(r&&(a=a.slice(r[0].length)||a),c.push(o=[])),n=!1,(r=pt.exec(a))&&(n=r.shift(),o.push({value:n,type:r[0].replace(ct," ")}),a=a.slice(n.length));for(s in _.filter)!(r=mt[s].exec(a))||l[s]&&!(r=l[s](r))||(n=r.shift(),o.push({value:n,type:s,matches:r}),a=a.slice(n.length));if(!n)break}return i?a.length:a?e.error(t):B(t,c).slice(0)},C=e.compile=function(t,e){var i,n=[],r=[],o=U[t+" "];if(!o){for(e||(e=M(t)),i=e.length;i--;)o=y(e[i]),o[V]?n.push(o):r.push(o);o=U(t,b(r,n)),o.selector=t}return o},x=e.select=function(t,e,i,n){var r,o,s,a,c,l="function"==typeof t&&t,u=!n&&M(t=l.selector||t);if(i=i||[],1===u.length){if(o=u[0]=u[0].slice(0),o.length>2&&"ID"===(s=o[0]).type&&w.getById&&9===e.nodeType&&O&&_.relative[o[1].type]){if(e=(_.find.ID(s.matches[0].replace(wt,_t),e)||[])[0],!e)return i;l&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(r=mt.needsContext.test(t)?0:o.length;r--&&(s=o[r],!_.relative[a=s.type]);)if((c=_.find[a])&&(n=c(s.matches[0].replace(wt,_t),bt.test(o[0].type)&&p(e.parentNode)||e))){if(o.splice(r,1),t=n.length&&d(o),!t)return Q.apply(i,n),i;break}}return(l||C(t,u))(n,e,!O,i,bt.test(t)&&p(e.parentNode)||e),i},w.sortStable=V.split("").sort(W).join("")===V,w.detectDuplicates=!!I,z(),w.sortDetached=r(function(t){return 1&t.compareDocumentPosition(P.createElement("div"))}),r(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||o("type|href|height|width",function(t,e,i){if(!i)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),w.attributes&&r(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||o("value",function(t,e,i){if(!i&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),r(function(t){return null==t.getAttribute("disabled")})||o(et,function(t,e,i){var n;if(!i)return t[e]===!0?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null}),e}(i);nt.find=ct,nt.expr=ct.selectors,nt.expr[":"]=nt.expr.pseudos,nt.unique=ct.uniqueSort,nt.text=ct.getText,nt.isXMLDoc=ct.isXML,nt.contains=ct.contains;var lt=nt.expr.match.needsContext,pt=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ut=/^.[^:#\[\.,]*$/;nt.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?nt.find.matchesSelector(n,t)?[n]:[]:nt.find.matches(t,nt.grep(e,function(t){return 1===t.nodeType}))},nt.fn.extend({find:function(t){var e,i=this.length,n=[],r=this;if("string"!=typeof t)return this.pushStack(nt(t).filter(function(){for(e=0;e<i;e++)if(nt.contains(r[e],this))return!0}));for(e=0;e<i;e++)nt.find(t,r[e],n);return n=this.pushStack(i>1?nt.unique(n):n),n.selector=this.selector?this.selector+" "+t:t,n},filter:function(t){return this.pushStack(a(this,t||[],!1))},not:function(t){return this.pushStack(a(this,t||[],!0))},is:function(t){return!!a(this,"string"==typeof t&&lt.test(t)?nt(t):t||[],!1).length}});var dt,ht=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,mt=nt.fn.init=function(t,e){var i,n;if(!t)return this;if("string"==typeof t){if(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:ht.exec(t),!i||!i[1]&&e)return!e||e.jquery?(e||dt).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof nt?e[0]:e,nt.merge(this,nt.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:et,!0)),pt.test(i[1])&&nt.isPlainObject(e))for(i in e)nt.isFunction(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return n=et.getElementById(i[2]),n&&n.parentNode&&(this.length=1,this[0]=n),this.context=et,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):nt.isFunction(t)?"undefined"!=typeof dt.ready?dt.ready(t):t(nt):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),nt.makeArray(t,this))};mt.prototype=nt.fn,dt=nt(et);var ft=/^(?:parents|prev(?:Until|All))/,gt={children:!0,contents:!0,next:!0,prev:!0};nt.extend({dir:function(t,e,i){for(var n=[],r=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&nt(t).is(i))break;n.push(t)}return n},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}}),nt.fn.extend({has:function(t){var e=nt(t,this),i=e.length;return this.filter(function(){for(var t=0;t<i;t++)if(nt.contains(this,e[t]))return!0})},closest:function(t,e){for(var i,n=0,r=this.length,o=[],s=lt.test(t)||"string"!=typeof t?nt(t,e||this.context):0;n<r;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(s?s.index(i)>-1:1===i.nodeType&&nt.find.matchesSelector(i,t))){o.push(i);break}return this.pushStack(o.length>1?nt.unique(o):o)},index:function(t){return t?"string"==typeof t?K.call(nt(t),this[0]):K.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(nt.unique(nt.merge(this.get(),nt(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),nt.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return nt.dir(t,"parentNode")},parentsUntil:function(t,e,i){return nt.dir(t,"parentNode",i)},next:function(t){return c(t,"nextSibling")},prev:function(t){return c(t,"previousSibling")},nextAll:function(t){return nt.dir(t,"nextSibling")},prevAll:function(t){return nt.dir(t,"previousSibling")},nextUntil:function(t,e,i){return nt.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return nt.dir(t,"previousSibling",i)},siblings:function(t){return nt.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return nt.sibling(t.firstChild)},contents:function(t){return t.contentDocument||nt.merge([],t.childNodes)}},function(t,e){nt.fn[t]=function(i,n){var r=nt.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(r=nt.filter(n,r)),this.length>1&&(gt[t]||nt.unique(r),ft.test(t)&&r.reverse()),this.pushStack(r)}});var vt=/\S+/g,yt={};nt.Callbacks=function(t){t="string"==typeof t?yt[t]||l(t):nt.extend({},t);var e,i,n,r,o,s,a=[],c=!t.once&&[],p=function(l){for(e=t.memory&&l,i=!0,s=r||0,r=0,o=a.length,n=!0;a&&s<o;s++)if(a[s].apply(l[0],l[1])===!1&&t.stopOnFalse){e=!1;break}n=!1,a&&(c?c.length&&p(c.shift()):e?a=[]:u.disable())},u={add:function(){if(a){var i=a.length;!function s(e){nt.each(e,function(e,i){var n=nt.type(i);"function"===n?t.unique&&u.has(i)||a.push(i):i&&i.length&&"string"!==n&&s(i)})}(arguments),n?o=a.length:e&&(r=i,p(e))}return this},remove:function(){return a&&nt.each(arguments,function(t,e){for(var i;(i=nt.inArray(e,a,i))>-1;)a.splice(i,1),n&&(i<=o&&o--,i<=s&&s--)}),this},has:function(t){return t?nt.inArray(t,a)>-1:!(!a||!a.length)},empty:function(){return a=[],o=0,this},disable:function(){return a=c=e=void 0,this},disabled:function(){return!a},lock:function(){return c=void 0,e||u.disable(),this},locked:function(){return!c},fireWith:function(t,e){return!a||i&&!c||(e=e||[],e=[t,e.slice?e.slice():e],n?c.push(e):p(e)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!i}};return u},nt.extend({Deferred:function(t){var e=[["resolve","done",nt.Callbacks("once memory"),"resolved"],["reject","fail",nt.Callbacks("once memory"),"rejected"],["notify","progress",nt.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var t=arguments;return nt.Deferred(function(i){nt.each(e,function(e,o){var s=nt.isFunction(t[e])&&t[e];r[o[1]](function(){var t=s&&s.apply(this,arguments);t&&nt.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[o[0]+"With"](this===n?i.promise():this,s?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?nt.extend(t,n):n}},r={};return n.pipe=n.then,nt.each(e,function(t,o){var s=o[2],a=o[3];n[o[1]]=s.add,a&&s.add(function(){i=a},e[1^t][2].disable,e[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?n:this,arguments),this},r[o[0]+"With"]=s.fireWith}),n.promise(r),t&&t.call(r,r),r},when:function(t){var e,i,n,r=0,o=J.call(arguments),s=o.length,a=1!==s||t&&nt.isFunction(t.promise)?s:0,c=1===a?t:nt.Deferred(),l=function(t,i,n){return function(r){i[t]=this,n[t]=arguments.length>1?J.call(arguments):r,n===e?c.notifyWith(i,n):--a||c.resolveWith(i,n)}};if(s>1)for(e=new Array(s),i=new Array(s),n=new Array(s);r<s;r++)o[r]&&nt.isFunction(o[r].promise)?o[r].promise().done(l(r,n,o)).fail(c.reject).progress(l(r,i,e)):--a;return a||c.resolveWith(n,o),c.promise()}});var bt;nt.fn.ready=function(t){return nt.ready.promise().done(t),this},nt.extend({isReady:!1,readyWait:1,holdReady:function(t){t?nt.readyWait++:nt.ready(!0)},ready:function(t){(t===!0?--nt.readyWait:nt.isReady)||(nt.isReady=!0,t!==!0&&--nt.readyWait>0||(bt.resolveWith(et,[nt]),nt.fn.triggerHandler&&(nt(et).triggerHandler("ready"),nt(et).off("ready"))))}}),nt.ready.promise=function(t){return bt||(bt=nt.Deferred(),"complete"===et.readyState?setTimeout(nt.ready):(et.addEventListener("DOMContentLoaded",p,!1),i.addEventListener("load",p,!1))),bt.promise(t)},nt.ready.promise();var kt=nt.access=function(t,e,i,n,r,o,s){var a=0,c=t.length,l=null==i;if("object"===nt.type(i)){r=!0;for(a in i)nt.access(t,e,a,i[a],!0,o,s)}else if(void 0!==n&&(r=!0,nt.isFunction(n)||(s=!0),l&&(s?(e.call(t,n),e=null):(l=e,e=function(t,e,i){return l.call(nt(t),i)})),e))for(;a<c;a++)e(t[a],i,s?n:n.call(t[a],a,e(t[a],i)));return r?t:l?e.call(t):c?e(t[0],i):o};nt.acceptData=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType},u.uid=1,u.accepts=nt.acceptData,u.prototype={key:function(t){if(!u.accepts(t))return 0;var e={},i=t[this.expando];if(!i){i=u.uid++;try{e[this.expando]={value:i},Object.defineProperties(t,e)}catch(n){e[this.expando]=i,nt.extend(t,e)}}return this.cache[i]||(this.cache[i]={}),i},set:function(t,e,i){var n,r=this.key(t),o=this.cache[r];if("string"==typeof e)o[e]=i;else if(nt.isEmptyObject(o))nt.extend(this.cache[r],e);else for(n in e)o[n]=e[n];return o},get:function(t,e){var i=this.cache[this.key(t)];return void 0===e?i:i[e]},access:function(t,e,i){var n;return void 0===e||e&&"string"==typeof e&&void 0===i?(n=this.get(t,e),void 0!==n?n:this.get(t,nt.camelCase(e))):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n,r,o=this.key(t),s=this.cache[o];if(void 0===e)this.cache[o]={};else{nt.isArray(e)?n=e.concat(e.map(nt.camelCase)):(r=nt.camelCase(e),e in s?n=[e,r]:(n=r,n=n in s?[n]:n.match(vt)||[])),i=n.length;for(;i--;)delete s[n[i]]}},hasData:function(t){return!nt.isEmptyObject(this.cache[t[this.expando]]||{})},discard:function(t){t[this.expando]&&delete this.cache[t[this.expando]]}};var wt=new u,_t=new u,jt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Tt=/([A-Z])/g;nt.extend({hasData:function(t){return _t.hasData(t)||wt.hasData(t)},data:function(t,e,i){return _t.access(t,e,i)},removeData:function(t,e){_t.remove(t,e)},_data:function(t,e,i){return wt.access(t,e,i)},_removeData:function(t,e){wt.remove(t,e)}}),nt.fn.extend({data:function(t,e){var i,n,r,o=this[0],s=o&&o.attributes;if(void 0===t){if(this.length&&(r=_t.get(o),1===o.nodeType&&!wt.get(o,"hasDataAttrs"))){for(i=s.length;i--;)s[i]&&(n=s[i].name,0===n.indexOf("data-")&&(n=nt.camelCase(n.slice(5)),d(o,n,r[n])));wt.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each(function(){_t.set(this,t)}):kt(this,function(e){var i,n=nt.camelCase(t);if(o&&void 0===e){if(i=_t.get(o,t),void 0!==i)return i;if(i=_t.get(o,n),void 0!==i)return i;if(i=d(o,n,void 0),void 0!==i)return i}else this.each(function(){var i=_t.get(this,n);_t.set(this,n,e),t.indexOf("-")!==-1&&void 0!==i&&_t.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){_t.remove(this,t)})}}),nt.extend({queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=wt.get(t,e),i&&(!n||nt.isArray(i)?n=wt.access(t,e,nt.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=nt.queue(t,e),n=i.length,r=i.shift(),o=nt._queueHooks(t,e),s=function(){nt.dequeue(t,e)};"inprogress"===r&&(r=i.shift(),n--),r&&("fx"===e&&i.unshift("inprogress"),delete o.stop,r.call(t,s,o)),!n&&o&&o.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return wt.get(t,i)||wt.access(t,i,{empty:nt.Callbacks("once memory").add(function(){wt.remove(t,[e+"queue",i])})})}}),nt.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?nt.queue(this[0],t):void 0===e?this:this.each(function(){var i=nt.queue(this,t,e);nt._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&nt.dequeue(this,t)})},dequeue:function(t){return this.each(function(){nt.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,r=nt.Deferred(),o=this,s=this.length,a=function(){--n||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)i=wt.get(o[s],t+"queueHooks"),i&&i.empty&&(n++,i.empty.add(a));return a(),r.promise(e)}});var Mt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ct=["Top","Right","Bottom","Left"],xt=function(t,e){return t=e||t,"none"===nt.css(t,"display")||!nt.contains(t.ownerDocument,t)},$t=/^(?:checkbox|radio)$/i;!function(){var t=et.createDocumentFragment(),e=t.appendChild(et.createElement("div")),i=et.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),e.appendChild(i),tt.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",tt.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var St="undefined";tt.focusinBubbles="onfocusin"in i;var It=/^key/,zt=/^(?:mouse|pointer|contextmenu)|click/,Pt=/^(?:focusinfocus|focusoutblur)$/,Dt=/^([^.]*)(?:\.(.+)|)$/;nt.event={global:{},add:function(t,e,i,n,r){var o,s,a,c,l,p,u,d,h,m,f,g=wt.get(t);if(g)for(i.handler&&(o=i,i=o.handler,r=o.selector),i.guid||(i.guid=nt.guid++),(c=g.events)||(c=g.events={}),(s=g.handle)||(s=g.handle=function(e){return typeof nt!==St&&nt.event.triggered!==e.type?nt.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(vt)||[""],l=e.length;l--;)a=Dt.exec(e[l])||[],h=f=a[1],m=(a[2]||"").split(".").sort(),h&&(u=nt.event.special[h]||{},h=(r?u.delegateType:u.bindType)||h,u=nt.event.special[h]||{},p=nt.extend({type:h,origType:f,data:n,handler:i,guid:i.guid,selector:r,needsContext:r&&nt.expr.match.needsContext.test(r),namespace:m.join(".")},o),(d=c[h])||(d=c[h]=[],d.delegateCount=0,u.setup&&u.setup.call(t,n,m,s)!==!1||t.addEventListener&&t.addEventListener(h,s,!1)),u.add&&(u.add.call(t,p),p.handler.guid||(p.handler.guid=i.guid)),r?d.splice(d.delegateCount++,0,p):d.push(p),nt.event.global[h]=!0)},remove:function(t,e,i,n,r){var o,s,a,c,l,p,u,d,h,m,f,g=wt.hasData(t)&&wt.get(t);if(g&&(c=g.events)){for(e=(e||"").match(vt)||[""],l=e.length;l--;)if(a=Dt.exec(e[l])||[],h=f=a[1],m=(a[2]||"").split(".").sort(),h){for(u=nt.event.special[h]||{},h=(n?u.delegateType:u.bindType)||h,d=c[h]||[],a=a[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=d.length;o--;)p=d[o],!r&&f!==p.origType||i&&i.guid!==p.guid||a&&!a.test(p.namespace)||n&&n!==p.selector&&("**"!==n||!p.selector)||(d.splice(o,1),p.selector&&d.delegateCount--,u.remove&&u.remove.call(t,p));s&&!d.length&&(u.teardown&&u.teardown.call(t,m,g.handle)!==!1||nt.removeEvent(t,h,g.handle),delete c[h])}else for(h in c)nt.event.remove(t,h+e[l],i,n,!0);nt.isEmptyObject(c)&&(delete g.handle,wt.remove(t,"events"))}},trigger:function(t,e,n,r){var o,s,a,c,l,p,u,d=[n||et],h=Z.call(t,"type")?t.type:t,m=Z.call(t,"namespace")?t.namespace.split("."):[];if(s=a=n=n||et,3!==n.nodeType&&8!==n.nodeType&&!Pt.test(h+nt.event.triggered)&&(h.indexOf(".")>=0&&(m=h.split("."),h=m.shift(),m.sort()),l=h.indexOf(":")<0&&"on"+h,t=t[nt.expando]?t:new nt.Event(h,"object"==typeof t&&t),t.isTrigger=r?2:3,
t.namespace=m.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),e=null==e?[t]:nt.makeArray(e,[t]),u=nt.event.special[h]||{},r||!u.trigger||u.trigger.apply(n,e)!==!1)){if(!r&&!u.noBubble&&!nt.isWindow(n)){for(c=u.delegateType||h,Pt.test(c+h)||(s=s.parentNode);s;s=s.parentNode)d.push(s),a=s;a===(n.ownerDocument||et)&&d.push(a.defaultView||a.parentWindow||i)}for(o=0;(s=d[o++])&&!t.isPropagationStopped();)t.type=o>1?c:u.bindType||h,p=(wt.get(s,"events")||{})[t.type]&&wt.get(s,"handle"),p&&p.apply(s,e),p=l&&s[l],p&&p.apply&&nt.acceptData(s)&&(t.result=p.apply(s,e),t.result===!1&&t.preventDefault());return t.type=h,r||t.isDefaultPrevented()||u._default&&u._default.apply(d.pop(),e)!==!1||!nt.acceptData(n)||l&&nt.isFunction(n[h])&&!nt.isWindow(n)&&(a=n[l],a&&(n[l]=null),nt.event.triggered=h,n[h](),nt.event.triggered=void 0,a&&(n[l]=a)),t.result}},dispatch:function(t){t=nt.event.fix(t);var e,i,n,r,o,s=[],a=J.call(arguments),c=(wt.get(this,"events")||{})[t.type]||[],l=nt.event.special[t.type]||{};if(a[0]=t,t.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,t)!==!1){for(s=nt.event.handlers.call(this,t,c),e=0;(r=s[e++])&&!t.isPropagationStopped();)for(t.currentTarget=r.elem,i=0;(o=r.handlers[i++])&&!t.isImmediatePropagationStopped();)t.namespace_re&&!t.namespace_re.test(o.namespace)||(t.handleObj=o,t.data=o.data,n=((nt.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,a),void 0!==n&&(t.result=n)===!1&&(t.preventDefault(),t.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,t),t.result}},handlers:function(t,e){var i,n,r,o,s=[],a=e.delegateCount,c=t.target;if(a&&c.nodeType&&(!t.button||"click"!==t.type))for(;c!==this;c=c.parentNode||this)if(c.disabled!==!0||"click"!==t.type){for(n=[],i=0;i<a;i++)o=e[i],r=o.selector+" ",void 0===n[r]&&(n[r]=o.needsContext?nt(r,this).index(c)>=0:nt.find(r,this,null,[c]).length),n[r]&&n.push(o);n.length&&s.push({elem:c,handlers:n})}return a<e.length&&s.push({elem:this,handlers:e.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var i,n,r,o=e.button;return null==t.pageX&&null!=e.clientX&&(i=t.target.ownerDocument||et,n=i.documentElement,r=i.body,t.pageX=e.clientX+(n&&n.scrollLeft||r&&r.scrollLeft||0)-(n&&n.clientLeft||r&&r.clientLeft||0),t.pageY=e.clientY+(n&&n.scrollTop||r&&r.scrollTop||0)-(n&&n.clientTop||r&&r.clientTop||0)),t.which||void 0===o||(t.which=1&o?1:2&o?3:4&o?2:0),t}},fix:function(t){if(t[nt.expando])return t;var e,i,n,r=t.type,o=t,s=this.fixHooks[r];for(s||(this.fixHooks[r]=s=zt.test(r)?this.mouseHooks:It.test(r)?this.keyHooks:{}),n=s.props?this.props.concat(s.props):this.props,t=new nt.Event(o),e=n.length;e--;)i=n[e],t[i]=o[i];return t.target||(t.target=et),3===t.target.nodeType&&(t.target=t.target.parentNode),s.filter?s.filter(t,o):t},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==f()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===f()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&nt.nodeName(this,"input"))return this.click(),!1},_default:function(t){return nt.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i,n){var r=nt.extend(new nt.Event,i,{type:t,isSimulated:!0,originalEvent:{}});n?nt.event.trigger(r,null,e):nt.event.dispatch.call(e,r),r.isDefaultPrevented()&&i.preventDefault()}},nt.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)},nt.Event=function(t,e){return this instanceof nt.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&t.returnValue===!1?h:m):this.type=t,e&&nt.extend(this,e),this.timeStamp=t&&t.timeStamp||nt.now(),void(this[nt.expando]=!0)):new nt.Event(t,e)},nt.Event.prototype={isDefaultPrevented:m,isPropagationStopped:m,isImmediatePropagationStopped:m,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=h,t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=h,t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=h,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},nt.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){nt.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,r=t.relatedTarget,o=t.handleObj;return r&&(r===n||nt.contains(n,r))||(t.type=o.origType,i=o.handler.apply(this,arguments),t.type=e),i}}}),tt.focusinBubbles||nt.each({focus:"focusin",blur:"focusout"},function(t,e){var i=function(t){nt.event.simulate(e,t.target,nt.event.fix(t),!0)};nt.event.special[e]={setup:function(){var n=this.ownerDocument||this,r=wt.access(n,e);r||n.addEventListener(t,i,!0),wt.access(n,e,(r||0)+1)},teardown:function(){var n=this.ownerDocument||this,r=wt.access(n,e)-1;r?wt.access(n,e,r):(n.removeEventListener(t,i,!0),wt.remove(n,e))}}}),nt.fn.extend({on:function(t,e,i,n,r){var o,s;if("object"==typeof t){"string"!=typeof e&&(i=i||e,e=void 0);for(s in t)this.on(s,e,i,t[s],r);return this}if(null==i&&null==n?(n=e,i=e=void 0):null==n&&("string"==typeof e?(n=i,i=void 0):(n=i,i=e,e=void 0)),n===!1)n=m;else if(!n)return this;return 1===r&&(o=n,n=function(t){return nt().off(t),o.apply(this,arguments)},n.guid=o.guid||(o.guid=nt.guid++)),this.each(function(){nt.event.add(this,t,n,i,e)})},one:function(t,e,i,n){return this.on(t,e,i,n,1)},off:function(t,e,i){var n,r;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,nt(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return e!==!1&&"function"!=typeof e||(i=e,e=void 0),i===!1&&(i=m),this.each(function(){nt.event.remove(this,t,i,e)})},trigger:function(t,e){return this.each(function(){nt.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];if(i)return nt.event.trigger(t,e,i,!0)}});var Ot=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Nt=/<([\w:]+)/,Et=/<|&#?\w+;/,At=/<(?:script|style|link)/i,Lt=/checked\s*(?:[^=]|=\s*.checked.)/i,Vt=/^$|\/(?:java|ecma)script/i,Rt=/^true\/(.*)/,Ft=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,qt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};qt.optgroup=qt.option,qt.tbody=qt.tfoot=qt.colgroup=qt.caption=qt.thead,qt.th=qt.td,nt.extend({clone:function(t,e,i){var n,r,o,s,a=t.cloneNode(!0),c=nt.contains(t.ownerDocument,t);if(!(tt.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||nt.isXMLDoc(t)))for(s=w(a),o=w(t),n=0,r=o.length;n<r;n++)_(o[n],s[n]);if(e)if(i)for(o=o||w(t),s=s||w(a),n=0,r=o.length;n<r;n++)k(o[n],s[n]);else k(t,a);return s=w(a,"script"),s.length>0&&b(s,!c&&w(t,"script")),a},buildFragment:function(t,e,i,n){for(var r,o,s,a,c,l,p=e.createDocumentFragment(),u=[],d=0,h=t.length;d<h;d++)if(r=t[d],r||0===r)if("object"===nt.type(r))nt.merge(u,r.nodeType?[r]:r);else if(Et.test(r)){for(o=o||p.appendChild(e.createElement("div")),s=(Nt.exec(r)||["",""])[1].toLowerCase(),a=qt[s]||qt._default,o.innerHTML=a[1]+r.replace(Ot,"<$1></$2>")+a[2],l=a[0];l--;)o=o.lastChild;nt.merge(u,o.childNodes),o=p.firstChild,o.textContent=""}else u.push(e.createTextNode(r));for(p.textContent="",d=0;r=u[d++];)if((!n||nt.inArray(r,n)===-1)&&(c=nt.contains(r.ownerDocument,r),o=w(p.appendChild(r),"script"),c&&b(o),i))for(l=0;r=o[l++];)Vt.test(r.type||"")&&i.push(r);return p},cleanData:function(t){for(var e,i,n,r,o=nt.event.special,s=0;void 0!==(i=t[s]);s++){if(nt.acceptData(i)&&(r=i[wt.expando],r&&(e=wt.cache[r]))){if(e.events)for(n in e.events)o[n]?nt.event.remove(i,n):nt.removeEvent(i,n,e.handle);wt.cache[r]&&delete wt.cache[r]}delete _t.cache[i[_t.expando]]}}}),nt.fn.extend({text:function(t){return kt(this,function(t){return void 0===t?nt.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=g(this,t);e.appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=g(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var i,n=t?nt.filter(t,this):this,r=0;null!=(i=n[r]);r++)e||1!==i.nodeType||nt.cleanData(w(i)),i.parentNode&&(e&&nt.contains(i.ownerDocument,i)&&b(w(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(nt.cleanData(w(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return nt.clone(this,t,e)})},html:function(t){return kt(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!At.test(t)&&!qt[(Nt.exec(t)||["",""])[1].toLowerCase()]){t=t.replace(Ot,"<$1></$2>");try{for(;i<n;i++)e=this[i]||{},1===e.nodeType&&(nt.cleanData(w(e,!1)),e.innerHTML=t);e=0}catch(r){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,function(e){t=this.parentNode,nt.cleanData(w(this)),t&&t.replaceChild(e,this)}),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e){t=G.apply([],t);var i,n,r,o,s,a,c=0,l=this.length,p=this,u=l-1,d=t[0],h=nt.isFunction(d);if(h||l>1&&"string"==typeof d&&!tt.checkClone&&Lt.test(d))return this.each(function(i){var n=p.eq(i);h&&(t[0]=d.call(this,i,n.html())),n.domManip(t,e)});if(l&&(i=nt.buildFragment(t,this[0].ownerDocument,!1,this),n=i.firstChild,1===i.childNodes.length&&(i=n),n)){for(r=nt.map(w(i,"script"),v),o=r.length;c<l;c++)s=i,c!==u&&(s=nt.clone(s,!0,!0),o&&nt.merge(r,w(s,"script"))),e.call(this[c],s,c);if(o)for(a=r[r.length-1].ownerDocument,nt.map(r,y),c=0;c<o;c++)s=r[c],Vt.test(s.type||"")&&!wt.access(s,"globalEval")&&nt.contains(a,s)&&(s.src?nt._evalUrl&&nt._evalUrl(s.src):nt.globalEval(s.textContent.replace(Ft,"")))}return this}}),nt.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){nt.fn[t]=function(t){for(var i,n=[],r=nt(t),o=r.length-1,s=0;s<=o;s++)i=s===o?this:this.clone(!0),nt(r[s])[e](i),Y.apply(n,i.get());return this.pushStack(n)}});var Ht,Bt={},Ut=/^margin/,Wt=new RegExp("^("+Mt+")(?!px)[a-z%]+$","i"),Jt=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):i.getComputedStyle(t,null)};!function(){function t(){s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",s.innerHTML="",r.appendChild(o);var t=i.getComputedStyle(s,null);e="1%"!==t.top,n="4px"===t.width,r.removeChild(o)}var e,n,r=et.documentElement,o=et.createElement("div"),s=et.createElement("div");s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",tt.clearCloneStyle="content-box"===s.style.backgroundClip,o.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",o.appendChild(s),i.getComputedStyle&&nt.extend(tt,{pixelPosition:function(){return t(),e},boxSizingReliable:function(){return null==n&&t(),n},reliableMarginRight:function(){var t,e=s.appendChild(et.createElement("div"));return e.style.cssText=s.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",s.style.width="1px",r.appendChild(o),t=!parseFloat(i.getComputedStyle(e,null).marginRight),r.removeChild(o),s.removeChild(e),t}}))}(),nt.swap=function(t,e,i,n){var r,o,s={};for(o in e)s[o]=t.style[o],t.style[o]=e[o];r=i.apply(t,n||[]);for(o in e)t.style[o]=s[o];return r};var Gt=/^(none|table(?!-c[ea]).+)/,Yt=new RegExp("^("+Mt+")(.*)$","i"),Kt=new RegExp("^([+-])=("+Mt+")","i"),Xt={position:"absolute",visibility:"hidden",display:"block"},Qt={letterSpacing:"0",fontWeight:"400"},Zt=["Webkit","O","Moz","ms"];nt.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=M(t,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,s,a=nt.camelCase(e),c=t.style;return e=nt.cssProps[a]||(nt.cssProps[a]=x(c,a)),s=nt.cssHooks[e]||nt.cssHooks[a],void 0===i?s&&"get"in s&&void 0!==(r=s.get(t,!1,n))?r:c[e]:(o=typeof i,"string"===o&&(r=Kt.exec(i))&&(i=(r[1]+1)*r[2]+parseFloat(nt.css(t,e)),o="number"),null!=i&&i===i&&("number"!==o||nt.cssNumber[a]||(i+="px"),tt.clearCloneStyle||""!==i||0!==e.indexOf("background")||(c[e]="inherit"),s&&"set"in s&&void 0===(i=s.set(t,i,n))||(c[e]=i)),void 0)}},css:function(t,e,i,n){var r,o,s,a=nt.camelCase(e);return e=nt.cssProps[a]||(nt.cssProps[a]=x(t.style,a)),s=nt.cssHooks[e]||nt.cssHooks[a],s&&"get"in s&&(r=s.get(t,!0,i)),void 0===r&&(r=M(t,e,n)),"normal"===r&&e in Qt&&(r=Qt[e]),""===i||i?(o=parseFloat(r),i===!0||nt.isNumeric(o)?o||0:r):r}}),nt.each(["height","width"],function(t,e){nt.cssHooks[e]={get:function(t,i,n){if(i)return Gt.test(nt.css(t,"display"))&&0===t.offsetWidth?nt.swap(t,Xt,function(){return I(t,e,n)}):I(t,e,n)},set:function(t,i,n){var r=n&&Jt(t);return $(t,i,n?S(t,e,n,"border-box"===nt.css(t,"boxSizing",!1,r),r):0)}}}),nt.cssHooks.marginRight=C(tt.reliableMarginRight,function(t,e){if(e)return nt.swap(t,{display:"inline-block"},M,[t,"marginRight"])}),nt.each({margin:"",padding:"",border:"Width"},function(t,e){nt.cssHooks[t+e]={expand:function(i){for(var n=0,r={},o="string"==typeof i?i.split(" "):[i];n<4;n++)r[t+Ct[n]+e]=o[n]||o[n-2]||o[0];return r}},Ut.test(t)||(nt.cssHooks[t+e].set=$)}),nt.fn.extend({css:function(t,e){return kt(this,function(t,e,i){var n,r,o={},s=0;if(nt.isArray(e)){for(n=Jt(t),r=e.length;s<r;s++)o[e[s]]=nt.css(t,e[s],!1,n);return o}return void 0!==i?nt.style(t,e,i):nt.css(t,e)},t,e,arguments.length>1)},show:function(){return z(this,!0)},hide:function(){return z(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){xt(this)?nt(this).show():nt(this).hide()})}}),nt.Tween=P,P.prototype={constructor:P,init:function(t,e,i,n,r,o){this.elem=t,this.prop=i,this.easing=r||"swing",this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=o||(nt.cssNumber[i]?"":"px")},cur:function(){var t=P.propHooks[this.prop];return t&&t.get?t.get(this):P.propHooks._default.get(this)},run:function(t){var e,i=P.propHooks[this.prop];return this.options.duration?this.pos=e=nt.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):P.propHooks._default.set(this),this}},P.prototype.init.prototype=P.prototype,P.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=nt.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){nt.fx.step[t.prop]?nt.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[nt.cssProps[t.prop]]||nt.cssHooks[t.prop])?nt.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},P.propHooks.scrollTop=P.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},nt.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},nt.fx=P.prototype.init,nt.fx.step={};var te,ee,ie=/^(?:toggle|show|hide)$/,ne=new RegExp("^(?:([+-])=|)("+Mt+")([a-z%]*)$","i"),re=/queueHooks$/,oe=[E],se={"*":[function(t,e){var i=this.createTween(t,e),n=i.cur(),r=ne.exec(e),o=r&&r[3]||(nt.cssNumber[t]?"":"px"),s=(nt.cssNumber[t]||"px"!==o&&+n)&&ne.exec(nt.css(i.elem,t)),a=1,c=20;if(s&&s[3]!==o){o=o||s[3],r=r||[],s=+n||1;do a=a||".5",s/=a,nt.style(i.elem,t,s+o);while(a!==(a=i.cur()/n)&&1!==a&&--c)}return r&&(s=i.start=+s||+n||0,i.unit=o,i.end=r[1]?s+(r[1]+1)*r[2]:+r[2]),i}]};nt.Animation=nt.extend(L,{tweener:function(t,e){nt.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var i,n=0,r=t.length;n<r;n++)i=t[n],se[i]=se[i]||[],se[i].unshift(e)},prefilter:function(t,e){e?oe.unshift(t):oe.push(t)}}),nt.speed=function(t,e,i){var n=t&&"object"==typeof t?nt.extend({},t):{complete:i||!i&&e||nt.isFunction(t)&&t,duration:t,easing:i&&e||e&&!nt.isFunction(e)&&e};return n.duration=nt.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in nt.fx.speeds?nt.fx.speeds[n.duration]:nt.fx.speeds._default,null!=n.queue&&n.queue!==!0||(n.queue="fx"),n.old=n.complete,n.complete=function(){nt.isFunction(n.old)&&n.old.call(this),n.queue&&nt.dequeue(this,n.queue)},n},nt.fn.extend({fadeTo:function(t,e,i,n){return this.filter(xt).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var r=nt.isEmptyObject(t),o=nt.speed(e,i,n),s=function(){var e=L(this,nt.extend({},t),o);(r||wt.get(this,"finish"))&&e.stop(!0)};return s.finish=s,r||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,r=null!=t&&t+"queueHooks",o=nt.timers,s=wt.get(this);if(r)s[r]&&s[r].stop&&n(s[r]);else for(r in s)s[r]&&s[r].stop&&re.test(r)&&n(s[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(i),e=!1,o.splice(r,1));!e&&i||nt.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,i=wt.get(this),n=i[t+"queue"],r=i[t+"queueHooks"],o=nt.timers,s=n?n.length:0;for(i.finish=!0,nt.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<s;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),nt.each(["toggle","show","hide"],function(t,e){var i=nt.fn[e];nt.fn[e]=function(t,n,r){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(O(e,!0),t,n,r)}}),nt.each({slideDown:O("show"),slideUp:O("hide"),slideToggle:O("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){nt.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),nt.timers=[],nt.fx.tick=function(){var t,e=0,i=nt.timers;for(te=nt.now();e<i.length;e++)t=i[e],t()||i[e]!==t||i.splice(e--,1);i.length||nt.fx.stop(),te=void 0},nt.fx.timer=function(t){nt.timers.push(t),t()?nt.fx.start():nt.timers.pop()},nt.fx.interval=13,nt.fx.start=function(){ee||(ee=setInterval(nt.fx.tick,nt.fx.interval))},nt.fx.stop=function(){clearInterval(ee),ee=null},nt.fx.speeds={slow:600,fast:200,_default:400},nt.fn.delay=function(t,e){return t=nt.fx?nt.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,i){var n=setTimeout(e,t);i.stop=function(){clearTimeout(n)}})},function(){var t=et.createElement("input"),e=et.createElement("select"),i=e.appendChild(et.createElement("option"));t.type="checkbox",tt.checkOn=""!==t.value,tt.optSelected=i.selected,e.disabled=!0,tt.optDisabled=!i.disabled,t=et.createElement("input"),t.value="t",t.type="radio",tt.radioValue="t"===t.value}();var ae,ce,le=nt.expr.attrHandle;nt.fn.extend({attr:function(t,e){return kt(this,nt.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){nt.removeAttr(this,t)})}}),nt.extend({attr:function(t,e,i){var n,r,o=t.nodeType;if(t&&3!==o&&8!==o&&2!==o)return typeof t.getAttribute===St?nt.prop(t,e,i):(1===o&&nt.isXMLDoc(t)||(e=e.toLowerCase(),n=nt.attrHooks[e]||(nt.expr.match.bool.test(e)?ce:ae)),void 0===i?n&&"get"in n&&null!==(r=n.get(t,e))?r:(r=nt.find.attr(t,e),null==r?void 0:r):null!==i?n&&"set"in n&&void 0!==(r=n.set(t,i,e))?r:(t.setAttribute(e,i+""),i):void nt.removeAttr(t,e))},removeAttr:function(t,e){var i,n,r=0,o=e&&e.match(vt);if(o&&1===t.nodeType)for(;i=o[r++];)n=nt.propFix[i]||i,nt.expr.match.bool.test(i)&&(t[n]=!1),t.removeAttribute(i)},attrHooks:{type:{set:function(t,e){if(!tt.radioValue&&"radio"===e&&nt.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}}}),ce={set:function(t,e,i){return e===!1?nt.removeAttr(t,i):t.setAttribute(i,i),i}},nt.each(nt.expr.match.bool.source.match(/\w+/g),function(t,e){var i=le[e]||nt.find.attr;le[e]=function(t,e,n){var r,o;return n||(o=le[e],le[e]=r,r=null!=i(t,e,n)?e.toLowerCase():null,le[e]=o),r}});var pe=/^(?:input|select|textarea|button)$/i;nt.fn.extend({prop:function(t,e){return kt(this,nt.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[nt.propFix[t]||t]})}}),nt.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(t,e,i){var n,r,o,s=t.nodeType;if(t&&3!==s&&8!==s&&2!==s)return o=1!==s||!nt.isXMLDoc(t),o&&(e=nt.propFix[e]||e,r=nt.propHooks[e]),void 0!==i?r&&"set"in r&&void 0!==(n=r.set(t,i,e))?n:t[e]=i:r&&"get"in r&&null!==(n=r.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){return t.hasAttribute("tabindex")||pe.test(t.nodeName)||t.href?t.tabIndex:-1}}}}),tt.optSelected||(nt.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null}}),nt.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){nt.propFix[this.toLowerCase()]=this});var ue=/[\t\r\n\f]/g;nt.fn.extend({addClass:function(t){var e,i,n,r,o,s,a="string"==typeof t&&t,c=0,l=this.length;if(nt.isFunction(t))return this.each(function(e){nt(this).addClass(t.call(this,e,this.className))});if(a)for(e=(t||"").match(vt)||[];c<l;c++)if(i=this[c],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(ue," "):" ")){for(o=0;r=e[o++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");s=nt.trim(n),i.className!==s&&(i.className=s)}return this},removeClass:function(t){var e,i,n,r,o,s,a=0===arguments.length||"string"==typeof t&&t,c=0,l=this.length;if(nt.isFunction(t))return this.each(function(e){nt(this).removeClass(t.call(this,e,this.className))});if(a)for(e=(t||"").match(vt)||[];c<l;c++)if(i=this[c],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(ue," "):"")){for(o=0;r=e[o++];)for(;n.indexOf(" "+r+" ")>=0;)n=n.replace(" "+r+" "," ");s=t?nt.trim(n):"",i.className!==s&&(i.className=s)}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):nt.isFunction(t)?this.each(function(i){nt(this).toggleClass(t.call(this,i,this.className,e),e)}):this.each(function(){if("string"===i)for(var e,n=0,r=nt(this),o=t.match(vt)||[];e=o[n++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else i!==St&&"boolean"!==i||(this.className&&wt.set(this,"__className__",this.className),this.className=this.className||t===!1?"":wt.get(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",i=0,n=this.length;i<n;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(ue," ").indexOf(e)>=0)return!0;return!1}});var de=/\r/g;nt.fn.extend({val:function(t){var e,i,n,r=this[0];{if(arguments.length)return n=nt.isFunction(t),this.each(function(i){var r;1===this.nodeType&&(r=n?t.call(this,i,nt(this).val()):t,null==r?r="":"number"==typeof r?r+="":nt.isArray(r)&&(r=nt.map(r,function(t){return null==t?"":t+""})),e=nt.valHooks[this.type]||nt.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))});if(r)return e=nt.valHooks[r.type]||nt.valHooks[r.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(i=e.get(r,"value"))?i:(i=r.value,"string"==typeof i?i.replace(de,""):null==i?"":i)}}}),nt.extend({valHooks:{option:{get:function(t){var e=nt.find.attr(t,"value");return null!=e?e:nt.trim(nt.text(t))}},select:{get:function(t){for(var e,i,n=t.options,r=t.selectedIndex,o="select-one"===t.type||r<0,s=o?null:[],a=o?r+1:n.length,c=r<0?a:o?r:0;c<a;c++)if(i=n[c],(i.selected||c===r)&&(tt.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!nt.nodeName(i.parentNode,"optgroup"))){if(e=nt(i).val(),o)return e;s.push(e)}return s},set:function(t,e){for(var i,n,r=t.options,o=nt.makeArray(e),s=r.length;s--;)n=r[s],(n.selected=nt.inArray(n.value,o)>=0)&&(i=!0);return i||(t.selectedIndex=-1),o}}}}),nt.each(["radio","checkbox"],function(){nt.valHooks[this]={set:function(t,e){if(nt.isArray(e))return t.checked=nt.inArray(nt(t).val(),e)>=0}},tt.checkOn||(nt.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),nt.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){nt.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),nt.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}});var he=nt.now(),me=/\?/;nt.parseJSON=function(t){return JSON.parse(t+"")},nt.parseXML=function(t){var e,i;if(!t||"string"!=typeof t)return null;try{i=new DOMParser,e=i.parseFromString(t,"text/xml")}catch(n){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||nt.error("Invalid XML: "+t),e};var fe=/#.*$/,ge=/([?&])_=[^&]*/,ve=/^(.*?):[ \t]*([^\r\n]*)$/gm,ye=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,be=/^(?:GET|HEAD)$/,ke=/^\/\//,we=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,_e={},je={},Te="*/".concat("*"),Me=i.location.href,Ce=we.exec(Me.toLowerCase())||[];nt.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Me,type:"GET",isLocal:ye.test(Ce[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Te,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":nt.parseJSON,"text xml":nt.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?F(F(t,nt.ajaxSettings),e):F(nt.ajaxSettings,t)},ajaxPrefilter:V(_e),ajaxTransport:V(je),ajax:function(t,e){function i(t,e,i,s){var c,p,v,y,k,_=e;2!==b&&(b=2,a&&clearTimeout(a),n=void 0,o=s||"",w.readyState=t>0?4:0,c=t>=200&&t<300||304===t,i&&(y=q(u,w,i)),y=H(u,y,w,c),c?(u.ifModified&&(k=w.getResponseHeader("Last-Modified"),k&&(nt.lastModified[r]=k),k=w.getResponseHeader("etag"),k&&(nt.etag[r]=k)),204===t||"HEAD"===u.type?_="nocontent":304===t?_="notmodified":(_=y.state,p=y.data,v=y.error,c=!v)):(v=_,!t&&_||(_="error",t<0&&(t=0))),w.status=t,w.statusText=(e||_)+"",c?m.resolveWith(d,[p,_,w]):m.rejectWith(d,[w,_,v]),w.statusCode(g),g=void 0,l&&h.trigger(c?"ajaxSuccess":"ajaxError",[w,u,c?p:v]),f.fireWith(d,[w,_]),l&&(h.trigger("ajaxComplete",[w,u]),--nt.active||nt.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,r,o,s,a,c,l,p,u=nt.ajaxSetup({},e),d=u.context||u,h=u.context&&(d.nodeType||d.jquery)?nt(d):nt.event,m=nt.Deferred(),f=nt.Callbacks("once memory"),g=u.statusCode||{},v={},y={},b=0,k="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(2===b){if(!s)for(s={};e=ve.exec(o);)s[e[1].toLowerCase()]=e[2];e=s[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===b?o:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return b||(t=y[i]=y[i]||t,v[t]=e),this},overrideMimeType:function(t){return b||(u.mimeType=t),this},statusCode:function(t){var e;if(t)if(b<2)for(e in t)g[e]=[g[e],t[e]];else w.always(t[w.status]);return this},abort:function(t){var e=t||k;return n&&n.abort(e),i(0,e),this}};if(m.promise(w).complete=f.add,w.success=w.done,w.error=w.fail,u.url=((t||u.url||Me)+"").replace(fe,"").replace(ke,Ce[1]+"//"),u.type=e.method||e.type||u.method||u.type,u.dataTypes=nt.trim(u.dataType||"*").toLowerCase().match(vt)||[""],null==u.crossDomain&&(c=we.exec(u.url.toLowerCase()),u.crossDomain=!(!c||c[1]===Ce[1]&&c[2]===Ce[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(Ce[3]||("http:"===Ce[1]?"80":"443")))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=nt.param(u.data,u.traditional)),R(_e,u,e,w),2===b)return w;l=nt.event&&u.global,l&&0===nt.active++&&nt.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!be.test(u.type),r=u.url,u.hasContent||(u.data&&(r=u.url+=(me.test(r)?"&":"?")+u.data,delete u.data),u.cache===!1&&(u.url=ge.test(r)?r.replace(ge,"$1_="+he++):r+(me.test(r)?"&":"?")+"_="+he++)),u.ifModified&&(nt.lastModified[r]&&w.setRequestHeader("If-Modified-Since",nt.lastModified[r]),nt.etag[r]&&w.setRequestHeader("If-None-Match",nt.etag[r])),(u.data&&u.hasContent&&u.contentType!==!1||e.contentType)&&w.setRequestHeader("Content-Type",u.contentType),w.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+Te+"; q=0.01":""):u.accepts["*"]);for(p in u.headers)w.setRequestHeader(p,u.headers[p]);if(u.beforeSend&&(u.beforeSend.call(d,w,u)===!1||2===b))return w.abort();k="abort";for(p in{success:1,error:1,complete:1})w[p](u[p]);if(n=R(je,u,e,w)){w.readyState=1,l&&h.trigger("ajaxSend",[w,u]),u.async&&u.timeout>0&&(a=setTimeout(function(){w.abort("timeout")},u.timeout));try{b=1,n.send(v,i)}catch(_){if(!(b<2))throw _;i(-1,_)}}else i(-1,"No Transport");return w},getJSON:function(t,e,i){return nt.get(t,e,i,"json")},getScript:function(t,e){return nt.get(t,void 0,e,"script")}}),nt.each(["get","post"],function(t,e){nt[e]=function(t,i,n,r){return nt.isFunction(i)&&(r=r||n,n=i,i=void 0),nt.ajax({url:t,type:e,dataType:r,data:i,success:n})}}),nt._evalUrl=function(t){return nt.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},nt.fn.extend({wrapAll:function(t){var e;return nt.isFunction(t)?this.each(function(e){nt(this).wrapAll(t.call(this,e))}):(this[0]&&(e=nt(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(t){return nt.isFunction(t)?this.each(function(e){nt(this).wrapInner(t.call(this,e))}):this.each(function(){var e=nt(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=nt.isFunction(t);return this.each(function(i){nt(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){
nt.nodeName(this,"body")||nt(this).replaceWith(this.childNodes)}).end()}}),nt.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},nt.expr.filters.visible=function(t){return!nt.expr.filters.hidden(t)};var xe=/%20/g,$e=/\[\]$/,Se=/\r?\n/g,Ie=/^(?:submit|button|image|reset|file)$/i,ze=/^(?:input|select|textarea|keygen)/i;nt.param=function(t,e){var i,n=[],r=function(t,e){e=nt.isFunction(e)?e():null==e?"":e,n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=nt.ajaxSettings&&nt.ajaxSettings.traditional),nt.isArray(t)||t.jquery&&!nt.isPlainObject(t))nt.each(t,function(){r(this.name,this.value)});else for(i in t)B(i,t[i],e,r);return n.join("&").replace(xe,"+")},nt.fn.extend({serialize:function(){return nt.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=nt.prop(this,"elements");return t?nt.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!nt(this).is(":disabled")&&ze.test(this.nodeName)&&!Ie.test(t)&&(this.checked||!$t.test(t))}).map(function(t,e){var i=nt(this).val();return null==i?null:nt.isArray(i)?nt.map(i,function(t){return{name:e.name,value:t.replace(Se,"\r\n")}}):{name:e.name,value:i.replace(Se,"\r\n")}}).get()}}),nt.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(t){}};var Pe=0,De={},Oe={0:200,1223:204},Ne=nt.ajaxSettings.xhr();i.attachEvent&&i.attachEvent("onunload",function(){for(var t in De)De[t]()}),tt.cors=!!Ne&&"withCredentials"in Ne,tt.ajax=Ne=!!Ne,nt.ajaxTransport(function(t){var e;if(tt.cors||Ne&&!t.crossDomain)return{send:function(i,n){var r,o=t.xhr(),s=++Pe;if(o.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(r in t.xhrFields)o[r]=t.xhrFields[r];t.mimeType&&o.overrideMimeType&&o.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(r in i)o.setRequestHeader(r,i[r]);e=function(t){return function(){e&&(delete De[s],e=o.onload=o.onerror=null,"abort"===t?o.abort():"error"===t?n(o.status,o.statusText):n(Oe[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:void 0,o.getAllResponseHeaders()))}},o.onload=e(),o.onerror=e("error"),e=De[s]=e("abort");try{o.send(t.hasContent&&t.data||null)}catch(a){if(e)throw a}},abort:function(){e&&e()}}}),nt.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return nt.globalEval(t),t}}}),nt.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),nt.ajaxTransport("script",function(t){if(t.crossDomain){var e,i;return{send:function(n,r){e=nt("<script>").prop({async:!0,charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&r("error"===t.type?404:200,t.type)}),et.head.appendChild(e[0])},abort:function(){i&&i()}}}});var Ee=[],Ae=/(=)\?(?=&|$)|\?\?/;nt.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ee.pop()||nt.expando+"_"+he++;return this[t]=!0,t}}),nt.ajaxPrefilter("json jsonp",function(t,e,n){var r,o,s,a=t.jsonp!==!1&&(Ae.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ae.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=nt.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(Ae,"$1"+r):t.jsonp!==!1&&(t.url+=(me.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return s||nt.error(r+" was not called"),s[0]},t.dataTypes[0]="json",o=i[r],i[r]=function(){s=arguments},n.always(function(){i[r]=o,t[r]&&(t.jsonpCallback=e.jsonpCallback,Ee.push(r)),s&&nt.isFunction(o)&&o(s[0]),s=o=void 0}),"script"}),nt.parseHTML=function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||et;var n=pt.exec(t),r=!i&&[];return n?[e.createElement(n[1])]:(n=nt.buildFragment([t],e,r),r&&r.length&&nt(r).remove(),nt.merge([],n.childNodes))};var Le=nt.fn.load;nt.fn.load=function(t,e,i){if("string"!=typeof t&&Le)return Le.apply(this,arguments);var n,r,o,s=this,a=t.indexOf(" ");return a>=0&&(n=nt.trim(t.slice(a)),t=t.slice(0,a)),nt.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(r="POST"),s.length>0&&nt.ajax({url:t,type:r,dataType:"html",data:e}).done(function(t){o=arguments,s.html(n?nt("<div>").append(nt.parseHTML(t)).find(n):t)}).complete(i&&function(t,e){s.each(i,o||[t.responseText,e,t])}),this},nt.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){nt.fn[e]=function(t){return this.on(e,t)}}),nt.expr.filters.animated=function(t){return nt.grep(nt.timers,function(e){return t===e.elem}).length};var Ve=i.document.documentElement;nt.offset={setOffset:function(t,e,i){var n,r,o,s,a,c,l,p=nt.css(t,"position"),u=nt(t),d={};"static"===p&&(t.style.position="relative"),a=u.offset(),o=nt.css(t,"top"),c=nt.css(t,"left"),l=("absolute"===p||"fixed"===p)&&(o+c).indexOf("auto")>-1,l?(n=u.position(),s=n.top,r=n.left):(s=parseFloat(o)||0,r=parseFloat(c)||0),nt.isFunction(e)&&(e=e.call(t,i,a)),null!=e.top&&(d.top=e.top-a.top+s),null!=e.left&&(d.left=e.left-a.left+r),"using"in e?e.using.call(t,d):u.css(d)}},nt.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){nt.offset.setOffset(this,t,e)});var e,i,n=this[0],r={top:0,left:0},o=n&&n.ownerDocument;if(o)return e=o.documentElement,nt.contains(e,n)?(typeof n.getBoundingClientRect!==St&&(r=n.getBoundingClientRect()),i=U(o),{top:r.top+i.pageYOffset-e.clientTop,left:r.left+i.pageXOffset-e.clientLeft}):r},position:function(){if(this[0]){var t,e,i=this[0],n={top:0,left:0};return"fixed"===nt.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),nt.nodeName(t[0],"html")||(n=t.offset()),n.top+=nt.css(t[0],"borderTopWidth",!0),n.left+=nt.css(t[0],"borderLeftWidth",!0)),{top:e.top-n.top-nt.css(i,"marginTop",!0),left:e.left-n.left-nt.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||Ve;t&&!nt.nodeName(t,"html")&&"static"===nt.css(t,"position");)t=t.offsetParent;return t||Ve})}}),nt.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var n="pageYOffset"===e;nt.fn[t]=function(r){return kt(this,function(t,r,o){var s=U(t);return void 0===o?s?s[e]:t[r]:void(s?s.scrollTo(n?i.pageXOffset:o,n?o:i.pageYOffset):t[r]=o)},t,r,arguments.length,null)}}),nt.each(["top","left"],function(t,e){nt.cssHooks[e]=C(tt.pixelPosition,function(t,i){if(i)return i=M(t,e),Wt.test(i)?nt(t).position()[e]+"px":i})}),nt.each({Height:"height",Width:"width"},function(t,e){nt.each({padding:"inner"+t,content:e,"":"outer"+t},function(i,n){nt.fn[n]=function(n,r){var o=arguments.length&&(i||"boolean"!=typeof n),s=i||(n===!0||r===!0?"margin":"border");return kt(this,function(e,i,n){var r;return nt.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+t],r["scroll"+t],e.body["offset"+t],r["offset"+t],r["client"+t])):void 0===n?nt.css(e,i,s):nt.style(e,i,n,s)},e,o?n:void 0,o,null)}})}),nt.fn.size=function(){return this.length},nt.fn.andSelf=nt.fn.addBack,n=[],r=function(){return nt}.apply(e,n),!(void 0!==r&&(t.exports=r));var Re=i.jQuery,Fe=i.$;return nt.noConflict=function(t){return i.$===nt&&(i.$=Fe),t&&i.jQuery===nt&&(i.jQuery=Re),nt},typeof o===St&&(i.jQuery=i.$=nt),nt})},function(t,e,i){"use strict";function n(t){return b.indexOf(t.nodeName.toLowerCase())!==-1}function r(t){return k.indexOf(t.nodeName.toLowerCase())!==-1}function o(t){var e=(new v).parseFromString(t,"text/html");return y(e.documentElement,n),e}function s(t){for(var e,i,n,r=[t],o=[];r.length>0;)for(e=r.shift(),o.push(e),i=e.childNodes,n=0;n<i.length;n++)1===i[n].nodeType&&r.push(i[n]);return o.shift(),o}function a(t){for(var e="",i=0;i<t.childNodes.length;i++)if(1===t.childNodes[i].nodeType)e+=t.childNodes[i]._replacement;else{if(3!==t.childNodes[i].nodeType)continue;e+=t.childNodes[i].data}return e}function c(t,e){return t.cloneNode(!1).outerHTML.replace("><",">"+e+"<")}function l(t,e){if("string"==typeof e)return e===t.nodeName.toLowerCase();if(Array.isArray(e))return e.indexOf(t.nodeName.toLowerCase())!==-1;if("function"==typeof e)return e.call(h,t);throw new TypeError("`filter` needs to be a string, array, or function")}function p(t,e){var i,r,o;return"left"===t?(i=e.previousSibling,r=/ $/):(i=e.nextSibling,r=/^ /),i&&(3===i.nodeType?o=r.test(i.nodeValue):1!==i.nodeType||n(i)||(o=r.test(i.textContent))),o}function u(t){var e="",i="";if(!n(t)){var r=/^[ \r\n\t]/.test(t.innerHTML),o=/[ \r\n\t]$/.test(t.innerHTML);r&&!p("left",t)&&(e=" "),o&&!p("right",t)&&(i=" ")}return{leading:e,trailing:i}}function d(t){var e,i=a(t);if(!r(t)&&!/A|TH|TD/.test(t.nodeName)&&/^\s*$/i.test(i))return void(t._replacement="");for(var n=0;n<m.length;n++){var o=m[n];if(l(t,o.filter)){if("function"!=typeof o.replacement)throw new TypeError("`replacement` needs to be a function that returns a string");var s=u(t);(s.leading||s.trailing)&&(i=i.trim()),e=s.leading+o.replacement.call(h,i,t)+s.trailing;break}}t._replacement=e}var h,m,f=i(1142),g=i(1143),v=i(1144),y=i(1146),b=["address","article","aside","audio","blockquote","body","canvas","center","dd","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frameset","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","isindex","li","main","menu","nav","noframes","noscript","ol","output","p","pre","section","table","tbody","td","tfoot","th","thead","tr","ul"],k=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];h=function(t,e){if(e=e||{},"string"!=typeof t)throw new TypeError(t+" is not a string");t=t.replace(/(\d+)\. /g,"$1\\. ");var i,n=o(t).body,r=s(n);m=f.slice(0),e.gfm&&(m=g.concat(m)),e.converters&&(m=e.converters.concat(m));for(var c=r.length-1;c>=0;c--)d(r[c]);return i=a(n),i.replace(/^[\t\r\n]+|[\t\r\n\s]+$/g,"").replace(/\n\s+\n/g,"\n\n").replace(/\n{3,}/g,"\n\n")},h.isBlock=n,h.isVoid=r,h.outer=c,t.exports=h},function(t,e){"use strict";t.exports=[{filter:"p",replacement:function(t){return"\n\n"+t+"\n\n"}},{filter:"br",replacement:function(){return"  \n"}},{filter:["h1","h2","h3","h4","h5","h6"],replacement:function(t,e){for(var i=e.nodeName.charAt(1),n="",r=0;r<i;r++)n+="#";return"\n\n"+n+" "+t+"\n\n"}},{filter:"hr",replacement:function(){return"\n\n* * *\n\n"}},{filter:["em","i"],replacement:function(t){return"_"+t+"_"}},{filter:["strong","b"],replacement:function(t){return"**"+t+"**"}},{filter:function(t){var e=t.previousSibling||t.nextSibling,i="PRE"===t.parentNode.nodeName&&!e;return"CODE"===t.nodeName&&!i},replacement:function(t){return"`"+t+"`"}},{filter:function(t){return"A"===t.nodeName&&t.getAttribute("href")},replacement:function(t,e){var i=e.title?' "'+e.title+'"':"";return"["+t+"]("+e.getAttribute("href")+i+")"}},{filter:"img",replacement:function(t,e){var i=e.alt||"",n=e.getAttribute("src")||"",r=e.title||"",o=r?' "'+r+'"':"";return n?"!["+i+"]("+n+o+")":""}},{filter:function(t){return"PRE"===t.nodeName&&"CODE"===t.firstChild.nodeName},replacement:function(t,e){return"\n\n    "+e.firstChild.textContent.replace(/\n/g,"\n    ")+"\n\n"}},{filter:"blockquote",replacement:function(t){return t=t.trim(),t=t.replace(/\n{3,}/g,"\n\n"),t=t.replace(/^/gm,"> "),"\n\n"+t+"\n\n"}},{filter:"li",replacement:function(t,e){t=t.replace(/^\s+/,"").replace(/\n/gm,"\n    ");var i="*   ",n=e.parentNode,r=Array.prototype.indexOf.call(n.children,e)+1;return i=/ol/i.test(n.nodeName)?r+".  ":"*   ",i+t}},{filter:["ul","ol"],replacement:function(t,e){for(var i=[],n=0;n<e.childNodes.length;n++)i.push(e.childNodes[n]._replacement);return/li/i.test(e.parentNode.nodeName)?"\n"+i.join("\n"):"\n\n"+i.join("\n")+"\n\n"}},{filter:function(t){return this.isBlock(t)},replacement:function(t,e){return"\n\n"+this.outer(e,t)+"\n\n"}},{filter:function(){return!0},replacement:function(t,e){return this.outer(e,t)}}]},function(t,e){"use strict";function i(t,e){var i=Array.prototype.indexOf.call(e.parentNode.childNodes,e),n=" ";return 0===i&&(n="| "),n+t+" |"}var n=/highlight highlight-(\S+)/;t.exports=[{filter:"br",replacement:function(){return"\n"}},{filter:["del","s","strike"],replacement:function(t){return"~~"+t+"~~"}},{filter:function(t){return"checkbox"===t.type&&"LI"===t.parentNode.nodeName},replacement:function(t,e){return(e.checked?"[x]":"[ ]")+" "}},{filter:["th","td"],replacement:function(t,e){return i(t,e)}},{filter:"tr",replacement:function(t,e){var n="",r={left:":--",right:"--:",center:":-:"};if("THEAD"===e.parentNode.nodeName)for(var o=0;o<e.childNodes.length;o++){var s=e.childNodes[o].attributes.align,a="---";s&&(a=r[s.value]||a),n+=i(a,e.childNodes[o])}return"\n"+t+(n?"\n"+n:"")}},{filter:"table",replacement:function(t){return"\n\n"+t+"\n\n"}},{filter:["thead","tbody","tfoot"],replacement:function(t){return t}},{filter:function(t){return"PRE"===t.nodeName&&t.firstChild&&"CODE"===t.firstChild.nodeName},replacement:function(t,e){return"\n\n```\n"+e.firstChild.textContent+"\n```\n\n"}},{filter:function(t){return"PRE"===t.nodeName&&"DIV"===t.parentNode.nodeName&&n.test(t.parentNode.className)},replacement:function(t,e){var i=e.parentNode.className.match(n)[1];return"\n\n```"+i+"\n"+e.textContent+"\n```\n\n"}},{filter:function(t){return"DIV"===t.nodeName&&n.test(t.className)},replacement:function(t){return"\n\n"+t+"\n\n"}}]},function(t,e,i){function n(){var t=s.DOMParser,e=!1;try{(new t).parseFromString("","text/html")&&(e=!0)}catch(i){}return e}function r(){var t=function(){};if("undefined"==typeof document){var e=i(1145);t.prototype.parseFromString=function(t){return e.jsdom(t,{features:{FetchExternalResources:[],ProcessExternalResources:!1}})}}else o()?t.prototype.parseFromString=function(t){var e=new window.ActiveXObject("htmlfile");return e.designMode="on",e.open(),e.write(t),e.close(),e}:t.prototype.parseFromString=function(t){var e=document.implementation.createHTMLDocument("");return e.open(),e.write(t),e.close(),e};return t}function o(){var t=!1;try{document.implementation.createHTMLDocument("").open()}catch(e){window.ActiveXObject&&(t=!0)}return t}var s="undefined"!=typeof window?window:this;t.exports=n()?s.DOMParser:r()},function(t,e){},function(t,e,i){"use strict";function n(t){return!(!t||!l[t.nodeName])}function r(t){return!(!t||!c[t.nodeName])}function o(t,e){if(t.firstChild&&"PRE"!==t.nodeName){"function"!=typeof e&&(e=n);for(var i=null,o=!1,c=null,l=a(c,t);l!==t;){if(3===l.nodeType){var p=l.data.replace(/[ \r\n\t]+/g," ");if(i&&!/ $/.test(i.data)||o||" "!==p[0]||(p=p.substr(1)),!p){l=s(l);continue}l.data=p,i=l}else{if(1!==l.nodeType){l=s(l);continue}e(l)||"BR"===l.nodeName?(i&&(i.data=i.data.replace(/ $/,"")),i=null,o=!1):r(l)&&(i=null,o=!0)}var u=a(c,l);c=l,l=u}i&&(i.data=i.data.replace(/ $/,""),i.data||s(i))}}function s(t){var e=t.nextSibling||t.parentNode;return t.parentNode.removeChild(t),e}function a(t,e){return t&&t.parentNode===e||"PRE"===e.nodeName?e.nextSibling||e.parentNode:e.firstChild||e.nextSibling||e.parentNode}var c=i(1147);Object.keys(c).forEach(function(t){c[t.toUpperCase()]=1});var l={};i(1148).forEach(function(t){l[t.toUpperCase()]=1}),t.exports=o},function(t,e){t.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuitem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}},function(t,e){t.exports=["address","article","aside","audio","blockquote","canvas","dd","div","dl","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","main","nav","noscript","ol","output","p","pre","section","table","tfoot","ul","video"]},function(t,e,i){(function(e){(function(){function e(t){this.tokens=[],this.tokens.links={},this.options=t||p.defaults,this.rules=u.normal,this.options.gfm&&(this.options.tables?this.rules=u.tables:this.rules=u.gfm)}function i(t,e){if(this.options=e||p.defaults,this.links=t,this.rules=d.normal,this.renderer=this.options.renderer||new n,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=d.breaks:this.rules=d.gfm:this.options.pedantic&&(this.rules=d.pedantic)}function n(t){this.options=t||{}}function r(t){this.tokens=[],this.token=null,this.options=t||p.defaults,this.options.renderer=this.options.renderer||new n,this.renderer=this.options.renderer,this.renderer.options=this.options}function o(t,e){return t.replace(e?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function s(t){return t.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/g,function(t,e){return e=e.toLowerCase(),"colon"===e?":":"#"===e.charAt(0)?"x"===e.charAt(1)?String.fromCharCode(parseInt(e.substring(2),16)):String.fromCharCode(+e.substring(1)):""})}function a(t,e){return t=t.source,e=e||"",function i(n,r){return n?(r=r.source||r,r=r.replace(/(^|[^\[])\^/g,"$1"),t=t.replace(n,r),i):new RegExp(t,e)}}function c(){}function l(t){for(var e,i,n=1;n<arguments.length;n++){e=arguments[n];for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t}function p(t,i,n){if(n||"function"==typeof i){n||(n=i,i=null),i=l({},p.defaults,i||{});var s,a,c=i.highlight,u=0;try{s=e.lex(t,i)}catch(d){return n(d)}a=s.length;var h=function(t){if(t)return i.highlight=c,n(t);var e;try{e=r.parse(s,i)}catch(o){t=o}return i.highlight=c,t?n(t):n(null,e)};if(!c||c.length<3)return h();if(delete i.highlight,!a)return h();for(;u<s.length;u++)!function(t){return"code"!==t.type?--a||h():c(t.text,t.lang,function(e,i){return e?h(e):null==i||i===t.text?--a||h():(t.text=i,t.escaped=!0,void(--a||h()))})}(s[u])}else try{return i&&(i=l({},p.defaults,i)),r.parse(e.lex(t,i),i)}catch(d){if(d.message+="\nPlease report this to https://github.com/chjj/marked.",(i||p.defaults).silent)return"<p>An error occured:</p><pre>"+o(d.message+"",!0)+"</pre>";throw d}}var u={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:c,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:c,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:c,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};u.bullet=/(?:[*+-]|\d+\.)/,u.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,u.item=a(u.item,"gm")(/bull/g,u.bullet)(),u.list=a(u.list)(/bull/g,u.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+u.def.source+")")(),u.blockquote=a(u.blockquote)("def",u.def)(),u._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",u.html=a(u.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,u._tag)(),u.paragraph=a(u.paragraph)("hr",u.hr)("heading",u.heading)("lheading",u.lheading)("blockquote",u.blockquote)("tag","<"+u._tag)("def",u.def)(),u.normal=l({},u),u.gfm=l({},u.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\s*\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),u.gfm.paragraph=a(u.paragraph)("(?!","(?!"+u.gfm.fences.source.replace("\\1","\\2")+"|"+u.list.source.replace("\\1","\\3")+"|")(),u.tables=l({},u.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),e.rules=u,e.lex=function(t,i){var n=new e(i);return n.lex(t)},e.prototype.lex=function(t){return t=t.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(t,!0)},e.prototype.token=function(t,e,i){for(var n,r,o,s,a,c,l,p,d,t=t.replace(/^ +$/gm,"");t;)if((o=this.rules.newline.exec(t))&&(t=t.substring(o[0].length),o[0].length>1&&this.tokens.push({type:"space"})),o=this.rules.code.exec(t))t=t.substring(o[0].length),o=o[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?o:o.replace(/\n+$/,"")});else if(o=this.rules.fences.exec(t))t=t.substring(o[0].length),this.tokens.push({type:"code",lang:o[2],text:o[3]||""});else if(o=this.rules.heading.exec(t))t=t.substring(o[0].length),this.tokens.push({type:"heading",depth:o[1].length,text:o[2]});else if(e&&(o=this.rules.nptable.exec(t))){for(t=t.substring(o[0].length),c={type:"table",header:o[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:o[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:o[3].replace(/\n$/,"").split("\n")},p=0;p<c.align.length;p++)/^ *-+: *$/.test(c.align[p])?c.align[p]="right":/^ *:-+: *$/.test(c.align[p])?c.align[p]="center":/^ *:-+ *$/.test(c.align[p])?c.align[p]="left":c.align[p]=null;for(p=0;p<c.cells.length;p++)c.cells[p]=c.cells[p].split(/ *\| */);this.tokens.push(c)}else if(o=this.rules.lheading.exec(t))t=t.substring(o[0].length),this.tokens.push({type:"heading",depth:"="===o[2]?1:2,text:o[1]});else if(o=this.rules.hr.exec(t))t=t.substring(o[0].length),this.tokens.push({type:"hr"});else if(o=this.rules.blockquote.exec(t))t=t.substring(o[0].length),this.tokens.push({type:"blockquote_start"}),o=o[0].replace(/^ *> ?/gm,""),this.token(o,e,!0),this.tokens.push({type:"blockquote_end"});else if(o=this.rules.list.exec(t)){for(t=t.substring(o[0].length),s=o[2],this.tokens.push({type:"list_start",ordered:s.length>1}),o=o[0].match(this.rules.item),n=!1,d=o.length,p=0;p<d;p++)c=o[p],l=c.length,c=c.replace(/^ *([*+-]|\d+\.) +/,""),~c.indexOf("\n ")&&(l-=c.length,c=this.options.pedantic?c.replace(/^ {1,4}/gm,""):c.replace(new RegExp("^ {1,"+l+"}","gm"),"")),this.options.smartLists&&p!==d-1&&(a=u.bullet.exec(o[p+1])[0],s===a||s.length>1&&a.length>1||(t=o.slice(p+1).join("\n")+t,p=d-1)),r=n||/\n\n(?!\s*$)/.test(c),p!==d-1&&(n="\n"===c.charAt(c.length-1),r||(r=n)),this.tokens.push({type:r?"loose_item_start":"list_item_start"}),this.token(c,!1,i),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(o=this.rules.html.exec(t))t=t.substring(o[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===o[1]||"script"===o[1]||"style"===o[1]),text:o[0]});else if(!i&&e&&(o=this.rules.def.exec(t)))t=t.substring(o[0].length),this.tokens.links[o[1].toLowerCase()]={href:o[2],title:o[3]};else if(e&&(o=this.rules.table.exec(t))){for(t=t.substring(o[0].length),c={type:"table",header:o[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:o[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:o[3].replace(/(?: *\| *)?\n$/,"").split("\n")},p=0;p<c.align.length;p++)/^ *-+: *$/.test(c.align[p])?c.align[p]="right":/^ *:-+: *$/.test(c.align[p])?c.align[p]="center":/^ *:-+ *$/.test(c.align[p])?c.align[p]="left":c.align[p]=null;for(p=0;p<c.cells.length;p++)c.cells[p]=c.cells[p].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(c)}else if(e&&(o=this.rules.paragraph.exec(t)))t=t.substring(o[0].length),this.tokens.push({type:"paragraph",text:"\n"===o[1].charAt(o[1].length-1)?o[1].slice(0,-1):o[1]});else if(o=this.rules.text.exec(t))t=t.substring(o[0].length),this.tokens.push({type:"text",text:o[0]});else if(t)throw new Error("Infinite loop on byte: "+t.charCodeAt(0));return this.tokens};var d={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:c,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:[^_]|__)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:c,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};d._inside=/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,d._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,d.link=a(d.link)("inside",d._inside)("href",d._href)(),d.reflink=a(d.reflink)("inside",d._inside)(),d.normal=l({},d),d.pedantic=l({},d.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),d.gfm=l({},d.normal,{escape:a(d.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:a(d.text)("]|","~]|")("|","|https?://|")()}),d.breaks=l({},d.gfm,{br:a(d.br)("{2,}","*")(),text:a(d.gfm.text)("{2,}","*")()}),i.rules=d,i.output=function(t,e,n){var r=new i(e,n);return r.output(t)},i.prototype.output=function(t){for(var e,i,n,r,s="";t;)if(r=this.rules.escape.exec(t))t=t.substring(r[0].length),s+=r[1];else if(r=this.rules.autolink.exec(t))t=t.substring(r[0].length),"@"===r[2]?(i=":"===r[1].charAt(6)?this.mangle(r[1].substring(7)):this.mangle(r[1]),n=this.mangle("mailto:")+i):(i=o(r[1]),n=i),s+=this.renderer.link(n,null,i);else if(this.inLink||!(r=this.rules.url.exec(t))){if(r=this.rules.tag.exec(t))!this.inLink&&/^<a /i.test(r[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(r[0])&&(this.inLink=!1),t=t.substring(r[0].length),s+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):o(r[0]):r[0];else if(r=this.rules.link.exec(t))t=t.substring(r[0].length),this.inLink=!0,s+=this.outputLink(r,{href:r[2],title:r[3]}),this.inLink=!1;else if((r=this.rules.reflink.exec(t))||(r=this.rules.nolink.exec(t))){if(t=t.substring(r[0].length),e=(r[2]||r[1]).replace(/\s+/g," "),e=this.links[e.toLowerCase()],!e||!e.href){s+=r[0].charAt(0),t=r[0].substring(1)+t;continue}this.inLink=!0,s+=this.outputLink(r,e),this.inLink=!1}else if(r=this.rules.strong.exec(t))t=t.substring(r[0].length),s+=this.renderer.strong(this.output(r[2]||r[1]));else if(r=this.rules.em.exec(t))t=t.substring(r[0].length),s+=this.renderer.em(this.output(r[2]||r[1]));else if(r=this.rules.code.exec(t))t=t.substring(r[0].length),s+=this.renderer.codespan(o(r[2],!0));else if(r=this.rules.br.exec(t))t=t.substring(r[0].length),s+=this.renderer.br();else if(r=this.rules.del.exec(t))t=t.substring(r[0].length),s+=this.renderer.del(this.output(r[1]));else if(r=this.rules.text.exec(t))t=t.substring(r[0].length),s+=this.renderer.text(o(this.smartypants(r[0])));else if(t)throw new Error("Infinite loop on byte: "+t.charCodeAt(0))}else t=t.substring(r[0].length),i=o(r[1]),n=i,s+=this.renderer.link(n,null,i);return s},i.prototype.outputLink=function(t,e){var i=o(e.href),n=e.title?o(e.title):null;return"!"!==t[0].charAt(0)?this.renderer.link(i,n,this.output(t[1])):this.renderer.image(i,n,o(t[1]))},i.prototype.smartypants=function(t){return this.options.smartypants?t.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014\/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014\/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):t},i.prototype.mangle=function(t){if(!this.options.mangle)return t;for(var e,i="",n=t.length,r=0;r<n;r++)e=t.charCodeAt(r),Math.random()>.5&&(e="x"+e.toString(16)),i+="&#"+e+";";return i},n.prototype.code=function(t,e,i){if(this.options.highlight){var n=this.options.highlight(t,e);null!=n&&n!==t&&(i=!0,t=n)}return e?'<pre><code class="'+this.options.langPrefix+o(e,!0)+'">'+(i?t:o(t,!0))+"\n</code></pre>\n":"<pre><code>"+(i?t:o(t,!0))+"\n</code></pre>"},n.prototype.blockquote=function(t){return"<blockquote>\n"+t+"</blockquote>\n"},n.prototype.html=function(t){return t},n.prototype.heading=function(t,e,i){return"<h"+e+' id="'+this.options.headerPrefix+i.toLowerCase().replace(/[^\w]+/g,"-")+'">'+t+"</h"+e+">\n"},n.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},n.prototype.list=function(t,e){var i=e?"ol":"ul";return"<"+i+">\n"+t+"</"+i+">\n"},n.prototype.listitem=function(t){return"<li>"+t+"</li>\n"},n.prototype.paragraph=function(t){return"<p>"+t+"</p>\n"},n.prototype.table=function(t,e){return"<table>\n<thead>\n"+t+"</thead>\n<tbody>\n"+e+"</tbody>\n</table>\n"},n.prototype.tablerow=function(t){return"<tr>\n"+t+"</tr>\n"},n.prototype.tablecell=function(t,e){var i=e.header?"th":"td",n=e.align?"<"+i+' style="text-align:'+e.align+'">':"<"+i+">";return n+t+"</"+i+">\n"},n.prototype.strong=function(t){return"<strong>"+t+"</strong>"},n.prototype.em=function(t){return"<em>"+t+"</em>"},n.prototype.codespan=function(t){return"<code>"+t+"</code>"},n.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},n.prototype.del=function(t){return"<del>"+t+"</del>"},n.prototype.link=function(t,e,i){if(this.options.sanitize){try{var n=decodeURIComponent(s(t)).replace(/[^\w:]/g,"").toLowerCase()}catch(r){return""}if(0===n.indexOf("javascript:")||0===n.indexOf("vbscript:"))return""}var o='<a href="'+t+'"';return e&&(o+=' title="'+e+'"'),o+=">"+i+"</a>"},n.prototype.image=function(t,e,i){var n='<img src="'+t+'" alt="'+i+'"';return e&&(n+=' title="'+e+'"'),n+=this.options.xhtml?"/>":">"},n.prototype.text=function(t){return t},r.parse=function(t,e,i){var n=new r(e,i);return n.parse(t)},r.prototype.parse=function(t){this.inline=new i(t.links,this.options,this.renderer),this.tokens=t.reverse();for(var e="";this.next();)e+=this.tok();return e},r.prototype.next=function(){return this.token=this.tokens.pop()},r.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},r.prototype.parseText=function(){for(var t=this.token.text;"text"===this.peek().type;)t+="\n"+this.next().text;return this.inline.output(t)},r.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var t,e,i,n,r,o="",s="";for(i="",t=0;t<this.token.header.length;t++)n={header:!0,align:this.token.align[t]},i+=this.renderer.tablecell(this.inline.output(this.token.header[t]),{header:!0,align:this.token.align[t]});for(o+=this.renderer.tablerow(i),t=0;t<this.token.cells.length;t++){for(e=this.token.cells[t],i="",r=0;r<e.length;r++)i+=this.renderer.tablecell(this.inline.output(e[r]),{header:!1,align:this.token.align[r]});s+=this.renderer.tablerow(i)}return this.renderer.table(o,s);case"blockquote_start":for(var s="";"blockquote_end"!==this.next().type;)s+=this.tok();return this.renderer.blockquote(s);case"list_start":for(var s="",a=this.token.ordered;"list_end"!==this.next().type;)s+=this.tok();return this.renderer.list(s,a);case"list_item_start":for(var s="";"list_item_end"!==this.next().type;)s+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(s);case"loose_item_start":for(var s="";"list_item_end"!==this.next().type;)s+=this.tok();return this.renderer.listitem(s);case"html":var c=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(c);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},c.exec=c,p.options=p.setOptions=function(t){return l(p.defaults,t),p},p.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new n,xhtml:!1},p.Parser=r,p.parser=r.parse,p.Renderer=n,p.Lexer=e,p.lexer=e.lex,p.InlineLexer=i,p.inlineLexer=i.output,p.parse=p,t.exports=p}).call(function(){return this||("undefined"!=typeof window?window:e)}())}).call(e,function(){return this}())},function(t,e){t.exports=function(t){var e='<div class="editor-content-wrap"> <textarea class="note-input" data-gta="{action: edit note}" placeholder="'+tb_i18n.get("task.detail.add.note")+'"></textarea> <span class="draft pull-left">'+tb_i18n.get("draft")+' <a class="restore-draft">'+tb_i18n.get("draft.restore")+'</a> <a class="discard-draft">'+tb_i18n.get("draft.discard")+'</a> </span></div><div class="note-handler-set flex flex-vcenter"> <div class="editor-switcher-container ';
return t.mdSupport&&(e+="visibility"),e+='"> <a class="editor-mode" data-toggle="dropdown" data-gta="{aciton: \'switch editor mode\'}"> <span class="editor-name pull-left">'+t.modeTitle+'</span> <span class="icon icon-chevron-down"></span> </a> <ul class="dropdown-menu" role="menu"> <li> <a class="editor-switcher-handler" data-mode="html" data-gta="{action: \'switch editor mode\', type: \'rich text\'}"> <span class="switcher-name">'+tb_i18n.get("editor.mode.html")+'</span> <span class="icon icon-tick"></span> </a> </li> <li> <a class="editor-switcher-handler" data-mode="md" data-gta="{action: \'switch editor mode\', type: \'markdown\'}"> <span class="switcher-name">'+tb_i18n.get("markdown.helper.title")+'</span> <span class="icon icon-tick"></span> </a> </li> </ul> </div> <a class="cancel-note-handler">'+tb_i18n.get("cancel")+'</a> <a class="save-note-handler btn btn-primary">'+tb_i18n.get("save")+'</a></div><div class="fake-upload-container hidden"></div>'}},function(t,e,i){var n;n=i(357),t.exports=Object.create(n.Events)},function(t,e,i){var n;n=i(449),t.exports={setup:function(){return n.locale="simditor",n.i18n={simditor:{blockquote:tb_i18n.get("simditor.blockquote"),bold:tb_i18n.get("simditor.bold"),code:tb_i18n.get("simditor.code"),color:tb_i18n.get("simditor.color"),coloredText:tb_i18n.get("simditor.coloredText"),hr:tb_i18n.get("simditor.hr"),image:tb_i18n.get("simditor.image"),externalImage:tb_i18n.get("simditor.externalImage"),uploadImage:tb_i18n.get("simditor.uploadImage"),uploadFailed:tb_i18n.get("simditor.uploadFailed"),uploadError:tb_i18n.get("simditor.uploadError"),imageUrl:tb_i18n.get("simditor.imageUrl"),imageSize:tb_i18n.get("simditor.imageSize"),imageAlt:tb_i18n.get("simditor.imageAlt"),restoreImageSize:tb_i18n.get("simditor.restoreImageSize"),uploading:tb_i18n.get("simditor.uploading"),indent:tb_i18n.get("simditor.indent"),outdent:tb_i18n.get("simditor.outdent"),italic:tb_i18n.get("simditor.italic"),link:tb_i18n.get("simditor.link"),text:tb_i18n.get("simditor.text"),linkTextTitle:tb_i18n.get("simditor.add.link.title"),linkText:tb_i18n.get("simditor.linkText"),linkUrl:tb_i18n.get("simditor.linkUrl"),linkUrlSubmit:tb_i18n.get("confirm"),removeLink:tb_i18n.get("simditor.removeLink"),ol:tb_i18n.get("simditor.ol"),ul:tb_i18n.get("simditor.ul"),strikethrough:tb_i18n.get("simditor.strikethrough"),table:tb_i18n.get("simditor.table"),deleteRow:tb_i18n.get("simditor.deleteRow"),insertRowAbove:tb_i18n.get("simditor.insertRowAbove"),insertRowBelow:tb_i18n.get("simditor.insertRowBelow"),deleteColumn:tb_i18n.get("simditor.deleteColumn"),insertColumnLeft:tb_i18n.get("simditor.insertColumnLeft"),insertColumnRight:tb_i18n.get("simditor.insertColumnRight"),deleteTable:tb_i18n.get("simditor.deleteTable"),title:tb_i18n.get("simditor.title"),normalText:tb_i18n.get("simditor.normalText"),underline:tb_i18n.get("simditor.underline"),alignment:tb_i18n.get("simditor.alignment"),alignCenter:tb_i18n.get("simditor.alignCenter"),alignLeft:tb_i18n.get("simditor.alignLeft"),alignRight:tb_i18n.get("simditor.alignRight"),selectLanguage:tb_i18n.get("simditor.selectLanguage"),upload:tb_i18n.get("simditor.upload")}}}}},function(t,e){t.exports=function(t){var e='<div class="note-adder-set"> <span class="icon icon-book detail-infos-icon"></span> <a class="add-note-handler" data-gta="{action: edit note}"> '+tb_i18n.get("task.detail.add.note")+' </a></div><div class="note-wrap"> <div class="note-container"> <div class="note-text-set"> <span class="detail-infos-icon icon icon-book"></span> <div class="note-text readable ';return t.permissions.putNote&&!t.permissions.isArchived&&(e+="hinted click-eidtable"),e+='" data-gta="{action: edit note}" data-title="'+tb_i18n.get("clickToEdit")+'"></div> </div> </div> <div class="note-button hide"> <a class="toggle-note-handler show-all-handler">'+tb_i18n.get("note.expand")+'</a> <a class="toggle-note-handler collapse-all-handler hide">'+tb_i18n.get("note.collapse")+"</a> </div></div>",t.permissions.putNote&&(e+='<div class="note-input-set"> <span class="detail-infos-icon icon icon-book"></span> <div class="note-input-wrap"> </div></div>'),e}},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;p=i(678),l=i(788),c=i(804),o=i(1126),a=i(1027),s=i(817),n=i(1155),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="DetailInfosRepeatView",e.prototype.className="detail-infos-repeat-view",e.prototype.events={"click .set-repeat-handler":"openRepeatMenu"},e.prototype.initialize=function(t){if(null==t&&(t={}),null!=t?t.objectModel:void 0)return this.options=t,this.eventModel=this.options.objectModel,this.renderBasic().listen(),this},e.prototype.listen=function(){return this.listenTo(this.eventModel,"change:recurrence",this.renderBasic),this},e.prototype.renderBasic=function(){var t,e;if(this.$el)return t={},this.eventModel.isRecurrenceEventInstance()?(this.rruleSet=this.eventModel.getRRuleSet(),e=c.freq2Label(this.rruleSet),t.title="CUSTOM"===e?c.freq2Description(this.rruleSet):c.freq2Title(this.rruleSet)):t.title=tb_i18n.get("repeat.add"),t.permissions=this.eventModel.hasPermissions("event.put"),this.$el.html(n(t)),this.$list=this.$(".tags-list"),this},e.prototype.openRepeatMenu=function(t){var e,i;return!this.eventModel.get("isArchived")&&(i=this.$(".add-handler-place"),e=$(t.currentTarget),i.css("left",t.pageX-e.offset().left),i.data("bs.popover")?i.click():this.repeatSelectorView=this.requestSubView(a,{$toggler:i,recurrence:this.eventModel.get("recurrence"),startDate:this.eventModel.get("startDate"),select:function(t){return function(e){return t.eventModel.isRecurrenceEventInstance()?o.setRepeat(t.eventModel,e):t.eventModel.save(null,{attrs:{recurrence:e}})}}(this)}).show(),this)},e.prototype.isCase=function(){return this.eventModel.isRecurrenceEventInstance()},e.prototype.hasPermission=function(){return this.eventModel.hasPermission("event.put")||this.isCase()},e}(l)},function(t,e){t.exports=function(t){var e='<div class="repeat-wrap"> <span class="add-handler-place"></span> <span class="icon icon-repeat detail-infos-icon"></span> <a ';return t.permissions.eventPut&&(e+='class="set-repeat-handler"'),e+=">"+(t.title||tb_i18n.get("repeat.add"))+"</a></div>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h=function(t,e){function i(){this.constructor=t}for(var n in e)m.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},m={}.hasOwnProperty;u=i(358),d=i(678),s=i(429),p=i(788),c=i(447),l=i(677),o=i(1126),a=i(1021),n=i(1157),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.viewName="DetailInfosReminderView",e.prototype.className="detail-infos-reminder-view",e.prototype.events={"click .set-reminder-handler":"openReminderMenu"},e.prototype.initialize=function(t){if(null==t&&(t={}),null!=t?t.objectModel:void 0)return this.options=t,this.eventModel=this.options.objectModel,this.initData().renderBasic().listen(),this},e.prototype.initData=function(){return this.eventModel.isRecurrenceEventInstance()?(this.isRecurrenceEventInstance=!0,this.rruleSet=this.eventModel.getRRuleSet()):this.isRecurrenceEventInstance=!1,this.rruleSet||(this.rruleSet=new c.RRuleSet,this.rruleSet.rrule(new c({freq:c.WEEKLY,dtstart:new Date(this.eventModel.get("startDate"))}))),this},e.prototype.listen=function(){return this.listenTo(this.eventModel,"change:reminders",this.renderBasic),this},e.prototype.renderBasic=function(){var t,e,i,r;switch(e=this.eventModel.get("reminders").length?this.eventModel.get("reminders")[0]:{minutes:-1},e.minutes){case-1:i=tb_i18n.get("remind.add");break;case 0:i=tb_i18n.get("remind.happened");break;default:r=s.duration(e.minutes,"minutes").humanize(),i=tb_i18n.get("remind.ago",r)}return t={title:i,permissions:this.eventModel.hasPermissions("event.put")},this.$el.html(n(t)),this},e.prototype.openReminderMenu=function(t){var e,i,n,r,c,l,p,d,h,m;if(this.eventModel.get("isArchived"))return!1;for(e=$(t.currentTarget),i=this.$(".add-handler-place"),i.css({left:t.pageX-e.offset().left}),r=this.eventModel.get("reminders").length?this.eventModel.get("reminders")[0]:{method:"popup",minutes:-1},n=[],d=[-1,0,5,15,30,60,120,1440],c=0,l=d.length;c<l;c++){switch(p=d[c]){case-1:m=tb_i18n.get("remind.close");break;case 0:m=tb_i18n.get("remind.happened");break;default:h=s.duration(p,"minutes").humanize(),m=tb_i18n.get("remind.ago",h)}n.push({_id:p,title:m})}return i.data("bs.popover")?i.click():this.requestSubView(a,{$toggler:i,width:170,dataList:n,selected:r.minutes,select:function(t){return function(e){var i,n;return e===-1?i={reminders:[]}:(n=u.clone(r),n.minutes=e,i={reminders:[n]}),t.eventModel.isRecurrenceEventInstance()?o.saveAttrs(t.eventModel,i):t.eventModel.save(null,{attrs:i})}}(this)}).show(),this},e.prototype.isCase=function(){return this.eventModel.get("reminders").length},e.prototype.hasPermission=function(){return this.eventModel.hasPermission("event.put")||this.isCase()},e}(p)},function(t,e){t.exports=function(t){var e='<div class="reminder-wrap"> <span class="add-handler-place"></span> <span class="icon icon-alert-clock detail-infos-icon"></span> <a ';return t.permissions.eventPut&&(e+='class="set-reminder-handler"'),e+=">"+t.title+"</a></div>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m=function(t,e){function i(){this.constructor=t}for(var n in e)f.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},f={}.hasOwnProperty;d=i(358),h=i(678),u=i(788),c=i(696),l=i(1053),a=i(1021),o=i(1126),n=i(1159),s=i(1160),p=i(1161),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.viewName="DetailInfosTagView",e.prototype.className="detail-infos-tag-view",e.prototype.events={"click .add-tag-handler:not(.disabled)":"openTagMenu","click .remove-tag-handler":"quickRemoveTag"},e.prototype.initialize=function(t){if((null!=t?t.objectModel:void 0)&&(null!=t?t._projectId:void 0))return this.options=t,this._projectId=t._projectId,this.objectModel=t.objectModel,l.fetch(null!=t?t._projectId:void 0,{boundToObjectType:"project",success:function(t){return function(e){return t.tagsCollection=e,t.renderBasic().setTags().render().listen()}}(this)}),this},e.prototype.listen=function(){return this.listenTo(this.objectModel,"change:tagIds",this.refresh),this.listenTo(this.tagsCollection,"change",this.render),this},e.prototype.setTags=function(){var t;return this.tags=(null!=(t=this.objectModel.get("tagIds"))?t.slice():void 0)||[],this},e.prototype.renderBasic=function(){var t;return t=this.objectModel.toJSON(),t.permissions=this.objectModel.hasPermissions("put.tag"),t.isArchived=this.objectModel.get("isArchived"),t.disabled=this.options.disabled,this.$el.html(n(t)),this.$list=this.$(".tags-list"),this},e.prototype.render=function(){var t,e,i,n,r,o,s;for(s=[],n=this.tags,e=0,i=n.length;e<i;e++)t=n[e],o=null!=(r=this.tagsCollection.get(t))?r.toJSON():void 0,(null!=o?o._id:void 0)&&!o.isArchived&&s.push(o);return this.$el[s.length?"addClass":"removeClass"]("withTag"),this.$("li.tag-wrap").remove(),this.$list.prepend(p({tags:s,canDelete:this.objectModel.hasPermissions("del.tag")&&!this.options.disabled})),this},e.prototype.openTagMenu=function(){var t,e;return t=this.$(".add-handler-place"),!this.objectModel.get("isArchived")&&(e=d.extend({},this.options,{fixed:this.$el.closest(".panel-view").length,$toggler:t,ListTemplate:s,multi:!0,selected:this.tags,addPlaceholder:tb_i18n.get("tag.picker.add"),unselectPermission:this.objectModel.hasPermission("del.tag"),select:function(t){return function(e){return t.setTag(e)}}(this),unselect:function(t){return function(e){return t.removeTag(e)}}(this),add:function(t){return function(e){return t.addTag(e)}}(this),onHidden:function(t){return function(){return t.saveTags()}}(this),dataList:this.tagsCollection.map(function(t){return{_id:t.get("_id"),title:t.get("name"),color:t.get("color")}})}),t.data("bs.popover")?t.click():this.tagMenu=this.requestSubView(a,e).show(),this)},e.prototype.hideTagMenu=function(){var t;return null!=(t=this.tagMenu)&&t.hide(),this},e.prototype.refresh=function(){return this.setTags().render(),this},e.prototype.addTag=function(t){return this.tagsCollection.create({name:t,_projectId:this._projectId},{wait:!0,success:function(t){return function(e){if(t.tags=d.union(t.tags,[e.id]),t.tagMenu.update(t.tagsCollection.map(function(t){return{_id:t.get("_id"),title:t.get("name"),color:t.get("color")}}),t.tags.slice()),t.render(),t.fadeIn(e.id),!t.objectModel.id)return t.saveTags()}}(this)}),this},e.prototype.setTag=function(t){return this.tags=d.union(this.tags,[t]),this.render(),this.fadeIn(t),this.objectModel.id||this.saveTags(),this},e.prototype.removeTag=function(t){var e;return this.tags=d.without(this.tags,t),null!=(e=this.tagMenu)&&e.update(this.tagsCollection.map(function(t){return{_id:t.get("_id"),title:t.get("name"),color:t.get("color")}}),this.tags.slice()),this.fadeOut(t),this.objectModel.id||this.saveTags(),this.tags.length||this.render(),this},e.prototype.saveTags=function(){var t,e;if(this.objectModel&&(e=this.tags.slice(),!d.isEqual(e,this.objectModel.get("tagIds"))))return this.objectModel.id?("function"==typeof(t=this.objectModel).isRecurrenceEventInstance?t.isRecurrenceEventInstance():void 0)?(this.objectModel.set("tagIds",e),o.saveAttrs(this.objectModel,{}).then(function(t){return function(i){return i.saveAttr("tagIds",e,{success:function(){return t.trigger("over")}})}}(this))):this.objectModel.saveAttr("tagIds",e,{success:function(t){return function(){return t.trigger("over")}}(this)}):(this.objectModel.set("tagIds",e),this.trigger("over")),this},e.prototype.fadeIn=function(t){return this.$list.find(".tag-wrap[data-id="+t+"]").transition({opacity:0},0).transition({opacity:1}),this},e.prototype.fadeOut=function(t){return this.$list.find(".tag-wrap[data-id="+t+"]").transition({opacity:0},function(){return $(this).remove()}),this},e.prototype.quickRemoveTag=function(t){var e;return e=$(t.currentTarget).parent().data("id"),this.removeTag(e),d.delay(function(t){return function(){return t.saveTags()}}(this),100),this},e.prototype.isCase=function(){var t;return!!(null!=(t=this.tags)?t.length:void 0)},e.prototype.hasPermission=function(){return this.objectModel.hasPermission("put.tag")},e}(u)},function(t,e){t.exports=function(t){var e='<div class="tag-add-wrap"> <span class="icon icon-tag detail-infos-icon"></span> <ul class="tags-list clearfix"> ';return t.permissions.putTag&&(e+=' <li class="tag-picker-add child-tree"> <span class="add-handler-place"></span> <a class="add-tag-handler clearfix ',t.disabled&&(e+="disabled"),e+='" data-gta="{action: \'set tags\'}"> <span class="icon icon-plus-sign  ',t.isArchived||(e+="hinted"),e+='" data-title="'+tb_i18n.get("tag.picker.add")+'"></span> <span class="add-tag-handler-tips">'+tb_i18n.get("tag.picker.add")+"</span> </a> </li> "),e+=" </ul></div>"}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(963).calculateColor,o=t.dataList;if(o)for(var s,a=-1,c=o.length-1;a<c;)s=o[a+=1],n+='<li class="menu-item tag-item ',s.selected&&(n+="selected"),n+='" data-id="'+s._id+'"> <a class="tag"> <span class="tag-label" style="background-color: '+r(s.color,s.colorRGBA)+'"></span> <span class="tag-name">'+e(s.title)+"</span> </a></li>";return n}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(963).calculateColor,o=t.tags;if(o)for(var s,a=-1,c=o.length-1;a<c;)s=o[a+=1],n+=' <li class="tag-wrap ',t.canDelete&&(n+="removeable"),n+='" data-id="'+s._id+'"> <span class="tag label"> <span class="tag-label" style="background-color: '+r(s.color,s.colorRGBA)+'"></span> <span class="tag-name">'+e(s.name)+"</span> </span> ",t.canDelete&&(n+=' <a class="remove-tag-handler" data-gta="{action: \'delete tag\'}">&times;</a> '),n+=" </li>";return n}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;p=i(677),u=i(788),s=i(697),o=i(1005),c=i(1163),l=i(1032),n=i(1170),r=i(1171),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.viewName="SubtaskCardView",e.prototype.className="subtask-card",e.prototype.events={"click .subtask-add-handler":"edit","keydown .subtask-creator .subtask-input":"quickSubmit","click .subtask-creator .cancel-subtask-handler":"cancel","click .subtask-creator .save-subtask-handler":"submit","click .subtask-creator .avatar":"toggleExecutorSelector","click a.task-datepicker":"showDatePicker","click a.task-timepicker":"showTimePicker"},e.prototype.creating=!1,e.prototype.initialize=function(t){return!!((null!=t?t.subtasksCollection:void 0)&&(null!=t?t.taskModel:void 0)&&(null!=t?t.membersCollection:void 0))&&(this.options=t,this.taskModel=t.taskModel,this.projectModel=s.get(this.taskModel.get("_projectId")),this.subtasksCollection=t.subtasksCollection,this.membersCollection=t.membersCollection,this.creating=!1,this.renderBasic(),this.renderSubtasks(),this.taskModel.hasPermission("put")&&this.setupSubtaskSortable(),this._executorId=this.taskModel.get("_executorId"),this.renderExecutor(),this.renderDueDate(),this.renderAddIcon(),this.listen(),this)},e.prototype.listen=function(){return this.listenTo(this.subtasksCollection,"add",this.renderSubtask),this.listenTo(this.subtasksCollection,"add remove change",this.renderAddIcon),this.listenTo(this.projectModel,"change:applications",function(){if(this.projectModel.isAppChanged("preciseDate"))return this.renderDueDate()}),this},e.prototype.renderBasic=function(){return this.$el.html(n({permissions:this.taskModel.hasPermissions("subtask.post")})),this.$list=this.$(".subtasks-list"),this.$creator=this.$(".subtask-creator"),this.$input=this.$(".subtask-input").flexText(),this},e.prototype.renderExecutor=function(){var t,e,i;return e=(null!=(i=this.membersCollection.get(this._executorId))?i.toJSON():void 0)||{},t=this.$creator.find(".avatar"),e.avatarUrl&&e.name?t.data("title",e.name).removeClass("no-avatar").attr("style","background-image:url("+e.avatarUrl+")"):t.data("title",tb_i18n.get("task.detail.no.executor")).addClass("no-avatar").attr("style",""),this},e.prototype.renderDueDate=function(){var t,e;return e=this.dueDate,t={endDateString:e?p.formatDate(e).dateString:"",endTimeString:e?p.formatDate(e).timeFormatString:"",preciseDate:this.projectModel.isAppEnabled("preciseDate")},this.$(".subtask-creator-duedate-handler").html(r(t)),this},e.prototype.renderSubtasks=function(){return this.subtasksCollection.updateSort(this.taskModel.get("subtaskIds")),this.subtasksCollection.each(function(t){return function(e){return t.renderSubtask(e)}}(this)),this},e.prototype.renderSubtask=function(t){return this.requestSubView(c,{subtaskModel:t,taskModel:this.taskModel,membersCollection:this.membersCollection}).$el.appendTo(this.$list),this},e.prototype.renderAddIcon=function(){return this.subtasksCollection.length?this.$(".subtask-creator .icon-checkbox").removeClass("icon-checkbox").addClass("icon-circle-cross"):this.$(".subtask-creator .icon-circle-cross").addClass("icon-checkbox").removeClass("icon-circle-cross"),this},e.prototype.setupSubtaskSortable=function(){return this.$list.sortable({items:".subtask-view",helper:"clone",placeholder:"subtask-drag-placeholder",tolerance:"pointer",zIndex:2001,axis:"y",start:function(t,e){return e.placeholder.height(e.helper.outerHeight())},update:function(t){return function(e,i){var n;return n=t.$list.find(".subtask-view").map(function(t,e){return $(e).data("id")}).toArray(),t.taskModel.saveAttr("subtaskIds",n)}}(this)}),this},e.prototype.showDatePicker=function(t){var e,i,n;return t.preventDefault(),e=$(t.currentTarget),e.data("showDatePicker")?this:(e.data("showDatePicker",!0),n=this.dueDate,i=n?new Date(n):new Date,e.datepicker({format:"yyyy-mm-dd",language:tb_i18n.getLanguage(),todayHighlight:!0,placement:"left",todayBtn:"linked",tomorrowBtn:"linked",clearBtn:"linked"}).datepicker("update",this.parseDate(i)).datepicker("show").focus().on("changeDate",function(t){return function(i){return e.datepicker("hide"),t.changeDateHandler(i.date)}}(this)))},e.prototype.parseDate=function(t){var e;return t instanceof Date||(t=new Date(t)),e=new Date(t.getFullYear(),t.getMonth(),t.getDate())},e.prototype.changeDateHandler=function(t){var e,i,n;return t&&(this.projectModel.isAppEnabled("preciseDate")?this.dueDate?(e=new Date(this.dueDate),i=e.getHours(),n=e.getMinutes()):(i=18,n=0):(i=0,n=0),t.setHours(i),t.setMinutes(n)),this.saveDueDate(t),this},e.prototype.saveDueDate=function(t){return p.isSameDate(this.dueDate,t)||(this.dueDate=t,this.renderDueDate(),this.$input.focusAtEnd()),this},e.prototype.showTimePicker=function(t){var e,i,n;if(t.preventDefault(),e=$(t.currentTarget),!e.data("showTimePicker"))return e.data("showTimePicker",!0),i=this.dueDate,null!=(n=this.timePickerView)&&n.remove(),this.timePickerView=this.requestSubView(l,{addPlaceholder:tb_i18n.get("time.input.placeholder"),$toggler:e,currentDate:i,startDate:null,select:function(t){return function(e){var n;return n=new Date(i),n.setHours(e.hours),n.setMinutes(e.minutes),t.saveDueDate(n)}}(this)}).show(),this},e.prototype.toggleExecutorSelector=function(t){var e,i,n;return e=$(t.currentTarget),i="toggleExecutorSelector",e.data(i)?this:(e.data(i,!0),null!=(n=this.executorSelectorView)&&n.remove(),this.executorSelectorView=this.requestSubView(o,{$toggler:e,noAssign:!0,membersCollection:this.membersCollection,selected:this._executorId,select:function(t){return function(e){var i;return i=e[0],t._executorId=i,t.renderExecutor()}}(this)}).show(),this)},e.prototype.edit=function(){return this.taskModel.get("isArchived")||(this.$creator.addClass("creating"),this.$input.focusAtEnd(),this.$creator.handleClickOutside(function(t){return function(){if(!t.$input.val().trim())return t.cancel()}}(this),"click",".member-menu-view")),this},e.prototype.cancel=function(){return this.$creator.removeClass("creating"),this},e.prototype.quickSubmit=function(t){return 13===t.keyCode&&(t.preventDefault(),this.submit()),this},e.prototype.submit=function(t){var e;return this.creating?this:(e=this.$input.val().trim(),(e=e.replace(/\s+/g," ").trim())?(this.creating=!0,this.subtasksCollection.create({_taskId:this.taskModel.id,_executorId:this._executorId,dueDate:this.dueDate,content:e},{wait:!0,success:function(t){return function(e){return e.set("task",t.taskModel.toJSON()),t.$input.val(""),t.$input.prev().remove(),t.creating=!1,t.$input.focusAtEnd()}}(this),error:function(t){return function(){return t.creating=!1,t.$input.focusAtEnd()}}(this)}),this):this)},e.prototype.isCase=function(){var t;return!!(null!=(t=this.taskModel.get("subtaskCount"))?t.total:void 0)},e.prototype.hasPermission=function(){return this.taskModel.hasPermission("subtask.post")},e}(u)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h=function(t,e){function i(){this.constructor=t}for(var n in e)m.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},m={}.hasOwnProperty;d=i(358),p=i(677),u=i(788),s=i(697),o=i(1005),a=i(1164),l=i(1032),n=i(1168),r=i(1169),t.exports=c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.viewName="SubtaskView",e.prototype.tagName="li",e.prototype.className="subtask-view toggler-parent",e.prototype.events={"click .check-box":"toggleSubtask","click .subtask-menu-toggler":"toggleSubtaskMenu","click .subtask-content.on-editable":"editSubtask","blur .subtask-input":"cancelUpdateByContent","click .save-subtask-handler":"updateSubtask","click .cancel-subtask-handler":"cancelUpdate","keydown .subtask-input":"quickUpdate","click a.avatar":"toggleExecutorSelector","click a.task-datepicker":"showDatePicker","click a.task-timepicker":"showTimePicker"},e.prototype.initialize=function(t){return!!((null!=t?t.subtaskModel:void 0)&&(null!=t?t.membersCollection:void 0))&&(this.options=t,this.subtaskModel=t.subtaskModel,this.taskModel=t.taskModel,this.projectModel=s.get(this.taskModel.get("_projectId")),this.membersCollection=t.membersCollection,this.renderBasic(),this.renderExecutor(),this.renderDueDate(),this.renderContent(),this.renderStatus(),this.listen(),this.$el.attr("data-id",this.subtaskModel.id),this.subtaskModel.getRoleScope()>=0||this.$el.addClass("guest"),this)},e.prototype.listen=function(){return this.listenTo(this.subtaskModel,"remove",this.remove),this.listenTo(this.subtaskModel,"change:isDone",this.renderStatus),this.listenTo(this.subtaskModel,"change:content",this.renderContent),this.listenTo(this.subtaskModel,"change:dueDate",this.renderDueDate),this.listenTo(this.projectModel,"change:applications",function(){if(this.projectModel.isAppChanged("preciseDate"))return this.renderDueDate()}),this.listenTo(this.subtaskModel,"change:_executorId",function(t){return function(){var e;return e=t.$subtaskInput.val().trim(),e=e.replace(/\s+/g," ").trim(),t.renderBasic(),t.renderExecutor(),t.renderDueDate(),t.renderContent(e),t.renderStatus()}}(this)),this},e.prototype.renderBasic=function(){var t;return t=this.subtaskModel.toJSON(),t.permissions=this.subtaskModel.hasPermissions("put","put.status","put.executor","put.dueDate","put.transform","del"),t.isArchived=this.taskModel.get("isArchived"),this.$el.html(n(t)),this.$subtaskInput=this.$(".subtask-input"),this.$executor=this.$(".avatar"),this.$content=this.$(".subtask-content"),this.$checkBox=this.$(".check-box"),this},e.prototype.renderExecutor=function(){var t,e,i;return t=this.subtaskModel.get("_executorId"),e=(null!=(i=this.membersCollection.get(t))?i.toJSON():void 0)||{},e.avatarUrl&&e.name?this.$executor.data("title",e.name).removeClass("no-avatar").attr("style","background-image:url("+e.avatarUrl+")"):this.$executor.data("title",tb_i18n.get("task.detail.no.executor")).addClass("no-avatar").attr("style",""),this},e.prototype.renderDueDate=function(){var t,e;return e=this.subtaskModel.get("dueDate"),t={permissions:this.subtaskModel.hasPermissions("put.dueDate"),endDateString:e?p.formatDate(e).dateString:"",endTimeString:e?p.formatDate(e).timeFormatString:"",preciseDate:this.projectModel.isAppEnabled("preciseDate")},this.$(".subtask-detail-duedate-handler").html(r(t)),this},e.prototype.renderContent=function(t){var e;return"string"!=typeof t&&(t=!1),e=d.unescape(this.subtaskModel.get("content").trim()),this.$content.text(t||e),this.$subtaskInput.val(t||e),this.$subtaskInput.flexText(),this},e.prototype.renderStatus=function(){return this.$el[this.subtaskModel.get("isDone")?"addClass":"removeClass"]("done"),this},e.prototype.showDatePicker=function(t){var e,i,n;return t.preventDefault(),!this.taskModel.get("isArchived")&&(e=$(t.currentTarget),e.data("showDatePicker")?this:(e.data("showDatePicker",!0),n=this.subtaskModel.get("dueDate"),i=n?new Date(n):new Date,e.datepicker({format:"yyyy-mm-dd",language:tb_i18n.getLanguage(),todayHighlight:!0,placement:"left",todayBtn:"linked",tomorrowBtn:"linked",clearBtn:"linked"}).datepicker("update",this.parseDate(i)).datepicker("show").focus().on("changeDate",function(t){return function(i){return e.datepicker("hide"),t.changeDateHandler(i.date)}}(this))))},e.prototype.parseDate=function(t){var e;return t instanceof Date||(t=new Date(t)),e=new Date(t.getFullYear(),t.getMonth(),t.getDate())},e.prototype.changeDateHandler=function(t){var e,i,n;return t&&(this.projectModel.isAppEnabled("preciseDate")?this.subtaskModel.get("dueDate")?(e=new Date(this.subtaskModel.get("dueDate")),i=e.getHours(),n=e.getMinutes()):(i=18,n=0):(i=0,n=0),t.setHours(i),t.setMinutes(n)),this.saveDueDate(t)},e.prototype.saveDueDate=function(t){return p.isSameDate(this.subtaskModel.get("dueDate"),t)||this.subtaskModel.editDueDate(t),this},e.prototype.showTimePicker=function(t){var e,i,n;return t.preventDefault(),!this.taskModel.get("isArchived")&&(e=$(t.currentTarget),e.data("showTimePicker")?void 0:(e.data("showTimePicker",!0),i=this.subtaskModel.get("dueDate"),null!=(n=this.timePickerView)&&n.remove(),this.timePickerView=this.requestSubView(l,{addPlaceholder:tb_i18n.get("time.input.placeholder"),$toggler:e,currentDate:i,startDate:null,select:function(t){return function(e){var n;return n=new Date(i),n.setHours(e.hours),n.setMinutes(e.minutes),t.saveDueDate(n)}}(this)}).show(),this))},e.prototype.toggleExecutorSelector=function(t){var e,i,n;return!this.taskModel.get("isArchived")&&(e=$(t.currentTarget),i="toggleExecutorSelector",e.data(i)?this:(e.data(i,!0),null!=(n=this.executorSelectorView)&&n.remove(),this.executorSelectorView=this.requestSubView(o,{$toggler:e,noAssign:!0,membersCollection:this.membersCollection,selected:[this.subtaskModel.get("_executorId")],select:function(t){return function(e){var i;return i=e[0],t.subtaskModel.saveAttr("_executorId",i)}}(this)}).show(),this))},e.prototype.editSubtask=function(){return this.$el.addClass("editing"),this.$subtaskInput.focusAtEnd(),this},e.prototype.quickUpdate=function(t){return 13===t.keyCode&&(t.preventDefault(),this.$subtaskInput.blur()),this},e.prototype.updateSubtask=function(){var t,e;if(this.$el.hasClass("editing"))return t=this.$subtaskInput.val().trim(),t=t.replace(/\s+/g," ").trim(),e=this.subtaskModel.get("content"),t?t!==e&&this.subtaskModel.saveAttr("content",t):this.cancelUpdate(),this.$el.removeClass("editing"),this},e.prototype.cancelUpdateByContent=function(){if(this.$subtaskInput.val().trim()===this.subtaskModel.get("content"))return this.cancelUpdate()},e.prototype.cancelUpdate=function(){if(this.$el.hasClass("editing"))return this.$subtaskInput.val(this.subtaskModel.get("content")),this.$el.removeClass("editing")},e.prototype.toggleSubtask=function(t){var e;return e=$(t.currentTarget),e.hasClass("non-checkable")||this.taskModel.get("isArchived")?this:(this.subtaskModel.saveAttr("isDone",!this.subtaskModel.get("isDone")),this)},e.prototype.toggleSubtaskMenu=function(t){var e;return e=$(t.currentTarget),e.data("bs.popover")?this:(this.requestSubView(a,{$toggler:e,subtaskModel:this.subtaskModel,onShown:function(t){return function(){return t.$el.addClass("on-menu-showing")}}(this),onHidden:function(t){return function(){return t.$el.removeClass("on-menu-showing")}}(this)}).show(),this)},e}(u)},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;p=i(678),n=i(1165),r=i(1166),s=i(813),l=i(1167),a=i(681),o=i(401),t.exports=c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="SubtaskMenuView",e.prototype.className="subtask-menu-view",e.prototype.popoverTitle="",e.prototype.events={"click .transform-handler":"enterTransformSubMenu","click .delete-handler":"enterDeleteSubMenu","submit .delete-form":"submitDeleteForm","submit .transform-form":"transformSubtask","click .subtask-menu-check-handler":"toggleLink"},e.prototype.initialize=function(t){var i;return this.popoverTitle=tb_i18n.get("subtask.menu.title"),this.localCache=a.namespace("temp").namespace("subtask_menu"),this.localCacheId=""+p.user.id,
i=this.localCache(this.localCacheId)||{},this.isLink=i.isLink,this.isLinked=i.isLinked,e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){var t;return t=this.options.subtaskModel.toJSON(),t.permissions=this.options.subtaskModel.hasPermissions("put.transform","del"),this.$el.html(n(t)),this},e.prototype.transformSubtask=function(t){return t.preventDefault(),this.options.subtaskModel.transform({attrs:{doLink:this.isLink,doLinked:this.isLinked}}),this.hide()},e.prototype.enterDeleteSubMenu=function(){return this.enterSubMenu(tb_i18n.get("subtask.menu.delete.title"),function(t){return function(){return t.$el.html(r())}}(this)),this},e.prototype.enterTransformSubMenu=function(){return this.enterSubMenu(tb_i18n.get("subtask.menu.transform.title"),function(t){return function(){return t.$el.html(l())}}(this)),this.checkStatus(),this},e.prototype.submitDeleteForm=function(t){return t.preventDefault(),this.hide(),this.options.subtaskModel.destroy({wait:!0,success:function(){return o.show({message:tb_i18n.get("delete.success"),status:"success"})}}),this},e.prototype.checkStatus=function(){return this.$(".subtask-menu-check-handler[data-type=link]")[this.isLink?"addClass":"removeClass"]("active"),this.$(".subtask-menu-check-handler[data-type=linked]")[this.isLinked?"addClass":"removeClass"]("active"),this},e.prototype.toggleLink=function(t){var e,i;return e=$(t.currentTarget),i=e.data("type"),"link"===i?this.isLink=!this.isLink:"linked"===i&&(this.isLinked=!this.isLinked),this.cacheData(),this.checkStatus(),this},e.prototype.cacheData=function(){var t;return t={isLink:this.isLink,isLinked:this.isLinked},this.localCache(this.localCacheId,t),this},e}(s)},function(t,e){t.exports=function(t){var e='<ul class="list"> ';return t.permissions.putTransform&&(e+=' <li> <a class="transform-handler"> <span class="icon icon-convert"></span>'+tb_i18n.get("subtask.menu.transform.title")+" </a> </li> "),e+=" ",t.permissions.del&&(e+=' <li> <a class="delete-handler" data-gta="{action: \'delete subtask\', type: \'task\'}"> <span class="icon icon-trash"></span>'+tb_i18n.get("subtask.menu.delete.title")+" </a> </li> "),e+="</ul>"}},function(t,e){t.exports=function(t){var e='<form class="delete-form"> <p>'+tb_i18n.get("subtask.menu.confirm.delete")+'</p> <button class="btn btn-danger" type="submit">'+tb_i18n.get("delete")+"</button></form>";return e}},function(t,e){t.exports=function(t){var e='<form class="transform-form"> <p class="transform-tips">'+tb_i18n.get("subtask.menu.confirm.transform")+'</p> <div class="subtask-menu-check-set"> <div class="subtask-menu-check"> <a class="subtask-menu-check-handler" data-type="link"> <div class="check-box pull-left flex flex-center flex-vcenter"> <span class="icon icon-tick"></span> </div> <span>'+tb_i18n.get("task.menu.copy.check.link")+'</span> </a> </div> <div class="subtask-menu-check"> <a class="subtask-menu-check-handler"  data-type="linked"> <div class="check-box pull-left flex flex-center flex-vcenter"> <span class="icon icon-tick"></span> </div> <span>'+tb_i18n.get("task.menu.copy.check.linked")+"</span> </a> </div> </div> <button class=\"btn btn-primary\" type=\"submit\" data-gta=\"{action: 'added content', type: 'task', control: 'convert subtask'}\"> "+tb_i18n.get("confirm")+" </button></form>";return e}},function(t,e){t.exports=function(t){var e='<div class="subtask-wrap row-flex ';return t.permissions.put&&(e+="on-sortable"),e+='"> <header> <div class="check-box flex flex-center flex-vcenter ',t.permissions.putStatus||(e+="non-checkable"),e+='" data-gta="{action: \'toggle complete subtask\', type: \'task\'}"> <span class="icon icon-tick"></span> </div> </header> <section> <div class="subtask-content-wrap"> ',t.permissions.put?(e+=' <div class="subtask-content readable ',t.isArchived||(e+="hinted on-editable"),e+="\" data-gta=\"{action: 'edit subtask', type: 'task'}\" data-title=\""+tb_i18n.get("clickToEdit")+'"></div> <div class="subtask-edit-wrap"> <textarea class="subtask-input form-control"></textarea> </div> '):e+=' <div class="subtask-content readable"></div> ',e+=' </div> </section> <footer> <div class="subtask-infos"> <div class="subtask-info subtask-duedate subtask-detail-duedate-handler"> <!-- set by js --> </div> <div class="subtask-info"> ',e+=t.permissions.putExecutor?" <a class=\"avatar img-24 img-circle no-avatar hinted\" data-gta=\"{action: 'select subtask assignee', type: 'task'}\"></a> ":' <span class="avatar img-24 img-circle no-avatar hinted"></span> ',e+=' </div> <div class="subtask-info"> ',t.permissions.putTransform||t.permissions.del?(e+=" ",t.isArchived||(e+='<a class="subtask-menu-toggler icon icon-chevron-down"></a>'),e+=" "):e+=' <span class="subtask-menu-toggler-place"></span> ',e+=" </div> </div> </footer></div>",t.permissions.put&&(e+='<div class="subtask-handler-set clearfix"> <a class="save-subtask-handler btn btn-primary pull-right" data-gta="{action: \'save subtask\', type: \'task\'}">'+tb_i18n.get("save")+'</a> <a class="cancel-subtask-handler pull-right">'+tb_i18n.get("cancel")+"</a></div>"),e}},function(t,e){t.exports=function(t){var e="";return t.endDateString?(e+=" ",t.permissions.putDueDate?(e+=" <a class=\"task-datepicker\" data-gta=\"{action: 'edit subtask due date', type: 'task'}\"> <span>"+t.endDateString+"</span> </a> ",t.preciseDate&&(e+=' <a class="task-timepicker"> <span>'+t.endTimeString+"</span> </a> "),e+=" "):(e+=" <span>"+t.endDateString+"</span> ",t.preciseDate&&(e+=" <span>"+t.endTimeString+"</span> "),e+=" ")):(e+=" ",e+=t.permissions.putDueDate?' <a class="task-datepicker" data-gta="{action: \'edit subtask due date\', type: \'task\'}"> <span class="icon icon-calendar2"></span> </a> ':' <span class="icon icon-calendar2"></span> '),e}},function(t,e){t.exports=function(t){var e='<ul class="subtasks-list"></ul>';return t.permissions.subtaskPost&&(e+='<div class="subtask-creator child-tree"> <div class="subtask-add-wrap"> <span class="icon icon-checkbox detail-infos-icon"></span> <a class="subtask-add-handler" data-gta="{action: \'add subtask\', type: \'task\'}"> '+tb_i18n.get("subtask.card.create.placeholder")+' </a> </div> <div class="subtask-view editing"> <div class="subtask-wrap row-flex"> <header> <div class="subtask-icon-wrap"> <span class="icon icon-checkbox detail-infos-icon"></span> </div> </header> <section> <div class="subtask-content-wrap"> <div class="subtask-edit-wrap"> <textarea class="subtask-input form-control" placeHolder="'+tb_i18n.get("subtask.card.create.input.placeholder")+'"></textarea> </div> </div> </section> <footer> <div class="subtask-infos"> <div class="subtask-info subtask-duedate subtask-creator-duedate-handler"> <!-- set by js --> <!-- <a class="subtask-date-picker"> <span class="subtask-date-icon icon icon-calendar2"></span> <span class="subtask-date"></span> </a> --> </div> <div class="subtask-info"> <a class="avatar img-24 img-circle no-avatar hinted" data-gta="{action: \'select subtask assignee\', type: \'task\'}"></a> </div> <div class="subtask-info"> <span class="subtask-menu-toggler-place"></span> </div> </div> </footer> </div> <div class="subtask-handler-set clearfix"> <a class="save-subtask-handler btn btn-primary pull-right" data-gta="{action: save subtask, type: \'task\'}">'+tb_i18n.get("save")+'</a> <a class="cancel-subtask-handler pull-right">'+tb_i18n.get("cancel")+"</a> </div> </div></div>"),e}},function(t,e){t.exports=function(t){var e="";return t.endDateString?(e+=' <a class="task-datepicker" data-gta="task" data-label="task detail|choose duedate"> <span>'+t.endDateString+"</span> </a> ",t.preciseDate&&(e+=' <a class="task-timepicker"> <span>'+t.endTimeString+"</span> </a> ")):e+=' <a class="task-datepicker" data-gta="task" data-label="task detail|choose duedate"> <span class="icon icon-calendar2"></span> </a>',e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;u=i(678),s=i(401),n=i(1173),o=i(1174),a=i(813),l=i(786),r=i(927),p=i(810),t.exports=c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.viewName="PreviewerMenuView",e.prototype.popoverTitle="",e.prototype.events={"click .copy-handler":"copyWork","click .move-handler":"moveWork","click .archive-handler":"archive","click .unarchive-handler":"unarchive","click .delete-handler":"enterDeleteSubMenu","click .favorite-work-handler":"favoriteWork","click .switch-visible-handler":"switchVisible","submit .delete-form":"submitDeleteForm"},e.prototype.initialize=function(t){return this._projectId=t.objectModel.get("_projectId"),this.popoverTitle=tb_i18n.get("previewer.menu.title"),e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){var t;return t=this.options.objectModel.toJSON(),t.where=this.options.where,t.permissions=this.options.objectModel.hasPermissions("put.fork","put.archive","put.move","del","put.visible"),this.$el.html(n(t)),this.triggerHook("render"),this},e.prototype.copyWork=function(t){var e,i,n;return this.workModel=this.options.objectModel,!this.workModel.get("isArchived")&&(null!=(i=this.picker)&&i.remove(),n=this.workModel,e=n.get("fileName"),this.remove(),this.picker=this.requestSubView(l).open(r,{_projectId:n.get("_projectId"),_parentId:n.get("_parentId"),onlyCollections:!0,allProjects:!0,isForkOrMove:"fork",title:tb_i18n.get("work.copy.message",e),select:function(t){var e;if(t.id!==n.get("_parentId"))return e=p.get(t.id,{isRemoveAfterMove:!1}),n.forkToCollection(e,{success:function(){return s.show({message:tb_i18n.get("work.copy.success"),status:"success"})}})}}),this)},e.prototype.moveWork=function(t){var e,i,n;return this.workModel=this.options.objectModel,!this.workModel.get("isArchived")&&(null!=(i=this.picker)&&i.remove(),n=this.workModel,e=n.get("fileName"),this.remove(),this.picker=this.requestSubView(l).open(r,{_projectId:n.get("_projectId"),_parentId:n.get("_parentId"),onlyCollections:!0,allProjects:!0,isForkOrMove:"move",title:tb_i18n.get("work.move.message",e),select:function(t){return function(e){var i;if(e.id!==n.get("_parentId"))return i=p.get(e.id),n.moveToCollection(i,{success:function(){return t.remove()}})}}(this)}),this)},e.prototype.archive=function(){var t;return t=this.options.objectModel,t.archive({success:function(t){return function(){return s.show({message:tb_i18n.get("archived.file.success"),status:"success"}),t.remove()}}(this)}),this},e.prototype.unarchive=function(){var t;return t=this.options.objectModel,t.unarchive({success:function(t){return function(){return s.show({message:tb_i18n.get("unarchived.file.success"),status:"success"}),t.remove()}}(this)}),this},e.prototype.favoriteWork=function(){var t;return t=this.options.objectModel.get("isFavorite"),this.options.objectModel[t?"unFavorite":"doFavorite"]({success:function(t){return function(e){var i;if(t.options.objectModel.set("isFavorite",e.isFavorite),t.render(),!e.isFavorite)return"function"==typeof(i=t.options).onUnfavorite?i.onUnfavorite(t.options.objectModel.get("_id")):void 0}}(this)})},e.prototype.switchVisible=function(t){var e;return e=$(t.currentTarget),this.options.objectModel.saveAttr("visible",e.data("type"),{success:function(t){return function(){return t.render()}}(this)}),this},e.prototype.enterDeleteSubMenu=function(){return this.enterSubMenu(tb_i18n.get("previewer.menu.delete.title"),function(t){return function(){return t.$el.html(o())}}(this)),this},e.prototype.submitDeleteForm=function(t){var e;return t.preventDefault(),e=this.options.objectModel,e.destroy({wait:!0,success:function(t){return function(){return s.show({message:tb_i18n.get("delete.success"),status:"success"}),t.remove()}}(this)}),this},e}(a)},function(t,e){t.exports=function(t){var e='<ul class="list previewer-menu-list"> ';return t.permissions.putFork&&(e+=" <li> <a class=\"copy-handler\" data-gta=\"{action: 'add content', type: 'work', control: 'More Menu'}\"> <span class=\"icon icon-copy\"></span>"+tb_i18n.get("work.menu.copy.file")+" </a> </li> "),e+=" ",t.permissions.putMove&&(e+=" <li> <a class=\"move-handler\" data-gta=\"{action: 'move content', type: 'work', control: 'More Menu'}\"> <span class=\"icon icon-file-move2\"></span>"+tb_i18n.get("work.menu.move.file")+" </a> </li> "),e+=" <li> <a class=\"favorite-work-handler\" data-gta=\"{action: 'add to favourite', type: 'work', control: 'More Menu'}\"> <span class=\"icon icon-favorite ",t.isFavorite&&(e+="favorited"),e+='"></span>',e+=t.isFavorite?""+tb_i18n.get("unfavorite"):""+tb_i18n.get("favorite")+tb_i18n.get("navigation.work"),e+=" </a> </li> ","activity"!=t.where&&t.permissions.putArchive&&(e+=" <li> ",e+=t.isArchived?" <a class=\"unarchive-handler\" data-gta=\"{action: 'unarchive content', type: 'work', control: 'More Menu'}\"> <span class=\"icon icon-archive\"></span>"+tb_i18n.get("unarchive")+" </a> ":" <a class=\"archive-handler\" data-gta=\"{action: 'archive content', type: 'work', control: 'More Menu'}\"> <span class=\"icon icon-archive\"></span>"+tb_i18n.get("work.menu.archive.file")+" </a> ",e+=" </li> "),e+=" ",t.permissions.del&&(e+=" <li> <a class=\"delete-handler\" data-gta=\"{action: 'delete content', type: 'work', control: 'More Menu'}\"> <span class=\"icon icon-trash\"></span>"+tb_i18n.get("previewer.menu.delete.title")+" </a> </li> "),e+=" ",t.permissions.putVisible&&(e+=' <li class="divider"></li> <li> ',"members"==t.visible||"all"==t.visible?e+=' <a class="switch-visible-handler" data-type="involves" data-gta="{action: \'toggle visible\', type: \'work\', control: \'More Menu\'}"> <div class="main-mode"> <span class="icon icon-unlock"></span> <span class="mode">'+tb_i18n.get("visible.mode")+'</span> <span class="ifClose">'+tb_i18n.get("visible.close")+'</span> </div> <span class="mode-explanation">'+tb_i18n.get("visible.to.member")+"</span> </a> ":"involves"==t.visible&&(e+=' <a class="switch-visible-handler" data-type="members" data-gta="{action: \'toggle visible\', type: \'work\', control: \'More Menu\'}"> <div class="main-mode"> <span class="icon icon-lock"></span> <span class="mode">'+tb_i18n.get("visible.mode")+'</span> <span class="ifClose">'+tb_i18n.get("visible.open")+'</span> </div> <span class="mode-explanation">'+tb_i18n.get("visible.to.involve")+"</span> </a> "),e+=" </li> "),e+="</ul>"}},function(t,e){t.exports=function(t){var e='<form class="delete-form"> <p>'+tb_i18n.get("previewer.menu.confirm.delete")+'</p> <button class="btn btn-danger" type="submit">'+tb_i18n.get("delete")+"</button></form>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m=function(t,e){function i(){this.constructor=t}for(var n in e)f.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},f={}.hasOwnProperty;h=i(678),s=i(677),c=i(788),r=i(429),o=i(697),l=i(792),u=i(1176),p=i(1177),n=i(1178),a=i(1179),t.exports=d=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.viewName="WorkVersionsView",e.prototype.tagName="div",e.prototype.className="work-version-view",e.prototype.activeIndex=0,e.prototype.events={"click .work-version-content":"select","keydown .work-version-description":"quickSave","click .work-version-edit-handler":"enterEditing","click .work-version-handler-save":"saveDescription","click .work-version-handler-cancel":"exitEditing"},e.prototype.initialize=function(t){if(null==t&&(t={}),!((null!=t?t._workId:void 0)&&t._projectId))throw new Error("Options of "+this.viewName+" should has _workId and _projectId.");return this.options=t,this._workId=t._workId,this._projectId=t._projectId,this.load().then(function(t){return function(){if(t.$el)return t.listen(),t.renderBasic(),t.renderVersions()}}(this))["catch"](function(t){return function(e){var i;return"function"==typeof(i=t.options).error&&i.error(t),console.error(e),t.remove()}}(this)),this},e.prototype.load=function(){return new Promise(function(t){return function(e,i){return o.fetch(t._projectId,{success:function(i){return t.projectModel=i,e()},error:i})}}(this)).then(function(t){return function(){return new Promise(function(e,i){return l.fetch(t._workId,{success:function(i){return t.workModel=i,e()},error:i})})}}(this)).then(function(t){return function(){return new Promise(function(e,i){return p.fetch(t._workId,{success:function(i){return t.workVersionCollection=i,e()},error:i})})}}(this))},e.prototype.listen=function(){return this.listenTo(this.workModel,"change:description",this.renderVersion),this.listenTo(this.workVersionCollection,"add",this.renderVersions),this.listenTo(this.workVersionCollection,"change:description",this.renderVersion),this.listenTo(this.workVersionCollection,"remove",this.removeVersion),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$versionsList=this.$(".work-versions-list"),this},e.prototype.renderVersions=function(){return this.$versionsList.empty(),this.renderVersion(this.workModel),this.workVersionCollection.each(function(t){return function(e){return t.renderVersion(e)}}(this)),this.initFlexText(),this.checkStatus(),this.selectDefault(),this},e.prototype.renderVersion=function(t,e){var i,n,o,c;return c=t.toJSON(),c.permissions=this.workModel.hasPermissions("put"),"work"===t.name?(c.isCurrent=!0,c.lastVersionTime?c.createTimeString=s.formatDate(new Date(c.lastVersionTime)).dateString+" "+r(c.lastVersionTime).format("LT"):c.createTimeString=tb_i18n.get("work.versions.current")):(c.isCurrent=!1,c.createTimeString=s.formatDate(new Date(c.created)).dateString+" "+r(c.created).format("LT")),i=this.$versionsList,o=$(a(c)),n=i.find(".work-version[data-id="+c._id+"]"),n.length?this.resetVersion(n):e===!0?o.prependTo(i):o.appendTo(i),this},e.prototype.removeVersion=function(t){var e,i;return e=this.$versionsList,i=e.find(".work-version[data-id="+t._id+"]"),i.remove(),this},e.prototype.enterEditing=function(t){var e,i,n,r,o;return(i=$(null!=t?t.currentTarget:void 0)).length?(t.preventDefault(),this.exitEditing(),n=i.closest(".work-version"),n.addClass("on-editing"),e=n.find(".work-version-description"),r=n.data("id"),o=n.hasClass("work-version-current")?this.workModel:this.workVersionCollection.get(r),o&&e.val(o.get("description")||""),e.focusAtEnd(),this):this},e.prototype.exitEditing=function(t,e){return e=this.$(".work-version.on-editing"),e.length&&this.resetVersion(e),this},e.prototype.resetVersion=function(t,e){var i,n,o,a,c;return t.removeClass("on-editing"),i=t.find(".work-version-description"),e!==!1&&(a=t.data("id"),t.hasClass("work-version-current")?(n=this.workModel.toJSON(),o=n.lastVersionTime?s.formatDate(new Date(n.lastVersionTime)).dateString+" "+r(n.lastVersionTime).format("LT"):tb_i18n.get("work.versions.current")):(c=this.workVersionCollection.get(a),o=s.formatDate(new Date(c.get("created"))).dateString+" "+r(c.get("created")).format("LT")),c&&i.val(c.get("description")||o).trigger("change")),this},e.prototype.saveDescription=function(t){var e,i,n,r,o;return(e=$(null!=t?t.currentTarget:void 0)).length?(i=e.closest(".work-version"),r=i.data("id"),o=i.hasClass("work-version-current")?this.workModel:this.workVersionCollection.get(r),n=i.find(".work-version-description").val().trim(),n!==o.get("description")?(e.attr("disabled","disabled"),o.save(null,{attrs:{description:n},wait:!0,success:function(){return e.removeAttr("disabled")},error:function(){return i.removeClass("on-saving")}})):this.exitEditing()):this},e.prototype.checkStatus=function(){return this.workVersionCollection.length?this.show():this.hide()},e.prototype.initFlexText=function(){return this.$(".work-version-description").each(function(){var t;if(t=$(this),!t.data("_flexText"))return t.flexText().data("_flexText",!0)}),this},e.prototype.show=function(){var t;return this.$el.removeClass("hide"),"function"==typeof(t=this.options).onShown?t.onShown():void 0},e.prototype.hide=function(){var t;return this.$el.addClass("hide"),"function"==typeof(t=this.options).onHidden?t.onHidden():void 0},e.prototype.quickSave=function(t){return 13===(null!=t?t.keyCode:void 0)&&(t.preventDefault(),this.saveDescription(t)),this},e.prototype.selectDefault=function(){var t,e;return e=this._lastSelectId||this._workId,t=this.$(".work-version[data-id="+e+"]"),t.addClass("on-selecting").siblings().removeClass("on-selecting"),this},e.prototype.select=function(t){var e,i,n,r;return(null!=t?t.currentTarget:void 0)?(e=$(t.currentTarget).parent(),n=e.data("id")):(n=t,e=this.$(".work-version[data-id="+n+"]")),n!==this._lastSelectId&&e.length?e.hasClass("on-editing")?this:(this._lastSelectId=n,r=e.hasClass("work-version-current")?this.workModel:this.workVersionCollection.get(n),e.addClass("on-selecting").siblings().removeClass("on-selecting"),"function"==typeof(i=this.options).onSelect?i.onSelect(r):void 0):this},e}(c)},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(678),n=i(688),s=i(792),r=i(686),o=i(677),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.name="version",e.prototype.urlRoot="versions",e.prototype.url=function(){return"works/"+this.get("_workId")+"/versions/"+this.get("_id")},e.prototype.getFormatData=function(){var t;return t=this.toJSON(),t=s.formatWork(t)},e}(n)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;n=i(685),r=i(686),s=i(1176),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.name="versions",e.prototype.boundToObjectType="work",e.prototype.model=s,e.prototype.sync=function(t,i,n){return null==n&&(n={}),n.url="works/"+this._boundToObjectId+"/versions",e.__super__.sync.call(this,t,i,n)},e.prototype.comparator=function(t,e){var i,n;return i=new Date(t.get("created")),n=new Date(e.get("created")),n-i},e}(n)},function(t,e){t.exports=function(t){var e='<div class="work-versions-title">'+tb_i18n.get("work.versions.title")+'</div><ul class="work-versions-list"></ul>';return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li class="work-version ';return t.isActive&&(i+="active"),i+=" ",t.isCurrent&&(i+="work-version-current"),i+='" data-id="'+t._id+'"><div class="work-version-content"><span class="work-version-point icon ',i+=t.isCurrent?"icon-focus":"on-circle",i+='"></span><textarea class="work-version-description">'+e(t.description||t.createTimeString)+"</textarea>",t.permissions.put&&(i+='<a class="icon icon-pencil work-version-edit-handler hinted" data-title="'+tb_i18n.get("work.versions.enter.edit")+'"></a>'),i+='</div><div class="work-version-handler-set clearfix"><a class="work-version-handler-save btn btn-primary" data-gta="event" data-label="save work version">'+tb_i18n.get("save")+'</a><a class="work-version-handler-cancel">'+tb_i18n.get("cancel")+"</a></div></li>"}},function(t,e){t.exports=function(t){var e='<div class="previewer-content"> ';return t.isChatRoom&&(e+=' <a class="modal-close cancel-handler cancel-chat-previewer icon icon-remove"  data-dismiss="modal" data-gta="event" data-label="close previewer"></a> '),e+=' <ul class="thumbnails-previewer"></ul> <div class="activities-container-wrap"> <div class="previewer-content-image-wrapper ',t.isChatRoom&&(e+="only-file"),e+='"> <div class="img-previewer"> <div class="img-preview-toolbar" data-rotate="0"> <div class="img-rotate" data-fn="left"> <span class="icon icon-turn-left"></span> <span>'+tb_i18n.get("previewer.img.turn.left")+'</span> </div> <div class="img-rotate" data-fn="right"> <span class="icon icon-turn-right"></span> <span>'+tb_i18n.get("previewer.img.turn.right")+'</span> </div> </div> <div class="img-previewer-wrap"></div> </div> <div class="pdf-previewer"></div> <div class="video-previewer"><div class="video-previewer-wrap"></div></div> <div class="audio-previewer"></div> <div class="text-previewer thin-scroll"></div> <div class="work-previewer work"></div> </div> <div class="previewer-updating ',t.isChatRoom&&(e+="only-file"),e+='"> <div class="previewer-updating-tips"> <span class="icon icon-arrow-up"></span> <span class="previewer-updating-tips-message">'+tb_i18n.get("previewer.updating")+'</span> <span class="previewer-updating-tips-progress"></span> </div> </div> ',t.isChatRoom||(e+=' <div class="activities-container"> <section class="detail-content scrollable thin-scroll"> <div class="previewer-header-wrap"></div> <div class="previewer-handler-wrap detail-white-card"></div> <div class="previewer-versions-wrap hide detail-white-card"></div> <div class="previewer-infos-wrap"></div> <section class="detail-activities-wrap"></section> </section> <footer class="activity-creator-wrapper"></footer> </div> '),e+=' </div></div><div class="prev-handler"></div><div class="next-handler"></div><div class="previewer-map map"></div>'}},function(t,e){t.exports=function(t){var e='<div class="previewer-handler-set"> ';return t.permissions.getDownload&&(e+=" ",e+=t.isFileLocalExist?" <a class=\"open-work-handler\" data-gta=\"{action: 'open detail', type: 'file', control: 'Right Open Button', method: 'open'}\"> <span class=\"icon icon-file3\"></span> "+tb_i18n.get("previewer.open")+" </a> ":" <a class=\"download-work-handler\" data-gta=\"{action: 'open detail', type: 'file', control: 'Right Download Button', method: 'download'}\"> <span class=\"icon icon-circle-arrow-down-o\"></span> "+tb_i18n.get("previewer.download")+" </a> ",e+=" "),e+=" ",t.permissions.putVersion&&(e+=" <a class=\"update-work-handler\" data-gta=\"{action: 'update file', type: 'file', control: 'Update Button'}\"> <span class=\"icon icon-circle-arrow-down-o\"></span> "+tb_i18n.get("previewer.update")+" </a> "),e+=" ",t.permissions.putMove&&(e+=" <a class=\"move-work-handler\" data-gta=\"{action: 'move content', type: 'file', control: 'Move Button'}\"> <span class=\"icon icon-file-move\"></span> "+tb_i18n.get("previewer.move")+" </a> "),e+=" ",t.permissions.put&&(e+=" <a class=\"edit-work-handler\" data-gta=\"{action: 'edit title', type: 'file', control: 'Edit Button'}\"> <span class=\"icon icon-pencil\"></span> "+tb_i18n.get("previewer.edit")+" </a> "),e+="</div>"}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="archived-wrapper"></div><div class="previewer-header"> <a class="menu-handler" data-gta="event" data-label="previewer menu"> '+tb_i18n.get("more")+' <span class="icon icon-chevron-down"></span> </a> <a class="modal-close cancel-handler icon icon-remove"  data-dismiss="modal" data-gta="event" data-label="close previewer"></a> <div class="previewer-header-folder"> ';return i+=t._parentId&&t.parentName&&t.roleScope>=0?' <span class="previewer-header-folder-tips minor">'+tb_i18n.get("previewer.header.folder.tips")+'</span> <a class="enter-collection-handler hinted" data-title="'+tb_i18n.get("previewer.enter.collection")+'" data-id="'+t._parentId+'" data-gta="event" data-label="enter collection"> '+e(t.parentName)+" </a> ":t._parentId&&t.roleScope>=0?' <a class="enter-collection-handler" data-id="'+t._parentId+'" data-gta="event" data-label="enter collection"> '+tb_i18n.get("previewer.enter.collection")+" </a> ":' <span class="previewer-header-folder-tips minor">'+tb_i18n.get("previewer.header.folder.tips")+"</span> <span>"+tb_i18n.get("previewer.header.temp.tips")+"</span> ",i+=" </div> ",i+=t.permissions.put&&!t.isArchived?' <div class="previewer-header-name hinted" data-title="'+tb_i18n.get("clickToEdit")+"\" data-gta=\"{action: 'edit title', type: 'file', control: 'Title'}\" contenteditable>"+e(t.fileName)+"</div> ":' <div class="previewer-header-name">'+e(t.fileName)+"</div> ",i+=' <div class="previewer-header-size minor">'+e(t.fileSizeFix)+"</div></div>"}},function(t,e){t.exports=function(t){var e='<ol class="map-indicators"> ',i=t.maps;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <li class="previewer-map-btn ',t.index==n&&(e+="active"),e+=" ",n==-1&&(e+="thumbnail-map-btn"),e+='" data-map-to="'+n+'"></li> ';return e+="</ol>"}},function(t,e){t.exports=function(t){var e='<div class="work-thumbnail"><p class="work-name"></p></div><p class="work-title"></p><p class="work-fall-title">'+(t.fallTitle||"")+"</p>";return t.download&&(e+="<a class=\"previewer-download-link\" data-gta=\"{action: 'open detail', type: 'file', control: 'Left Download Button', method: 'download'}\"></a>"),e+='<p class="deleted-info">'+tb_i18n.get("previewer.file.deleted")+"</p>"}},function(t,e){t.exports=function(t){var e="";return t.isArchived&&(e+=' <div class="archived-badge"> <div class="archived-explaination"> <span class="icon icon-archive"></span>'+t.text+" </div> ",(t.permissions.putArchive||t.permissions.del)&&(e+=' <div class="archive-handler-set"> ',t.permissions.putArchive&&(e+=' <a class="unarchive-handler"> <span class="icon icon-putback"></span>   <span class="archived-button archived-cancel">'+t.cancel+"</span>   </a> "),e+=" ",t.permissions.del&&(e+=' <a class="remove-handler"> <span class="icon icon-trash"></span>   <span class="archived-button archived-delete">'+t.deleted+"</span>   </a> "),e+=" </div> "),e+=" </div>"),e}},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;l=i(678),o=i(401),a=i(681),c=i(677),s=i(813),r=i(1187),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="ArchiveDeleteMenuView",e.prototype.className="archive-menu-view",e.prototype.popoverTitle="",e.prototype.events={"submit .delete-form":"deleteModelObject"},e.prototype.initialize=function(t){return null==t&&(t={}),t.currentModel?(this.options=t,this.currentModel=this.options.currentModel,e.__super__.initialize.apply(this,arguments)):this},e.prototype.render=function(t){return this.$el.html(r(this.options)),this},e.prototype.deleteModelObject=function(t){var e;return t.preventDefault(),e={success:function(t){return function(){var e;return t.success(),null!=(e=t.options)&&"function"==typeof e.success?e.success():void 0}}(this)},this.currentModel[this.currentModel.get("objectType")?"destroy":"deleteObject"](e),this},e.prototype.success=function(){return o.show({message:tb_i18n.get("delete.success"),status:"success"}),this.remove()},e}(s)},function(t,e){t.exports=function(t){var e='<form class="delete-form"> <p>'+t.confirmDelete+'</p> <button class="btn btn-danger" type="submit">'+tb_i18n.get("delete")+"</button></form>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;p=i(678),o=i(401),a=i(681),l=i(677),n=i(998),s=i(813),r=i(1189),t.exports=c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="UnarchivedMenuView",e.prototype.className="unarchived-menu-view",e.prototype.popoverTitle="",e.prototype.events={"submit .cancel-form":"unarchiveModelObject"},e.prototype.initialize=function(t){return null==t&&(t={}),t.currentModel?(this.options=t,this.type=this.options.type||"",
this.currentModel=this.options.currentModel,this.successMessage=this.options.msg,e.__super__.initialize.apply(this,arguments)):this},e.prototype.render=function(t){return this.$el.html(r({type:this.type})),this},e.prototype.unarchiveModelObject=function(t){var e;return t.preventDefault(),e={_stageId:this.options.stageId?this.options.stageId:void 0,success:function(t){return function(){var e;return o.show({message:t.options.msg,status:"success"}),null!=(e=t.options)&&"function"==typeof e.success&&e.success(),t.remove()}}(this)},this.currentModel[this.currentModel.get("isArchived")?"unarchive":"unarchiveObject"](e),this},e}(s)},function(t,e){t.exports=function(t){var e='<form class="cancel-form"> ';return e+="file"==t.type?" <p>"+tb_i18n.get("confirm.unarchive.tip.file")+"</p> ":" <p>"+tb_i18n.get("confirm.unarchive.tip")+"</p> ",e+=' <button class="btn btn-primary" type="submit">'+tb_i18n.get("unarchive")+"</button></form>"}},function(t,e,i){var n,r;r=i(678),t.exports=n=function(){function t(t){this.src=t.src,this.onTimeUpdate=t.onTimeUpdate,this.onEnd=t.onEnd,this.onStateChange=t.onStateChange,this.duration=t.duration,this.duration||(this.duration=0),this._audioEl=document.createElement("audio"),this._audioLoaded=!1,this._events={},this._listenTo(this._audioEl,"canplaythrough",this._initListener,!0),this._audioEl.src=t.src}return t.prototype._initListener=function(){return this._audioLoaded=!0,this._setDuration(),this._listenTo(this._audioEl,"durationchange",this._setDuration),this._listenTo(this._audioEl,"timeupdate",this._updateProgress),this._listenTo(this._audioEl,"ended",this._endProgress)},t.prototype._listenTo=function(t,e,i,n){var r,o;return(o=this._events)[e]||(o[e]=[]),r=function(o){return function(s){if(i.call(o,s),n)return t.removeEventListener(e,r)}}(this),this._events[e].push({ele:t,eventListener:r}),t.addEventListener(e,r,!1)},t.prototype._stopListening=function(t,e){var i,n,r,o,s,a,c,l,p;if(t){for(i=this._events[e]||[],this._events[e]=[],p=[],s=0,c=i.length;s<c;s++)o=i[s],o.ele===t?p.push(t.removeEventListener(e,o.eventListener,!1)):p.push(this._events[e].push(o));return p}l=this._events;for(e in l)for(n=l[e],r=0,a=n.length;r<a;r++)o=n[r],o.ele.removeEventListener(e,o.eventListener,!1);return this._events={}},t.prototype.remove=function(){return this._stopListening(),this._audioEl.src=""},t.prototype.isPaused=function(){return this._audioEl.paused},t.prototype.isEnded=function(){return this._audioEl.ended},t.prototype.playClick=function(){if(this._audioLoaded)return this._audioEl.paused?this._audioEl.play():this._audioEl.pause(),"function"==typeof this.onStateChange?this.onStateChange(this._genResource()):void 0},t.prototype.currentTime=function(){return this._audioEl.currentTime},t.prototype._playPercent=function(){return Math.round(this._audioEl.currentTime/this.duration*1e4)/100},t.prototype.formatDuration=function(t){var e,i,n;return t<=0?e="00:00":(i=Math.floor(t/60),n=Math.floor(t%60),i<10&&(i="0"+i),n<10&&(n="0"+n),e=i+":"+n),e},t.prototype._updateProgress=function(){return"function"==typeof this.onTimeUpdate?this.onTimeUpdate(this._genResource()):void 0},t.prototype._genResource=function(){var t,e,i;return this._audioEl.ended?(t=this.duration,e=100):this._playPercent()>=100?(t=this.duration,e=100):(e=this._playPercent(),t=this.currentTime()),i={ended:this.isEnded(),paused:this.isPaused(),currentTime:t,duration:this.duration,playPercent:e}},t.prototype._endProgress=function(){return this._audioEl.paused||this._audioEl.pause(),"function"==typeof this.onEnd?this.onEnd(this._genResource()):void 0},t.prototype._setDuration=function(){var t;return t=this._audioEl.duration,t===1/0?this._audioEl.duration=this.duration:this.duration||"Safari"!==r.ua.getBrowser().name?void 0:this.duration=t},t}()},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y=function(t,e){return function(){return t.apply(e,arguments)}},b=function(t,e){function i(){this.constructor=t}for(var n in e)k.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},k={}.hasOwnProperty;g=i(358),v=i(678),c=i(429),o=i(401),m=i(677),p=i(813),f=i(786),u=i(696),r=i(1192),h=i(1010),l=i(687),a=i(1194),n=i(1258),d=i(1259),t.exports=s=function(t){function e(){return this.load=y(this.load,this),e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.viewName="MemberCardView",e.prototype.className="member-card-view card popover-no-header",e.prototype.popoverTitle="Menu",e.prototype.width=320,e.prototype.events={"click .open-member-detail":"openMemberDetail","click .member-role-setting":"enterRoleSubMenu","click .resend-handler":"resendMember","click .role-handler":"setRole","click .delete-handler":"deleteMember","click .upgrade-handler":"upgradeHandler","click .set-role-handler":"setRoleHandler","focus .member-send-chat-text":"openChatWrapper","blur .member-send-chat-text":"closeChatWrapper","click .member-send-chat-btn":"submit","keydown .member-send-chat-text":"quickSubmit"},e.prototype.initialize=function(t){var i,n,r;if(this.memberModel=t.memberModel,this.projectModel=t.projectModel,this.memberCardClass=t.memberCardClass,this.orgMembersCollection=t.orgMembersCollection,this.affixToggler=t.affixToggler,this.roles=t.roles,this.orgMembersCollection&&(i=this.projectModel.get("_organizationId"),this.organizationModel=l.get(i),n=this.orgMembersCollection.get(this.memberModel.id),r=this.organizationModel.getRoleScope()>=0,this.canSeeOrganization=n&&r),this.load(function(t){return function(){return t.render(),t.fixPosition(),t.listen()}}(this)),e.__super__.initialize.apply(this,arguments),this.affixToggler)return this.$popover.css({visibility:"hidden"})},e.prototype.load=function(t){var e;return e=this.canSeeOrganization?this.projectModel.get("_organizationId"):null,this.memberModel.getTasksCount({memberId:this.memberModel.get("_id"),projectId:this.projectModel.get("_id"),organizationId:e,success:function(e){return function(i){return e.taskCountObj=i,"function"==typeof t?t():void 0}}(this)})},e.prototype.render=function(){var t,e,i;return i=m.getMemberPermissions(this.projectModel,this.memberModel),"organization"!==this.projectModel.get("visibility")&&"all"!==this.projectModel.get("visibility")||(e=!0),t=g.extend(this.memberModel.toJSON(),{roleName:this.memberModel.getRole(),roleScope:this.projectModel.getRoleScope(),hasVisited:e,_userMeId:v.user.id,isShowOrgTask:this.canSeeOrganization,tasksCount:this.taskCountObj,lang:tb_i18n.getLanguage(),roleId:this.memberModel.get("_roleId")},i),t.latestActived&&(t.latestActivedString=tb_i18n.get("memberlatest.actived",c(t.latestActived).format("YYYY-MM-DD HH:mm"))),this.$el.html(n(t)),this.$textareaset=this.$(".member-send-chat-text"),this},e.prototype.fixPosition=function(){var t,i,n,r;return this.affixToggler?(r=this.$popover[0].getBoundingClientRect(),n=20,t=62,i=!1,window.innerHeight-(r.height+2*n)<=0?(i=!0,this.$popover.css({top:n}),this.$content.css({height:window.innerHeight-2*n,overflow:"auto"})):window.innerHeight-(r.height+r.top)<=t+n&&(this.$popover.addClass("isBottommost"),this.$popover.css({top:window.innerHeight-r.height-n})),g.delay(function(t){return function(){var e;return null!=(e=t.$popover)?e.css({visibility:"visible"}):void 0}}(this),i?0:100)):e.__super__.fixPosition.apply(this,arguments)},e.prototype.listen=function(){return this.listenTo(this.memberModel,"change",this.render),this},e.prototype.openMemberDetail=function(t){var e;return e=$(t.currentTarget).data("toggle"),this.goToDetail(e),this},e.prototype.goToDetail=function(t){var e,i;return null!=(i=this.memberCardView)&&i.remove(),e={memberModel:this.memberModel,projectModel:this.projectModel,type:t,fromPanel:!0},this.canSeeOrganization&&"project-tasks"!==t?(e.organizationModel=this.organizationModel,e.orgMembersCollection=this.orgMembersCollection,e.modalTitle=tb_i18n.get("organization.member.detail.organization")):(e.modalTitle=tb_i18n.get("organization.member.detail.project"),e.orgMembersCollection=[]),this.memberCardView=this.requestSubView(f).open(a,e),"member-info"===t&&(this.canSeeOrganization?v.gta.event({action:"open detail",type:"org member",control:"Member Card"}):v.gta.event({action:"open detail",type:"project member",control:"Member Card"})),this.hide(),this},e.prototype.enterRoleSubMenu=function(){return new Promise(function(t){return function(e,i){return t.projectModel.get("_organizationId")?h.fetch(t.projectModel.id,{boundToObjectType:"project",success:function(n){var r;return t.projectTeamsCollection=n,t.cannotRemove=null!=(r=t.projectTeamsCollection)?r.isInTeams(t.memberModel.get("_id")):void 0,t.$el?e():i()},error:function(t,e){return i(e)}}):(t.cannotRemove=null,e())}}(this)).then(function(t){return function(e){var i,n;return n=m.getMemberPermissions(t.projectModel,t.memberModel),i=g.extend(t.memberModel.toJSON(),{payType:t.projectModel.getPaymentPlan().payType,_organizationId:t.projectModel.get("_organizationId"),roles:t.roles,teamRelated:t.cannotRemove,myRoleId:t.projectModel.getRoleScope()},n),t.enterSubMenu(tb_i18n.get("member.card.submenu.title"),function(){return t.$el.html(d(i)),$(".member-card-view.card").removeClass("popover-no-header")})}}(this)),this},e.prototype.resendMember=function(t){var e;return e=$(t.currentTarget),this.memberModel.saveAttr("resend",null,{wait:!0,success:function(){return o.show({message:tb_i18n.get("project.settings.email.sent30"),status:"success"})}}),this},e.prototype.deleteMember=function(t){var e;return e=$(t.currentTarget),this.memberModel.destroy({wait:!0,success:function(){return{message:tb_i18n.get("remove.success"),status:"success"}}}),this.hide(),this},e.prototype.setRole=function(t){var e,i;if(e=$(t.currentTarget),i=e.data("role"),1===i.length&&(i=+i),i!==this.memberModel.get("_roleId"))return this.memberModel.saveAttr("_roleId",i,{wait:!0}),this},e.prototype.upgradeHandler=function(t){return this.hide(),this},e.prototype.setRoleHandler=function(t){return this.hide(),this},e.prototype.openChatWrapper=function(t){var e;return this.$popover.hasClass("isBottommost")&&this.$popover.css({marginTop:-62}),e=$(t.currentTarget),e.closest(".member-send-chat-wrapper").addClass("open"),this},e.prototype.closeChatWrapper=function(t){var e;if(e=$(t.currentTarget),0===e.val().length)return e.closest(".member-send-chat-wrapper").removeClass("open"),this.$popover.css({marginTop:0})},e.prototype.submit=function(){var t;return this.roomIdsMap||(this.roomIdsMap={}),t=$(".member-send-chat-btn").data("id"),this.collection=r.get(t),this.roomIdsMap[t]?this.sendMsg(t):this.collection.getRoomInfo("users",t,{success:function(e){return function(i){return e.roomIdsMap[t]=i._id,e.sendMsg(t)}}(this)}),this},e.prototype.sendMsg=function(t){var e;if(e=this.$textareaset.val().trim())return this.collection.create({_creatorId:v.user.id,content:e,_boundToObjectId:this.collection._boundToObjectId,boundToObjectType:this.collection.boundToObjectType},{url:"rooms/"+this.roomIdsMap[t]+"/activities",success:function(t){return function(e){var i;return i=e.toJSON()._boundToObjectId,o.show({message:tb_i18n.get("chat.room.send.success",i),status:"success"}),t.$textareaset.val(""),t.$popover.css({marginTop:0}),$(".member-send-chat-wrapper").removeClass("open")}}(this),error:function(){return o.show({message:tb_i18n.get("chat.room.send.error"),status:"error"})}}),this.$textareaset.blur(),this},e.prototype.quickSubmit=function(t){return 13===t.keyCode&&(t.ctrlKey||t.metaKey||t.shiftKey)&&(t.preventDefault(),this.submit()),this},e.prototype.remove=function(){var t;return"WindowView"===(null!=(t=this.parentView)?t.viewName:void 0)&&this.parentView.close(),e.__super__.remove.apply(this,arguments)},e}(p)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=i(685),r=i(1193),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.name="chatMessages",e.prototype.model=r,e.prototype.pageNum=30,e.prototype.orderBy="earliest-created",e.prototype.getParams=function(t,e){var i;if("read"===t)return i={boundToObjectType:this.boundToObjectType,_boundToObjectId:this._boundToObjectId}},e.prototype.getRoomInfo=function(t,e,i){return null==i&&(i={}),"users"!==t&&"projects"!==t||(i.url="rooms/"+t+"/"+e,this.sync("read",this,i)),this},e}(o)},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=i(358),r=i(688),o=i(677),s=i(792),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.name="chatMessage",e.prototype.defaults={objectType:"ChatMessage",_boundToObjectId:"",boundToObjectType:"",_creatorId:"",created:"",updated:"",content:"",attachments:[]},e.prototype.urlRoot=function(){return"direct_messages/"+this.chatType+"/"+this.roomId+"/messages"},e.prototype.initSubscribe=function(){var t,e,i,n,r;if(i=(null!=(n=this.get("content"))?n.attachments:void 0)||[],i.length&&i[0]._id){for(t=0,e=i.length;t<e;t++)r=i[t],this.subscribeTo(r._id,"change",function(t){return function(e){return t.updateAttachments(e.toJSON())}}(this)),this.subscribeTo(r._id,"destroy",function(t){return function(e){return t.removeAttachments(e)}}(this));return this}},e.prototype.updateAttachments=function(t){var e,i,n,r,o,s;for(e=(null!=(r=this.get("content"))?r.attachments:void 0)||[],o=[],i=0,n=e.length;i<n;i++)s=e[i],t._id!==s._id?o.push(s):o.push(t);return this.set("content",a.extend(this.get("content"),{attachments:o})),this},e.prototype.removeAttachments=function(t){var e,i,n,r,o,s;for(e=(null!=(r=this.get("content"))?r.attachments:void 0)||[],o=[],i=0,n=e.length;i<n;i++)s=e[i],s._id!==t&&o.push(s);return this.set("content",a.extend(this.get("content"),{attachments:o})),this},e.prototype.getAttachmentDatas=function(){var t,e,i,n,r,o;for(n=[],t=(null!=(r=this.get("content"))?r.attachments:void 0)||[],e=0,i=t.length;e<i;e++)o=t[e],n.push(s.formatWork(o));return n},e}(r)},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;l=i(678),r=i(429),c=i(788),s=i(684),o=i(687),a=i(1195),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="MemberOverallView",e.prototype.className="member-overall-view",e.prototype.events={},e.prototype.initialize=function(t){var e;return t?(this.options=t,e=this.options.type||"member-tasks",this.datas=this.parseData(e),this.render(),this):this},e.prototype.render=function(){var t,e;return t={cardModel:this.datas.memberModel,modalTitle:this.options.modalTitle||tb_i18n.get("organization.member.detail"),objType:"member",objectModel:this.datas.objectModel,teamsCollection:this.options.teamsCollection,fromPanel:this.options.fromPanel,type:this.options.type},e=this.requestSubView(a,t),this.$el.html(e.$el),this},e.prototype.parseData=function(t){var e,i,n;return e="organization-tasks"===t?this.options.orgMembersCollection.get(this.options.memberModel.get("_id")):this.options.memberModel,i="project-tasks"===t||0===(null!=(n=this.options.orgMembersCollection)?n.length:void 0)?this.options.projectModel:this.options.organizationModel,{memberModel:e,objectModel:i}},e}(c)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},v={}.hasOwnProperty;m=i(358),s=i(700),c=i(980),d=i(1196),h=i(1203),l=i(1223),u=i(1245),r=i(1247),a=i(1249),o=i(1250),n=i(1257),f=function(){return{member:{subItems:[{title:tb_i18n.get("team.manger.tasks"),icon:"icon-checkbox-ios-checked",type:"member-tasks"},{title:tb_i18n.get("team.manger.events"),icon:"icon-calendar",type:"member-events"},{title:tb_i18n.get("member.info"),icon:"icon-user",type:"member-info"}]},team:{subItems:[{title:tb_i18n.get("team.manger.tasks"),icon:"icon-checkbox-ios-checked",type:"team-tasks"},{title:tb_i18n.get("team.manger.events"),icon:"icon-calendar",type:"team-events"},{title:tb_i18n.get("team.projects"),icon:"icon-collection",type:"team-projects"}]}}},t.exports=p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.viewName="TeamMemberDetailView",e.prototype.className="team-member-detail-view fixed",e.prototype.modalTitle="",e.prototype.events={"click .sub-menu-picker li:not(.active)":"switchContent"},e.prototype.initialize=function(t){if(t.cardModel)return this.options=t,this.modalTitle=this.options.modalTitle,this.teamsCollection=this.options.teamsCollection,e.__super__.initialize.apply(this,arguments)},e.prototype.renderMain=function(){var t,e,i,r;return e=f(),i=e[this.options.objType].subItems,this.$el.removeClass("modal-padding modal-dialog"),t=this.options.cardModel.toJSON(),"team"===this.options.objType&&(r={name:t.style.split(",")[0],color:t.style.split(",")[1]},t.style=r),this.data=m.extend({card:t,subItems:i,objType:this.options.objType},this.options),this.$modalBody.html(n(this.data)),this.$subMenuList=this.$(".sub-menu-picker"),this.$subNav=this.$(".sub-menu-item"),this.$subMenuList.find("li:first-child").addClass("active"),this.$detailContent=this.$(".detail-picker-content"),this.switchContent()},e.prototype.switchContent=function(t){var e,i,n;if(t){if(e=$(t.currentTarget),e.hasClass("active"))return;e.addClass("active").siblings().removeClass("active")}else this.options.fromPanel&&(n=this.options.type,this.$subMenuList.find("li[data-type='"+n+"']").addClass("active").siblings().removeClass("active"));switch(n=this.$subMenuList.find("li.active").data("type"),null!=(i=this.currentContentView)&&i.remove(),n){case"team-projects":this.renderTeamContent(d);break;case"team-tasks":this.renderTeamContent(h);break;case"team-events":this.renderTeamContent(l);break;case"member-info":this.renderMemberInfo(o);break;case"member-tasks":this.renderMemberContent(a);break;case"member-events":this.renderMemberContent(r)}return this.$detailContent.html(this.currentContentView.$el),this},e.prototype.renderTeamContent=function(t){var e;return e={membersCollection:this.options.membersCollection,organizationProjectsCollection:this.options.organizationProjectsCollection,teamProjectsCollection:this.options.teamProjectsCollection,objectModel:this.options.organizationModel},this.renderBasicView(e,t),this},e.prototype.renderMemberContent=function(t){var e;return e={startDate:this.weekPicker?this.weekPicker.startOfWeek:void 0,noExecutor:!0,withCreate:!0,objectModel:this.options.objectModel},this.renderBasicView(e,t),this},e.prototype.renderMemberInfo=function(t){var e;return e={teamsCollection:this.options.teamsCollection,fromPanel:this.options.fromPanel,objectModel:this.options.objectModel},this.renderBasicView(e,t),this},e.prototype.renderBasicView=function(t,e){var i;return i=m.extend({cardModel:this.options.cardModel},t),this.currentContentView=this.requestSubView(e,i),this},e}(c)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h=function(t,e){function i(){this.constructor=t}for(var n in e)m.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},m={}.hasOwnProperty;p=i(358),d=i(678),c=i(788),o=i(401),l=i(786),n=i(1197),s=i(1200),r=i(1202),u=i(1199),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.viewName="TeamProjectsView",e.prototype.className="team-projects-view fade",e.prototype.events={"click .add-projects-handler":"openAddProjectsView","click .remove-handler":"removeProject","click .projects-list .project":"gotoProject","input .filter-input":"renderProjects"},e.prototype.initialize=function(t){return this.teamProjectsCollection=t.teamProjectsCollection,this.organizationProjectsCollection=t.organizationProjectsCollection,this.teamModel=t.cardModel,this.organizationModel=t.objectModel,this.renderBasic(),this.renderProjects(),this.listen(),p.delay(function(t){return function(){return t.$el.addClass("in")}}(this)),this},e.prototype.renderBasic=function(){return this.$el.html(r({permissions:this.organizationModel.hasPermissions("team.post"),name:this.teamModel.get("name")})),this.$projectsList=this.$(".projects-list"),this},e.prototype.listen=function(){return this.listenTo(this.teamProjectsCollection,"add remove",this.renderProjects),this},e.prototype.renderProjects=function(){var t;return this.$projectsList.empty(),t=this.teamProjectsCollection.models,0===this.teamProjectsCollection.length?(this.$(".team-tip").hide(),this.$projectsList.html("<li><div class='placeholder muted'><div class='placeholder-image'></div>"+tb_i18n.get("team.manger.no.project")+"</div></li>")):t.length?(this.$(".team-tip").show(),p.each(t,function(t){return function(e){return t.renderProject(e)}}(this))):this.$projectsList.html("<li><div class='placeholder placeholder-search muted'><span class='icon icon-search-warning'></span><br>"+tb_i18n.get("search.no.content")+"</div></li>"),this},e.prototype.renderProject=function(t){var e;return e=t.toJSON(),e.permissions=this.organizationModel.hasPermissions("team.post"),this.$projectsList.append(u(e)),this},e.prototype.removeProject=function(t){var e,i,n,r;return e=$(t.currentTarget).closest(".project"),i=e.data("id"),n=this.organizationProjectsCollection.findWhere({_id:i}),null!=(r=this.projectRemovePromptView)&&r.remove(),this.projectRemovePromptView=this.requestSubView(s,{hideDelay:0,$toggler:$(t.currentTarget),title:tb_i18n.get("team.manger.project.confirm.title"),description:tb_i18n.get("team.manger.project.confirm.remove"),action:function(t){return function(){return t.teamModel.removeProject(i,{success:function(){return t.teamProjectsCollection.remove(n),o.success(tb_i18n.get("remove.success")),d.gta.event({action:"remove member",type:"team member",control:"Org Team Project List",category:"team"})}})}}(this)}).show(),this},e.prototype.gotoProject=function(t){var e,i;if(!$(t.target).hasClass("remove-handler"))return e=$(t.currentTarget).data("id"),i=this.teamProjectsCollection.get(e),d.router.navigate("project/"+e+"/"+i.getFirstApp(),{trigger:!0}),this},e.prototype.openAddProjectsView=function(){return this.requestSubView(l).open(n,{teamProjectsCollection:this.teamProjectsCollection,organizationProjectsCollection:this.organizationProjectsCollection,teamModel:this.teamModel,organizationModel:this.organizationModel}),this},e}(c)},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;c=i(358),o=i(401),a=i(788),l=i(678),r=i(1198),s=i(1199),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="AddTeamProjectsView",e.prototype.className="add-team-projects-view modal-dialog flex-vert",e.prototype.width=360,e.prototype.events={"click .add-handler":"addProject","input .filter-input":"renderProjects"},e.prototype.initialize=function(t){return this.teamProjectsCollection=t.teamProjectsCollection,this.organizationProjectsCollection=t.organizationProjectsCollection,this.teamModel=t.teamModel,this.organizationModel=t.organizationModel,this.renderBasic().renderProjects().listen(),this},e.prototype.renderBasic=function(){return this.$el.html(r()).width(this.width),this.$projectsList=this.$(".projects-list"),this.$filterInput=this.$(".filter-input"),this},e.prototype.listen=function(){return this.listenTo(this.teamProjectsCollection,"add",function(t){return function(){return t.renderProjects()}}(this)),this},e.prototype.renderProjects=function(){var t,e;return this.$projectsList.empty(),e=this.$filterInput.val().trim().toLowerCase(),t=e?this.organizationProjectsCollection.filter(function(t){return(t.get("name")||"").toLowerCase().indexOf(e)>-1||(t.get("pinyin")||"").toLowerCase().indexOf(e)>-1}):this.organizationProjectsCollection.models,0===this.organizationProjectsCollection.length?this.$projectsList.html("<li><div class='placeholder muted'>"+tb_i18n.get("team.manger.no.project")+"</div></li>"):t.length?c.each(t,function(t){return function(e){return t.renderProject(e)}}(this)):this.$projectsList.html("<li><div class='placeholder placeholder-search muted'><span class='icon icon-search-warning'></span><br>"+tb_i18n.get("search.no.content")+"</div></li>"),this},e.prototype.renderProject=function(t){var e;return e=t.toJSON(),e.permissions=this.organizationModel.hasPermissions("team.post"),e.isAddView=!0,e.isAdded=this.teamProjectsCollection.findWhere({_id:e._id}),this.$projectsList.append(s(e)),this},e.prototype.addProject=function(t){var e,i,n;return e=$(t.currentTarget).closest(".item"),i=e.data("id"),n=this.organizationProjectsCollection.findWhere({_id:i}),this.teamModel.addProject(i,{success:function(t){return function(){return t.teamProjectsCollection.add(n),o.show({message:tb_i18n.get("add.success"),status:"success"}),l.gta.event({action:"added member",type:"org member",control:"Org Team Project List",category:"team"})}}(this)})},e}(a)},function(t,e){t.exports=function(t){var e='<div class="modal-header text-center flex-static"> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> <h4 class="modal-title text-center">'+tb_i18n.get("team.projects.add.title")+'</h4></div><div class="modal-body thin-scroll flex-fill"> <input class="form-control filter-input" type="text" placeholder="'+tb_i18n.get("team.projects.add.search")+'"> <div class="team-list-view projects-list"></div></div>';return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li class="item project" data-id=\''+t._id+'\' data-gta="event" data-label="teams - enter project"> <div class="item-logo" style="background-image:url('+t.logo+');"></div> <div class="item-title" title="'+t.name+'">'+e(t.name)+"</div> ";return t.permissions.teamPost&&(i+=" ",t.isAddView?(i+=" ",i+=t.isAdded?' <button class="btn btn-text">'+tb_i18n.get("added")+"</button> ":' <button class="btn add-handler">'+tb_i18n.get("add")+"</button> ",i+=" "):i+=' <button class="btn btn-hover-danger remove-handler">'+tb_i18n.get("team.mananger.remove")+"</button> ",i+=" "),i+="</li><hr>"}},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;r=i(813),n=i(1201),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.viewName="RemovePromptView",e.prototype.className="remove-prompt-view",e.prototype.width=300,e.prototype.placement="auto bottom",e.prototype.hotkeys={esc:function(t){var e;return t.preventDefault(),null!=(e=this.$popover)&&e.parent().trigger("click"),this.hide()}},e.prototype.events={"click .rm-confirm":"deleteConfirm"},e.prototype.initialize=function(t){if(t)return this.popoverTitle=t.title,this.popoverDes=t.description,this.action=t.action,e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){return this.$el.html(n({description:this.popoverDes})),this},e.prototype.deleteConfirm=function(t){return this.hide(),$(t.currentTarget).attr("disabled","disabled"),this.action()},e.prototype.remove=function(){return e.__super__.remove.apply(this,arguments)},e}(r)},function(t,e){t.exports=function(t){var e='<form class="delete-form"> <p>'+t.description+'</p> <button class="btn btn-danger rm-confirm" type="button">'+tb_i18n.get("remove")+"</button></form>";return e}},function(t,e){t.exports=function(t){var e='<div class="team-projects-view"> <div class="actions-bar"> ';return t.permissions.teamPost&&(e+=' <div class="action"> <span class="team-tip">'+tb_i18n.get("team.name",t.name)+"</span> <a class=\"link-add-handler add-projects-handler\" data-gta=\"{action: 'add member', type: 'org member', control: 'Org Team Project List', category: 'team'}\"> "+tb_i18n.get("team.projects.add")+" </a> </div> "),e+='</div><div class="team-list-view projects-list"></div>'}},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;c=i(358),l=i(678),s=i(996),o=i(1204),r=i(1205),n=i(1206),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="TeamTasksView",e.prototype.className="team-tasks-view all-tasks-list thin-scroll",e.prototype.events={"click .task-create-handler":"openTaskCreator","click .task .task-content-set":"gtaLogOpenDetail","click .task .check-box":"gtaToggleCompleteTask","click .tasks-board-date-menu":"toggleDateSelector"},e.prototype.initialize=function(t){return this.teamModel=t.cardModel,this.load({success:function(t){return function(){return t.renderBasic(),t.refreshTasks(),t.listen()}}(this)}),e.__super__.initialize.apply(this,arguments)},e.prototype.load=function(t){return this.showLoadingIndicator(this.$el),Promise.all([new Promise(function(t){return function(e,i){return t.teamModel.fetchMemberTasks({expireCache:{namespace:"team_tasks",expire:120},success:e,error:function(t,e){return i(e)}})}}(this)),new Promise(function(t){return function(e,i){return t.teamModel.fetchMemberSubtasks({expireCache:{namespace:"team_subtasks",expire:120},success:e,error:function(t,e){return i(e)}})}}(this))]).then(function(e){return function(i){var n,a;if(e.$el)return a=i[0],n=[],c.each(i[1],function(t,e){var o;return o=new r(t),i[1][e]=o.attributes,n.push(o)}),e.tasksCollection=new s(a),e.subtasksCollection=new o(n),e.hideLoadingIndicator(),t.success()}}(this))["catch"](function(t){return console.error(t)}),this},e.prototype.loadDoneTasks=function(t){return t.attrs||(t.attrs={}),this.showLoadingIndicator(this.$el),Promise.all([new Promise(function(e){return function(i,n){return e.teamModel.fetchMemberDoneTasks({attrs:t.attrs,success:i,error:function(t,e){return n(e)}})}}(this)),new Promise(function(e){return function(i,n){return e.teamModel.fetchMemberDoneSubtasks({attrs:t.attrs,success:i,error:function(t,e){return n(e)}})}}(this))]).then(function(e){return function(i){var n,a;if(e.$el)return a=i[0],n=[],c.each(i[1],function(t,e){var o;return o=new r(t),i[1][e]=o.attributes,n.push(o)}),e.doneTasksCollection=new s(a),e.doneTasksCollection.hasMore=e.doneTasksCollection.checkHasMore(a),e.doneSubtasksCollection=new o(n),e.doneSubtasksCollection.hasMore=e.doneSubtasksCollection.checkHasMore(n),e.hideLoadingIndicator(),t.success()}}(this))["catch"](function(t){return console.error(t)}),this},e.prototype.gtaLogOpenDetail=function(){return l.gta.event({action:"open detail",type:"task",control:"Org Teams Task List"})},e.prototype.gtaToggleCompleteTask=function(){return l.gta.event({action:"toggle complete task",control:"Org Teams Task List"})},e}(n)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;n=i(685),r=i(686),s=i(1205),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.name="subtasks",e.prototype.model=s,e.prototype.boundToObjectType="task",e.prototype.orderBy="order",e.prototype.initialize=function(){return this.on("add destroy remove change:isDone",function(){
return r.trigger(":change:task/"+this._boundToObjectId,{subtaskCount:{total:this.length,done:this.getDoneSubTaskCount()}})}),e.__super__.initialize.apply(this,arguments)},e.prototype.getDoneSubTaskCount=function(){return this.where({isDone:!0}).length},e}(n)},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=i(678),r=i(429),n=i(688),o=i(686),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.name="subtask",e.prototype.urlRoot="subtasks",e.prototype.defaults={type:"subtask",isDone:!1,content:""},e.prototype.transform=function(t){return t||(t={}),t.url=this.url()+"/transform",t.success=function(t){return function(e){var i;return null!=(i=t.collection)&&i.remove(t),o.trigger(":new:tasks/"+e._stageId,e)}}(this),this.sync("update",this,t)},e.prototype.editDueDate=function(t,e){var i;return e||(e={}),e.attrs={dueDate:null},null==t?this.save(null,e):(t instanceof Date||(t=new Date(t)),t.getFullYear()&&(i=this.get("dueDate"),i instanceof Date||(i=new Date(i)),e.attrs={dueDate:t},this.save(null,e)),this)},e.prototype.getScope=function(){var t,e;return this.get("isDone")?"past":(t=r(this.get("dueDate")||null).valueOf(),e=r().endOf("day"),this.get("startOnToday")||t&&t<=e.valueOf()?"today":t&&t<=e.add(7,"days").valueOf()?"recent":"future")},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C=function(t,e){function i(){this.constructor=t}for(var n in e)x.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},x={}.hasOwnProperty;j=i(358),M=i(678),s=i(680),_=i(786),a=i(429),w=i(788),k=i(677),u=i(797),g=i(803),d=i(1205),y=i(996),m=i(1204),v=i(1207),h=i(1213),l=i(1215),f=i(1001),T=i(1217),c=i(1218),p=i(1219),o=i(1220),b=i(1221),r=i(1222),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return C(e,t),e.prototype.viewName="AllTasksListView",e.prototype.initialize=function(t){return this.options=t,this},e.prototype.listen=function(){return this.listenTo(this.tasksCollection,"add change remove destroy",this.refreshTasks),this.listenTo(this.subtasksCollection,"add change remove destroy",this.refreshTasks)},e.prototype.parseTasks=function(t){var e,i,n;return i=j.sortBy(t,function(t){return t.get("priority")||0}).reverse(),i=j.sortBy(i,function(t){return t.get("dueDate")}),i.forEach(function(t){return t.timeScope=t.getScope()}),n=j.groupBy(i,"timeScope"),e={today:n.today||[],recent:n.recent||[],future:n.future||[]},e=j.mapObject(e,function(t,e){var i;return i=j.sortBy(t,function(t){return t.get("project").name}),i=j.groupBy(i,function(t){return t.get("project").name})})},e.prototype.loadMore=function(t){var e;if(!this.loadingMore&&(e=T.getDateType(),"todo"!==e))return e=T.getDateType(),this.min_date=T.getDateString()||new Date(0).toISOString(),this.max_date=T.getRangeDateString(),this.loadDoneTasks({attrs:{minAccomplished:this.min_date,maxAccomplished:this.max_date,page:++this.donetasksPage},success:function(e){return function(){var i,n;return n=e.doneModels.concat(e.doneTasksCollection.models).concat(e.doneSubtasksCollection.models),n=j.sortBy(n,function(t){return t.get("accomplished")}).reverse(),e.renderFinishedTask(n),e.doneModels=n,i=e.doneTasksCollection.hasMore||e.doneSubtasksCollection.hasMore,e.loadingMore=!i,i?"function"==typeof t?t():void 0:e.showEndPoint(e.$detailContent)}}(this)}),this},e.prototype.renderBasic=function(){return this.$el.html(r({withCreate:this.options.withCreate})),this.$recentlyDoneTasks=this.$(".recently-done-tasks"),this.$dateMenuTitle=this.$(".date-menu-title"),this.$tasksContainer=this.$(".tasks-container"),T.setDateType("todo"),this},e.prototype.refreshFinishedTasksContainer=function(){return this.donetasksPage=0,this.doneModels=[],this.loadingMore=!1,this.$detailContent=$(".detail-picker-content"),this.$(".tasks-container").empty(),this.setupScroll(this.$detailContent),this.loadMore()},e.prototype.renderFinishedTask=function(t){var e;return this.$tasksContainer.html(o()),e=this.$(".task-list"),t.length?j.each(t,function(t){return function(i){return t.renderTask(i,e)}}(this)):e.html(c())},e.prototype.refreshHeader=function(){var t,e;return"all"===T.getDateType()?e=""+tb_i18n.get("tasklist.bar.done.tasks"):"todo"===T.getDateType()?e=tb_i18n.get("my.task.undone"):(t=T.getDateTitle(),e=""+t+tb_i18n.get("my.task.done")),this.$dateMenuTitle.text(e)},e.prototype.refreshTasks=function(){var t,e;if(this.$tasksContainer.html(b({withCreate:this.options.withCreate})),this.undoneModels=this.tasksCollection.models.concat(this.subtasksCollection.models),t=this.parseTasks(this.undoneModels),e=T.getDateType(),"todo"===e)return j.mapObject(t,function(t){return function(e,i){return t.renderCollection(e,i,t.$("."+i+"-tasks"))}}(this))},e.prototype.renderCollection=function(t,e,i){var n,r,o;return i=i.find(".task-list"),n=!j.keys(t).length,n?i.html(c()):(o=t,r=[],j.each(t,function(t,e){return r.push(t[0].get("project"))}),this.renderTasks(r,t,i))},e.prototype.renderTasks=function(t,e,i){return i.empty(),j.each(t,function(t){return function(n,r){var o,s;return 0===i.find(".my-tasks-group[data-id="+n._id+"] .group-list").length&&i.append(p(n)),s=e[n.name],o=r,j.each(s,function(e,n){return t.renderTask(e,i.find(".my-list").eq(o))})}}(this)),this},e.prototype.renderTask=function(t,e){return"task"===t.get("objectType")?this.renderSingleTask(t,e):"subtask"===t.get("type")?this.renderSingleSubtask(t,e):console.error("error")},e.prototype.renderSingleTask=function(t,e){var i,n;return this.options.noExecutor||(i=t.get("_executorId"),n=this.options.membersCollection.get(i)),this.requestSubView(v,{model:t,isUseProjectName:!0,noExecutor:this.options.noExecutor,executor:this.options.noExecutor?void 0:n.toJSON()}).$el.appendTo(e)},e.prototype.renderSingleSubtask=function(t,e){var i,n;return this.options.noExecutor||(i=t.get("_executorId"),n=this.options.membersCollection.get(i)),this.requestSubView(h,{model:t,noExecutor:this.options.noExecutor,executor:this.options.noExecutor?void 0:n.toJSON()}).$el.appendTo(e)},e.prototype.toggleDateSelector=function(t){var e,i,n;return e=$(t.currentTarget),i="toggleDateSelector",e.data(i)?this:(e.data(i,!0),null!=(n=this.toggleDateSelectorrView)&&n.remove(),this.toggleDateSelectorrView=this.requestSubView(l,{$toggler:e,width:245,dataList:T.getDateList(),selected:T.getDateType(),select:function(t){return function(e){var i;if(i=T.getDateType(),e!==i)return T.setDateType(e),t.refreshHeader(),$(".end-point-wrapper").remove(),"todo"!==e?t.refreshFinishedTasksContainer():t.refreshTasks()}}(this)}).show(),this)},e.prototype.openTaskCreator=function(){return this.requestSubView(_).open(f)},e}(w),j.extend(n.prototype,u),t.exports=n},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y=function(t,e){function i(){this.constructor=t}for(var n in e)b.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},b={}.hasOwnProperty;g=i(358),v=i(678),a=i(447),m=i(677),c=i(804),f=i(788),o=i(699),l=i(1053),u=i(995),s=i(697),d=i(1208),p=i(818),n=i(1211),r=i(1212),t.exports=h=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.viewName="TaskView",e.prototype.tagName="li",e.prototype.className="task",e.prototype.events={"click .task-content-set":"showTaskDetail","click a.check-box":"toggleTaskStatus","click .task-priority":"openTaskPrioritySetter","click .task-tag":"onClickTaskTag","touchstart .scroll-ctrl-touchscreen":"preventDefault"},e.prototype.initialize=function(t){if(null!=t?t.model:void 0)return this.options=t,this.taskModel=t.model,this.projectModel=s.find(this.taskModel.get("_projectId")),this.tagsCollection=l.get(this.taskModel.get("_projectId")),this.render().initDropHandler().listen(),this.taskModel.getRoleScope()>=0||this.$el.addClass("no-right"),this},e.prototype.listen=function(){return this.listenTo(this.taskModel,"remove destroy",this.remove),this.listenTo(this.taskModel,"change",this.render),this.listenTo(this.projectModel,"change:applications",function(t){if(t.isAppChanged("taskUniqueId")&&"card"===this.options.viewType)return this.render()}),this},e.prototype.render=function(){return this.renderContent(),this.renderTaskIdLabel(),this},e.prototype.renderContent=function(){var t,e,i,s,a,l,p,d;if(this.$el)return e="card"===this.options.viewType,t=this.taskModel.toJSON(),this.options.noExecutor||(t.executorData=t.executor||(null!=(i=o.findOne(t._projectId,t._executorId))?i.toJSON():void 0)||this.options.executor||{}),t.tasklist=null!=(s=u.find(t._tasklistId))?s.toJSON():void 0,t.project=this.projectModel.toJSON(),t.taskListTitle=this.options.isUseProjectName?null!=(a=t.project)?a.name:void 0:null!=(l=t.tasklist)?l.title:void 0,t.content=m.escape(g.unescape(t.content)),t.startDate&&(t.startDate=m.formatDate(t.startDate,e),t.startDate.datetimeFormatString=this.datetimeFormat(t.startDate)),t.dueDate&&(t.dueDate=m.formatDate(t.dueDate,e),t.dueDate.datetimeFormatString=this.datetimeFormat(t.dueDate)),t.datetimeString=this.getDatetimeString(t),t.accomplished&&(t.accomplished=m.formatDate(t.accomplished)),(null!=(p=t.subtaskCount)?p.total:void 0)<=0&&(t.subtaskCount=null),t.commentsCount>99&&(t.commentsCount="99+"),t.likesCount>999&&(t.likesCount="999+"),t.hidePriority=this.options.hidePriority,t.priority=t.isDone?0:t.priority,t.permissions=this.taskModel.hasPermissions("put","put.status"),this.$el.toggleClass("done",this.taskModel.get("isDone")),this.$el.attr("data-id",this.taskModel.id),t.tags=this.tagsCollection.getTagsbyIds(t.tagIds),t.isTouchScreen=void 0!==window.ontouchstart,t.isUniqueIdEnabled=this.projectModel.isAppEnabled("taskUniqueId")&&t.uniqueId,d=this.taskModel.getRRule(),d&&(t.freqString=c.freq2Title(d)),e?this.$el.addClass("task-card").html(n(t)):this.$el.html(r(t)),this},e.prototype.renderTaskIdLabel=function(){return this.requestSubView(p,{projectModel:this.projectModel,uniqueId:this.taskModel.get("uniqueId")}).bind(this.$(".task-id-placeholder"))},e.prototype.getDatetimeString=function(t){var e,i;return i=t.startDate,e=t.dueDate,i&&e?i.dateString===e.dateString?i.dateTimeString+" - "+e.timeFormatString:i.datetimeFormatString+" - "+e.datetimeFormatString:i?tb_i18n.get("task.startDate.label",i.datetimeFormatString):e?tb_i18n.get("task.dueDate.label",e.datetimeFormatString):""},e.prototype.datetimeFormat=function(t){var e;return e=t.dateString,"today"===t.dateClass&&"00:00"!==t.timeFormatString?e+" "+t.timeFormatString:e},e.prototype.renderExecutor=function(t){var e,i;return e=this.taskModel.get("_projectId"),t||(t=this.taskModel.get("_executorId")),i=o.getOne(e,t),this.$(".avatar").css({"background-image":"url("+i.get("avatarUrl")+")"}),this},e.prototype.toggleTaskStatus=function(){return this.taskModel.hasPermission("put.status")&&(this.$el.hasClass("done")?(this.$el.removeClass("done"),this.taskModel.markUndo()):(this.$el.addClass("done"),this.taskModel.markDone()),v.gta.event({action:"toggle complete task"})),!1},e.prototype.popOutAvatar=function(){return g.delay(function(t){return function(){return t.$(".avatar").addClass("pop-out")}}(this)),this},e.prototype.popBackAvatar=function(){return g.delay(function(t){return function(){return t.$(".avatar").removeClass("pop-out")}}(this)),this},e.prototype.initDropHandler=function(){var t,e;return this.taskModel.hasPermission("put.executor")?(t=null,e=function(e){return function(){return t&&(e.renderExecutor(),t=null),e.popBackAvatar()}}(this),this.$el.droppable({hoverClass:"hover",accept:".member",addClasses:!1,tolerance:"pointer",drop:function(i){return function(n,r){var o,s,a,c,l,p;if(i.taskModel.get("isDone"))return!1;if(t){if(c=r.helper.hide(),l=r.position.left,p=document.elementFromPoint(r.position.left,r.position.top),i.$el[0]!==p&&!i.$el.has(p).length)return e();o={_executorId:t},i.taskModel.save(o,{attrs:o}),t=null;try{return v.gta.event(null,"drop","task card|drop member")}catch(a){s=a}}}}(this),over:function(e){return function(i,n){return!e.taskModel.get("isDone")&&(e.taskModel.get("_executorId")!==n.helper.data("id")&&(e.popOutAvatar(),t=n.helper.data("id"),e.renderExecutor(t)))}}(this),out:function(){return e()}}),this):this},e.prototype.openTaskPrioritySetter=function(t){return this.taskModel.hasPermission("put")?(this.requestSubView(d,{currentPriority:this.taskModel.get("priority"),select:function(t){return function(e){return t.taskModel.save(null,{attrs:{priority:e}})}}(this)}).setup($(t.currentTarget)),this):this},e.prototype.onClickTaskTag=function(t){var e,i,n,r;switch(t.stopPropagation(),"function"==typeof(n=this.options).onTaskTagClick&&n.onTaskTagClick(),r=$(t.currentTarget).data("tag"),e=this.taskModel.get("_projectId"),r){case"project":v.router.navigate("project/"+e+"/tasks",{trigger:!0});break;case"tasklist":i=this.taskModel.get("_tasklistId"),v.gta.event(null,"click","go to tasks"),v.router.navigate("project/"+e+"/tasks/scrum/"+i,{trigger:!0})}return v.gta.event({action:"open detail",type:"project"}),this},e.prototype.preventDefault=function(t){return t.stopPropagation()},e.prototype.showTaskDetail=function(){var t;if("card"!==this.options.viewType)return this.options.showTaskDetail?this.options.showTaskDetail():(t=this.taskModel.get("_id"),v.APP.openTaskPreviewer(t))},e}(f)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;n=i(1209),r=i(1210),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.viewName="TaskPriorityView",e.prototype.className="task-priority-setter",e.prototype.events={"click li":"setPriority"},e.prototype.initialize=function(t){if(t)return this.options=t,this.currentPriority=t.currentPriority||0,this.render()},e.prototype.render=function(){return this.$el.html(n({priorityLabels:[tb_i18n.get("priority.none"),tb_i18n.get("priority.high"),tb_i18n.get("priority.urgent")],currentPriority:this.currentPriority})),this},e.prototype.setPriority=function(t){var e;return e=$(t.currentTarget),e.addClass("selected").siblings().removeClass("selected"),this.currentPriority=e.data("priority"),this.options.select(this.currentPriority),this},e}(r)},function(t,e){t.exports=function(t){var e="",i=t.priorityLabels;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+='<li class="',t.currentPriority===r&&(e+="selected"),e+='" data-priority="'+r+'"> <a><span class="icon icon-circle color-priority-'+r+'"></span> '+n+" </a></li>";return e}},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(358),r=i(677),o=i(788),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="DropdownView",e.prototype.tagName="ul",e.prototype.setup=function(t,e){return this.options=s.extend(this.options||{},e||{}),this.$el.addClass("dropdown-menu"),this.$el.attr("role","menu"),this.$opener=$(t),this.$opener.data("bs.dropdown")||(this.$opener.addClass("dropdown-toggle"),this.$opener.attr("data-toggle","dropdown"),this.$el.insertAfter(this.$opener),this.dropdown=this.$opener.dropdown(e).data("bs.dropdown"),this.$opener.parent().on("shown.bs.dropdown",function(t){return function(){return t.refreshPosition()}}(this)),this.onOpen(),this.$opener.click(function(t){return function(){return t.onOpen()}}(this))),this},e.prototype.onOpen=function(){return this.$el.on("mousewheel",r.mousewheel),this.$el.handleClickOutside(function(t){return function(){return t.onClose()}}(this)),this},e.prototype.onClose=function(){var t,e;return null!=(e=this.$el)&&e.off("mousewheel"),"function"==typeof(t=this.options).close&&t.close(),this},e.prototype.hide=function(){return this.$el.parent().hasClass("open")&&(this.dropdown.toggle(),this.onClose()),this},e.prototype.refreshPosition=function(){var t,e,i,n,r,o,s,a,c;if(e=/\s?auto\s?/i,i=(null!=(s=this.options)?s.direction:void 0)||"auto bottom",t=e.test(i),this.$el.parent().hasClass("open")&&(this.$el.attr("style",""),a=function(t){return function(){return t.$el.css({top:"bottom"===i?"100%":"auto",bottom:"top"===i?"100%":"auto"})}}(this),t&&(i=i.replace(e,"")||"bottom"),a(),t))return n=document.documentElement.scrollTop||document.body.scrollTop,c=window.innerHeight,r=this.$el[0].offsetHeight,o=this.$el.offset(),o.top<n&&"top"===i?i="bottom":o.top+r>n+c&&"bottom"===i&&(i="top"),a()},e}(o)},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(963).calculateColor;if(n+='<div class="task-priority bg-priority-'+t.priority+'" ',t.permissions.put&&(n+="data-gta=\"{action: 'select priority', control: 'Stage List'}\""),n+="></div>",t.permissions.putStatus?n+='<a class="check-box"> <span class="icon icon-tick"></span></a>':(n+='<div class="check-box non-checkable ',t.executorData&&t.executorData.name&&(n+="hinted"),n+='" data-title="',t.executorData&&t.executorData.name&&(n+=""+tb_i18n.get("task.viewl.authority.msg",t.executorData.name)),n+='"> <span class="icon icon-tick"></span></div>'),n+='<div class="task-content-set open-detail" data-type="task" data-id="'+t._id+'" data-gta="{action: \'open detail\', type: \'task\', control: \'Stage List\'}"> <div class="task-content-wrapper"> <div class="task-content"> ',"involves"==t.visible&&(n+=' <span class="icon icon-lock hinted pull-right" data-title="'+tb_i18n.get("visible.to.involve")+'"></span> '),n+=" "+e(t.content)+" </div> ",t.executorData&&(n+=" ",n+=t.executorData.avatarUrl?' <div class="avatar img-circle img-24 hinted" style="background-image:url('+t.executorData.avatarUrl+')" data-title="'+t.executorData.name+'"></div> ':' <div class="avatar img-circle img-24 placeholder"></div> ',n+=" "),n+=" </div> ",t.isDone&&t.accomplished){if(n+=" ",t.isUniqueIdEnabled||t.tags.length){n+=' <div class="task-info-wrapper clearfix"> <div class="task-infos"> ';var o=t.tags;if(o)for(var s,a=-1,c=o.length-1;a<c;)s=o[a+=1],n+=' <span class="tag"> <span class="tag-label" style="background-color: '+r(s.color,s.colorRGBA)+'"></span> <span class="tag-name">'+e(s.name)+"</span> </span> ";n+=" </div> ",t.isUniqueIdEnabled&&(n+=' <div class="task-id-wrapper wrapper"> <span class="task-id-placeholder"></span> </div> '),n+=" </div> "}n+=" "}else{if(n+=" ",t.isUniqueIdEnabled||t.tags.length||t.startDate||t.dueDate||t.freqString||t.subtaskCount&&t.subtaskCount.total||t.commentsCount||t.attachmentsCount||t.objectlinksCount||t.likesCount){n+=' <div class="task-info-wrapper clearfix"> <div class="task-infos"> ',(t.startDate||t.dueDate)&&(n+=' <span class="label ',t.dueDate&&(n+=" ","overdue"===t.dueDate.dateClass?n+=" label-important ":"today"===t.dueDate.dateClass?n+=" label-warning ":"upcoming"===t.dueDate.dateClass&&(n+=" label-info "),n+=" "),n+=' "> <span>'+t.datetimeString+"</span> </span> "),n+=" ",t.freqString&&(n+=' <span class="label label-info"> <span>'+t.freqString+"</span> </span> "),n+=" ",t.subtaskCount&&t.subtaskCount.total&&(n+=' <span class="icon-wrapper with-text"><span class="icon icon-ul"></span> '+t.subtaskCount.done+"/"+t.subtaskCount.total+" </span> "),n+=" ",t.commentsCount&&(n+=' <span class="icon-wrapper"> <span class="icon icon-comment-line"></span> </span> '),n+=" ",t.attachmentsCount&&(n+=' <span class="icon-wrapper"> <span class="icon icon-paperclip"></span> </span> '),n+=" ",t.objectlinksCount&&(n+=' <span class="icon-wrapper"> <span class="icon icon-link2"></span> </span> '),n+=" ",t.likesCount&&(n+=' <span class="icon-wrapper with-text"> <span class="icon icon-dig-line"></span> '+t.likesCount+" </span> "),n+=" ";var l=t.tags;if(l)for(var s,p=-1,u=l.length-1;p<u;)s=l[p+=1],n+=' <span class="tag"> <span class="tag-label" style="background-color: '+r(s.color,s.colorRGBA)+'"></span> <span class="tag-name">'+e(s.name)+"</span> </span> ";n+=" </div> ",t.isUniqueIdEnabled&&(n+=' <div class="task-id-wrapper wrapper"> <span class="task-id-placeholder"></span> </div> '),n+=" </div> "}n+=" "}return n+=" ",t.isTouchScreen&&(n+=' <div class="scroll-ctrl-touchscreen"></div> '),n+="</div>"}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(963).calculateColor;if(n+='<div class="task-priority bg-priority-'+t.priority+'"></div>',t.permissions.putStatus?n+=" <a class=\"check-box\" data-gta='event' data-label='task|check task'> <span class=\"icon icon-tick\"></span> </a>":(n+=' <div class="check-box non-checkable ',t.executorData&&t.executorData.name&&(n+="hinted"),n+='" data-title="',t.executorData&&t.executorData.name&&(n+=""+tb_i18n.get("task.viewl.authority.msg",t.executorData.name)),n+='"> <span class="icon icon-tick"></span> </div>'),n+='<div class="task-content-set" data-id="'+t._id+"\" data-gta='event' data-label='task|open task detail'> ",t.executorData&&(n+=" ",n+=t.executorData.avatarUrl?' <div class="avatar img-circle img-24" style="background-image:url('+t.executorData.avatarUrl+')"></div> ':' <div class="avatar img-circle img-24 no-avatar"></div> ',n+=" "),n+=' <div class="task-content-wrapper"> <div class="task-content"> '+e(t.content)+" ",t.taskListTitle&&(n+=' <a class="task-tag" data-tag="tasklist"> '+e(t.taskListTitle)+" </a> "),n+=' <span class="task-id-placeholder"></span> ',t.tags&&t.tags.length){n+=" ";var o=t.tags;if(o)for(var s,a=-1,c=o.length-1;a<c;)s=o[a+=1],n+=' <span class="label tag"> <span class="tag-label" style="background-color: '+r(s.color,s.colorRGBA)+'"></span> <span class="tag-name">'+e(s.name)+"</span> </span> ";n+=" "}return n+=" </div> ",t.isDone||!t.dueDate&&!t.startDate?t.isDone&&t.accomplished&&(n+=' <time class="task-accomplished-date"> '+t.accomplished.dateString+" </time> "):(n+=' <time class="task-duedate label ',t.dueDate&&(n+=" ","overdue"===t.dueDate.dateClass?n+=" label-important ":"today"===t.dueDate.dateClass?n+=" label-warning ":"upcoming"===t.dueDate.dateClass&&(n+=" label-info "),n+=" "),n+=' "> <span class="icon icon-calendar2 ',t.dueDate&&"normal"!==t.dueDate.dateClass&&(n+="icon-white"),n+='"></span> '+t.datetimeString+" </time> "),n+=" </div></div>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;p=i(678),l=i(358),a=i(677),c=i(788),o=i(803),s=i(1208),n=i(1214),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="SubtaskView",e.prototype.tagName="li",e.prototype.className="task subtask",e.prototype.events={"click .task-content-set":"showTaskDetail","click a.check-box":"toggleSubtaskStatus","click .task-tag":"onClickTaskTag"},e.prototype.initialize=function(t){var e;if(this.options=t,null!=(e=this.options)?e.model:void 0)return this.subtaskModel=this.options.model,this.render().listen(),this.subtaskModel.getRoleScope()>=0||this.$el.addClass("no-right"),this.subtaskModel.get("isDone")&&this.$el.addClass("done"),this},e.prototype.listen=function(){return this.listenTo(this.subtaskModel,"remove destroy change:isDone",this.remove),this.listenTo(this.subtaskModel,"change",this.render),this},e.prototype.render=function(){var t;return t=this.assembleSubtaskData(),this.$el.html(n(t)),this},e.prototype.assembleSubtaskData=function(){var t,e;return e=this.subtaskModel.toJSON(),t=l.extend(e,{permissions:this.subtaskModel.hasPermissions("subtask.put.status"),noExecutor:this.options.noExecutor,executor:this.options.executor,dueDate:e.dueDate?a.formatDate(e.dueDate):""})},e.prototype.toggleSubtaskStatus=function(){var t;if(this.subtaskModel.getRoleScope()>=0)return t=this.subtaskModel.get("isDone"),this.subtaskModel.saveAttr("isDone",!t)},e.prototype.showTaskDetail=function(){var t;return this.options.showTaskDetail?this.options.showTaskDetail():(t=this.subtaskModel.get("_taskId"),p.APP.openTaskPreviewer(t))},e.prototype.onClickTaskTag=function(t){var e,i;switch(t.stopPropagation(),i=$(t.currentTarget).data("tag"),e=this.subtaskModel.get("project")._id,i){case"project":p.router.navigate("project/"+e+"/tasks",{trigger:!0});break;case"tasklist":o.fetch(this.subtaskModel.get("_taskId"),{success:function(t){var i;return i=t.get("_tasklistId"),p.gta.event(null,"click","go to tasks"),p.router.navigate("project/"+e+"/tasks/scrum/"+i,{trigger:!0})},error:function(t){return console.error(t)}})}return p.gta.event({action:"open detail",type:"project"})},e}(c)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<a class="check-box ';return t.permissions.subtaskPutStatus||(i+="non-checkable"),i+='"> <span class="icon icon-tick"></span></a><div class="task-content-set" data-id="'+t._taskId+'"> ',t.noExecutor||(i+=" ",i+=t.executor.avatarUrl?' <div class="avatar img-circle img-24 hinted" style="background-image:url('+t.executor.avatarUrl+')" data-title="'+t.executor.name+'"></div> ':' <div class="avatar img-circle img-24 placeholder"></div> ',i+=" "),i+=' <div class="task-content-wrapper"> <div class="task-content"> '+e(t.content)+" ",t.project&&t.project.name&&(i+=' <a class="task-tag" data-tag="tasklist"> '+e(t.project.name)+" </a> "),i+=" ",t.task&&(i+=' <div class="subtask-info muted">'+tb_i18n.get("task.list.belong.to",t.task.content)+"</div> "),i+=" </div> ",!t.isDone&&t.dueDate&&(i+=' <time class="task-duedate label ',"overdue"===t.dueDate.dateClass?i+="label-important":"today"===t.dueDate.dateClass?i+="label-warning":"upcoming"===t.dueDate.dateClass&&(i+="label-info"),i+='"> <span class="icon icon-calendar2 ',"normal"!==t.dueDate.dateClass&&(i+="icon-white"),i+='"></span> <span>'+t.dueDate.dateTimeString+"</span> </time> "),i+=" </div></div>"}},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(358),o=i(1021),n=i(1216),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="PopoverCategoryMenuView",e.prototype.className="popover-category-menu-view popover-menu-view",e.prototype.events={"click .menu-item":"changeItem"},e.prototype.initialize=function(t){if(null!=t?t.dataList:void 0)return this.multi=t.multi,this.dataList=t.dataList||[],this.selected=t.selected,this.multi&&!s.isArray(this.selected)&&(this.selected=[]),e.__super__.initialize.apply(this,arguments),this},e.prototype.render=function(){return this.$el.html(n({selected:"todo"===this.selected})),this.$undoneUl=this.$(".undone-tasks-list ul"),this.$finishedUl=this.$(".finished-tasks-list ul"),this.$addInput=this.$(".add-input"),this.renderFinished(this.dataList,this.selected),this},e.prototype.renderFinished=function(t,e){return this.renderItems(t,e),this},e.prototype.renderItems=function(t,e){if(this.$finishedUl)return s.isArray(e)||(e=[e]),s.each(t,function(t){return t.selected=e.indexOf(t._id)>=0}),this.$finishedUl.html(this.ListTemplate({dataList:t})),t!==this.dataList&&this.$finishedUl.find(".menu-item:first").addClass("active"),this},e.prototype.changeItem=function(t){var e;return e=this.$(t.currentTarget).data("id"),this.toggleItem(t)},e}(o),t.exports=r},function(t,e){t.exports=function(t){var e='<div class="undone-tasks-list category-tasks"> <div class="title">'+tb_i18n.get("my.task.undone")+'</div> <ul class="list-unstyled"> <li class="menu-item ';return t.selected&&(e+="selected"),e+='" data-id="todo"> <a>'+tb_i18n.get("my.task.dateByAll")+'</a> </li> </ul></div><div class="finished-tasks-list category-tasks"> <div class="title">'+tb_i18n.get("tasklist.bar.done.tasks")+'</div> <ul class="list-unstyled"></ul></div>'}},function(t,e,i){var n,r,o,s,a,c,l,p;a=i(358),s=i(677),r=i(429),o=i(697),l="todo",p="project",c={done:"all",created:"all"},n=function(){function t(){}return t.prototype.getFilterType=function(){return l},t.prototype.setFilterType=function(t){return l=t},t.prototype.getFilterList=function(){var t,e,i,n,r;for(r=[],n=["todo","joined","done","created"],t=0,i=n.length;t<i;t++)e=n[t],r.push({_id:e,title:this.getFilterTitle(e)});return r},t.prototype.getFilterTitle=function(t){switch(t||(t=this.getFilterType()),t){case"todo":return tb_i18n.get("my.task.undone");case"joined":return tb_i18n.get("my.task.joined");case"done":return tb_i18n.get("my.task.done");case"created":return tb_i18n.get("my.task.created")}},t.prototype.getDateType=function(){return c[l]||"all"},t.prototype.setDateType=function(t){return c[l]=t},t.prototype.getDateList=function(){var t,e,i,n,r;for(r=[],n=["all","today","yesterday","lastWeek","lastTwoWeek","lastMonth"],t=0,i=n.length;t<i;t++)e=n[t],r.push({_id:e,title:this.getDateTitle(e)});return r},t.prototype.getDateString=function(t){var e;switch(t||(t=this.getDateType()),e=r().startOf("day"),t){case"today":return e.toISOString();case"yesterday":return e.subtract(1,"day").toISOString();case"lastWeek":return e.subtract(1,"week").toISOString();case"lastTwoWeek":return e.subtract(2,"week").toISOString();case"lastMonth":return e.subtract(1,"month").toISOString();default:return null}},t.prototype.getRangeDateString=function(t){var e;switch(t||(t=this.getDateType()),e=r().startOf("day"),t){case"all":return e.add(1,"day").toISOString();case"today":return e.add(1,"day").toISOString();case"yesterday":return e.toISOString();case"lastWeek":return e.add(1,"day").toISOString();case"lastTwoWeek":return e.add(1,"day").toISOString();case"lastMonth":return e.add(1,"day").toISOString();default:return null}},t.prototype.getDateTitle=function(t){switch(t||(t=this.getDateType()),t){case"all":return tb_i18n.get("my.task.dateByAll");case"today":return tb_i18n.get("my.task.dateByToday");case"yesterday":return tb_i18n.get("my.task.dateByYesterday");case"lastWeek":return tb_i18n.get("my.task.dateByLastWeek");case"lastTwoWeek":return tb_i18n.get("my.task.dateByLastTwoWeek");case"lastMonth":return tb_i18n.get("my.task.dateByLastMonth")}},t.prototype.getSortType=function(){return p},t.prototype.setSortType=function(t){return p=t},t.prototype.getSortList=function(){var t,e,i,n,r;for(r=[],n=["project","priority"],t=0,i=n.length;t<i;t++)e=n[t],r.push({_id:e,title:this.getSortTitle(e)});return r},t.prototype.getSortTitle=function(t){switch(t||(t=this.getSortType()),t){case"project":return tb_i18n.get("my.task.sortByProject");case"priority":return tb_i18n.get("my.task.sortByPriority");case"dueDate":return tb_i18n.get("my.task.sortByDueDate")}},t.prototype.sortTask=function(t,e){switch(e||(e=this.getSortType()),e){case"priority":case"project":return this.sortByPriority(t);case"dueDate":return this.sortByDueDate(t);default:return t}},t.prototype.sortByPriority=function(t){return t.sort(s.compareTask)},t.prototype.sortByDueDate=function(t){return t.sort(this.dueDateSorter)},t.prototype.dueDateSorter=function(t,e){var i,n;return i=new Date(t.dueDate||0).valueOf()||Number.MAX_VALUE,n=new Date(e.dueDate||0).valueOf()||Number.MAX_VALUE,i-n},t.prototype.getProjects=function(t){var e,i,n,r,s,c,l,p;
for(c={},e=0,i=t.length;e<i;e++)p=t[e],c[n=p._projectId]||(c[n]=null!=(l=o.find(p._projectId))?l.toJSON():void 0),c[r=p._projectId]||(c[r]=a.clone(p.project)||{}),s=c[p._projectId],s.tasks||(s.tasks=[]),s.tasks.push(p),s.count=s.tasks.length;return a.chain(c).values().sortBy("name").value()},t}(),t.exports=new n},function(t,e){t.exports=function(t){var e='<li class="no-task-placeholder"> <span class="muted">'+tb_i18n.get("tasks.no.task")+"</span></li>";return e}},function(t,e){t.exports=function(t){var e='<li class="my-tasks-group" data-id="'+t._id+'"> <ul class="group-list my-list"></ul></li>';return e}},function(t,e){t.exports=function(t){var e='<div class="recently-done-tasks finished-tasks member-tasks" data-gta="event" data-label="member recently done tasks" data-value="member recently done tasks"> <ul class="task-list"></ul></div';return e}},function(t,e){t.exports=function(t){var e='<div class="today-tasks undone-tasks member-tasks';return t.withCreate||(e+=" moveUp"),e+='" data-gta="event" data-label="member today tasks" data-value="member today tasks"> <h3>'+tb_i18n.get("member.tasks.today.tasks")+'</h3> <ul class="task-list"></ul></div><div class="recent-tasks undone-tasks member-tasks" data-gta="event" data-label="member recent tasks" data-value="member recent tasks"> <h3>'+tb_i18n.get("member.tasks.recent.tasks")+'</h3> <ul class="task-list"></ul></div><div class="future-tasks undone-tasks member-tasks" data-gta="event" data-label="member future tasks" data-value="member future tasks"> <h3>'+tb_i18n.get("member.tasks.future.tasks")+'</h3> <ul class="task-list"></ul></div>'}},function(t,e){t.exports=function(t){var e='<h3 class="clearfix header-handler"> ';return t.withCreate&&(e+=' <a class="flex-static task-create-handler link-add-handler" data-gta="{action: \'add content\', type: \'task\'}"> <span class="icon icon-circle-cross"></span> <span>'+tb_i18n.get("task.creator.add")+"</span> </a> "),e+=' <div class="pull-right"> <a class="tasks-board-date-menu"> <span class="date-menu-title">'+tb_i18n.get("tasklist.bar.total.tasks")+'</span> <i class="icon icon-chevron-down"></i> </a> </div></h3><div class="tasks-container"></div>'}},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;l=i(358),p=i(678),a=i(788),r=i(1079),c=i(1224),o=i(1226),n=i(1244),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="TeamEventsView",e.prototype.className="team-events-view fade",e.prototype.initialize=function(t){return this.membersCollection=t.membersCollection,this.teamModel=t.cardModel,this.eventsCollection=r.get(this.teamModel.id),this.objectModel=t.objectModel,this.renderBasic().renderWeekPicker().renderEvents().listen(),l.delay(function(t){return function(){return t.$el.addClass("in")}}(this)),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$weekSelectorWrap=this.$(".week-selector-wrap"),this.$eventsListWrap=this.$(".events-list-wrap"),this},e.prototype.listen=function(){return this.listenTo(this.eventsCollection,"remove add change:startDate change:endDate",this.renderEvents),this},e.prototype.renderWeekPicker=function(){return this.weekPicker=this.requestSubView(c,{createdDate:this.objectModel.get("created"),onChange:function(t){return function(){return p.gta.event({action:"filter event date"}),t.renderEvents()}}(this)}),this.$weekSelectorWrap.html(this.weekPicker.$el),this},e.prototype.renderEvents=function(){return this.showLoadingIndicator(this.$el),this.teamModel.fetchEvents({data:{startDate:this.weekPicker.startOfWeek.toISOString(),endDate:this.weekPicker.endOfWeek.toISOString()},success:function(t){return function(e){var i;if(t.$el)return t.eventsCollection.reset(e),t.eventsCollection.each(function(e){var i;return i=[],l.each(e.get("involveMembers"),function(e){var n;if(n=t.membersCollection.get(e))return i.push({_id:n.get("_id"),name:n.get("name"),avatarUrl:n.get("avatarUrl")})}),e.set("involved",i)}),t.hideLoadingIndicator(),i=t.requestSubView(o,{groupBy:!0,rightOffset:0,showInvolved:!0,weekly:t.weekPicker.startOfWeek,eventsCollection:t.eventsCollection}),t.$eventsListWrap.html(i.$el)}}(this)}),this},e}(a)},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(358),s=i(788),r=i(429),o=i(1021),n=i(1225),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="WeekSelectorView",e.prototype.className="week-selector-view",e.prototype.events={"click .switch-handler":"switchWeek"},e.prototype.initialize=function(t){return this.options=t,this.reset(),this},e.prototype.reset=function(){return this.startOfWeek=r().startOf("week"),this.endOfWeek=r().endOf("week"),this.weeksList=[],this.index=0,this.generateWeeks().renderBasic(),this},e.prototype.renderBasic=function(){var t;return t=c.find(this.weeksList,function(t){return function(e){return e._id===t.index}}(this)),this.$el.html(n({weekString:t.title})),this},e.prototype.generateWeeks=function(){var t,e,i;for(i=0;i<26;)e=r(),e.subtract(i,"weeks"),t=this.dateDataConstructor(e,i),i++,t.startDate.valueOf()<r(this.options.createdDate).valueOf()&&(i=26),this.weeksList.push(t);for(;i<52;)e=r(),e.add(i-25,"weeks"),t=this.dateDataConstructor(e,i),i++,this.weeksList.unshift(t);return this},e.prototype.dateDataConstructor=function(t,e){var i,n,r,o,s;return r=t.clone().startOf("week"),n=t.clone().endOf("week"),o=t.format("wo"),s=r.format("MM.DD")+" - "+n.format("MM.DD")+" ("+o+")",i={_id:e,title:s,startDate:r,endDate:n}},e.prototype.switchWeek=function(t){var e,i,n;if(e=$(t.currentTarget),i="weekSelectorPopover",!e.data(i))return e.data(i,!0),null!=(n=this.WeekSelectorPopover)&&n.remove(),this.WeekSelectorPopover=this.requestSubView(o,{$toggler:e,width:240,searchPlaceholder:tb_i18n.get("week.selector.search"),dataList:this.weeksList,selected:this.index,select:function(t){return function(e){var i,n;return t.index=e,n=c.find(t.weeksList,function(t){return t._id===e}),t.startOfWeek=n.startDate,t.endOfWeek=n.endDate,t.renderBasic(),"function"==typeof(i=t.options).onChange?i.onChange():void 0}}(this)}).show(),this},e}(s)},function(t,e){t.exports=function(t){var e='<a class="week-info switch-handler">'+t.weekString+'<span class="icon icon-chevron-down"></span></a>';return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f=function(t,e){function i(){this.constructor=t}for(var n in e)g.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},g={}.hasOwnProperty;h=i(358),m=i(678),d=i(786),n=i(1227),c=i(794),r=i(1228),o=i(1242),a=i(429),l=i(1243),p=i(677),u=i(788),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.viewName="EventsListView",e.prototype.tagName="ul",e.prototype.className="events-list",e.prototype.events={"click .event":"openDetail"},e.prototype.initialize=function(t){return!(null==t||!t.eventsCollection)&&(this.options=t,this.eventsCollection=t.eventsCollection,this.$placeholder=$(l()),this.checkPlaceholder().renderEvents().listen(),t.groupBy&&this.$el.addClass("events-group"),this)},e.prototype.listen=function(){return this.listenTo(this.eventsCollection,"add change",function(t){return function(e){return e.collection===t.eventsCollection&&t.renderEvent(e,!0),t.checkPlaceholder()}}(this)),this.listenTo(this.eventsCollection,"destroy remove",function(t){return function(e){return t.$(".event[data-id="+e.id+"]").remove(),t.checkGroupBy(e),t.checkPlaceholder()}}(this)),this},e.prototype.renderEvents=function(){var t,e,i;if(this.options.weekly)for(t=7,i=this.options.weekly.clone();t--;)this.getOrRenderEventDate({date:i.format("YYYYMMDD"),dateString:""+i.format("ddd")+tb_i18n.get("comma")+i.format("MM.DD")}),i.add(1,"d");return e=this.eventsCollection.models.slice(),h.each(e,function(t){return function(e){return t.renderEvent(e)}}(this)),this},e.prototype.renderEvent=function(t){var e,i,n,r,s,c,l,u,d,h,m,f,g,v;if(l=t.toJSON(),m="HH:mm",l.startDateString=a(l.startDate).format(m),v=p.formatDate(new Date(l.startDate)).dateString,f=a("today"===t.getScope()?new Date:l.startDate),h={date:f.format("YYYYMMDD"),dateString:p.formatDate(f).dateString},this.options.weekly&&(h.dateString=""+f.format("ddd")+tb_i18n.get("comma")+f.format("MM.DD")),n=this.getOrRenderEventDate(h),n.next(".no-event-placeholder").remove(),(v===h.dateString||this.options.weekly)&&this.options.groupBy||(l.startDateString=h.dateString+" "+l.startDateString),null!=l.endDate&&(u=a(l.endDate),d=p.formatDate(u).dateString,l.endDateString=a(l.endDate).format(m),l.startDateString+=" - ",u.isSame(f,"day")?(l.startDateString+=l.endDateString,l.endDateString=""):l.endDateString=d+" "+l.endDateString),l.date=h.date,l.showInvolved=this.options.showInvolved,l.involved&&l.involved.length>3&&(l.involvedString=l.involved.map(function(t){return t.name}).join(", ")),i=$(o(l)),c=this.$(".event[data-id="+t.id+"]"),g=c.data("date")+"",c.length&&g===l.date)c.replaceWith(i);else{for(c.remove(),r=this.$("[data-date="+g+"]"),r.length<=1&&r.remove(),e=n,s=e.next(".event");s.length;)e=s,s=e.next(".event");i.insertAfterH(e)}return this},e.prototype.getOrRenderEventDate=function(t){var e,i;return this.eventDates||(this.eventDates=[]),e=this.$(".event-date-wrap[data-date="+t.date+"]"),e.length||(e=$(n(t)),this.eventDates.push(+t.date),this.eventDates.sort(),i=this.eventDates.indexOf(+t.date),i<this.eventDates.length-1?e.insertBeforeH(this.$(".event-date-wrap[data-date="+this.eventDates[i+1]+"]")):e.appendTo(this.$el)),e},e.prototype.checkGroupBy=function(t){var e,i,n;return n=a("today"===t.getScope()?new Date:t.get("startDate")).format("YYYYMMDD"),e=this.$(".event-date-wrap[data-date="+n+"]"),i=e.next(),i.length&&!i.hasClass("event-date-wrap")||e.remove(),this},e.prototype.checkPlaceholder=function(){return this.options.weekly||(this.$placeholder.remove(),this.eventsCollection.length||this.$el.html(this.$placeholder)),this},e.prototype.openDetail=function(t){var e;return e=this.eventsCollection.get($(t.currentTarget).data("id")),m.APP.openEventPreviewer(e),this},e}(u)},function(t,e){t.exports=function(t){var e='<li class="event-date-wrap" data-date="'+t.date+'"> <span class="event-date">'+t.dateString+'</span></li><li class="no-event-placeholder"> <span class="muted">'+tb_i18n.get("events.no.event")+"</span></li>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S=function(t,e){return function(){return t.apply(e,arguments)}},I=function(t,e){function i(){this.constructor=t}for(var n in e)z.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},z={}.hasOwnProperty,P=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};M=i(358),x=i(678),v=i(429),_=i(677),b=i(804),j=i(788),f=i(817),y=i(696),h=i(1126),n=i(809),r=i(796),p=i(983),u=i(1071),m=i(1229),o=i(1237),T=i(786),a=i(1186),w=i(1188),k=i(1151),s=i(1239),l=i(1240),g=i(1241),c=i(1185),a=i(1186),w=i(1188),C=/\/event\/[0-9a-f]{24}.*$/,t.exports=d=function(t){function e(){return this._innerPinBarHandler=S(this._innerPinBarHandler,this),e.__super__.constructor.apply(this,arguments)}return I(e,t),e.prototype.viewName="EventDetailView",e.prototype.tagName="div",e.prototype.className="event-detail toggler-parent fade thin-scroll event-detail-loading",e.prototype.events={"click .menu-handler":"toggleEventMenu","keydown .attr-input":"quickSaveAttr","blur .attr-input":"saveAttr","click .date-input":"showDatepicker","click .time-input":"showTimePicker","click .all-day-switcher":"switchAllDay","mousewheel .detail-content":_.mousewheel,"click .event-detail-repeat-handler":"showEditor","click .event-detail-start-handler":"showEditor","click .event-detail-end-handler":"showEditor","click .icon-video":"openAppearin","click .unarchive-handler":"openUnarchiveMenu","click .remove-handler":"deleteModelObject"},e.prototype.initialize=function(t){if(t._eventId||t.eventModel)return this.options=t,this._eventId=t._eventId,this.eventModel=t.eventModel,this.showLoadingIndicator(),this.load().then(function(t){return function(){var e;return t.renderBasic(),t.renderHeader(),t.renderInfos(),t.renderArchivedBadge(),t.initActivityTimeline(),t.renderActivitiyCreator(),t.listen(),t.activeEventCard(),"function"==typeof(e=t.options).success&&e.success(t),t.eventModel.eventDetailView=t}}(this))["catch"](function(t){return function(e){var i;return t.options.silentError&&"function"==typeof(i=t.options).error&&i.error(t),console.error(e),t.close()}}(this)),M.delay(function(t){return function(){return t.$el.addClass("in")}}(this)),this},e.prototype.refreshView=function(){var t;return t=x.router.getUrl(),this.resetView(),this.initialize(this.options),C.test(t)&&(t=t.replace(C,"/event/"+this.eventModel.id),x.router.navigate(t,{trigger:!1})),this},e.prototype.load=function(){return new Promise(function(t){return function(e,i){var n;return t.eventModel?(t._eventId=t.eventModel.id,void e()):(n={silentError:t.options.silentError||!1,success:function(i){return i.refreshDate(),t.eventModel=i,e()},error:function(t,e){return i(e)}},f.fetch(t._eventId,n))}}(this)).then(function(t){return function(){return t._projectId=t.eventModel.get("_projectId"),t.projectModel=y.getOne(0,t._projectId),t.eventModel.getRoleScope()<0&&t.$el.addClass("guest"),t.hideLoadingIndicator(),t.$el.removeClass("event-detail-loading")}}(this))},e.prototype.listen=function(){return this.listenTo(this.eventModel,"destroy remove",function(t){return function(){var e,i;return"function"==typeof(e=t.options).onEventDelete&&e.onEventDelete(t.eventModel),"function"==typeof(i=t.options).onUnfavorite&&i.onUnfavorite(t.eventModel.get("_id")),t.close()}}(this)),this.listenTo(this.eventModel,"cancel change",function(t){return function(){var e;if(t.$el)return t.renderHeader(),t.renderArchivedBadge(),t.renderInfos(),"function"==typeof(e=t.options).onEventChange?e.onEventChange(t.eventModel):void 0}}(this)),this.listenTo(this.eventModel,"change:recurrence",function(t){return function(){var e,i,n,r,o,s;if(i=t.eventModel.toJSON(),o=b.getRRuleSet(i.recurrence),o&&(s=v(i.startDate).subtract(1,"month").toDate(),e=v(i.startDate).add(1,"month").toDate(),r=o.between(s,e,!0).map(function(t){return t.toISOString()}),n=i.startDate,P.call(r,n)<0))return t.close()}}(this)),this.listenTo(this.projectModel,"change:applications",function(){if(this.projectModel.isAppChanged("appearin"))return this.renderAppearin()}),this},e.prototype.renderBasic=function(){return this.$el.html(l()),this.$eventDetailInfoContainer=this.$(".event-detail-info-container"),this.$involveSet=this.$(".involve-set"),this.$activityCreator=this.$(".activity-creator-wrapper"),this.$detailContent=this.$(".detail-content"),this.$noteInputSet=this.$(".note-input-set"),this},e.prototype.renderHeader=function(){var t,e,i,n;return t=this.eventModel.toJSON(),t.permissions=this.eventModel.hasPermissions("put","put.archive","put.visible","del"),t.isAllDay=this.eventModel.checkAllDay(),this.eventModel.isRecurrenceEventInstance()&&(i=this.eventModel.getRRuleSet()),n=v(t.startDate),e=v(t.endDate),t.isAllDay?(e=e.subtract(1,"day"),t=M.extend(t,{startDateString:_.formatDate(n).dateString,startTimeString:"",endDateString:_.formatDate(e).dateString,endTimeString:""})):t=M.extend(t,{startDateString:_.formatDate(n).dateString,startTimeString:v(n).format("LT"),endDateString:_.formatDate(e).dateString,endTimeString:v(e).format("LT")}),t=M.extend(t,{isArchived:this.eventModel.get("isArchived"),scope:this.eventModel.getScope(),repeatTitle:i?b.freq2Title(i)||"":void 0}),this.$(".event-detail-header-wrap").html(g(t)),this},e.prototype.renderInfos=function(){return this.infosView=this.requestSubView(p,{objectModel:this.eventModel,boundToObjectType:"event",infos:["note","repeat","reminder","link","tag"],noteAttribute:"content"}),this.$(".event-detail-infos-wrap").html(this.infosView.$el),this.$detailContent.off("scroll",this._innerPinBarHandler).on("scroll",this._innerPinBarHandler),this},e.prototype._innerPinBarHandler=function(){return k.trigger("noteEditorToolBarScroll",this.$detailContent)},e.prototype.renderArchivedBadge=function(){var t;return t={isArchived:this.eventModel.get("isArchived"),text:tb_i18n.get("event.detail.archived"),cancel:tb_i18n.get("unarchive"),deleted:tb_i18n.get("delete.event"),permissions:this.eventModel.hasPermissions("put.archive","del")},this.$(".archived-wrapper").html(c(t)),this.$el[t.isArchived?"addClass":"removeClass"]("archived"),this},e.prototype.initActivityTimeline=function(){return this.activityTimelineView=this.requestSubView(r,{_projectId:this._projectId,boundToObjectType:"event",objectModel:this.eventModel,$scrollFrame:this.$(".detail-content"),where:this.options.where,success:function(t){return function(){return t.activityCreatorView.show()}}(this)}),this.listenTo(this.activityTimelineView,"toggleOnlyCommentsBtn",function(t){return function(e){var i;return null!=(i=t.activityCreatorView)?i.toggleOnlyCommentsBtn(e):void 0}}(this)),this.activityTimelineView.$el.appendTo(this.$(".detail-activities-wrap")),this.eventModel.getRoleScope()>=0&&this.renderAppearin(),this},e.prototype.renderAppearin=function(){var t,e;return t=this.$(".activities-timeline-involve-set"),this.projectModel.isAppEnabled("appearin")?t.addClass("with-appearin").append(s(this.eventModel.toJSON())):(t.removeClass("with-appearin"),null!=(e=this.$(".event-detail-appearin"))&&e.remove()),this},e.prototype.renderActivitiyCreator=function(){return this.activityCreatorView=this.requestSubView(n,{_projectId:this._projectId,where:this.options.where,boundToObjectType:"event",objectModel:this.eventModel}),this.listenTo(this.activityCreatorView,"filterActivities",function(t){return function(e){var i;return null!=(i=t.activityTimelineView)?i.filterActivities(e):void 0}}(this)),this.$(".activity-creator-wrapper").html(this.activityCreatorView.$el),this},e.prototype.showEditor=function(){return this.parentView.requestSubView(T).open(u,{eventModel:this.eventModel,_projectId:this.eventModel.get("_projectId"),title:tb_i18n.get("event.creator.edit.title"),noRecurrence:this.options.noRecurrence}),this},e.prototype.openAppearin=function(){return this.requestSubView(T).open(o,{_eventId:this._eventId})},e.prototype.toggleEventMenu=function(t){var e;return e=$(t.currentTarget),e.data("bs.popover")||this.requestSubView(m,{fixed:this.$el.closest(".panel-view").length,$toggler:e,_projectId:this._projectId,eventModel:this.eventModel,noRecurrence:this.options.noRecurrence,onUnfavorite:this.options.onUnfavorite}).show(),this},e.prototype.openUnarchiveMenu=function(t){var e;if(e=$(t.currentTarget),!e.data("bs.popover"))return this.requestSubView(w,{$toggler:e,title:tb_i18n.get("unarchive"),currentModel:this.eventModel,msg:tb_i18n.get("unarchived.event.success")}).show()},e.prototype.deleteModelObject=function(t){var e;return e=$(t.currentTarget),e.data("bs.popover")||this.requestSubView(a,{$toggler:e,title:tb_i18n.get("delete.post"),confirmDelete:tb_i18n.get("event.menu.confirm.delete"),currentModel:this.eventModel}).show(),this},e.prototype.activeEventCard=function(){return this.unactiveEventCard(),$(".event[data-id="+this._eventId+"]").addClass("active-event-detail"),this},e.prototype.unactiveEventCard=function(){return $(".active-event-detail").removeClass("active-event-detail"),this},e.prototype.quickSaveAttr=function(t){if(13===t.keyCode)return t.preventDefault(),$(t.currentTarget).blur()},e.prototype.saveAttr=function(t){var e,i,n,r;if(e=$(t.currentTarget),r=e.text().trim(),i=e.data("attr"),r&&r!==this.eventModel.get(i))return n={},n[i]=r,h.saveAttrs(this.eventModel,n)},e.prototype.showDatepicker=function(t){var e,i;if(!this.eventModel.get("isArchived"))return e=$(t.currentTarget),i=e.data("attr"),h.showDatePicker(e,this.eventModel,i)},e.prototype.showTimePicker=function(t){var e,i;if(!this.eventModel.get("isArchived"))return e=$(t.currentTarget),i=e.data("attr"),h.showTimePicker(e,this.eventModel,i,this)},e.prototype.switchAllDay=function(t){var e;if(!this.eventModel.get("isArchived"))return e=!$(t.currentTarget).hasClass("active"),h.switchAllDay(this.eventModel,e)},e.prototype.close=function(){var t,e;return"EventDetailPanel"===(null!=(e=this.parentView)?e.viewName:void 0)?"function"==typeof(t=this.parentView).back&&t.back():this.remove(),this},e.prototype.remove=function(){var t,i,n;return null!=(t=this.$activityCreator)&&t.remove(),this.unactiveEventCard(),this.eventModel&&(this.eventModel.eventDetailView=null,n=x.router.getUrl().replace(C,""),x.router.navigate(n,{trigger:!1})),"ObjectModalView"===(null!=(i=this.parentView)?i.viewName:void 0)&&this.parentView.remove(),e.__super__.remove.apply(this,arguments)},e}(j)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},v={}.hasOwnProperty;f=i(678),c=i(401),h=i(677),d=i(696),r=i(1230),a=i(1231),l=i(1071),u=i(813),m=i(786),s=i(1232),n=i(1233),o=i(1234),t.exports=p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.viewName="EventMenuView",e.prototype.popoverTitle="",e.prototype.events={"click .edit-event-handler":"editEvent","click .copy-event-handler":"forkEvent","click .move-event-handler":"moveEvent","click .archive-event-handler":"archiveEvent","click .unarchive-event-handler":"unarchiveEvent","click .delete-event-handler":"deleteEvent","click .favorite-event-handler":"favoriteEvent","click .switch-visible-handler":"switchVisible","submit .delete-form":"submitDeleteForm"},e.prototype.initialize=function(t){return this._projectId=t.eventModel.get("_projectId"),this.popoverTitle=tb_i18n.get("event.menu.title"),e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){var t;return t=this.options.eventModel.toJSON(),t.permissions=this.options.eventModel.hasPermissions("put","put.move","put.archive","put.visible","del"),this.$el.html(r(t)),this.triggerHook("render"),this},e.prototype.editEvent=function(){return this.parentView.requestSubView(m).open(l,{eventModel:this.options.eventModel,_projectId:this.options._projectId,title:tb_i18n.get("event.creator.edit.title")}),this.remove(),this},e.prototype.forkEvent=function(){return this.copyOrMoveEvent("fork")},e.prototype.moveEvent=function(){return this.copyOrMoveEvent("move")},e.prototype.copyOrMoveEvent=function(t){var e,i,n,r;switch(e=this.formatProjectsDataList(t),n=tb_i18n.get("project.select.list.hint"),t){case"fork":r=tb_i18n.get("fork.to.other.project"),i=tb_i18n.get("event.fork.hint");break;case"move":r=tb_i18n.get("move.to.other.project"),i=tb_i18n.get("event.move.hint")}return this.enterSubMenu(r,function(r){return function(){return r.copyOrMoveListView=r.requestSubView(o,{dataList:e,globalHint:i,selectHint:n,selectConfirm:function(e){return r.copyOrMoveListView.disableSubmit(),r.copyOrMoveCallback(e,t)}}),r.$el.html(r.copyOrMoveListView.$el)}}(this))},e.prototype.formatProjectsDataList=function(t){var e;return e=[],d.get(0).each(function(i){return function(n){var r,o;if(!(n.getRoleScope()<0||n.id===i._projectId))return r=n.getCopyOrMoveStatus("events"),o=function(){switch(r){case"closed":return tb_i18n.get("target.event.closed");case"denied":if("fork"===t)return tb_i18n.get("target.event.fork.post.denied");if("move"===t)return tb_i18n.get("target.event.move.post.denied");break;default:return""}}(),e.push({id:n.get("_id"),name:n.get("name"),pinyin:n.get("pinyin"),py:n.get("py"),disabled:null!=r,disabledHint:o})}}(this)),e},e.prototype.copyOrMoveCallback=function(t,e){return this.options.eventModel.forkOrMove(e,t,{success:function(t){return function(i){var n;return n=function(){switch(e){case"fork":return tb_i18n.get("event.menu.fork.success");case"move":return tb_i18n.get("event.menu.move.success")}}(),h.message({tips:n,url:"/project/"+i._projectId+"/events/event/"+i._id,title:t.options.eventModel.get("title")}),t.remove()}}(this),error:function(t){return function(){var i;return i=function(){switch(e){case"fork":return tb_i18n.get("event.menu.fork.fail");case"move":return tb_i18n.get("event.menu.move.fail")}}(),c.show({message:i,status:"error"}),t.copyOrMoveListView.enableSubmit()}}(this)})},e.prototype.archiveEvent=function(){var t,e;return t=this.options.eventModel,e=function(){return c.success({message:tb_i18n.get("archived.event.success")})},t.isRecurrenceEventInstance()?this.parentView.requestSubView(m).open(n,{onConfirm:function(i){return t.archiveEvent(i).then(function(){return e()})}}):t.archive({success:e}),this.remove()},e.prototype.unarchiveEvent=function(){return this.options.eventModel.unarchive({success:function(t){return function(){return c.show({message:tb_i18n.get("unarchived.event.success"),status:"success"}),t.remove()}}(this)}),this},e.prototype.enterDeleteSubMenu=function(){return this.enterSubMenu(tb_i18n.get("event.menu.delete.title"),function(t){return function(){return t.$el.html(a())}}(this)),this},e.prototype.favoriteEvent=function(){var t;return t=this.options.eventModel.get("isFavorite"),this.options.eventModel[t?"unFavorite":"doFavorite"]({success:function(t){return function(e){var i;if(t.options.eventModel.set("isFavorite",e.isFavorite),t.render(),!e.isFavorite&&t.options.onUnfavorite)return"function"==typeof(i=t.options).onUnfavorite&&i.onUnfavorite(t.options.eventModel.get("_id")),t.parentView.close()}}(this)}),this},e.prototype.deleteEvent=function(){return this.options.eventModel.isRecurrenceEventInstance()?this.showDeleteRecurrenceEventConfirm():this.enterDeleteSubMenu(),this},e.prototype.submitDeleteForm=function(t){var e;return t.preventDefault(),e=this.options.eventModel,e.destroy({wait:!0,success:function(t){return function(){return c.show({message:tb_i18n.get("delete.success"),status:"success"}),t.remove(),f.APP.hidePanel()}}(this)}),this},e.prototype.showDeleteRecurrenceEventConfirm=function(){var t;return t=this.options.eventModel,this.parentView.requestSubView(m).open(s,{onConfirm:function(e){return t.deleteEvent(e).then(function(){return c.success(tb_i18n.get("delete.success"))})}}),this.remove(),this},e.prototype.switchVisible=function(t){var e;return e=$(t.currentTarget),this.options.eventModel.saveAttr("visible",e.data("type"),{success:function(t){return function(){return t.render()}}(this)}),this},e}(u)},function(t,e){t.exports=function(t){var e='<ul class="list event-menu-list"> ';return t.permissions.put&&(e+=' <li> <a class="edit-event-handler" data-gta="{action: \'edit event\', control: \'More Menu\'}"> <span class="icon icon-pencil"></span>'+tb_i18n.get("event.menu.edit")+" </a> </li> "),e+=' <li> <a class="copy-event-handler"> <span class="icon icon-copy"></span>'+tb_i18n.get("event.menu.copy")+" </a> </li> ",t.permissions.putMove&&(e+=' <li> <a class="move-event-handler"> <span class="icon icon-move-task"></span>'+tb_i18n.get("event.menu.move")+" </a> </li> "),e+=' <li> <a class="favorite-event-handler" data-gta="{action: \'favorite event\', type: event, control: \'More Menu\'}"> <span class="icon icon-favorite ',t.isFavorite&&(e+="favorited"),e+='"></span>',e+=t.isFavorite?""+tb_i18n.get("unfavorite"):""+tb_i18n.get("favorite")+tb_i18n.get("navigation.event"),e+=" </a> </li> ",t.permissions.putArchive&&(e+=" <li> ",e+=t.isArchived?' <a class="unarchive-event-handler" data-gta="{action: \'unarchive event\', type: event, control: \'More Menu\'}"> <span class="icon icon-archive"></span>'+tb_i18n.get("unarchive")+" </a> ":' <a class="archive-event-handler" data-gta="{action: \'archive event\', type: event, control: \'More Menu\'}"> <span class="icon icon-archive"></span>'+tb_i18n.get("archive.event")+" </a> ",e+=" </li> "),e+=" ",t.permissions.del&&(e+=' <li> <a class="delete-event-handler" data-gta="{action: \'delete event\', type: event, control: \'More Menu\'}"> <span class="icon icon-trash"></span>'+tb_i18n.get("event.menu.delete.title")+" </a> </li> "),e+=" ",t.permissions.putVisible&&(e+=' <li class="divider"></li> <li> ',"members"==t.visible||"all"==t.visible?e+=' <a class="switch-visible-handler" data-type="involves" data-gta="{action: \'toggle visible\', type: event, control: \'More Menu\'}"> <div class="main-mode"> <span class="icon icon-unlock"></span> <span class="mode">'+tb_i18n.get("visible.mode")+'</span> <span class="ifClose">'+tb_i18n.get("visible.close")+'</span> </div> <span class="mode-explanation">'+tb_i18n.get("visible.to.member")+"</span> </a> ":"involves"==t.visible&&(e+=' <a class="switch-visible-handler" data-type="members" data-gta="{action: \'toggle visible\', type: event, control: \'More Menu\'}"> <div class="main-mode"> <span class="icon icon-lock"></span> <span class="mode">'+tb_i18n.get("visible.mode")+'</span> <span class="ifClose">'+tb_i18n.get("visible.open")+'</span> </div> <span class="mode-explanation">'+tb_i18n.get("visible.to.involve")+"</span> </a> "),e+=" </li> "),e+="</ul>"}},function(t,e){t.exports=function(t){var e='<form class="delete-form"> <p>'+tb_i18n.get("event.menu.confirm.delete")+'</p> <button class="btn btn-danger" type="submit">'+tb_i18n.get("delete")+"</button></form>";return e}},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(1013),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.viewName="EventConfirmDeleteView",e.prototype.initialize=function(){var t,i,n,r;return e.__super__.initialize.apply(this,arguments),r=tb_i18n.get("event.confirm.delete.title"),n=tb_i18n.get("event.confirm.delete.description"),t=["current","next","all"],i="danger",this.render({title:r,description:n,btns:t,color:i})},e}(n)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(1013),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.viewName="EventConfirmArchiveView",e.prototype.initialize=function(){var t,i,n;return e.__super__.initialize.apply(this,arguments),n=tb_i18n.get("event.confirm.archive.title"),i=tb_i18n.get("event.confirm.archive.description"),t=["current","next","all"],this.render({title:n,description:i,btns:t})},e}(n)},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(358),a=i(788),s=i(797),n=i(1235),r=i(1236),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="ProjectsCopyMoveListView",e.prototype.className="projects-copy-move-list-view",e.prototype.events={"click .item:not(.disabled)":"toggleItem","keyup input":"filterData","click .confirm":"confirmSelect"},e.prototype.initialize=function(t){return this.dataList=this.sortDataByStatus(t.dataList),this.selectConfirm=t.selectConfirm,this.globalHint=t.globalHint,this.selectHint=t.selectHint,this.searchedDataList=null,this.selectedId=null,this.activeId=null,this.render()},e.prototype.render=function(){return this.$el.html(n({selectedId:this.selectedId,globalHint:this.globalHint,selectHint:this.selectHint})),this.$itemList=this.$(".item-list"),this.$confirmBtn=this.$(".btn.confirm"),this.setupScroll(this.$itemList),this.renderItems()},e.prototype.renderItems=function(){return this.$itemList.html(r({
items:this.searchedDataList||this.dataList,selectedId:this.selectedId,activeId:this.activeId}))},e.prototype.toggleItem=function(t){var e;return e=$(t.currentTarget),this.setSelectedId(e.data("id"))},e.prototype.setSelectedId=function(t){var e;return t===this.selectedId&&(t=null),this.selectedId=t,this.renderItems(),this.selectedId&&this.slideTo(this.$itemList.find(".selected")),e=null!=t?"removeClass":"addClass",this.$confirmBtn[e]("is-disabled")},e.prototype.setActiveId=function(t){if(this.activeId=t,this.renderItems(),this.activeId)return this.slideTo(this.$itemList.find(".active"))},e.prototype.filterData=function(t){var e,i;switch(13!==(i=t.keyCode)&&38!==i&&40!==i||t.preventDefault(),t.keyCode){case 13:return this.switchActive("enter");case 38:return this.switchActive("up");case 40:return this.switchActive("down");default:return e=$(t.currentTarget).val().trim(),e?(this.searchedDataList=this.searchDataByQueryStr(e),this.activeId=null):this.searchedDataList=null,this.renderItems()}},e.prototype.searchDataByQueryStr=function(t){var e;return e=c.chain(this.dataList).map(function(e){return function(i){return i.queryIndex=e.getQueryIndex(i,t),i}}(this)).filter(function(t){return~t.queryIndex}).sortBy("queryIndex").each(function(t){return delete t.queryIndex}).value(),this.sortDataByStatus(e)},e.prototype.getQueryIndex=function(t,e){var i,n,r,o;return e=e.toLowerCase(),n=[t.name.toLowerCase().indexOf(e),null!=(r=t.pinyin)?r.toLowerCase().indexOf(e):void 0,null!=(o=t.py)?o.toLowerCase().indexOf(e):void 0],i=c.chain(n).filter(function(t){return c.isNumber(t)&&t>-1}).sort().first().value(),null==i&&(i=-1),i},e.prototype.sortDataByStatus=function(t){var e,i;return i=[],e=[],c.each(t,function(t){return t.disabled?e.push(t):i.push(t)}),t=i.concat(e)},e.prototype.switchActive=function(t){var e,i,n,r,o;switch(i=this.searchedDataList||this.dataList,n=c.chain(i).filter(function(t){return!t.disabled}).pluck("id").value(),r=n.length,e=c.indexOf(n,this.activeId),t){case"enter":if(this.activeId)return this.setSelectedId(this.activeId);break;case"up":return o=e-1,o<0&&(o=r-1),this.setActiveId(n[o]);case"down":return o=e+1,o>=r&&(o=0),this.setActiveId(n[o])}},e.prototype.confirmSelect=function(){return this.selectedId?"function"==typeof this.selectConfirm?this.selectConfirm(this.selectedId):void 0:(this.$extraInfo||(this.$extraInfo=this.$(".extra-info")),this.$extraInfo.addClass("show-alert"),c.delay(function(t){return function(){return t.$extraInfo.removeClass("show-alert")}}(this),1500),void 0)},e.prototype.disableSubmit=function(){return this.$confirmBtn.addClass("disabled")},e.prototype.enableSubmit=function(){return this.$confirmBtn.removeClass("disabled")},e}(a),c.extend(o.prototype,s),t.exports=o},function(t,e){t.exports=function(t){var e='<div> <input class="form-control" type="text" autofocus="autofocus" placeholder="'+tb_i18n.get("project.search")+'"> <ul class="item-list list-unstyled thin-scroll"></ul> <div class="extra-info"> ';return t.globalHint&&(e+=" <p>"+t.globalHint+"</p> "),e+=" ",t.selectHint&&(e+=' <div class="no-select-hint text-center">'+t.selectHint+"</div> "),e+=' </div> <button type="button" class="btn btn-primary btn-block confirm ',t.selectedId||(e+=" is-disabled"),e+='"> '+tb_i18n.get("confirm")+"</button></div>"}},function(t,e){t.exports=function(t){var e="",i=t.items;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+='<li class="flex item ',n.disabled&&(e+=" disabled"),e+=" ",n.id===t.selectedId&&(e+=" selected"),e+=" ",n.id===t.activeId&&(e+=" active"),e+='" data-id="'+n.id+'"> <span class="item-title">'+n.name+"</span> ",n.disabled&&(e+=' <span class="icon icon-warning hinted hint-icon" data-title="'+n.disabledHint+'"></span> '),e+=' <span class="icon icon-tick selected-icon"></span></li>';return e}},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(788),n=i(350),o=i(1238),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="AppearInView",e.prototype.className="appearin-view modal-dialog",e.prototype.events={"click .close-handler":"closeTip"},e.prototype.initialize=function(t){var e;if(this._eventId=t._eventId||(null!=(e=t.eventModel)?e._id:void 0),this._eventId)return this.render(),this},e.prototype.render=function(){var t;return this.$el.html(o({isCN:"zh"===tb_i18n.getLanguage()})),t=new n,t.addRoomToIframe(this.$("iframe")[0],"teambition/"+this._eventId),this},e.prototype.closeTip=function(t){return this.$(".tips").remove(),this},e}(s)},function(t,e){t.exports=function(t){var e="";return t.isCN&&(e+='<div class="tips"> 如加载时间过久或遇到网络问题，请尝试使用代理，也可以向我们<a href="http://form.teambition.com/f/mFjnL5" target="_blank">反馈问题</a>。 <a class="close-handler">关闭提示</a></div>'),e+='<iframe width="100%" height="100%" frameBorder="none" id="appearin-iframe"></iframe>'}},function(t,e){t.exports=function(t){var e='<div class="event-detail-appearin"> <a class="icon icon-video hinted" data-title="'+tb_i18n.get("event.detail.appearin.tips")+'" data-gta="{action: \'video conference\'}"></a>';return e}},function(t,e){t.exports=function(t){var e='<section class="detail-content scrollable thin-scroll"> <div class="event-detail-header-wrap"></div> <div class="event-detail-infos-wrap"></div> <section class="detail-activities-wrap"></section></section><footer class="activity-creator-wrapper"></footer>';return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="archived-wrapper"></div><div class="event-detail-header clearfix"> <a class="menu-handler"> '+tb_i18n.get("more")+' <span class="icon icon-chevron-down"></span> </a> <div class="event-detail-title-wrap"> <div ';return t.permissions.put?(i+=' class="event-detail-title-input attr-input" data-attr="title" placeholder="'+tb_i18n.get("event.creator.title.placeholder")+'" ',t.isArchived||(i+=" contenteditable "),i+=" "):i+=' class="event-detail-title-input" ',i+=">"+e(t.title)+'</div> </div> <div class="event-detail-location-wrap"> <div ',t.permissions.put?(i+=' class="event-detail-location-input attr-input" data-attr="location" placeholder="'+tb_i18n.get("event.creator.location.placeholder")+'" ',t.isArchived||(i+=" contenteditable "),i+=" "):i+=' class="event-detail-location-input" ',i+=">"+e(t.location)+'</div> </div> <div class="event-detail-handler-set"> <div class="event-detail-startDate"> <h6 class="event-detail-handler-tips dirty">'+tb_i18n.get("event.detail.start.date.tips")+'</h6> <p class="event-detail-handler-content"> <span class="event-detail-datepicker ',t.permissions.put&&(i+="date-input"),i+='" data-attr="startDate">'+t.startDateString+'</span> <span class="event-detail-timepicker ',t.permissions.put&&(i+="time-input"),i+='" data-attr="startDate">'+t.startTimeString+'</span> </p> </div> <div class="event-detail-endDate"> <h6 class="event-detail-handler-tips dirty">'+tb_i18n.get("event.detail.end.date.tips")+'</h6> <p class="event-detail-handler-content"> <span class="event-detail-datepicker ',t.permissions.put&&(i+="date-input"),i+='" data-attr="endDate">'+t.endDateString+'</span> <span class="event-detail-timepicker ',t.permissions.put&&(i+="time-input"),i+='" data-attr="endDate">'+t.endTimeString+'</span> </p> </div> <div class="event-detail-isAllDay"> <h6 class="event-detail-handler-tips dirty">'+tb_i18n.get("event.creator.all.day")+'</h6> <p class="event-detail-handler-content"> <a class="check-box ',t.isAllDay&&(i+="active"),i+=" ",t.permissions.put&&(i+="all-day-switcher"),i+='"> <span class="icon icon-tick"></span> </a> </p> </div> </div></div>'}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li class="event ';if(t.showInvolved&&(i+="show-members"),i+='" data-id="'+t._id+'" data-date="'+t.date+'" data-type="event" data-gta="{action: \'open detail\', type: \'event\'}"> <div class="event-time"> <time>'+t.startDateString+"</time> ",t.endDateString&&(i+=" <time>"+t.endDateString+"</time> "),i+=' </div> <div class="event-content"> <span class="event-title">'+e(t.title)+"</span> ",t.project&&t.project.name&&t.project._id&&(i+=' <a class="event-tag" data-tag="project" data-id="'+t.project._id+'" data-gta="event" data-label="event|go to project"> '+e(t.project.name)+" </a> "),i+=" </div> ",t.showInvolved){i+=' <ul class="members-list clearfix"> ';var n=t.involved.slice(0,2);if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li> <div class="avatar img-circle img-24 hinted" style="background-image:url('+r.avatarUrl+');" data-title="'+r.name+'"></div> </li> ';i+=" ",3==t.involved.length?i+=' <li> <div class="avatar img-circle img-24 hinted" style="background-image:url('+t.involved[2].avatarUrl+');" data-title="'+t.involved[2].name+'"></div> </li> ':t.involved.length>3&&(i+=' <li> <div class="img-circle img-24 hinted" data-title="'+t.involvedString+'">'+t.involved.length+"</div> </li> "),i+=" </ul> "}return i+="</li>"}},function(t,e){t.exports=function(t){var e='<div class="event-placeholder placeholder muted"> <a class="icon icon-calendar"></a> <br /> '+tb_i18n.get("event.placeholder")+"</div>";return e}},function(t,e){t.exports=function(t){var e='<div class="actions-bar"> <div class="action week-selector-wrap"></div></div><div class="events-list-wrap"></div>';return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;p=i(678),l=i(679),n=i(1246),s=i(813),o=i(699),r=i(401),c=i(677),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="TeamMemberMenuView",e.prototype.className="team-member-menu-view",e.prototype.popoverTitle="",e.prototype.width=245,e.prototype.events={"click .remove-from-team":"removeFromTeam","click .remove-from-org":"removeFromOrg"},e.prototype.initialize=function(t){return null==t&&(t={}),this.popoverTitle=tb_i18n.get("team.member.menu"),this.options=t,e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){var t,e;return e=this.options.organizationModel,t=c.getMemberPermissions(e,this.options.memberModel).canDeleteMember,this.$el.html(n({_roleId:this.options.memberModel.getRoleScope(),permissions:e.hasPermissions("organization.del.member"),canDeleteMember:t}))},e.prototype.removeFromTeam=function(t){var e;return this.hide(),e=new o([],{boundToObjectType:"team",_boundToObjectId:this.options.teamId}),e.removeMember(this.options.memberModel.id,{wait:!0,success:function(t){return function(){return t.options.onRemove(),r.success(tb_i18n.get("remove.success"))}}(this)})},e.prototype.removeFromOrg=function(t){return this.hide(),this.options.membersCollection.removeMember(this.options.memberModel.id,{wait:!0,success:function(t){return function(){return t.options.onRemove(),r.success(tb_i18n.get("remove.success"))}}(this)})},e}(s)},function(t,e){t.exports=function(t){var e='<ul class="list"> ';return t.permissions.organizationDelMember&&(e+=" <li class=\"remove-wrapper\"> <a class=\"remove-from-team\" data-gta=\"{action: 'remove member', type: 'team member', control: 'Org Member List'}\"> "+tb_i18n.get("team.member.remove")+" </a> </li> "),e+=" ",t.canDeleteMember&&(e+=" <li class=\"remove-wrapper\"> <a class=\"remove-from-org\" data-gta=\"{action: 'remove member', type: 'org member', control: 'Org Member List'}\"> "+tb_i18n.get("organization.member.remove")+"</a> </li> "),e+="</ul>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h=function(t,e){function i(){this.constructor=t}for(var n in e)m.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},m={}.hasOwnProperty;u=i(358),d=i(678),c=i(788),p=i(786),o=i(1079),l=i(1224),s=i(1226),r=i(1071),n=i(1248),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.viewName="MemberEventsView",e.prototype.className="member-events-view fade",e.prototype.events={"click .event-create-handler":"openEventCreator"},e.prototype.initialize=function(t){return this.options=t,this.startDate=t.startDate,this.memberModel=t.cardModel,this.objectModel=t.objectModel,this.eventsCollection=o.get(this.memberModel.get("_memberId")),this.renderBasic().renderWeekPicker().loadEvents(),u.delay(function(t){return function(){return t.$el.addClass("in")}}(this)),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$weekSelectorWrap=this.$(".week-selector-wrap"),this.$eventsListWrap=this.$(".events-list-wrap"),this},e.prototype.renderWeekPicker=function(){return this.weekPicker=this.requestSubView(l,{createdDate:this.objectModel.get("created"),onChange:function(t){return function(){return d.gta.event({action:"filter event date"}),t.loadEvents()}}(this)}),this.$weekSelectorWrap.html(this.weekPicker.$el),this},e.prototype.loadEvents=function(){return this.showLoadingIndicator(this.$el),this.memberModel.fetchMemberEvents({data:{startDate:this.weekPicker.startOfWeek.toISOString(),endDate:this.weekPicker.endOfWeek.toISOString()},success:function(t){return function(e){var i;if(t.$el)return t.eventsCollection.reset(e),t.hideLoadingIndicator(),i=t.requestSubView(s,{modalDetail:t.options.modalDetail,groupBy:!0,rightOffset:0,weekly:t.weekPicker.startOfWeek,eventsCollection:t.eventsCollection}),t.$eventsListWrap.html(i.$el)}}(this)}),this},e.prototype.openEventCreator=function(){return this.requestSubView(p).open(r)},e}(c)},function(t,e){t.exports=function(t){var e='<h3 class="clearfix header-handler"> <a class="flex-static event-create-handler link-add-handler" data-gta="{action: \'add content\', type: \'event\'}"> <span class="icon icon-circle-cross"></span> <span>'+tb_i18n.get("events.add")+'</span> </a> <div class="week-selector-wrap pull-right" data-gta="{action: \'filter event date\'}"></div></h3><div class="events-list-wrap"></div>';return e}},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;c=i(358),l=i(678),a=i(996),s=i(1204),o=i(1205),n=i(1206),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="MemberTasksView",e.prototype.tagName="section",e.prototype.className="member-tasks-view all-tasks-list",e.prototype.events={"click .tasks-board-date-menu":"toggleDateSelector","click .task-create-handler":"openTaskCreator","click .task:not(.subtask) .task-content-set":"gtaTaskClick","click .subtask .task-content-set":"gtaSubaskClick","click .task .check-box":"gtaToggleCompleteTask"},e.prototype.initialize=function(t){return this.options=t,this.memberModel=this.options.cardModel,this.load({success:function(t){return function(){return t.renderBasic(),t.refreshTasks(),t.listen()}}(this)}),e.__super__.initialize.apply(this,arguments)},e.prototype.load=function(t){return this.showLoadingIndicator(this.$el),Promise.all([new Promise(function(t){return function(e,i){return t.memberModel.fetchMemberTasks({expireCache:{namespace:"member_tasks",expire:120},success:e,error:function(t,e){return i(e)}})}}(this)),new Promise(function(t){return function(e,i){return t.memberModel.fetchMemberSubtasks({expireCache:{namespace:"member_subtasks",expire:120},success:e,error:function(t,e){return i(e)}})}}(this))]).then(function(e){return function(i){var n,r;if(e.$el)return r=i[0],n=[],c.each(i[1],function(t,e){var r;return r=new o(t),i[1][e]=r.attributes,n.push(r)}),e.tasksCollection=new a(r),e.subtasksCollection=new s(n),e.hideLoadingIndicator(),t.success()}}(this))["catch"](function(t){return console.error(t)}),this},e.prototype.loadDoneTasks=function(t){return t.attrs||(t.attrs={}),this.hideLoadingIndicator(),this.showLoadingIndicator(),Promise.all([new Promise(function(e){return function(i,n){return e.memberModel.fetchMemberDoneTasks({attrs:t.attrs,success:i,error:function(t,e){return n(e)}})}}(this)),new Promise(function(e){return function(i,n){return e.memberModel.fetchMemberDoneSubtasks({attrs:t.attrs,success:i,error:function(t,e){return n(e)}})}}(this))]).then(function(e){return function(i){var n,r;if(e.$el)return r=i[0],n=[],c.each(i[1],function(t,e){var r;return r=new o(t),i[1][e]=r.attributes,n.push(r)}),e.doneTasksCollection=new a(r),e.doneTasksCollection.hasMore=e.doneTasksCollection.checkHasMore(r),e.doneSubtasksCollection=new s(n),e.doneSubtasksCollection.hasMore=e.doneSubtasksCollection.checkHasMore(n),e.hideLoadingIndicator(),t.success()}}(this))["catch"](function(t){return console.error(t)}),this},e.prototype.gtaTaskClick=function(){return l.gta.event({action:"open detail",type:"task",control:"Org Member Task List"})},e.prototype.gtaSubaskClick=function(){return l.gta.event({action:"open detail",type:"subtask",control:"Org Member Task List"})},e.prototype.gtaToggleCompleteTask=function(){return l.gta.event({action:"toggle complete subtask",control:"Org Member Task List"})},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f=function(t,e){function i(){this.constructor=t}for(var n in e)g.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},g={}.hasOwnProperty;m=i(678),s=i(401),p=i(429),d=i(788),h=i(786),u=i(1008),o=i(805),l=i(699),c=i(700),n=i(1251),r=i(1256),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.viewName="MemberInfoView",e.prototype.tagName="section",e.prototype.className="member-info-view thin-scroll",e.prototype.events={"click .remove-from-team":"removeOtherTeamMember","click .quit-from-team":"removeSelfTeamMember","click .add-team-menu-handler":"showAssignTeam"},e.prototype.initialize=function(t){return this.options=t,this.memberModel=this.options.cardModel,this.objectModel=this.options.objectModel,this.teamsCollection=this.options.teamsCollection,this.renderBasic(),this.listen(),e.__super__.initialize.apply(this,arguments)},e.prototype.listen=function(){return this.listenTo(this.memberModel,"change",this.renderBasic),this},e.prototype.renderBasic=function(){var t,e,i,n;return i=this.memberModel.toJSON(),i.role=this.memberModel.getRole(),t=p(i.birthday),i.birthday=t.isValid()?t.format("LL"):"",i.fromPanel=this.options.fromPanel,e=m.user,i.isNotMe=i._id!==e.id,i.permissions=this.objectModel.hasPermissions("team.post","team.del","put.member"),this.teamsCollection&&(n=u.parseTree(this.teamsCollection.toJSON()),i.inTeams=u.getMemberTeams(i,n)),i.language=tb_i18n.getLanguage(),this.$el.html(r(i)),this.$memberRole=this.$(".member-role")},e.prototype.removeOtherTeamMember=function(t){var e;return e=$(t.currentTarget),this.teamMembersCollection=new l([],{boundToObjectType:"team",_boundToObjectId:e.data("id")}),this.requestSubView(h).open(o,{title:tb_i18n.get("member.remove.from.team"),content:tb_i18n.get("team.member.remove.content"),confirmText:tb_i18n.get("project.settings.remove.member"),confirmStyle:"danger",onConfirm:function(t){return function(){return t.teamMembersCollection.removeMember(t.options.cardModel.get("_id"),{wait:!0,success:function(){return s.success(tb_i18n.get("remove.success")),m.gta.event({action:"remove member",type:"team member",control:"Org Member Info"})}})}}(this)})},e.prototype.removeSelfTeamMember=function(t){var e,i,n;return e=$(t.currentTarget),i=e.data("id"),n=this.teamsCollection.get(i),this.requestSubView(h).open(o,{title:tb_i18n.get("team.member.remove"),content:tb_i18n.get("team.member.remove.content"),confirmText:tb_i18n.get("project.settings.remove.member"),confirmStyle:"danger",onConfirm:function(){return n.quit({wait:!0,success:function(t){return function(){return t.renderBasic(),s.success(tb_i18n.get("quit.success")),m.gta.event({action:"quit team",type:"team member",control:"Org Member Info"})}}(this)})}})},e.prototype.showAssignTeam=function(t){var e,i;if(t.assignTeamClick=!0,e=$(t.currentTarget),!e.data("bs.popover"))return null!=(i=this.assignTeamView)&&i.remove(),this.assignTeamView=this.requestSubView(h).open(n,{memberModel:this.memberModel,teamTree:u.parseTree(this.teamsCollection.toJSON()),teamTreeState:{},gta:{type:"org member",control:"Org Member Info"}})},e.prototype.renderRoleheader=function(t){return this.$memberRole.html(t)},e}(d)},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;p=i(678),o=i(401),s=i(699),c=i(788),l=i(786),a=i(1252),r=i(1255),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="AssignTeamView",e.prototype.className="assign-team-view modal-dialog flex-vert",e.prototype.events={"click .submit":"submit"},e.prototype.initialize=function(t){return null==t&&(t={}),this.options=t,this.renderBasic()},e.prototype.renderBasic=function(){var t;return t=this.requestSubView(a,{teamTree:this.options.teamTree,teamTreeState:this.options.teamTreeState,onSelect:function(t){return function(e){return t.currentTeamId=e[0],t.$(".submit").removeClass("disabled")}}(this)}),this.$el.html(r()),this.$(".modal-body").html(t.$el)},e.prototype.submit=function(){var t;return this.close(),t=new s([],{boundToObjectType:"team",_boundToObjectId:this.currentTeamId}),t.addMember(this.options.memberModel.toJSON(),{success:function(t){return function(){return o.success(tb_i18n.get("add.success")),p.gta.event({action:"added member",type:t.options.gta.type,control:t.options.gta.control,category:"team"})}}(this)})},e.prototype.close=function(){var t,e,i;return(null!=(e=this.parentView)?e.close:void 0)?"function"==typeof(t=this.parentView).close?t.close():void 0:null!=(i=this.parentView)?i.remove():void 0},e}(c)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=i(788),r=i(1253),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.viewName="TeamTree",e.prototype.className="team-tree-view",e.prototype.events={"click .team-node":"selectTeam","click .toggle-subtree":"toggleSubtree"},e.prototype.initialize=function(t){return this.options=t,this.render()},e.prototype.render=function(){var t;return t=this.requestSubView(r,{teamTree:this.options.teamTree,teamTreeState:this.options.teamTreeState}),this.$el.html(t.$(".teams-level-1"))},e.prototype.selectTeam=function(t){var e,i;return t.toggleSubtree?this:(e=$(t.currentTarget),i=e.data("id"),this.changeActive(i),this.options.onSelect([i]))},e.prototype.toggleSubtree=function(t){var e,i;return t.toggleSubtree=!0,e=$(t.currentTarget),i=e.data("id"),this.toggleState(i),this.toggleClass(this.$(".team-"+i),"open"),this.toggleClass(this.$(".team-"+i+"-children"),"open")},e.prototype.toggleState=function(t){return this.options.teamTreeState[t]=!this.options.teamTreeState[t]},e.prototype.toggleClass=function(t,e){return t.hasClass(e)?t.removeClass(e):t.addClass(e)},e.prototype.changeActive=function(t){return this.$(".team-node").removeClass("active"),this.$(".team-"+t).addClass("active")},e}(o)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(358),o=i(788),n=i(1254),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="TeamTreeNode",e.prototype.className="team-tree-node-view",e.prototype.initialize=function(t){return this.options=t,this.render()},e.prototype.render=function(){var t,i,r;return t=this.options.teamTree._id,r=this.options.teamTree.style,i=s.extend({styleName:r.split(",")[0],styleColor:r.split(",")[1],isOpen:this.options.teamTreeState[t]},this.options.teamTree),this.$el.html(n(i)),this.options.teamTree.children.forEach(function(t){return function(i){var n;return n=t.requestSubView(e,{teamTree:i,teamTreeState:t.options.teamTreeState}),t.$("ul.team-"+t.options.teamTree._id+"-children").append(n.$el)}}(this))},e}(o)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li> <div class="team-node team-'+t._id+" ";return t.isOpen&&(i+="open"),i+=' flex flex-between" data-id="'+t._id+'" data-gta="{action: \'open team detail\'}"> <div class="team-name hinted" data-title="'+e(t.name)+'"> ',i+=t.level>1?' <span class="team-child-icon" style="background-color:'+(t.styleColor||"#8193BA")+'"></span> ':' <span class="icon '+(t.styleName||"icon-team-tie")+'" style="color:'+(t.styleColor||"#8193BA")+'"></span> ',i+=" "+e(t.name)+" </div> ",t.children&&t.children.length>0&&(i+=' <span class="icon icon-circle-down pull-right toggle-subtree" data-id="'+t._id+'"></span> '),i+=" </div> ",t.children&&t.children.length>0&&(i+=' <ul class="team-'+t._id+"-children ",t.isOpen&&(i+="open"),i+=" teams-level-"+(t.level+1)+'"></ul> '),i+="</li>"}},function(t,e){t.exports=function(t){var e='<div class="modal-header text-center flex-static"> <div class="modal-title text-center">'+tb_i18n.get("organization.member.assign.team")+'</div> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a></div><div class="modal-body thin-scroll flex-fill"></div><div class="modal-footer"> <button type="button" class="btn btn-primary submit disabled"> '+tb_i18n.get("save")+" </button></div>";return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="member-content-wrap row '+e(t.language)+'"> <div class="col-xs-12"> ';if(t.email&&(i+=' <div class="member-info-item"> <div class="member-info-label">'+tb_i18n.get("email")+'</div> <div class="member-info-content"> <a href="mailto:'+t.email+'">'+e(t.email)+"</a> </div> </div> "),i+=' <div class="member-info-item"> <div class="member-info-label">'+tb_i18n.get("position")+'</div> <div class="member-info-content"> <a>'+e(t.title||tb_i18n.get("none"))+"</a> </div> </div> ",t.phone&&(i+=' <div class="member-info-item"> <div class="member-info-label">'+tb_i18n.get("mobile")+'</div> <div class="member-info-content"> <a href="tel:'+e(t.phone)+'">'+e(t.phone)+"</a> </div> </div> "),i+=" ",t.birthday&&(i+=' <div class="member-info-item"> <div class="member-info-label">'+tb_i18n.get("birthday")+'</div> <div class="member-info-content">'+e(t.birthday)+"</div> </div> "),i+=" ",t.location&&(i+=' <div class="member-info-item"> <div class="member-info-label">'+tb_i18n.get("location")+'</div> <div class="member-info-content">'+e(t.location)+"</div> </div> "),i+=" ",t.website&&(i+=' <div class="member-info-item"> <div class="member-info-label">'+tb_i18n.get("website")+'</div> <div class="member-info-content"> <a href="'+t.website+'" target="_blank">'+e(t.website)+"</a> </div> </div> "),i+=" ",!t.fromPanel){i+=' <div class="member-info-item"> <div class="member-info-label">'+tb_i18n.get("team")+'</div> <div class="member-info-content"> <ul class="team-list"> ';var n=t.inTeams;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li class="team" data-id="'+r._id+'" data-title="'+r.name+'"> <span class="img-26 pull-left icon ',i+="default"!=r.type&&r.styleName?""+r.styleName:"icon-team-tie",i+='" ',"default"!=r.type&&r.styleColor&&(i+='style="color: '+r.styleColor+'"'),i+=' ></span> <div class="team-info flex-vert flex-center"> <div class="team-name"> '+r.name+"・"+r.hasMembers.length+" ",(t.permissions.teamPost||t.permissions.teamDel)&&(i+=" ",i+=t.isNotMe?' <button class="remove-from-team btn btn-hover-danger" type ="button" data-id="'+r._id+'"> '+tb_i18n.get("team.mananger.remove")+" </button> ":' <button class="quit-from-team btn btn-hover-danger" type ="button" data-id="'+r._id+'"> '+tb_i18n.get("team.mananger.quit")+" </button> ",i+=" "),i+=" </div> ",r.belongsTo&&(i+=' <p class="team-child muted"> '+(tb_i18n.get("team.belongsTo"),r.belongsTo)+" </p> "),i+=" </div> </li> ";i+=" ",t.permissions.teamPost&&(i+=" <li class=\"add-team\"> <a class=\"add-team-menu-handler\" data-gta=\"{action: 'add member', type: 'org member', control: 'Org Member Info', category: 'team'}\"> <span class=\"icon icon-circle-cross\"></span> "+tb_i18n.get("team.mananger.add")+" </a> </li> "),i+=" </ul> </div> </div> "}return i+=" </div></div>"}},function(t,e){t.exports=function(t){var e='<div class="detail-picker-menu flex-static"> <div class="content-header"> ';"team"==t.objType?(e+=' <div class="detail-picker-img team-icon icon ',e+=t.card.style.name?""+t.card.style.name:"icon-team-tie",e+='" ',e+=t.card.style.color?'style="color:'+t.card.style.color+'"':'style="color:#8193BA"',e+='> </div> <div class="card-detail"> <span class="card-name">'+t.card.name+'</span> <span class="card-description">'+tb_i18n.get("team.members.count",t.membersCount)+"</span> </div> "):(e+=' <div class="detail-picker-img avatar img-36 img-circle ',t.card.avatarUrl||(e+="no-avatar"),e+='" ',t.card.avatarUrl&&(e+='style="background-image: url('+t.card.avatarUrl+');"'),e+='> </div> <div class="card-detail"> <span class="card-name">'+t.card.name+'</span> <span class="card-description">'+(t.card.title||t.card.email)+"</span> </div> "),e+=' </div> <ul class="sub-menu-picker"> ';var i=t.subItems;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <li class="sub-menu-item" data-type="'+n.type+'"> <a class="sub-menu-handler" data-gta="{action: \'switch '+t.objType+" tab', type: '"+n.type+'\'}"> <span class="icon '+n.icon+'"></span> <span>'+n.title+"</span> </a> </li> ";return e+=' </ul></div><div class="detail-picker-content flex-fill thin-scroll"></div>'}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<header class="member-card-header"> <div class="avatar img-circle pull-left" style="background-image: url('+t.avatarUrl+');"> ';return"paid"!==t.plan.status||t.isExpiring||(i+=' <span class="img-circle pro-spot pro-spot-star"></span> '),i+=' </div> <div class="member-name"> <h4 class="chinese-name">'+e(t.name)+"</h4> ",i+=t.title?' <p class="member-title">'+e(t.title)+"</p> ":' <p class="member-title">'+e(t.email)+"</p> ",i+=" ",t.latestActivedString&&(i+=' <p class="member-last-active">'+e(t.latestActivedString)+"</p> "),i+=" </div></header>",t.roleScope>=0&&(i+='<section class="member-card-content"> <ul class="member-card-handler-list"> <li> <a class="member-card-handler open-member-detail" data-toggle="member-info"> <span class="icon icon-user"></span> <span>'+tb_i18n.get("member.card.detail")+"</span> </a> </li> ",t.isShowOrgTask&&(i+=' <li> <a class="member-card-handler open-member-detail" data-toggle="organization-tasks" data-gta="{action: \'open detail\', type: \'org task\', control: \'Member Card\'}"> <span class="icon icon-building"></span> <span>'+tb_i18n.get("member.card.task.organization")+"</span> ",
t.tasksCount&&t.tasksCount.organization&&(i+=' <div class="member-task-badge"> ',t.tasksCount.organization[0].expired&&(i+=' <span class="task-badge-duedate"> ',i+=t.tasksCount.organization[0].expired>99?"99+":""+t.tasksCount.organization[0].expired,i+=" </span> "),i+=" ",t.tasksCount.organization[0].undone&&(i+=' <span class="task-badge-undone"> ',i+=t.tasksCount.organization[0].undone>99?"99+":""+t.tasksCount.organization[0].undone,i+=" </span> "),i+=" </div> "),i+=" </a> </li> "),i+=' <li> <a class="member-card-handler open-member-detail" data-toggle="project-tasks" data-gta="{action: \'open detail\', type: \'project task\', control: \'Member Card\'}"> <span class="icon icon-project"></span> <span>'+tb_i18n.get("member.card.task.project")+"</span> ",t.tasksCount&&t.tasksCount.project&&(i+=' <div class="member-task-badge"> ',t.tasksCount.project[0].expired&&(i+=' <span class="task-badge-duedate"> ',i+=t.tasksCount.project[0].expired>99?"99+":""+t.tasksCount.project[0].expired,i+=" </span> "),i+=" ",t.tasksCount.project[0].undone&&(i+=' <span class="task-badge-undone"> ',i+=t.tasksCount.project[0].undone>99?"99+":""+t.tasksCount.project[0].undone,i+=" </span> "),i+=" </div> "),i+=' </a> </li> <li> <a class="member-card-handler ',i+=t._userMeId!=t._id&&(t.canManageMemberRole||t.canDeleteMember)?"member-role-setting":"cannot-setting-role",i+='"> <span class="icon icon-medal"></span> <span>'+tb_i18n.get("member.card.role.setting")+'</span> <span class="member-role-name role-id-'+t.roleId+" "+t.lang+'">'+e(t.roleName)+"</span> </a> </li> </ul> ",t._userMeId!=t._id&&(i+=' <div class="member-send-chat"> <div class="member-send-chat-wrapper"> <textarea type="text" name="" placeholder="'+tb_i18n.get("chat.room.placeholder")+'" class="form-control comment-input member-send-chat-text"></textarea> <a class="btn btn-primary reply-handler pull-right member-send-chat-btn" data-id="'+t._id+"\" data-gta=\"{action: 'added content', type: 'chat', control: 'Side Member Menu'}\">"+tb_i18n.get("chat.room.send")+"</a> </div> </div> "),i+="</section>",0==t.isActive&&t.password&&(i+='<footer class="member-card-footer"> <p>'+tb_i18n.get("member.card.inactive.init.password")+e(t.password)+"</p></footer>")),i}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(798);if(n+='<div class="member-card-submenu member-card-setting-role"> <ul class="list"> ',(0!=t.isActive||!t.password)&&t.canManageMemberRole){n+=" ","organization"===t.payType&&2===t.myRoleId&&(n+=' <li class="',2==t._roleId&&(n+="selected"),n+='"> <a class="role-handler" data-role="2"> '+tb_i18n.get("owner")+" </a> </li> "),n+=" ","organization"!==t.payType&&"professional"!==t.payType||(n+=' <li class="',1==t._roleId&&(n+="selected"),n+='"> <a class="role-handler" data-role="1"> '+tb_i18n.get("manager")+" </a> </li> "),n+=' <li class="',0==t._roleId&&(n+="selected"),n+='"> <a class="role-handler" data-role="0"> '+tb_i18n.get("member")+" </a> </li> ";var o=t.roles;if(o)for(var s,a=-1,c=o.length-1;a<c;)s=o[a+=1],n+=' <li class="',t._roleId==s._id&&(n+="selected"),n+=" ",0==a&&(n+="underscore"),n+='"> <a class="role-handler" data-role="'+s._id+'"> '+e(s.name)+" </a> </li> ";n+=" <hr/> "}return n+=" ","organization"===t.payType?n+=' <div class="set-role-wrapper"> <a class="set-role-handler" href="/applications/permissions/'+t._organizationId+'" target="_blank"> '+tb_i18n.get("project.settings.member.menu.set.role")+" </a> </div> ":(n+=' <div class="upgrade-wrapper"> <a class="upgrade-handler" href="'+r.pay.plans+"\" target=\"_blank\" data-gta=\"{action: 'view plan option', control: 'permission', type: '",n+=t._organizationId?"business":"plus",n+="'}\"> "+tb_i18n.get("project.settings.member.menu.upgrade.button")+' </a> <p class="description"> '+tb_i18n.get("project.settings.member.menu.upgrade.description")+" </p> </div> "),n+=" ",t.canDeleteMember&&2!==t._roleId&&(n+=' <hr/> <div class="remove-wrapper"> ',n+=t.teamRelated?' <p class="description"> '+tb_i18n.get("project.settings.cannot.remove")+" </p> ":' <a class="delete-member delete-handler"> '+tb_i18n.get("project.settings.remove.member")+" </a> ",n+=" </div> "),n+=" </ul></div>"}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(968),o=t.content;if(~t.action.indexOf("activity.comment")){if(n+=' <div class="avatar img-36 img-circle pull-left ',t.creator.avatarUrl||(n+="no-avatar"),n+='" data-id="'+t.creator._id+"\" data-gta=\"{action: 'view member info', control: 'Comment Portrait'}\" ",t.creator.avatarUrl&&(n+=' style="background-image: url('+t.creator.avatarUrl+');"'),n+='> </div> <div class="activity-body"> <div class="activity-header-all"> <div class="activity-header clearfix"> <span class="activity-creator-name">'+e(t.creator.name)+'</span> </div> <div class="activity-handler-set-button"> ',t.attachments.length>0&&(t.isOwn||t.canDownload)&&(n+=' <a class="btn btn-link btn-mini download-attachments-handler">'+tb_i18n.get("activity.download.all.attachments")+"</a> "),n+=" ",t.isOwn&&!t.voice&&(n+=' <a class="btn btn-link btn-mini edit-activity-handler">'+tb_i18n.get("edit")+"</a> "),n+=" ",t.isLogedInUser||(n+=' <a class="btn btn-link btn-mini reply-activity-handler">'+tb_i18n.get("reply")+"</a> "),n+=" ",t.isOwn&&(n+=' <a class="btn btn-link btn-mini delete-activity-handler">'+tb_i18n.get("delete")+"</a> "),n+=' </div> <time class="time-stamp muted hinted" datetime="'+t.created+'" data-title="'+t.createdTime+'"></time> </div> ',t.mdStatus)n+=' <div class="activity-content readable"> '+e(t.commentMD,"MD")+" </div> ";else{n+=' <!-- pre tag fn, no break line --> <div class="activity-content readable pre">';var s=t.commentList;if(s)for(var a,c=-1,l=s.length-1;c<l;)a=s[c+=1],n+=a.isEmoji?""+a.value:""+e(a.value);n+="</div> "}if(n+=" ",t.content.voice&&(n+=' <div class="activity-voice-wrapper clearfix" style="width:'+t.content.voice.barWidth+'"> <div class="voice-progress transition-ctrl"></div> <span class="icon icon-play play-ctrl pull-left"></span> <span class="icon icon-pause pause-ctrl pull-left" style="display:none;"></span> <span class="play-time pull-right">'+t.content.voice.durationFormat+"</span> </div> "),n+=" ",t.attachments.length>0){n+=' <ul class="activity-attachments"> ';var p=t.attachments;if(p)for(var u,d=-1,h=p.length-1;d<h;)u=p[d+=1],n+=' <li class="work previewer-handler" data-id="'+u._id+'"> '+r(u,"fileSizeFix")+" </li> ";n+=" </ul> "}n+=" </div>"}else{if(n+=' <span class="icon '+t.iconName+' activity-type-icon pull-left muted"></span> <time class="time-stamp muted pull-right hinted" datetime="'+t.created+'" data-title="'+t.createdTime+'"></time> <div class="activity-body-coyness readable muted"> <span> ',t.titleToStress?(n+=" "+e(t.titleToStressLeft)+" <a class='linked-handler' ",t.url&&(n+='href="'+t.url+'"'),n+="> "+e(t.titleToStress)+" </a> "+e(t.titleToStressRight)+" "):t.content.linkedCollection?(n+=" "+t.titleLeft+" <a class='linked-collection-handler'>"+e(t.titleSubFirst)+"</a> "+t.titleMiddle+" ",n+=/remove/.test(t.action)||/archive.collection/.test(t.action)?" "+e(t.titleSubSecond)+" ":" <a class='linked-file-handler'>"+e(t.titleSubSecond)+"</a> ",n+=" "+t.titleRight+" "):n+=" "+e(t.title||"")+" ",n+=" </span> ",(t.description||o.content)&&(n+=" ","activity.post.update.content"===t.action?n+=' <div class="activity-content overflow"> <blockquote class="activity-description">'+e(t.description)+'</blockquote> <blockquote class="activity-content-detail">'+e(o.content)+"</blockquote> </div> ":~t.action.indexOf("update.content")?n+=' <div class="activity-content overflow"> <blockquote class="activity-description">'+e(t.description)+'</blockquote> <blockquote class="activity-content-detail">'+e(o.content)+"</blockquote> </div> ":~t.action.indexOf("update.note")&&(n+=' <div class="activity-content overflow"> <blockquote class="activity-description">'+e(t.description)+'</blockquote> <blockquote class="activity-content-detail"> ',n+=t.mdStatus?" "+e(o.note,"MD")+" ":" "+e(o.note)+" ",n+=" </blockquote> </div> "),n+=" "),n+=" ",o.subtasks){n+=' <ul class="subtask-list"> ';var m=o.subtasks;if(m)for(var f,g=-1,v=m.length-1;g<v;)f=m[g+=1],n+=" <li>"+e(f)+"</li> ";n+=" </ul> "}n+=" </div>"}return n}},function(t,e){t.exports=function(t){var e='<div class="activities-timeline-involve-set"></div><div class="activities-timeline-like"> <div class="';return t.user.isGhost||(e+="like-toggler-handler hinted"),e+=' like-toggler-wrap" data-gta="{action: \'like\', control: \'Detail Page Like Button\'}" data-title=""> <span class="icon icon-dig"></span> <span class="icon icon-dig"></span> </div></div><div class="activities-list-wrap"> <div class="activity-early-wrap"> <a class="activity-early-handler link-add-handler"> <span class="activity-early-hidden">'+tb_i18n.get("activity.early.hidden")+'</span> <span class="activity-early-shown">'+tb_i18n.get("activity.early.shown")+'</span> <span class="activity-early-loading">'+tb_i18n.get("activity.early.loading")+'</span> </a> </div> <ul class="activities-list"></ul> <div class="member-tip-wrap"></div> <div class="involve-tip-wrap"></div> <div class="activities-place-bottom"></div></div>'}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="";if(t.likesCount){i+='<div class="like-group-wrap clearfix"> <span class="like-group"> ';var n=t.newItems;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <span class="name on-new">'+e(r.name)+'</span> <span class="on-'+t.language+'">'+tb_i18n.get("comma")+"</span> ";i+=" ";var a=t.oldItems;if(a)for(var r,c=-1,l=a.length-1;c<l;)r=a[c+=1],i+=' <span class="name">'+e(r.name)+'</span> <span class="on-'+t.language+'">'+tb_i18n.get("comma")+"</span> ";i+=' </span> <span class="like-group-count"> '+tb_i18n.get("activity.timeline.like.tips.long",t.likesCount)+" </span></div>"}else i+=' <span class="like-toggler-tips">'+tb_i18n.get("activity.timeline.like.tips.short")+"</span>";return i}},function(t,e){t.exports=function(t){var e='<li class="activity-line" data-time="'+t+'"></li>';return e}},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty,p=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};o=i(358),a=i(678),r=i(688),s=function(){return{category:{attr:"category",title:tb_i18n.get("bookkeeping.home.fields.category"),isDefault:!0,isSort:!0},content:{attr:"content",title:tb_i18n.get("bookkeeping.home.fields.content"),isDefault:!0,isSort:!0},creator:{attr:"creator",title:tb_i18n.get("bookkeeping.home.fields.creator"),isDefault:!0,isSort:!0},amount:{attr:"amount",title:tb_i18n.get("bookkeeping.home.fields.amount"),isDefault:!0,isSort:!0},date:{attr:"date",title:tb_i18n.get("bookkeeping.home.fields.date"),isDefault:!0,isSort:!0}}},n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.name="bookkeeping",e.prototype.urlRoot="bookkeepings",e.prototype.parse=function(t){var e,i;return e=o.extend(this.toJSON(),t),e._approverIds&&(e.approveRight=(i=a.user.id,p.call(e._approverIds,i)>=0)),e},e.prototype.getDisplayFields=function(t){var e,i,n,r,o,a,c,l,u;for(c=s(),a=this.get("displayFields")||[],l=[],i=0,o=a.length;i<o;i++)e=a[i],r=c[e],r&&l.push(r);for(n in c)r=c[n],r.isDefault&&(u=r.attr,p.call(a,u)<0)&&l.push(r);return l},e.prototype.getHiddenFields=function(t){var e,i,n,r,o,a;r=s(),n=this.get("displayFields")||[],o=[];for(e in r)i=r[e],i.isDefault||(a=i.attr,p.call(n,a)>=0)||o.push(i);return o},e.prototype.getFields=function(t){var e,i,n,r,o,a;for(o=s(),a=[],i=0,r=t.length;i<r;i++)e=t[i],n=o[e],n&&a.push(n);return a},e}(r),t.exports=n},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;o=i(358),s=i(678),r=i(688),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.name="entry",e.prototype.urlRoot="entries",e.prototype.defaults={objectType:"entry"},e.prototype.listen=function(){if(!this.listenedLock&&this.id)return this.listenedLock=!0,this.on("change:visible",function(t){var e;if(!t.checkIsVisible())return null!=(e=t.collection)?e.remove(t):void 0}),e.__super__.listen.apply(this,arguments)},e.prototype.parse=function(t){var e;return e=o.extend({cost:"",receiver:"",profit:"",content:""},this.toJSON(),t)},e.prototype.approve=function(t){var e;return t||(t={}),e=t.success,t.success=function(t){return function(){return t.set("status","approved"),"function"==typeof e?e():void 0}}(this),t.url=this.url()+"/approval",t.attrs={},this.sync("create",this,t),this},e.prototype.revoke=function(t){var e;return t||(t={}),e=t.success,t.success=function(t){return function(){return t.set("status","confirmed"),"function"==typeof e?e():void 0}}(this),t.url=this.url()+"/approval",t.attrs={},this.sync("delete",this,t),this},e}(r)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;r=i(685),o=i(1264),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.name="bookkeepings",e.prototype.boundToObjectType="project",e.prototype.model=o,e}(r)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty,m=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};p=i(358),u=i(678),n=i(685),o=i(1268),a=i(688),s=i(1265),c=i(429),l=i(1053),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.name="entries",e.prototype.boundToObjectType="project",e.prototype.model=s,e.prototype.pageNum=20,e.prototype.getPlaceholders=function(){var t,e,i;for(i=[],e=0;e++<3;)t={creator:u.user.toJSON(),type:Math.random()>.5?1:-1,content:"placeholder内容"+e,note:"",date:new Date,amount:Math.floor(1e4*Math.random()),status:"applying",category:{icon:"icon",title:"测试"+e}},i.push(new a(t));return i},e.prototype.getCount=function(t,e){var i;return i={},this.each(function(n){var r,o;return o=n.get(t),e?p.each(o,function(t){return i[t]||(i[t]=0),i[t]++}):(r=o,i[r]||(i[r]=0),i[r]++)}),i},e.prototype.getCreators=function(){var t,e;return t=[],e=[],this.each(function(i){var n,r;if(n=i.get("creator"),r=n._id,m.call(t,r)<0)return e.push(n),t.push(n._id)}),e},e.prototype.getCreatorIdsCount=function(){return this.getCount("_creatorId")},e.prototype.getEntryCategoryIdsCount=function(){return this.getCount("_entryCategoryId")},e.prototype.getTagIdsCount=function(){return this.getCount("tagIds",!0)},e}(n)},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(358),n=i(685),o=i(1269),s=i(429),a=i(686),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.name="entryCategories",e.prototype.boundToObjectType="project",e.prototype.model=o,e.prototype.pageNum=20,e.prototype.getCategory=function(t){var e,i;return i=this.get(t),i||(e={_id:"entryCategoryNull",icon:"",title:tb_i18n.get("entry.category.title.null"),type:0},i=new o(e)),i},e.prototype.getCategories=function(t,e){var i;return i=this.toJSON(),c.filter(i,function(i){return(!t||t===i.type)&&(!c.isBoolean(e)||e===i.isDefault)})},e.prototype.getDefaultId=function(t){var e,i,n,r;for(r=this.models,e=0,i=r.length;e<i;e++)if(n=r[e],n.get("type")===t&&n.get("isDefault"))return n.id},e}(n)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=i(358),r=i(688),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.name="entryCategory",e.prototype.urlRoot="entryCategories",e.prototype.parse=function(t){var e;return e=o.extend(this.toJSON(),t),e.iconStr=e.icon||"more",e},e}(r)},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;a=i(401),n=i(1271),r=i(1272),o=i(1273),c=i(813),l=i(786),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="EntryMenuView",e.prototype.popoverTitle="",e.prototype.events={"click .edit-entry-handler":"openEditor","click .revoke-entry-handler":"revokeEntry","click .approve-entry-handler":"approveEntry","click .archive-entry-handler":"archiveEntry","click .unarchive-entry-handler":"unarchiveEntry","click .delete-entry-handler":"enterDeleteSubMenu","click .favorite-entry-handler":"favoriteEntry","click .switch-visible-handler":"switchVisible","submit .entry-delete-form":"submitDeleteForm"},e.prototype.initialize=function(t){return this._projectId=t.entryModel.get("_projectId"),this.popoverTitle=tb_i18n.get("entry.menu.title"),e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){var t;return this.entryModel=this.options.entryModel,this.bookkeepingModel=this.options.bookkeepingModel,t=this.entryModel.toJSON(),"list"!==this.options.status&&(t.approveRight=this.bookkeepingModel.get("approveRight")),t.permissions=this.entryModel.hasPermissions("put","put.archive","put.visible","del"),this.$el.html(n(t)),this.triggerHook("render"),this},e.prototype.openEditor=function(t){return this.hide(),this.parentView.requestSubView(l).open(o,{_entryId:this.entryModel.id,type:this.entryModel.get("type")}),this.remove()},e.prototype.approveEntry=function(){return this.entryModel.approve({success:function(t){return function(){return t.remove(),a.show({message:tb_i18n.get("entry.menu.success.approve"),status:"success"})}}(this)}),this},e.prototype.revokeEntry=function(){return this.entryModel.revoke({success:function(t){return function(){return t.remove(),a.show({message:tb_i18n.get("entry.menu.success.revoke"),status:"success"})}}(this)}),this},e.prototype.archiveEntry=function(){return this.entryModel.archive({success:function(t){return function(){return t.remove(),a.show({message:tb_i18n.get("entry.menu.success.archive"),status:"success"})}}(this)}),this},e.prototype.unarchiveEntry=function(){return this.entryModel.unarchive({success:function(t){return function(){return a.show({message:tb_i18n.get("entry.menu.success.unarchive"),status:"success"}),t.remove()}}(this)}),this},e.prototype.favoriteEntry=function(){var t;return t=this.entryModel.get("isFavorite"),this.entryModel[t?"unFavorite":"doFavorite"]({success:function(t){return function(e){var i;if(t.entryModel.set("isFavorite",e.isFavorite),t.render(),!e.isFavorite&&t.options.onUnfavorite)return"function"==typeof(i=t.options).onUnfavorite&&i.onUnfavorite(t.entryModel.get("_id")),t.parentView.close()}}(this)}),this},e.prototype.enterDeleteSubMenu=function(t){return this.enterSubMenu(tb_i18n.get("entry.menu.title.delete"),function(t){return function(){return t.$el.html(r())}}(this)),this},e.prototype.submitDeleteForm=function(t){return t.preventDefault(),this.entryModel.destroy({success:function(t){return function(){return t.remove(),a.show({message:tb_i18n.get("delete.success"),status:"success"})}}(this)}),this},e.prototype.switchVisible=function(t){var e;return e=$(t.currentTarget),this.entryModel.saveAttr("visible",e.data("type"),{success:function(t){return function(){return t.render()}}(this)}),this},e}(c)},function(t,e){t.exports=function(t){var e='<ul class="list entry-menu-list"> ';return t.approveRight&&(e+=" <li> ",e+="confirmed"==t.status?' <a class="approve-entry-handler" data-gta="event" data-label="bkp menu approve"> <span class="icon icon-share"></span>'+tb_i18n.get("entry.menu.action.approve")+" </a> ":' <a class="revoke-entry-handler" data-gta="event" data-label="bkp menu revoke"> <span class="icon icon-repeat"></span>'+tb_i18n.get("entry.menu.action.revoke")+" </a> ",e+=" </li> "),e+=" ",t.permissions.put&&(e+=' <li> <a class="edit-entry-handler" data-gta="event" data-label="bkp menu edit"> <span class="icon icon-pencil"></span>'+tb_i18n.get("entry.menu.action.edit")+" </a> </li> "),e+=' <li> <a class="favorite-entry-handler" data-gta="event" data-label="entry detail|favorite entry"> <span class="icon icon-favorite ',t.isFavorite&&(e+="favorited"),e+='"></span>',e+=t.isFavorite?""+tb_i18n.get("unfavorite"):""+tb_i18n.get("favorite")+tb_i18n.get("bookkeeping"),e+=" </a> </li> ",t.permissions.putArchive&&(e+=" ",e+=t.isArchived?' <li> <a class="unarchive-entry-handler" data-gta="event" data-label="bkp detail|unarchive bkp"> <span class="icon icon-archive"></span>'+tb_i18n.get("unarchive")+" </a> </li> ":' <li> <a class="archive-entry-handler" data-gta="event" data-label="bkp menu archive"> <span class="icon icon-archive"></span>'+tb_i18n.get("entry.menu.action.archive")+" </a> </li> ",e+=" "),e+=" ",t.permissions.del&&(e+=' <li> <a class="delete-entry-handler" data-gta="event" data-label="bkp menu delete"> <span class="icon icon-trash"></span>'+tb_i18n.get("entry.menu.action.delete")+" </a> </li> "),e+=" ",t.permissions.putVisible&&(e+=' <li class="divider"></li> <li> ',"members"==t.visible||"all"==t.visible?e+=' <a class="switch-visible-handler" data-type="involves" data-gta="event" data-label="bkp menu visible involves"> <div class="main-mode"> <span class="icon icon-unlock"></span> <span class="mode">'+tb_i18n.get("visible.mode")+'</span> <span class="ifClose">'+tb_i18n.get("visible.close")+'</span> </div> <span class="mode-explanation">'+tb_i18n.get("visible.to.member")+"</span> </a> ":"involves"==t.visible&&(e+=' <a class="switch-visible-handler" data-type="members" data-gta="event" data-label="bkp menu visible members"> <div class="main-mode"> <span class="icon icon-lock"></span> <span class="mode">'+tb_i18n.get("visible.mode")+'</span> <span class="ifClose">'+tb_i18n.get("visible.open")+'</span> </div> <span class="mode-explanation">'+tb_i18n.get("visible.to.involve")+"</span> </a> "),e+=" </li> "),e+="</ul>"}},function(t,e){t.exports=function(t){var e='<form class="entry-delete-form"> <p>'+tb_i18n.get("entry.menu.delete.tips")+'</p> <button class="btn btn-danger" type="submit">'+tb_i18n.get("delete")+"</button></form>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w=function(t,e){function i(){this.constructor=t}for(var n in e)_.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},_={}.hasOwnProperty;b=i(358),k=i(678),p=i(1002),m=i(686),f=i(681),v=i(677),y=i(788),l=i(401),s=i(1269),c=i(1265),r=i(1267),o=i(1268),u=i(699),d=i(980),h=i(1021),g=i(1052),n=i(1274),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.viewName="EntryCreatorView",e.prototype.tagName="div",e.prototype.className="entry-creator-view fade",e.prototype.modalTitle="",e.prototype.events={"click .entry-category-option":"categoryHandler","click .entry-date":"showDatePicker","click .submit-handler":"submit","change input, blur textarea":"parseEntry","click a.creator-visible":"switchVisible"},e.prototype.initialize=function(t){if(!((null!=t?t._projectId:void 0)||t._entryId&&t.type))throw new Error(this.viewName+":wrong options");return this.options=t,this.type=t.type||1,this.type===-1?this.modalTitle=tb_i18n.get("entry.creator.expense.title"):this.modalTitle=tb_i18n.get("entry.creator.income.title"),this._projectId=t._projectId,this.localCache=f.namespace("temp").namespace("entry_creator"),this.localCacheId=t._projectId+"_"+k.user.id+"_"+this.type,b.delay(function(t){return function(){return t.$el.addClass("in")}}(this),100),e.__super__.initialize.apply(this,arguments)},e.prototype.renderMain=function(t){return this.load().then(function(e){return function(){return e.reset(),e.listen(),e.renderBasic(t),e.renderCategory(),e.renderDate(),e.renderVisible(),e.initCategoryPicker(),e.initInvolve(),e.initTagPicker()}}(this))["catch"](function(t){return console.error(t)})},e.prototype.load=function(t){return new Promise(function(t){return function(e,i){return t.options._entryId?(t.isUpdate=!0,c.fetch(t.options._entryId,{success:function(i){return t.entryModel=i,t._projectId=t.entryModel.get("_projectId"),e()},error:i})):void e()}}(this)).then(function(t){return function(){return new Promise(function(e,i){return o.fetch(t._projectId,{success:function(i){return t.entryCategoriesCollection=i,e()},error:i})})}}(this)).then(function(t){return function(){return new Promise(function(e,i){return u.fetch(t._projectId,{success:function(i){return t.membersCollection=i,e()},error:i})})}}(this))},e.prototype.reset=function(){var t,e;return this.model&&this.stopListening(this.model),this.isUpdate?this.model=this.entryModel.clone():(e=this.localCache(this.localCacheId)||{},t=b.extend({type:this.type,_projectId:this._projectId,_boundToObjectId:this._projectId,_entryCategoryId:this.entryCategoriesCollection.getDefaultId(this.type),content:"",amount:"",date:new Date,note:"",involveMembers:[k.user.id],tagsId:[],visible:"members"},e),this.model=new c(t)),this},e.prototype.listen=function(){return this.listenTo(this.model,"change:_entryCategoryId",this.renderCategory),this.listenTo(this.model,"change:date",this.renderDate),this.listenTo(this.model,"change:visible",this.renderVisible),this.listenTo(this.model,"change",this.cacheEntry)},e.prototype.renderBasic=function(t){var e,i;return e=this.model.toJSON(),i=!0,e.defaultCategories=this.entryCategoriesCollection.getCategories(this.type,i),e.isUpdate=this.isUpdate,t.html(n(e)),t.find(".entry-note-input").flexText(),this.$submit=this.$el.find(".submit-handler"),this.$category=this.$el.find(".entry-category"),this.$date=this.$el.find(".entry-date-label"),this.$amountInput=this.$el.find(".entry-amount-input"),this.$contentInput=this.$el.find(".entry-content-input"),this.$noteInput=this.$el.find(".entry-note-input"),this.$visibleSwitchers=this.$el.find(".creator-visible"),this},e.prototype.renderCategory=function(){var t,e,i,n;return t=this.model.get("_entryCategoryId"),e=null!=(n=this.entryCategoriesCollection.get(t))?n.toJSON():void 0,e&&(this.$category.find(".active").removeClass("active"),i=e.icon?e.icon:"other",this.$category.find("[data-icon="+i+"]").addClass("active")),this},e.prototype.renderDate=function(){var t,e,i;return t=this.model.get("date"),e=t?null!=(i=v.formatDate(t))?i.dateString:void 0:"选择日期",this.$date.text(e),this},e.prototype.renderVisible=function(){var t;return t=this.model.get("visible"),"involves"===t?(this.$visibleSwitchers.filter(".creator-visible-members").addClass("hide"),this.$visibleSwitchers.filter(".creator-visible-involves").removeClass("hide")):(this.$visibleSwitchers.filter(".creator-visible-members").removeClass("hide"),this.$visibleSwitchers.filter(".creator-visible-involves").addClass("hide")),this},e.prototype.initCategoryPicker=function(){var t;return t=!1,this.typePickerView=this.requestSubView(h,{$toggler:this.$(".entry-category-option.other"),width:240,addPlaceholder:tb_i18n.get("entry.creator.other.add.placeholder"),dataList:this.entryCategoriesCollection.getCategories(this.type,t),selected:this.model.get("_entryCategoryId"),select:function(t){return function(e){return t.model.set("_entryCategoryId",e)}}(this),add:function(e){return function(i){return e.entryCategoriesCollection.create({title:i,type:e.type,_projectId:e._projectId},{wait:!0,success:function(i){return e.model.set("_entryCategoryId",i.id),e.typePickerView.update(e.entryCategoriesCollection.getCategories(e.type,t),e.model.get("_entryCategoryId"))}})}}(this)}),this},e.prototype.initInvolve=function(){return this.involveView=this.requestSubView(p,{_projectId:this._projectId,objectModel:this.model,membersCollection:this.membersCollection,dropArea:this.$el,undeletable:!1,resident:[k.user.id]}),this.involveView.$el.prependTo(this.$(".entry-involve-set")),this},e.prototype.initTagPicker=function(){return this.taPickerView=this.requestSubView(g,{_projectId:this._projectId,objectModel:this.model}),this.taPickerView.$el.prependTo(this.$(".entry-tags-set")),this},e.prototype.categoryHandler=function(t){var e,i,n;if(e=$(t.currentTarget),i=e.data("id"),n=e.data("icon"),i&&"other"!==n)return this.model.set("_entryCategoryId",i)},e.prototype.showDatePicker=function(t){var e,i;return this.$date.data("datepicker")?(i=!this.$date.data("showDatepicker"),this.$date.data("showDatepicker",i),this.$date.data("datepicker").picker.toggle(i)):(e=this.model.get("date")?new Date(this.model.get("date")):new Date,this.$date.datepicker({format:"yyyy-mm-dd",language:tb_i18n.getLanguage(),todayHighlight:!0,placement:"left",todayBtn:"linked",tomorrowBtn:"linked"}).datepicker("update",e).datepicker("show").focus().on("changeDate",function(t){return function(e){return t.model.set("date",e.date),t.$date.datepicker("hide")}}(this)).on("hide",function(t){return function(e){return t.$date.data("showDatepicker",!1)}}(this)),this.$date.data("showDatepicker",!0)),!0},e.prototype.parseEntry=function(t){var e,i,n,r,o,s;return o=[],s=!1,r=this.$contentInput.val().trim(),r||(s=!0,o.push("entry-content-input")),e=+this.$amountInput.val().trim(),i=/^\d+(\.\d{0,2})?$/,e>0&&i.test(e)||(s=!0,o.push("entry-amount-input")),n={content:r,amount:e>=0?e:"",note:this.$noteInput.val().trim()},this.model.set(n),s?o:null},e.prototype.switchVisible=function(t){var e;return e=$(t.currentTarget),this.model.set("visible",e.data("type")),this},e.prototype.submit=function(t){var e,i,n,r,o;if(null!=t&&t.preventDefault(),!this.$submit.prop("disabled")){if(i="validate-error",this.$("."+i).removeClass(i),e=this.parseEntry()){for(n=0,o=e.length;n<o;n++)r=e[n],this.$("."+r).addClass(i);return void this.$("."+i).first().focusAtEnd()}return this.disableSubmit(),this.model.save(null,{attrs:this.model.toJSON(),wait:!0,error:function(t){return function(e,i){return t.enableSubmit(),i.status="error",l.show(i)}}(this),success:function(t){return function(e){return t.isUpdate||t.localCache.remove(t.localCacheId),t.enableSubmit(),t.close(),m.trigger(":new:"+e.urlRoot+"/"+e.get("_projectId"),e.toJSON())}}(this)})}},e.prototype.disableSubmit=function(){return this.$submit.attr("disabled","disabled")},e.prototype.enableSubmit=function(){return this.$submit.removeAttr("disabled")},e.prototype.cacheEntry=function(){var t;return t=this.model.toJSON(),this.localCache(this.localCacheId,t),this},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.remove(),this},e}(d)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){
return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<form class="entry-creator-form"> <div class="entry-category"> <ul class="entry-category-select ';i+=1==t.type?"income":"expense",i+='"> ';var n=t.defaultCategories;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=" ","other"!=r.icon&&(i+=' <li class="entry-category-option " data-icon="'+r.icon+'" data-id="'+r._id+'"> <span class="entry-icon icon icon-'+r.iconStr+'"></span> <span class="entry-category-title">'+e(r.title)+"</span> </li> "),i+=" ";return i+=' <li class="entry-category-option other" data-icon="other"> <span class="entry-icon icon icon-more"></span> <span class="entry-category-title">'+tb_i18n.get("entry.creator.other.category")+'</span> </li> </ul> </div> <div class="entry-content"> <input class="entry-content-input form-control" placeholder="'+tb_i18n.get("entry.creator.placeholder.content")+'" value="'+t.content+'" /> </div> <div class="entry-amount-date clearfix"> <div class="entry-amount"> <input class="entry-amount-input form-control" type="number" min="1" placeholder="'+tb_i18n.get("entry.creator.placeholder.amount")+'" value="'+t.amount+'" /> </div> <div class="entry-date"> <label class="entry-date-label btn btn-default form-control-select" data-gta="event" data-label="bkp creator date"></label> </div> </div> <div class="entry-note"> <textarea class="entry-note-input" placeholder="'+tb_i18n.get("entry.creator.placeholder.note")+'">'+t.note+'</textarea> </div> <div class="entry-tags-set"></div> <div class="entry-involve-set"></div> <div class="submit-set clearfix"> <a class="creator-visible creator-visible-members hide" data-type="involves"> <span class="icon icon-unlock"></span>'+tb_i18n.get("visible.mode")+' <span class="mode-explanation">'+tb_i18n.get("visible.to.member")+'</span> </a> <a class="creator-visible creator-visible-involves hide" data-type="members"> <span class="icon icon-lock"></span>'+tb_i18n.get("visible.mode")+' <span class="mode-explanation">'+tb_i18n.get("visible.to.involve")+'</span> </a> <button class="btn btn-primary submit-handler pull-right" data-gta="event" data-label="bkp creator submit"> ',i+=t.isUpdate?""+tb_i18n.get("save"):""+tb_i18n.get("create"),i+=" </button> </div></form>"}},function(t,e){t.exports=function(t){var e='<section class="detail-content scrollable thin-scroll"> <div class="entry-detail-header-wrap"></div> <div class="entry-detail-infos-wrap"></div> <section class="detail-activities-wrap"></section></section><footer class="activity-creator-wrapper"></footer>';return e}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(358);return n+='<div class="archived-wrapper"></div><div class="entry-detail-header"> <a class="menu-handler" data-gta="event" data-label="entry menu"> '+tb_i18n.get("more")+' <span class="icon icon-chevron-down"></span> </a> <div class="entry-info-set entry-content"> <span class="icon icon-'+t.category.iconStr+" ",n+=1==t.type?"income":"expense",n+='"></span> <span class="entry-content-case">'+e(t.content)+'</span> </div> <div class="entry-info-set entry-detail-other"> <div class="entry-other-2-1"> <div class="entry-date"> <span class="icon icon-calendar"></span> <span class="entry-date-case">'+t.dateStr+"</span> </div> ",t.receiver&&(n+=' <div class="entry-receiver"> <span class="icon icon-user"></span> <span class="entry-receiver-case">'+t.receiver+"</span> </div> "),n+=' </div> <div class="entry-other-2-1"> <div class="entry-amount"> <span class="entry-amount-unit">'+tb_i18n.get("entry.amount.unit")+'</span> <span class="entry-amount-case">'+t.amount+"</span> </div> <div> ",r.isNumber(t.cost)&&t.cost>=0&&(n+=' <span class="entry-cost"> <span class="entry-cost-tips">'+tb_i18n.get("entry.detail.cost")+'</span> <span class="entry-cost-unit">'+tb_i18n.get("entry.amount.unit")+'</span> <span class="entry-cost-case">'+t.cost+"</span> </span> "),n+=" ",r.isNumber(t.profit)&&t.profit>=0&&(n+=' <span class="entry-profit"> <span class="entry-profit-tips">'+tb_i18n.get("entry.detail.profit")+'</span> <span class="entry-profit-case">'+t.profit+'</span> <span class="entry-profit-unit">%</span> </span> '),n+=" </div> </div> </div></div>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x=function(t,e){function i(){this.constructor=t}for(var n in e)S.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},S={}.hasOwnProperty;C=i(678),h=i(411),w=i(677),_=i(788),u=i(401),M=i(1044),g=i(1042),b=i(696),T=i(810),r=i(796),n=i(809),p=i(983),m=i(1043),f=i(1278),y=i(982),j=i(786),a=i(1281),c=i(1282),l=i(1283),d=i(1284),s=i(1185),o=i(1186),k=i(1188),t.exports=v=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return x(e,t),e.prototype.viewName="PostView",e.prototype.tagName="article",e.prototype.className="post-detail-view toggler-parent fade",e.prototype.events={"click .menu-handler":"togglePostMenu","click .post-edit-handler":"openPostCreator","click .work-previewer-handler":"openPreviewer","click .shimo-update":"updateShimo","mousewheel .detail-content":w.mousewheel,"click .unarchive-handler":"openUnarchiveMenu","click .remove-handler":"deleteModelObject"},e.prototype.initialize=function(t){if(t._postId||t.postModel)return this.options=t,this.postModel=t.postModel,this._postId=t._postId,this.showLoadingIndicator(),this.load({success:function(t){return function(){var e;return t.$el.addClass("in"),t.renderBasic(),t.renderPost(),t.renderInfos(),t.renderActivities(),t.renderActivitiyCreator(),t.listen(),"function"==typeof(e=t.options).success?e.success(t):void 0}}(this)}),this},e.prototype.load=function(t){return null==t&&(t={}),Promise.resolve().then(function(t){return function(){return new Promise(function(e,i){return t.postModel?(t._postId=t.postModel.id,e()):g.fetch(t._postId,{silentError:t.options.silentError||!1,success:function(i){return t.postModel=i,e()},error:function(t,e){return i(e)}})})}}(this)).then(function(t){return function(){return t._projectId=t.postModel.get("_projectId"),t.refer=t.postModel.get("source"),t.projectModel=b.getOne(0,t._projectId),t.projectModel.getRoleScope()<0&&t.$el.addClass("guest"),"teambition"===t.refer?Promise.resolve():t.loadThirdDoc()}}(this)).then(function(e){return function(){if(e.$el)return e.hideLoadingIndicator(),e.$el.attr("id",e.postModel.id),e.$el.removeClass("post-detail-loading"),"function"==typeof t.success?t.success():void 0}}(this))["catch"](function(t){return function(e){var i;return t.options.silentError&&"function"==typeof(i=t.options).error&&i.error(t),console.error(e),t.close()}}(this)),this},e.prototype.loadThirdDoc=function(){return this.refer&&this._projectId?M.get(this._postId,this._projectId,this.refer,this.postModel.get("_creatorId")).then(function(t){return function(e){var i,n,r;return e?(n=t.postModel,"shimo"===t.refer&&(r=e.name),"yiqixie"===t.refer&&(r=n.get("title")),i=e.html,t.postUrl=e.url,n.set("content",i),n.set("title",r)):Promise.reject()}}(this)):Promise.reject()},e.prototype.listen=function(){return this.listenTo(this.postModel,"destroy remove",function(t){return function(){var e;return"function"==typeof(e=t.options).onUnfavorite&&e.onUnfavorite(t.postModel.get("_id")),t.close()}}(this)),this.listenTo(this.postModel,"change",this.renderPost),this},e.prototype.renderBasic=function(){return this.$el.html(c()),this.$header=this.$(".post-detail-header-wrap"),this.$content=this.$(".post-content"),this.$attachments=this.$(".post-attachments"),this.$involveSet=this.$(".involve-set"),this},e.prototype.renderPost=function(){var t,e;return e=this.postModel.toJSON(),e.title=w.escape(this.postModel.get("title")),e.permissions=this.postModel.hasPermissions("put","put.pin","put.archive","put.visible","del"),this.$header.html(d(e)),this.$header.find(".time-stamp").timesince(),this.$content.html(l(e)),t=this.postModel.getAttachmentDatas(),(null!=t?t.length:void 0)?this.$attachments.html(a({attachments:t})):this.$attachments.html(""),this.$content.find("pre").each(function(){return h.highlightBlock(this)}),this.renderArchivedBadge(),this},e.prototype.updateShimo=function(t){var e,i;if(!i)return i=!0,e=$(t.target),e.css({cursor:"not-allowed"}),this.loadThirdDoc().then(function(){return i=!1,e.css({cursor:"pointer"})})},e.prototype.renderInfos=function(){var t;return null!=(t=this.infosView)&&t.remove(),this.infosView=this.requestSubView(p,{objectModel:this.postModel,boundToObjectType:this.postModel.get("objectType"),infos:["link","tag"]}),this.$(".post-detail-infos-wrap").html(this.infosView.$el),this},e.prototype.renderArchivedBadge=function(){var t;return t={isArchived:this.postModel.get("isArchived"),text:tb_i18n.get("post.detail.archived"),cancel:tb_i18n.get("unarchive"),deleted:tb_i18n.get("delete.post"),permissions:this.postModel.hasPermissions("put.archive","del")},this.$(".archived-wrapper").html(s(t)),this.$el[t.isArchived?"addClass":"removeClass"]("archived"),this},e.prototype.renderActivities=function(){return this.activityTimelineView=this.requestSubView(r,{boundToObjectType:"post",_projectId:this._projectId,objectModel:this.postModel,$scrollFrame:this.$(".detail-content"),where:this.options.where,success:function(t){return function(){return t.activityCreatorView.show()}}(this)}),this.listenTo(this.activityTimelineView,"toggleOnlyCommentsBtn",function(t){return function(e){var i;return null!=(i=t.activityCreatorView)?i.toggleOnlyCommentsBtn(e):void 0}}(this)),this.$(".detail-activities-wrap").append(this.activityTimelineView.$el),this},e.prototype.renderActivitiyCreator=function(){return this.activityCreatorView=this.requestSubView(n,{_projectId:this._projectId,dragAndDropWrap:this.$el,where:this.options.where,boundToObjectType:"post",objectModel:this.postModel}),this.listenTo(this.activityCreatorView,"filterActivities",function(t){return function(e){var i;return null!=(i=t.activityTimelineView)?i.filterActivities(e):void 0}}(this)),this.$(".activity-creator-wrapper").html(this.activityCreatorView.$el),this},e.prototype.openPostCreator=function(){return this.projectModel.hasPermission("post.post")?(this.requestSubView(j).open(m,{backdrop:"static",_projectId:this._projectId,postModel:this.postModel,created:function(t){}}),this):this},e.prototype.togglePostMenu=function(t){var e;return e=$(t.currentTarget),e.data("bs.popover")?this:(this.requestSubView(f,{fixed:this.$el.closest(".panel-view").length,$toggler:e,_projectId:this._projectId,postModel:this.postModel,permission:this.postModel.get("_creatorId")===C.user.id,onUnfavorite:this.options.onUnfavorite,postUrl:this.postUrl,refer:this.refer}).show(),this)},e.prototype.openPreviewer=function(t){var e,i;return e=this.postModel.get("attachments"),(null!=e?e.length:void 0)?(i=new T(e),this.checkPostAttachments()?(this.requestSubView(j).open(y,{_projectId:this.postModel.get("_projectId"),thumbnailModel:this.postModel,workModels:i.models,workModel:i.get($(t.currentTarget).data("id"))}),this):(u.show({message:tb_i18n.get("post.attachment.not.visible"),status:"error"}),!1)):this},e.prototype.checkPostAttachments=function(){var t,e;return t=this.postModel.get("attachments"),null==t||!t.length||(e=new T(t),e.every(function(t){return!("involves"===t.get("visible")&&t.get("involveMembers").indexOf(C.user.id)===-1)}))},e.prototype.openUnarchiveMenu=function(t){var e;if(e=$(t.currentTarget),!e.data("bs.popover"))return this.requestSubView(k,{$toggler:e,title:tb_i18n.get("unarchive"),currentModel:this.postModel,msg:tb_i18n.get("unarchived.post.success")}).show()},e.prototype.deleteModelObject=function(t){var e;return e=$(t.currentTarget),e.data("bs.popover")||this.requestSubView(o,{$toggler:e,title:tb_i18n.get("delete.post"),confirmDelete:tb_i18n.get("post.menu.confirm.delete"),currentModel:this.postModel}).show(),this},e.prototype.close=function(){var t,e;return"PostPanelView"===(null!=(e=this.parentView)?e.viewName:void 0)?"function"==typeof(t=this.parentView).back&&t.back():this.remove(),this},e.prototype.remove=function(){var t,i,n;return null!=(t=this.$activityCreator)&&t.remove(),this.postModel&&(n=C.router.getUrl().replace("/post/"+this.postModel.id,""),C.router.navigate(n,{trigger:!1})),"ObjectModalView"===(null!=(i=this.parentView)?i.viewName:void 0)&&this.parentView.remove(),e.__super__.remove.apply(this,arguments)},e}(_)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y=function(t,e){function i(){this.constructor=t}for(var n in e)b.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},b={}.hasOwnProperty;m=i(358),v=i(678),u=i(677),o=i(401),f=i(679),n=i(1279),r=i(1280),s=i(813),a=i(1043),d=i(786),g=i(1044),h=i(810),l=i(696),p=i(1234),t.exports=c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.viewName="PostMenuView",e.prototype.popoverTitle="",e.prototype.events={"click .edit-handler":"openPostCreator","click .pin-handler":"pinPost","click .copy-handler":"copyPost","click .move-handler":"movePost","click .archive-handler":"archivePost","click .unarchive-handler":"unarchivePost","click .delete-handler":"enterDeleteSubMenu","click .favorite-post-handler":"favoritePost","click .switch-visible-handler":"switchVisible","submit .delete-form":"submitDeleteForm"},e.prototype.initialize=function(t){return this._projectId=t.postModel.get("_projectId"),this.popoverTitle=tb_i18n.get("post.menu.title"),e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){var t;return this.postModel=this.options.postModel,t=m.extend(this.options.postModel.toJSON(),{refer:this.options.refer,postUrl:this.options.postUrl,permissions:this.postModel.hasPermissions("put","put.pin","put.move","put.archive","put.visible","del")}),this.$el.html(n(t)),this.triggerHook("render"),this},e.prototype.openPostCreator=function(t){var e,i,n,r,o,s,c;return e=this.options.postModel,i=e.get("_id"),r=e.get("title"),c=$(t.target),n=c.data("postRefer"),o=c.data("postUrl"),this.hide(),s=f.SHIMO_HOST+"/sso/login/teambition?callback="+encodeURIComponent(o)+"&providerUser="+v.user.get("_id"),"shimo"===n?window.open(s):(this.requestSubView(d).open(a,{backdrop:"static",_projectId:e.get("_projectId"),postModel:e,yiqixieUrl:o,isYiqixie:"yiqixie"===n}),this)},e.prototype.pinPost=function(){var t,e;return e=this.options.postModel,t=e.get("pin"),e.set("pin",!t),t?e.unpin():e.pin(),this.render(),this.remove(),this},e.prototype.copyPost=function(){return this.enterCopyOrMoveSubMenu("fork")},e.prototype.movePost=function(){return this.enterCopyOrMoveSubMenu("move")},e.prototype.enterCopyOrMoveSubMenu=function(t){var e,i,n,r;if(this.checkPostAttachments(t)){switch(e=this.formatProjectsDataList(t),n=tb_i18n.get("project.select.list.hint"),t){case"fork":r=tb_i18n.get("fork.to.other.project"),i=tb_i18n.get("post.menu.fork.global.hint");break;case"move":r=tb_i18n.get("move.to.other.project"),i=tb_i18n.get("post.menu.move.global.hint")}return this.enterSubMenu(r,function(r){return function(){var o;return null!=(o=r.copyOrMoveListView)&&o.remove(),r.copyOrMoveListView=r.requestSubView(p,{dataList:e,globalHint:i,selectHint:n,selectConfirm:function(e){return r.copyOrMoveListView.disableSubmit(),r.copyOrMoveCallback(e,t)}}),r.$el.html(r.copyOrMoveListView.$el)}}(this))}},e.prototype.formatProjectsDataList=function(t){var e;return e=[],l.get(0).each(function(i){return function(n){var r,o;if(!(n.getRoleScope()<0||n.id===i._projectId))return r=n.getCopyOrMoveStatus("posts"),o=function(){switch(r){case"closed":return tb_i18n.get("target.post.closed");case"denied":if("fork"===t)return tb_i18n.get("target.post.fork.post.denied");if("move"===t)return tb_i18n.get("target.post.move.post.denied");break;default:return""}}(),e.push({id:n.get("_id"),name:n.get("name"),py:n.get("py"),pinyin:n.get("pinyin"),disabled:null!=r,disabledHint:o})}}(this)),e},e.prototype.checkPostAttachments=function(t){var e,i,n;return"move"!==t||(e=this.postModel.get("attachments"),null==e||!e.length||(n=new h(e),i=n.every(function(t){return!("involves"===t.get("visible")&&t.get("involveMembers").indexOf(v.user.id)===-1)}),i||o.show({message:tb_i18n.get("post.menu.move.error.title"),hint:tb_i18n.get("post.menu.move.error.hint"),status:"error"}),i))},e.prototype.copyOrMoveCallback=function(t,e){var i;return i=this._projectId,this.postModel.forkOrMove(e,t,{success:function(t){return function(n){var r,o;if(r=function(){switch(e){case"fork":return o=tb_i18n.get("post.menu.fork.success");case"move":return o=tb_i18n.get("post.menu.move.success")}}(),u.message({tips:r,url:"/project/"+n._projectId+"/posts/post/"+n._id,title:t.postModel.get("title")}),t.remove(),"move"===e)return v.router.navigate("project/"+i+"/posts",{trigger:!0})}}(this),error:function(t){return function(){var i;return i=function(){switch(e){case"fork":return tb_i18n.get("post.menu.fork.fail");case"move":return tb_i18n.get("post.menu.move.fail")}}(),o.show({message:i,status:"error"}),t.copyOrMoveListView.disableSubmit()}}(this)})},e.prototype.archivePost=function(){return this.options.postModel.archive({success:function(t){return function(){return o.show({message:tb_i18n.get("archived.post.success"),status:"success"}),t.remove()}}(this)}),this},e.prototype.unarchivePost=function(){return this.options.postModel.unarchive({success:function(t){return function(){return o.show({message:tb_i18n.get("unarchived.post.success"),status:"success"}),t.remove()}}(this)}),this},e.prototype.favoritePost=function(){var t;return t=this.options.postModel.get("isFavorite"),this.options.postModel[t?"unFavorite":"doFavorite"]({success:function(t){return function(e){var i;if(t.options.postModel.set("isFavorite",e.isFavorite),t.render(),!e.isFavorite&&t.options.onUnfavorite)return"function"==typeof(i=t.options).onUnfavorite&&i.onUnfavorite(t.options.postModel.get("_id")),t.parentView.close()}}(this)}),this},e.prototype.enterDeleteSubMenu=function(){return this.enterSubMenu(tb_i18n.get("post.menu.delete.title"),function(t){return function(){return t.$el.html(r())}}(this)),this},e.prototype.submitDeleteForm=function(t){return t.preventDefault(),this.options.postModel.destroy({success:function(t){return function(){return t.remove()}}(this)}),this},e.prototype.switchVisible=function(t){var e;return e=$(t.currentTarget),this.options.postModel.saveAttr("visible",e.data("type"),{success:function(t){return function(){return t.render()}}(this)}),this},e.prototype.remove=function(){var t;return"ObjectModalView"===(null!=(t=this.parentView)?t.viewName:void 0)&&this.parentView.remove(),e.__super__.remove.apply(this,arguments)},e}(s)},function(t,e){t.exports=function(t){var e='<ul class="list post-menu-view"> ';return t.permissions.put&&(e+=' <li> <a class="edit-handler" data-gta="event" data-label="edit post" ',t.refer&&(e+=' data-post-refer="'+t.refer+'" data-post-url="'+t.postUrl+'" '),e+='> <span class="icon icon-pencil"></span>'+tb_i18n.get("post.menu.edit")+" </a> </li> "),e+=" ",t.permissions.putPin&&(e+=' <li> <a class="pin-handler ',t.pin||(e+="unpin"),e+='" data-gta="{action: \'toggle pin Post\', control: \'More Menu\'}"> <span class="icon icon-pin"></span>',e+=t.pin?""+tb_i18n.get("post.menu.unpin.title"):""+tb_i18n.get("post.menu.pin.title"),e+=" </a> </li> "),e+=' <li> <a class="copy-handler"> <span class="icon icon-copy"></span>'+tb_i18n.get("post.menu.copy")+" </a> </li> ",t.permissions.putMove&&(e+=' <li> <a class="move-handler"> <span class="icon icon-move-task"></span>'+tb_i18n.get("post.menu.move")+" </a> </li> "),e+=' <li> <a class="favorite-post-handler" data-gta="event" data-label="post detail|favorite post"> <span class="icon icon-favorite ',t.isFavorite&&(e+="favorited"),e+='"></span>',e+=t.isFavorite?""+tb_i18n.get("unfavorite"):""+tb_i18n.get("favorite")+tb_i18n.get("post"),e+=" </a> </li> ",t.permissions.putArchive&&(e+=" <li> ",e+=t.isArchived?' <a class="unarchive-handler" data-gta="event" data-label="unarchive post"> <span class="icon icon-archive"></span>'+tb_i18n.get("unarchive")+" </a> ":' <a class="archive-handler" data-gta="event" data-label="archive post"> <span class="icon icon-archive"></span>'+tb_i18n.get("archive.post")+" </a> ",e+=" </li> "),e+=" ",t.permissions.del&&(e+=' <li> <a class="delete-handler" data-gta="event" data-label="delete post"> <span class="icon icon-trash"></span>'+tb_i18n.get("post.menu.delete.title")+" </a> </li> "),e+=" ",t.permissions.putVisible&&(e+=' <li class="divider"></li> <li> ',"members"==t.visible||"all"==t.visible?e+=' <a class="switch-visible-handler" data-type="involves" data-gta="event" data-label="post detail|switch visible"> <div class="main-mode"> <span class="icon icon-unlock"></span> <span class="mode">'+tb_i18n.get("visible.mode")+'</span> <span class="ifClose">'+tb_i18n.get("visible.close")+'</span> </div> <span class="mode-explanation">'+tb_i18n.get("visible.to.member")+"</span> </a> ":"involves"==t.visible&&(e+=' <a class="switch-visible-handler" data-type="members" data-gta="event" data-label="post detail|switch visible"> <div class="main-mode"> <span class="icon icon-lock"></span> <span class="mode">'+tb_i18n.get("visible.mode")+'</span> <span class="ifClose">'+tb_i18n.get("visible.open")+'</span> </div> <span class="mode-explanation">'+tb_i18n.get("visible.to.involve")+"</span> </a> "),e+=" </li> "),e+="</ul>"}},function(t,e){t.exports=function(t){var e='<form class="delete-form"> <p>'+tb_i18n.get("post.menu.confirm.delete")+'</p> <button class="btn btn-danger" type="submit">'+tb_i18n.get("delete")+"</button></form>";return e}},function(t,e,i){t.exports=function(t){var e="",n=i(968);e+='<ul class="attachments-list clearfix"> ';var r=t.attachments;if(r)for(var o,s=-1,a=r.length-1;s<a;)o=r[s+=1],e+=' <li class="work work-previewer-handler" data-id="'+o._id+'"> '+n(o,"fileSizeFix")+" </li> ";return e+="</ul>"}},function(t,e){t.exports=function(t){var e='<section class="detail-content scrollable thin-scroll"> <div class="post-detail-header-wrap"></div> <div class="post-detail-content-wrap"> <div class="post-content"></div> <div class="post-attachments"></div> </div> <div class="post-detail-infos-wrap"></div> <section class="detail-activities-wrap"></section></section><footer class="activity-creator-wrapper"></footer>';return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="simditor routeLinks"> <div class="simditor-body"> ';if(i+="md"==t.postMode?" "+e(t.content,"MD")+" ":" "+t.content+" ",i+=" </div></div>",t.links.length>0){i+=" <ul> ";var n=t.links;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li> <a href="'+r.shortUrl+'" target="_blank" title="'+r.title+'"> '+r.shortUrl+" </a> </li> ";i+=" </ul>"}return i}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="archived-wrapper"></div><div class="post-detail-header"> <h4 class="post-title">'+e(t.title)+"</h4> ";return"shimo"==t.source&&(i+=' <a class="shimo-update button-shimo-update" data-gta="event" data-label="click shimo update"> '+tb_i18n.get("wall.view.shimo.update")+" </a> "),i+=' <a class="menu-handler" data-gta="event" data-label="open post menu"> '+tb_i18n.get("more")+' <span class="icon icon-chevron-down"></span> </a></div>'}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S,I,z,P,D,O,N,E=function(t,e){return function(){return t.apply(e,arguments)}},A=function(t,e){function i(){this.constructor=t}for(var n in e)L.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},L={}.hasOwnProperty;O=i(358),N=i(678),P=i(677),b=i(804),y=i(447),D=i(788),l=i(401),S=i(803),I=i(995),h=i(699),v=i(696),_=i(992),j=i(1204),z=i(994),r=i(796),n=i(809),d=i(1005),m=i(1021),x=i(1286),c=i(983),T=i(1031),C=i(818),k=i(1151),a=i(1290),u=i(1291),p=i(1292),g=i(1293),s=i(1185),w=i(1024),o=i(1186),f=i(1027),M=function(t){function e(){return this._innerPinBarHandler=E(this._innerPinBarHandler,this),e.__super__.constructor.apply(this,arguments)}return A(e,t),e.prototype.viewName="TaskDetailView",e.prototype.className="task-detail fade task-detail-loading column-rest-fill",e.prototype.events={"click a.task-detail-tasklist":"toggleGroupSwitcher","click a.task-detail-stage":"toggleStageSwitcher","click .menu-handler":"toggleTaskMenu","click .task a.check-box":"toggleDone","keydown .task-content-input":"quickUpdateTaskContent","blur .task-content-input":"updateTaskContent","click a.task-detail-executor":"toggleExecutorSelector","click a.task-detail-priority ":"togglePrioritySelector","click a.task-detail-repeat":"toggleRepeatSelector","mousewheel .detail-content":P.mousewheel,"click .unarchive-handler":"openUnarchiveMenu","click .remove-handler":"deleteModelObject"},e.prototype.initialize=function(t){if(t._taskId||t.taskModel)return this.options=t,this.taskModel=t.taskModel,this.load().then(function(t){return function(){var e;return t.$el.addClass("in"),t.renderBasic(),t.listen(),t.renderHeader(),t.renderArchivedBadge(),t.renderInfos(),t.renderHandlerSet(),t.initActivityTimeline(),t.renderActivitiyCreator(),t.activeTaskCard(),"function"==typeof(e=t.options).success?e.success(t):void 0}}(this))["catch"](function(t){return function(e){var i;return t.options.silentError&&"function"==typeof(i=t.options).error&&i.error(t),console.error(e),t.close()}}(this)),this},e.prototype.load=function(){return this.showLoadingIndicator(),new Promise(function(t){return function(e,i){var n,r;return t.taskModel?void e():(r=t.options._taskId,n={silentError:t.options.silentError||!1,success:function(i){return t.taskModel=i,e()},error:i},S.fetch(r,n))}}(this)).then(function(t){return function(){var e;if(t.$el)return t._taskId=t.taskModel.id,t._projectId=t.taskModel.get("_projectId"),t.projectModel=v.getOne(0,t._projectId),(null!=(e=t.projectModel)?e.getRoleScope():void 0)<0&&t.$el.addClass("guest"),t.projectModel.getRoleScope()>=0||"all"===t.projectModel.get("visibility")||"organization"===t.projectModel.get("visibility")?Promise.all([new Promise(function(e,i){return z.fetch(t._projectId,{success:function(i){return t.tasklistsCollection=i,e()},error:i})}),new Promise(function(e,i){return _.fetch(t.taskModel.get("_tasklistId"),{success:function(i){return t.stagesCollection=i,e()},error:i})}),new Promise(function(e,i){return j.fetch(t.taskModel.id,{success:function(i){return t.subtasksCollection=i,e()},error:i})}),new Promise(function(e,i){return h.fetch(t._projectId,{success:function(i){return t.membersCollection=i,e()},error:i})})]):(t.subtasksCollection=j.get(t._taskId),t.membersCollection=h.get(t._projectId),Promise.resolve())}}(this)).then(function(t){return function(){if(t.$el)return t.hideLoadingIndicator(),t.$el.removeClass("task-detail-loading")}}(this))},e.prototype.listen=function(){var t,e;return e="change:content change:isDone change:_stageId change:_executorId",this.listenTo(this.taskModel,e,this.renderHeader),"taskDetailPanel"===this.parentView.viewName?this.listenTo(this.taskModel,"change:_tasklistId change:_stageId",this.close):this.listenTo(this.taskModel,"change:_tasklistId",this.refreshStage),t="change:startDate change:dueDate change:_stageId change:_executorId change:priority change:recurrence",this.listenTo(this.taskModel,t,this.renderHandlerSet),this.listenTo(this.projectModel,"change:applications",function(){if(this.projectModel.isAppChanged("preciseDate startDate")&&this.renderHandlerSet(),this.projectModel.isAppChanged("tasklist"))return this.renderHeader()}),this.listenTo(this.taskModel,"change:isArchived",function(){return this.renderHeader(),this.renderHandlerSet(),this.renderArchivedBadge(),this.renderInfos()}),this.listenTo(this.taskModel,"destroy",function(t){return function(){var e;return"function"==typeof(e=t.options).onUnfavorite&&e.onUnfavorite(t.taskModel.get("_id")),t.close()}}(this)),this},e.prototype.renderBasic=function(){return this.$el.html(a()),this.$content=this.$(".task-detail-content"),this.$activityCreator=this.$(".activity-creator-wrapper"),this.$detailContent=this.$(".detail-content"),this.$noteInputSet=this.$(".note-input-set"),this},e.prototype.renderTaskIdLabel=function(){return this.requestSubView(C,{projectModel:this.projectModel,uniqueId:this.taskModel.get("uniqueId")}).bind(this.$(".task-id-placeholder"))},e.prototype.renderHeader=function(){var t,e,i,n,r,o,s;return o=null!=(e=this.stagesCollection)?e.get(this.taskModel.get("_stageId")):void 0,s=null!=(i=this.tasklistsCollection)?i.get(this.taskModel.get("_tasklistId")):void 0,t=O.extend(this.taskModel.toJSON(),{isGhost:N.user.get("isGhost"),permissions:this.taskModel.hasPermissions("put","put.status","put.move"),tasklistName:(null!=s?s.get("title"):void 0)||(null!=(n=this.taskModel.get("tasklist"))?n.title:void 0),isTasklistEnabled:this.projectModel.isAppEnabled("tasklist"),stageName:(null!=o?o.get("name"):void 0)||(null!=(r=this.taskModel.get("stage"))?r.name:void 0),isArchived:this.taskModel.get("isArchived")}),this.taskModel.get("isArchived")&&(t.permissions={}),this.$(".task-detail-header-wrap").html(u(t)),this.renderTaskIdLabel(),this},e.prototype.renderInfos=function(){return this.infosView=this.requestSubView(c,{objectModel:this.taskModel,boundToObjectType:"task",subtasksCollection:this.subtasksCollection,membersCollection:this.membersCollection,infos:["note","link","tag","subtask"]}),this.$(".task-detail-infos-wrap").html(this.infosView.$el),this.$detailContent.off("scroll",this._innerPinBarHandler).on("scroll",this._innerPinBarHandler),this},e.prototype._innerPinBarHandler=function(){return k.trigger("noteEditorToolBarScroll",this.$detailContent)},e.prototype.renderArchivedBadge=function(){var t;return t={isArchived:this.taskModel.get("isArchived"),text:tb_i18n.get("task.detail.archived"),cancel:tb_i18n.get("unarchive"),deleted:tb_i18n.get("delete.task"),permissions:this.taskModel.hasPermissions("put.archive","del")},this.$(".archived-wrapper").html(s(t)),this.$el[t.isArchived?"addClass":"removeClass"]("archived"),this},e.prototype.renderHandlerSet=function(){var t,e,i,n,r,o,s;return i=this.taskModel.get("startDate")||this.projectModel.isAppEnabled("startDate"),e=[O.extend(this.taskModel.getDateFormatObj("dueDate"),{title:tb_i18n.get("task.detail.due.date"),hasPermission:this.taskModel.hasPermission("put.dueDate"),hint:tb_i18n.get("task.detail.time.click.set")})],i&&e.unshift(O.extend(this.taskModel.getDateFormatObj("startDate"),{title:tb_i18n.get("task.detail.start.date"),hasPermission:this.taskModel.hasPermission("put.startDate"),hint:tb_i18n.get("task.detail.time.click.set")})),t=O.extend(this.taskModel.toJSON(),{permissions:this.taskModel.hasPermissions("put","put.executor"),executor:this.taskModel.get("executor")||(null!=(r=this.membersCollection)&&null!=(o=r.get(this.taskModel.get("_executorId")))?o.toJSON():void 0),priorityTitle:(n=this.taskModel.get("priority"))?P.getPriorityDisplay(n)||"":void 0,repeatTitle:this.taskModel.getRepeatTitle(),preciseDate:this.projectModel.isAppEnabled("preciseDate"),isStartTimeEnable:i,dateItems:e,projectId:this.projectModel.get("_id"),orgId:this.projectModel.get("_organizationId")}),this.taskModel.get("isArchived")&&(t.permissions={},O.each(e,function(t){return t.hasPermission=!1})),this.$(".task-detail-handlers-wrap").html(p(t)),this.initDropHandler(this.$(".task-detail-handler:eq(0)")),null!=(s=this.taskDatetimeView)&&s.remove(),
this.taskDatetimeView=this.requestSubView(T,{el:this.$(".task-detail-handler-set:first-of-type")[0],taskModel:this.taskModel,projectModel:this.projectModel,onSelect:function(t){return function(e,i){return t.taskModel.editDate(e,i)}}(this)}),this},e.prototype.initActivityTimeline=function(){var t,e;return this.activityTimelineView=this.requestSubView(r,{_projectId:this._projectId,boundToObjectType:"task",objectModel:this.taskModel,$scrollFrame:this.$detailContent,where:this.options.where,success:function(t){return function(){return t.activityCreatorView.show()}}(this)}),this.listenTo(this.activityTimelineView,"toggleOnlyCommentsBtn",function(t){return function(e){var i;return null!=(i=t.activityCreatorView)?i.toggleOnlyCommentsBtn(e):void 0}}(this)),e=this.$(".detail-activities-wrap"),t=this.activityTimelineView.$el,t.appendTo(e),this},e.prototype.renderActivitiyCreator=function(){return this.activityCreatorView=this.requestSubView(n,{_projectId:this._projectId,where:this.options.where,boundToObjectType:"task",objectModel:this.taskModel}),this.listenTo(this.activityCreatorView,"filterActivities",function(t){return function(e){var i;return null!=(i=t.activityTimelineView)?i.filterActivities(e):void 0}}(this)),this.$(".activity-creator-wrapper").html(this.activityCreatorView.$el),this},e.prototype.popOutAvatar=function(){return O.delay(function(t){return function(){return t.$(".task-detail-handler-wrap .avatar").addClass("pop-out")}}(this)),this},e.prototype.popBackAvatar=function(){return O.delay(function(t){return function(){return t.$(".task-detail-handler-wrap .avatar").removeClass("pop-out")}}(this)),this},e.prototype.renderExecutor=function(t){var e,i;return e=this.taskModel.get("_projectId"),t||(t=this.taskModel.get("_executorId")),i=h.getOne(e,t),this.$(".task-detail-handler-wrap .avatar").css({"background-image":"url("+i.get("avatarUrl")+")"}),this},e.prototype.initDropHandler=function(t){var e;return t&&this.taskModel.hasPermission("put.executor")?(e=null,t.droppable({hoverClass:"hover",accept:".member",addClasses:!1,tolerance:"pointer",greedy:!0,drop:function(t){return function(i){var n;if(t.taskModel.get("isDone"))return!1;if(e)return n={_executorId:e},t.taskModel.save(n,{attrs:n}),t.popBackAvatar(),e=null}}(this),over:function(t){return function(i,n){return!t.taskModel.get("isDone")&&(t.taskModel.get("_executorId")!==n.helper.data("id")&&(t.popOutAvatar(),e=n.helper.data("id"),t.renderExecutor(e)))}}(this),out:function(t){return function(){return e&&(t.renderExecutor(),e=null),t.popBackAvatar()}}(this)}),this):this},e.prototype.refreshStage=function(){return _.fetch(this.taskModel.get("_tasklistId"),{success:function(t){return function(e){return t.stagesCollection=e,t.renderHeader()}}(this)}),this},e.prototype.toggleGroupSwitcher=function(t){var e,i,n;return e=$(t.currentTarget),i="toggleGroupSwitcher",e.data(i)?this:(e.data(i,!0),null!=(n=this.groupSwitcherView)&&n.remove(),this.groupSwitcherView=this.requestSubView(m,{$toggler:e,dataList:this.tasklistsCollection.map(function(t){return{_id:t.get("_id"),title:t.get("title")}}),selected:this.taskModel.get("_tasklistId"),select:function(t){return function(e){var i;return i=I.find(e),t.taskModel.saveAttr("move",null,{attrs:{_stageId:i.get("stageIds")[0]}})}}(this)}).show(),this)},e.prototype.toggleStageSwitcher=function(t){var e,i,n;return e=$(t.currentTarget),i="toggleStageSwitcher",e.data(i)?this:(e.data(i,!0),null!=(n=this.stageSwitcherView)&&n.remove(),this.stageSwitcherView=this.requestSubView(m,{$toggler:e,dataList:this.stagesCollection.map(function(t){return{_id:t.get("_id"),title:t.get("name")}}),selected:this.taskModel.get("_stageId"),select:function(t){return function(e){return t.taskModel.saveAttr("move",null,{attrs:{_stageId:e}})}}(this)}).show(),this)},e.prototype.toggleTaskMenu=function(t){var e;return e=$(t.currentTarget),e.data("bs.popover")||this.requestSubView(x,{fixed:this.$el.closest(".panel-view").length,$toggler:e,_projectId:this._projectId,taskModel:this.taskModel,onUnfavorite:this.options.onUnfavorite}).show(),N.gta.event({action:"toggle more menu",type:"task"}),this},e.prototype.toggleDone=function(){var t;return t=this.taskModel.get("isDone"),this.taskModel.save(null,{attrs:{isDone:!t,onStage:t?0:null}}),this},e.prototype.openUnarchiveMenu=function(t){var e,i,n,r,o;if(e=$(t.currentTarget),o=null!=(i=this.tasklistsCollection)?i.get(this.taskModel.get("_tasklistId")):void 0,r=null!=(n=this.stagesCollection)?n.get(this.taskModel.get("_stageId")):void 0,!e.data("bs.popover"))return this.requestSubView(w,{$toggler:e,projectModel:this.projectModel,tasklistModel:o,stageModel:r,isFrozenProject:!0,success:function(t){return function(e){return t.projectModel=e.projectModel,t.stageModel=e.stageModel,t.taskModel.unarchive({_stageId:t.stageModel.id,success:function(){return N.PREFERENCE.getIsUsePanelToOpenTask()&&N.APP.hidePanel(),l.show({message:tb_i18n.get("unarchived.task.success"),status:"success"}),t.remove()}})}}(this)}).show()},e.prototype.deleteModelObject=function(t){var e;return e=$(t.currentTarget),e.data("bs.popover")||this.requestSubView(o,{$toggler:e,title:tb_i18n.get("delete.task"),confirmDelete:tb_i18n.get("task.menu.confirm.delete"),currentModel:this.taskModel}).show(),this},e.prototype.quickUpdateTaskContent=function(t){var e;return e=$(t.currentTarget),13===t.keyCode&&(t.preventDefault(),e.blur()),this},e.prototype.updateTaskContent=function(){var t,e,i;return t=this.$(".task-content-input"),e=t.text().replace(/\s+/g," ").trim(),i=this.taskModel.get("content"),e&&e!==i?this.taskModel.save(null,{attrs:{content:e}}):t.text(i),this},e.prototype.toggleExecutorSelector=function(t){var e,i,n;return e=$(t.currentTarget),i="toggleExecutorSelector",e.data(i)?this:(e.data(i,!0),null!=(n=this.executorSelectorView)&&n.remove(),this.executorSelectorView=this.requestSubView(d,{fixed:this.$el.closest(".panel-view").length,$toggler:e,noAssign:!0,membersCollection:this.membersCollection,selected:[this.taskModel.get("_executorId")],select:function(t){return function(e){var i;return i=e[0],t.taskModel.save(null,{attrs:{_executorId:i||null}})}}(this)}).show(),this)},e.prototype.togglePrioritySelector=function(t){var e,i,n;return e=$(t.currentTarget),i="togglePrioritySelector",e.data(i)?this:(e.data(i,!0),null!=(n=this.prioritySelectorView)&&n.remove(),this.prioritySelectorView=this.requestSubView(m,{$toggler:e,width:170,dataList:P.getPriorities(),selected:this.taskModel.get("priority"),ListTemplate:g,select:function(t){return function(e){return t.taskModel.save(null,{attrs:{priority:e}})}}(this)}).show(),this)},e.prototype.toggleRepeatSelector=function(t){var e,i,n;return e=$(t.currentTarget),i="toggleRepeatSelector",e.data(i)?this:(e.data(i,!0),null!=(n=this.repeatSelectorView)&&n.remove(),this.repeatSelectorView=this.requestSubView(f,{$toggler:e,recurrence:this.taskModel.get("recurrence"),select:function(t){return function(e){return t.taskModel.save("recurrence",e)}}(this)}).show(),this)},e.prototype.close=function(){var t,e;return"taskDetailPanel"===(null!=(e=this.parentView)?e.viewName:void 0)?"function"==typeof(t=this.parentView).back&&t.back():this.remove(),this},e.prototype.remove=function(){var t,i,n,r,o,s;return null!=(t=this.$noteEditContent)&&t.off("change"),null!=(i=this.$priority)&&i.off(".task-detail"),null!=(n=this.$repeat)&&n.off(".task-detail"),null!=(r=this.$activityCreator)&&r.remove(),this.unactiveTaskCard(),this.taskModel&&(s=N.router.getUrl().replace("/task/"+this.taskModel.id,""),N.router.navigate(s,{trigger:!1})),"ObjectModalView"===(null!=(o=this.parentView)?o.viewName:void 0)&&this.parentView.remove(),e.__super__.remove.apply(this,arguments)},e.prototype.activeTaskCard=function(){return this.unactiveTaskCard(),$(".task[data-id="+this._taskId+"]").addClass("active-task-detail"),this},e.prototype.unactiveTaskCard=function(){return $(".active-task-detail").removeClass("active-task-detail"),this},e}(D),e.Constructor=M},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w=function(t,e){function i(){this.constructor=t}for(var n in e)_.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},_={}.hasOwnProperty;b=i(358),k=i(678),s=i(401),h=i(681),y=i(677),l=i(697),u=i(993),g=i(995),p=i(696),d=i(992),f=i(994),v=i(996),a=i(1021),c=i(813),n=i(1287),r=i(1288),o=i(1289),t.exports=m=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.viewName="TaskMenuView",e.prototype.className="task-menu-view",e.prototype.popoverTitle="",e.prototype.events={"click .copy-task-handler":"enterCopySubMenu","click .favorite-task-handler":"favoriteTask","click .move-task-handler":"enterMoveSubMenu","click .archive-task-handler":"archiveTask","click .delete-task-handler":"enterDeleteSubMenu","click .select-project":"selectProject","click .select-tasklist":"selectTasklist","click .select-stage":"selectStage","click .copy-or-move-task button":"submitCopyOrMove","click .switch-visible-handler":"switchVisible","click .task-menu-check-handler":"toggleLink","submit .delete-form":"submitDeleteForm"},e.prototype.initialize=function(t){if(!t._projectId)throw new Error("task menu error:should has _projectId in options");return this.popoverTitle=tb_i18n.get("task.menu.title"),this.localCache=h.namespace("temp").namespace("task_menu"),this.localCacheId=k.user.id,this._projectId=t.taskModel.get("_projectId"),e.__super__.initialize.apply(this,arguments)},e.prototype.onShown=function(){return e.__super__.onShown.apply(this,arguments),this.listen()},e.prototype.render=function(){var t;return t=b.extend(this.options.taskModel.toJSON(),{permissions:this.options.taskModel.hasPermissions("put","put.move","put.archive","put.visible","del")}),this.$el.html(n(t)),this.triggerHook("render"),this.assembleData(),this},e.prototype.listen=function(){return this.listenTo(this.projectsCollection,"add change remove destroy",function(){var t;return null!=(t=this.projectMenuView)?t.update(this.getProjectsDataList()).filterData():void 0})},e.prototype.assembleData=function(){var t,e,i,n,r;return t=this.localCache(this.localCacheId)||{},this.options.taskModel.hasPermission("objectlink.post")&&(this.isLink=t.isLink,this.isLinked=t.isLinked),this.projectsCollection=p.get(0),e=(null!=(i=this.projectsCollection.get(t._projectId))?i.get("_roleId"):void 0)>=0?t._projectId:this.options.taskModel.get("_projectId"),r=t._tasklistId,r||e!==this.options.taskModel.get("_projectId")||(r=this.options.taskModel.get("_tasklistId")),this.projectModel=l.find(e),this.tasklistModel=g.find(r)||(null!=(n=this.tasklistsCollection)?n.at(0):void 0),this.tasklistsCollection||f.fetch(e,{success:function(t){return function(e){return t.tasklistsCollection=e,t.tasklistModel=e.models[0]}}(this)}),this.stageModel=u.find(t._stageId)},e.prototype.renderPopover=function(){switch(this.forkOrMove){case"fork":return this.renderCopyPopover();case"move":return this.renderMovePopover()}},e.prototype.renderCopyPopover=function(){return this.enterSubMenu(tb_i18n.get("task.menu.copy"),function(t){return function(){return t.$el.html(r({isCopy:!0,isTasklistEnabled:t.isTasklistEnabled(),permissions:t.options.taskModel.hasPermissions("objectlink.post"),title:tb_i18n.get("copyTo"),tips:tb_i18n.get("task.menu.copy.tips")})),t.$projectName=t.$(".project-name"),t.$tasklistName=t.$(".tasklist-name"),t.$stageName=t.$(".stage-name"),t.$submit=t.$(".btn-primary"),t.$warning=t.$(".warning"),t.checkStatus(),t.forkOrMove="fork"}}(this)),this},e.prototype.renderMovePopover=function(){return this.enterSubMenu(tb_i18n.get("task.menu.move"),function(t){return function(){return t.$el.html(r({isTasklistEnabled:t.isTasklistEnabled(),title:tb_i18n.get("moveTo"),tips:tb_i18n.get("task.menu.move.tips")})),t.$projectName=t.$(".project-name"),t.$tasklistName=t.$(".tasklist-name"),t.$stageName=t.$(".stage-name"),t.$submit=t.$(".btn-primary"),t.$warning=t.$(".warning"),t.checkStatus(),t.forkOrMove="move"}}(this)),this},e.prototype.archiveTask=function(){return this.options.taskModel.archive({success:function(t){return function(){return s.show({message:tb_i18n.get("archived.task.success"),status:"success"}),t.remove()}}(this)}),this},e.prototype.enterDeleteSubMenu=function(){return this.enterSubMenu(tb_i18n.get("task.menu.delete.title"),function(t){return function(){return t.$el.html(o())}}(this)),this},e.prototype.enterCopySubMenu=function(){return this.resetSelectMenu().renderCopyPopover()},e.prototype.enterMoveSubMenu=function(){return this.resetSelectMenu().renderMovePopover()},e.prototype.favoriteTask=function(){var t;return t=this.options.taskModel.get("isFavorite"),this.options.taskModel[t?"unFavorite":"doFavorite"]({success:function(t){return function(e){var i;if(t.options.taskModel.set("isFavorite",e.isFavorite),t.render(),!e.isFavorite&&t.options.onUnfavorite)return"function"==typeof(i=t.options).onUnfavorite&&i.onUnfavorite(t.options.taskModel.get("_id")),t.parentView.close()}}(this)}),this},e.prototype.resetSelectMenu=function(){var t,e;return null!=(t=this.tasklistMenuView)&&t.remove(),this.tasklistMenuView=null,null!=(e=this.stageMenuView)&&e.remove(),this.stageMenuView=null,this.assembleData(),this},e.prototype.getProjectsDataList=function(){return this.projectsCollection.filter(function(t){return t.getRoleScope()>=0}).map(function(t){return{_id:t.get("_id"),title:t.get("name"),pinyin:t.get("pinyin")}})},e.prototype.selectProject=function(t){var e,i;if(e=$(t.currentTarget),!e.data("bs.popover"))return this.projectMenuView=this.requestSubView(a,{container:this.$el,$toggler:e,searchPlaceholder:tb_i18n.get("task.menu.search.project"),dataList:this.getProjectsDataList(),selected:(null!=(i=this.projectModel)?i.id:void 0)||"",select:function(t){return function(e){var i,n,r;return e!==(null!=(i=t.projectModel)?i.id:void 0)&&(t.projectModel=t.projectsCollection.get(e),t.stageModel=null,t.cacheData(),null!=(n=t.tasklistMenuView)&&n.remove(),t.tasklistMenuView=null,null!=(r=t.stageMenuView)&&r.remove(),t.stageMenuView=null,t.setTasklistModel(e)),t.checkStatus()}}(this)}).show(),this},e.prototype.selectTasklist=function(t){var e,i;if(this.projectModel&&(e=$(t.currentTarget),!e.data("bs.popover")))return this.tasklistMenuView=this.requestSubView(a,{container:this.$el,$toggler:e,dataList:[],selected:(null!=(i=this.tasklistModel)?i.id:void 0)||"",select:function(t){return function(e){var i,n;return e!==(null!=(i=t.tasklistModel)?i.id:void 0)&&(t.tasklistModel=t.tasklistsCollection.get(e),t.stageModel=null,t.cacheData(),null!=(n=t.stageMenuView)&&n.remove(),t.stageMenuView=null,t.renderPopover()),t.checkStatus()}}(this)}).show(),this.tasklistMenuView.update([]),f.fetch(this.projectModel.id,{success:function(t){return function(e){return t.tasklistsCollection=e,t.tasklistMenuView.update(e.map(function(t){return{_id:t.get("_id"),title:t.get("title")}}))}}(this)}),this},e.prototype.selectStage=function(t){var e;if(this.tasklistModel&&(e=$(t.currentTarget),!e.data("bs.popover")))return this.stageMenuView=this.requestSubView(a,{container:this.$el,$toggler:e,dataList:[],selected:"",select:function(t){return function(e){var i;return e!==(null!=(i=t.stageModel)?i.id:void 0)&&(t.stageModel=t.stagesCollection.get(e),t.cacheData(),t.renderPopover()),t.checkStatus()}}(this)}).show(),this.stageMenuView.update([]),d.fetch(this.tasklistModel.id,{success:function(t){return function(e){return t.stagesCollection=e,t.stageMenuView.update(e.map(function(t){return{_id:t.get("_id"),title:t.get("name")}}))}}(this)}),this},e.prototype.switchVisible=function(t){var e;return e=$(t.currentTarget),this.options.taskModel.saveAttr("visible",e.data("type"),{success:function(t){return function(){return t.render()}}(this)}),this},e.prototype.toggleLink=function(t){var e,i;return e=$(t.currentTarget),i=e.data("type"),"link"===i?this.isLink=!this.isLink:"linked"===i&&(this.isLinked=!this.isLinked),this.cacheData(),this.checkStatus(),this},e.prototype.checkStatus=function(){var t,e,i;return this.$projectName.text((null!=(t=this.projectModel)?t.get("name"):void 0)||tb_i18n.get("task.menu.select.project")),this.$tasklistName.text((null!=(e=this.tasklistModel)?e.get("title"):void 0)||tb_i18n.get("task.menu.select.group")),this.$stageName.text((null!=(i=this.stageModel)?i.get("name"):void 0)||tb_i18n.get("task.menu.select.stage")),this.$(".task-menu-check-handler[data-type=link]")[this.isLink?"addClass":"removeClass"]("active"),this.$(".task-menu-check-handler[data-type=linked]")[this.isLinked?"addClass":"removeClass"]("active"),this.disableSubmit(!(this.projectModel&&this.tasklistModel&&this.stageModel)),this},e.prototype.disableSubmit=function(t){return this.$submit[t?"addClass":"removeClass"]("is-disabled"),this},e.prototype.submitCopyOrMove=function(t){return this.$submit.hasClass("is-disabled")?(this.$warning.addClass("is-shown"),void b.delay(function(t){return function(){return t.$warning.removeClass("is-shown")}}(this),1500)):"move"===this.forkOrMove&&this.stageModel.id===this.options.taskModel.get("_stageId")?this.hide():null==this.tasklistsCollection.get(this.tasklistModel.id)?(this.render(),void s.show({message:tb_i18n.get("stage.selector.changed.tips"),status:"warning"})):(this.disableSubmit(!0),"fork"===this.forkOrMove&&k.gta.event({action:"added content",type:"task",control:"More Menu"}),this.options.taskModel.forkOrMove(this.forkOrMove,this.stageModel.id,{attrs:{doLink:this.isLink,doLinked:this.isLinked},success:function(t){return function(e){var i;return y.message({tips:"fork"===t.forkOrMove?tb_i18n.get("task.menu.copy.success"):tb_i18n.get("task.menu.move.success"),url:"/project/"+e._projectId+"/tasks/scrum/"+e._tasklistId+"/task/"+e._id,title:t.options.taskModel.get("content")}),"fork"===t.forkOrMove?null!=(i=v.find(t.stageModel.id))&&i.add(e):t.options.taskModel.set(e),t.remove()}}(this),error:function(t){return function(){return t.disableSubmit(!1),s.show({message:"fork"===t.forkOrMove?tb_i18n.get("task.menu.copy.fail"):tb_i18n.get("task.menu.move.fail"),status:"error"})}}(this)}))},e.prototype.submitDeleteForm=function(t){return t.preventDefault(),this.options.taskModel.destroy({success:function(t){return function(){return s.show({message:tb_i18n.get("delete.success"),status:"success"}),t.remove(),k.APP.hidePanel()}}(this)}),this},e.prototype.cacheData=function(){var t,e,i,n;return t={_projectId:null!=(e=this.projectModel)?e.get("_id"):void 0,_stageId:null!=(i=this.stageModel)?i.get("_id"):void 0,_tasklistId:null!=(n=this.tasklistModel)?n.get("_id"):void 0},this.options.taskModel.hasPermission("objectlink.post")&&(t.isLink=this.isLink,t.isLinked=this.isLinked),this.localCache(this.localCacheId,t),this},e.prototype.setTasklistModel=function(t){return f.fetch(t,{success:function(t){return function(e){return t.tasklistsCollection=e,t.tasklistModel=e.at(0),t.renderPopover()}}(this)})},e.prototype.isTasklistEnabled=function(){return this.tasklistsCollection.length>1||this.projectModel.isAppEnabled("tasklist")},e}(c)},function(t,e){t.exports=function(t){var e='<ul class="list task-menu-list"> <li> <a class="copy-task-handler" data-gta="{action: \'add content\', type: task, control: \'More Menu\'}"> <span class="icon icon-copy-task"></span>'+tb_i18n.get("task.menu.copy")+" </a> </li> ";return t.permissions.putMove&&(e+=' <li> <a class="move-task-handler" data-gta="{action: \'move content\', type: task, control: \'More Menu\'}"> <span class="icon icon-move-task"></span>'+tb_i18n.get("task.menu.move")+" </a> </li> "),e+=' <li> <a class="favorite-task-handler" data-gta="{action: \'add to favourite\', type: task, control: \'More Menu\'}"> <span class="icon icon-favorite ',t.isFavorite&&(e+="favorited"),e+='"></span>',e+=t.isFavorite?""+tb_i18n.get("unfavorite"):""+tb_i18n.get("favorite")+tb_i18n.get("navigation.task"),e+=" </a> </li> ",t.permissions.putArchive&&(e+=" <li> ",e+=t.isArchived?' <a class="unarchive-task-handler" data-gta="{action: \'unarchive task\', type: task, control: \'More Menu\'}"> <span class="icon icon-archive"></span>'+tb_i18n.get("unarchive")+" </a> ":' <a class="archive-task-handler" data-gta="{action: \'archive\', type: task, control: \'More Menu\'}"> <span class="icon icon-archive"></span>'+tb_i18n.get("archive.task")+" </a> ",e+=" </li> "),e+=" ",t.permissions.del&&(e+=' <li> <a class="delete-task-handler" data-gta="{action: \'delete content\', type: task, control: \'More Menu\'}"> <span class="icon icon-trash"></span>'+tb_i18n.get("task.menu.delete.title")+" </a> </li> "),e+=" ",t.permissions.putVisible&&(e+=' <li class="divider"></li> <li> ',"members"==t.visible||"all"==t.visible?e+=' <a class="switch-visible-handler" data-type="involves" data-gta="{action: \'toggle visible\', type: task, control: \'More Menu\'}"> <div class="main-mode"> <span class="icon icon-unlock"></span> <span class="mode">'+tb_i18n.get("visible.mode")+'</span> <span class="ifClose">'+tb_i18n.get("visible.close")+'</span> </div> <span class="mode-explanation">'+tb_i18n.get("visible.to.member")+"</span> </a> ":"involves"==t.visible&&(e+=' <a class="switch-visible-handler" data-type="members" data-gta="{action: \'toggle visible\', type: task, control: \'More Menu\'}"> <div class="main-mode"> <span class="icon icon-lock"></span> <span class="mode">'+tb_i18n.get("visible.mode")+'</span> <span class="ifClose">'+tb_i18n.get("visible.open")+'</span> </div> <span class="mode-explanation">'+tb_i18n.get("visible.to.involve")+"</span> </a> "),e+=" </li> "),e+="</ul>"}},function(t,e){t.exports=function(t){var e='<div class="copy-or-move-task"> <p class="menu-title muted">'+t.title+'</p> <div class="task-select"> <span class="select-label">'+tb_i18n.get("project")+'</span> <a class="select-project"> <span class="project-name choose-name">'+tb_i18n.get("task.menu.select.project")+'</span> <span class="icon icon-chevron-down"></span> </a> </div> ';return t.isTasklistEnabled&&(e+=' <div class="task-select"> <span class="select-label">'+tb_i18n.get("task.group")+'</span> <a class="select-tasklist"> <span class="tasklist-name choose-name">'+tb_i18n.get("task.menu.select.group")+'</span> <span class="icon icon-chevron-down"></span> </a> </div> '),e+=' <div class="task-select"> <span class="select-label">'+tb_i18n.get("stage")+'</span> <a class="select-stage"> <span class="stage-name choose-name">'+tb_i18n.get("task.menu.select.stage")+'</span> <span class="icon icon-chevron-down"></span> </a> </div> ',t.isCopy&&t.permissions.objectlinkPost&&(e+=' <div class="task-menu-check-set"> <div class="task-menu-check"> <a class="task-menu-check-handler" data-type="link"> <div class="check-box pull-left"> <span class="icon icon-tick"></span> </div> <span>'+tb_i18n.get("task.menu.copy.check.link")+'</span> </a> </div> <div class="task-menu-check"> <a class="task-menu-check-handler"  data-type="linked"> <div class="check-box pull-left"> <span class="icon icon-tick"></span> </div> <span>'+tb_i18n.get("task.menu.copy.check.linked")+"</span> </a> </div> </div> "),e+=' <p class="menu-tips muted">'+t.tips+'</p> <div class="warning">'+tb_i18n.get("task.menu.warning")+'</div> <button class="btn btn-primary" type="submit">'+tb_i18n.get("confirm")+"</button></div>"}},function(t,e){t.exports=function(t){var e='<form class="delete-form"> <p>'+tb_i18n.get("task.menu.confirm.delete")+'</p> <button class="btn btn-danger" type="submit">'+tb_i18n.get("delete")+"</button></form>";return e}},function(t,e){t.exports=function(t){var e='<section class="detail-content scrollable thin-scroll"> <div class="task-detail-header-wrap"></div> <div class="task-detail-handlers-wrap"></div> <div class="task-detail-infos-wrap"></div> <section class="detail-activities-wrap"></section></section><footer class="activity-creator-wrapper"></footer>';return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="archived-wrapper"></div><div class="task-detail-header detail-header-card"> ';return t.isGhost||(i+=' <a class="menu-handler"> '+tb_i18n.get("more")+' <span class="icon icon-chevron-down"></span> </a> '),i+=' <div class="task-tasklist-stage-wrap"> ',t.isTasklistEnabled&&(i+=' <span class="tasklist-title">'+tb_i18n.get("task.detail.tasklist")+"</span> ",i+=t.permissions.putMove?' <a class="task-detail-tasklist" data-gta="{action: \'move tasklist\'}">'+e(t.tasklistName)+"</a> ":' <span class="task-detail-tasklist">'+e(t.tasklistName)+"</span> ",i+=" <span>"+tb_i18n.get("comma")+"</span> "),i+=' <span class="stage-title">'+tb_i18n.get("task.detail.stage")+"</span> ",i+=t.permissions.putMove?" <a class=\"task-detail-stage\" data-gta=\"{action: 'move content', type: 'task', control: 'Task Editor'}\">"+e(t.stageName||tb_i18n.get("task.detail.stage.unset"))+"</a> ":' <span class="task-detail-stage">'+e(t.stageName||tb_i18n.get("task.detail.stage.unset"))+"</span> ",i+=' </div> <div class="task clearfix ',t.isDone&&(i+="done"),i+='"> ',t.permissions.putStatus?(i+=' <a class="check-box hinted" data-title="',i+=t.isDone?""+tb_i18n.get("task.detail.redo"):""+tb_i18n.get("task.detail.complete"),i+='" data-gta="{action: \'toggle complete task\', page: \'Task Detail Page\'}"> <span class="icon icon-tick"></span> </a> '):i+=' <div class="check-box non-checkable cursor-not-allowed" data-gta="{action: \'toggle complete task\'}"> <span class="icon icon-tick"></span> </div> ',i+=' <span class="task-id-placeholder"></span> ',i+=t.permissions.put?' <div class="task-content-input hinted" data-gta="{action: \'edit title\'}" contenteditable data-title="'+tb_i18n.get("clickToEdit")+'"> '+e(t.content)+" </div> ":' <div class="task-content-input"> '+e(t.content)+" </div> ",i+=" </div></div>"}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="detail-white-card task-detail-handler-wrap"> <div class="task-detail-handler-set ';t.isStartTimeEnable||(i+="four-items"),i+='"> <div class="task-detail-handler"> <h6 class="task-info-title">'+tb_i18n.get("task.detail.executor")+"</h6> ",t.executor?(i+=" ",i+=t.permissions.putExecutor?' <a class="task-detail-executor" data-gta="{action: \'select assignee\', type: \'task\'}"> <div class="task-detail-handler-icon avatar img-24 img-circle" style="background-image: url('+t.executor.avatarUrl+')"></div> '+e(t.executor.name)+" </a> ":' <span class="task-detail-executor cursor-not-allowed"> <div class="task-detail-handler-icon avatar img-24 img-circle" style="background-image: url('+t.executor.avatarUrl+')"></div> '+e(t.executor.name)+" </span> ",i+=" "):(i+=" ",i+=t.permissions.putExecutor?' <a class="task-detail-executor dirty" data-gta="{action: \'select assignee\', type: \'task\'}"> <div class="task-detail-handler-icon avatar img-24 img-circle no-avatar"></div> '+tb_i18n.get("task.detail.no.executor")+" </a> ":' <span class="task-detail-executor dirty cursor-not-allowed"> <div class="task-detail-handler-icon avatar img-24 img-circle no-avatar"></div> '+tb_i18n.get("task.detail.no.executor")+" </span> ",i+=" "),i+=" </div> ";var n=t.dateItems;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <div class="task-detail-handler"> <h6 class="task-info-title">'+r.title+'</h6> <div class="task-detail-handler-body task-detail-date ',r.hasPermission||(i+="cursor-not-allowed"),i+='"> <a class="task-datepicker ',r.dateString||(i+="dirty"),i+=" ",r.hasPermission||(i+=" cursor-not-allowed ban"),i+='" data-type="'+r.type+'" data-gta="{action: \'edit ',i+="startDate"===r.type?"start ":"due ",i+="date', type: 'task' ",t.projectId&&(i+=", projectid: '"+t.projectId+"'"),t.orgId&&(i+=", organizationid: '"+t.orgId+"'"),i+='}}"> <span class="icon icon-calendar2"></span> <span>'+(r.dateString||r.hint)+"</span> </a> ",t.preciseDate&&r.timeString&&(i+=' <a class="task-timepicker ',r.hasPermission||(i+="cursor-not-allowed ban"),i+='" data-type="'+r.type+'" data-gta="{action: \'edit ',i+="startDate"===r.type?"start ":"due ",i+="time', type: 'task' ",t.projectId&&(i+=", projectid: '"+t.projectId+"'"),t.orgId&&(i+=", organizationid: '"+t.orgId+"'"),i+='}}"> <span>'+r.timeString+"</span> </a> "),i+=" </div> </div> ";return t.isStartTimeEnable&&(i+=' </div></div><div class="detail-white-card task-detail-handler-wrap"> <div class="task-detail-handler-set">'),i+=' <div class="task-detail-handler"> <h6 class="task-info-title">'+tb_i18n.get("task.detail.priority")+"</h6> ",t.permissions.put?(i+=' <a class="task-detail-priority ',t.priorityTitle||(i+="dirty"),i+="\" data-gta=\"{action: 'select priority', type: 'task'}\"> <span class=\"icon icon-circle priority-label ",t.priority&&(i+="color-priority-"+t.priority),i+='"></span> <span class="priority-title">'+(t.priorityTitle||tb_i18n.get("priority.none"))+"</span> </a> "):(i+=' <span class="task-detail-priority ',t.priorityTitle||(i+="dirty"),i+=' cursor-not-allowed"> <span class="icon icon-circle priority-label ',t.priority&&(i+="color-priority-"+t.priority),i+='"></span> <span class="priority-title">'+(t.priorityTitle||tb_i18n.get("priority.none"))+"</span> </span> "),i+=' </div> <div class="task-detail-handler repeat-menu-wrap ',t.isStartTimeEnable&&(i+="expand"),i+='"> <h6 class="task-info-title">'+tb_i18n.get("task.detail.repeat")+"</h6> ",t.permissions.put?(i+=' <a class="task-detail-repeat ',t.repeatTitle||(i+="dirty"),i+=" hinted\" data-gta=\"{action: 'set repeat', type: 'task'}\" data-title=\""+(t.repeatTitle||tb_i18n.get("repeat.freq.NO"))+'"> <span class="icon icon-repeat"></span> <span class="repeat-title">'+(t.repeatTitle||tb_i18n.get("repeat.freq.NO"))+"</span> </a> "):(i+=' <span class="task-detail-repeat ',t.repeatTitle||(i+="dirty"),i+=' cursor-not-allowed hinted" data-title="'+(t.repeatTitle||tb_i18n.get("repeat.freq.NO"))+'"> <span class="icon icon-repeat"></span> <span class="repeat-title">'+(t.repeatTitle||tb_i18n.get("repeat.freq.NO"))+"</span> </span> "),i+=" </div> </div></div>"}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t.dataList;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li class="task-detail-priority menu-item ',r.selected&&(i+="selected"),i+='" data-id="'+r._id+'"> <a><span class="icon icon-circle color-priority-'+r._id+'"></span>'+e(r.title)+"</a></li>";return i}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="object-nav"> ',n=t;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <a class="btn url-handler" href="'+r.url+'" data-gta="event" data-label="'+(0==o?"inbox|goto project":"inbox|goto app")+'">'+e(r.title)+"</a> ";return i+="</div>"}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;a=i(358),c=i(678),s=i(686),n=i(685),o=i(1296),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.name="messages",e.prototype.model=o,e.prototype.type="normal",e.prototype.pageNum=20,e.prototype.comparator=null,e.prototype.listen=function(){if(e.__super__.listen.apply(this,arguments),
!this._messageCollectionlistened)return this._messageCollectionlistened=!0,s.on("all",function(t){return function(e,i){var n,r;if(r=/\:change\:message\/(\w{24})/.exec(e),n=r&&r[1],n&&"pm"!==i.msgType&&!t.get(r[1]))return t.fetchOne(r[1])}}(this)),s.on(":change:"+this.name,function(t){return function(e){if("readAll:"+t.type===e)return t.markAllRead()}}(this)),s.on(":remove:"+this.name,function(t){return function(e){if("removeAll:"+t.type===e)return t.removeAllRead()}}(this))},e.prototype.parse=function(t){return a.isArray(t)||(t=[t]),t.filter(function(t){return"room"!==t.objectType})},e.prototype.fetch=function(t){return null==t&&(t={}),t.url="v2/"+this.name,t.attrs||(t.attrs={}),t.attrs.type=this.onlyMentions?[this.type,"ated"]:this.type,e.__super__.fetch.call(this,t)},e.prototype.fetchOne=function(t,i){return null==i&&(i={}),i.url="v2/"+this.name,e.__super__.fetchOne.call(this,t,i)},e.prototype.sync=function(t,i,n){switch(n||(n={}),t){case"delete":n.success=function(t){return function(){return t.remove(t.getReaded())}}(this)}return e.__super__.sync.apply(this,arguments)},e.prototype.readAll=function(){var t;if(this.getUnread().length)return t={type:this.onlyMentions?[this.type,"ated"]:this.type},this.sync("update",this,{url:"messages/markallread",attrs:t,success:function(t){return function(){return t.markAllRead()}}(this)})},e.prototype.markAllRead=function(){var t;return t={isRead:!0,unreadActivitiesCount:0},this.each(function(e){return e.set(t)})},e.prototype.removeAllRead=function(){var t;return t=this.filter(function(t){return!t.get("isRead")}),this.set(t,{reset:!0})},e.prototype.getUnreadCount=function(){return this.reduce(function(t,e){return t+e.get("unreadActivitiesCount")},0)},e.prototype.getUnarchivedCount=function(){return this.where({isArchived:!1}).length},e.prototype.getUnarchived=function(){return this.where({isArchived:!1})},e.prototype.getUnread=function(){return this.where({isRead:!1})},e.prototype.getReaded=function(){return this.where({isRead:!0})},e.prototype.archiveRead=function(t){return null==t&&(t={}),this.onlyMentions?t.url="messages?type="+this.type+"&type=ated":t.url="messages?type="+this.type,this.sync("delete",this,t),this},e.prototype.remove=function(t){return"all"===t?this.remove(this.getReaded()):e.__super__.remove.apply(this,arguments)},e}(n)},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;s=i(358),a=i(678),r=i(688),o=i(677),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.name="message",e.prototype.urlRoot="messages",e.prototype.isReading=!1,e.prototype.parse=function(t){return t.mentions||(t.mentions={}),t=s.extend(this.toJSON(),t),t.inboxIgnore="home"===t.type,t.inboxIgnore?t.unreadActivitiesCount=0:"system"!==t.type||t.isRead||(t.unreadActivitiesCount=1),this.response=t,t},e.prototype.archive=function(){return this.has("isPseudo")&&this.get("isPseudo")?this.collection.removePseudoMessage(this):(this.set({isRead:!0,isArchived:!0,unreadActivitiesCount:0}),this.destroy())},e.prototype.markRead=function(){var t;if(!this.get("isRead")||this.get("unreadActivitiesCount"))return t={isRead:!0,unreadActivitiesCount:0},this.save(t,{attrs:t})},e.prototype.markLater=function(t,e){var i;return i={isLater:t,reminderDate:e?e:void 0},this.save(i,{url:this.urlRoot+"/"+this.id+"/later",attrs:i})},e.prototype.genMessage=function(){var t;return this.set("creator",this.response.creator),t=this.toJSON(),t.title=this.parseString(t.content||t.note||t.title),t.boundToObjectType=t.boundToObjectType||t.objectType,t.creator||(t.creator={name:"",avatarUrl:""}),t},e.prototype.parseString=function(t){return t=$("<div>"+t+"</div>").text(),t=o.cutString(t,100,"..."),t=s.unescape(t)},e.prototype.getModelId=function(){return this.has("project")?this.get("project")._id:this.has("creator")?this.get("creator")._id:void 0},e.prototype.isValid=function(){return!this.get("isArchived")&&!this.get("inboxIgnore")},e.prototype.isReaded=function(){return this.isValid()&&this.get("isRead")&&0===this.get("unreadActivitiesCount")},e.prototype.isUnread=function(){return this.isValid()&&!this.get("isRead")||this.get("unreadActivitiesCount")>0},e.prototype.onRead=function(){var t;if(!this.isReading)return this.isUnread()?(this.isReading=!0,t={isRead:!0,unreadActivitiesCount:0},this.save(t,{attrs:t,complete:function(t){return function(){return t.isReading=!1}}(this)})):void 0},e.prototype.onRemove=function(){return this.set({isRead:!0,isArchived:!0,unreadActivitiesCount:0}),this.destroy()},e.prototype.getTargetId=function(){return this.has("project")?this.get("project")._id:this.has("creator")?this.get("creator")._id:null},e}(r)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m=function(t,e){function i(){this.constructor=t}for(var n in e)f.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},f={}.hasOwnProperty;d=i(358),h=i(678),a=i(1298),c=i(1391),o=i(1424),p=i(1454),u=i(788),l={position:"absolute",right:"-100%"},n=$("body"),r=$(window),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.viewName="FloatView",e.prototype.hotkeys={i:"toggleInbox",c:"toggleCalendar",m:"toggleMy",s:"enterSearch",esc:function(t){return t.preventDefault(),this.close()}},e.prototype.disableFloat=!1,e.prototype.open=function(t,e,i){if(!this.disableFloat&&!h.user.get("isGhost"))return h.APP.hidePanel(),e=d.extend({animateType:"slide"},e||{}),this.currentView instanceof t?(this.currentView.remove(),this.currentView=this._currentView=this.requestSubView(t,e),this.currentView.$el.appendTo(n),h.APP.setDataCategory(i)):this._closeView(function(n){return function(){return n.currentView=n.requestSubView(t,e),n.animate(n.currentView.$el,"open",function(){var t;return"function"==typeof(t=n.currentView).onOpen&&t.onOpen(),"function"==typeof e.onOpen?e.onOpen():void 0}),h.APP.setDataCategory(i)}}(this)),this},e.prototype._closeView=function(t){var e,i,n;return h.APP.setDataCategory(),this.currentView?(i=this.prevView=this.currentView,e=this.$container,null!=(n=this.prevView)&&"function"==typeof n.beforeClose&&n.beforeClose(),this.animate(i.$el,"close",function(){return null!=i&&"function"==typeof i.remove&&i.remove(),null!=e&&"function"==typeof e.remove&&e.remove(),"function"==typeof t?t():void 0})):"function"==typeof t&&t(),this},e.prototype.close=function(t){if(!this.disableFloat)return h.APP.hidePanel(),this._closeView(function(e){return function(){return e.currentView=e.prevView=e._currentView=null,"function"==typeof t?t():void 0}}(this)),this},e.prototype.toggle=function(t,e,i){var n;if(!this.disableFloat)return e||(e={}),n=e.isSame||function(e){return function(){return e.currentView instanceof t}}(this),n=n(),n?this.close():this.open(t,e,i),!n},e.prototype.toggleMy=function(t){return this.toggle(c,t,"my")},e.prototype.enterSearch=function(){return $("#navigator .nav-footer-handler[data-mark=search]").click()},e.prototype.toggleCalendar=function(t){return this.toggle(o,t,"calendar")},e.prototype.toggleInbox=function(t){return this.toggle(a,t,"inbox")},e.prototype.animate=function(t,e,i){return"open"===e?this.animate_open(t,e,i):this.animate_close(t,e,i)},e.prototype.animate_open=function(t,e,i){var o,s;switch(n.addClass("float-open"),$("#navigator .projects-handler").removeClass("active"),$("#navigator .organization-switcher-handler").removeClass("active"),o=this.currentView.options.animateType){case"slide":return s=-r.height(),t.transition({y:s},0),t.appendTo(n),t.transition({y:0},300,"ease",function(){return t.transition({y:.01*s},80,function(){return t.transition({y:0},40,function(){return"function"==typeof i?i():void 0})})});case"fade":return t.appendTo(n),t.fadeIn(218,function(){return"function"==typeof i?i():void 0})}},e.prototype.animate_close=function(t,e,i){var o,s,a,c,l,p;if(o=(null!=(a=this._currentView)&&null!=(c=a.options)?c.animateType:void 0)||!1,s=(null!=(l=this.prevView)&&null!=(p=l.options)?p.animateType:void 0)||!1,"projects"===h.router.getUrl().split("/")[0]&&$("#navigator .projects-handler").addClass("active"),"organization"===h.router.getUrl().split("/")[0]&&$("#navigator .organization-switcher-handler").addClass("active"),s!==o&&s&&o)return n.removeClass("float-open"),"function"==typeof i?i():void 0;switch(s){case"slide":return t.transition({y:-r.height()},300,"snap",function(){return n.removeClass("float-open"),"function"==typeof i?i():void 0});case"fade":return t.fadeOut(218,function(){return n.removeClass("float-open"),"function"==typeof i?i():void 0})}},e.prototype.remove=function(){return n.removeClass("float-open"),e.__super__.remove.apply(this,arguments)},e}(u)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S,I,z,P,D,O=function(t,e){function i(){this.constructor=t}for(var n in e)N.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},N={}.hasOwnProperty,E=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};P=i(358),D=i(678),j=i(797),T=i(1299),S=i(677),p=i(680),I=i(788),g=i(688),h=i(1296),w=i(697),n=i(799),f=i(1295),v=i(684),_=i(696),d=i(699),o=i(976),c=i(795),l=i(1228),m=i(1300),b=i(1277),k=i(982),M=i(1304),C=i(1285),z=i(786),x=i(1385),r=i(1387),a=i(1388),s=i(1389),y=i(1390),u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return O(e,t),e.prototype.viewName="InboxView",e.prototype.className="inbox-view",e.prototype.events={"click .new-messages-handler":"showNew","click .all-messages-handler":"showAll","click .inbox-footer":"clear","click .messages-ordinary":"showOrdinaryMessages","click .messages-snoozed":"showSnoozedyMessages","click .clear-readed-handler":"clearReadMessages","click .read-all-handler":"readAllMessages","click .message-view":"showMessageDetail","click .preference-handler":"showPreferences","click .inbox-type-display":"renderDropdown","click .only-mentions":"toggleOnlyMentions"},e.prototype.hotkeys={j:"selectNext",k:"selectPrev"},e.prototype.initialize=function(t){return this.options=t||{},this.collection=f.get(D.user.id),this.statistics=[],this.projectsCollection=_.get(0),this.collection.type=t._type||"normal",this.unreadModel=new g({normal:!1,later:!1}),this.renderBasic().renderPlaceholder().renderDropdown(),this.setupScroll(this.$messageScroll),this.showLoadingIndicator(this.$messages,{isPrepend:!0}),this.load({remove:!1,silent:!0,success:function(e){return function(){if(e.collection.forEach(function(t){return e.statistics.push(t.id),D.gta.event({action:"receive message",category:t.get("latestActivityAction")||"null"})}),e.$el)return e.hideLoadingIndicator({animated:!0}),e.renderMessages(),t._messageId&&e.showMessageDetail(t._messageId),!e.options._messageId&&e.options._boundToObjectId&&e.showMessageDetailByObjectId(e.options._boundToObjectId),e.listen(),e.syncUnread()}}(this)}),$("#navigator .inbox-handler").addClass("active"),this},e.prototype.listen=function(){var t;return this.listenTo(this.unreadModel,"change",this.renderDropdown),this.listenTo(this.collection,"remove destroy",function(){return this.checkArchived(),this.setUnread()}),this.listenTo(this.collection,"add",function(t,e,i){var n,r;if(null==i&&(i={}),"room"!==t.get("objectType"))return r=t.get("isLater"),n=t.get("isAted"),this.appendMessage(t,!i.isAppendLoad,r,n),this.setUnread()}),this.listenTo(this.collection,"change:unreadActivitiesCount",function(t){return function(e,i){var n,r;if(i>0)return r=e.get("isLater"),n=e.get("isAted"),t.appendMessage(e,!0,r,n)}}(this)),this.listenTo(this.collection,"change:isRead",this.setUnread),this.listenTo(this.collection,"change:isLater",function(t,e){var i;if(i=t.get("isAted"),this.appendMessage(t,!0,e,i),this.setUnread(),!e)return p.ajax("users/badge",{success:function(t){return function(e){if("normal"===t.collection.type&&e.hasNormal)return t.unreadModel.set("normal",!0)}}(this)})}),t=P.throttle(function(t){return function(){if(t.collection&&D.user.get("normal")!==t.collection.getUnreadCount()&&!t.collection.hasMore)return t.collection.resetSoft(),t.collection.fetch({remove:!1,success:function(){return t.checkUnread()}})}}(this),5e3,{leading:!1}),this.listenTo(D.user,"change:normal",function(e,i){return t()}),this},e.prototype.stopListenMessage=function(){if(this._listeningMessageModel)return this.stopListening(this._listeningMessageModel),this._listeningMessageModel=null},e.prototype.listenToMessage=function(t){return this.stopListenMessage(),this._listeningMessageModel=t,this.listenTo(t,"change:unreadActivitiesCount",P.debounce(function(t,e){if(e>0)return t.markRead()},10))},e.prototype.syncUnread=function(){return p.ajax("users/badge",{success:function(t){return function(e){if(e.hasLater&&t.unreadModel.set("later",!0),"normal"===t.collection.type&&e.hasNormal)return t.unreadModel.set("normal",!0)}}(this)})},e.prototype.renderBasic=function(){return this.$el.html(r({type:this.collection.type})),this.$messages=this.$(".messages"),this.$messageScroll=this.$(".messages-scroll"),this.$detailPanel=this.$(".detail-panel"),this.$detailHeader=this.$(".detail-header"),this.$typeToggler=this.$(".type-toggler"),this.$onlyMentions=this.$(".only-mentions"),this.$emptyTip=this.$(".empty-tip"),this},e.prototype.renderPlaceholder=function(){var t;return t=this.collection.onlyMentions?"ated":this.collection.type,this.$emptyTip.html(y({type:t})),this},e.prototype.renderDropdown=function(){var t,e,i;if(0!==this.$typeToggler.length)return i=this.collection.type,"ated"===i&&(i="normal"),t=null!=(e=this.$typeToggler.find(".dropdown"))?e.hasClass("open"):void 0,this.$typeToggler.html(a({type:i,unread:this.unreadModel.toJSON(),open:t})).find(".inbox-type-display").dropdown(),this},e.prototype.setUnread=function(){var t,e;return e=this.collection.where({isRead:!1,isLater:!1}),t=this.collection.where({isRead:!1,isLater:!0}),this.unreadModel.set({normal:e.length>0,later:t.length>0})},e.prototype.showPreferences=function(){return this.requestSubView(z).open(x),D.gta.event({action:"enter my settings",control:"feed",segment:this.getSegmentType()})},e.prototype.load=function(t){return null==t&&(t={}),t.isAppendLoad=!0,this.collection.reset(),this.collection.fetch(t),this},e.prototype.loadMore=function(t){return this.collection.loadMore({isAppendLoad:!0,silent:!0,beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$messages)}}(this),success:function(e){return function(i,n,r){if(e.collection.forEach(function(t){var i;if(i=t.id,!(E.call(e.statistics,i)>=0))return D.gta.event({action:"receive message",category:t.get("latestActivityAction")||"null"}),e.statistics.push(t.id)}),e.$el)return e.hideLoadingIndicator({animated:!0}),P.each(n,function(t){return e.renderMessage(e.collection.get(t._id))}),e.collection.hasMore?"function"==typeof t&&t():e.showEndPoint(e.$messages),D.gta.event(null,"load more","inbox|view more message")}}(this)}),this},e.prototype.appendMessage=function(t,e,i,n){switch(this.collection.type){case"normal":if(this.collection.onlyMentions){if(n&&!i)return this.renderMessage(t,e)}else if(!i)return this.renderMessage(t,e);break;case"later":if(this.collection.onlyMentions){if(n&&i)return this.renderMessage(t,e)}else if(i)return this.renderMessage(t,e)}},e.prototype.renderMessages=function(){return this.removeSubViews(),this.$messages.empty(),this.$detailPanel.empty(),this.$detailHeader.empty(),this.prevMessageModel=null,this.collection.each(function(t){return function(e){return t.renderMessage(e)}}(this)),this},e.prototype.renderMessage=function(t,e){var i,n;if(!t.get("inboxIgnore")&&!t.get("isArchived"))return i=this.$(".message-view[data-id="+t.id+"]"),i.length&&e?i.prependTo(this.$messages):i.length||(n=e?"prependTo":"appendTo",this.requestSubView(m,{segmentType:this.getSegmentType(),messageModel:t}).$el[n](this.$messages)),this},e.prototype.loadMessages=function(){return this.$messages.empty(),this.renderPlaceholder(),this.showLoadingIndicator(this.$messages,{isPrepend:!0}),this.load({remove:!0,silent:!0,success:function(t){return function(){if(t.$el)return t.hideLoadingIndicator({animated:!0}),t.renderMessages(),t.setupScroll(t.$messageScroll),t.options._messageId&&t.showMessageDetail(t.options._messageId),t.renderDropdown()}}(this)})},e.prototype.showOrdinaryMessages=function(){return"normal"===this.collection.type?void this.renderDropdown():(this.stopListenMessage(),this.collection.type="normal",this.switchOnlyMentionsOff(),this.loadMessages(),this)},e.prototype.showSnoozedyMessages=function(){return"later"===this.collection.type?void this.renderDropdown():(this.collection.type="later",this.stopListenMessage(),this.switchOnlyMentionsOff(),this.loadMessages(),this)},e.prototype.toggleOnlyMentions=function(){return this.collection.onlyMentions?this.switchOnlyMentionsOff():this.switchOnlyMentionsOn(),this.loadMessages(),this},e.prototype.switchOnlyMentionsOn=function(){return this.collection.onlyMentions=!0,this.$onlyMentions.addClass("on-only-mentions")},e.prototype.switchOnlyMentionsOff=function(){return this.collection.onlyMentions=!1,this.$onlyMentions.removeClass("on-only-mentions")},e.prototype.moveNewMessageToTop=function(t){return this.$messages.find("[data-id="+t.id+"]").prependTo(this.$messages),this},e.prototype.showMessageDetailByObjectId=function(t){var e;if(e=this.collection.find(function(e){return e.get("_objectId")===t}))return this.showMessageDetail(e.id)},e.prototype.showMessageDetail=function(t){var e,i,r,o,s,a,c;if(!($(t.target).parents(".actions-handler").length>0)&&(t.currentTarget&&(t=$(t.currentTarget).data("id")),r=this.collection.get(t)))return o=r.get("objectType"),D.gta.event({action:"open detail",type:o,control:"feed",segment:this.getSegmentType(),category:r.get("latestActivityAction")}),D.gta.event({action:"open message",category:r.get("latestActivityAction")||"null"}),this.stopListenMessage(),e=r.get("_latestActivityId"),e&&P.delay(function(){var t;if(t=n.find(r.get("_objectId")),t&&!t.get(e))return t.fetch()},1e3),this.setActive(this.$(".message-view[data-id="+t+"]")),r===this.prevMessageModel&&"work"!==r.get("objectType")?(this.listenToMessage(r),r.markRead()):(this.prevMessageModel=r,null!=(s=this.detailView)&&null!=(a=s.currentView)&&"function"==typeof a.close&&a.close(),null!=(c=this.detailView)&&c.remove(),this.$detailHeader.empty(),this.$detailPanel.empty(),i=r.get("_projectId"),r.markRead(),this.$detailPanel.removeClass("system-message-pannel"),new Promise(function(t,e){return"work"===r.get("objectType")||null==i?t():_.fetchOne(0,i,{success:t,error:e})}).then(function(t){return function(){return t.renderMessageDetail(r)}}(this))["catch"](function(t){return console.error(t)}),this)},e.prototype.renderMessageDetail=function(t){var e;if(e=t.get("_objectId"),"system"===t.get("type")||"activity"===t.get("objectType"))this.detailView=this.requestSubView(M,{messageModel:t,inPanel:!0}),this.detailView.$el.appendTo(this.$detailPanel),this.$detailPanel.addClass("system-message-pannel");else switch(this.listenToMessage(t),t.get("objectType")){case"task":this.detailView=this.requestSubView(C,{_taskId:e,where:"inbox",success:function(e){return function(i){return e.renderDetailHeader(t,i.taskModel)}}(this)}),this.detailView.$el.appendTo(this.$detailPanel);break;case"post":this.detailView=this.requestSubView(b,{_postId:e,where:"inbox",success:function(e){return function(i){return e.renderDetailHeader(t,i.postModel)}}(this)}),this.detailView.$el.appendTo(this.$detailPanel);break;case"event":this.detailView=this.requestSubView(l,{_eventId:e,where:"inbox",success:function(e){return function(i){return e.renderDetailHeader(t,i.eventModel)}}(this)}),this.detailView.$el.appendTo(this.$detailPanel);break;case"work":this.detailView=this.requestSubView(z).open(k,{_workId:e});break;case"entry":this.detailView=this.requestSubView(c,{_entryId:e,where:"inbox",success:function(e){return function(i){return e.renderDetailHeader(t,i.entryModel)}}(this)}),this.detailView.$el.appendTo(this.$detailPanel)}return this},e.prototype.renderDetailHeader=function(t,e){var i,n,r,o;return i=[],n=t.toJSON(),o=this.getSegmentType(),r=n.objectType,new Promise(function(t,e){return n._organizationId?v.fetchOne(0,n._organizationId,{success:function(e){return e.joinRoom(),t(e.toJSON())},error:e}):t()}).then(function(a){return function(c){var l,p;if((null!=c?c._id:void 0)&&i.push({url:"/organization/"+c._id,title:""+tb_i18n.get("inbox.go.to.organization")+c.name,segmentType:o,messageType:r}),null!=n._projectId&&(l=_.getOne(0,n._projectId),a.stopListening(l),a.listenTo(l,"change:applications",function(){var i,n,r,o,s;for(o=["tasks","posts","events","bookkeeping"],n=!1,i=0,s=o.length;i<s;i++)if(r=o[i],l.isAppChanged(r)){n=!0;break}if(n)return a.renderDetailHeader(t,e)}),p="/project/"+l.id,i.push({url:""+p,title:""+tb_i18n.get("inbox.go.to.project")+l.get("name"),segmentType:o,messageType:r})),l&&e)switch(n.objectType){case"task":if(!l.isAppEnabled("tasks"))break;i.push({url:p+"/tasks/scrum/"+e.get("_tasklistId")+"/task/"+e.id,title:tb_i18n.get("inbox.go.to.task"),segmentType:o,messageType:r});break;case"post":if(!l.isAppEnabled("posts"))break;i.push({url:p+"/posts/post/"+e.id,title:tb_i18n.get("inbox.go.to.post"),segmentType:o,messageType:r});break;case"event":if(!l.isAppEnabled("events"))break;i.push({url:p+"/events/event/"+e.id,title:tb_i18n.get("inbox.go.to.event"),segmentType:o,messageType:r});break;case"entry":if(!l.isAppEnabled("bookkeeping"))break;i.push({url:p+"/bookkeeping/entry/"+e.id,title:tb_i18n.get("inbox.go.to.entry"),segmentType:o,messageType:r})}return a.$detailHeader.html(s(i))}}(this))["catch"](function(t){return console.error(t)}),this},e.prototype.selectPrev=function(){return this.prev(function(t){return function(){return t.showMessageDetail(t.getActive().data("id"))}}(this)),this},e.prototype.selectNext=function(){return this.next(function(t){return function(){return t.showMessageDetail(t.getActive().data("id"))}}(this)),this},e.prototype.clear=function(){return D.APP.Float.close(),this},e.prototype.clearReadMessages=function(){return this.collection.getReaded().length&&this.requestSubView(o,{title:tb_i18n.get("inbox.clear.messages"),description:tb_i18n.get("inbox.clear.messages.desc"),onConfirm:function(t){return function(){return t.collection.archiveRead(),D.gta.event({action:"mark all message",type:"delete",control:"feed",segment:t.getSegmentType()})}}(this)}),this},e.prototype.readAllMessages=function(){return this.collection.readAll(),D.gta.event({action:"mark all message",type:"read",control:"feed",segment:this.getSegmentType()}),this},e.prototype.checkArchived=function(t){var e,i,n,r;return t&&(null!=(e=this.prevMessageModel)?e.id:void 0)===t.id&&(null!=(i=this.detailView)&&null!=(n=i.currentView)&&"function"==typeof n.close&&n.close(),null!=(r=this.detailView)&&r.remove(),this.$detailPanel.empty(),this.$detailHeader.empty()),this},e.prototype.checkUnread=function(){var t;return t=this.collection.getUnreadCount(),t>D.user.get("normal")&&D.user.set("normal",t),this},e.prototype.beforeClose=function(){return $("#navigator .inbox-handler").removeClass("active"),this},e.prototype.getSegmentType=function(){switch(this.collection.type){case"later":return"snooze";default:return"messages"}},e.prototype.remove=function(){var t;return this.beforeClose(),t=D.router.getUrl().replace(/\/inbox.*/,""),D.router.navigate(t,{trigger:!1}),e.__super__.remove.apply(this,arguments)},e}(I),P.extend(u.prototype,T(".message-view")),P.extend(u.prototype,j),t.exports=u},function(t,e){var i;t.exports=i=function(t){return{setActive:function(t){return t.siblings().removeClass("active"),t.addClass("active"),this},getActive:function(){return this.$(t).filter(".active").first()},prev:function(e){var i,n,r;if(n=this.$(t),0!==n.length)return i=n.filter(".active"),i.length?(i.removeClass("active"),r=i.prev(),r.length||(r=i)):r=n.first(),this.slideTo(r,!0,0,function(){return r.addClass("active"),"function"==typeof e?e():void 0}),this},next:function(e){var i,n,r;if(n=this.$(t),0!==n.length)return i=n.filter(".active"),i.length?(i.removeClass("active"),r=i.next(t),r.length||(r=i)):r=n.first(),this.slideTo(r,!0,0,function(){return r.addClass("active"),"function"==typeof e?e():void 0}),this}}}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;c=i(358),u=i(678),l=i(820),a=i(788),o=i(429),s=i(1301),n=i(1303),p={post:"icon-wall",task:"icon-board",event:"icon-calendar",work:"icon-file",entry:"icon-bookkeeping-logo",system:"icon-circle-info-o",activity:"icon-circle-info-o"},t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.viewName="MessageView",e.prototype.tagName="li",e.prototype.className="message-view flex-horiz flex-vcenter",e.prototype.events={"click .icon-clock":"snoozedMessage","click .icon-circle-check":"cancelSnoozed","click .delete-handler":"deleteMessage"},e.prototype.initialize=function(t){if(null!=t?t.messageModel:void 0)return this.options=t,this.messageModel=t.messageModel,this.renderBasic().refreshRead().listen(),this},e.prototype.listen=function(){return this.listenTo(this.messageModel,"change",this.renderBasic),this.listenTo(this.messageModel,"change:isRead change:unreadActivitiesCount",this.refreshRead),this.listenTo(this.messageModel,"remove destroy change:isLater",this.archive),this},e.prototype.renderBasic=function(t){var e,i,r,o,s;return this.messageModel=t||this.messageModel,e=this.messageModel.genMessage(),s=this.messageModel.get("reminder")||{reminderDate:null,updated:null},i=c.extend(e,{segmentType:this.options.segmentType,atMe:e.isAted,iconName:p[e.objectType]||p.system,sub:(null!=(r=e.project)?r.name:void 0)||(null!=(o=e.organization)?o.name:void 0),reminder:s}),this.$el.html(n(i)).attr("data-id",this.messageModel.id),this.$el.find("time").timesince(),this.$el.find(".message-content-subtitle").text(e.subtitle),this.renderContent(),this},e.prototype.renderContent=function(){var t,e;return e=this.messageModel.genMessage().title,t=document.createDocumentFragment(),c.each(l.translate(e),function(e){var i;return e.isEmoji?t.appendChild($(e.value)[0]):(i=document.createTextNode(e.value),t.appendChild(i))}),this.$el.find(".message-content-title").html(t),this},e.prototype.refreshRead=function(){return this.$el.toggleClass("read",this.messageModel.get("isRead")),this},e.prototype.deleteMessage=function(t){return this.messageModel.archive(),this.archive(),this},e.prototype.archive=function(){var t;return null!=(t=this.$el)&&t.slideUp(300,"swing",function(t){return function(){return t.remove()}}(this)),this},e.prototype.snoozedMessage=function(t){var e;return e=$(t.currentTarget),e.data("bs.popover")||this.requestSubView(s,{$toggler:e,messageModel:this.messageModel,segmentType:this.options.segmentType,onShown:function(t){return function(){return t.$el.addClass("snoozed")}}(this),onHidden:function(t){return function(){return t.$el.removeClass("snoozed")}}(this)}).show(),this},e}(a)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;p=i(358),u=i(678),o=i(429),r=i(401),l=i(677),a=i(813),n=i(1302),c=[{id:20,delay:"20mins"},{id:60,delay:"1hour"},{id:240,delay:"4hours"},{id:1440,delay:"1day"}],t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.viewName="PopoverSnoozedView",e.prototype.className="popover-single-picker-view popover-snoozed-picker",e.prototype.width=170,e.prototype.events={"click .single-picker-item":"selectItem","click .cancel-handler":"cancelSnoozed"},e.prototype.initialize=function(t){return this.options=t,this.options.messageModel?(this.messageModel=this.options.messageModel,e.__super__.initialize.apply(this,arguments),this):void console.error("messageModel is required!")},e.prototype.render=function(){return this.$el.html(n({dataList:c,isLater:this.messageModel.get("isLater")})),this},e.prototype.selectItem=function(t){var e,i;return e=$(t.currentTarget),this.selected=e.data("id"),u.gta.event({action:"snooze time",segment:this.options.segmentType,type:null!=(i=p.findWhere(c,{id:this.selected}))?i.delay:void 0}),this.submitSnoozedMessage()},e.prototype.submitSnoozedMessage=function(){var t,e;return t=this.messageModel.get("reminderDate"),t=t?o(t):o(),e=t.minute(t.minute()+this.selected).format(),this.messageModel.markLater(!0,e),r.success({hint:tb_i18n.get("already.inbox.later.message.hint",l.formatDate(e).dateTimeString),message:tb_i18n.get("already.inbox.later.message")}),this.remove()},e.prototype.cancelSnoozed=function(){return this.messageModel.markLater(!1),r.success({message:tb_i18n.get("cancel.inbox.later.message")})},e}(a)},function(t,e){t.exports=function(t){var e="<!-- tb_i18n.get('1day') tb_i18n.get('1hour') tb_i18n.get('20mins') tb_i18n.get('4hours')-->",i=t.dataList;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <li class="single-picker-item" data-id="'+n.id+'"> <a>'+tb_i18n.get("inbox.message.snoozed.time.picker",tb_i18n.get(n.delay))+"</a> </li>";return t.isLater&&(e+='<li class="divider"></li><li> <a class="cancel-handler">'+tb_i18n.get("inbox.later.message.cancel")+"</a></li>"),e}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(677),o=["entry","post","event","task","work"];return t.creator.avatarUrl?(n+=' <div class="avatar flex-static img-circle img-36 pull-left ',"room"===t.objectType&&t.project&&(n+="project"),n+='" style="background-image: url('+t.creator.avatarUrl+');"></div>'):n+=' <div class="avatar flex-static img-circle img-36 pull-left no-avatar"></div>',n+='<div class="message-detail flex-fill"> <div class="message-heading flex-horiz flex-vcenter flex-between"> <span class="project-name flex-fill">'+t.sub+"</span> ",t.reminder&&(n+=" ",t.isLater?t.reminder.reminderDate&&(n+=' <span class="time flex-static reminder-time"> '+r.formatDate(t.reminder.reminderDate).dateTimeString+" "+tb_i18n.get("task.detail.remind")+" </span> "):(n+=" ",n+=!t.isRead&&t.reminder.updated?' <span class="time flex-static"> '+tb_i18n.get("task.detail.setting.remind",r.formatDate(t.reminder.updated).dateTimeString)+" </span> ":' <time class="time time-stamp flex-static" datetime="'+t.boundToObjectUpdated+'"></time> ',n+=" "),n+=" "),n+=' <div class="actions-handler"> ',o.indexOf(t.objectType)>-1&&(n+=' <a class="icon icon-clock hinted" data-title="'+tb_i18n.get("inbox.later.message")+"\" data-gta=\"{action: 'toggle snooze', type: '"+t.objectType+"', control: 'feed', segment: '"+t.segmentType+"'}\"></a> "),n+=' <a class="delete-handler icon icon-remove hinted" data-title="'+tb_i18n.get("inbox.delete.message")+'" data-gta="{action: delete message, type: \''+t.objectType+"', control: 'feed', segment: '"+t.segmentType+"'}\"></a> </div> </div> <p class=\"message-content flex-horiz flex-vcenter\"> <span class='message-content-title-wrapper flex-fill'> ",t.atMe&&(n+='<span class="message-at"> '+tb_i18n.get("inbox.at.me")+"</span>"),n+=" "+e(t.creator.name)+' <span class="message-content-title"></span> </span> <span class="unread-activities-count flex-static">',t.unreadActivitiesCount>0&&(n+=""+t.unreadActivitiesCount),n+='</span> </p> <p class="object-content muted"> <span class="icon '+t.iconName+'"></span> <span class="message-content-subtitle"></span> </p></div>';
}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(358),a=i(788),r=i(1305),o=i(1382),n=i(1384),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="SystemMessageView",e.prototype.className="system-message",e.prototype.events={"click .open-chat-handler":"openChat"},e.prototype.initialize=function(t){if(t._messageId||t.messageModel)return this.messageModel=t.messageModel,this.renderBasic(),this},e.prototype.renderBasic=function(){var t;return t=o.formatData(this.messageModel),this.$el.html(n(t))},e.prototype.openChat=function(){var t;return this.message=this.messageModel.genMessage(),t={id:this.message.creator._id,name:this.message.creator.name,avatarUrl:this.message.creator.avatarUrl},r.open({pseudoMessageData:t,activeObjectId:t.id})},e}(a)},function(t,e,i){var n,r,o,s;s=i(358),o=i(786),n=i(1306),r=function(){function t(){}return t.prototype.windowView=null,t.prototype.open=function(t){return null==t&&(t={}),this.windowView?this.windowView.currentView.onSwitch(t.activeMessageId,t.activeObjectId):(t=s.extend({},t,{onClose:function(t){return function(){return t.reset()}}(this)}),this.windowView=new o,this.windowView.open(n,t))},t.prototype.close=function(){if(this.windowView)return this.windowView.close(),this.reset()},t.prototype.reset=function(){return this.windowView=null},t}(),t.exports=new r},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v=function(t,e){function i(){this.constructor=t}for(var n in e)y.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},y={}.hasOwnProperty;f=i(358),h=i(788),d=i(797),g=i(678),m=i(786),p=i(976),l=i(1307),u=i(1296),s=i(1308),r=i(1312),a=i(1318),c=i(1327),n=i(1381),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return v(e,t),e.prototype.viewName="ChatModalView",e.prototype.className="chat-modal-view",e.prototype.hotkeys={esc:"remove"},e.prototype.events={"click .close-handler":"remove","click .new-chat-handler":"onStartChat","click .read-all-handler":"onReadAll","click .clear-readed-handler":"onClearReadedMessages"},e.prototype.initialize=function(t){var e;return this.options=t||{},this.onClose=this.options.onClose||function(){},this.hasRequested=this.options.hasRequested,this.activeObjectId=this.options.activeObjectId||null,this.activeMessageId=this.options.activeMessageId||null,e=this.options.pseudoMessageData,this.chatsCollection=l.get("chats"),this.renderBefore(),this.onSetup().then(function(t){return function(){var i;if(t.onReady(),e)return i=t.chatsCollection.getMessage(e),t.onSwitch(i.id),t.messageListView.onLead(i)}}(this))["catch"](function(t){return function(e){if(e)return t.messageListView.onError()}}(this))},e.prototype.remove=function(){return this.parentView.close(),this.onClose(),e.__super__.remove.apply(this,arguments)},e.prototype.listen=function(){return this.listenTo(this.chatsCollection,"add",function(t){return function(e){return t.messageListView.onAdd(e)}}(this)),this.listenTo(this.chatsCollection,this.chatsCollection.pseudoEvent,function(t){return function(e){return t.messageListView.onReplace(e)}}(this)),this.listenTo(this.chatsCollection,"change:title",function(t){return function(e){return t.messageListView.onLead(e)}}(this)),this.listenTo(this.chatsCollection,"change:unreadActivitiesCount",function(t){return function(e,i){if(i>0)return t.messageListView.onLead(e)}}(this)),this.listenTo(this.chatsCollection,"destroy remove",function(t){return function(e){return 0===t.chatsCollection.getAllMessagesCount()?t.messageListView.onEmpty():t.messageListView.onRemove(e)}}(this))},e.prototype.loadMore=function(){if(!this.chatsCollection.isComplete)return this.onRequestMore()},e.prototype.onSetup=function(){return new Promise(function(t){return function(e,i){return t.hasRequested?t.chatsCollection.isFetching?(t.messageListView.onLoading(),t.listenToOnce(t.chatsCollection,t.chatsCollection.fetchEvent,function(n){return n?i():(t.messageListView.onLoaded(),e())})):e():t.onRequest().then(function(){return e()})["catch"](function(){return i()})}}(this))},e.prototype.onReady=function(){var t;return this.activeObjectId&&(t=this.chatsCollection.getMessageByObjectId(this.activeObjectId),t&&(this.activeObjectId=null,this.activeMessageId=t.get("_id"),this.messageListView.onUpdateActiveMessageId(this.activeMessageId))),this.listen(),this.render(),this.renderPanel()},e.prototype.onStartChat=function(){return this.requestSubView(m).open(s,{onItemClick:function(t){return function(e){var i;return i=t.chatsCollection.getMessage(e),t.onSwitch(i.id),t.messageListView.onLead(i)}}(this)})},e.prototype.onClearReadedMessages=function(){if(this.chatsCollection.getReadedMessagesCount()>0)return this.requestSubView(p,{title:tb_i18n.get("inbox.clear.messages"),description:tb_i18n.get("inbox.clear.messages.desc"),onConfirm:function(t){return function(){return t.chatsCollection.onClearReadedMessages()}}(this)})},e.prototype.onReadAll=function(){return this.chatsCollection.onMarkAllMessagesReaded()},e.prototype.onSwitch=function(t,e){var i;if(e){if(this.activeObjectId=e,i=this.chatsCollection.getMessageByObjectId(this.activeObjectId))return this.activeObjectId=null,this.activeMessageId=i.get("_id"),this.messageListView.onUpdateActiveMessageId(this.activeMessageId)}else if(t!==this.activeMessageId)return this.activeMessageId=t,this.messageListView.onActive(this.activeMessageId),this.renderPanel()},e.prototype.onRequest=function(){return new Promise(function(t){return function(e,i){return t.messageListView.onLoading(),t.stopListening(),t.chatsCollection.reset(),t.chatsCollection.fetch().then(function(){return t.messageListView?(t.messageListView.onLoaded(),e()):i()})}}(this))},e.prototype.onRequestMore=function(){var t;return t={remove:!1},this.messageListView.onLoading(),this.chatsCollection.fetch(t).then(function(t){return function(){if(t.messageListView)return t.messageListView.onLoaded()}}(this))},e.prototype.renderBefore=function(){var t;return this.$el.html(n()),this.messageListView=this.requestSubView(r,{from:"Chat Window",activeMessageId:this.activeMessageId,onClick:function(t){return function(e){return t.onSwitch(e)}}(this),onRefresh:function(t){return function(){return t.messageListView.onReset(),t.onRequest().then(function(){return t.onReady()})["catch"](function(e){if(e)return t.messageListView.onError()})}}(this)}),t=this.$(".message-list-container"),t.html(this.messageListView.$el),this.setupScroll(this.messageListView.$el)},e.prototype.render=function(){var t,e;if(t=this.chatsCollection.getAllMessages(),this.messageListView.onSetup(t),this.activeMessageId)return e=this.chatsCollection.get(this.activeMessageId),this.messageListView.onLead(e)},e.prototype.renderPanel=function(){var t,e,i;if(this.activeMessageId)return e=this.chatsCollection.get(this.activeMessageId),i=e.has("project")?c:a,this.panelView=this.requestSubView(i,{roomId:e.get("_objectId"),modelId:e.getTargetId(),messageModel:e}),t=this.$(".panel-right"),t.html(this.panelView.$el),f.delay(function(t){return function(){return t.panelView.scrollToBottom()}}(this),250),f.delay(function(t){return function(){return t.panelView.$(".message-input").focus()}}(this),250)},e}(h),f.extend(o.prototype,d),t.exports=o},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;c=i(358),o=i(680),a=i(686),r=i(685),p=i(678),s=i(1296),l=function(t){return"room"===(null!=t?t.objectType:void 0)},t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.name="messages",e.prototype.type="private",e.prototype.model=s,e.prototype.baseUrl="v2/messages",e.prototype.pageNum=20,e.prototype.isComplete=!1,e.prototype.isFetching=!1,e.prototype.isListened=!1,e.prototype.pseudoMessages=[],e.prototype.fetchEvent="fetch",e.prototype.pseudoEvent="pseudo",e.prototype.initialize=function(){return this.listen(),e.__super__.initialize.apply(this,arguments),this},e.prototype.comparator=function(t,e){var i;return i=t.get("isRead")-e.get("isRead"),i||(i=new Date(e.get("updated"))-new Date(t.get("updated"))),i},e.prototype.createPseudoMessage=function(t){var e;return e=new s(t),this.add(e),e},e.prototype.fetch=function(t){return null==t&&(t={}),this.isFetching=!0,new Promise(function(i){return function(n,r){var o;return o=c.extend({},t.attrs,{type:i.type}),t=c.extend({},t,{attrs:o,url:i.baseUrl,complete:function(){return i.isFetching=!1},error:function(){return r(arguments),i.trigger(i.fetchEvents,!0)},success:function(t){return t.length<i.pageNum&&(i.isComplete=!0),n(t),i.trigger(i.fetchEvents,!1)}}),e.__super__.fetch.call(i,t)}}(this))},e.prototype.fetchOne=function(t){return o.get("v2/messages/"+t,{cache:!1}).then(function(t){return function(e){var i,n;return i=new s(e),n=c.find(t.models,function(t){return t.get("isPseudo")&&t.getTargetId()===i.getTargetId()}),n?(t.remove(n,{silent:!0}),t.add(e,{silent:!0}),t.trigger(t.pseudoEvent,i)):t.add(e)}}(this))},e.prototype.listen=function(){var t;if(!this.isListened)return this.isListened=!0,t=this.name+"/"+p.user.id,a.on("all",function(t){return function(e,i){var n;if(n=/\:change\:message\/(\w{24})/.exec(e),n&&n[1]&&"pm"===i.msgType&&!t.get(n[1]))return t.fetchOne(n[1])}}(this)),a.on(":new:"+t,function(t){return function(e){var i,n;return i=new s(e),n=c.find(t.models,function(t){return t.get("isPseudo")&&t.getTargetId()===i.getTargetId()}),n?(t.remove(n,{silent:!0}),t.add(e,{silent:!0}),t.trigger(t.pseudoEvent,i)):t.add(e)}}(this)),a.on(":change:"+t,function(t){return function(e){return t.set(e)}}(this)),a.on(":remove:"+t,function(t){return function(e){return t.remove(e)}}(this)),a.on(":change:"+this.name,function(t){return function(e){if(e==="readAll:"+t.type)return t.onSetAllMessagesReaded()}}(this)),a.on(":remove:"+this.name,function(t){return function(e){return e==="removeAll:"+t.type?t.onRemoveReadedMessages():t.remove(e)}}(this))},e.prototype.getAllMessages=function(){return c.filter(this.models,function(t){return t.isValid()})},e.prototype.getAllMessagesCount=function(){return this.getAllMessages().length},e.prototype.getMessageByObjectId=function(t){return c.find(this.models,function(e){return e.get("_objectId")===t})},e.prototype.getMessageByTargetId=function(t){return c.find(this.models,function(e){return e.getTargetId()===t})},e.prototype.getReadedMessages=function(){return c.filter(this.models,function(t){return t.isReaded()})},e.prototype.getReadedMessagesCount=function(){return this.getReadedMessages().length},e.prototype.getUnreadMessages=function(){return c.filter(this.models,function(t){return t.isUnread()})},e.prototype.getUnreadMessagesCount=function(){return this.getUnreadMessages().length},e.prototype.onClearReadedMessages=function(t){if(this.getReadedMessagesCount()>0)return t=c.extend({},t,{url:"messages?type="+this.type}),this.sync("delete",this,t)},e.prototype.onRemoveReadedMessages=function(){var t;return t=this.models.filter(function(t){return!t.isUnread()}),this.remove(t)},e.prototype.onMarkAllMessagesReaded=function(){if(this.getUnreadMessagesCount()>0)return this.sync("update",this,{url:"messages/markallread",attrs:{type:this.type},success:function(t){return function(){return t.onSetAllMessagesReaded()}}(this)})},e.prototype.onSetAllMessagesReaded=function(){var t;return t={isRead:!0,unreadActivitiesCount:0},c.each(this.models,function(e){return e.set(t)})},e.prototype.parse=function(t){return c.isArray(t)||(t=[t]),t.filter(function(t){return l(t)})},e.prototype.getMessage=function(t){var e,i;return(i=this.getMessageByTargetId(t.id))?i:(e={_id:""+t.id,_objectId:null,title:"&nbsp;",isRead:!0,creator:{_id:t.id,name:t.name,avatarUrl:t.avatarUrl},updated:Date.now(),isPseudo:!0,objectType:"room"},"projects"===t.chatType&&c.extend(e,{project:{_id:t.id,logo:t.avatarUrl,name:t.name}}),i=this.createPseudoMessage(e))},e}(r)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m=function(t,e){function i(){this.constructor=t}for(var n in e)f.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},f={}.hasOwnProperty;d=i(358),h=i(678),c=i(797),u=i(788),p=i(677),s=i(699),a=i(696),n=i(1309),l=i(1310),o=i(1311),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.viewName="ChatRoomAddView",e.prototype.className="chat-room-add-view modal-dialog",e.prototype.events={"click .section-switcher>li:not(.active)":"switchTab","click .item-detail":"createChat","input [type=search]":"search","keydown [type=search]":"itemSwitch","mousewheel .item-list-wrapper":p.mousewheel},e.prototype.initialize=function(t){return null==t&&(t={}),this.onItemClick=t.onItemClick,this.isGroupChatEnabled=h.applications.checkIsAppOnline("groupchat"),this.isGroupChatEnabled?this.type=t.type||"member":this.type="member",this.projectsCollection=a.get(0),this.membersCollection=s.get(0),this.renderBasic().load(),this},e.prototype.renderBasic=function(){return this.$el.html(n({isGroupChatEnabled:this.isGroupChatEnabled,type:this.type})),this.$itemList=this.$(".item-list-wrapper"),this.showLoadingIndicator(this.$itemList),this.setupScroll(this.$itemList),this},e.prototype.load=function(t){switch(null==t&&(t={}),d.extend(t,{success:function(t){return function(e){return t.hideLoadingIndicator(t.$itemList),t.renderSearch().renderList(e)}}(this)}),this.type){case"member":this.getMembers(t);break;case"project":this.getProjects(t)}return this},e.prototype.getMembers=function(t){return null==t&&(t={}),s.fetch(0,{url:"projects/members",success:function(e){return function(){return e.members=d.map(d.filter(e.membersCollection.toJSON(),function(t){return t._id!==h.user.id}),function(t){return{type:"member",id:t._id,avatarUrl:t.avatarUrl,name:t.name,title:t.title,email:t.email,pinyin:t.pinyin,py:t.py,chatType:"users"}}),t.success(e.members)}}(this)}),this},e.prototype.getProjects=function(t){return null==t&&(t={}),a.fetch(0,{success:function(e){return function(){return e.projects=e.projectsCollection.map(function(t){var e;return e=t.toJSON(),{type:"project",id:e._id,avatarUrl:e.logo,name:e.name,pinyin:e.pinyin,py:e.py,chatType:"projects",isOpen:t.isAppEnabled("groupchat")}}),t.success(e.projects)}}(this)}),this},e.prototype.renderSearch=function(){return this.$(".chat-room-add-search").html(l({type:this.type})),d.delay(function(){return this.$(".search-input").focus()},220),this},e.prototype.renderList=function(t){return this.$itemList.html(o({type:this.type,items:t})),this},e.prototype.switchTab=function(t){var e;return e=$(t.currentTarget),e.addClass("active").siblings("li").removeClass("active"),this.type=e.data("type"),this.$itemList.html(""),this.showLoadingIndicator(this.$itemList),this.load(),this},e.prototype.createChat=function(t){var e,i,n,r;return e=$(t.currentTarget),i=e.data("id"),i&&(r={member:this.members,project:this.projects}[this.type],n=d.findWhere(r,{id:i}),("project"!==this.type||n.isOpen)&&(this.onItemClick(n),this.remove())),this},e.prototype.search=function(t){var e,i,n;return e=$(t.currentTarget),n=e.val().trim().replace(/\/|\\/g,""),n?(i={member:this.members,project:this.projects}[this.type],this.set=this.keywordSearch(i,n),this.renderList(this.set)):this.renderContent(),this},e.prototype.renderContent=function(t){return t||(t={member:this.members,project:this.projects}[this.type]),this.renderList(t),this},e.prototype.keywordSearch=function(t,e){var i,n;return i=new RegExp(e,"i"),n=d.filter(t,function(t){return i.test(t.name)||i.test(t.pinyin)||i.test(t.py)||i.test(t.title)||i.test(t.email)})},e.prototype.itemSwitch=function(t){var e;if(13!==(e=t.keyCode)&&38!==e&&40!==e||(t.preventDefault(),t.stopPropagation()),this.$(".item-detail").length)switch(t.keyCode){case 13:this.selectSwitch("enter");break;case 38:this.selectSwitch("up");break;case 40:this.selectSwitch("down")}return this},e.prototype.selectSwitch=function(t){var e,i,n,r,o,s;switch(this.$items=this.$(".item-detail"),e=this.$items.filter(".active"),t){case"enter":e.click();break;case"up":s=e.removeClass("active").prev(),r=this.$items.filter("li:last"),s.length>0?s.addClass("active"):r.addClass("active");break;case"down":o=e.removeClass("active").next(),n=this.$items.filter("li:first"),o.length>0?o.addClass("active"):n.addClass("active")}return"enter"!==t&&(i=this.$items.filter(".active"),i&&this.slideTo(i)),this},e.prototype.remove=function(){var t;return"WindowView"===(null!=(t=this.parentView)?t.viewName:void 0)&&this.parentView.close(),e.__super__.remove.apply(this,arguments)},e}(u),d.extend(r.prototype,c),t.exports=r},function(t,e){t.exports=function(t){var e='<div class="modal-content"> <header class="modal-header text-center"> <h4 class="modal-title">'+tb_i18n.get("chat.room.chat.create")+'</h4> <a class="modal-close icon icon-remove" data-dismiss="modal"></a> ';return t.isGroupChatEnabled&&(e+=' <ul class="nav nav-tabs section-switcher"> <li class="btn btn-link ',"member"===t.type&&(e+="active"),e+='" data-type="member">'+tb_i18n.get("chat.room.new.private.msg")+'</li> <li class="btn btn-link  ',"project"===t.type&&(e+="active"),e+='" data-type="project">'+tb_i18n.get("chat.room.new.project.msg")+"</li> </ul> "),e+=' </header> <div class="modal-body"> <div class="chat-room-add-search"></div> <div class="item-list-wrapper scrollable thin-scroll"></div> </div></div>'}},function(t,e){t.exports=function(t){var e='<span class="icon icon-search"></span><input class="form-control search-input" type="search" autofocus="autofocus" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="';return"member"===t.type?e+=""+tb_i18n.get("organization.statistics.searchMember"):"project"===t.type&&(e+=""+tb_i18n.get("organization.statistics.searchProject")),e+='">'}},function(t,e){t.exports=function(t){var e="";if(t.items.length){e+=' <ul class="items-list"> ';var i=t.items;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <li class="item item-detail ',0===r&&(e+="active"),e+=" ","project"!==t.type||n.isOpen||(e+="is-closed"),e+='" data-gta="event" data-label="create new chat" data-id="'+n.id+'"> <div class="avatar pull-left '+t.type+'" style="background-image: url('+n.avatarUrl+')"></div> <div class="item-info"> <p class="item-name '+t.type+'">'+n.name+"</p> ","member"===t.type&&(e+=' <p class="item-title muted">'+(n.title||n.email||"")+"</p> "),e+=" ","project"!==t.type||n.isOpen||(e+=' <span class="closed-room"> '+tb_i18n.get("chat.room.cloesd.room")+" </span> "),e+=" </div> </li> ";e+=" </ul>"}else e+=' <div class="empty-tip"> <span class="icon icon-search-member"></span> <div class="tips"> <p>'+tb_i18n.get("chat.room.member.empty1")+'</p> <p class="tip-small">'+tb_i18n.get("chat.room.member.empty2")+"</p> </div> </div>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;l=i(358),u=i(678),c=i(788),r=i(1313),a=i(1315),o=i(1316),s=i(1317),p=function(t){return function(e){return e.model.get("_id")===t.get("_id")}},t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.viewName="ChatMessageListView",e.prototype.className="chat-message-list-view thin-scroll",e.prototype.events={"click .refresh-handler":"onClickOnRefreshHandler"},e.prototype.initialize=function(t){return this.options=t||{},this.onClick=this.options.onClick||function(){},this.onRefresh=this.options.onRefresh||function(){},this.activeMessageId=this.options.activeMessageId||null,this},e.prototype.handleAppend=function(t){var e;if(l.every(this.subViews,l.negate(p(t))))return e=this.renderMessage(t),this.$el.append(e.$el)},e.prototype.handlePrepend=function(t){var e;if(l.every(this.subViews,l.negate(p(t))))return e=this.renderMessage(t),this.$el.prepend(e.$el)},e.prototype.onActive=function(t){var e;return this.activeMessageId=t,e=function(e){return e.model.get("_id")===t?e.onActive():e.isActive?e.onInactive():void 0},this.subViews.forEach(e)},e.prototype.onAdd=function(t){return this.onClearStatus(),t.get("_id")===this.activeMessageId?void this.handlePrepend(t):t.isUnread()?void this.handlePrepend(t):this.handleAppend(t)},e.prototype.onClickOnRefreshHandler=function(t){return t.stopPropagation(),this.onClearStatus(),this.onRefresh()},e.prototype.onClearStatus=function(){if(this.emptyView&&(this.emptyView.remove(),this.emptyView=null),this.errorView&&(this.errorView.remove(),this.errorView=null),this.loadView)return this.loadView.remove(),this.loadView=null},e.prototype.onEmpty=function(){return this.onClearStatus(),this.renderEmpty()},e.prototype.onError=function(){return this.onClearStatus(),this.renderError()},e.prototype.onLead=function(t){var e;return this.onClearStatus(),e=l.find(this.subViews,p(t)),e&&0!==e.$el.index()?e.$el.insertBefore(this.$el.children().eq(0)):this.handlePrepend(t)},e.prototype.onLoaded=function(){return this.renderLoaded(),this.onClearStatus()},e.prototype.onLoading=function(){return this.renderLoading()},e.prototype.onRemove=function(t){var e;if(e=l.find(this.subViews,p(t)))return e.onRemove()},e.prototype.onReplace=function(t){var e;if(this.onClearStatus(),e=l.find(this.subViews,function(e){return e.model.getTargetId()===t.getTargetId()}))return this.activeMessageId===e.model.get("_id")&&(this.activeMessageId=t.get("_id")),e.onReplace({message:t,activeMessageId:this.activeMessageId})},e.prototype.onReset=function(){return this.$el.empty()},e.prototype.onSetup=function(t){return this.chatsCollection=t,0===this.chatsCollection.length?this.renderEmpty():this.renderMessages()},e.prototype.onUpdateActiveMessageId=function(t){return this.activeMessageId=t},e.prototype.renderEmpty=function(){return this.emptyView=$(o()),this.$el.html(this.emptyView)},e.prototype.renderError=function(){return this.errorView=$(s()),this.$el.html(this.errorView)},e.prototype.renderLoading=function(){return this.loadView=$(a()),this.$el.append(this.loadView),this.showLoadingIndicator(this.loadView)},e.prototype.renderLoaded=function(){return this.hideLoadingIndicator()},e.prototype.renderMessage=function(t){return this.requestSubView(r,{message:t,activeMessageId:this.activeMessageId,onClick:function(t){return function(e){return u.gta.event({action:"open detail",type:"chat",control:t.options.from||""}),t.onClick(e)}}(this)})},e.prototype.renderMessages=function(){return l.each(this.chatsCollection,function(t){return function(e){var i;return i=t.renderMessage(e),t.$el.append(i.$el)}}(this))},e}(c)},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;s=i(358),o=i(788),c=i(820),n=i(1314),a=function(t,e){return t+=e.value},t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="ChatMessageView",e.prototype.className="chat-message-view",e.prototype.events={click:"onClickMessage","click .delete-handler":"onDeleteMessage"},e.prototype.initialize=function(t){return null==t&&(t={}),this.options=t,this.model=this.options.message,this.onClick=this.options.onClick||function(){},this.activeMessageId=this.options.activeMessageId,this.isActive=this.activeMessageId===this.model.get("_id"),this.isRemoving=!1,this.onClearUnread=s.debounce(this.onClearUnread,100),this.render(),this.listen(),this.isActive&&this.onClearUnread(),this},e.prototype.listen=function(){return this.listenTo(this.model,"change:title",function(t){return function(){return t.renderTitle()}}(this)),this.listenTo(this.model,"change:unreadActivitiesCount",function(t){return function(e,i){return t.isActive?t.onClearUnread():t.renderUnreadCount()}}(this)),this.listenTo(this.model,"change:isRead",function(t){return function(){return t.renderReaded()}}(this)),this.listenTo(this.model,"change:isMute change:isAted",this.render)},e.prototype.onActive=function(){return this.isActive=!0,this.renderActive(),this.model.onRead()},e.prototype.onInactive=function(){return this.isActive=!1,this.renderActive()},e.prototype.onClearUnread=function(){var t;return t=this.$(".message-unread-count"),t.hide(),this.model.onRead()},e.prototype.onClickMessage=function(t){return t.stopPropagation(),this.model.onRead(),this.onClick(this.model.get("_id"))},e.prototype.onDeleteMessage=function(t){return t.stopPropagation(),this.onRemove()},e.prototype.onReplace=function(t){return this.stopListening(),this.model=t.message,this.activeMessageId=t.activeMessageId,this.isActive=this.activeMessageId===this.model.get("_id"),this.render(),this.listen()},e.prototype.onRemove=function(){if(!this.isRemoving)return this.isRemoving=!0,this.$el.slideUp(150,"swing",function(t){return function(){return t.model.onRemove(),t.remove()}}(this))},e.prototype.render=function(){var t;return t=this.model.genMessage(),this.$el.html(n({message:t})),this.renderActive(),this.renderReaded(),this.renderTitle(),this.renderUnreadCount()},e.prototype.renderActive=function(){return this.isActive?this.$el.addClass("is-active"):this.$el.removeClass("is-active")},e.prototype.renderReaded=function(){return this.model.get("isRead")?this.$el.addClass("is-readed"):this.$el.removeClass("is-readed")},e.prototype.renderTitle=function(){var t,e,i;return e=this.model.genMessage(),i=c.translate(e.title).reduce(a,""),t=this.$(".message-info .content"),t.html(i)},e.prototype.renderUnreadCount=function(){var t;return t=this.$(".message-unread-count"),this.model.get("unreadActivitiesCount")>0?(t.show(),this.$(".message-unread-count.normal-mode").text(this.model.get("unreadActivitiesCount"))):t.hide()},e}(o)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i=" ";return t.message.project&&t.message.project.logo?i+=' <i class="message-avatar is-corner no-avatar" style="background-image: url('+t.message.project.logo+')"></i> ':t.message.creator&&t.message.creator.avatarUrl&&(i+=' <i class="message-avatar is-circle no-avatar" style="background-image: url('+t.message.creator.avatarUrl+')"></i> '),i+='<div class="message-info"> <p class="name">  ',t.message.project&&t.message.project.name?i+=" "+e(t.message.project.name)+" ":t.message.creator&&t.message.creator.name&&(i+=" "+e(t.message.creator.name)+" "),i+=" ",t.message.isMute&&(i+=' <span class="icon-mute icon"></span> '),i+=' </p> <p class="content-wrap"> ',t.message.isAted&&(i+=' <span class="badge-at">'+tb_i18n.get("chat.message.at.me")+"</span> "),i+=' <span class="content"></span> </p></div><div class="message-handlers"> <div class="message-handler-group"> <a class="message-handler delete-handler" data-id="'+t.message._id+'"> <i class="icon icon-remove"></i> </a> </div> ',i+=t.message.isMute?' <div class="mute-point message-unread-count"></div> ':' <div class="normal-mode message-unread-count"></div> ',i+="</div>"}},function(t,e){t.exports=function(t){var e='<div class="status-handler load-handler"></div>';return e}},function(t,e){t.exports=function(t){var e='<div class="status-handler empty-handler"> <center> '+tb_i18n.get("chat.message.list.is.empty")+" </center></div>";return e}},function(t,e){t.exports=function(t){var e='<div class="status-handler error-handler"> <center> '+tb_i18n.get("chat.message.list.is.error")+' <a class="refresh-handler">'+tb_i18n.get("chat.message.list.to.refresh")+"</a> </center></div>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h=function(t,e){function i(){this.constructor=t}for(var n in e)m.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},m={}.hasOwnProperty;u=i(358),d=i(678),l=i(797),p=i(788),o=i(1193),r=i(1192),c=i(1319),s=i(1321),n=i(1326),a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.viewName="DirectMessagePanelView",e.prototype.className="chat-room-panel-view direct-message-panel-view",e.prototype.initialize=function(t){var e;return e=t.modelId,this.roomId=t.roomId,this.chatType="users",this.messageModel=t.messageModel,this.renderBasic(),this.setupScroll(this.$(".direct-messages-content")),this.setupLoadMore(0,!0),this.collection=new r,this.roomId?this.load():this.collection.getRoomInfo(this.chatType,e,{success:function(t){return function(e){var i;return t.roomId=e._id,null!=(i=t.messageModel)&&i.set({_objectId:e._id},{silent:!0}),t.load()}}(this)}),this},e.prototype.renderBasic=function(){return this.$el.html(n({chatType:this.chatType})),this.$messageList=this.$(".direct-message-list"),this},e.prototype.load=function(t){return null==t&&(t={}),this.showLoadingIndicator(this.$messageList,{isPrepend:!0}),r.fetch(this.roomId,{url:"rooms/"+this.roomId+"/activities",success:function(t){return function(e){if(t.$el)return t.collection=e,t.hideLoadingIndicator(),t.renderDirectMessages(),t.renderDirectMessageCreator(),t.scrollToBottom(),t.listen()}}(this),error:this.close.bind(this)}),this},e.prototype.loadMore=function(t){if(!this.loadingMore)return this.collection.loadMore({url:"rooms/"+this.roomId+"/activities",attrs:{maxId:this.collection.at(0).id},silent:!0,beforeSend:function(t){return function(){if(t.$el)return t.loadingMore=!0,t.showLoadingIndicator(t.$messageList,{isPrepend:!0})}}(this),success:function(e){return function(i,n){var r,o;if(e.$el)return e.collection.hasMore&&t(),o=e.$messageList.height(),(null!=n?n.length:void 0)&&e.renderMoreMessages(n),r=e.$messageList.height(),e.$(".direct-messages-content").scrollTop(r-o)}}(this),complete:function(t){return function(){if(t.$el)return t.loadingMore=!1,t.hideLoadingIndicator({animated:!0})}}(this)}),this},e.prototype.listen=function(){return this.listenTo(this.collection,"add",function(t){var e,i;if(e=this.isScrollToBottom(t),i=[this.chatType,this.roomId],t.chatType=i[0],t.roomId=i[1],this.renderDirectMessage(t),e)return this.scrollToBottom()}),this},e.prototype.renderDirectMessages=function(){var t;return null!=(t=this.$messageList)&&t.empty(),this.collection.each(function(t){return function(e){var i;return i=[t.chatType,t.roomId],e.chatType=i[0],e.roomId=i[1],t.renderDirectMessage(e)}}(this)),this},e.prototype.renderMoreMessages=function(t){return t.sort(function(t,e){return new Date(e.created||0).getTime()-new Date(t.created||0).getTime()}),u.each(t,function(t){return function(e){var i,n;return i=new o(e),n=[t.chatType,t.roomId],i.chatType=n[0],i.roomId=n[1],t.renderDirectMessage(i,!0)}}(this)),this},e.prototype.renderDirectMessage=function(t,e){if(t)return this.requestSubView(c,{messageModel:t}).$el[e?"prependTo":"appendTo"](this.$messageList),this},e.prototype.renderDirectMessageCreator=function(){return this.directMessageCreatorView=this.requestSubView(s,{roomId:this.roomId,collection:this.collection}),this.$(".chat-room-creator-wrapper").html(this.directMessageCreatorView.$el),this},e.prototype.scrollToBottom=function(){return u.delay(function(t){return function(){return t.slideTo()}}(this)),this},e.prototype.isScrollToBottom=function(t){var e,i,n,r;return r=!1,t.get("_creatorId")===d.user.id&&(r=!0),r||(i=this.$(".direct-messages-content"),e=this.$(".place-bottom"),n=e.offset().top-(i.offset().top+i.height()),r=n<100),r},e.prototype.close=function(t){return this.remove(),this},e}(p),u.extend(a.prototype,l),t.exports=a},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j=function(t,e){
return function(){return t.apply(e,arguments)}},T=function(t,e){function i(){this.constructor=t}for(var n in e)M.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},M={}.hasOwnProperty;b=i(358),_=i(678),k=i(679),w=i(820),r=i(411),p=i(677),f=i(788),n=i(401),v=i(792),y=i(810),c=i(794),l=i(982),g=i(786),o=i(1190),a=i(1320),m=1,h=60,d=100,u=200,t.exports=s=function(t){function e(){return this.voiceEnd=j(this.voiceEnd,this),this.voiceTimeUpdate=j(this.voiceTimeUpdate,this),this.voiceState=j(this.voiceState,this),e.__super__.constructor.apply(this,arguments)}return T(e,t),e.prototype.viewName="MessageItemView",e.prototype.tagName="li",e.prototype.className="message-item",e.prototype.events={"click .download-attachments-handler":"downloadAttachments","click .previewer-handler":"enterPreviewer","click .message-voice-wrapper":"voiceCtrl","click .share-content":"openSharingDetail"},e.prototype.initialize=function(t){var e,i;if(null!=t?t.messageModel:void 0)return this.options=t,this.messageModel=t.messageModel,this.worksCollection=y.get("chatMessage_"+this.messageModel.id,{isRemoveAfterMove:!1}),this.worksCollection.set(this.messageModel.getAttachmentDatas(),{sort:!1}),this.render().listen(),(null!=(e=this.messageModel.get("creator"))?e._id:void 0)===_.user.id&&this.$el.addClass("creator"),(null!=(i=this.messageModel.get("attachments"))?i.length:void 0)&&this.$el.addClass("attachments"),this},e.prototype.listen=function(){return this.listenTo(this.messageModel,"remove destroy",this.remove),this.listenTo(this.messageModel,"change",this.render),this},e.prototype.render=function(){var t,e,i,n,o,s,c,l;for(e=this.messageModel.toJSON(),(null!=(s=e.content)?s.comment:void 0)&&(e.content.comment=w.replaceMD(null!=(c=e.content)?c.comment:void 0)),e.title||(e.title=""),e.creator||(e.creator={_id:"",name:""}),e.note=p.escape(e.note),e.attachments=this.messageModel.getAttachmentDatas(),l=e.attachments,i=n=0,o=l.length;n<o;i=++n)t=l[i],e.attachments[i]=this.generateDynamicThumbnail(t);return e._userMeId=_.user.id,e.permissions={put:e.creator._id===_.user.id,del:e.creator._id===_.user.id,workGetDownload:!0},e.share=this.formatShareData(e.content.share),e.voice=this.formatVoiceData(e.content.voice),this.$el.html(a(e)).attr("data-id",this.messageModel.id),e.voice&&!this.audio&&this.voiceInit(),this.$("time").timesince(),this.$("pre code").each(function(){return r.highlightBlock(this)}),this},e.prototype.formatShareData=function(t){return t?(t=b.clone(t),t.fileName=t.title,t.fileType=t.type,t.thumbnail=t.imgUrl,t):null},e.prototype.formatVoiceData=function(t){var e,i;return t?(t=b.clone(t),i=t.duration,t.durationFormat=this.voiceDurationFormat(i),e=i>=h?u:i>m?d+Math.floor((i-m)*(u-d)/(h-m)):d,t.barWidth=e+"px",t):null},e.prototype.openSharingDetail=function(t){var e,i,n;return e=$(t.currentTarget),n=e.data("type"),"file"===n&&(n="work"),i=e.data("id"),this.requestSubView(g).open(c,{objectType:n,objectId:i,fixedModal:!0,isChatRoom:!0}),this},e.prototype.downloadAttachments=function(t){var e,i,n,r,o,s;return e=this.messageModel.getAttachmentDatas(),e&&e.length?(e.length>1?(i=p.getStrikerDownloadConfig(),r=e[0].fileName,o=r.indexOf("."),s=r.slice(0,o),s=s+"_"+tb_i18n.get("activity.moreAttachments")+"_"+e.length+"_"+tb_i18n.get("activity.moreFiles")+"_teambition",n={httpMethod:"POST"},n.data={zipName:s,downloadUrls:e.map(function(t){return t.downloadUrl})}):e.length&&(i=e[0].downloadUrl,n=""),$.fileDownload(i,n)):this},e.prototype.enterPreviewer=function(t){var e;if(!_.user.get("isGhost"))return e=this.worksCollection.find(function(e){return e.get("fileKey")===$(t.currentTarget).data("key")}),e.hasPermission=function(t){return"get.download"===t},this.requestSubView(g).open(l,{isChatRoom:!0,workModel:e,workModels:this.worksCollection.models,where:"chatMessage"}),this},e.prototype.voiceInit=function(){var t,e;return this.$progress=this.$(".voice-progress"),this.$playTime=this.$(".play-time"),this.audio=new o({src:null!=(t=this.messageModel.get("content").voice)?t.previewUrl:void 0,duration:null!=(e=this.messageModel.get("content").voice)?e.duration:void 0,onStateChange:this.voiceState,onTimeUpdate:this.voiceTimeUpdate,onEnd:this.voiceEnd})},e.prototype.voiceCtrl=function(t){var e;return t.preventDefault(),null!=(e=this.audio)&&e.playClick(),this},e.prototype.voiceState=function(t){var e;return e=function(e){return function(){var i,n;return i=0,n=Math.abs(1e3*(t.duration-t.currentTime-i)),e.$progress.animate({width:"100%"},n,"linear")}}(this),this.voiceTimer&&(this.$progress.stop(!0,!0).css({width:0}).fadeIn(0),clearTimeout(this.voiceTimer),this.voiceTimer=null),t.paused?(this.$progress.stop(!0),this.$(".play-ctrl").show(),this.$(".pause-ctrl").hide()):(e(),this.$(".play-ctrl").hide(),this.$(".pause-ctrl").show()),this},e.prototype.voiceTimeUpdate=function(t){return this.$playTime.html(this.voiceDurationFormat(t.currentTime)),this},e.prototype.voiceEnd=function(){var t;return this.$playTime.html(this.voiceDurationFormat(null!=(t=this.messageModel.get("content").voice)?t.duration:void 0)),this.voiceTimer=b.delay(function(t){return function(){return t.$(".play-ctrl").show(),t.$(".pause-ctrl").hide(),t.$progress.stop(!0,!0).fadeOut(218)}}(this),400),this},e.prototype.voiceDurationFormat=function(t){var e,i;return t=Math.floor(t),e=parseInt(t/60),i=parseInt(t%60),e<10&&(e="0"+e),i<10&&(i="0"+i),e+":"+i},e.prototype.generateDynamicThumbnail=function(t){var e,i,n,r,o,s;return s=t.imageWidth||200,n=t.imageHeight||200,o=s/n,r=36,o>1?(i=Math.min(s,200),e=i/o):o<1?(e=Math.min(n,200),i=e*o):i=e=Math.min(s,200),i=Math.max(i,36),e=Math.max(e,36),t.dynamicThumbnail={width:i+"px",height:e+"px",url:k.FILE_HOST+"/thumbnail/"+t.fileKey+"/w/"+i+"/h/"+e},t},e.prototype.remove=function(){var t,i;return null!=(t=this.$clone)&&t.remove(),null!=(i=this.audio)&&i.remove(),e.__super__.remove.apply(this,arguments)},e}(f)},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(968);if(t.creator._id!==t._userMeId&&(n+='<div class="avatar img-36 img-circle ',t.creator.avatarUrl||(n+="no-avatar"),n+='" data-id="'+t.creator._id+'" ',t.creator.avatarUrl&&(n+=' style="background-image: url('+t.creator.avatarUrl+');"'),n+="></div>"),n+='<div class="message-body"> <div class="message-content bubble readable">'+e(t.content.comment,"MD")+"</div> ",t.share&&(n+=' <div class="bubble work share-content" data-type="'+t.share.type+'" data-id="'+t.share.url+'"> '+r(t.share,"description")+" </div> "),n+=" ",t.voice&&(n+=' <div class="message-voice-wrapper bubble clearfix" style="width:'+t.voice.barWidth+'"> <div class="voice-progress"></div> <span class="icon icon-play play-ctrl pull-left"></span> <span class="icon icon-pause pause-ctrl pull-left" style="display:none;"></span> <span class="play-time pull-right">'+t.voice.durationFormat+"</span> </div> "),n+=" ",t.attachments.length>0){n+=' <ul class="message-attachments"> ';var o=t.attachments;if(o)for(var s,a=-1,c=o.length-1;a<c;)s=o[a+=1],n+=" ",n+=s.thumbnail?' <li class="previewer-handler category-thumb hinted" data-key="'+s.fileKey+'" data-title="'+s.fileName+'" style="background-image: url('+s.dynamicThumbnail.url+"); width: "+s.dynamicThumbnail.width+"; height: "+s.dynamicThumbnail.height+';"> </li> ':' <li class="work previewer-handler category-'+s.fileCategory+' bubble" data-key="'+s.fileKey+'"> '+r(s,"fileSizeFix")+" </li> ",n+=" ";n+=" </ul> "}return n+=' <div class="message-info clearfix"> <div class="message-handler-set">',t.attachments.length>0&&t.permissions.workGetDownload&&(n+='<a class="btn btn-link btn-mini download-attachments-handler">'+tb_i18n.get("activity.download.all.attachments")+"</a>"),n+='</div> <span class="message-creator-name">',t.creator._id!==t._userMeId&&(n+='<span class="name-limit">'+e(t.creator.name)+"</span>"+tb_i18n.get("comma")),n+='<time class="time-stamp muted ',(t.creator._id===t._userMeId||t.attachments.length>0)&&(n+="clickable"),n+=" ",(t.permissions.put||t.permissions.del||t.attachments.length>0&&t.permissions.workGetDownload)&&(n+="removeable"),n+='" datetime="'+t.created+'"></time></span> </div></div>'}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b=function(t,e){function i(){this.constructor=t}for(var n in e)k.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},k={}.hasOwnProperty;g=i(358),y=i(678),p=i(681),d=i(677),h=i(788),s=i(401),l=i(699),f=i(810),u=i(811),o=i(819),a=i(1322),c=i(1324),m=i(966),n=i(1325),v=/https?:\/\/[^\s<]{3,}?\/(task|post|event|work)\/([0-9a-z]{24})\/?/,t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.viewName="ChatRoomCreatorView",e.prototype.tagName="div",e.prototype.className="chat-room-creator",e.prototype.events={"click .reply-handler":"submit","keydown .message-input":"quickSubmit","click .reply-menu li a":"changeQuickType","focusin .message-input":"focusAttachment","focusout .message-input":"blurAttachment","click .add-work-handler":"toggleWorksPicker","click .screen-crop-handler":"openScreenCrop","click .login-handler":"loginHandler","click .register-handler":"registerHandler","mousewheel .scrollable":d.mousewheel},e.prototype.initialize=function(t){var e,i,n;if(t.roomId)return this.options=t,this.roomId=t.roomId,this.projectModel=t.projectModel,this.collection=t.collection,this.isOpen=!this.projectModel||this.projectModel.has("navigation")&&this.projectModel.get("navigation").groupchat!==-1,this.localCache=p.namespace("temp").namespace("direct_messages"),this.localCacheId=this.roomId+"_"+y.user.id,i=this.localCache(this.localCacheId)||{},e=g.filter(i.attachments,function(t){return t.completed!==!1}),this.attachments=new f(e,{boundToObjectType:"collection",_boundToObjectId:this.roomId}),this.mentions=i.mentions||{},this.renderBasic().initUploader().initEmoji().initSortable().listen(),this.isOpen&&(this.$textareaset.val(i.content).flexText(function(t){return function(){return t.cacheChatRoom()}}(this)),(null!=(n=this.projectModel)?n.getRoleScope():void 0)>=-1&&l.fetch(this.projectModel.id,{boundToObjectType:"project",silentError:!0,error:function(){},success:function(t){return function(e){if(t.$textareaset.length)return t.initAt(e)}}(this)})),this},e.prototype.renderBasic=function(){var t,e;return e=y.user.toJSON(),e.isGhost&&this.$el.addClass("ghost"),this.$el.html(n({user:e,quickReply:y.PREFERENCE.quickReply(),isOpen:this.isOpen,isShowCropBtn:null!=(null!=(t=window.TbScreenshotD)?t.startScreenShot:void 0)})),this.$textareaset=this.$(".message-input"),this.$attachmentsList=this.$(".attachments-list"),this.$quickCreate=this.$(".quick-create"),this.$submit=this.$(".reply-handler"),this.$attachmentsList.css("max-height",Math.max(52*this.attachments.length,100)),this.attachments.each(function(t){return function(e){return t.renderAttachment(e)}}(this)),this},e.prototype.submit=function(t,e){var i,n,r;if(null==e&&(e="click"),!this.$submit.prop("disabled")){if(i=this.attachments.getUploadingCount())return void s.show({message:tb_i18n.get("works.uploader.uploading.total",i),status:"warning"});if(r=this.$textareaset.val().trim(),r||this.attachments.length)return this.disableSubmit(!0),this.attachments.length&&(n=this.$attachmentsList.find(".work").map(function(){return $(this).data("cid")}).toArray(),this.attachments.comparator=function(t,e){return n.indexOf(t.cid)-n.indexOf(e.cid)},this.attachments.sort()),Promise.resolve().then(function(t){return function(){return new Promise(function(e,i){return t.collection.create({_creatorId:y.user.id,content:r,mentions:t.mentions,attachments:t.attachments.toJSON(),_boundToObjectId:t.collection._boundToObjectId,boundToObjectType:t.collection.boundToObjectType},{url:"rooms/"+t.roomId+"/activities",wait:!0,success:function(t){return t.initialize(),e()},error:i})})}}(this)).then(function(t){return function(){if(y.gta.event({action:"added content",type:"chat",control:"comment box",method:e}),t.$el)return t.mentions={},t.$attachmentsList.empty(),t.attachments.reset(),t.$textareaset.val(""),t.$textareaset.trigger("change"),t.$el.removeClass("active"),t.localCache.remove(t.localCacheId)}}(this))["catch"](function(t){return s.show({message:t,status:"error"}),y.gta.event(null,"submit","add direct message failed")}).then(function(t){return function(){if(t.$el)return t.disableSubmit(!1),t.$textareaset.focusAtEnd()}}(this)),this}},e.prototype.disableSubmit=function(t){return this.$submit.prop("disabled",t),this.$submit[t?"addClass":"removeClass"]("disabled"),this},e.prototype.changeQuickType=function(t){var e;return e=$(t.currentTarget),e.hasClass("active")||(this.$(".reply-menu li a").removeClass("active"),e.addClass("active"),"only-enter"===e.data("type")?y.PREFERENCE.quickReply(!0):y.PREFERENCE.quickReply(!1)),this.$textareaset.focusAtEnd(),this},e.prototype.quickSubmit=function(t){return 13===t.keyCode&&!(t.ctrlKey||t.metaKey||t.shiftKey)&&y.PREFERENCE.quickReply()?(t.preventDefault(),this.submit(null,"keyboard")):13===t.keyCode&&(t.ctrlKey||t.metaKey||t.shiftKey)&&!y.PREFERENCE.quickReply()&&(t.preventDefault(),this.submit(null,"keyboard")),this},e.prototype.listen=function(){return this.listenTo(this.attachments,"add",this.renderAttachment),this.listenTo(this.attachments,"add change remove",this.cacheChatRoom),this.listenTo(this.attachments,"add remove reset",function(t){return function(){return t.attachments.length?t.$attachmentsList.css("max-height",Math.max(52*t.attachments.length,100)):t.deactiveAttachment()}}(this)),this},e.prototype.initUploader=function(){var t,e;return null!=(e=this.FileUploaderView)&&e.remove(),t={collection:this.attachments,pick:null,dnd:this.$el,paste:this.$textareaset},this.isOpen&&(this.FileUploaderView=this.requestSubView(c,t)),this},e.prototype.initEmoji=function(){return this.isOpen&&(this.fastEmojiView=this.requestSubView(o,{$toggler:this.$(".message-box-wrap .add-emoji-handler"),select:function(t){return function(e){return t.insertEmoji(e)}}(this)}),this.fastEmojiView.$el.appendTo(this.$(".chat-room-creator-fast-emoji")),this.activeEmojiView=this.requestSubView(o,{$toggler:this.$(".chat-room-handler .add-emoji-handler"),select:function(t){return function(e){return t.insertEmoji(e)}}(this)}),this.activeEmojiView.$el.appendTo(this.$(".chat-room-creator-active-emoji"))),this},e.prototype.insertEmoji=function(t){var e,i,n,r;return e=this.$(".message-input"),r=e.val().replace(/\n/g,""),i=e[0].selectionStart,r=r.slice(0,i)+t+r.slice(i),r=r.replace(/\r/g,"\r\n"),e.val(r).change(),n=i+t.length,e.selectRange(n,n)},e.prototype.initSortable=function(){return this.$attachmentsList.sortable({items:".work",helper:"clone",placeholder:"work-drag-placeholder",tolerance:"pointer",zIndex:2001,axis:"y",scroll:!1}),this},e.prototype.initAt=function(t){return this.symbolPopoverView=this.requestSubView(u,{$inputor:this.$textareaset,at:"@",fixed:!0,membersData:{projectMembers:t.toJSON(),organizationMembers:{}},select:function(t){return function(e,i){return t.selectAt(e,i)}}(this)}),this},e.prototype.selectAt=function(t,e){return this.mentions[t]=e.name,this.cacheChatRoom(),this},e.prototype.toggleWorksPicker=function(t){var e;return this.isOpen&&(e=$(t.currentTarget),e.data("bs.popover")||this.requestSubView(a,{collection:this.attachments,projectModel:this.projectModel?this.projectModel:void 0,$toggler:e,placement:"auto top"}).show()),this},e.prototype.openScreenCrop=function(){var t;if(null!=(null!=(t=window.TbScreenshotD)?t.startScreenShot:void 0))return this.$textareaset.focusAtEnd(),window.TbScreenshotD.startScreenShot()},e.prototype.focusAttachment=function(){return this.$el.addClass("focus"),this.$el.addClass("active"),this.$el.handleClickOutside(function(t){return function(){return t.deactiveAttachment()}}(this),"click",".file-picker, #atwho-container"),this},e.prototype.blurAttachment=function(){return this.$el.removeClass("focus"),this},e.prototype.loginHandler=function(t){return y.router.gotoLogin(),this},e.prototype.registerHandler=function(t){return y.router.gotoRegister(),this},e.prototype.renderAttachment=function(t){return this.requestSubView(m,{workModel:t}).$el.appendTo(this.$attachmentsList),this.$attachmentsList.scrollTop(999),this.$(".message-input").focusAtEnd(),this},e.prototype.cacheChatRoom=function(){var t,e,i,n;t=this.$textareaset.val().trim(),i=this.mentions;for(e in i)n=i[e],t.indexOf("@"+n)<0&&delete this.mentions[e];return this.localCache(this.localCacheId,{content:t,attachments:this.attachments.toJSON(),mentions:this.mentions}),this},e.prototype.deactiveAttachment=function(){return this.attachments.length||this.$textareaset.val().trim()||(this.$textareaset.val(""),this.$textareaset.trigger("change"),this.$el.removeClass("active")),this},e.prototype.show=function(){return g.delay(function(t){return function(){var e,i;if(t.$el)return i=t.$el.height(),i>0?(e={display:"block",height:"0px",overflow:"hidden"},t.$el.css(e),t.$el.on("transitionend.chat-room-creator",function(t){var e;if(e=$(t.target),e.hasClass("chat-room-creator"))return e.off(".chat-room-creator"),e.addClass("showing"),e.removeAttr("style")}),g.delay(function(){if(t.$el)return t.$el.height(i)},10)):t.$el.addClass("showing")}}(this),100)},e.prototype.remove=function(){var t;return null!=(t=this.atwho)&&t.shutdown(),e.__super__.remove.apply(this,arguments)},e}(h)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},v={}.hasOwnProperty;u=i(358),f=i(678),d=i(679),n=i(1323),r=i(927),s=i(680),a=i(813),c=i(677),l=i(786),o=i(1324),h=window.Dropbox,m=function(t,e,i){switch(t){case"remote":e=JSON.stringify({downloadUrl:e,source:t});break;case"dropbox":e=JSON.stringify({files:u.isArray(e)?e:[e],source:t})}return s.ajax({url:d.FILE_HOST+"/forremote",type:"POST",headers:{authorization:f.user.get("strikerAuth")},contentType:"application/json",dataType:"json",data:e,success:i})},t.exports=p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.viewName="WorksPickerView",e.prototype.popoverTitle="",e.prototype.events={"click .library-picker-handler":"attachFromLibrary","click .dropbox-picker-handler":"attachFromDropbox","click .uploader-handler":"hide","click .remote-picker-handler":"attachFromRemote"},e.prototype.initialize=function(){return this.popoverTitle=tb_i18n.get("work.picker.title"),e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){return this.$el.html(n({dropbox:!!h})),this.initUploader(),this},e.prototype.initUploader=function(){var t,e,i,n;return this.projectModel=null!=(e=this.options)?e.projectModel:void 0,null!=(i=this.uploaderView)&&i.remove(),t={collection:this.options.collection,projectModel:this.projectModel,pick:{id:this.$(".uploader-handler"),multiple:!0},fileSingleSizeLimit:this.options.fileSingleSizeLimit||(null!=(n=this.projectModel)?n.getPaymentPlan().fileSizeLimit:void 0),onStart:function(t){return function(){return t.hide()}}(this)},this.options.server&&(t.server=this.options.server),this.uploaderView=this.requestSubView(o,t),this},e.prototype.attachFromLibrary=function(){var t;return this.hide(),null!=(t=this.picker)&&t.remove(),this.picker=this.requestSubView(l).open(r,{multiple:!0,onlyWorks:!0,title:tb_i18n.get("work.picker.from.library"),select:function(t){return function(e){var i;return t.options.collection.add(e,{parse:!0}),t.options.collection.trigger("change:completed"),"function"==typeof(i=t.options).success?i.success(e):void 0}}(this)})},e.prototype.attachFromDropbox=function(){var t;if(h)return this.hide(),t={success:function(t){return function(e){return m("dropbox",e,function(e){var i,n,r,o,s,a;if(!e.works)return"function"==typeof(i=t.options).error?i.error(e.message):void 0;for(s=e.works,r=0,o=s.length;r<o;r++)a=s[r],a.progress=1,a.completed=!0;return t.options.collection.add(e.works,{parse:!0}),t.options.collection.trigger("change:completed"),"function"==typeof(n=t.options).success?n.success(e.works):void 0})}}(this),cancel:function(){},linkType:"preview",multiselect:!0},h.choose(t),this},e.prototype.attachFromRemote=function(t){var e,i,n;if(this.hide(),e=this.$(".remote-input-wrap input"),i=e.val().trim())return n=this.options.collection.add({downloadUrl:i,progress:0},{parse:!0}),m("remote",i,function(t){return function(e){var i,r;return e.message?"function"==typeof(i=t.options).error?i.error(e.message):void 0:(e.progress=1,e.completed=!0,n.set(n.parse(e)),"function"==typeof(r=t.options).success?r.success(e):void 0)}}(this)),this},e}(a)},function(t,e){t.exports=function(t){var e='<ul class="list file-picker"> <li> <a class="uploader-handler" data-gta="event" data-label="Choose file from computer"> <span class="icon icon-upload"></span>'+tb_i18n.get("work.picker.uploader")+' </a> </li> <li class="list-divider"></li> ';return t.dropbox&&(e+=' <li> <a class="dropbox-picker-handler" data-gta="event" data-label="Choose file from dropbox"> <span class="icon icon-dropbox"></span>'+tb_i18n.get("work.picker.from.dropbox")+" </a> </li> "),e+=' <li class="list-divider"></li> <li class="remote-input-wrap"> <input type="text" placeholder="'+tb_i18n.get("work.picker.from.link")+'" class="form-control pull-left"/> <span class="btn btn-default remote-picker-handler pull-right">'+tb_i18n.get("add")+"</span> </li></ul>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;p=i(358),u=i(678),o=i(925),a=i(788),l=i(810),n=i(401),c=i(786),s=i(926),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.viewName="FileUploaderView",e.prototype.initialize=function(t){return t.collection||(t.collection=new l([],{_boundToObjectId:t._parentId})),this.collection=t.collection,this.options=p.extend({accept:null,onCreate:function(t){return function(e){var i;return e.progress=0,e.completed=!1,i=t.collection.add(e),i.set("completed",!1),i}}(this),onProgress:function(t,e){return e.set("progress",t)},onComplete:function(t,e){return t.thumbnailUrl&&(t.thumbnail=t.thumbnailUrl),e.set(t),e.set("completed",!0)},onError:function(t){return function(e,i){return t.options.isBackground&&n.show({message:tb_i18n.get("works.background.uploader.error"),status:"error"}),t.collection.remove(i)}}(this),errorHandler:function(e){return function(i,n,r){return"F_EXCEED_SIZE"===n?e.requestSubView(c).open(s,{projectModel:t.projectModel,fileName:r.name}):i()}}(this)},t),this.uploader=new o(this.options).uploader,this},e.prototype.getData=function(){return this.collection.toJSON()},e.prototype.remove=function(){var t,i,n,r;return r=this.uploader,r&&(n=r.getStats(),(null!=(i=this.options)?i.isBackground:void 0)&&(n.progressNum||n.queueNum)?(t=p.find(r._widgets,function(t){return"dnd"===t.name}),null!=t&&"function"==typeof t.destroy&&t.destroy(),r.on("uploadFinished",function(){return r.destroy()})):r.destroy()),e.__super__.remove.apply(this,arguments)},e}(a)},function(t,e){t.exports=function(t){var e='<div class="chat-room-creator-wrap"> ';return t.user.isGhost?e+=" "+tb_i18n.get("activity.timeline.comment.ghost")+" ":(e+=' <div class="chat-room-creator-fast-emoji"></div> <div class="message-box-wrap ',t.isOpen||(e+="is-closed"),e+='"> <div class="message-box-icon-wrap"> ',t.isShowCropBtn&&(e+=' <a class="screen-crop-handler icon icon-crop hinted" data-title="'+tb_i18n.get("screen.crop")+'"></a> '),e+=' <a class="add-emoji-handler icon icon-emoji hinted" data-title="'+tb_i18n.get("chat.room.add.emoji")+'" data-gta="event" data-label="chat-room add emoji"></a> <a class="add-work-handler icon icon-paperclip hinted" data-title="'+tb_i18n.get("activity.timeline.add.attachment")+'" data-gta="event" data-label="chat-room add works"></a> </div> <div class="message-box-input-wrap"> <textarea type="text" placeholder="',e+=t.isOpen?""+tb_i18n.get("chat.room.placeholder"):""+tb_i18n.get("chat.room.cloesd.room.placeholder"),e+='" ',t.isOpen||(e+="disabled"),e+=' class="form-control message-input"></textarea> </div> <ul class="attachments-list scrollable thin-scroll clearfix"></ul> </div> <div class="chat-room-creator-active-emoji"></div> <div class="chat-room-handler clearfix"> <a class="add-work-handler icon icon-paperclip hinted" data-title="'+tb_i18n.get("activity.timeline.add.attachment")+'" data-gta="event" data-label="chat-room add works"></a> <a class="add-emoji-handler icon icon-emoji hinted" data-title="'+tb_i18n.get("chat.room.add.emoji")+'" data-gta="event" data-label="chat-room add emoji"></a> ',t.isShowCropBtn&&(e+=' <a class="screen-crop-handler icon icon-crop hinted" data-title="'+tb_i18n.get("screen.crop")+'"></a> '),e+=' <span class="dropdown pull-right reply-btn"> <span class="reply-handler">'+tb_i18n.get("chat.room.send")+'</span> <span class="reply-line"></span> <a class="reply-switch" data-toggle="dropdown"> <i class="icon icon-chevron-down"></i> </a> <ul class="dropdown-menu reply-menu" role="menu" aria-labelledby="dLabel"> <li><a class="',t.quickReply&&(e+="active"),e+='" data-type="only-enter"><span>'+tb_i18n.get("activity.timeline.reply.enter")+'</span><i class="icon icon-tick"></i></a></li> <li><a class="',t.quickReply||(e+="active"),e+='" data-type="ctrl-enter"><span>'+tb_i18n.get("activity.timeline.reply.shortcut")+'</span><i class="icon icon-tick"></i></a></li> </ul> </span> </div> '),e+="</div>"}},function(t,e){t.exports=function(t){var e='<div class="panel-layer"> <div class="chat-room-panel-wrap direct-message-panel-wrap"> <section class="direct-messages-content scrollable thin-scroll"> <ul class="direct-message-list"></ul> <div class="empty-tip chat-private"> <span class="icon icon-chat-group"></span> <div class="tips"> <p>'+tb_i18n.get("chat.room.chat.empty1")+'</p> <p class="tip-small">'+tb_i18n.get("chat.room.chat.empty2")+'</p> </div> </div> <div class="place-bottom"></div> </section> <footer class="chat-room-creator-wrapper"></footer> </div></div>';return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y=function(t,e){function i(){this.constructor=t}for(var n in e)b.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},b={}.hasOwnProperty;g=i(358),v=i(678),h=i(797),m=i(788),s=i(680),r=i(1192),o=i(1193),p=i(697),d=i(1328),f=i(786),u=i(1329),a=i(1319),c=i(1321),n=i(1380),l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.viewName="ProjectMessagePanelView",e.prototype.className="chat-room-panel-view project-message-panel-view",e.prototype.events={"click .switch-mute":"toggleMessageMute"},e.prototype.initialize=function(t){var e;return e=t.modelId,this.roomId=t.roomId,this.messageModel=t.messageModel,this.chatType="projects",this.projectModel=p.get(e),this.collection=new r,this.renderBasic(),this.setupScroll(this.$(".project-messages-content")),this.setupLoadMore(0,!0),this.dClearRoomUnreadMessages=g.debounce(this.clearRoomUnreadMessages,500),this.dClearRoomUnreadMessages(),this.roomModel?this.load():this.collection.getRoomInfo(this.chatType,e,{success:function(t){return function(e){var i;return t.roomId=e._id,t.roomModel=new d(e),null!=(i=t.messageModel)&&i.set({_objectId:t.roomId,isMute:t.roomModel.get("isMute")},{silent:!0}),t.load(),t.renderMute()}}(this)}),this},e.prototype.renderBasic=function(){return this.$el.html(n({chatType:this.chatType})),this.$messageList=this.$(".project-message-list"),this.$switchMute=this.$(".switch-mute"),this},e.prototype.renderMute=function(){var t;return t=this.roomModel.get("isMute"),this.$switchMute[t?"addClass":"removeClass"]("checked")},e.prototype.load=function(t){return null==t&&(t={}),this.showLoadingIndicator(this.$messageList,{isPrepend:!0}),r.fetch(this.roomId,{url:"rooms/"+this.roomId+"/activities",success:function(t){return function(e){if(t.$el)return t.collection=e,t.hideLoadingIndicator(),t.renderProjectMessages(),t.renderProjectMessageCreator(),t.scrollToBottom(),t.listen()}}(this),error:this.close.bind(this)}),this},e.prototype.loadMore=function(t){if(!this.loadingMore)return this.collection.loadMore({url:"rooms/"+this.roomId+"/activities",attrs:{maxId:this.collection.at(0).id},silent:!0,beforeSend:function(t){return function(){if(t.$el)return t.loadingMore=!0,t.showLoadingIndicator(t.$messageList,{isPrepend:!0})}}(this),success:function(e){return function(i,n){var r,o;if(e.$el)return e.collection.hasMore&&t(),o=e.$messageList.height(),(null!=n?n.length:void 0)&&e.renderMoreMessages(n),r=e.$messageList.height(),e.$(".project-messages-content").scrollTop(r-o)}}(this),complete:function(t){return function(){if(t.$el)return t.loadingMore=!1,t.hideLoadingIndicator({animated:!0})}}(this)}),this},e.prototype.listen=function(){return this.listenTo(this.collection,"add",function(t){return function(e){var i,n;if(i=t.isScrollToBottom(e),n=[t.chatType,t.roomId],e.chatType=n[0],e.roomId=n[1],t.renderProjectMessage(e),i)return t.scrollToBottom()}}(this)),this.listenTo(this.roomModel,"change",this.renderMute),this.listenTo(this.collection,"add",function(t){return function(e){if(e.get("creator")._id!==v.user.get("_id"))return t.dClearRoomUnreadMessages()}}(this)),this},e.prototype.renderProjectMessages=function(){var t;return null!=(t=this.$messageList)&&t.empty(),this.collection.each(function(t){return function(e){var i;return i=[t.chatType,t.roomId],e.chatType=i[0],e.roomId=i[1],t.renderProjectMessage(e)}}(this)),this},e.prototype.renderMoreMessages=function(t){return t.sort(function(t,e){return new Date(e.created||0).getTime()-new Date(t.created||0).getTime()}),g.each(t,function(t){return function(e){var i,n;return i=new o(e),n=[t.chatType,t.roomId],i.chatType=n[0],i.roomId=n[1],t.renderProjectMessage(i,!0)}}(this)),this},e.prototype.renderProjectMessage=function(t,e){if(t)return this.requestSubView(a,{messageModel:t}).$el[e?"prependTo":"appendTo"](this.$messageList),this},e.prototype.renderProjectMessageCreator=function(){return this.directMessageCreatorView=this.requestSubView(c,{roomId:this.roomId,projectModel:this.projectModel,collection:this.collection}),this.$(".chat-room-creator-wrapper").html(this.directMessageCreatorView.$el),this},e.prototype.scrollToBottom=function(){return g.delay(function(t){return function(){return t.slideTo()}}(this)),this},e.prototype.isScrollToBottom=function(t){var e,i,n,r;return r=!1,t.get("_creatorId")===v.user.id&&(r=!0),r||(i=this.$(".project-messages-content"),e=this.$(".place-bottom"),n=e.offset().top-(i.offset().top+i.height()),r=n<100),r},e.prototype.close=function(t){return this.remove(),this},e.prototype.toggleMessageMute=function(t){var e,i;return e=$(t.currentTarget),i=this.roomModel.get("isMute"),this.roomModel.markMute({isMute:!i})},e.prototype.clearRoomUnreadMessages=function(){var t;return t=this.roomModel.get("_id"),s.put("rooms/"+t+"/message")},e}(m),g.extend(l.prototype,h),t.exports=l},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=i(358),n=i(688),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.name="room",e.prototype.urlRoot="rooms",e.prototype.markMute=function(t){return null==t&&(t={}),t.attrs={isMute:t.isMute},t.url=this.urlRoot+"/"+this.get("_id")+"/mute",this.sync("update",this,t)},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);
return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},v={}.hasOwnProperty;m=i(358),f=i(678),n=i(357),d=i(788),r=i(401),o=i(684),h=i(786),u=i(1330),s=i(1332),c=i(1353),l=i(1355),a=i(1369),t.exports=p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.viewName="ProjectSettingsView",e.prototype.className="project-settings-view",e.prototype.initialize=function(t){return this.options=null,this.loadOrganization(t).then(function(e){return function(i){var n;return e.options=m.assign(t,i),n=e.requestSubView(h),e.render(e.options,n),e.listen(e.options)}}(this))["catch"](function(t){if(t)return console.error(t)})},e.prototype.listen=function(t){if(this.listenTo(t.projectModel,"change:isArchived change:_roleId change:_orgRoleId remove destroy",function(){return this.remove()}),t.organizationModel)return this.listenTo(t.organizationModel,"change:_roleId destroy",function(){return this.remove()})},e.prototype.loadOrganization=function(t){return f.user.get("isGhost")?Promise.resolve():new Promise(function(t,e){return o.fetch(0,{success:t,error:function(t,i){return e(i)}})}).then(function(e){var i;return i=e.get(t.projectModel.get("_organizationId")),{organizationModel:i,organizationsCollection:e}})},e.prototype.isOrganization=function(){return this.options.organizationModel},e.prototype.render=function(t,e){var i;return i={title:tb_i18n.get("project.settings"),list:m.compact([{text:tb_i18n.get("project.settings.tab.infomation"),icon:"icon-project",view:function(e){return function(){return e.requestSubView(s,t).$el}}(this)},t.projectModel.getRoleScope()>=0?{text:tb_i18n.get("project.settings.tab.activity"),icon:"icon-alert-clock",view:function(e){return function(){return e.requestSubView(c,t).$el}}(this)}:void 0,{text:tb_i18n.get("project.settings.tab.preference"),icon:"icon-eye",view:function(e){return function(){return e.requestSubView(l,t).$el}}(this)},t.projectModel.hasPermission("put.archive")||t.projectModel.getCanQuit()||t.projectModel.hasPermission("del")?{text:tb_i18n.get("project.settings.tab.more"),icon:"icon-more",view:function(e){return function(){return e.requestSubView(a,t).$el}}(this)}:void 0])},this.requestSubView(h).open(u,i)},e}(d)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=i(788),n=i(1331),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.viewName="TabContainerView",e.prototype.className="tab-container-view modal-dialog",e.prototype.events={"click .tab-item":"switch"},e.prototype.initialize=function(t){return this.options=t,this.currentIndex=0,this.renderBasic()},e.prototype.renderBasic=function(){return this.$el.html(n(this.options)),this.$content=this.$(".tab-container-view-content"),this.$tabItems=this.$(".tab-item"),this.renderTab(this.currentIndex)},e.prototype["switch"]=function(t){var e;return e=$(t.currentTarget).data("index"),this.renderTab(e)},e.prototype.renderTab=function(t){var e;return e=this.options.list[t].view(),this.setActiveTab(t),this.$content.html(e)},e.prototype.setActiveTab=function(t){return $(this.$tabItems.get(this.currentIndex)).removeClass("active"),$(this.$tabItems.get(t)).addClass("active"),this.currentIndex=t},e}(o)},function(t,e){t.exports=function(t){var e='<header class="tab-container-view-header"> <center class="title"> <strong>'+t.title+'</strong> </center> <a class="close-handler" data-dismiss="modal"> <span class="icon icon-remove"></span> </a></header><div class="tab-container-view-body"> <div class="tab-list"> ',i=t.list;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <a class="tab-item" data-index="'+r+'"> <span class="icon '+n.icon+'"></span> <span class="text">'+n.text+"</span> </a> ";return e+=' </div> <div class="tab-container-view-content"> </div></div>'}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h=function(t,e){function i(){this.constructor=t}for(var n in e)m.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},m={}.hasOwnProperty;d=i(358),n=i(357),u=i(788),o=i(401),r=i(1333),p=i(1336),s=i(1337),l=i(1347),a=i(1352),t.exports=c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.viewName="ProjectSettingsInfoView",e.prototype.className="project-settings-view project-settings-info-view",e.prototype.initialize=function(t){var e;return this.projectModel=t.projectModel,this.organizationModel=t.organizationModel,this.changes={},e=this.getForm(),this.render(e,t),this.listen(e)},e.prototype.listen=function(t){return t.on("submit",d.partial(this.onSubmit,t).bind(this)),t.on("change",d.debounce(this.onChange.bind(this,t),100))},e.prototype.hasPermission=function(){return this.projectModel.hasPermission("put.info")},e.prototype.showGrouping=function(){var t;return null!=(t=this.organizationModel)?t.get("dividers").length:void 0},e.prototype.configureOrganization=function(t){var e,i,n,o,s,a,c;return a=t.schema,e=t.data,this.organizationModel?(this.showGrouping()&&(i=this.organizationModel.get("dividers"),s=this.organizationModel.get("projectIds").indexOf(this.projectModel.id),n=d.find(i,function(t,e){var n,r;return r=t.pos,e===i.length-1?r<=s:(n=i[e+1].pos,r<=s&&s<n)}),o=d.map(i,function(t,e){return{val:e,label:t.name,pos:t.pos}}).concat([{val:null,label:tb_i18n.get("project.none.section")}]),c=d.find(o,function(t){return t.pos===(null!=n?n.pos:void 0)&&t.label===(null!=n?n.name:void 0)}),a.grouping={type:r,title:tb_i18n.get("project.grouping"),options:o},e.grouping=null!=c?c.val:void 0),{schema:a,data:e}):{schema:a,data:e}},e.prototype.getForm=function(){var t,e,i,o;return o={name:{type:"Text",title:tb_i18n.get("project.name"),editorAttrs:{maxlength:30,minlength:1,autofocus:!0},validators:["required"]},description:{type:"TextArea",title:tb_i18n.get("project.desc"),editorAttrs:{rows:2,placeholder:this.hasPermission()?tb_i18n.get("project.settings.desc.placeholder"):""}},visibility:{type:r,title:tb_i18n.get("project.settings.visibility"),fieldClass:"visibility",options:d.compact([{val:"all",label:tb_i18n.get("project.setting.visibility.all")+" ("+tb_i18n.get("project.setting.visibility.info.all")+")"},this.organizationModel?{val:"organization",label:tb_i18n.get("project.setting.visibility.organization")+" ("+tb_i18n.get("project.setting.visibility.info.organization")+")"}:void 0,{val:"project",label:tb_i18n.get("project.setting.visibility.project")+" ("+tb_i18n.get("project.setting.visibility.info.project")+")"}])}},e={name:this.projectModel.get("name"),description:this.projectModel.get("description"),visibility:this.projectModel.get("visibility")},i=this.configureOrganization({schema:o,data:e}),o=i.schema,e=i.data,this.hasPermission()||(o=d.mapObject(o,function(t){return t.editorAttrs=d.assign({},t.editorAttrs,{disabled:!0}),t})),n.Form.editors.Text.prototype.events.keydown="determineChange",n.Form.validators.errMessages.required="",new(t=n.Form.extend({template:function(t){return function(){return a(t)}}(this),schema:o,data:e}))},e.prototype.onSubmit=function(t,e){var i,n,r;if(e.preventDefault(),this.hasPermission()&&!d.isEmpty(this.changes))return r=Promise.resolve(),n=d.pick(this.changes,"name","description","visibility"),d.isEmpty(n)||(r=r.then(function(t){return function(){return new Promise(function(e,i){return t.projectModel.save(null,{attrs:n,success:function(n){return t.$el?e(n):i()},error:i})})}}(this))),i=this.changes.dividerIndex,this.showGrouping()&&d.isNumber(i)&&(r=r.then(function(e){return function(){return new Promise(function(n,r){return e.projectModel.saveAttr("dividerIndex",i,{success:function(o){return t.data.grouping=i,e.$el?n(o):r()},error:r})})}}(this))),r.then(function(t){return t?Promise.resolve():Promise.reject()}).then(function(t){return function(){return t.changes={},t.disableSubmitButton(!0),o.success(tb_i18n.get("project.settings.save.success"))}}(this))["catch"](function(t){if(t)return console.error(t),o.error(t)})},e.prototype.onChange=function(t){var e,i,n;if(this.hasPermission())return n=t.data,e=t.validate(),d.isEmpty(e)?(this.changes={},i=t.getValue(),i.name!==this.projectModel.get("name")&&(this.changes.name=i.name),i.description!==this.projectModel.get("description")&&(this.changes.description=i.description),i.visibility!==this.projectModel.get("visibility")&&(this.changes.visibility=i.visibility),i.grouping!==n.grouping&&(this.changes.dividerIndex=i.grouping),this.disableSubmitButton(d.isEmpty(this.changes))):(e.name&&t.fields.name.$el.addClass("is-error"),void this.disableSubmitButton(!0))},e.prototype.disableSubmitButton=function(t){var e;if(this.$el)return e=this.$("input.submit"),e.attr("disabled",t)},e.prototype.renderNoPermissionSection=function(){if(!this.hasPermission())return this.$(".no-permission-section").html(p)},e.prototype.renderLogoSection=function(t){return this.$(".project-setting-section[data-type=project-cover]").html(this.requestSubView(l,t).$el)},e.prototype.renderBelongingSection=function(t){return this.$(".project-setting-section[data-type=project-belonging]").html(this.requestSubView(s,t).$el)},e.prototype.render=function(t,e){return t.render(),this.$el.html(t.el),this.renderNoPermissionSection(),this.renderLogoSection(e),this.renderBelongingSection(e),this.disableSubmitButton(!0)},e}(u)},function(t,e,i){var n,r,o;i(1334),n=i(357),o=i(358),t.exports=r=n.Form.Editor.extend({tagName:"div",className:"backbone-form-select",events:{"click li":"onClick","click .button":"onToggleMenu"},initialize:function(t){var e;if(n.Form.editors.Base.prototype.initialize.call(this,t),!this.schema||!this.schema.options)throw new Error("Missing required 'schema.options'");return this.isOpen=!1,this.value=t.value,this.isDisabled=null!=(e=t.schema.editorAttrs)?e.disabled:void 0},onClick:function(t){if(t.preventDefault(),!this.isDisabled)return this.setValue($(t.currentTarget).data("option")),this.$(".button").html(this.getLabel()+'<span class="icon icon-chevron-down"></span>'),this.onToggleMenu(),this.trigger("change",this)},onToggleMenu:function(){if(!this.isDisabled)return this.isOpen=!this.isOpen,this.$(".menu").toggleClass("is-open",this.isOpen),this.$(".menu").html(this.getItem(this.schema)),this.isOpen?this.$el.handleClickOutside(function(t){return function(){return t.isOpen=!1,t.$(".menu").removeClass("is-open")}}(this)):void 0},getLabel:function(){var t,e;return e=this.getValue(),e=o.isNull(e)||o.isUndefined(e)?null:e,t=o.find(this.schema.options,function(t){return t.val===e}),t&&o.escape(t.label)},getItem:function(t){return o.chain(t.options).filter(function(t){return null!==t.val}).map(function(t){return function(e){var i,n;return i=e.val===t.getValue()?"selected":"",n=e.val===t.getValue()?'<span class="icon icon-tick"></span>':"",'<li class="'+i+'" data-option="'+e.val+'">'+o.escape(e.label)+n+"</li>"}}(this)).join("").value()},getHtml:function(t){var e,i;return i='<ul class="menu thin-scroll">'+this.getItem(t)+"</ul>",e='<div class="button">'+this.getLabel()+'<span class="icon icon-chevron-down"></span></div>',[e,i].join("")},render:function(){var t;return this.setValue(this.value),t=this.getHtml(this.schema),this.$el.html(t),this.isDisabled&&this.$el.addClass("disabled"),this}})},function(t,e){},,function(t,e){t.exports=function(t){var e='<div class="project-settings-view settings-no-permission-view"> <span class="icon icon-circle-info"></span> <span>'+tb_i18n.get("settings.no.permission")+"</span></div>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;u=i(358),n=i(357),l=i(788),r=i(401),o=i(699),p=i(786),s=i(1338),c=i(1339),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.viewName="ProjectBelongingView",e.prototype.className="project-settings-view project-belonging-view",e.prototype.events={"click .transfer-handler":"onTransfer"},e.prototype.initialize=function(t){return this.projectModel=t.projectModel,this.organizationModel=t.organizationModel,this.organizationsCollection=t.organizationsCollection,this.loadMembers(this.projectModel).then(function(t){return function(e){return t.owner=t.findOwner(e),t.render()}}(this))["catch"](console.error.bind(console))},e.prototype.loadMembers=function(t){return new Promise(function(e,i){return o.fetch(t.get("_id"),{boundToObjectType:"project",success:e,error:i})})},e.prototype.findOwner=function(t){var e;return e=t.filter(function(t){return 2===t.getRoleScope()}),u.chain(e).sortBy(function(t){return new Date(t.get("joined")).valueOf()}).first().value()},e.prototype.hasPermission=function(){return this.projectModel.hasPermission("put.transfer")},e.prototype.isOrganization=function(){return null!=this.organizationModel},e.prototype.getTitle=function(){return this.isOrganization()?tb_i18n.get("project.creator.belongsTo"):tb_i18n.get("project.belonging.owner")},e.prototype.getName=function(){return this.isOrganization()?this.organizationModel.get("name"):this.owner.get("name")},e.prototype.getLogo=function(){return this.isOrganization()?this.organizationModel.get("logo"):this.owner.get("avatarUrl")},e.prototype.onTransfer=function(t){return t.preventDefault(),this.requestSubView(p).open(c,{projectModel:this.projectModel,organizationsCollection:this.organizationsCollection}),this},e.prototype.render=function(){return this.$el.html(s(this))},e}(l)},function(t,e){t.exports=function(t){var e='<div class="section-grid"> <label>'+t.getTitle()+'</label> <div class="section-content"> <div class="organization-item">  ';return e+=t.getLogo()&&t.getLogo().length>0?' <div class="organization-logo" style="background-image: url(\''+t.getLogo()+"')\"></div> ":' <div class="organization-logo"></div> ',e+=' <div class="organization-name">'+t.getName()+"</div> ",t.hasPermission()&&(e+=' <a class="transfer-handler">'+tb_i18n.get("project.setting.handler.transfer")+"</a> "),e+=" </div> </div></div>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v=function(t,e){function i(){this.constructor=t}for(var n in e)y.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},y={}.hasOwnProperty;f=i(358),g=i(678),o=i(401),h=i(788),a=i(688),d=i(1340),s=i(699),l=i(689),c=i(1341),m=i(786),r=i(805),p=i(1343),n=i(1346),t.exports=u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return v(e,t),e.prototype.viewName="ProjectTransferView",e.prototype.className="project-transfer-view modal-dialog modal-padding",e.prototype.events={"click .project-owner-select":"toggleOwnerSelector","click .confirm-handler":"onConfirm"},e.prototype.initialize=function(t){return this.projectModel=t.projectModel,this.organizationsCollection=t.organizationsCollection,this.load({success:function(t){return function(){return t.renderBasic()}}(this)}),this},e.prototype.renderBasic=function(t){return null==t&&(t={}),this.$el.html(n(t)),this.$confirmHandler=this.$(".confirm-handler"),this},e.prototype.load=function(t){return null==t&&(t={}),this.showLoadingIndicator(),s.fetch(this.projectModel.id,{boundToObjectType:"project",success:function(e){return function(i){if(e.$el)return e.membersCollection=i,t.success()}}(this)})},e.prototype.toggleOwnerSelector=function(t){var e,i,n,r;return e=$(t.currentTarget),e.data("bs.popover")?this:(i="organization"===this.projectModel.getPaymentPlan().payType?this.membersCollection.toJSON():this.membersCollection.toJSON().filter(function(t){return t._id!==g.user.id}),n=this.organizationsCollection.filter(function(t){return!t.getPaymentPlan().isOverdue&&t.get("_roleId")>=0}).map(function(t){return t.toJSON()}),null!=(r=this.ownerSelectorView)&&r.remove(),this.ownerSelectorView=this.requestSubView(p,{$toggler:e,members:i,organizations:n,select:function(t){return function(e){return t.ownerId=e[0],t.ownerModel=t.organizationsCollection.get(t.ownerId)||t.membersCollection.get(t.ownerId),t.ownerType=t.membersCollection.get(t.ownerId)?"user":"organization",t.renderBasic(t.ownerModel.toJSON())}}(this)}).show(),this)},e.prototype.checkMembersExceed=function(t,e){var i,n,o,s,a;return i=this.membersCollection.length,a=t.getPaymentPlan().payType,s=this.ownerModel.getPaymentPlan(),n=s.membersLimit,o=s.payType,i>n?this.requestSubView(m).open(r,{title:tb_i18n.get("project.setting.members.exceed.limit"),content:this.getMembersExceedText(o,n)}):this.requestSubView(m).open(r,{title:tb_i18n.get("confirm")+tb_i18n.get("project.settings.transfer"),content:this.getRolesChangeText(a,o),confirmText:tb_i18n.get("project.settings.transfer.confirm"),confirmStyle:"danger",onConfirm:function(){return e.success()}})},e.prototype.getMembersExceedText=function(t,e){var i,n;return i={action:"reach plan limit",control:"project member number",category:"transfer"},"organization"===t?(n=tb_i18n.get("project.settings.transfer.members.exceed.2org",e),i.type="plus"):(n=tb_i18n.get("project.settings.transfer.members.exceed.2user",e),i.type="business"),g.gta.event(i),n},e.prototype.getRolesChangeText=function(t,e){var i,n,r,o;return n={free:0,professional:1,organization:2},i=n[t],o=n[e],i<=o?r=tb_i18n.get("project.settings.transfer.roles.change.1"):2===i?r=tb_i18n.get("project.settings.transfer.roles.change.2"):1===i&&(r=tb_i18n.get("project.settings.transfer.roles.change.3")),r},e.prototype.onConfirm=function(){if(this.ownerId)return this.checkMembersExceed(this.projectModel,{success:function(t){return function(){return t.submit()}}(this)})},e.prototype.submit=function(){return this.projectModel.transfer(this.ownerId,{ownerType:this.ownerType,wait:!0,success:function(t){return function(){return o.success(tb_i18n.get("project.settings.transfer.success")),t.close(),g.router.navigate("/projects",{trigger:!0})}}(this),error:function(t){return o.error(t.message)}}),this},e.prototype.close=function(){var t,e;return null!=(t=this.parentView)&&"function"==typeof t.close&&t.close(),null!=(e=this.parentView)?e.remove():void 0},e}(h)},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;p=i(358),n=i(680),r=i(688),o=i(429),a=i(686),s=i(689),l=i(677),t.exports=c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.name="user",e.prototype.urlRoot="users",e.prototype.defaults={name:"",title:"",phone:"",location:"",website:"",birthday:"",email:"",avatar:"",emails:[],badge:0,todayTasks:0,isGhost:!0},e.prototype.parse=function(t){var e;return t=p.extend(this.toJSON(),t),e=p.findWhere(t.emails,{email:t.email}),e&&(t._emailId=e._id),t.isGhost=!t._id,t},e.prototype.initialize=function(){return this.formatBirthday(),this.on("change:birthday",this.formatBirthday),this.on("change",function(t){return function(e){var i;if(i=t.pick("name","title","phone","location","website","birthday","email","avatar","avatarUrl"),!p.isEmpty(i))return a.trigger(":change:member/"+t.id,i)}}(this)),e.__super__.initialize.apply(this,arguments)},e.prototype.formatBirthday=function(){var t;if(t=this.get("birthday"),t&&!(t instanceof Date))return t=new Date(t),this.set("birthday",t,{silent:!0})},e.prototype.fetchBadge=function(){return this.fetch({silentError:!0,url:"users/badge"})},e.prototype.fetchTodayTasks=function(){return this._fetchTodayTasks||(this._fetchTodayTasks=p.debounce(function(t){return function(){return n.ajax("tasks/me",{data:{dueDate:o().endOf("day").toISOString()},success:function(e){return t.set("todayTasks",e.count||0)}})}}(this),100)),this._fetchTodayTasks()},e.prototype.getSetting=function(t,e){var i;return~t.indexOf(".")?(i=t.split("."),this.attributes[e][i[0]][i[1]]):this.attributes[e][t]},e.prototype.sendResetPasswordMail=function(t){return this.sync("create",this,{url:"users/resetpassword"})},e.prototype.emailSetting=function(t,e,i){switch(t){case"setMain":return this.sync("update",this,{url:"users/email/"+e,attrs:{},success:function(t){return function(e){return t.set(t.parse(e)),i(null,tb_i18n.get("set.success"))}}(this),error:i});case"resend":return this.sync("create",this,{url:"users/email/"+e+"/send",attrs:{},success:function(){return i(null,tb_i18n.get("resend.success"))},error:i});case"delete":return this.sync("delete",this,{url:"users/email/"+e,success:function(t){return function(e){return t.set(t.parse(e)),i(null,tb_i18n.get("delete.success"))}}(this),error:i})}},e.prototype.addEmail=function(t,e){return this.sync("create",this,{url:"users/email",attrs:{email:t},success:function(t){return function(i){return t.set(t.parse(i)),e(null,tb_i18n.get("add.success"))}}(this),error:e})},e.prototype.isNew=function(){var t;return t=this.get("created"),o(t).isAfter(o().subtract(1,"hour"))},e.prototype.fetchToken=function(t,e){if(null==e&&(e=!1),!this.get("isGhost"))return this.get("tokens")&&!e?"function"==typeof t?t(null,this.get("tokens")):void 0:this.sync("read",this,{url:this.urlRoot+"/tokens",success:function(e){return function(i){return e.set("tokens",i),"function"==typeof t?t(null,i):void 0}}(this),error:t})},e.prototype.getPaymentPlan=function(){return s.userPaymentPlan(this.get("plan"))},e.prototype.checkSnapperToken=function(){return this._checkToken(this.get("snapperToken"))?Promise.resolve():this._fetchMe()},e.prototype.checkStrikerAuth=function(){return this._checkToken(this.get("strikerAuth"))?Promise.resolve():this._fetchMe()},e.prototype.fetchCrossNotify=function(){return n.get("users/cross-notify",{silentError:!0}).then(function(t){return function(e){return t.set({crossNotify:e})}}(this))["catch"](function(t){})},e.prototype._checkToken=function(t){var e,i,n;return e=t.split(".")[1],!!e&&(n=JSON.parse(window.atob(e)),i=1e3*n.exp-36e5,Date.now()<i)},e.prototype._fetchMe=function(){return this._fetchMePromise?Promise.resolve():(this._fetchMePromise=new Promise(function(t){return function(e,i){return t.fetch({url:"users/me",success:e,error:i})}}(this)).then(function(t){return function(e){return t._fetchMePromise=null,e}}(this)),this._fetchMePromise)},e}(r)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f=function(t,e){function i(){this.constructor=t}for(var n in e)g.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},g={}.hasOwnProperty;d=i(358),m=i(678),h=i(679),u=i(788),p=i(677),s=i(680),o=i(401),a=i(684),l=i(687),r=i(561),n=i(1342),t.exports=c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.viewName="OrganizationCreatorView",e.prototype.tagName="div",e.prototype.className="organization-creator modal-dialog",e.prototype.events={"click .cancel-create-organization":"close"},e.prototype.initialize=function(t){return null==t&&(t={}),this.options=t,this.renderBasic(),d.delay(function(t){return function(){return t.renderComponent()}}(this),200),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this},e.prototype.renderComponent=function(){return new r({$wrap:this.$el,gta:m.gta,businessUrl:h.BUSINESS_URL,userMe:m.user.toJSON(),locale:m.PREFERENCE.getLanguage(),tabList:"build"===m.env?["info"]:["info","contact"],createOrgTab:"build"===m.env?"info":"contact",environment:m.env,captchaHost:h.CAPTCHA_HOST,apiGetVerifyCode:this.apiGetVerifyCode,apiPostCreateOrg:this.apiPostCreateOrg,apiPostVerifyCode:this.apiPostVerifyCode,cbLastButtonAction:this.cbLastButtonAction,enableSMSVerification:h.FEATURES.create_organization_verification}),this},e.prototype.apiGetVerifyCode=function(t,e){return s.post("phone/"+t+"/vcode",{uid:e})["catch"](function(t){return o.show({status:"error",message:t.xhr.responseJSON.message})})},e.prototype.apiPostCreateOrg=function(t){return s.post("organizations",t)},e.prototype.apiPostVerifyCode=function(t,e){return s.post("phone/"+t+"/verify",e)},e.prototype.cbLastButtonAction=function(t){return window.location.assign(location.origin+"/organization/"+t._id+"?isNew=true")},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.close(),this},e}(u)},function(t,e){t.exports=function(t){var e='<a class="cancel-create-organization"> <span class="icon icon-remove"></span></a>';return e}},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;l=i(358),n=i(1344),r=i(1345),o=i(813),a=i(797),c=i(677),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="ProjectOwnerSelectorView",e.prototype.className="project-owner-selector-view",e.prototype.popoverTitle="Menu",e.prototype.width=320,e.prototype.events={"click .owner-item":"selectMember","mouseenter .member-item":"activate","input .filter-input":"onFilter"},e.prototype.initialize=function(t){return this.members=t.members||[],this.organizations=t.organizations||[],e.__super__.initialize.apply(this,arguments),this},e.prototype.render=function(){return this.$el.html(n()),this.$ul=this.$("ul"),this.$("input").focusAtEnd(),this.setupScroll(this.$ul),this.renderOwners({organizations:this.organizations,members:this.members}),this},e.prototype.renderOwners=function(t){return this.$ul.html(r(t)),this},e.prototype.selectMember=function(t){var e,i;return e=$(t.currentTarget).data("id"),this.hide(),"function"==typeof(i=this.options).select&&i.select([e]),this},e.prototype.onFilter=function(t){var e,i;return e=this.$(t.target),i=e.val().trim().toLowerCase(),i?(this.query=i,this.renderOwners({organizations:c.memberFilter(this.organizations,this.query),members:c.memberFilter(this.members,this.query)})):this.renderOwners({organizations:this.organizations,members:this.members}),this},e.prototype.activate=function(t){var e;if(e=$(t.currentTarget),e.length&&!e.hasClass("active"))return e.addClass("active").siblings().removeClass("active"),this},e}(o),l.extend(s.prototype,a),t.exports=s},function(t,e){t.exports=function(t){var e='<div class="menu-input"> <input class="filter-input form-control" placeholder="'+tb_i18n.get("project.owner.search")+'"/></div><ul class="list-unstyled thin-scroll"></ul>';return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="";t.organizations.length>0&&(i+=" <p>"+tb_i18n.get("organization")+"</p>");var n=t.organizations;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li class="owner-item" data-id="'+r._id+'"> <a> <div class="avatar img-circle" style="background-image:url('+r.logo+');"></div> '+e(r.name)+" </a> </li>";t.members.length>0&&(i+=" <p>"+tb_i18n.get("project.member")+"</p>");var a=t.members;if(a)for(var c,l=-1,p=a.length-1;l<p;)c=a[l+=1],i+=' <li class="owner-item" data-id="'+c._id+'"> <a> <div class="avatar img-circle" style="background-image:url('+c.avatarUrl+');"></div> '+e(c.name)+" </a> </li>";return i}},function(t,e){t.exports=function(t){var e='<div class="modal-content"> <header class="modal-header"> <h4 class="modal-title text-center">'+tb_i18n.get("project.settings.transfer")+'</h4> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </header> <div class="modal-body"> <a class="project-owner-select"> ';return(t.logo||t.avatarUrl)&&(e+=' <div class="avatar img-circle" style="background-image:url('+(t.logo||t.avatarUrl)+');"></div> '),e+=' <span class="project-owner-name">'+(t.name||tb_i18n.get("project.settings.select.owner"))+'</span> <span class="icon icon-chevron-down"></span> </a> </div> <div class="modal-footer"> <button class="confirm-handler btn btn-primary ',t._id||(e+="disabled"),e+='">'+tb_i18n.get("project.settings.transfer")+"</button> </div></div>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){return function(){return t.apply(e,arguments)}},d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;n=i(357),l=i(788),r=i(401),p=i(786),c=i(925),o=i(1348),a=i(1351),t.exports=s=function(t){function e(){return this.logoUpload=u(this.logoUpload,this),e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.viewName="ProjectLogoView",e.prototype.className="section-grid project-logo-view",e.prototype.events={"click .upload-cover-handler":"onCropLogo"},e.prototype.initialize=function(t){return this.projectModel=t.projectModel,this.uploader=null,this.$logoInputBtn=null,this.initUploader(t.projectModel),this.render(),this.listen()},e.prototype.listen=function(){return this.listenTo(this.projectModel,"change:logo",this.renderLogo)},e.prototype.hasPermission=function(){return this.projectModel.hasPermission("put.info")},e.prototype.getLogo=function(){return this.projectModel.get("logo")},e.prototype.renderLogo=function(t){var e,i;return e=new window.Image,i=t.get("logo"),e.onload=function(t){return function(){if(t.$el)return t.$(".project-cover").css({"background-image":"url("+i+")"})}}(this),e.src=i},e.prototype.initUploader=function(t){var e;return e=this.$el.find(".progress-mask"),this.uploader=new c({model:t,type:"logo",thumb:{width:600,height:300},onCreate:function(e){return t.set("logo",e.thumbnailUrl)},onStart:function(){return e.css("clip","rect(auto, auto, 200px, auto)").html("")},onProgress:function(t){var i;return i=200*t,e.css("clip","rect(auto, auto, "+i+"px, auto)")},onComplete:function(i){var n;return e.css("clip","rect(auto, auto, 0, auto)"),n=i.thumbnailUrl.replace("/w/200/h/200","/w/600/h/300"),t.save(null,{attrs:{logo:n},wait:!0,success:function(){return r.show({message:tb_i18n.get("project.settings.logo.upload.success"),status:"success"})}})},onError:function(){return t.save({logo:this.projectModel.previous("logo")}),r.show({message:tb_i18n.get("project.settings.logo.upload.failed"),status:"error"})}})},e.prototype.logoUpload=function(t){return this.uploader.addFile(t),this.uploader.upload()},e.prototype.onCropLogo=function(t){var e;return t.preventDefault(),null!=(e=this.$logoInputBtn)&&e.remove(),this.$logoInputBtn=$("<input type='file' accept='image/*'>"),this.$logoInputBtn.on("change",function(t){return function(e){return t.requestSubView(p).open(o,{file:e.target.files[0],backdrop:"static",logoUpload:t.logoUpload.bind(t),projectModel:t.projectModel})}}(this)).trigger("click")},e.prototype.render=function(){return this.$el.html(a(this))},e}(l)},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;c=i(358),l=i(678),r=i(401),a=i(788),o=i(1349),n=i(1350),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="ProjectLogoCropView",e.prototype.className="project-logo-crop-view modal modal-dialog",e.prototype.hotkeys={enter:"upload"},e.prototype.events={"click .save":"upload"},e.prototype.initialize=function(t){return this.file=t.file,this.logoUpload=t.logoUpload,this.projectModel=t.projectModel,this},e.prototype.onOpen=function(){var t,e,i;return this.$el.html(n(this.projectModel.toJSON())),this.showLoadingIndicator(this.$(".modal-body")),t=this.$(".image-cropper-wrapper"),e=this.$el.find(".prev-l canvas")[0],i=this.$el.find(".prev-s canvas")[0],c.delay(function(n){return function(){return n.imageCropper=new o({input:n.$(".image-cropper-input")[0],container:t[0],containerWidth:t.width(),
containerHeight:280,cropperWidth:300,resultWidth:600,ratio:2,file:n.file,fileSizeLimit:4194304,hd:!0,widthAdapt:!0,heightAdapt:!0,crop:function(t){var n,r;return n=e.getContext("2d"),n.clearRect(0,0,e.width,e.height),n.drawImage(t,0,0,e.width,e.height),r=i.getContext("2d"),r.clearRect(0,0,i.width,i.height),r.drawImage(e,e.width/4,0,e.height,e.height,0,0,i.width,i.height)},onError:function(t){"sizeTooLarge"===t&&r.show({message:tb_i18n.get("project.settings.logo.crop.image.size.too.large"),status:"error"})}})}}(this),300),this},e.prototype.upload=function(){var t,e,i,n;return null!=(i=this.imageCropper)&&i.destroy(),e=this.logoUpload,t=this.imageCropper,"function"==typeof(null!=(n=this.parentView)?n.close:void 0)?this.parentView.close():this.$el.addClass("hide"),e(t.toBlob())},e.prototype.remove=function(){return this.imageCropper.destroy()},e}(a)},function(t,e){var i;t.exports=i=function(){function t(t){if(this.inputId=t.input,this.containerId=t.container,this.containerWidth=t.containerWidth,this.containerHeight=t.containerHeight||240,this.widthAdapt=t.widthAdapt||!1,this.heightAdapt=t.heightAdapt||!1,this.cropperWidth=t.cropperWidth||0,this.cropperRatio=t.ratio||1,this.croppedWidth=t.resultWidth||this.cropperWidth,this.cropperRound=t.round||!1,this.hd=t.hd||!1,this.cropCallback=t.crop||null,this.onError=t.onError||null,this.fileSizeLimit=t.fileSizeLimit||1/0,this.input=t.input||document.querySelector(this.inputId),this.container=t.container||document.querySelector(this.containerId),this.imageContainer=document.createElement("div"),this.imageContainer.style.position="relative",this.imageContainer.style.top="0px",this.imageContainer.style.left="0px",this.imageContainer.style.overflow="hidden",this.imageContainer.style.width=this.containerWidth+"px",this.imageContainer.style.height=this.containerHeight+"px",this._events={},this.sourceImage=document.createElement("canvas"),this.cropper=document.createElement("canvas"),this.cropperSeResize=document.createElement("canvas"),this.cropperSource=document.createElement("canvas"),this.imageOpti=document.createElement("canvas"),this.image=new window.Image,this.imageRatio=1,this.reader=new window.FileReader,this.cropperSeResizeSize=10,this.cropperOffsetTop=0,this.cropperOffsetLeft=0,this.imageOffsetTop=0,this.imageOffsetLeft=0,this.cropperPrevX=0,this.cropperPrevY=0,this.imagePrevX=0,this.imagePrevY=0,this.cropperResizePrevX=0,this.cropperResizePrevY=0,this.listenTo(this.input,"change",this.readFile),this.listenTo(this.reader,"load",this.fileReady),this.listenTo(this.image,"load",this.imageReady),this.listenTo(this.sourceImage,"mousedown",this.sourceImageMousedown),this.listenTo(this.sourceImage,"touchstart",this.sourceImageMousedown),this.listenTo(this.cropper,"mousedown",this.cropperMousedown),this.listenTo(this.cropper,"touchstart",this.cropperMousedown),this.listenTo(this.cropperSeResize,"mousedown",this.cropperSeResizeMousedown),this.listenTo(this.cropperSeResize,"touchstart",this.cropperSeResizeMousedown),this.listenTo(document,"mouseup",this.stopListeningMousemove),this.listenTo(document,"touchend",this.stopListeningMousemove),this.container.innerHTML="",this.container.appendChild(this.imageContainer),t.file){if(t.file.size>this.fileSizeLimit)return void("function"==typeof this.onError&&this.onError("sizeTooLarge"));this.reader.readAsDataURL(t.file)}}return t.prototype.stopListeningMousemove=function(){return this.stopListening(document,"mousemove"),this.stopListening(document,"touchmove"),this.cropperListener()},t.prototype.listenTo=function(t,e,i){var n;return(n=this._events)[e]||(n[e]=[]),i=i.bind(this),this._events[e].push({ele:t,eventListener:i}),t.addEventListener(e,i,!1)},t.prototype.stopListening=function(t,e){var i,n,r,o,s,a,c,l,p;if(t){for(i=this._events[e]||[],this._events[e]=[],p=[],s=0,c=i.length;s<c;s++)r=i[s],r.ele===t?p.push(t.removeEventListener(e,r.eventListener,!1)):p.push(this._events[e].push(r));return p}l=this._events;for(e in l)for(n=l[e],o=0,a=n.length;o<a;o++)r=n[o],r.ele.removeEventListener(e,r.eventListener,!1);return this._events={}},t.prototype.readFile=function(t){var e;if(e=t.target.files[0])return e.size>this.fileSizeLimit?void("function"==typeof this.onError&&this.onError("sizeTooLarge")):this.reader.readAsDataURL(t.target.files[0])},t.prototype.fileReady=function(t){return this.image.src=t.target.result},t.prototype.imageReady=function(){var t,e,i,n,r,o;return this.sourceImage.width=this.image.width,this.sourceImage.height=this.image.height,r=this.sourceImage.getContext("2d"),r.fillStyle="white",r.fillRect(0,0,this.image.width,this.image.height),r.drawImage(this.image,0,0),r.fillStyle="rgba(0, 0, 0, 0.5)",r.fillRect(0,0,this.image.width,this.image.height),this.sourceImage.style.cursor="move",this.sourceImage.style.position="relative",this.sourceImage.style.top="0px",this.sourceImage.style.left="0px",this.imageContainer.appendChild(this.sourceImage),this.image.width>1200&&this.image.height>1200?this.imageOptiRatio=Math.max(this.image.width,this.image.height)/1200:this.imageOptiRatio=1,this.imageOpti.width=~~(this.image.width/this.imageOptiRatio),this.imageOpti.height=~~(this.image.height/this.imageOptiRatio),this.imageOpti.getContext("2d").drawImage(this.image,0,0,this.imageOpti.width,this.imageOpti.height),o=function(t){return function(){var e;return t.sourceImage.style.width=t.containerWidth+"px",t.sourceImageWidth=t.containerWidth,e=t.image.height*t.containerWidth/t.image.width,t.sourceImage.style.height=e+"px",t.sourceImageLeft=0,t.sourceImageTop=(t.containerHeight-e)/2,t.sourceImage.style.top=t.sourceImageTop+"px"}}(this),n=function(t){return function(){return t.sourceImage.style.height=t.containerHeight+"px",t.sourceImageWidth=t.image.width*t.containerHeight/t.image.height,t.sourceImage.style.width=t.sourceImageWidth+"px",t.sourceImageLeft=(t.containerWidth-t.sourceImageWidth)/2,t.sourceImageTop=0,t.sourceImage.style.left=t.sourceImageLeft+"px"}}(this),this.widthAdapt&&!this.heightAdapt?o():this.heightAdapt&&!this.widthAdapt?n():this.widthAdapt&&this.heightAdapt?(this.sourceImage.style.cursor="default",this.image.width/this.image.height>=this.containerWidth/this.containerHeight?o():n()):this.image.width/this.image.height>=this.containerWidth/this.containerHeight?n():o(),this.imageStyleWidth=parseInt(this.sourceImage.style.width.slice(0,-2)),this.imageStyleHeight=parseInt(this.sourceImage.style.height.slice(0,-2)),e=this.imageStyleWidth,this.imageStyleWidth>this.containerWidth&&(e=this.containerWidth),t=this.imageStyleHeight,this.imageStyleHeight>this.containerHeight&&(t=this.containerHeight),this.imageRatio=this.sourceImageWidth/this.sourceImage.width,this.imageOffsetTop=this.sourceImageTop/this.imageRatio,this.imageOffsetLeft=this.sourceImageLeft/this.imageRatio,(0===this.cropperWidth||this.cropperWidth>this.sourceImageWidth)&&(this.cropperWidth=.8*this.sourceImageWidth),this.cropperHeight=this.cropperWidth/this.cropperRatio,this.cropperRatio>e/t?this.cropperWidth>e&&(this.cropperWidth=.8*this.cropperBaseWidth,this.cropperHeight=this.cropperWidth/this.cropperRatio):this.cropperHeight>t&&(this.cropperHeight=.8*t,this.cropperWidth=this.cropperHeight*this.cropperRatio),this.cropperOffsetTop=(this.containerHeight-this.cropperHeight)/2,this.cropperOffsetLeft=(this.containerWidth-this.cropperWidth)/2,this.cropper.style.cursor="move",this.cropper.style.position="absolute",this.imageContainer.appendChild(this.cropper),this.cropperSeResize.width=this.cropperSeResize.height=this.cropperSeResizeSize,i=this.cropperSeResize.getContext("2d"),i.fillStyle="rgba(0, 0, 0, 0.24)",i.fillRect(0,0,this.cropperSeResizeSize,this.cropperSeResizeSize),i.beginPath(),i.moveTo(0,0),i.lineTo(this.cropperSeResizeSize,0),i.lineTo(this.cropperSeResizeSize,this.cropperSeResizeSize),i.lineTo(0,this.cropperSeResizeSize),i.closePath(),i.lineWidth=2,i.strokeStyle="rgba(255, 255, 255, 0.4)",i.stroke(),this.cropperSeResize.style.cursor="se-resize",this.cropperSeResize.style.position="absolute",this.imageContainer.appendChild(this.cropperSeResize),this.cropperListener()},t.prototype.cropperListener=function(t){var e,i,n,r,o,s,a,c,l,p,u,d,h,m,f,g;return null==t&&(t=!0),this.cropperWidth=~~this.cropperWidth,this.cropperHeight=~~this.cropperHeight,m=-this.imageOffsetLeft+(this.cropperOffsetLeft-parseFloat(this.imageContainer.style.left.slice(0,-2)))/this.imageRatio,f=-this.imageOffsetTop+(this.cropperOffsetTop-parseFloat(this.imageContainer.style.top.slice(0,-2)))/this.imageRatio,h=this.cropperWidth/this.imageRatio,m+h<=this.image.width||(h=this.image.width-m),d=this.cropperHeight/this.imageRatio,f+d<=this.image.height||(d=this.image.height-f),g=h,c=d,l=this.image,t||(m=~~(m/this.imageOptiRatio),f=~~(f/this.imageOptiRatio),h=~~(h/this.imageOptiRatio),d=~~(d/this.imageOptiRatio),g=this.cropperWidth,c=this.cropperHeight,l=this.imageOpti),this.cropper.width=g,this.cropper.height=c,r=this.cropper.getContext("2d"),r.drawImage(l,m,f,h,d,0,0,g,c),e=1,r.save(),this.cropperSource.width=g,this.cropperSource.height=c,o=this.cropperSource.getContext("2d"),o.fillStyle="white",o.fillRect(0,0,g,c),o.drawImage(l,m,f,h,d,0,0,g,c),this.cropperRound&&(r.fillStyle="rgba(0, 0, 0, 0.5)",r.fillRect(0,0,g,c),i=document.createElement("canvas"),i.width=g,i.height=c,n=i.getContext("2d"),n.drawImage(this.cropperSource,0,0),n.globalCompositeOperation="destination-in",u=g>c?c:g,u/=2,u=u>=0?u:0,n.arc(g/2,c/2,u,0,2*Math.PI),n.fill(),r.drawImage(i,0,0)),r.restore(),r.beginPath(),e=Math.ceil(e*g/this.cropperWidth),p=e/2,a=~~g,s=~~c,r.moveTo(p,p),r.lineTo(a-p,p),r.lineTo(a-p,s-p),r.lineTo(p,s-p),r.closePath(),r.lineWidth=e,r.strokeStyle="rgba(255, 255, 255, 0.24)",r.stroke(),"function"==typeof this.cropCallback&&this.cropCallback(this.cropperSource),this.cropper.style.top=this.cropperOffsetTop+"px",this.cropper.style.left=this.cropperOffsetLeft+"px",this.cropper.style.width=this.cropperWidth+"px",this.cropper.style.height=this.cropperHeight+"px",this.cropperSeResize.style.top=this.cropperOffsetTop+this.cropperHeight-this.cropperSeResizeSize/2+"px",this.cropperSeResize.style.left=this.cropperOffsetLeft+this.cropperWidth-this.cropperSeResizeSize/2+"px"},t.prototype.sourceImageMousedown=function(t){return t.preventDefault(),this.imagePrevX=t.clientX||t.targetTouches[0].clientX,this.imagePrevY=t.clientY||t.targetTouches[0].clientY,this.listenTo(document,"mousemove",this.sourceImageMove),this.listenTo(document,"touchmove",this.sourceImageMove)},t.prototype.sourceImageMove=function(t){var e,i,n,r,o,s;return t.preventDefault(),this.sourceImage.offsetWidth>this.containerWidth?(e=t.clientX||t.targetTouches[0].clientX,n=e-this.imagePrevX+parseFloat(this.sourceImage.style.left.slice(0,-2)),r=this.containerWidth-this.sourceImage.offsetWidth,n<r&&(n=r),n>0&&(n=0),this.sourceImage.offsetWidth>this.containerWidth&&(this.sourceImage.style.left=n+"px")):(i=t.clientY||t.targetTouches[0].clientY,o=i-this.imagePrevY+parseFloat(this.sourceImage.style.top.slice(0,-2)),s=this.containerHeight-this.sourceImage.offsetHeight,o<s&&(o=s),o>0&&(o=0),this.sourceImage.offsetHeight>this.containerHeight&&(this.sourceImage.style.top=o+"px")),this.imagePrevX=t.clientX||t.targetTouches[0].clientX,this.imagePrevY=t.clientY||t.targetTouches[0].clientY,this.imageOffsetTop=parseFloat(this.sourceImage.style.top.slice(0,-2))/this.imageRatio,this.imageOffsetLeft=parseFloat(this.sourceImage.style.left.slice(0,-2))/this.imageRatio,this.cropperListener(this.hd)},t.prototype.cropperMousedown=function(t){return t.preventDefault(),this.cropperPrevX=t.clientX||t.targetTouches[0].clientX,this.cropperPrevY=t.clientY||t.targetTouches[0].clientY,this.listenTo(document,"mousemove",this.cropperMove),this.listenTo(document,"touchmove",this.cropperMove)},t.prototype.cropperMove=function(t){var e,i,n,r,o,s;return t.preventDefault(),e=t.clientX||t.targetTouches[0].clientX,i=t.clientY||t.targetTouches[0].clientY,this.cropperOffsetTop=i-this.cropperPrevY+this.cropper.offsetTop,this.cropperOffsetLeft=e-this.cropperPrevX+this.cropper.offsetLeft,this.imageStyleHeight<this.containerHeight?(s=(this.containerHeight-this.imageStyleHeight)/2,o=s+this.imageStyleHeight-this.cropperHeight):(o=this.containerHeight-this.cropperHeight,s=0),this.cropperOffsetTop>o&&(this.cropperOffsetTop=o),this.cropperOffsetTop<s&&(this.cropperOffsetTop=s),this.imageStyleWidth<this.containerWidth?(r=(this.containerWidth-this.imageStyleWidth)/2,n=r+this.imageStyleWidth-this.cropperWidth):(n=this.containerWidth-this.cropperWidth,r=0),this.cropperOffsetLeft>n&&(this.cropperOffsetLeft=n),this.cropperOffsetLeft<r&&(this.cropperOffsetLeft=r),this.cropperPrevX=t.clientX||t.targetTouches[0].clientX,this.cropperPrevY=t.clientY||t.targetTouches[0].clientY,this.cropperListener(this.hd)},t.prototype.cropperSeResizeMousedown=function(t){return t.preventDefault(),this.cropperResizePrevX=t.clientX||t.targetTouches[0].clientX,this.cropperResizePrevY=t.clientY||t.targetTouches[0].clientY,this.listenTo(document,"mousemove",this.cropperSeResizeMove),this.listenTo(document,"touchmove",this.cropperSeResizeMove)},t.prototype.cropperSeResizeMove=function(t){var e,i,n,r;return t.preventDefault(),r=this.imageStyleWidth<this.containerWidth?this.imageStyleWidth/2+this.containerWidth/2-this.cropperOffsetLeft:this.containerWidth-this.cropperOffsetLeft,n=this.imageStyleHeight<this.containerHeight?this.imageStyleHeight/2+this.containerHeight/2-this.cropperOffsetTop:this.containerHeight-this.cropperOffsetTop,this.cropperRatio>=1?(e=t.clientX||t.targetTouches[0].clientX,this.cropperWidth+=e-this.cropperResizePrevX,this.cropperWidth<0&&(this.cropperWidth=0),this.cropperWidth>r&&(this.cropperWidth=r),this.cropperHeight=Math.floor(this.cropperWidth/this.cropperRatio),this.cropperHeight>n&&(this.cropperHeight=n,this.cropperWidth=this.cropperHeight*this.cropperRatio)):(i=t.clientY||t.targetTouches[0].clientY,this.cropperHeight+=i-this.cropperResizePrevY,this.cropperHeight<0&&(this.cropperHeight=0),this.cropperHeight>n&&(this.cropperHeight=n),this.cropperWidth=Math.floor(this.cropperHeight*this.cropperRatio),this.cropperWidth>r&&(this.cropperWidth=r,this.cropperHeight=this.cropperWidth/this.cropperRatio)),this.cropperWidth<10&&(this.cropperWidth=10,this.cropperHeight=this.cropperWidth/this.cropperRatio),this.cropperResizePrevX=t.clientX||t.targetTouches[0].clientX,this.cropperResizePrevY=t.clientY||t.targetTouches[0].clientY,this.cropperListener(this.hd)},t.prototype.toBlob=function(){var t,e,i,n,r,o,s,a,c,l,p;for(t=document.createElement("canvas"),t.width=this.croppedWidth,t.height=this.croppedWidth/this.cropperRatio,t.getContext("2d").drawImage(this.cropperSource,0,0,t.width,t.height),r="image/png",s=t.toDataURL(r),i=s.split(","),o=window.atob(i[1]),n=o.length,p=new Uint8Array(n),a=c=0,l=o.length;c<l;a=++c)e=o[a],p[a]=e.charCodeAt(0);return new window.Blob([p],{type:r})},t.prototype.toDataURL=function(){return this.cropperSource.toDataURL()},t.prototype.destroy=function(){return this.stopListening()},t}()},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="modal-content"> <div class="modal-header"> <div class="modal-title">'+tb_i18n.get("project.logoCrop.set.project.logo")+'</div> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </div> <div class="modal-body image-cropper-wrapper"></div> <div class="upload-hint"> <input type="file" accept="image/*" id="project-logo-input" class="image-cropper-input" style="display:none"> <a class="image-input"> <label for="project-logo-input" style="margin:0;cursor:pointer;"> <span class="icon icon-picture"></span> '+tb_i18n.get("project.logoCrop.choose")+" </label> </a> <span>"+tb_i18n.get("project.logoCrop.best.size.hint")+'</span> </div> <div class="previews"> <p class="title">'+tb_i18n.get("project.logoCrop.previews")+'</p> <div class="preview-items"> <div class="item prev-l"> <canvas width="600" height="300" class="hinted" data-title="'+tb_i18n.get("project.logoCrop.desktop.logo")+'"></canvas> <div class="prev-hint">300&times;150</div> <div class="project-info"> <h3 class="project-name">'+e(t.name)+'</h3> <p class="project-desc">'+e(t.description)+'</p> </div> </div> <div class="item prev-s"> <canvas width="300" height="300" class="hinted" data-title="'+tb_i18n.get("project.logoCrop.mobile.logo")+'"></canvas> <div class="prev-hint">50&times;50</div> </div> </div> </div> <div class="modal-footer clear-fix"> <button type="button" class="btn btn-link cancel" data-dismiss="modal">'+tb_i18n.get("cancel")+'</button> <button type="submit" class="btn btn-primary save">'+tb_i18n.get("save")+"</button> </div></div>";return i}},function(t,e){t.exports=function(t){var e='<div class="section-grid"> <label> '+tb_i18n.get("project.settings.label.project.cover")+' </label> <div class="section-content">  ';return e+=t.getLogo()&&t.getLogo().length>0?' <div class="project-cover" style="background-image: url(\''+t.getLogo()+"')\"></div> ":' <div class="project-cover"></div> ',e+=" ",t.hasPermission()&&(e+=' <a class="upload-cover-handler"> '+tb_i18n.get("project.settings.button.upload.cover")+" </a> "),e+=" </div></div>"}},function(t,e){t.exports=function(t){var e='<form class="project-setting-form project-info-form" > <div class="no-permission-section"></div> <div class="project-setting-section" data-type="project-cover"> </div> <div class="project-setting-section is-column-2"> <div class="section-grid" data-fields="name"> </div> ';return t.showGrouping()&&(e+=' <div class="section-grid" data-fields="grouping"> </div> '),e+=' </div> <div class="project-setting-section"> <div class="section-grid" data-fields="description"> </div> </div> <div class="project-setting-section"> <div class="section-grid" data-fields="visibility"> </div> </div> <div class="project-setting-section project-belonging" data-type="project-belonging"> </div> ',t.hasPermission()&&(e+=' <hr class="seperator"> <div class="project-setting-actions-section"> <input class="btn form-handler submit" type="submit" value="'+tb_i18n.get("save")+'"></input> </div> '),e+="</form>"}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(358),n=i(357),a=i(788),r=i(401),s=i(1354),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="ProjectSettingsNotificationView",e.prototype.className="project-settings-view notification-view",e.prototype.initialize=function(t){var e;return this.projectModel=t.projectModel,e=this.getForm(),this.render(e),this.listen(e)},e.prototype.listen=function(t){return t.on("change",c.debounce(function(t){return function(e){var i;return i=e.getValue(),t.updatePushStatus("true"===i.noti)}}(this),300))},e.prototype.updatePushStatus=function(t){return this.projectModel.putPushStatus(t,{success:function(){return r.success(tb_i18n.get("project.settings.save.success"))},error:console.error.bind(console)})},e.prototype.getForm=function(){var t,e,i;return i={noti:{type:"Radio",options:[{val:"true",label:tb_i18n.get("project.setting.notification.accept")},{val:"false",label:tb_i18n.get("project.setting.notification.reject")}]}},e={noti:""+this.projectModel.get("pushStatus")},new(t=n.Form.extend({template:function(t){return function(){return s(t)}}(this),schema:i,data:e}))},e.prototype.render=function(t){return t.render(),this.$el.html(t.el),this.$("label[for=noti]").remove()},e}(a)},function(t,e){t.exports=function(t){var e='<form class="project-setting-form noti-form"> <div class="project-setting-section"> <label>'+tb_i18n.get("project.setting.notification.title")+'</label> <div class="subtitle">'+tb_i18n.get("project.setting.notification.tips")+'</div> <div data-fields="noti"></div> </div></form>';return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},v={}.hasOwnProperty;m=i(358),f=i(678),r=i(357),d=i(788),s=i(401),h=i(786),o=i(1333),n=i(1356),p=i(1358),a=i(1359),u=i(1336),c=i(1368),t.exports=l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.viewName="ProjectSettingsPreferenceView",e.prototype.className="project-settings-view project-settings-preference-view",e.prototype.events={"click .open-powerups":"onPowerUpClick"},e.prototype.initialize=function(t){return this.projectModel=t.projectModel,this.organizationModel=t.organizationModel,this.loadRolesCollection().then(function(t){return function(e){var i,n;return i=t.getApps(),n=t.getForm(i,e),t.render(n,i,e),t.initSortableApps(),t.listen(n)}}(this))["catch"](console.error.bind(console))},e.prototype.listen=function(t){return t.on("change",this.onChange.bind(this))},e.prototype.loadRolesCollection=function(){return this.projectModel.get("_organizationId")&&!f.user.get("isGhost")?new Promise(function(t){return function(e,i){return p.fetch(t.projectModel.get("_organizationId"),{success:function(t){return e((null!=t?t.toJSON():void 0)||[])},error:i})}}(this)):Promise.resolve([])},e.prototype.onChange=function(t){var e;return e=t.getValue(),this.projectModel.putDefaultRole(e.role,{success:function(){return t.data.role=e.role,s.success(tb_i18n.get("project.settings.save.success"))},error:function(e){if(t.fields.role.setValue(t.data.role),e)return console.error(e),s.error(e)}})},e.prototype.onPowerUpClick=function(){return this.requestSubView(h).open(a,{projectModel:this.projectModel})},e.prototype.hasPutAppsPermission=function(){return this.projectModel.hasPermission("put.applications")},e.prototype.hasPutRolePermission=function(){return this.projectModel.hasPermission("put.defaultrole")},e.prototype.isOrganization=function(){return this.organizationModel},e.prototype.isProfessional=function(){return"professional"===this.projectModel.getPaymentPlan().payType},e.prototype.isFree=function(){return"free"===this.projectModel.getPaymentPlan().payType},e.prototype.getApps=function(){var t,e;return e=this.projectModel.getNavigations(),t=n.get(0),m.chain(e).map(function(e,i){var n;if(n=t.get(i),n&&e>=0)return{index:e,name:i,title:tb_i18n.get(n.get("i18n")),icon:n.getIcon()}}).compact().sortBy("index").value()},e.prototype.getForm=function(t,e){var i,n,s,a,l,p,u,d,h,f;return i=new Array(25).join("0"),s=this.projectModel.get("_defaultRoleId")||(null!=(u=this.organizationModel)?u.get("_defaultRoleId"):void 0)||i,h={role:{type:o,editorAttrs:{disabled:!this.hasPutRolePermission()},options:[{val:i,label:tb_i18n.get("member")}].concat(e.map(function(t){return{val:t._id,label:t.name}}))}},p={role:s},l=this.projectModel.get("_id"),a=null!=(d=this.organizationModel)?d.get("_id"):void 0,f=m.assign(this,{apps:t,_projectId:l,_organizationId:a}),new(n=r.Form.extend({template:function(){return c(f)},schema:h,data:p}))},e.prototype.initSortableApps=function(){if(this.hasPutAppsPermission())return this.$(".apps-list").sortable({items:".app-card",connectWith:".apps-list",helper:"clone",placeholder:"app-card sortable-placeholder",tolerance:"pointer",zIndex:2001,scroll:!1,update:function(t){return function(e,i){var n,r;if(n=$(e.target),n.closest(".apps-list").length)return r=n.sortable("toArray",{attribute:"data-app"}),t.updateNavigation(r)}}(this)})},e.prototype.updateNavigation=function(t){var e;if(t.length)return e=m.mapObject(this.projectModel.getNavigations(),function(e,i){return m.indexOf(t,i)}),this.projectModel.setNavigation(e)},e.prototype.renderNoPermissionSection=function(){if(!this.hasPutAppsPermission()&&!this.hasPutRolePermission())return this.$(".no-permission-section").html(u)},e.prototype.render=function(t){return t.render(),this.$el.html(t.el),this.renderNoPermissionSection(),this.$("label[for='role']").remove()},e}(d)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;r=i(1357),o=i(685),s=function(){return[{name:"tasks",i18n:"tasks"},{name:"works",i18n:"works"},{name:"posts",i18n:"posts"},{name:"events",i18n:"events"},{name:"groupchat",i18n:"groupchat"},{name:"bookkeeping",i18n:"bookkeeping"}]},t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.name="apps",e.prototype.model=r,e.prototype.sync=function(t,e,i){switch(t){case"read":return i.success(s()),this.synced=!0}},e}(o)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;r=i(688),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.name="app",e.prototype.urlRoot="apps",e.prototype.idAttribute="name",e.prototype.getUrl=function(){return"app:"+this.get("name")},e.prototype.getIcon=function(){var t;switch(this.get("name")){case"tasks":t="icon-board";break;case"posts":t="icon-wall";break;case"works":t="icon-folder";break;case"events":t="icon-calendar";break;case"groupchat":t="icon-chat-group";break;case"tags":t="icon-tag";break;case"bookkeeping":t="icon-bookkeeping-logo";break;case"settings":t="icon-cog";break;default:t="icon-"+this.get("name")}return t},e}(r)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(678),n=i(685),o=i(698),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.name="roles",e.prototype.model=o,e.prototype.boundToObjectType="organization",e.prototype.sync=function(t,i,n){return null==n&&(n={}),n.url="organizations/"+this._boundToObjectId+"/roles",e.__super__.sync.call(this,t,i,n)},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h=function(t,e){function i(){this.constructor=t}for(var n in e)m.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},m={}.hasOwnProperty,f=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};u=i(358),d=i(678),l=i(788),p=i(786),o=i(684),c=i(1360),a=i(701),n=i(1366),r=i(1367),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.viewName="PowerUpView",e.prototype.className="modal modal-dialog modal-padding power-up-common power-up-view",e.prototype.events={"click .app-card":"openItemDetail"},e.prototype.initialize=function(t){return this.projectModel=t.projectModel,this.itemsMap=a.getItems(),this.renderBasic().listen(),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this.renderApps(),this.renderPlugins(),d.gta.event({action:"show power-ups",control:"Side Menu"}),this},e.prototype.listen=function(){return this.listenTo(this.projectModel,"change:applications",function(){return this.projectModel.isNavAppChanged()?this.renderApps():this.renderPlugins()}),this},e.prototype.renderApps=function(){var t,e,i,n,o,s,a,c;return o=function(){var t,e,i,r;for(i=d.applications.getNavApps(),r=[],t=0,e=i.length;t<e;t++)n=i[t],r.push(n.get("name"));return r}(),o=u.without(o,"tags"),e=this.projectModel.get("applications"),t=u.pluck(e,"name"),i=u.object(t,e),a=[],s=[],u.each(o,function(t){return function(e){var n,r,o,c;return o=null!=(c=i[e])?c.order:void 0,null!=o?(n=a,r=!0):(o=-1,n=s,r=!1),n.push(u.extend({order:o,isOn:r},t.itemsMap[e]))}}(this)),c=u.union(u.sortBy(a,"order"),u.sortBy(s,"type")),this.$(".group-apps").html(r({type:"nav-app",items:c})),this},e.prototype.renderPlugins=function(){var t,e,i,n,o,s,a,c;o=d.applications.getNavApps(),n=function(){var t,i,n;for(n=[],t=0,i=o.length;t<i;t++)e=o[t],n.push(e.get("name"));return n}(),t=u.pluck(this.projectModel.get("applications"),"name"),a=u.omit(this.itemsMap,n),s=[];for(i in a)c=a[i],s.push(u.extend(c,{isOn:f.call(t,i)>=0}));return this.$(".fns").html(r({type:"plugin",items:s})),this.triggerHook("render_plugins"),this},e.prototype.openItemDetail=function(t){var e,i,n;return n=$(t.currentTarget).data("app"),e=!!this.itemsMap[n].isPremium,i=$(t.currentTarget).closest("li").attr("class"),this.requestSubView(p).open(c,{projectModel:this.projectModel,type:n,isPremium:e}),d.gta.event({action:"view project "+("nav-app-item"===i?"apps":"plugins"),type:n,control:"Power-ups "+("nav-app-item"===i?"Apps ":"")+"Menu"}),this},e}(l)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v=function(t,e){function i(){this.constructor=t}for(var n in e)y.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},y={}.hasOwnProperty,b=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};m=i(358),f=i(678),d=i(788),g=i(798),s=i(401),u=i(994),h=i(786),o=i(1361),a=i(1019),p=i(1363),c=i(701),n=i(1365),r=["taskUniqueId"],t.exports=l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return v(e,t),e.prototype.viewName="PowerupsItemDetailView",e.prototype.className="modal modal-dialog power-up-common powerups-item-detail-view",e.prototype.hotkeys={"left|up|h|k":"movePrev","right|down|j|l":"moveNext"},e.prototype.events={"click .switch-handler":"onOffToggle","click .config-handler":"openEditorModal","click .thumbnail-wrap":"frameSwitch","click .switcher.prev":"movePrev","click .switcher.next":"moveNext","click .play-ctrl":"playToggle"},e.prototype.initialize=function(t){var e,i,n;return this.type=t.type,this.isPremium=t.isPremium,this.projectModel=t.projectModel,this.appsMap=c.getItems(),this.navigations=f.applications.getNavApps(),this.navigationKeys=function(){var t,i,n,r;for(n=this.navigations,r=[],t=0,i=n.length;t<i;t++)e=n[t],r.push(e.get("name"));return r}.call(this),this.plugins=f.applications.getPlugins(),this.pluginKeys=function(){var t,i,n,r;for(n=this.plugins,r=[],t=0,i=n.length;t<i;t++)e=n[t],r.push(e.get("name"));return r}.call(this),i=this.type,b.call(this.navigationKeys,i)>=0?this.itemType="navigation":(n=this.type,b.call(this.pluginKeys,n)>=0&&(this.itemType="plugin")),this.renderBasic().listen(),this},e.prototype.renderBasic=function(){return this.$el.html(this.genTemplateString()),this.$video=this.$("video"),this.video=this.$video[0],this.$playCtrl=this.$(".play-ctrl"),this.$contentWrap=this.$(".content-wrap"),this.$content=this.$(".content"),this},e.prototype.listen=function(){var t,e,i;return null!=(t=this.video)&&(t.onplay=function(t){return function(){return t.$playCtrl.hide(),m.delay(function(){return t.video.controls=!0},800)}}(this)),null!=(e=this.video)&&(e.onpause=null!=(i=this.video)?i.onended=function(t){return function(){return t.$playCtrl.show(),m.delay(function(){return t.video.controls=!1},800)}}(this):void 0),this.listenTo(this.projectModel,"change:applications",function(t){return function(e){var i;return i=$(t.genTemplateString()).find(".app-detail"),t.$el.find(".app-detail").replaceWith(i)}}(this)),this},e.prototype.genTemplateString=function(){var t,e,i,r,o;return this.isOn=(o=this.type,b.call(m.pluck(this.projectModel.get("applications"),"name"),o)>=0||!1),t=this.projectModel.hasPermission("project.put.applications"),i=t&&this.isPremium&&"free"===this.projectModel.getPaymentPlan().payType,r=t&&!i,e=t&&this.isPluginConfigurable(),n({appInfo:this.appsMap[this.type],type:this.itemType,isOn:this.isOn,isPremium:this.isPremium,isSwitcherShow:r,isConfigurable:e,isShowUpdateUrl:i,updateUrl:g.pay.plans})},e.prototype.onOffToggle=function(t){if(this.$switchHandler=$(t.currentTarget),
!this.isOn||this.isPluginCancelable())return this.isOn?this.requestSubView(o,{title:tb_i18n.get("powerups.app.close"),description:tb_i18n.get("powerups.app.confirm.close",this.projectModel.get("name"),this.appsMap[this.type].name),confirm:tb_i18n.get("powerups.app.close.btn"),onConfirm:function(t){return function(){return t.handleSwitchToggler()}}(this)}):this.handleSwitchToggler(),this.gtaToggleSwitch(),this},e.prototype.handleSwitchToggler=function(){var t,e,i,n,r,o;switch(this.itemType){case"navigation":return e=this.projectModel.getNavigations(),e[this.type]=this.isOn?-1:m.keys(e).length,n=[],t=[],m.chain(e).pairs().sortBy(function(t){return t[1]}).each(function(e){return(e[1]===-1?t:n).push(e[0])}),n.length<1?this.navigationCloseCheck():(i={},m.each(n,function(t,e){return i[t]=e}),m.each(t,function(t){return i[t]=-1}),this.navigationToggle(i,this.isOn));case"plugin":switch(this.type){case"taskUniqueId":return o=null!=(null!=(r=this.getTaskPrefix())?r.match(/^[A-Za-z]{2,4}$/):void 0),this.isOn||o?this.pluginToggle(this.isOn):this.openEditorModal();default:return this.pluginToggle(this.isOn)}}},e.prototype.openEditorModal=function(){var t;switch(this.itemType){case"plugin":switch(this.type){case"taskUniqueId":return t=this.getTaskPrefix(),this.requestSubView(h).open(p,{uniqueIdPrefix:t,backdrop:"static",editMode:this.isOn,projectModel:this.projectModel,onConfirm:function(t){return function(){if(!t.isOn)return t.pluginToggle(t.isOn,!0)}}(this)})}}},e.prototype.navigationCloseCheck=function(){return s.show({message:tb_i18n.get("powerups.item.detail.nav.apps.least"),status:"error"})},e.prototype.pluginToggle=function(t,e){return this.projectModel.pluginToggle(this.type,{enable:!t,success:function(i){return function(){if(!e)return s.success(i.getMessage(t))}}(this)}),this},e.prototype.navigationToggle=function(t,e){return this.projectModel.setNavigation(t,{success:function(t){return function(){return s.success(t.getMessage(e))}}(this)}),this},e.prototype.frameSwitch=function(t){var e,i,n;return e=$(t.currentTarget),i=e.data("no"),0!==i&&null!=(n=this.video)&&n.pause(),e.addClass("active").siblings().removeClass("active"),this.$contentWrap.attr("translatex","left"+i),this.$content.attr("translatex","left"+i),this},e.prototype.playToggle=function(){if(this.video)return this.video.isPlaying?this.video.pause():this.video.play(),this},e.prototype.getMessage=function(t){return t?tb_i18n.get("powerups.item.detail.closed",this.appsMap[this.type].name):tb_i18n.get("powerups.item.detail.opened",this.appsMap[this.type].name)},e.prototype.getTaskPrefix=function(){return this.projectModel.get("uniqueIdPrefix")},e.prototype.isPluginCancelable=function(){switch(this.type){case"tasklist":return!(u.get(this.projectModel.id).length>1)||(this.requestSubView(a,{$toggler:this.$switchHandler,title:tb_i18n.get("powerups.item.close.plugin.tasklist"),description:tb_i18n.get("powerups.item.detail.tasklist.warning",this.appsMap[this.type].name),confirmStr:tb_i18n.get("confirm"),onConfirm:function(){}}).show(),!1);default:return!0}},e.prototype.isPluginConfigurable=function(){return~r.indexOf(this.type)},e.prototype.gtaToggleSwitch=function(){return f.gta.event({action:(this.isOn?"de":"")+"activated project "+("navigation"===this.itemType?"apps":"plugins"),type:this.type,control:"Power-up App Detail",projectid:this.projectModel.id})},e.prototype.moveNext=function(t){var e;return t.preventDefault(),null!=(e=this.$(".thumbnail-wrap.active").next())&&e.click(),this},e.prototype.movePrev=function(t){var e;return t.preventDefault(),null!=(e=this.$(".thumbnail-wrap.active").prev())&&e.click(),this},e.prototype.remove=function(){return null!=this.video&&(this.video.onplay=this.video.onended=this.video.onpause=null),e.__super__.remove.apply(this,arguments)},e}(d)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(358),o=i(788),n=i(1362),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="confirmView",e.prototype.className="confirm-danger-modal modal fade in",e.prototype.hotkeys={esc:function(t){return t.preventDefault(),this.hide()}},e.prototype.events={"click .modal-close":"hide","click .confirm-handler":"confirm"},e.prototype.initialize=function(t){return this.options=s.extend({title:"",description:"",confirm:tb_i18n.get("confirm"),onConfirm:function(){}},t),this.render().show(),this},e.prototype.render=function(){return this.$el.html(n(this.options)),this},e.prototype.show=function(){return this.$el.appendTo("body"),this.$backdrop=$("<div></div>").addClass("confirm-danger-modal-backdrop fade").insertAfter(this.$el),s.delay(function(t){return function(){return t.$backdrop.addClass("in")}}(this))},e.prototype.hide=function(){var t,e;return null!=(t=this.$el)&&t.removeClass("in"),null!=(e=this.$backdrop)&&e.removeClass("in"),s.delay(function(t){return function(){if(t.$el)return t.$backdrop.remove(),t.remove()}}(this),350)},e.prototype.confirm=function(){return this.options.onConfirm(),this.hide()},e.prototype.remove=function(){var t;return null!=(t=this.$backdrop)&&t.remove(),e.__super__.remove.apply(this,arguments)},e}(o)},function(t,e){t.exports=function(t){var e='<div class="modal-dialog"> <div class="modal-content"> <header class="modal-header"> <h4 class="modal-title text-center">'+t.title+'</h4> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </header> <div class="modal-body"> <p>'+t.description+'</p> </div> <div class="modal-footer"> <button class="confirm-handler btn btn-block btn-danger">'+t.confirm+"</button> </div> </div></div>";return e}},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;n=i(1364),o=i(686),a=i(788),r=i(401),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.viewName="TaskIdDialogView",e.prototype.className="task-id-dialog-view modal-dialog modal-padding",e.prototype.width=360,e.prototype.hotkeys={esc:"onEscClick"},e.prototype.events={"click .confirm-handler":"confirm","keyup .task-id-input":"checkValid","keydown .task-id-input":"submit","click .modal-close":"onCloseClick"},e.prototype.initialize=function(t){return this.options=t,this.projectModel=this.options.projectModel,this.editMode=this.options.editMode,this.render(),this.listen()},e.prototype.listen=function(){if(!this.editMode)return o.on("system:notifications",function(t){if("taskUniqueId"===t.name&&"success"===t.status)return r.success(tb_i18n.get("powerups.taskUniqueId.success.tip"))})},e.prototype.render=function(){var t,e,i;return this.editMode?(i=tb_i18n.get("powerups.taskUniqueId.dialog.edit.title"),e=tb_i18n.get("powerups.taskUniqueId.dialog.edit.desc"),t=tb_i18n.get("powerups.taskUniqueId.dialog.edit.confirm")):(i=tb_i18n.get("powerups.taskUniqueId.dialog.title"),e=tb_i18n.get("powerups.taskUniqueId.dialog.desc"),t=tb_i18n.get("powerups.taskUniqueId.dialog.confirm")),this.$el.html(n({title:i,confirm:t,description:e,uniqueIdPrefix:this.options.uniqueIdPrefix})).width(this.width),this.$confirmHandler=this.$(".confirm-handler"),this},e.prototype.onEscClick=function(){if(!this.isSubmitting)return this.parentView.close()},e.prototype.onOpen=function(){var t;return null!=(t=this.$("input"))?t.focusAtEnd():void 0},e.prototype.updateUniquePrefix=function(t){return new Promise(function(e){return function(i,n){return e.projectModel.setUniqueIdPrefix({attrs:{uniqueIdPrefix:t},success:i,error:n})}}(this))},e.prototype.confirm=function(){var t;if(this.valid)return t=this.$(".task-id-input").val().trim(),this.isSubmitting=!0,this.editMode||this.$confirmHandler.text(tb_i18n.get("powerups.taskUniqueId.dialog.submitting")).addClass("is-submitting"),this.updateUniquePrefix(t).then(function(t){return function(){var e;return t.editMode&&r.success(tb_i18n.get("powerups.taskUniqueId.success.edit.tip")),"function"==typeof(e=t.options).onConfirm&&e.onConfirm(),t.parentView.close()}}(this))["catch"](function(t){return function(e){return console.error(e),t.parentView.close()}}(this))},e.prototype.onCloseClick=function(){if(this.isSubmitting)return!1},e.prototype.submit=function(t){if(13===t.keyCode)return this.confirm()},e.prototype.checkValid=function(){var t;if(t=this.isValid(),this.valid!==t)return this.valid=t,this.valid?this.$confirmHandler.removeClass("disabled"):this.$confirmHandler.addClass("disabled")},e.prototype.isValid=function(){var t;return t=this.$(".task-id-input").val().trim(),!!t&&(t!==this.options.uniqueIdPrefix&&null!=t.match(/^[A-Za-z]{2,4}$/))},e}(a)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<header class="modal-header"> <h4 class="modal-title text-center">'+t.title+'</h4> <a class="modal-close icon icon-remove" data-dismiss="modal"></a></header><section class="modal-body flex-vert flex-stretch"> <p>'+t.description+'</p> <input type="text" class="task-id-input form-control" placeholder="'+tb_i18n.get("powerups.taskUniqueId.dialog.placeholder")+'" value="'+e(t.uniqueIdPrefix)+'"> <button class="confirm-handler btn btn-primary btn-block disabled">'+t.confirm+"</button></section>";return i}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="modal-content"> <div class="modal-header"> <div class="modal-title text-center"> '+tb_i18n.get("powerups.modal.title.detail")+' </div> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </div> <div class="modal-body"> <div class="app-detail"> <div class="app-logo app-card" data-app="'+t.appInfo.type+'"> <span class=" ';"navigation"===t.type?i+=" icon icon-"+t.appInfo.className+" size-sd ":"plugin"==t.type&&(i+=" img-icon img-icon-"+t.appInfo.type+" size-sd "),i+='"></span> </div> <div class="app-content"> <h4 class="app-name">'+t.appInfo.name,t.isPremium&&(i+='<span class="pro-mark">Pro</span>'),t.isOn&&(i+='<span class="check-wrap img-circle"><span class="icon icon-tick-thin"></span></span>'),i+='</h4> <div class="app-author muted">'+tb_i18n.get("powerups.author","Teambition")+'</div> <div class="app-desc muted">'+t.appInfo.des+"</div> ",t.isShowUpdateUrl&&(i+=' <div class="app-handler-wrap update-url"> <a href="'+e(t.updateUrl)+"\" target=\"_blank\" class=\"btn btn-default\" data-gta=\"{action: 'reach plan limit', type: 'plus', control: 'power-up', category: '"+t.appInfo.name+"'}\"> "+tb_i18n.get("powerups.item.update.hint")+" </a> </div> "),i+=" ",t.isSwitcherShow&&(i+=' <div class="app-handler-wrap on-off-toggle"> ',t.isOn?(i+=" ",t.isConfigurable&&(i+=' <a class="btn btn-default config-handler" data-action="modify"> '+tb_i18n.get("setting")+" </a> "),i+=' <a class="btn btn-danger switch-handler" data-action="close"> '+tb_i18n.get("close")+" </a> "):i+=' <a class="btn btn-default switch-handler" data-action="open"> '+tb_i18n.get("open")+" </a> ",i+=" </div> "),i+=' </div> </div> <div class="content-wrap" translateX="left0"> <div class="switcher prev"><span class="icon icon-chevron-left"></span></div> <div class="switcher next"><span class="icon icon-chevron-right"></span></div> <div class="content"> ',i+=t.appInfo.video?' <video poster="'+t.appInfo.poster+'" preload="metadata"> <source src="'+t.appInfo.video+'" type="video/mp4"> </video> ':' <img src="'+t.appInfo.poster+'"> ',i+=" ";var n=t.appInfo.imgs;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <img src="'+r+'"> ';i+=" ",t.appInfo.video&&(i+=' <span class="icon icon-play play-ctrl"></span> '),i+=' </div> </div> <div class="action-btns"> <div class="thumbnail-wrap poster active" data-no="0"> ',t.appInfo.video&&(i+=' <span class="icon icon-play"></span> '),i+=' <img src="'+t.appInfo.poster+'"> </div> ';var a=t.appInfo.imgs;if(a)for(var r,o=-1,c=a.length-1;o<c;)r=a[o+=1],i+=' <div class="thumbnail-wrap" data-no="'+(o+1)+'"> <img src="'+r+'"> </div> ';return i+=" </div> </div></div>"}},function(t,e,i){t.exports=function(t){var e="",n=i(679),r=n.FEATURES;return e+='<div class="modal-content"> <div class="modal-header"> <div class="modal-title text-center">'+tb_i18n.get("plugin")+'</div> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </div> <div class="modal-body"> <h4 class="items-title">'+tb_i18n.get("powerups.powerup.groupApp")+'</h4> <ul class="group-apps"></ul> <h4 class="items-title"> '+tb_i18n.get("powerups.powerup.plugin")+" ",r.plugins&&(e+=' <a class="pull-right link-add-handler add-plugins" href="/appstore/apps" target="_blank" data-gta="{action: \'view all plugins\'}"><span class="icon icon-plus-sign"></span>'+tb_i18n.get("powerups.add.plugins")+"</a> "),e+=' </h4> <ul class="fns"></ul> </div></div>'}},function(t,e){t.exports=function(t){var e="",i=t.items;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+='<li class="'+t.type+'-item"> <div class="app-card" data-app="'+n.type+'"> <span class=" ',"nav-app"===t.type?e+=" icon icon-"+n.className+" ":"plugin"==t.type&&(e+=" img-icon img-icon-"+n.type+" size-sd "),e+='"></span> ',n.isPremium&&(e+=' <span class="pro-mark">Pro</span> '),e+=' </div> <div class="app-card-des text-center"> ',n.isOn&&(e+=' <span class="check-wrap img-circle"> <span class="icon icon-tick-thin"></span> </span> '),e+=" <span>"+n.name+"</span> </div></li>";return e}},function(t,e){t.exports=function(t){var e='<form class="project-setting-form preference-form"> <div class="no-permission-section"></div> <div class="project-setting-section"> <label>'+tb_i18n.get("project.settings.label.sort")+'</label> <div class="subtitle">'+tb_i18n.get("project.setting.nav.hint")+'</div> <ul class="apps-list"> ',i=t.apps;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <li class="app-card flex flex-vcenter" data-app="'+n.name+'"> <span class="icon '+n.icon+'"></span> <span class="app-title">'+n.title+"</span> </li> ";return e+=' </ul> </div> <hr class="seperator"> <div class="project-setting-section"> ',t.isOrganization()?e+=" <label>"+tb_i18n.get("project.settings.label.permission")+'</label> <div class="subtitle"> '+tb_i18n.get("project.setting.defaultrole.tips")+' </div> <div class="dropdown-list" data-fields="role"> </div> <div class="subtitle"> '+tb_i18n.get("project.setting.defaultrole.help",t._organizationId)+" </div> ":(t.isProfessional()||t.isFree())&&(e+=" <label>"+tb_i18n.get("project.settings.label.permission")+'</label> <div class="subtitle"> ',t.isProfessional()?e+=" "+tb_i18n.get("profession.setting.permission.hint")+" ":t.isFree()&&(e+=" "+tb_i18n.get("project.setting.permission.hint")+" "),e+=" <a class='open-permissions' href=\"/applications/permissions/personal/"+t._projectId+'" target="_blank"> '+tb_i18n.get("organization.settings.roles.and.permissions")+" </a> </div> "),e+=" </div></form>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v=function(t,e){function i(){this.constructor=t}for(var n in e)y.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},y={}.hasOwnProperty;f=i(358),g=i(678),n=i(357),h=i(788),o=i(401),m=i(786),d=i(1010),a=i(1370),u=i(1373),s=i(1376),r=i(805),p=i(1378),c=i(1379),t.exports=l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return v(e,t),e.prototype.viewName="ProjectSettingsMoreView",e.prototype.className="project-settings-view project-settings-more-view",e.prototype.events={"click .archive-handler":"showArchive","click .quit-handler":"showQuit","click .delete-handler":"showDelete"},e.prototype.initialize=function(t){return this.projectModel=t.projectModel,this.organizationsCollection=t.organizationsCollection,this.render()},e.prototype.loadTeamsCollection=function(t){},e.prototype.canArchive=function(){return this.projectModel.hasPermission("put.archive")},e.prototype.canQuit=function(){return this.projectModel.getCanQuit()},e.prototype.canDelete=function(){return this.projectModel.hasPermission("del")},e.prototype.canQuitOnly=function(){return this.canQuit()&&!this.canArchive()&&!this.canDelete()},e.prototype.isInTeam=function(){return new Promise(function(t){return function(e,i){return d.fetch(t.projectModel.id,{boundToObjectType:"project",success:function(t){var i,n;return n=f.reduce(t.toJSON().map(function(t){return t.hasMembers}),function(t,e){return t.concat(e)}),i=!!f.find(n||[],function(t){return t._id===g.user.id}),e(i)},error:function(t,e){return i(e)}})}}(this))},e.prototype.showArchive=function(t){return t.preventDefault(),this.requestSubView(m).open(s,{projectModel:this.projectModel})},e.prototype.showQuit=function(t){return t.preventDefault(),this.projectModel.get("_organizationId")?this.isInTeam().then(function(t){return function(e){return e?t.showInTeamDialog():t.showQuitConfirm()}}(this)):this.showQuitConfirm()},e.prototype.showQuitConfirm=function(){return this.requestSubView(m).open(a,{projectModel:this.projectModel,organizationsCollection:this.organizationsCollection})},e.prototype.showInTeamDialog=function(t){return this.requestSubView(m).open(r,{title:tb_i18n.get("project.settings.cannot.quit"),content:tb_i18n.get("project.settings.cannot.quit.content")})},e.prototype.showDelete=function(t){var e;return t.preventDefault(),e=this.projectModel.get("_organizationId"),this.requestSubView(m).open(u,{model:this.projectModel,template:function(){return p({title:tb_i18n.get("project.settings.delete"),message:tb_i18n.get("project.settings.delete.msg"),button:tb_i18n.get("project.settings.delete")})},success:function(){return o.success(tb_i18n.get("project.settings.delete.success")),e?g.router.navigate("organization/"+e,{trigger:!0}):g.router.navigate("projects",{trigger:!0})}})},e.prototype.render=function(){return this.$el.html(c(this))},e}(h)},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;l=i(678),r=i(401),o=i(699),c=i(788),n=i(1371),a=i(1372),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="ProjectSettingsQuitView",e.prototype.className="project-settings-quit-view modal-dialog modal-padding",e.prototype.events={"click .confirm-handler":"submit","change .project-owner-select":"selectOwner"},e.prototype.initialize=function(t){return this.projectModel=t.projectModel,this.projectModel.isOwner()&&!this.projectModel.get("_organizationId")?o.fetch(this.projectModel.id,{boundToObjectType:"project",success:function(t){return function(e){var i;if(t.projectMembersCollection=e,i=t.projectMembersCollection.where({_roleId:2}),t.renderBasic(),i.length<=1)return t.renderTransfer()}}(this)}):this.renderBasic(),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$submit=this.$(".confirm-handler"),this},e.prototype.renderTransfer=function(){var t;return this.$submit.addClass("disabled"),t=[],this.projectMembersCollection.each(function(e){if(e.get("_userId")!==l.user.id)return t.push(e.toJSON())}),this.$(".modal-body").html(a({members:t}))},e.prototype.selectOwner=function(t){return this._ownerId=$(t.currentTarget).val().trim(),this.$submit[this._ownerId?"removeClass":"addClass"]("disabled")},e.prototype.submit=function(){if(!this.$submit.hasClass("disabled"))return this.projectModel.quit({wait:!0,attrs:this._ownerId?{_ownerId:this._ownerId}:null,success:function(t){return function(){var e,i,n;return n=t.projectModel,e=n.get("_organizationId"),i=n.get("_orgRoleId")>=0,r.show({message:tb_i18n.get("project.settings.leave.success"),status:"success"}),t.close(),e&&i?l.router.navigate("organization/"+e,{trigger:!0}):l.router.navigate("projects",{trigger:!0}),setTimeout(function(){var t;if(2!==n.get("_orgRoleId"))return null!=(t=n.collection)?t.remove(n):void 0},1e3)}}(this)}),this},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.remove(),this},e}(c)},function(t,e){t.exports=function(t){var e='<div class="modal-content"> <header class="modal-header"> <h4 class="modal-title">'+tb_i18n.get("project.settings.leave")+'</h4> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </header> <div class="modal-body"> <p>'+tb_i18n.get("project.settings.leave.msg")+'</p> </div> <div class="modal-footer"> <button class="confirm-handler btn btn-primary">'+tb_i18n.get("project.settings.leave")+"</button> </div></div>";return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="<p>"+tb_i18n.get("project.setting.transfer.and.quit")+'</p><label class="form-control-select"> <select class="project-owner-select form-control"> <option value="" selected>'+tb_i18n.get("project.settings.select.owner")+"</option> ",n=t.members;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <option value="'+r._id+'">'+e(r.name)+"</option> ";return i+=" </select></label>"}},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;i(1374),s=i(678),n=i(401),o=i(788),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="SettingsDeleteView",e.prototype.className="settings-delete-view modal-dialog modal-padding",e.prototype.events={"click .confirm-handler":"onSubmit"},e.prototype.initialize=function(t){return this.options=t,this.renderBasic()},e.prototype.onSubmit=function(t){var e,i,n;return n=this.$(".delete-input:visible"),n.val()?"DELETE"===n.val().toUpperCase()?this["delete"]():n.val(""):(e=$(t.currentTarget),i=e.next(),e.transition({width:165},function(){return i.show()}))},e.prototype["delete"]=function(){var t;return t=this.options,this.options.model.destroy({wait:!0,success:function(e){return function(){return t.success(),e.close()}}(this)})},e.prototype.close=function(){var t;return null!=(t=this.parentView)?t.remove():void 0},e.prototype.renderBasic=function(){return this.$el.html(this.options.template())},e}(o)},function(t,e){},,function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(678),r=i(401),n=i(1377),s=i(696),a=i(788),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="ProjectSettingsArchiveView",e.prototype.className="project-settings-archive-view modal-dialog modal-padding",e.prototype.events={"click .confirm-handler":"submit"},e.prototype.initialize=function(t){return this.projectModel=t.projectModel,this.renderBasic(),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this},e.prototype.submit=function(){var t;return t=this.projectModel.get("_organizationId"),this.projectModel.save(null,{wait:!0,attrs:{isArchived:!0},success:function(e){return function(){var i,n;return r.show({message:tb_i18n.get("project.settings.archive.success"),status:"success"}),null!=(i=e.projectModel)&&null!=(n=i.collection)&&n.remove(e.projectModel),s.get("archived_0").add(e.projectModel),e.close(),t?c.router.navigate("organization/"+t,{trigger:!0}):c.router.navigate("projects",{trigger:!0})}}(this),error:function(t){return r.show({message:tb_i18n.get("project.settings.archive.error"),status:"error"})}}),this},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.remove(),this},e}(a)},function(t,e){t.exports=function(t){var e='<div class="modal-content"> <header class="modal-header"> <h4 class="modal-title">'+tb_i18n.get("project.settings.archive")+'</h4> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </header> <div class="modal-body"> <p>'+tb_i18n.get("project.settings.archive.msg")+'</p> </div> <div class="modal-footer"> <button class="confirm-handler btn btn-primary">'+tb_i18n.get("project.settings.archive")+"</button> </div></div>";return e}},function(t,e){t.exports=function(t){var e='<div class="modal-content"> <header class="modal-header"> <h4 class="modal-title">'+t.title+'</h4> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </header> <div class="modal-body"> <p>'+t.message+'</p> </div> <div class="modal-footer"> <p> <a class="btn btn-danger confirm-handler form-control">'+t.button+'</a> <input class="delete-input form-control" type="text" placeholder="'+tb_i18n.get("project.settings.placeholder")+'"/> </p> </div></div>';return e}},function(t,e){t.exports=function(t){var e='<form class="project-setting-form more-form"> <div class="project-setting-section"> <label>'+tb_i18n.get("project.settings.label.actions")+"</label> ";return t.canQuitOnly()?e+=' <div class="subtitle">'+tb_i18n.get("project.settings.leave.msg")+'</div> <div class="handler-group"> <button class="red-handler quit-handler">'+tb_i18n.get("project.settings.leave")+"</button> </div> ":(e+=' <div class="subtitle">'+tb_i18n.get("project.settings.label.subtitle.actions")+'</div> <div class="handler-group"> ',t.canArchive()&&(e+=' <button class="blue-handler archive-handler">'+tb_i18n.get("project.settings.archive")+"</button> "),e+=" ",t.canQuit()&&!t.canQuitOnly()&&(e+=' <button class="red-handler quit-handler">'+tb_i18n.get("project.settings.leave")+"</button> "),e+=" ",t.canDelete()&&(e+=' <button class="red-handler delete-handler">'+tb_i18n.get("project.settings.button.delete")+"</button> "),e+=" </div> "),e+=" </div></form>"}},function(t,e){t.exports=function(t){var e='<div class="panel-layer"> <div class="chat-room-panel-wrap project-message-panel-wrap"> <div class="mute-container clearfixt"> <div class="form-group pull-right"> <label>'+tb_i18n.get("chat.room.group.mute")+'</label> <div class="toggle blue pull-right"> <input type="button" class="switch-mute check" data-key="muteGroupMessage"> <div class="switch"></div> <div class="track"></div> </div> </div> </div> <section class="project-messages-content scrollable thin-scroll"> <ul class="project-message-list"></ul> <div class="empty-tip chat-group"> <span class="img-icon"></span> <div class="tips"> <p>'+tb_i18n.get("chat.room.group.empty1")+'</p> <p class="tip-small">'+tb_i18n.get("chat.room.group.empty2")+'</p> </div> </div> <div class="place-bottom"></div> </section> <footer class="chat-room-creator-wrapper"></footer> </div></div>';return e}},function(t,e){t.exports=function(t){var e='<header class="chat-modal-header"> <center><strong><span class="title">'+tb_i18n.get("chat.modal.title")+'</span></strong></center> <a class="close-handler"><i class="icon icon-remove"></i></a></header><div class="chat-modal-body"> <div class="panel-left"> <div class="actions-group"> <div class="actions"> <a class="new-chat-handler" data-gta="{action: \'begin new chat\', control: \'Chat Window\'}"> <i class="icon icon-circle-cross"></i> '+tb_i18n.get("chat.nav.popover.new.chat")+' </a> </div> <div class="actions dropdown handler-wrapper"> <a class="handler-switch hinted" data-toggle="dropdown" data-gta="event" data-label="open handler wrapper" data-title="'+tb_i18n.get("more.operations")+'"> <span class="icon icon-more"></span> </a> <ul class="dropdown-menu handler-list" role="menu" aria-labelledby="dLabel"> <li> <a class="inbox-handler read-all-handler" data-gta="event" data-label="read all messages"> <span class="icon icon-tick"></span>'+tb_i18n.get("inbox.read.messages")+' </a> </li> <li> <a class="inbox-handler clear-readed-handler" data-gta="event" data-label="clear readed messages"> <span class="icon icon-trash"></span>'+tb_i18n.get("inbox.clear.messages")+' </a> </li> </ul> </div> </div> <div class="message-list-container"> </div> </div> <div class="panel-right"></div></div>';return e}},function(t,e,i){var n,r,o,s,a,c,l;r=i(358),n=i(1383),s=function(t){var e,i,r,s;if(t)return r=t.genMessage(),e=t.get("latestActivityAction"),i=n.getSystemAction(e),s=i?o(i,t):o({title:r.title,noContent:!0},t)},o=function(t,e){var i,n,r;return n=e.genMessage(),i=e.get("latestActivityAction"),t.title=tb_i18n.get("message.system."+i),r={},r=t.isRemoved?{placeholder:"placeholder-no-resulet",title:t.title,content:t.noContent?void 0:n.creator.name+" "+n.title,handlers:a(t,e)}:{placeholder:"placeholder-welcome",title:n.creator.name+" "+n.title,content:t.noContent?void 0:t.title,handlers:a(t,e)},r.action=e.get("latestActivityAction"),r},a=function(t,e){var i,n,r;return i=[],t.canEnterProject&&(r=l(e),r&&i.push(r)),t.canEnterOrg&&(n=c(e),n&&i.push(n)),t.canCreateChat&&i.push({"class":"open-chat-handler",type:"chat",title:tb_i18n.get("activity.system.handlers.openchat",e.genMessage().creator.name)}),i},l=function(t){var e;if(e=t.genMessage().project,!r.isEmpty(e))return{"class":"url-handler",type:"project",url:"/project/"+e._id,name:e.name,title:tb_i18n.get("activity.system.handlers.enterproject",e.name)}},c=function(t){var e;if(e=t.genMessage().organization,!r.isEmpty(e))return{"class":"url-handler",type:"organization",url:"/organization/"+e._id+"/projects",name:e.name,title:tb_i18n.get("activity.system.handlers.enterorg",e.name)}},e.formatData=s},function(t,e,i){var n,r;n=i(358),r=n.once(function(){var t,e,i,r,o,s,a,c;return o=r=i=e=!0,t=function(t,e){return n.mapObject(t,function(t){return n.extend(t,e)})},c={"activity.task.remove":{},"activity.work.remove":{},"activity.post.remove":{},"activity.event.remove":{},"activity.entry.remove":{}},t(c,{isRemoved:o,canEnterProject:r,canCreateChat:e}),s={"activity.project.archive":{},"activity.project.remove":{},"activity.project.remove.member":{},"activity.organization.remove.member":{},"activity.organization.remove":{}},t(s,{isRemoved:o}),a={"activity.project.unarchive":{canEnterProject:!0},"activity.project.invite.members":{canEnterProject:!0},"activity.organization.invite.members":{canEnterOrg:!0}},n.extend(c,s,a)}),e.getSystemAction=function(t){return r()[t]}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="system-message-content text-center"> <div class="system-message-image '+e(t.placeholder)+'"></div> <h4>'+e(t.title)+"</h4> <p>"+e(t.content)+'</p> <div class="message-btn"> ',n=t.handlers;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <a href="'+(r.url||"javascript:void(0);")+'" class="btn btn-primary '+r["class"]+"\" data-gta=\"{action: 'open detail', type: '"+r.type+"', control: 'feed', category: '"+t.action+"}'\"> "+r.title+" </a> ";return i+=" </div></div>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;p=i(678),c=i(679),r=i(790),s=i(677),a=i(788),n=i(1386),l=function(){return{zh:tb_i18n.point("language","zh"),en:tb_i18n.point("language","en"),ja:tb_i18n.point("language","ja"),
ko:tb_i18n.point("language","ko"),zh_tw:tb_i18n.point("language","zh_tw")}},t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="UserSettingsView",e.prototype.className="user-settings-view modal-dialog card",e.prototype.events={"click .switchHandler":"togglePreference","click .notificationHandler":"toggleNotificationSetting","click .desktop-notification-handler":"setupDesktopNotification","click .language-handler":"changeLanguage"},e.prototype.initialize=function(){return this.userModel=p.user,this.changes={},this.renderBasic(),this},e.prototype.renderBasic=function(){var t;return t=p.PREFERENCE.structureNotification(),t.isUsePanel=p.PREFERENCE.getIsUsePanelToOpenTask(),t.desktopNotification=r.support(),t.lang=tb_i18n.getLanguage(),t.languages=c.LANGUAGES,t.languageTips=l(),this.$el.html(n(t)),this.$content=this.$(".user-settings-content"),this.$mask=this.$(".progress-mask"),this.$switcher=this.$(".section-switcher"),this},e.prototype.updateTaskPanel=function(t){var e,i;return i=!p.PREFERENCE.getIsUsePanelToOpenTask(),t[i?"addClass":"removeClass"]("checked"),e=i?{openWindowMode:"slide"}:{openWindowMode:"window"},p.PREFERENCE.set(e),p.PREFERENCE.save(null,{attrs:e}),p.PREFERENCE.set("isUsePanel",!1)},e.prototype.togglePreference=function(t){var e,i,n,r;return e=$(t.currentTarget),n=e.data("key"),"openWindowMode"===n?this.updateTaskPanel(e):(r=!p.PREFERENCE.get(n),e[r?"addClass":"removeClass"]("checked"),p.PREFERENCE.set(n,r),i={},i[n]=r,p.PREFERENCE.save(null,{attrs:i}),this)},e.prototype.toggleNotificationSetting=function(t){var e,i;return e=$(t.currentTarget),i=e.data("type"),e.hasClass("checked")?(this.changes[i]=!1,e.removeClass("checked")):(this.changes[i]=!0,e.addClass("checked")),p.PREFERENCE.updateNotification(this.changes),this},e.prototype.changeLanguage=function(t){var e,i;if(!this.changingLang&&(e=$(t.currentTarget),i=e.data("lang"),i!==p.PREFERENCE.getLanguage()&&p.PREFERENCE.setLanguage(i)))return this.changingLang=!0,e.siblings().addClass("btn-default").removeClass("btn-primary"),e.addClass("btn-primary").removeClass("btn-default")},e.prototype.setupDesktopNotification=function(){return r.setup(),this},e}(a)},function(t,e){t.exports=function(t){var e='<header class="user-settings-header card-header"> <p class="card-title">'+tb_i18n.get("user.settings.setting")+'</p> <a class="modal-close icon icon-remove" data-dismiss="modal"></a></header><div class="user-settings-content"> <h4>'+tb_i18n.get("language.label")+'</h4> <div class="form-group"> <div class="clearfix"> ',i=t.languages;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <a class="btn ',e+=t.lang==n?"btn-primary":"btn-default",e+=' language-handler" data-lang="'+n+'"> '+t.languageTips[n]+" </a> ";return e+=' </div> </div> <hr> <form class="notification-form"> <div class="form-group clearfix"> <label>'+tb_i18n.get("user.settings.preference.usePanelTitle")+'</label> <div class="toggle blue pull-right"> <input class="switchHandler check ',t.isUsePanel&&(e+="checked"),e+='" type="button" data-key="openWindowMode"> <div class="switch"></div> <div class="track"></div> </div> </div> </form> <hr> <div class="notification-header"> <h4>'+tb_i18n.get("user.settings.notification.setting")+'</h4> <p class="notification-type-label pull-right">'+tb_i18n.get("user.settings.mobile")+'</p> <p class="notification-type-label pull-right">'+tb_i18n.get("email")+'</p> </div> <form class="notification-form"> <div class="form-group clearfix"> <label>'+tb_i18n.get("user.settings.receive.post.notice")+'</label> <div class="toggle blue pull-right"> <input class="notificationHandler check',t.newpost.mobile&&(e+=" checked"),e+='" type="button" data-type="newpost.mobile"> <div class="switch"></div> <div class="track"></div> </div> <div class="toggle blue pull-right"> <input class="notificationHandler check',t.newpost.email&&(e+=" checked"),e+='" type="button" data-type="newpost.email"> <div class="switch"></div> <div class="track"></div> </div> </div> <div class="form-group clearfix"> <label>'+tb_i18n.get("user.settings.receive.task.notice")+'</label> <div class="toggle blue pull-right"> <input class="notificationHandler check',t.newtask.mobile&&(e+=" checked"),e+='" type="button" data-type="newtask.mobile"> <div class="switch"></div> <div class="track"></div> </div> <div class="toggle blue pull-right"> <input class="notificationHandler check',t.newtask.email&&(e+=" checked"),e+='" type="button" data-type="newtask.email"> <div class="switch"></div> <div class="track"></div> </div> </div> <div class="form-group clearfix"> <label>'+tb_i18n.get("user.settings.receive.file.notice")+'</label> <div class="toggle blue pull-right"> <input class="notificationHandler check',t.newwork.mobile&&(e+=" checked"),e+='" type="button" data-type="newwork.mobile"> <div class="switch"></div> <div class="track"></div> </div> <div class="toggle blue pull-right"> <input class="notificationHandler check',t.newwork.email&&(e+=" checked"),e+='" type="button" data-type="newwork.email"> <div class="switch"></div> <div class="track"></div> </div> </div> <div class="form-group clearfix"> <label>'+tb_i18n.get("user.settings.receive.event.notice")+'</label> <div class="toggle blue pull-right"> <input class="notificationHandler check',t.newevent.mobile&&(e+=" checked"),e+='" type="button" data-type="newevent.mobile"> <div class="switch"></div> <div class="track"></div> </div> <div class="toggle blue pull-right"> <input class="notificationHandler check',t.newevent.email&&(e+=" checked"),e+='" type="button" data-type="newevent.email"> <div class="switch"></div> <div class="track"></div> </div> </div> <div class="form-group clearfix"> <label>'+tb_i18n.get("user.settings.comment.notice")+'</label> <div class="toggle blue pull-right"> <input class="notificationHandler check',t.comment.mobile&&(e+=" checked"),e+='" type="button" data-type="comment.mobile"> <div class="switch"></div> <div class="track"></div> </div> <div class="toggle blue pull-right"> <input class="notificationHandler check',t.comment.email&&(e+=" checked"),e+='" type="button" data-type="comment.email"> <div class="switch"></div> <div class="track"></div> </div> </div> <div class="form-group clearfix"> <label>'+tb_i18n.get("user.settings.participant.notice")+'</label> <div class="toggle blue pull-right"> <input class="notificationHandler check',t.involve.mobile&&(e+=" checked"),e+='" type="button" data-type="involve.mobile" > <div class="switch"></div> <div class="track"></div> </div> <div class="toggle blue pull-right"> <input class="notificationHandler check',t.involve.email&&(e+=" checked"),e+='" type="button" data-type="involve.email"> <div class="switch"></div> <div class="track"></div> </div> </div> <div class="form-group clearfix"> <label>'+tb_i18n.get("user.settings.task.file.update.notice")+'</label> <div class="toggle blue pull-right"> <input class="notificationHandler check',t.update.mobile&&(e+=" checked"),e+='" type="button" data-type="update.mobile"> <div class="switch"></div> <div class="track"></div> </div> <div class="toggle blue pull-right"> <input class="notificationHandler check',t.update.email&&(e+=" checked"),e+='" type="button" data-type="update.email"> <div class="switch"></div> <div class="track"></div> </div> </div> <div class="form-group clearfix"> <label>'+tb_i18n.get("user.settings.daily.mail.notice")+'</label> <div class="toggle toggle-placeholder pull-right"> </div> <div class="toggle blue pull-right"> <input class="notificationHandler check',t.daily.email&&(e+=" checked"),e+='" type="button" data-type="daily.email"> <div class="switch"></div> <div class="track"></div> </div> </div> <div class="form-group clearfix"> <label>'+tb_i18n.get("user.settings.monthly.mail.notice")+'</label> <div class="toggle toggle-placeholder pull-right"> </div> <div class="toggle blue pull-right"> <input class="notificationHandler check',t.monthly.email&&(e+=" checked"),e+='" type="button" data-type="monthly.email"> <div class="switch"></div> <div class="track"></div> </div> </div> </form> ',t.desktopNotification&&(e+=' <hr /> <div class="clearfix"> <a class="btn btn-default desktop-notification-handler">'+tb_i18n.get("desktop.notification")+"</a> </div> "),e+="</div>"}},function(t,e){t.exports=function(t){var e='<header class="inbox-header sub-navigator"> <div class="inbox-wrap flex-horiz"> <div class="inbox-side flex-static"> <div class="messages-header flex-horiz flex-vcenter flex-between"> <div class="type-toggler"> </div> <div class="dropdown handler-wrapper"> <a class="handler-switch hinted" data-toggle="dropdown" data-gta="event" data-label="open handler wrapper" data-title="'+tb_i18n.get("more.operations")+'"> <span class="icon icon-more"></span> </a> <ul class="dropdown-menu handler-list" role="menu" aria-labelledby="dLabel"> <li> <a class="inbox-handler read-all-handler"> <span class="icon icon-tick"></span>'+tb_i18n.get("inbox.read.messages")+' </a> </li> <li> <a class="inbox-handler clear-readed-handler"> <span class="icon icon-trash"></span>'+tb_i18n.get("inbox.clear.messages")+' </a> </li> <hr> <li> <a class="inbox-handler preference-handler"> <span class="icon icon-cog"></span>'+tb_i18n.get("inbox.preference")+' </a> </li> </ul> </div> </div> </div> <div class="message-detail-wrapper flex-fill"> <div class="detail-header"></div> </div> </div></header><div class="inbox-content inbox-wrap flex-horiz"> <div class="inbox-side message-list flex-static"> <div class="messages-scroll thin-scroll"> <div class="messages-wrapper"> <ul class="messages clearfix"></ul> <div class="empty-tip"> </div> ';return"normal"==t.type&&(e+=' <div class="only-mentions flex-horiz flex-vcenter" data-gta="{action: \'toggle only show mentions\', control: \'feed\', segment: \'message\'}"> <div class="check-box"> <span class="icon icon-tick"></span> </div> <span>'+tb_i18n.get("inbox.my.mention")+"</span> </div> "),e+=' </div> </div> </div> <div class="message-detail-wrapper flex-fill"> <div class="detail-panel hack-render-bug"></div> </div></div><footer class="inbox-footer" data-gta="event" data-label="close inbox"> <span class="icon icon-chevron-up"></span></footer>'}},function(t,e){t.exports=function(t){var e='<div class="dropdown ';return t.open&&(e+="open"),e+='"> <a class="inbox-type-display flex-horiz flex-vcenter" data-toggle="dropdown"> <span class="inbox-type"> ',"normal"==t.type?e+=' <span class="icon icon-inbox"></span> '+tb_i18n.get("inbox.all.message")+" ":"later"==t.type&&(e+=' <span class="icon icon-clock"></span> '+tb_i18n.get("inbox.later.message")+" "),e+=' </span> <span class="icon icon-chevron-down"></span> </a> <ul class="dropdown-menu" role="menu"> <li> <a class="messages-ordinary ',"normal"==t.type&&(e+="active"),e+=' flex-horiz flex-between" data-gta="{action: \'select messages segment\'}"> <div class="inbox-type"> <span class="icon-wrapper ',t.unread.normal&&(e+="unread"),e+='"> <span class="icon icon-inbox"></span> </span> '+tb_i18n.get("inbox")+' </div> <span class="icon icon-tick"> </a> </li> <li> <a class="messages-snoozed ',"later"==t.type&&(e+="active"),e+=' flex-horiz flex-between" data-gta="{action: \'select snooze segment\'}"> <div class="inbox-type"> <span class="icon-wrapper ',t.unread.later&&(e+="unread"),e+='"> <span class="icon icon-clock"></span> </span> '+tb_i18n.get("inbox.later.message")+' </div> <span class="icon icon-tick"> </a> </li> </ul></div>'}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<a class="btn url-handler" href="'+r.url+"\" data-gta=\"{action: 'open detail', type: '"+(0==o?"project":r.messageType)+"', control: 'original content', segment: '"+r.segmentType+"'}\"> "+e(r.title)+"</a>";return i}},function(t,e){t.exports=function(t){var e="";return"normal"==t.type?e+=' <span class="icon icon-inbox"></span> <p>'+tb_i18n.get("inbox.normal.empty.tip1")+'</p> <p class="tip-small">'+tb_i18n.get("inbox.normal.empty.tip2")+"</p>":"ated"==t.type?e+=' <span class="icon icon-at"></span> <p>'+tb_i18n.get("inbox.ated.empty.tip1")+'</p> <p class="tip-small">'+tb_i18n.get("inbox.ated.empty.tip2")+"</p>":"later"==t.type&&(e+=' <span class="icon icon-clock"></span> <p>'+tb_i18n.get("inbox.later.empty.tip1")+'</p> <p class="tip-small">'+tb_i18n.get("inbox.later.empty.tip2")+"</p>"),e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w=function(t,e){function i(){this.constructor=t}for(var n in e)_.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},_={}.hasOwnProperty;y=i(358),k=i(678),b=i(679),g=i(788),o=i(680),a=i(429),s=i(688),r=i(817),u=i(1392),c=i(1397),p=i(1401),h=i(1407),l=i(1417),v=i(786),f=i(1385),n=i(1423),d={recent:{name:"recent",view:u,lang:"my.recent"},tasks:{name:"tasks",view:h,lang:"my.tasks"},events:{name:"events",view:c,lang:"my.events"},favorites:{name:"favorites",view:l,lang:"my.favorites"},notes:{name:"notes",view:p,lang:"my.notes"}},t.exports=m=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.viewName="MyView",e.prototype.className="my-view",e.prototype.events={"click .my-footer":"clear","click .my-tab:not(.plugin-handler)":"enterSection","click a.settings-handler":"showUserSettings","setRecentCount .recent-count":"onSetRecentCount"},e.prototype.initialize=function(t){return this.options=t||{},this.renderBasic(),this.renderCount(),this.tabModel=new s({}),this.listenTo(this.tabModel,"change",function(){return this.renderSection()}),y.delay(function(t){return function(){return t.enterSection()}}(this)),$("#navigator .my-handler").addClass("active"),this},e.prototype.renderBasic=function(){var t,e;return e=k.user.toJSON(),t={name:e.name,avatarUrl:e.avatarUrl,accountHost:b.ACCOUNT_HOST,tabs:y.map(d,function(t){return t.count=e[t.name+"Count"],t})},this.$el.html(n(t)),this.triggerHook("render"),this.$content=this.$(".my-content"),this.$myTabs=this.$(".my-tab"),this},e.prototype.renderCount=function(){var t,e,i,n;return n=this.$(".tasks-count"),t=this.$(".events-count"),e=this.$(".favorites-count"),i=this.$(".notes-count"),o.ajax("users/me/count",{success:function(t){return function(r){var o;if(t.$el)return o=+n.text(),o>0||n.text(r.tasksCount+r.subtasksCount||0),e.text(r.favoritesCount||0),i.text(r.notesCount||0),t.isCountGot=!0,t.showCount()}}(this)}),o.ajax("events/me",{data:{endDate:a().startOf("day").toISOString()},expireCache:{namespace:"my_events",expire:10},success:function(e){return function(i){var n;if(e.$el)return n=i.filter(function(t){var e,i;return e=new r(t),i=e.getScope(),"future"===i||"today"===i}).length,t.text(n||0),e.isEventCountGot=!0,e.showCount()}}(this)})},e.prototype.renderSection=function(t,e){var i,n;return t&&(this.viewType="plugin"),t||(t=d[this.viewType].view),e=y.extend(e,{$scrollElement:this.$(".my-content-wrap")}),null!=(n=this.currentView)&&n.remove(),this.currentView=this.requestSubView(t,e),this.$content.html(this.currentView.$el),this.$myTabs.removeClass("active"),"plugin"===this.viewType?(i=e.pluginModel.get("_id"),this.$myTabs.filter("[data-plugin-id="+i+"]").addClass("active")):this.$myTabs.filter("[data-type="+d[this.viewType].name+"]").addClass("active"),$("body").scrollTop(0),this},e.prototype.onSetRecentCount=function(t,e){if(this.$el)return this.isRecentCountGot=!0,this.showCount()},e.prototype.showCount=function(){var t;if(this.isCountGot&&this.isRecentCountGot&&this.isEventCountGot&&!this.isShownCount)return this.isShownCount=!0,t=this.$el,y.delay(function(){return t.addClass("on-count-got")},500)},e.prototype.enterSection=function(t){var e;return t&&(e=$(t.target).closest(".my-tab").data("type")),e||(e="recent"),"plugin"===this.viewType&&e===this.tabModel.get("active")?(this.viewType=e,this.renderSection()):(this.viewType=e,this.tabModel.set("active",this.viewType))},e.prototype.showUserSettings=function(t){return this.requestSubView(v).open(f),this},e.prototype.clear=function(){return k.APP.Float.close(),this},e.prototype.remove=function(){return e.__super__.remove.apply(this,arguments),$("#navigator .my-handler").removeClass("active")},e}(g)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w=function(t,e){function i(){this.constructor=t}for(var n in e)_.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},_={}.hasOwnProperty;b=i(358),k=i(678),c=i(429),g=i(677),a=i(680),v=i(788),u=i(797),n=i(1393),p=i(697),m=i(803),d=i(1205),o=i(817),f=i(1207),h=i(1213),y=i(786),r=i(1395),s=i(1396),l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.viewName="MyRecentView",e.prototype.tagName="section",e.prototype.className="my-recent-view fade",e.prototype.events={"click .task-content-set":"gtaShowTaskDetail","click .event":"showEventDetail","click .event-tag":"onClickEventTag"},e.prototype.initialize=function(t){return this.options=b.extend({},t),this.setupScroll(this.options.$scrollElement||this.$el),this.api=n.create(),this.api.load(),this.render(),this.listen(),b.delay(function(t){return function(){return t.$el.addClass("in")}}(this)),this},e.prototype.listen=function(){return this.listenTo(this.api,"merge remove",b.debounce(function(t){return function(){return t.render()}}(this),100))},e.prototype.render=function(){if(this.$el)return"loaded"===this.api.state?(this.renderBasic(),this.renderTodayWorks(),this.renderTomorrowWorks(),this.renderNextDaysWorks()):(this.$el.empty(),this.showLoadingIndicator())},e.prototype.renderBasic=function(){return this.$el.html(r()),this.$todayTasks=this.$(".today-tasks"),this.$tomorrowTasks=this.$(".tomorrow-tasks"),this.$futureTasks=this.$(".week-tasks"),this.$placeholder=this.$(".placeholder")},e.prototype.renderTodayWorks=function(){var t,e;return t=this.$todayTasks,e=this.api.getTodayWorks(),this.renderWorks(t,e)},e.prototype.renderTomorrowWorks=function(){var t,e;return t=this.$tomorrowTasks,e=this.api.getTomorrowWorks(),this.renderWorks(t,e)},e.prototype.renderNextDaysWorks=function(){var t,e;return t=this.$futureTasks,e=this.api.getNextDaysWorks(),this.renderWorks(t,e)},e.prototype.renderWorks=function(t,e){var i,n,r,o,s;for(t.show(),i=t.find(".task-list").empty(),n=0,r=e.length;n<r;n++)switch(s=e[n],o=s.type||s.objectType){case"task":this.renderTask(i,s);break;case"subtask":this.renderSubtask(i,s);break;case"event":this.renderEvent(i,s)}return this.refreshCount()},e.prototype.renderTask=function(t,e){return this.requestSubView(f,{model:new m(e,{bindByMatrix:!0}),isUseProjectName:!0,noExecutor:!0}).$el.appendTo(t)},e.prototype.renderSubtask=function(t,e){return this.requestSubView(h,{model:new d(e,{bindByMatrix:!0}),noExecutor:!0}).$el.appendTo(t)},e.prototype.renderEvent=function(t,e){var i,n;return e.project||(e.project=null!=(n=p.find(e._projectId))?n.toJSON():void 0),t.find("[data-id="+e._id+"]").remove(),i=g.parseEventDateString(e),t.append(s(i))},e.prototype.removeWork=function(t){if(this.$el)return this.$("[data-id="+t+"]").remove(),this.$("[data-subtask="+t+"]").remove(),this.refreshCount()},e.prototype.refreshCount=function(){var t,e,i,n,r;for(r=[this.$(".today-tasks"),this.$(".tomorrow-tasks"),this.$(".week-tasks")],i=0,n=r.length;i<n;i++)t=r[i],e=t.find(".task").length+t.find(".event").length,t.find(".count").text(e),t[e?"show":"hide"]();return e=this.$(".task").length+this.$(".event").length,$(".my-view .recent-count").text(e),$(".my-view .recent-count").trigger("setRecentCount",e),this.$placeholder[e?"hide":"show"]()},e.prototype.gtaShowTaskDetail=function(t){return k.gta.event({action:"open detail",type:"task",control:"Me Recent"})},e.prototype.showEventDetail=function(t){var e,i,n,r;return k.gta.event({action:"open detail",type:"event",control:"Me Recent"}),e=$(t.currentTarget).data("id"),i=this.api.getById(e),i._originEventId&&(r=b.extend({},i,{_id:i._originEventId}),n=new o(r,{bindByMatrix:!1}),n.set("startDate",i.startDate),n.set("endDate",i.endDate)),k.APP.openEventPreviewer(n||e),this},e.prototype.onClickEventTag=function(t){var e;return t.stopPropagation(),e=$(t.currentTarget).data("id"),e&&k.router.navigate("project/"+e+"/events",{trigger:!0}),this},e.prototype.remove=function(){return this.api.remove(),e.__super__.remove.apply(this,arguments)},e}(v),b.extend(l.prototype,u),t.exports=l},function(t,e,i){var n,r;n=i(1394),r=function(){function t(){}return t.prototype.api=null,t.prototype.cache=(new Date).valueOf(),t.prototype.create=function(){var t,e;return e=(new Date).valueOf(),t=e-this.cache>0,this.api&&!t||(this.cache=e,this.api=new n),this.api},t}(),t.exports=new r},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};p=i(358),m=i(678),v=i(530),n=i(357),o=i(429),r=i(680),c=i(686),l=i(677),s=i(447),d=function(t,e){return new Date(t.startDate)-new Date(e.startDate)},u=function(t,e,i,n){var r,s,a,c,l,p,u,d;return l=m.user.id,d=t.type||t.objectType,"task"===d||"subtask"===d?!t.isDone&&(t._executorId===l&&(t.startDate?(u=o(t.startDate).valueOf(),n?u<=i:e<=u&&u<=i):!!t.dueDate&&(r=o(t.dueDate).valueOf(),n?r<=i:e<=r&&r<=i))):(c=t.involveMembers||[],!(y.call(c,l)<0)&&(a=o(t.startDate).valueOf(),s=o(t.endDate).valueOf(),p=o().valueOf(),e<s&&a<i))},f=function(t){var e,i;return i=o().startOf("day").valueOf(),e=o().endOf("day").valueOf(),u(t,i,e,!0)},g=function(t){var e,i;return i=o().add(1,"day").startOf("day").valueOf(),e=o().add(1,"day").endOf("day").valueOf(),u(t,i,e)},h=function(t){var e,i;return i=o().add(2,"day").startOf("day"),e=o().add(6,"day").endOf("day"),u(t,i,e)},t.exports=a=function(){function t(){var t,e,i,r;for(p.extend(this,n.Events),this.state=null,this.datas={},r=["task","subtask","event"],t=0,e=r.length;t<e;t++)i=r[t],this.listenTo(v,":change:"+i,function(t){return this.mergeData(t.toJSON())}),this.listenTo(v,":destroy:"+i,function(t){var e;return e=t.get("type")||t.get("objectType"),this.removeData(t.id,"event"===e)}),this.listenTo(v,":new:"+i,function(t){return this.mergeData(t.toJSON())})}return t.prototype.load=function(t){var e;return this.state?"function"==typeof t?t():void 0:(e=o().add(7,"day").endOf("day").toISOString(),this.setState("loading"),r.ajax("users/recent",{data:{dueDate:e},success:function(t){return function(e){return t.setState("loaded"),t.mergeDatas(e)}}(this),error:function(t){return function(){return t.setState("error")}}(this)}))},t.prototype.chargeIsRepeatEvent=function(t){var e;return e=t.recurrence||[],e.length},t.prototype.fakeRecurrenceEvents=function(t){var e,i,n,r,s,a,c,l,u,d,h,m;if(l=[],a=t.recurrence||[],!a.length)return l;for(s=new Date(t.endDate).valueOf()-new Date(t.startDate).valueOf(),u=this.getRRuleSet(a,t.startDate),i=o().startOf("day"),m=o().add(6,"day").endOf("day"),c=u.between(i,m,!0),n=0,r=c.length;n<r;n++)d=c[n],h=new Date(d).valueOf(),e=p.clone(t),e._id=t._id+"_"+h,e._originEventId=t._id,e.startDate=o(d).toISOString(),e.endDate=o(d).add(s).toISOString(),l.push(e);return l},t.prototype.getRRuleSet=function(t,e){var i;return i=t.join("\n"),i=s.rrulestr(i,{forceset:!0})},t.prototype.removeFakeEvents=function(t){var e,i,n,r;n=this.datas,r=[];for(i in n)e=n[i],(null!=e?e._originEventId:void 0)===t?r.push(this.datas[i]=null):r.push(void 0);return r},t.prototype.mergeDatas=function(t){var e,i,n;for(i=0,n=t.length;i<n;i++)e=t[i],this.doMerge(e);return this.trigger("merge",t)},t.prototype.mergeData=function(t){return this.doMerge(t),this.trigger("merge",t)},t.prototype.doMerge=function(t){var e,i,n,r,o,s;if(null!=t?t._id:void 0){if(s=t.type||t.objectType,"event"===s&&this.chargeIsRepeatEvent(t)){for(this.datas[t._id]=null,this.removeFakeEvents(t._id),i=this.fakeRecurrenceEvents(t),o=[],n=0,r=i.length;n<r;n++)e=i[n],o.push(this.doMergeOne(e));return o}return this.doMergeOne(t)}},t.prototype.doMergeOne=function(t){var e,i,n;return e=this.datas[t._id]||{},n=p.extend({},e,t),!(null!=(i=n.task)?i._id:void 0)&&e.task&&(n.task=e.task),this.datas[t._id]=n},t.prototype.removeData=function(t,e){return this.datas[t]=null,e&&this.removeFakeEvents(t),p.values(this.datas).forEach(function(e){return function(i){var n;if((null!=i&&null!=(n=i.task)?n._id:void 0)===t)return e.datas[i._id]=null}}(this)),this.trigger("remove",t)},t.prototype.setState=function(t){return this.state=t},t.prototype.getTaskFromList=function(t,e){var i,n,r;for(i=0,n=t.length;i<n;i++)if(r=t[i],r._id===e&&r._executorId===m.user.id)return r;return null},t.prototype.removeSubtaskIncludedByTask=function(t){var e,i,n,r,o,s;for(o=[],e=0,i=t.length;e<i;e++)s=t[e],(null!=(r=s.task)?r._id:void 0)&&(n=this.getTaskFromList(t,s.task._id))||o.push(s);return o},t.prototype.getTodayWorks=function(){return this.getWorksByFilter(f)},t.prototype.getTomorrowWorks=function(){return this.getWorksByFilter(g)},t.prototype.getNextDaysWorks=function(){return this.getWorksByFilter(h)},t.prototype.getWorksByFilter=function(t){var e,i,n,r,o,s,a;o=[],s=[],i=[],r=this.datas;for(n in r)e=r[n],e&&!e.isArchived&&t(e)&&(a=e.type||e.objectType,"event"===a?i.push(p.clone(e)):s.push(p.clone(e)));return s=this.removeSubtaskIncludedByTask(s),s.sort(l.compareTask).map(function(t){return o.push(t)}),i.sort(d).map(function(t){return o.push(t)}),o},t.prototype.getById=function(t){return this.datas[t]},t.prototype.remove=function(){return this.stopListening()},t}()},function(t,e){t.exports=function(t){var e='<div class="today-tasks" data-gta="event" data-label="my today tasks" data-value="my today tasks"> <h3> '+tb_i18n.get("my.recent.today")+' · <span class="count"></span> </h3> <ul class="task-list my-list"></ul></div><div class="tomorrow-tasks" data-gta="event" data-label="my tomorrow tasks" data-value="my tomorrow tasks"> <h3> '+tb_i18n.get("my.recent.tomorrow")+' · <span class="count"></span> </h3> <ul class="task-list my-list"></ul></div><div class="week-tasks" data-gta="event" data-label="my week tasks" data-value="my week tasks"> <h3> '+tb_i18n.get("my.recent.week")+' · <span class="count"></span> </h3> <ul class="task-list my-list"></ul></div><div class="task-placeholder placeholder muted"> <span class="icon icon-board"></span> <br /> '+tb_i18n.get("task.recent.placeholder")+"</div>";return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li class="event" data-id="'+t._id+'" data-type="event"  data-gta=\'event\' data-label=\'open event detail\'> <i class="icon icon-calendar"></i> <div class="event-content"> <span class="event-title">'+e(t.title)+"</span> ";return t.project&&t.project.name&&t.project._id&&(i+=' <a class="event-tag" data-tag="project" data-id="'+t.project._id+'" data-gta="event" data-label="event|go to project"> '+e(t.project.name)+" </a> "),i+=' </div> <div class="event-time"> <time>'+t.startDateString+"</time> - <time>"+t.endDateString+"</time> </div></li>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f=function(t,e){function i(){this.constructor=t}for(var n in e)g.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},g={}.hasOwnProperty,v=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};h=i(358),m=i(678),a=i(680),l=i(429),u=i(788),r=i(817),o=i(1079),s=i(1226),c=i(1398),d=i(786),n=i(1400),t.exports=p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.viewName="MyEventsView",e.prototype.tagName="section",e.prototype.className="my-events-view fade",e.prototype.events={"click .event-tag":"onClickEventTag","click .icalendar":"showICalendar","click .event":"gtaOpenEvent"},e.prototype.initialize=function(t){return this.options=h.extend({},t),this.options.title=tb_i18n.get("my.events"),this.options.webcal=m.user.get("calLink"),this.todayEventsCollection=o.get(m.user.id+"_today_events"),this.futureEventsCollection=o.get(m.user.id+"_future_events"),this.loadEvents(),h.delay(function(t){return function(){return t.$el.addClass("in")}}(this)),this},e.prototype.renderBasic=function(){return this.$el.html(n(this.options)),this},e.prototype.listen=function(){return this.listenTo(this.todayEventsCollection,"add remove",this.refreshTodayEventsCount),this.listenTo(this.futureEventsCollection,"add remove",this.refreshFutureEventsCount),this.listenTo(this.todayEventsCollection,"add change",function(t){return function(e){var i;return e.get("recurrence")&&e.refreshDate(),i=!m.user.id,v.call(e.get("involveMembers"),i)>=0?t.todayEventsCollection.remove(e):"future"===e.getScope()?(t.todayEventsCollection.remove(e),t.futureEventsCollection.add(e)):void 0}}(this)),this.listenTo(this.futureEventsCollection,"add change",function(t){return function(e){var i;return e.get("recurrence")&&e.refreshDate(),i=!m.user.id,v.call(e.get("involveMembers"),i)>=0?t.futureEventsCollection.remove(e):"today"===e.getScope()?(t.futureEventsCollection.remove(e),t.todayEventsCollection.add(e)):void 0}}(this)),this},e.prototype.loadEvents=function(){return this.todayEventsCollection.reset(),this.futureEventsCollection.reset(),this.showLoadingIndicator(this.$el),a.ajax("events/me",{data:{endDate:l().startOf("day").toISOString()},expireCache:{namespace:"my_events",expire:10},success:function(t){return function(e){if(t.$el)return h.each(e,function(i,n){var o;return i=new r(i),e[n]=i.attributes,o=i.getScope(),"today"===o?t.todayEventsCollection.add(i):"future"===o?t.futureEventsCollection.add(i):void 0}),t.hideLoadingIndicator(),t.renderBasic().listen(),t.todayEventsCollection.checkScope("today"),t.requestSubView(s,{groupBy:!0,rightOffset:0,eventsCollection:t.todayEventsCollection}).$el.appendTo(t.$(".today-events")),t.futureEventsCollection.checkScope("future"),t.requestSubView(s,{groupBy:!0,rightOffset:0,eventsCollection:t.futureEventsCollection}).$el.appendTo(t.$(".future-events")),t.refreshTodayEventsCount().refreshFutureEvenCount()}}(this)}),this},e.prototype.onClickEventTag=function(t){var e;return t.stopPropagation(),e=$(t.currentTarget).data("id"),m.router.navigate("project/"+e+"/events",{trigger:!0}),this},e.prototype.refreshTodayEventsCount=function(){return this.$(".today-events-count").text(this.todayEventsCollection.length),this.refreshMyEventsCount(),this},e.prototype.refreshFutureEvenCount=function(){return this.$(".future-events-count").text(this.futureEventsCollection.length),this.refreshMyEventsCount(),this},e.prototype.refreshMyEventsCount=function(){var t;return t=this.todayEventsCollection.length+this.futureEventsCollection.length,$(".my-view .events-count").text(t),this},e.prototype.showICalendar=function(){return this.requestSubView(d).open(c,this.options),this},e.prototype.gtaOpenEvent=function(){return m.gta.event({action:"open detail",type:"event",control:"Me Events"})},e}(u)},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=i(678),n=i(1399),r=i(680),s=i(788),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.viewName="ICalendarView",e.prototype.className="icalendar-view modal-dialog modal-padding",e.prototype.initialize=function(t){return!!t&&(this.options=t,this.renderBasic(),this)},e.prototype.renderBasic=function(){return this.$el.html(n(this.options)),this.$qr=this.$(".icalendar-qrcode"),this.renderQr(),this},e.prototype.renderQr=function(){return this.$qr.qrcode({
size:170,text:this.options.webcal,background:"white"})},e}(s)},function(t,e){t.exports=function(t){var e='<div class="modal-content"> <header class="modal-header"> <h4 class="modal-title">'+tb_i18n.get("iCalendar.title",t.title)+'</h4> <a class="modal-close icon icon-remove" data-dismiss="modal"></a> </header> <div class="modal-body"> <div> <div class="icalendar-qrcode pull-left"></div> <div class="icalendar-msg"> <p class="msg1">'+tb_i18n.get("iCalendar.msg1",t.title)+'</p> <p class="msg2">'+tb_i18n.get("iCalendar.msg2",t.title)+' <a class="icalendar-url link-add-handler" href="'+t.webcal+'" target="_blank">'+t.webcal+'</a> </p> </div> </div> <div class="icalendar-footer"> <!-- <a class="icalendar-reset"><i class="icon icon-refresh"></i> '+tb_i18n.get("iCalendar.reset")+'</a> --> <a class="icalendar-howto" href="https://bbs.teambition.com/issues/54deced8f12cd5890bd1070b" target="_blank"><i class="icon icon-question"></i> '+tb_i18n.get("iCalendar.howto")+"</a> </div> </div></div>";return e}},function(t,e){t.exports=function(t){var e='<div class="today-events" data-gta="event" data-label="my today events" data-value="my today events"> <h3>'+tb_i18n.get("today.events")+' ・ <span class="today-events-count">0</span> <a class="icalendar pull-right" data-gta="{action: \'subscribe to calendar\', type: \'event\', control: \'Subscribe My Events\'}"> <i class="icon icon-calendar"></i> '+tb_i18n.get("iCalendar.title",t.title)+' </a> </h3></div><div class="future-events" data-gta="event" data-label="my future events" data-value="my future events"> <h3>'+tb_i18n.get("future.events")+' ・ <span class="future-events-count">0</span></h3></div>';return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f=function(t,e){function i(){this.constructor=t}for(var n in e)g.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},g={}.hasOwnProperty;h=i(358),m=i(678),p=i(681),u=i(677),d=i(788),l=i(797),s=i(1402),r=i(976),n=i(1404),o=i(1405),c=i(1406),a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.viewName="NotesView",e.prototype.tagName="div",e.prototype.className="notes-view clearfix fade",e.prototype.events={"click .create-note-handler":"createNote","click .delete-note-handler":"deleteNote","mousedown .save-note-handler":"saveNote","mousedown .cancel-note-handler":"cancelNote","focusin .note":"editNote","blur .note":"memCacheNote","keydown .note-content, .note-title":"quickSaveNote","mousedown .restore-draft":"restoreDraft","mousedown .discard-draft":"discardDraft"},e.prototype.initialize=function(t){return null==t&&(t={}),this.localCache=p.namespace("temp").namespace("my-note-"+m.user.id),this.$placeholder=$(c()),this.renderBasic(),this.setupScroll(t.$scrollElement),this.load({beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$el)}}(this),success:function(t){return function(){if(t.$el)return t.hideLoadingIndicator(),t.notesCollection.each(function(e){return t.renderNote(e)}),t.listen(),t.checkPlaceholder()}}(this)}),h.delay(function(t){return function(){return t.$el.addClass("in")}}(this)),this},e.prototype.listen=function(){return this.listenTo(this.notesCollection,"add",function(t,e,i){return this.renderNote(t,!i.isLoadMore),this.cancelCreate(),this.checkPlaceholder()}),this.listenTo(this.notesCollection,"change",this.renderNote),this.listenTo(this.notesCollection,"remove",this.removeNote),this.listenTo(this.notesCollection,"change destroy remove",this.checkPlaceholder),this},e.prototype.load=function(t){return t||(t={}),"function"==typeof t.beforeSend&&t.beforeSend(),s.fetch(m.user.id,{success:function(e){return function(i){return e.notesCollection=i,"function"==typeof t.success?t.success():void 0}}(this)}),this},e.prototype.loadMore=function(t){return this.notesCollection.loadMore({isLoadMore:!0,beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$list)}}(this),success:function(e){return function(){if(e.notesCollection.hasMore)return"function"==typeof t?t():void 0}}(this),complete:function(t){return function(){return t.hideLoadingIndicator({animated:!0})}}(this)})},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$list=this.$(".notes-list"),this},e.prototype.renderNote=function(t,e){var i,n,r;return r=t.toJSON(),r.dateString=u.formatDate(r.updated).dateString,i=$(o(r)),n=this.$(".note[data-id="+r._id+"]"),n.length?n.replaceWith(i):i[e===!0?"prependTo":"appendTo"](this.$list),i.find(".note-content").flexText(),this.refreshNotesCount(),this},e.prototype.removeNote=function(t){var e,i;return i=t.toJSON(),e=this.$(".note[data-id="+i._id+"]"),e.remove(),this},e.prototype.createNote=function(){var t,e,i;if(!this.$(".note[data-id=new_note]").length)return this.$createNote=$(o({_id:"new_note",isCreate:!0})),i=this.getMemCache("new_note")||{},e=this.$createNote.find(".note-title"),t=this.$createNote.find(".note-content"),e.val(i.title),t.val(i.content).flexText(),this.$createNote.prependTo(this.$list),this.checkPlaceholder(),e.focusAtEnd(),this},e.prototype.deleteNote=function(t){var e;return e=$(t.currentTarget).closest(".note"),this.requestSubView(r,{title:tb_i18n.get("note.delete.confirm.title"),description:tb_i18n.get("note.delete.confirm"),confirm:tb_i18n.get("confirm.delete"),onConfirm:function(t){return function(){var i;return null!=(i=t.notesCollection.get(e.data("id")))?i.destroy():void 0}}(this)}),this},e.prototype.saveNote=function(t){var e,i,n,r,o;return e=$(t.currentTarget).closest(".note"),n=e.data("id"),o={title:e.find(".note-title").val().trim(),content:e.find(".note-content").val().trim()},e.find(".flex-text-wrap").removeClass("validate-error"),e.find(".note-title").removeClass("validate-error"),o.title?o.content?(r=this.notesCollection.get(n),i=function(t){return function(){return t.clearMemCache(n)}}(this),r?(this.cancelEdit(),r.save(null,{attrs:o,wait:!0,success:i})):this.notesCollection.create(o,{wait:!0,success:i}),!1):e.find(".flex-text-wrap").addClass("validate-error"):e.find(".note-title").addClass("validate-error")},e.prototype.editNote=function(t){var e,i;if(e=$(t.currentTarget),i=e.data("id"),!e.hasClass("active"))return this.cancelEdit(),e.addClass("active"),this.getMemCache(i)&&e.addClass("has-draft"),this},e.prototype.memCacheNote=function(t){var e,i,n,r,o;if(e=$(t.currentTarget),n=e.data("id"))return r=this.notesCollection.get(n),o=e.find(".note-title").val().trim(),i=e.find(".note-content").val().trim(),r&&o===r.get("title")&&i===r.get("content")||this.localCache.set(n,{title:o,content:i}),this},e.prototype.getMemCache=function(t){return this.localCache.get(t)},e.prototype.clearMemCache=function(t){return this.localCache.remove(t),this},e.prototype.restoreDraft=function(t){var e,i,n,r;return i=$(t.currentTarget),e=i.closest(".note"),!!(n=e.data("id"))&&(r=this.getMemCache(n)||{},r.title&&e.find(".note-title").val(r.title).focus(),r.content&&e.find(".note-content").val(r.content).focus(),e.removeClass("has-draft"),this.clearMemCache(n),!1)},e.prototype.discardDraft=function(t){var e,i,n;return i=$(t.currentTarget),e=i.closest(".note"),!!(n=e.data("id"))&&(e.removeClass("has-draft"),this.clearMemCache(n),!1)},e.prototype.cancelCreate=function(t){var e;return e=this.$createNote,e&&(this.$createNote=null,e.remove()),this.checkPlaceholder(),this},e.prototype.cancelEdit=function(){var t,e,i;return t=this.$(".note.active[data-id!=new_note]"),e=t.data("id"),i=this.notesCollection.get(e),i?(t.removeClass("active"),t.find(".note-title").val(i.get("title")).blur(),t.find(".note-content").val(i.get("content")).blur(),this.clearMemCache(e)):t.remove(),this},e.prototype.cancelNote=function(t){var e,i;return e=$(t.currentTarget).closest(".note"),i=e.data("id"),"new_note"===i?this.cancelCreate():this.cancelEdit(),this},e.prototype.quickSaveNote=function(t){return 13===t.keyCode&&(t.ctrlKey||t.shiftKey||t.metaKey)&&(t.preventDefault(),this.saveNote(t)),this},e.prototype.refreshNotesCount=function(){return this.$(".notes-count").text(this.notesCollection.length),this},e.prototype.checkPlaceholder=function(){return this.$placeholder.remove(),this.notesCollection.length||this.$createNote||this.$list.html(this.$placeholder),this},e}(d),h.extend(a.prototype,l),t.exports=a},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;n=i(685),o=i(1403),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.model=o,e.prototype.name="notes",e.prototype.pageNum=20,e.prototype.orderBy="latest-updated",e}(n)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(688),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.name="note",e.prototype.urlRoot="notes",e.prototype.defaults={objectType:"note",_teamId:"",_userId:"",created:"",updated:"",title:"",content:""},e}(n)},function(t,e){t.exports=function(t){var e='<h3 class="note-header">'+tb_i18n.get("my.notes")+' ・ <span class="notes-count">0</span></h3><a class="create-note-handler btn btn-primary" data-gta="event" data-label="create note"> <span class="icon icon-plus"></span> '+tb_i18n.get("create")+'</a><ul class="notes-list"></ul>';return e}},function(t,e){t.exports=function(t){var e='<li class="note card ';return t.isCreate&&(e+="active"),e+='" data-id="'+t._id+'" data-gta="event" data-label="show note detail"> <input class="note-title" placeholder="'+tb_i18n.get("notes.input.title")+'" value="'+(t.title||"")+'"/> <textarea class="note-content" placeholder="'+tb_i18n.get("notes.input.note")+'">'+(t.content||"")+'</textarea> <time class="time-stamp">'+(t.dateString||"")+'</time> <div class="draft">'+tb_i18n.get("draft")+' <a class="restore-draft">'+tb_i18n.get("draft.restore")+'</a> <a class="discard-draft">'+tb_i18n.get("draft.discard")+'</a> </div> <div class="note-handler-set clearfix"> ',t.isCreate||(e+=' <a class="delete-note-handler pull-left" data-gta="event" data-label="delete note"> <span class="icon icon-trash"></span> '+tb_i18n.get("delete")+" </a> "),e+=' <a class="save-note-handler btn btn-primary pull-right" data-gta="event" data-label="save note"> ',e+=t.isCreate?""+tb_i18n.get("create"):""+tb_i18n.get("save"),e+=' </a> <a class="cancel-note-handler pull-right"> '+tb_i18n.get("cancel")+" </a> </div></li>"}},function(t,e){t.exports=function(t){var e='<div class="note-placeholder placeholder muted"> <span class="icon icon-book"></span> <br> '+tb_i18n.get("note.placeholder")+"</div>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f=function(t,e){function i(){this.constructor=t}for(var n in e)g.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},g={}.hasOwnProperty;d=i(358),m=i(678),p=i(788),c=i(797),l=i(1205),o=i(1398),u=i(786),a=i(1021),n=i(1408),h=i(1217),r={todo:i(1409),joined:i(1414),created:i(1415),done:i(1416)},s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.viewName="MyTasksView",e.prototype.tagName="section",e.prototype.className="my-tasks-view fade",e.prototype.events={"click .icalendar":"showICalendar","click .task-content-set":"gtaShowTaskDetail","click .type-filter":"toggleFilterSelector","click .tasks-board-sort-menu":"toggleSortSelector","click .tasks-board-date-menu":"toggleDateSelector"},e.prototype.initialize=function(t){return this.options=d.extend({},t),this.setupScroll(this.options.$scrollElement||this.$el),this.renderBasic(),this.renderCurrent(),d.delay(function(t){return function(){return t.$el.addClass("in")}}(this)),this},e.prototype.renderBasic=function(){var t;return t={filterTitle:h.getFilterTitle(),sortTitle:h.getSortTitle(),dateTitle:h.getDateTitle()},this.$el.html(n(t)).attr("data-filter",h.getFilterType()),this.$content=this.$(".tasks-board .task-list"),this.$filterMenuTitle=this.$(".type-filter .filter-name"),this.$sortMenuTitle=this.$(".sort-menu-title"),this.$dateMenuTitle=this.$(".date-menu-title"),this.$dropdownMenu=this.$(".dropdown-menu"),this},e.prototype.renderCurrent=function(){var t,e;return null!=(e=this.currentView)&&e.remove(),t=r[h.getFilterType()],this.currentView=this.requestSubView(t),this.$el.append(this.currentView.$el),this.refreshHeader()},e.prototype.refreshHeader=function(){return this.$filterMenuTitle.text(h.getFilterTitle()),this.$sortMenuTitle.text(h.getSortTitle()),this.$dateMenuTitle.text(h.getDateTitle()),this.$dropdownMenu.find(".selected").removeClass("selected"),this.$dropdownMenu.find("[data-type="+h.getFilterType()+"]").parent().addClass("selected"),this.$el.attr("data-filter",h.getFilterType())},e.prototype.showICalendar=function(){var t;return t=d.extend({},this.options,{title:tb_i18n.get("my.tasks"),webcal:m.user.get("taskCalLink")}),this.requestSubView(u).open(o,t),this},e.prototype.gtaShowTaskDetail=function(){return m.gta.event({action:"open detail",type:"task",control:"Me Tasks"})},e.prototype.loadMore=function(t){var e;return t(),"function"==typeof(e=this.currentView).loadMore?e.loadMore():void 0},e.prototype.toggleFilterSelector=function(t){var e,i,n;return e=$(t.currentTarget),i="toggleFilterSelector",e.data(i)?this:(e.data(i,!0),null!=(n=this.toggleFilterSelectorView)&&n.remove(),this.toggleFilterSelectorView=this.requestSubView(a,{$toggler:e,width:170,dataList:h.getFilterList(),selected:h.getFilterType(),select:function(t){return function(e){var i;if(i=h.getFilterType(),e!==i)return h.setFilterType(e),t.renderCurrent()}}(this)}).show(),this)},e.prototype.toggleSortSelector=function(t){var e,i,n;return e=$(t.currentTarget),i="toggleSortSelector",e.data(i)?this:(e.data(i,!0),null!=(n=this.toggleSortSelectorrView)&&n.remove(),this.toggleSortSelectorrView=this.requestSubView(a,{$toggler:e,width:170,dataList:h.getSortList(),selected:h.getSortType(),select:function(t){return function(e){var i;if(i=h.getSortType(),e!==i)return h.setSortType(e),t.currentView.render(),t.refreshHeader()}}(this)}).show(),this)},e.prototype.toggleDateSelector=function(t){var e,i,n;return e=$(t.currentTarget),i="toggleDateSelector",e.data(i)?this:(e.data(i,!0),null!=(n=this.toggleDateSelectorrView)&&n.remove(),this.toggleDateSelectorrView=this.requestSubView(a,{$toggler:e,width:170,dataList:h.getDateList(),selected:h.getDateType(),select:function(t){return function(e){var i;if(i=h.getDateType(),e!==i)return h.setDateType(e),t.refreshHeader(),t.currentView.setDueDate()}}(this)}).show(),this)},e}(p),d.extend(s.prototype,c),t.exports=s},function(t,e){t.exports=function(t){var e='<h3 class="clearfix"> <div class="type-filter pull-left"> <span class="filter-name">'+t.filterTitle+'</span> <i class="icon icon-chevron-down"></i> </div> <div class="pull-right"> <a class="tasks-board-sort-menu"> <span class="sort-menu-title">'+t.sortTitle+'</span> <i class="icon icon-chevron-down"></i> </a> <a class="icalendar" data-gta="{action: \'subscribe to calendar\', type: \'task\', control: \'Subscribe My Tasks\'}"> <i class="icon icon-calendar2"></i> '+tb_i18n.get("iCalendar.title",tb_i18n.get("my.tasks"))+' </a> <a class="tasks-board-date-menu"> <span class="date-menu-title">'+t.dateTitle+'</span> <i class="icon icon-chevron-down"></i> </a> </div></h3>';return e}},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;c=i(678),a=i(1217),l=i(677),o=i(429),n=i(1410),r=i(1413),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="MyTasksCreatedTasks",e.prototype.createAPI=function(t){var e;return e={page:1,count:500,isDone:!1},this.api=new t(e,(!0))},e.prototype.renderList=function(t){var e,i,n,r;if(t=a.sortTask(t),"project"===a.getSortType())n=a.getProjects(t),this.renderGroup(n,t);else for(e=0,i=t.length;e<i;e++)r=t[e],this.renderTask(r);return this.refreshCount()},e.prototype.renderGroup=function(t,e){var i,n,o,s,a;for(this.$el.html(r(t)),s=[],n=0,o=e.length;n<o;n++)a=e[n],i=this.$("[data-id="+a._projectId+"] .group-list"),s.push(this.renderTask(a,i));return s},e.prototype.getTaskFilter=function(){var t;return t=c.user.id,function(e){return!e.isDone&&e._executorId===t}},e.prototype.loadMore=function(){},e.prototype.refreshCount=function(){return $(".my-view .tasks-count").text(this.$(".task").length)},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f=function(t,e){function i(){this.constructor=t}for(var n in e)g.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},g={}.hasOwnProperty;d=i(358),m=i(678),h=i(1217),p=i(677),u=i(788),s=i(1205),c=i(803),l=i(1207),a=i(1213),o=i(1411),n=i(1412),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.viewName="MyTasksBasicTasks",e.prototype.className="task-list my-list",e.prototype.tagName="ul",e.prototype.dueDate=null,e.prototype.events={"click .icalendar":"showICalendar","click .subtask .task-content-set":"gtaShowTaskDetail","click .subtask .check-box":"gtaToggleCompleteTask","click .tasks-board-date-menu":"toggleDateSelector"},e.prototype.initialize=function(){return this.dueDate=h.getDateString(),this.createAPI(n),this.api.load(),this.render(),this.listen()},e.prototype.createAPI=function(t){return this.api=new t},e.prototype.listen=function(){return this.listenTo(this.api,"changeState remove",this.render),this.listenTo(this.api,"merge",d.debounce(function(t){return function(){return t.render()}}(this),100))},e.prototype.render=function(){var t,e;if(this.$el)return"loading"!==(t=this.api.state)&&"loadingMore"!==t?(this.hideLoadingIndicator(),e=this.api.getWorksByFilter(this.getTaskFilter()),e.length?(this.$el.empty(),this.renderList(e)):this.$el.html(o())):this.$(".loading-indicator").length?void 0:this.showLoadingIndicator()},e.prototype.renderList=function(t,e){var i,n,r,o;for(t.sort(this.getTaskSorter()),r=[],i=0,n=t.length;i<n;i++)o=t[i],r.push(this.renderTask(o,e));return r},e.prototype.renderTask=function(t,e){return"subtask"===t.type||"subtask"===t.objectType||t.task?this.renderSubViewSubtask(t,e):this.renderSubViewTask(t,e)},e.prototype.renderSubViewTask=function(t,e){return e||(e=this.$el),this.requestSubView(l,{model:new c(t,{bindByMatrix:!0}),isUseProjectName:!0,noExecutor:!0}).$el.appendTo(e)},e.prototype.renderSubViewSubtask=function(t,e){return e||(e=this.$el),this.requestSubView(a,{model:new s(t,{bindByMatrix:!0}),noExecutor:!0}).$el.appendTo(e)},e.prototype.gtaShowTaskDetail=function(){return m.gta.event({action:"check done",type:"subtask"})},e.prototype.gtaToggleCompleteTask=function(){return m.gta.event({action:"open task detail",type:"subtask"})},e.prototype.setDueDate=function(){return this.dueDate=h.getDateString(),this.stopListening(),this.createAPI(n),this.api.load(),this.listen(),this.render()},e.prototype.loadMore=function(){if(this.api.hasMore())return this.api.loadMore()},e.prototype.getTaskFilter=function(){return function(){return!0}},e.prototype.getTaskSorter=function(){return function(){return-1}},e.prototype.refreshCount=function(){},e.prototype.remove=function(){return this.api.remove(),e.__super__.remove.apply(this,arguments)},e}(u)},function(t,e){t.exports=function(t){var e='<div class="task-placeholder placeholder muted"> <span class="icon icon-board"></span> <br /> '+tb_i18n.get("task.placeholder")+"</div>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u;l=i(358),p=i(678),u=i(530),n=i(357),o=i(429),r=i(680),a=i(686),c=i(677),t.exports=s=function(){function t(t,e,i){this.hasMoreSubtask=null==e||e,this.hasDueDate=null==i||i,this.datas={},l.extend(this,n.Events),this.setLoadData(t),this.listen()}return t.prototype.state=null,t.prototype.hasMoreTask=!0,t.prototype.hasMoreSubtask=!0,t.prototype.listen=function(){var t,e,i,n,r;for(n=["task"],this.hasMoreSubtask&&n.push("subtask"),r=[],t=0,e=n.length;t<e;t++)i=n[t],this.listenTo(u,":change:"+i,function(t){return this.mergeData(t.toJSON())}),this.listenTo(u,":destroy:"+i,function(t){return this.removeData(t.id)}),r.push(this.listenTo(u,":new:"+i,function(t){return this.mergeData(t.toJSON())}));return r},t.prototype.load=function(t){var e,i;if("loading"!==(i=this.state))return this.datas={},this.setState("loading"),e=t?this.setLoadData(t):this.loadData,Promise.all([this.loadMyTask(e),this.loadMySubtask(e)]).then(function(t){return function(e){return t.mergeDatas(l.flatten(e)),t.setState("loaded")}}(this))},t.prototype.loadMore=function(){var t,e;if("loading"!==(e=this.state)&&"loadingMore"!==e&&this.hasMore())return this.setState("loadingMore"),t=this.loadData,t.page++,Promise.all([this.loadMyTask(t),this.loadMySubtask(t)]).then(function(t){return function(e){return t.mergeDatas(l.flatten(e)),t.setState("loaded")}}(this))},t.prototype.loadMyTask=function(t){return this.hasMoreTask?Promise.all([function(e){return function(){var i;return i=l.clone(t),i.hasDueDate=!0,e.doLoadMyTask(i)}}(this)(),function(e){return function(){var i;return e.hasDueDate?t.endDate||t.startDate?[]:(i=l.clone(t),i.hasDueDate=!1,e.doLoadMyTask(i)):[]}}(this)()]).then(function(t){return function(e){var i,n,r,o,s;for(o=e[0]||[],s=e[1]||[],t.hasMoreTask=o.length||s.length,i=0,r=s.length;i<r;i++)n=s[i],o.push(n);return o}}(this)):[]},t.prototype.loadMySubtask=function(t){return this.hasMoreSubtask?Promise.all([function(e){return function(){var i;return i=l.clone(t),i.hasDueDate=!0,e.doLoadMySubtask(i)}}(this)(),function(e){return function(){var i;return e.hasDueDate?t.endDate||t.startDate?[]:(i=l.clone(t),i.hasDueDate=!1,e.doLoadMySubtask(i)):[]}}(this)()]).then(function(t){return function(e){var i,n,r,o,s;for(o=e[0]||[],s=e[1]||[],t.hasMoreSubtask=o.length||s.length,i=0,r=s.length;i<r;i++)n=s[i],o.push(n);return o}}(this)):[]},t.prototype.doLoadMyTask=function(t){return r.ajax("v2/tasks/me",{data:t})},t.prototype.doLoadMySubtask=function(t){return r.ajax("v2/tasks/me/subtasks",{data:t})},t.prototype.setLoadData=function(t){return this.loadData=l.extend({count:20,page:1},t),this.loadData},t.prototype.getTaskFromList=function(t,e){var i,n,r;for(i=0,n=t.length;i<n;i++)if(r=t[i],r._id===e&&r._executorId===p.user.id)return r;return null},t.prototype.removeSubtaskIncludedByTask=function(t){var e,i,n,r,o,s;for(o=[],e=0,i=t.length;e<i;e++)s=t[e],(null!=(r=s.task)?r._id:void 0)&&(n=this.getTaskFromList(t,s.task._id))||o.push(s);return o},t.prototype.mergeDatas=function(t){var e,i,n;for(i=0,n=t.length;i<n;i++)e=t[i],this.doMerge(e);return this.trigger("merge",t)},t.prototype.mergeData=function(t){return this.doMerge(t),this.trigger("merge",t)},t.prototype.doMerge=function(t){var e,i,n;if(null!=t?t._id:void 0)return e=this.datas[t._id]||{},n=l.extend({},e,t),!(null!=(i=n.task)?i._id:void 0)&&e.task&&(n.task=e.task),this.datas[t._id]=n},t.prototype.removeData=function(t){return this.datas[t]=null,l.values(this.datas).forEach(function(e){return function(i){var n;if((null!=i&&null!=(n=i.task)?n._id:void 0)===t)return e.datas[i._id]=null}}(this)),this.trigger("remove",t)},t.prototype.setState=function(t){if(this.state!==t)return this.state=t,this.trigger("changeState",t)},t.prototype.getWorksByFilter=function(t){var e,i,n,r;r=[],n=this.datas;for(i in n)e=n[i],e&&!e.isArchived&&t(e)&&r.push(l.clone(e));return r},t.prototype.getById=function(t){return this.datas[t]},t.prototype.hasMore=function(){return this.hasMoreTask||this.hasMoreSubtask},t.prototype.remove=function(){return this.stopListening()},t}()},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li class="my-tasks-group" data-id="'+r._id+'"> <div class="group-header"> <span class="group-name">'+e(r.name)+'</span> ·     <span class="group-count">'+r.count+'</span> </div> <ul class="group-list my-list"></ul></li>';return i}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty,u=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};a=i(678),s=i(1217),c=i(677),r=i(429),n=i(1410),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="MyTasksCreatedTasks",e.prototype.createAPI=function(t){var e;return e={isDone:!1,isInvolved:!0},this.api=new t(e,(!1))},e.prototype.getTaskFilter=function(){var t;return t=a.user.id,function(e){var i;return i=e.involveMembers||[],!e.isDone&&u.call(i,t)>=0}},e.prototype.getTaskSorter=function(){return c.compareTask},e}(n)},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;a=i(678),s=i(1217),c=i(677),r=i(429),n=i(1410),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="MyTasksCreatedTasks",e.prototype.createAPI=function(t){var e;return e={isCreator:!0},this.dueDate&&(e.startDate=r(this.dueDate).toISOString()),this.api=new t(e)},e.prototype.getTaskFilter=function(){var t;return t=a.user.id,function(e){return e._creatorId===t}},e.prototype.getTaskSorter=function(){return function(t,e){var i,n;return i=new Date(t.created).getTime(),n=new Date(e.created).getTime(),n-i}},e}(n)},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(678),a=i(1217),s=i(677),r=i(429),n=i(1410),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="MyTasksDoneTasks",e.prototype.createAPI=function(t){var e;return e={isDone:!0},this.dueDate&&(e.startDate=r(this.dueDate).toISOString()),this.api=new t(e)},e.prototype.getTaskFilter=function(){var t,e,i;return e=c.user.id,t=r(this.dueDate||0).valueOf(),i=r().endOf("day").valueOf(),function(n){var o;return o=r(n.accomplished||0).valueOf(),(!t||t<=o&&o<=i)&&(!!n.isDone&&n._executorId===e)}},e.prototype.getTaskSorter=function(){return function(t,e){var i,n;return i=new Date(t.updated).getTime(),n=new Date(e.updated).getTime(),n-i}},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j=function(t,e){function i(){this.constructor=t}for(var n in e)T.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},T={}.hasOwnProperty;b=i(358),_=i(678),w=i(429),m=i(797),f=i(677),g=i(788),r=i(401),o=i(817),y=i(792),p=i(699),a=i(1418),d=i(1021),u=i(794),v=i(786),h=i(982),s=i(1420),n=i(1422),l={task:"board",post:"wall",event:"calendar",work:"file",entry:"bookkeeping-logo"},k=function(){return{task:tb_i18n.get("navigation.task"),post:tb_i18n.get("navigation.sharing"),work:tb_i18n.get("navigation.work"),event:tb_i18n.get("navigation.event"),entry:tb_i18n.get("bookkeeping")}},c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return j(e,t),e.prototype.viewName="FavoritesView",e.prototype.className="favorites-view float-view",e.prototype.events={"click .type-item":"filterType","keyup .search-input":"searchFavorite","input .search-input":"onInput","click .favorite-item":"openDetail","click .unfavorite":"unFavorite"},e.prototype.initialize=function(t){return this.options=t||{},this.url="favorites",this.attrs={q:this.query,type:t.type},this.collection=a.get(0),this.membersCollection=p.get(0),this.renderBasic(),b.delay(function(t){return function(){return t.$el.addClass("in")}}(this)),this},e.prototype.renderBasic=function(){var t,e,i;return i=k(),t=this.options.type,e=t?i[t]:tb_i18n.get("favorites.all"),this.$el.html(n({type:t,typeName:e})),this.$body=this.$(".favorites-body"),this.$list=this.$(".favorites-list"),this.fetchData(),this},e.prototype.fetchData=function(){return this.load({silent:!0,url:this.url,attrs:this.attrs,beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$list)}}(this),success:function(t){return function(e){if(t.hideLoadingIndicator(),t.renderResults(),t.collection.hasMore)return t.setupScroll(t.$el.closest(".my-content-wrap"))}}(this)})},e.prototype.renderResult=function(t){return t.forEach(function(t){return function(e){return t.$list.append(t.requestSubView(s,{model:e}).$el)}}(this))},e.prototype.renderResults=function(t){var e,i,n,r;return e=t&&null!=(null!=(r=t.results)?r.length:void 0)?new a(t):this.collection,this.renderResult(e),n=this.$(".search-input").val().trim(),i=this.attrs.source&&0===e.length&&""!==n,this.$body[i?"addClass":"removeClass"]("no-result"),this.$body.find(".search-placeholder-content").text(tb_i18n.get("search.no.result",n)),this},e.prototype.load=function(t){return this.collection.resetSoft(),this.collection.fetch(t),this},e.prototype.loadMore=function(t){return this.collection.loadMore({silent:!0,attrs:this.attrs,beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$list)}}(this),success:function(e){return function(i,n,r){var o;if(e.$el)return e.hideLoadingIndicator({animated:!0}),(null!=(o=n.results)?o.length:void 0)&&e.renderResults(n),e.collection.hasMore&&"function"==typeof t?t():void 0}}(this)}),this},e.prototype.filterFavorites=function(t){return this.attrs=b.extend(this.attrs,t),this.$list.html(""),this.fetchData(),this},e.prototype.filterType=function(t){var e,i,n;return n=k(),e=$(t.currentTarget),e.siblings("li").removeClass("active"),e.addClass("active"),i=e.data("type")||"",this.$(".active-type").text(i?n[i]:tb_i18n.get("favorites.all")),this.filterFavorites({type:i}),this},e.prototype.searchFavorite=function(t){var e,i;return e=$(t.currentTarget),i=e.val().trim(),i&&13===t.keyCode&&(this.url="favorites/me/search",this.filterFavorites({q:i,source:"search"})),this},e.prototype.onInput=function(t){var e,i;return e=$(t.currentTarget),i=e.val().trim(),i||"favorites"===this.url||(this.url="favorites",this.filterFavorites()),this},e.prototype.unFavorite=function(t){var e,i,n,o,s;if(i=$(t.currentTarget),e=i.closest(".favorite-item"),n=e.data("id"),s=e.data("type"),n)return t.stopPropagation(),o=this.collection.get(n),o.unFavorite(s,{success:function(){return e.next(".underscore").remove(),e.remove(),r.show({message:tb_i18n.get("favorites.unfavorite.success"),status:"success"})}}),this},e.prototype.openDetail=function(t){var e,i,n,o;if(e=$(t.currentTarget),!this.$(".type-filter").hasClass("open")&&(i=e.data("id"),o=e.data("type"),_.gta.event({action:"open detail",type:o,control:"Me Favourites"}),i))return n=this.collection.get(i),e.hasClass("not-visible")?r.show({message:tb_i18n.get("favorites.not.visible"),status:"warning"}):("work"===o?this.requestSubView(v).open(h,{_projectId:n.get("_projectId"),workModel:new y(b.extend(n.toJSON(),{_id:n.get("_refId")})),onUnfavorite:function(t){return function(e){return t.onUnfavorite(e)}}(this)}):this.requestSubView(v).open(u,{objectType:o,objectId:i,_projectId:n.get("_projectId"),fixedModal:!0,onUnfavorite:function(t){return function(e){return t.onUnfavorite(e)}}(this)}),this)},e.prototype.onUnfavorite=function(t){var e;return e=this.$(".favorite-item[data-id='"+t+"']"),e.next(".underscore").remove(),e.remove()},e}(g),b.extend(c.prototype,m),t.exports=c;
},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;n=i(351),c=i(358),l=i(429),a=i(677),r=i(685),o=i(1419),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.name="favorites",e.prototype.model=o,e.prototype.pageNum=20,e.prototype.comparator=!1,e.prototype.parse=function(t){var e,i;return e=[],i=null!=t.results?t.results:t,c.each(i||[],function(t){return function(i,r){var o,s,l,p,u,d,h;switch(i=c.extend(i,c.omit(i.data,"created")),i.type=i.refType,i._projectId=null!=(p=i.project)?p._id:void 0,i.projectName=null!=(u=i.project)?u.name:void 0,i.type){case"work":null!=i.fileSize&&(i.fileSize=a.formatFileSize(i.fileSize)),i.title=i.fileName;break;case"task":i.avatarUrl=(null!=(d=i.executor)?d.avatarUrl:void 0)||(null!=(h=i.creator)?h.avatarUrl:void 0),i.dueDate&&(i.dueDate=a.formatDate(i.dueDate)),i.accomplished&&(i.accomplished=a.formatDate(i.accomplished)),i.title=i.content,i.content=i.note;break;case"post":o=c.unescape(i.content);try{i.content=n("<div>"+o+"</div>").text()}catch(l){s=l,i.content=c.escape(o)}break;case"event":i.dateStr=t.formatDate(i.startDate),i.eventDateString=t.getEventDateString(i);break;case"entry":i._type=i.data.type,i._type===-1&&(i.amount="-"+i.amount),i.title=i.content,i.content=i.note}return i.createdDate=t.formatDate(i.created),e.push(i)}}(this)),e},e.prototype.formatDate=function(t){var e,i,n;return n=l(),i=l(t),e=i.isSame(n,"year")?"en"===tb_i18n.getLanguage()?"MMM D":"MMMDo":"ll",l(t).format(e)},e.prototype.getEventDateString=function(t){var e,i,n;return t.startDate?(i=a.formatDate(new Date(t.startDate)).dateString,n=i+" "+l(t.startDate).format("LT"),t.endDate&&(n+=" -",e=a.formatDate(new Date(t.endDate)).dateString,e!==i&&(n+=" "+e),n+=" "+l(t.endDate).format("LT")),n):""},e}(r)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty,m=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};u=i(358),s=i(688),l=i(803),r=i(817),p=i(792),a=i(1042),n=i(1265),c={task:l,event:r,work:p,post:a,entry:n},t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.name="favorite",e.prototype.urlRoot="favorites",e.prototype.idAttribute="_refId",e.prototype.initialize=function(t,i){return i||(i={}),i.bindByMatrix=!1,e.__super__.initialize.apply(this,arguments)},e.prototype.doFavorite=function(t,e){var i,n,r;if(null==e&&(e={}),!(m.call(u.keys(c),t)<0))return i=u.extend(this.get("data"),{_id:this.id}),n=new c[t](i),r=e.success,e.success=function(t){return function(e){var i,n;if("function"==typeof r&&r(),i=null!=(n=t.collection)?n.parse([e])[0]:void 0)return i.status="",t.set(i)}}(this),n.doFavorite(e),this},e.prototype.unFavorite=function(t,e){var i,n;if(!(m.call(u.keys(c),t)<0))return i=u.extend(this.get("data"),{_id:this.id}),n=new c[t](i),n.unFavorite(e),this},e}(s)},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;l=i(788),p=i(358),n=i(401),s=i(697),c=i(818),a=i(1421),o={task:"board",post:"wall",event:"calendar",work:"file",entry:"bookkeeping-logo"},t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.events={"click .update-icon":"reFavorite"},e.prototype.initialize=function(t){return null==t&&(t={}),this.model=t.model,this.render(),this.listenTo(this.model,"change",this.render)},e.prototype.render=function(){var t,e,i;if(t=p.extend(this.model.toJSON(),{iconName:o[this.model.get("type")]}),this.$el.html(a({item:t})),i=t.uniqueId,e=t._projectId,"task"===t.type)return s.fetch(e,{silentError:!0,success:function(t){return function(e){return t.requestSubView(c,{projectModel:e,uniqueId:i}).bind(t.$(".task-id-placeholder"))}}(this)})},e.prototype.reFavorite=function(t){return t.stopPropagation(),this.model.doFavorite(this.model.get("type"),{success:function(){return n.success(tb_i18n.get("favorites.update.success"))}})},e}(l)},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(932).fileIconT,o=i(963).calculateColor,s=t.item;if(n+='<li class="favorite-item '+e(s.type)+"-wrapper ",s.isVisible||(n+="not-visible"),n+='" data-type="'+e(s.type)+'" data-id="'+e(s._refId)+'"> <div class="item-header"> <div class="project-name">'+e(s.projectName||"projectName")+'</div> <div class="create-date">'+s.createdDate+'</div> <div class="unfavorite">'+tb_i18n.get("unfavorite")+'</div> </div> <div class="item-title clearfix"> <span class="icon icon-'+e(s.iconName)+" ","entry"!=s.type&&(n+="title-icon"),n+=" ","work"==s.type&&(n+="is-work"),n+=' pull-left"></span> ',"task"==s.type?(n+=' <span class="img img-24 img-circle no-avatar pull-left" ',s.avatarUrl&&(n+='style="background-image:url('+s.avatarUrl+')"'),n+="></span> "):"work"==s.type&&(n+=" "+r(s)+" "),n+=' <div class="title ',"work"==s.type&&(n+="work-title"),n+='"> <p> <span class="title-text">'+e(s.title)+"</span> ","work"==s.type&&(n+=' <span class="file-size"> ('+s.fileSize+") </span> "),n+=" ",s.tagIds&&s.tagIds.length>0){n+=" ";var a=s.tagIds;if(a)for(var c,l=-1,p=a.length-1;l<p;)c=a[l+=1],n+=' <span class="label tag ',0==l&&(n+="first-tag"),n+='"> <span class="tag-label" style="background-color: '+o(s.color,s.colorRGBA)+'"></span> <span class="tag-name">'+e(c.name)+"</span> </span> ";n+=" "}return n+=" ",s.isArchived&&(n+=' <span class="label archived"> <span class="icon icon-archive"></span> '+tb_i18n.get("search.archived")+" </span> "),n+=" ","task"===s.type&&(n+=' <span class="task-id-placeholder"></span> '),n+=' </p> </div> <div class="badges"> ',"updated"==s.status?n+=' <span class="label update-icon hinted" data-title="'+tb_i18n.get("favorites.updated")+'"> <span class="icon icon-file-update"></span> '+tb_i18n.get("favorites.new")+" </span> ":"archived"==s.status?n+=' <span class="label"> <span class="icon icon-archive"></span> '+tb_i18n.get("search.archived")+" </span> ":"invisible"==s.status?n+=' <span class="label"> <span class="icon icon-lock"></span> '+tb_i18n.get("favorites.invisible")+" </span> ":"deleted"==s.status&&(n+=' <span class="label"> <span class="icon icon-trash"></span> '+tb_i18n.get("favorites.deleted")+" </span> "),n+=" ","task"==s.type&&(n+=" ",!s.isDone&&s.dueDate?(n+=' <time class="task-duedate label ',"overdue"===s.dueDate.dateClass?n+="label-important":"today"===s.dueDate.dateClass?n+="label-warning":"upcoming"===s.dueDate.dateClass&&(n+="label-info"),n+='"> <span class="icon icon-calendar ',"normal"!==s.dueDate.dateClass&&(n+="icon-white"),n+='"></span> ',n+="today"===s.dueDate.dateClass?" <span>"+s.dueDate.dateTimeString+"</span> ":" <span>"+s.dueDate.dateString+"</span> ",n+=" </time> "):s.isDone&&s.accomplished&&(n+=' <time class="label task-accomplished-date"> <span class="icon icon-calendar icon-white"></span> '+s.accomplished.dateString+" </time> "),n+=" "),n+=" </div> ","entry"==s.type&&(n+=' <div class="entry-amount ',n+=1==s._type?"income":"expense",n+='">'+s.amount+"</div> "),n+=" </div> <!-- end of `.item-title`--> ","event"==s.type&&(n+=' <time class="event-date">'+s.eventDateString+"</time> ",s.location&&(n+=' <div class="address">'+e(s.location)+"</div> "),n+=" "),n+=" ","work"!=s.type&&s.content&&(n+=' <div class="item-content"> <div class="'+e(s.type)+'-content">'+e(s.content)+"</div> </div> "),n+='</li><div class="underscore"></div>'}},function(t,e){t.exports=function(t){var e='<div class="favorites-header"> <div class="favorites-filter clearfix"> <div class="filter type-filter"> <a class="type-toggler" data-toggle="dropdown"> <span class="active-type">'+t.typeName+'</span> <span class="icon icon-chevron-down"></span> </a> <div class="type-selector dropdown-menu card"> <ul class="type-list"> <li class="type-item ';return t.type||(e+="active"),e+='"> <a class="clearfix"> <span class="icon icon-favorite"></span> '+tb_i18n.get("favorites.all")+' </a> </li> <li class="type-item ',"task"==t.type&&(e+="active"),e+='" data-type="task"> <a class="clearfix"> <span class="icon icon-board"></span> '+tb_i18n.get("navigation.task")+' </a> </li> <li class="type-item ',"post"==t.type&&(e+="active"),e+='" data-type="post"> <a class="clearfix"> <span class="icon icon-wall"></span> '+tb_i18n.get("navigation.sharing")+' </a> </li> <li class="type-item ',"work"==t.type&&(e+="active"),e+='" data-type="work"> <a class="clearfix"> <span class="icon icon-file"></span> '+tb_i18n.get("navigation.work")+' </a> </li> <li class="type-item ',"event"==t.type&&(e+="active"),e+='" data-type="event"> <a class="clearfix"> <span class="icon icon-calendar"></span> '+tb_i18n.get("navigation.event")+' </a> </li> <li class="type-item ',"entry"==t.type&&(e+="active"),e+='" data-type="entry"> <a class="clearfix"> <span class="icon icon-bookkeeping-logo"></span> '+tb_i18n.get("bookkeeping")+' </a> </li> </ul> </div> </div> </div> <div class="search-wrap"> <span class="icon icon-search"></span> <input class="form-control search-input" type="search" placeholder="'+tb_i18n.get("favorites.search")+'"> </div></div><div class="favorites-body"> <ul class="favorites-list"></ul> <div class="normal-placeholder favorites-placeholder placeholder muted"> <span class="icon icon-favorite"></span> <br> '+tb_i18n.get("favorites.placeholder")+' </div> <div class="noresult-placeholder favorites-placeholder placeholder muted"> <span class="icon icon-search-warning"></span> <br> <div class="search-placeholder-content"></div> </div></div>'}},function(t,e,i){t.exports=function(t){var e="<!-- DO NOT REMOVE tb_i18n.get('my.recent') tb_i18n.get('my.tasks') tb_i18n.get('my.events') tb_i18n.get('my.favorites') tb_i18n.get('my.notes')-->",n=i(679),r=n.FEATURES;e+='<div class="my-header row-flex"> <div class="my-user-wrap"> <i class="avatar img-circle" style="background-image:url('+t.avatarUrl+')"></i> <span class="my-user-name">'+t.name+'</span> </div> <section class="my-tab-wrap"> ';var o=t.tabs;if(o)for(var s,a=-1,c=o.length-1;a<c;){s=o[a+=1],e+=" ";var l=s.name;e+=' <a class="my-tab my-'+l+'-handler" data-type='+l+' data-gta="{action: select '+l+'}"> <span class="my-tab-count '+l+'-count">'+(s.count||0)+'</span> <span class="my-tab-tip">'+tb_i18n.get(s.lang)+"</span> </a> "}return e+=' </section> <div class="my-btn-wrap"> ',r.userMenu_personalCenter&&(e+=' <a class="my-btn personal-handler" href="'+t.accountHost+'/my" target="_blank" data-gta="{action: enter personal center}">'+tb_i18n.get("my.btn.personal")+"</a> "),e+=' <a class="my-btn settings-handler" data-gta="{action: enter account center}"> '+tb_i18n.get("my.btn.settings")+' </a> </div></div><div class="my-content-wrap"> <div class="my-content card my-wrap"></div></div><footer class="my-footer" data-gta="event" data-label="close my"> <span class="icon icon-chevron-up"></span></footer>'}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w=function(t,e){function i(){this.constructor=t}for(var n in e)_.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},_={}.hasOwnProperty;g=i(429),k=i(678),y=i(1425),b=i(1426),u=i(1427),s=i(1428),h=i(788),f=i(786),n=i(1429),p=i(1430),a=i(1438),r=i(1442),o=i(1445),c=i(1449),v=u.TABLE_MODE,m=v.WEEK,d=v.MONTH,t.exports=l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.viewName="CalendarView",e.prototype.className="calendar-view",e.prototype.initialize=function(t){return this.options=t,this.renderBasic(),this.requestInitial().then(function(t){return function(){return t.filterView.update({calendarModel:t.calendarModel})}}(this))},e.prototype.beforeClose=function(){return $("#navigator .calendar-handler").removeClass("active")},e.prototype.clear=function(){return k.APP.Float.close()},e.prototype.onOpen=function(){return $("#navigator .calendar-handler").addClass("active")},e.prototype.remove=function(){var t;return this.beforeClose(),t=k.router.getUrl().replace(/\/calendar.*/,""),k.router.navigate(t,{trigger:!1}),e.__super__.remove.apply(this,arguments)},e.prototype.getTableView=function(){switch(b.instance.getTableMode()){case m:return p;case d:return a}},e.prototype.onChangeCurrentDay=function(){return this.tableView.onCurrentDayChange()},e.prototype.onChangeTableMode=function(){return this.renderTableView()},e.prototype.onChangeTableFilter=function(){return this.tableView.onTableFilterChange()},e.prototype.onOpenSubscriberModel=function(){return this.renderSubscriberModal()},e.prototype.onUpdateSelects=function(){return this.tableView.onUpdateSelects()},e.prototype.onRefreshList=function(){return this.filterView.onRefreshList()},e.prototype.onToggleShowFilterButton=function(){return this.filterView.setWidth(),this.tableView.setWidth()},e.prototype.renderBasic=function(){return this.$el.html(n()),this.renderHeader(),this.renderFilterView(),this.renderTableView()},e.prototype.renderHeader=function(){var t;return this.headerView=this.requestSubView(o),t=this.$(".calendar-view-header"),t.html(this.headerView.$el)},e.prototype.renderFilterView=function(){var t;return this.filterView=this.requestSubView(r),t=this.$(".calendar-view-body"),t.append(this.filterView.$el)},e.prototype.renderTableView=function(){var t,e;return null!=(e=this.tableView)&&e.remove(),this.tableView=this.requestSubView(this.getTableView()),t=this.$(".calendar-view-body"),t.append(this.tableView.$el)},e.prototype.renderSubscriberModal=function(){return this.subscriberView=this.requestSubView(f).open(c,{onClose:function(t){return function(){return t.onUpdateSelects()}}(this),calendarModel:this.calendarModel,onRefreshList:function(t){return function(){return t.onRefreshList()}}(this),originSelectsIds:b.instance.getSelectsIds()})},e.prototype.requestInitial=function(){return y.getSubscriberCalendars().then(function(t){return function(e){return t.calendarModel=new s(e),b.instance.initializeSelects(t.calendarModel.getFlattenIds())}}(this))},e}(h)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h;p=i(443),h=i(461),d=i(678),r=i(680),c=i(996),l=i(1010),n=i(1079),o=i(699),a=i(696),s=i(684),u={indices:!1,skipNulls:!0},e.getOrganizations=function(){return Promise.resolve(s.get(0))},e.getProjects=function(){return Promise.resolve(a.get(0))},e.getRecommendMembers=function(){return r.get("projects/recommendMembers",{cache:!1}).then(function(t){var e;return e=new o(null,{comparator:null}),e.add(t),e})},e.getRelativeMembers=function(){return r.get("members/me",{cache:!1}).then(function(t){var e;return e=new o,e.add(t),e})},e.getRelativeTeams=function(){return r.get("teams/me",{cache:!1}).then(function(t){var e;return e=new l,e.add(t),e})},e.getSubscriberCalendars=function(){return r.get("subscribers/calendar",{cache:!1})},e.getEvents=function(t,e,i,n){return null==t&&(t=[]),null==e&&(e=[]),Promise.all([function(){var e;return 0===t.length?Promise.resolve([]):(e=h.format({search:p.stringify({_projectId:t,startDate:i,endDate:n},u),pathname:"projects/events"}),r.get(e,{cache:!1}))}(),function(){var t;return 0===e.length?Promise.resolve([]):(t=h.format({search:p.stringify({_userId:e,startDate:i,endDate:n},u),pathname:"events/others"}),r.get(t,{cache:!1}))}(),function(){var t;return e=e.filter(function(t){return t!==d.user.get("_id")}),0===e.length?Promise.resolve([]):(t=h.format({search:p.stringify({_userId:e,startDate:i,endDate:n},u),pathname:"events/invisible"}),r.get(t,{cache:!1}).then(function(t){return t=t.map(function(t){return t.invisible=!0,t})}))}()])},e.getTasks=function(t,e,i,n){return null==t&&(t=[]),null==e&&(e=[]),Promise.all([function(){var e;return 0===t.length?Promise.resolve([]):(e=h.format({search:p.stringify({_projectId:t,dueDate__gt:i,dueDate__lt:n},u),pathname:"projects/tasks"}),r.get(e,{cache:!1}))}(),function(){var t;return 0===e.length?Promise.resolve([]):(t=h.format({search:p.stringify({_userId:e,dueDate__gt:i,dueDate__lt:n},u),pathname:"tasks/others"}),r.get(t,{cache:!1}))}()])}},function(t,e,i){var n,r,o,s,a,c,l,p=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};s=i(358),o=i(681),a=i(429),l=i(678),n=i(1427),c=o.namespace("calenderOptions"),r=function(){function t(){}return t.prototype.deleteSelects=function(t){var e;return e=function(e){return e.id!==t},this.setSelects(this.getSelects().filter(e))},t.prototype.getCurrentDay=function(){return null==this.currentDay&&(this.currentDay=a()),this.currentDay},t.prototype.getSelects=function(){return c.has(n.NAME_SPACE.SELECTES)||c(n.NAME_SPACE.SELECTES,JSON.stringify([{id:l.user.get("_id"),type:n.SELECTS_TYPES.USER}])),JSON.parse(c(n.NAME_SPACE.SELECTES))},t.prototype.getSelectsIds=function(){var t;return t=function(t){return t.id},this.getSelects().map(t)},t.prototype.getSelectsIdsWithType=function(t){var e,i;return e=function(e){return e.type===t},i=function(t){return t.id},this.getSelects().filter(e).map(i)},t.prototype.getShowFilter=function(){return c.has(n.NAME_SPACE.SHOW_FILTER)||c(n.NAME_SPACE.SHOW_FILTER,!0),c(n.NAME_SPACE.SHOW_FILTER)},t.prototype.getTableFilter=function(){var t;return c.has(n.NAME_SPACE.TABLE_FILTER)||c(n.NAME_SPACE.TABLE_FILTER,JSON.stringify((t={},t[""+n.TABLE_FILTERS.TASK]=!0,t[""+n.TABLE_FILTERS.EVENT]=!0,t[""+n.TABLE_FILTERS.WEEKEND]=!0,t))),JSON.parse(c(n.NAME_SPACE.TABLE_FILTER))},t.prototype.getTableFilterWithKey=function(t){return this.getTableFilter()[t]},t.prototype.getTableMode=function(){return c.has(n.NAME_SPACE.TABLE_MODE)||c(n.NAME_SPACE.TABLE_MODE,n.TABLE_MODE.WEEK),c(n.NAME_SPACE.TABLE_MODE)},t.prototype.initializeSelects=function(t){var e;return e=function(e){var i;return i=e.id,p.call(t,i)>=0},this.setSelects(this.getSelects().filter(e))},t.prototype.setCurrentDay=function(t){return this.currentDay=t},t.prototype.setSelects=function(t){return c(n.NAME_SPACE.SELECTES,JSON.stringify(t))},t.prototype.setShowFilter=function(t){return c(n.NAME_SPACE.SHOW_FILTER,t)},t.prototype.setTableFilter=function(t){return c(n.NAME_SPACE.TABLE_FILTER,JSON.stringify(t))},t.prototype.setTableFilterWithKey=function(t){var e;return e=this.getTableFilter(),e[t]=!e[t],this.setTableFilter(e)},t.prototype.setTableMode=function(t){return c(n.NAME_SPACE.TABLE_MODE,t)},t}(),e.instance=new r},function(t,e){t.exports={MIN_SUBSCRIBERS_LENGTH:1,NAME_SPACE:{SELECTES:"selects",TABLE_MODE:"tableMode",SHOW_FILTER:"showFilter",TABLE_FILTER:"tableFilter"},FILTER_VIEW_WIDTH:265,SELECTS_TYPES:{TEAM:"team",USER:"user",PROJECT:"project"},WEEKDAYS:{MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6,SUNDAY:7},WEEKEND_INDEXES:[5,6],TABLE_FILTERS:{TASK:"task",EVENT:"event",WEEKEND:"weekend"},TABLE_MODE:{WEEK:"week",MONTH:"month"}}},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;o=i(358),r=i(688),s=i(678),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.name="calendar",e.prototype.urlRoot="subscribers/calendar",e.prototype.parse=function(t){var e,i;return e=function(t){return t._id===s.user.get("_id")},i=function(t,i){var n,r;return e(t)&&!e(i)?-1:!e(t)&&e(i)?1:(r=t.pinyin||t.name,n=i.pinyin||i.name,r.localeCompare(n))},null!=t.body&&(null!=t.body.users&&(o.some(t.body.users,e)||(t.body.users=t.body.users.concat([s.user.toJSON()]))),t.body=o.mapObject(t.body,function(t){return t.sort(i)})),t},e.prototype.update=function(t){return new Promise(function(e){return function(i,n){return e.save(null,{url:e.urlRoot,attrs:t,parse:!0,success:i,error:n})}}(this))},e.prototype.getFlatten=function(){return o.chain(this.get("body")).map(function(t){return t}).flatten().value()},e.prototype.getFlattenIds=function(){return o.chain(this.getFlatten()).map(function(t){return t._id}).value()},e}(r)},function(t,e){t.exports=function(t){var e='<div class="calendar-view-header"></div><div class="calendar-view-body card"></div>';return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S,I,z,P,D,O,N,E,A,L,V,R=function(t,e){function i(){this.constructor=t}for(var n in e)F.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},F={}.hasOwnProperty,q=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};P=i(358),x=i(677),D=i(429),k=i(804),L=i(678),V=i(1431),E=i(1425),A=i(1426),s=i(1427),T=i(996),h=i(1079),g=i(699),u=i(817),S=i(788),z=i(786),j=i(1432),n=i(1433),d=i(1434),M=i(1435),m=i(1436),b=i(1021),_=i(1001),p=i(1071),v=i(1437),a="YYYYMMDD",O=s.SELECTS_TYPES,C=O.USER,y=O.PROJECT,f=s.FILTER_VIEW_WIDTH,N=s.TABLE_FILTERS,c=N.EVENT,w=N.TASK,I=N.WEEKEND,l=23,r=40,t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return R(e,t),e.prototype.viewName="CalendarWeekView",e.prototype.className="calendar-week-view",e.prototype.events={"click .et":"openEventOrTaskDetail","click .week-day":"addNewTaskOrEvent","click .week-time .event":"openEventOrTaskDetail","click .day-col-wrapper":"addNewNormEvent","click .expand-or-collapse":"expandOrCollapseTop"},e.prototype.initialize=function(t){return this.options=t||{},this.fetchData=P.debounce(this.fetchData,500),this.tasksCollection=T.get("calendarTasks"),this.eventsCollection=h.get("calendarEvents"),this.invisibleEventsCollection=h.get("calendarInvisibleEvents"),this.setWidth(),this.setup().renderBasic(),this.updateTimeInterval=setInterval(function(t){return function(){return t.updateTime()}}(this),6e4),this.registerAsResponsive(),this},e.prototype.setup=function(){return this.currentDay=A.instance.getCurrentDay(),this.shouldShowTasks=A.instance.getTableFilterWithKey(w),this.shouldShowEvents=A.instance.getTableFilterWithKey(c),this.selectedMemberIds=A.instance.getSelectsIdsWithType(C),this.selectedProjectIds=A.instance.getSelectsIdsWithType(y),this},e.prototype.listen=function(){return this.listenTo(this.tasksCollection,"add change remove",this.refreshData),this.listenTo(this.eventsCollection,"add change remove",this.refreshData),this},e.prototype.stopListen=function(){return this.stopListening(this.tasksCollection,"add change remove",this.refreshData),this.stopListening(this.eventsCollection,"add change remove",this.refreshData),this},e.prototype.refreshData=function(){return this.fetchData(function(t){return function(){return t.renderData(),t.setWeekTopHeight()}}(this))},e.prototype.renderBasic=function(){return this.renderDates(),setTimeout(function(t){return function(){return t.fetchAllMembers({success:function(e){return t.allMembers=e.toJSON().concat(L.user.toJSON()),t.fetchData(function(){if(t.renderData(),t.setWeekTopHeight(!0),V.isToday(t.currentDay))return t.$weekTime.scrollTop(t.updateTime()-75)})}})}}(this),100),this},e.prototype.renderDates=function(){return this.genDates(),this.$el.html(n({days:this.days,hours:this.hours,isThisWeek:V.isToday(this.currentDay),nowTime:this.formatTime(D())})),this.$toggleHeight=this.$(".toggle-height"),this.$weekDay=this.$(".week-day"),this.$gap=this.$(".gap"),this.$weekTime=this.$(".week-time"),this},e.prototype.renderWeeks=function(){var t,e;return e=D(),this.genDates(),this.$(".calendar-week-header").html(M({days:this.days})),t=P.pluck(this.days,"formatted").indexOf(e.format(a)),t>-1?(this.$weekDay.eq(t).addClass("current"),this.$weekTime.find(".day-col-wrapper").eq(t).addClass("current").append('<div class="now-time"></div>'),this.updateTime()):(this.$(".current").removeClass("current"),this.$(".now-time").remove()),this},e.prototype.renderData=function(){return this.renderTasksAndAllDayEvents(),this.renderNormEvents(),this},e.prototype.renderTasksAndAllDayEvents=function(){var t,e,i,n;return i=this.manipEvents(this.dataToShow),e=i[0],n=i[1],t=this.$(".tasks").html("").remove(),t=this.prepareTasksRender(n,t),this.$(".week-days-wrapper").append(t),this},e.prototype.setWeekTopHeight=function(t){var e;e=this.maxTasksNum*l+15,(t||this.maxTasksNum>5&&!this.$toggleHeight.find(".expand-or-collapse").hasClass("expanded"))&&(this.maxTasksNum>5&&(e=110),this.$toggleHeight.html(m({expanded:!1}))),this.maxTasksNum<=5&&(1===this.maxTasksNum&&(e=34),this.$toggleHeight.html("")),this.$weekDay.height(e),this.$weekTime.height($(window).height()-Math.min(e,240)-100-r)},e.prototype.renderNormEvents=function(){var t,e,i,n,r,o,s,a,c,l,p,u,d;for(p=this.manipEvents(this.dataToShow),r=p[0],d=p[1],this.$weekTime.find(".event, .new-event").remove(),u=this.days,o=s=0,c=u.length;s<c;o=++s)if(e=u[o],t=this.$weekTime.find(".day-col").eq(o),i=r[e.formatted])for(i.sort(function(t,e){return new Date(t.startDate)-new Date(e.startDate)}),a=0,l=i.length;a<l;a++)n=i[a],this.displayEvents(t,n);return this},e.prototype.displayEvents=function(t,e){var i,n,r,o,s,c,l,p,u,h,m,f;return p=D(e.startDate),r=D(e.endDate),s=p.hour(),l=p.minute(),h=this.formatTime(p,!l),m=parseInt(60*(s+l/60)),u=(r.toDate()-p.toDate())/1e3/60,o=parseInt(u),o<28&&(o=28),l>0&&m--,f="100%",c=0,i=t.find(".event"),i.length&&(n=i.filter(function(t){var e,n,r,o,s;if(e=$(this),n=i.eq(t+1),n.length&&(s=parseInt(n.position().top),o=parseInt(n.height())),r=parseInt(e.position().top),m<r+e.height()-1||s<r+e.height()-1&&m<s+o-1)return e})),n&&(f=100/(n.length+1),c=f*n.length,n.each(function(t){return $(this).css({left:f*t+"%"})}),c+="%"),t.append(d({event:e,start:p.format(a),top:m,height:o,left:c,time:h})),this},e.prototype.prepareTasksRender=function(t,e){var i,n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w;for(this.maxTasksNum=0,v=this.days,l=u=0,h=v.length;u<h;l=++u)if(r=v[l],c=t[r.formatted])for(n=l%7,y=Math.floor(l/7),p=d=0,m=c.length;d<m;p=++d)a=c[p],g=p,b=0===l?D(r.date).startOf("day"):D(a.startDate).startOf("day"),s=D(a.endDate).startOf("day"),o=f=a.isAllday?this.getEventsDuaration(b,s)-1:this.getEventsDuaration(b,s),w={event:a,date:r.formatted,startTime:o>1?D(a.endDate).format("h:mm a"):D(a.startDate).format("h:mm a"),data:[]},k=b.day(),0===k&&(k=7),k-=1,k+o>7&&(f=7-k),i=this.getEventMarginTop(r,a,e,y,g),w.data.push({colStart:n,rowStart:y,length:f,duaration:o,top:i}),this.maxTasksNum<i&&(this.maxTasksNum=i),w.data.length&&e.append(j(w));return this.maxTasksNum+=1,e},e.prototype.getEventMarginTop=function(t,e,i,n,r){var o,s,c,l,p,u,d,h,m;if(c=i.find(".event-layer"),!c.length)return r;for(o=c.find(".row-"+n),p=u=0,m=o.length;0<=m?u<m:u>m;p=0<=m?++u:--u)s=o.eq(p).find(".et"),d=s.data("duaration"),h=s.data("start"),l=this.getEventsDuaration(D(h,a),D(t.date))-1,0<l&&l<d&&r>=s.data("top")&&(r+=1);return r},e.prototype.fetchData=function(t){var e,i;return this.showLoadingIndicator(),this.stopListen(),e=D(this.days[0].date).startOf("day").toISOString(),i=D(this.days[6].date).endOf("day").toISOString(),this.tasksCollection.reset(),this.eventsCollection.reset(),this.invisibleEventsCollection.reset(),Promise.all([E.getEvents(this.selectedProjectIds,this.selectedMemberIds,e,i).then(function(t){return function(e){var i,n;return i=[].concat(e[0],e[1]),n=P.uniq(i,function(t){return t._id}),t.eventsCollection.add(n),t.invisibleEventsCollection.add(e[2])}}(this)),E.getTasks(this.selectedProjectIds,this.selectedMemberIds,e,i).then(function(t){return function(e){var i,n;return i=[].concat(e[0],e[1]),n=P.uniq(i,function(t){return t._id}),t.tasksCollection.add(n)}}(this))]).then(function(e){return function(){return e.hideLoadingIndicator(),e.assembleData(t),e.listen()}}(this)),this},e.prototype.assembleData=function(t){var e,i,n,r,o;return e=function(t,e){return new Date(t.startDate)-new Date(e.startDate)},this.shouldShowTasks&&(o=P.chain(this.tasksCollection.toJSON()).map(function(t){return P.extend({},t,{type:"task",endDate:t.dueDate,startDate:t.dueDate})}).sort(e).filter(function(t){return!t.isDone}).value()),this.shouldShowEvents&&(n=P.union(this.eventsCollection.toJSON(),this.invisibleEventsCollection.toJSON()),r=D(P.first(this.days).date).startOf("day"),i=D(P.last(this.days).date).endOf("day"),n=k.fakeByCollection(n,r,i),n=P.chain(n).map(function(t){return P.extend({},t,{type:"event",isEvent:!0,isAllday:x.isAllDayEvent(t)})}).sort(e).value()),this.dataToShow=P.union(o,n),t(),this},e.prototype.manipEvents=function(t){var e,i,n,r,o,s,c,l,p,u,d,h,m,f,g,v,y,b,k,w;for(k={},o={},s=this.days[0],g={},l=0,h=t.length;l<h;l++)n=t[l],b=D(n.startDate),i=D(n.endDate),u=b.format(a),n.isEvent||(n.avatarUrl=this.getUserAvatarById(n._executorId)),!n.isEvent||n.isAllday||this.isCrossDayEvent(n)?(k[u]||(k[u]=[])).push(n):(this.setInvisibleEventContent(n),(g[u]||(g[u]=[])).push(n)),b.toDate()<(v=s.date)&&v<i.toDate()&&this.isCrossDayEvent(n)&&(o[f=s.formatted]||(o[f]=[])).unshift(n);for(p in o)for(w=o[p],d=0,m=w.length;d<m;d++)r=w[d],c=r.fakeId?"fakeId":"_id",e=P.pluck(k[p],c),y=r[c],q.call(e,y)<0&&(k[p]||(k[p]=[])).unshift(r);return[g,k]},e.prototype.setInvisibleEventContent=function(t){var e,i,n;if(t.invisible)return e=P.pluck(P.filter(this.allMembers,function(e){var i;return i=e._id,q.call(t.involveMembers,i)>=0}),"name"),n=e.length,i=e[0],e.length>1?t.content=tb_i18n.get("calendar.invisivle.event.tip1",i,n):t.content=tb_i18n.get("calendar.invisivle.event.tip2",i),t.tooltip=e.join(","),this},e.prototype.getUserAvatarById=function(t){var e,i,n,r;if(this.allMembers)for(r=this.allMembers,e=0,i=r.length;e<i;e++)if(n=r[e],n._id===t)return n.avatarUrl},e.prototype.fetchAllMembers=function(t){var e;return t=P.extend(t,{url:"projects/members"}),e=t.success,g.fetchT("MemberCollection",t)(function(t,i){return e(i||[])})},e.prototype.getDates=function(t,e){var i,n,r;for(n=new Array(e),i=new Date(t),r=0;r<e;)n[r++]=new Date(i),i.setDate(i.getDate()+1);return n},e.prototype.genDates=function(){var t,e,i,n,r,o,s,c,l;for(l=[tb_i18n.get("MON"),tb_i18n.get("TUE"),tb_i18n.get("WED"),tb_i18n.get("THU"),tb_i18n.get("FRI"),tb_i18n.get("SAT"),tb_i18n.get("SUN")],r=D(),t=D(this.currentDay),c=0===t.day()?t.subtract(6,"days"):t.subtract(t.day()-1,"days"),e=this.getDates(c,7),i=0;i<7;)n=D(e[i]),e[i]={date:e[i],formatted:n.format(a),title:l[i]+" "+n.format("M/D"),current:n.isSame(r,"day"),weekend:0===(o=n.day())||6===o},i++;return this.days=e,s=r.startOf("day"),this.hours=function(){var t,e;for(e=[],i=t=0;t<23;i=++t)e.push(this.formatTime(s.add(1,"hours"),!0));return e}.call(this),this},e.prototype.layout=function(){return this.$weekTime.height(this.$el.height()-this.$(".week-days-wrapper").height()-54),this},e.prototype.formatTime=function(t,e){return"en"===tb_i18n.getLanguage()?e?t.format("h a"):t.format("h:mm a"):e?t.format("ah["+tb_i18n.get("calendar.time")+"]"):t.format("ah:mm")},e.prototype.openEventOrTaskDetail=function(t){var e,i,n,r,o,s,a;if(!t.currentTarget)return this;if(e=$(t.currentTarget),a=e.data("type"),n=e.data("id"),i=e.data("fid"),e.hasClass("temp"))return!1;if(e.hasClass("invisible"))return!1;switch(a){case"task":L.gta.event({action:"open detail",type:"task"}),L.APP.openTaskPreviewer(n);break;case"event":o=P.find(this.dataToShow,function(t){return t._id===n}),r=24===o._id.length?o:P.extend({},o,{_id:o._originEventId}),s=new u(r,{bindByMatrix:!1}),s.collection=this.eventsCollection,L.gta.event({action:"open detail",type:"event"}),L.APP.openEventPreviewer(s)}return this},e.prototype.getEventsDuaration=function(t,e){var i;return i=e.diff(t,"day"),i+1},e.prototype.isCrossDayEvent=function(t){var e;return e=this.getEventsDuaration(D(t.startDate),D(t.endDate)),t.isAllday&&(e-=1),e>1},e.prototype.showTasks=function(t){
return this.shouldShowTasks=t,this.assembleData(function(t){return function(){return t.renderData().setWeekTopHeight()}}(this))},e.prototype.showEvents=function(t){return this.shouldShowEvents=t,this.assembleData(function(t){return function(){return t.renderData().setWeekTopHeight()}}(this))},e.prototype.onCurrentDayChange=function(){return this.currentDay=A.instance.getCurrentDay(),this.renderWeeks(),this.fetchData(function(t){return function(){if(t.renderData(),t.setWeekTopHeight(!0),t.$weekTime.find(".hour div").show(),V.isToday(t.currentDay))return t.$weekTime.scrollTop(t.updateTime()-50)}}(this))},e.prototype.addNewTaskOrEvent=function(t){var e,i,n,r,o,s,c,l,p,u;return e=$(t.currentTarget),i=$(t.target),i.hasClass("temp")?this:(o=this.days[e.index()].formatted)?(r=D(o,a),u=new Date(r.year(),r.month(),r.date(),D().hour()).toISOString(),(null!=(s=this.typeMenu)&&null!=(c=s.$popover)?c.length:void 0)?(this.typeMenu.remove(),this.$weekDay.find(".temp").remove(),this):(null!=(l=L.APP.panelView)?l.isIn:void 0)?this:(this.isAddingTaskOrAllDayEvent=o,n=$("<div class='temp' style='left: "+e.offset().left+"px; width: "+e.width()+"px;'></div>").appendTo(e),null!=(p=this.typeMenu)&&p.remove(),this.typeMenu=this.requestSubView(b,{$toggler:n,hideDelay:0,ListTemplate:v,placement:function(){var t;return 6===(t=r.day())||0===t?"left":"right"},dataList:[{_id:0,title:tb_i18n.get("create.task")},{_id:1,title:tb_i18n.get("create.event")}],onHidden:function(t){return function(){return t.isAddingTaskOrAllDayEvent=null,t.typeMenu=null,n.remove()}}(this),select:function(t){return function(e){return 0===e?t.openTaskCreator(u):t.openEventCreator(u,!0),t.typeMenu.remove(),n.remove()}}(this)}).show(),this)):this},e.prototype.addNewNormEvent=function(t){var e,i,n,r,o,s;return i=$(t.target),e=$(t.currentTarget),(null!=(s=L.APP.panelView)?s.isIn:void 0)||i.closest(".event").length||this.isAddingTaskOrAllDayEvent?this:(n=D(this.days[e.index()].date),o=Math.floor(t.offsetY/60),n.hour(o),n.minute(0),r=D(n).add(1,"hours"),e.append('<div class="new-event" style="top: '+(60*o-1)+'px; height: 58px;">\n  '+this.formatTime(n,!0)+" - "+this.formatTime(r,!0)+"\n</div>"),L.gta.event({action:"add content",type:"event",control:"Calendar Cell"}),this.openEventCreator(n),this)},e.prototype.expandOrCollapseTop=function(t){var e,i,n;return e=$(t.currentTarget),n=this.maxTasksNum*l+15,e.hasClass("expanded")?(this.$toggleHeight.html(m({expanded:!1})),this.$weekDay.height(110),this.$weekTime.height(this.$el.height()-110-54)):(this.$toggleHeight.html(m({expanded:!0})),this.$weekDay.height(n),i=Math.min(n,240),this.$weekTime.height(this.$el.height()-i-54)),this},e.prototype.openTaskCreator=function(t){return this.requestSubView(z).open(_,{dueDate:t,tasksCollection:this.tasksCollection,onClose:function(t){return function(){return t.isAddingTaskOrAllDayEvent=null,t.assembleData(function(){return t.renderTasksAndAllDayEvents()})}}(this)})},e.prototype.openEventCreator=function(t,e){return this.requestSubView(z).open(p,{startDate:t,endDate:D(t).add(1,"hours").toISOString(),eventsCollection:this.eventsCollection,isAllDay:e,onClose:function(t){return function(){return t.isAddingTaskOrAllDayEvent=null,t.assembleData(function(){return t.renderData()})}}(this)}),this},e.prototype.updateTime=function(){var t,e,i,n,r;return n=D(),e=n.hour(),i=n.minute(),r=60*(e+i/60),t=this.$weekTime.find(".now-time").css({top:r+"px"}),t.filter(".hour").text(this.formatTime(n)),r},e.prototype.remove=function(){return clearInterval(this.updateTimeInterval),e.__super__.remove.apply(this,arguments)},e.prototype.setWidth=function(){return this.$el.css("left",A.instance.getShowFilter()?f:0)},e.prototype.onUpdateSelects=function(){return this.selectedMemberIds=A.instance.getSelectsIdsWithType(C),this.selectedProjectIds=A.instance.getSelectsIdsWithType(y),this.refreshData()},e.prototype.onTableFilterChange=function(){var t,e;if(e=A.instance.getTableFilterWithKey(w),t=A.instance.getTableFilterWithKey(c),this.shouldShowTasks!==e&&this.showTasks(e),this.shouldShowEvents!==t)return this.showEvents(t)},e}(S)},function(t,e,i){var n,r;n=i(358),r=i(429),e.changeTime=function(t,e,i){var n;switch(i){case"week":n=r(e)[t](7,"day");break;case"month":n=r(e)[t](1,"month")}return n},e.increment=function(t,i,n,r){var o,s;return null==r&&(r=0),o=i.length+r,o<t+r?(s=i.concat([n(o)]),e.increment(t,s,n,r)):i},e.isToday=function(t){return t.isSame(r(),"day")},e.searchIdByString=function(t,e){return n.chain(e).filter(function(e){return e.name&&~e.name.toLowerCase().search(t.toLowerCase())||e.pinyin&&~e.pinyin.search(t)||e.py&&~e.py.search(t)}).map(function(t){return t._id}).value()},e.searchByString=function(t,e){return n.chain(e).filter(function(e){return e.name&&~e.name.toLowerCase().search(t.toLowerCase())||e.pinyin&&~e.pinyin.search(t)||e.py&&~e.py.search(t)}).value()}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="event-layer ';!t.event.invisible&&t.event._id&&(i+=""+e(t.event.fakeId||t.event._id)),i+='"> ';var n=t.data;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <div class="rows row-'+e(r.rowStart)+'"> <div class="et is-'+e(t.event.type)+" ",t.event.invisible&&(i+="invisible hinted"),i+=" ",t.event.isTemp&&(i+="temp"),i+=" col-"+e(r.colStart)+" length-"+e(r.length)+'" style="margin-top: '+e(24*r.top)+'px;" data-title="'+t.event.tooltip+'" data-duaration="'+e(r.duaration)+'" data-start="'+e(t.date)+'" data-top="'+e(r.top)+'" data-type="'+e(t.event.type)+'" data-id="'+e(t.event._id)+'" data-gta="event"> <div class="event-inner flex-horiz flex-vcenter ',r.duaration>1&&o==t.data.length-1&&(i+="multi"),i+=" ",t.event.isAllday&&(i+="all-day"),i+='"> <span class="title flex-fill">',i+=t.event.isEvent?""+e(t.event.title):""+e(t.event.content),i+="</span> ",t.event.isEvent?(i+=" ",o!=t.data.length-1||t.event.isAllday||(i+='<span class="time flex-static">'+e(t.startTime)+"</span>"),i+=" "):(i+=" ",t.event.isTemp||(i+='<span class="avatar no-avatar flex-static" ',t.event.avatarUrl&&(i+='style="background-image: url('+t.event.avatarUrl+');"'),i+="></span>"),i+=" "),i+=" </div> </div> </div> ";return i+="</div>"}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="calendar-week-inner"> <div class="calendar-week-header"> <div class="week-title"> ',n=t.days;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <div class="title ',5!=o&&6!=o||(i+="weekend"),i+='">'+e(r.title)+"</div> ";i+=' </div> </div> <div class="week-top thin-scroll"> <div class="all-day-text">'+tb_i18n.get("event.creator.all.day")+'</div> <div class="week-days-wrapper thin-scroll"> <div class="week-row clearfix"> ';var a=t.days;if(a)for(var r,c=-1,l=a.length-1;c<l;)r=a[c+=1],i+=' <div class="week-day ',r.current&&(i+="current"),i+=" ",r.weekend&&(i+="weekend"),i+='"></div> ';i+=' </div> <div class="tasks"></div> </div> </div> <div class="gap"> <div class="toggle-height"></div> </div> <div class="week-time thin-scroll"> <div class="left-side thin-scroll"> ';var p=t.hours;if(p)for(var u,d=-1,h=p.length-1;d<h;)u=p[d+=1],i+=' <div class="hour"><div>'+e(u)+"</div></div> ";i+=' </div> <div class="day-hours thin-scroll"> ';var m=t.days;if(m)for(var r,f=-1,g=m.length-1;f<g;)r=m[f+=1],i+=' <div class="day-col-wrapper ',r.current&&(i+="current"),i+='"> <div class="day-col"></div> ',r.current&&(i+='<div class="now-time"></div>'),i+=" </div> ";i+=' </div> <div class="day-lines thin-scroll"> ';var v=t.days;if(v)for(var r,y=-1,b=v.length-1;y<b;)r=v[y+=1],i+=' <div class="vertical-line"></div> ';i+=' </div> <div class="hour-lines thin-scroll"> ';var k=t.hours;if(k)for(var u,w=-1,_=k.length-1;w<_;)u=k[w+=1],i+=' <div class="hour-line"></div> ';return i+=" </div> </div></div>"}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="";return!t.event.invisible&&t.event._id?(i+=' <div class="event '+e(t.event._id)+'" data-id="'+e(t.event._id)+'" ',t.event.fakeId&&(i+='data-fid="'+e(t.event.fakeId)+'"'),i+=' data-start="'+e(t.start)+'" data-type="event" style="top: '+e(t.top)+"px; height: "+e(t.height)+"px; left: "+e(t.left)+'"> <div class="content-wrapper hinted" data-title="'+e(t.event.title)+'"> <div class="content">'+e(t.event.title)+"</div> ",t.height>41&&(i+='<div class="time">'+e(t.time)+"</div>"),i+=" </div> </div>"):(i+=' <div class="event hinted invisible" data-title="'+e(t.event.tooltip)+'" data-type="event" style="top: '+e(t.top)+"px; height: "+e(t.height)+"px; left: "+e(t.left)+'"> <div class="content-wrapper"> <div class="content">'+e(t.event.content)+"</div> ",t.height>41&&(i+='<div class="time">'+e(t.time)+"</div>"),i+=" </div> </div>"),i}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="week-title"> ',n=t.days;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <div class="title ',5!=o&&6!=o||(i+="weekend"),i+='">'+e(r.title)+"</div> ";return i+="</div>"}},function(t,e){t.exports=function(t){var e="";return e+=t.expanded?' <a class="expand-or-collapse expanded"> <span class="text">'+tb_i18n.get("collapse")+'</span> <span class="icon icon-chevron-up"></span> </a>':' <a class="expand-or-collapse"> <span class="text">'+tb_i18n.get("expand")+'</span> <span class="icon icon-chevron-down"></span> </a>'}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t.dataList;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li class="menu-item ',r.selected&&(i+="selected"),i+='" data-id="'+r._id+"\" data-gta=\"{action: 'add content', type:'",i+=r._id?"event":"task",i+="', control: 'Calendar Cell'}\"> <a> <span class=\"icon icon-",i+=0==r._id?"checkbox-checked":"calendar",i+='"></span> <span>'+e(r.title)+"</span> </a></li>";return i}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S,I,z,P,D,O,N,E,A=function(t,e){function i(){this.constructor=t}for(var n in e)L.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},L={}.hasOwnProperty,V=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};I=i(358),M=i(677),z=i(429),k=i(804),E=i(678),O=i(1425),N=i(1426),s=i(1427),j=i(996),m=i(1079),g=i(699),d=i(817),C=i(788),S=i(786),n=i(1439),h=i(1432),b=i(1021),_=i(1001),p=i(1071),v=i(1437),u=i(1440),a="YYYYMMDD",P=s.SELECTS_TYPES,T=P.USER,y=P.PROJECT,f=s.FILTER_VIEW_WIDTH,D=s.TABLE_FILTERS,c=D.EVENT,w=D.TASK,x=D.WEEKEND,r=128,l=23,t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return A(e,t),e.prototype.viewName="CalendarMonthView",e.prototype.className="calendar-month-view",e.prototype.events={"click .et":"openEventOrTaskDetail","click .total":"openEventListPopover","click .month-day":"addNewTaskOrEvent"},e.prototype.initialize=function(t){return this.options=t||{},this.fetchData=I.debounce(this.fetchData,500),this.tasksCollection=j.get("calendarTasks"),this.eventsCollection=m.get("calendarEvents"),this.invisibleEventsCollection=m.get("calendarInvisibleEvents"),this.setWidth(),this.setup().renderBasic(),this.registerAsResponsive(),this},e.prototype.setup=function(){return this.currentDay=N.instance.getCurrentDay(),this.shouldShowTasks=N.instance.getTableFilterWithKey(w),this.shouldShowEvents=N.instance.getTableFilterWithKey(c),this.selectedMemberIds=N.instance.getSelectsIdsWithType(T),this.selectedProjectIds=N.instance.getSelectsIdsWithType(y),this},e.prototype.listen=function(){return this.listenTo(this.tasksCollection,"add change remove",this.refreshData),this.listenTo(this.eventsCollection,"add change remove",this.refreshData),this},e.prototype.stopListen=function(){return this.stopListening(this.tasksCollection,"add change remove",this.refreshData),this.stopListening(this.eventsCollection,"add change remove",this.refreshData),this},e.prototype.refreshData=function(){return this.isAdding=null,this.fetchData(function(t){return function(){return t.renderData()}}(this))},e.prototype.renderBasic=function(){return this.renderDates(),setTimeout(function(t){return function(){return t.fetchAllMembers({success:function(e){return t.allMembers=e.toJSON().concat(E.user.toJSON()),t.numOfEventsToShow=t.getNumOfEventsToShow(),t.fetchData(function(){return t.renderData()})}})}}(this),100),this},e.prototype.renderDates=function(){return this.genDates(),this.$el.html(n({weekdays:this.weekDays,rows:this.rows,fiveRows:this.fiveRows}))},e.prototype.renderData=function(){var t,e,i,n,r,o;return this.dumbEvents=this.copyEvents(this.dataToShow),i=this.manipEvents(this.dataToShow),this.isAdding&&(o={_id:0,isTemp:!0,startDate:z(this.isAdding,a).toISOString(),endDate:z(this.isAdding,a).toISOString()},((e=this.dumbEvents)[n=this.isAdding]||(e[n]=[])).push(o),(i[r=this.isAdding]||(i[r]=[])).push(o)),t=this.$(".month-events").html("").remove(),t=this.prepareEventsRender(i,t),this.$(".calendar-month-body").append(t),this.renderTotalNums(t),this},e.prototype.renderTotalNums=function(t){var e,i,n,r,o,s,a,c,l,p,u,d,h;for(i=this.$(".total"),p=this.days,u=[],a=c=0,l=p.length;c<l;a=++c)n=p[a],e=i.eq(a),r=this.dumbEvents[n.formatted]||[],o=r.length,d=Math.floor(a/7),h=function(){var e,i,n;for(n=[],i=0,e=r.length;i<e;i++)s=r[i],t.find("."+(s.fakeId||s._id)+" .row-"+d).length&&n.push(s);return n}().length,o>h&&this.numOfEventsToShow>0?u.push(e.html("<span class='number'>"+tb_i18n.get("total.events.and.tasks",o)+"</span>")):u.push(e.html(""));return u},e.prototype.copyEvents=function(t){var e,i,n,r,o,s,c,l,p,u,d,h,m,f,g,v,y;for(n={},c={},d=0,h=t.length;d<h;d++)if(s=t[d],g=z(s.startDate).startOf("day"),o=z(s.endDate).startOf("day"),i=(s.isAllday?this.getEventsDuaration(g,o)-1:this.getEventsDuaration(g,o))-1,u=g.format(a),v=s.isEvent?s.title:s.content,r={_id:s.fakeId||s._id,title:v,startTime:i?z(s.startDate).format("MMM D, h:mm a"):z(s.startDate).format("h:mm a"),isEvent:s.isEvent,isAllday:s.isAllday,isCrossday:i>0,invisible:s.invisible,involveMembers:s.involveMembers},s.isEvent||(r.avatarUrl=this.getUserAvatarById(s._executorId)),(n[u]||(n[u]=[])).push(r),i)for(l=m=1,f=i;1<=f?m<=f:m>=f;l=1<=f?++m:--m)e=z(g).add(l,"days"),p=e.format(a),(c[p]||(c[p]=[])).push(r);for(p in c)y=c[p],n[p]=y.concat(n[p]||(n[p]=[]));return n},e.prototype.prepareEventsRender=function(t,e){var i,n,r,o,s,a,c,l,p,u,d,m,f,g,v,y,b,k,w,_,j,T,M;for(w=this.days,u=m=0,g=w.length;m<g;u=++m)if(s=w[u],p=t[s.formatted])for(o=u%7,j=Math.floor(u/7),d=b=0,v=p.length;b<v;d=++b){if(l=p[d],k=d,T=u%7===0?z(s.date).startOf("day"):z(l.startDate).startOf("day"),c=z(l.endDate).startOf("day"),a=y=l.isAllday?this.getEventsDuaration(T,c)-1:this.getEventsDuaration(T,c),M={event:l,date:s.formatted,startTime:a>1?z(l.endDate).format("h:mm a"):z(l.startDate).format("h:mm a"),data:[]},f=null,_=T.day(),0===_&&(_=7),_-=1,_+a>7&&(f=a+_-7,y=7-_),n=this.getEventMarginTop(s,l,e,j,k),n<this.numOfEventsToShow&&M.data.push({colStart:o,rowStart:j,length:y,duaration:a,top:n}),f)for(r=j;f>0&&(r+=1,!(r>this.rows.length-1));)i=this.getEventMarginTop(s,l,e,r,0,!0),i<this.numOfEventsToShow&&M.data.push({colStart:0,rowStart:r,length:f>7?7:f,duaration:a,top:i}),f-=7;M.data.length&&e.append(h(M))}return e},e.prototype.getEventMarginTop=function(t,e,i,n,r,o){var s,c,l,p,u,d,h,m,f;if(l=i.find(".event-layer"),!l.length)return r;for(s=l.find(".row-"+n),u=d=0,f=s.length;0<=f?d<f:d>f;u=0<=f?++d:--d)c=s.eq(u).find(".et"),h=c.data("duaration"),m=c.data("start"),p=this.getEventsDuaration(z(m,a),z(t.date))-1,0<p&&p<h&&r>=c.data("top")&&(r+=1),o&&0===p&&(r+=1);return r},e.prototype.fetchData=function(t){var e,i;return this.showLoadingIndicator(),this.stopListen(),e=z(this.fromDate).startOf("day").toISOString(),i=z(this.toDate).endOf("day").toISOString(),this.tasksCollection.reset(),this.eventsCollection.reset(),this.invisibleEventsCollection.reset(),Promise.all([O.getEvents(this.selectedProjectIds,this.selectedMemberIds,e,i).then(function(t){return function(e){var i,n;return i=[].concat(e[0],e[1]),n=I.uniq(i,function(t){return t._id}),t.eventsCollection.add(n),t.invisibleEventsCollection.add(e[2])}}(this)),O.getTasks(this.selectedProjectIds,this.selectedMemberIds,e,i).then(function(t){return function(e){var i,n;return i=[].concat(e[0],e[1]),n=I.uniq(i,function(t){return t._id}),t.tasksCollection.add(n)}}(this))]).then(function(e){return function(){return e.hideLoadingIndicator(),e.assembleData(t),e.listen()}}(this)),this},e.prototype.assembleData=function(t){var e,i,n,r,o;return e=function(t,e){return new Date(t.startDate)-new Date(e.startDate)},this.shouldShowTasks&&(o=I.chain(this.tasksCollection.toJSON()).map(function(t){return I.extend({},t,{type:"task",endDate:t.dueDate,startDate:t.dueDate})}).sort(e).filter(function(t){return!t.isDone}).value()),this.shouldShowEvents&&(n=I.union(this.eventsCollection.toJSON(),this.invisibleEventsCollection.toJSON()),r=z(I.first(this.days).date).startOf("day"),i=z(I.last(this.days).date).endOf("day"),n=k.fakeByCollection(n,r,i),n=I.chain(n).map(function(t){return I.extend({},t,{type:"event",isEvent:!0,isAllday:M.isAllDayEvent(t)})}).sort(e).value()),this.dataToShow=I.union(o,n),t(),this},e.prototype.manipEvents=function(t){var e,i,n,r,o,s,c,l,p,u,d,h,m,f,g,v,y,b,k,w;for(v={},s=this.days[0],d=this.days[this.days.length-1],o={},u=0,h=t.length;u<h;u++)n=t[u],k=z(n.startDate),i=z(n.endDate),p=k.format(a),n.isEvent||(n.avatarUrl=this.getUserAvatarById(n._executorId)),(v[p]||(v[p]=[])).push(n),this.setInvisibleEventContent(n),k.toDate()<(y=s.date)&&y<i.toDate()&&(o[g=s.formatted]||(o[g]=[])).unshift(n);for(l in o)for(w=o[l],f=0,m=w.length;f<m;f++)r=w[f],c=r.fakeId?"fakeId":"_id",e=I.pluck(v[l],c),b=r[c],V.call(e,b)<0&&(v[l]||(v[l]=[])).unshift(r);return v},e.prototype.setInvisibleEventContent=function(t){var e,i,n;if(t.invisible)return e=I.pluck(I.filter(this.allMembers,function(e){var i;return i=e._id,V.call(t.involveMembers,i)>=0}),"name"),n=e.length,i=e[0],e.length>1?t.title=tb_i18n.get("calendar.invisivle.event.tip1",i,n):t.title=tb_i18n.get("calendar.invisivle.event.tip2",i),t.tooltip=e.join(","),this},e.prototype.getUserAvatarById=function(t){var e,i,n,r;if(this.allMembers)for(r=this.allMembers,e=0,i=r.length;e<i;e++)if(n=r[e],n._id===t)return n.avatarUrl},e.prototype.fetchAllMembers=function(t){var e;return t=I.extend(t,{url:"projects/members"}),e=t.success,g.fetchT("MemberCollection",t)(function(t,i){return e(i||[])})},e.prototype.getDates=function(t,e){var i,n,r;for(n=new Array(e),i=new Date(t),r=0;r<e;)n[r++]=new Date(i),i.setDate(i.getDate()+1);return n},e.prototype.genDates=function(){var t,e,i,n,r,o,s,c,l,p,u,d;for(c=z(),d=z(this.currentDay).startOf("month"),i=z(d).day(),0===i?i=6:i-=1,n=z(d.toDate()).add(-i,"days").toDate(),this.weekDays=[tb_i18n.get("MON"),tb_i18n.get("TUE"),tb_i18n.get("WED"),tb_i18n.get("THU"),tb_i18n.get("FRI"),tb_i18n.get("SAT"),tb_i18n.get("SUN")],e=this.getDates(n,42),r=0;r<42;)s=z(e[r]),e[r]={date:e[r],formatted:s.format(a),secondary:s.month()!==d.month(),dayOfMonth:s.date(),current:s.isSame(c,"day"),weekend:0===(u=s.day())||6===u},r++;for(p=function(){var i,n,r,o;for(r=e.slice(35),o=[],i=0,n=r.length;i<n;i++)t=r[i],t.secondary||o.push(t.secondary);return o}(),p.length?(l=6,this.fiveRows=!1,this.days=e):(l=5,this.days=e.slice(0,35),this.fiveRows=!0),o=0,this.rows=new Array(l);o<l;)this.rows[o]=this.days.slice(7*o,7*(o+1)),o++;return this.fromDate=this.days[0].date,this.toDate=this.days[this.days.length-1].date,this},e.prototype.getNumOfEventsToShow=function(){var t,e,i,n,o;return n=$(window).height()-50-50,t=r*this.rows.length,e=Math.max(t,n-40)/this.rows.length,i=e-32,o=Math.floor(i/l)},e.prototype.layout=function(){var t;if(t=$(window).height()-50-50,!(t<r*this.rows.length))return this.numOfEventsToShow=this.getNumOfEventsToShow(),this.renderData(),this},e.prototype.openEventOrTaskDetail=function(t){var e,i,n,r,o,s;if(!t.currentTarget)return this;if(e=$(t.currentTarget),s=e.data("type"),i=e.data("id"),e.hasClass("temp"))return!1;if(e.hasClass("invisible"))return!1;switch(s){case"task":E.gta.event({action:"open detail",type:"task"}),E.APP.openTaskPreviewer(i);break;case"event":r=I.find(this.dataToShow,function(t){return t._id===i}),n=24===r._id.length?r:I.extend({},r,{_id:r._originEventId}),o=new d(n,{bindByMatrix:!1}),o.collection=this.eventsCollection,E.gta.event({action:"open detail",type:"event"}),E.APP.openEventPreviewer(o)}return this},e.prototype.getEventsDuaration=function(t,e){var i;return i=e.diff(t,"day"),i+1},e.prototype.showTasks=function(t){return this.shouldShowTasks=t,this.assembleData(function(t){return function(){return t.renderData()}}(this))},e.prototype.showEvents=function(t){return this.shouldShowEvents=t,this.assembleData(function(t){return function(){return t.renderData()}}(this))},e.prototype.onCurrentDayChange=function(){return this.currentDay=N.instance.getCurrentDay(),this.renderBasic().highlightToday(300)},e.prototype.highlightToday=function(t){var e,i,n,r,o,s,c,l,p;for(l=z(),n=null,s=this.days,i=r=0,o=s.length;r<o;i=++r)e=s[i],l.format(a)===e.formatted&&(n=i);if(null!=n)return c=Math.floor(n/7),p=this.$(".month-row").height()*c,t?setTimeout(function(t){return function(){return t.$(".calendar-month-body").animate({scrollTop:p},200)}}(this),t):this.$(".calendar-month-body").animate({scrollTop:p},200)},e.prototype.openEventListPopover=function(t){var e,i,n,r,o;if(null!=(o=this.eventListView)&&o.remove(),t.currentTarget)return e=$(t.currentTarget),r=e.data("date"),i=this.dumbEvents[r],n=z(r,a),this.eventListView=this.requestSubView(u,{openDetail:this.openEventOrTaskDetail.bind(this),data:i,fixed:!0,$toggler:e,hideDelay:0,popoverTitle:n.format("ddd, MMM D, YYYY"),allMembers:this.allMembers}).show(),this},e.prototype.addNewTaskOrEvent=function(t){var e,i,n,r,o,s,c,l;return e=$(t.target),(n=e.find(".total").data("date"))?(i=z(n,a),l=new Date(i.year(),i.month(),i.date(),z().hour()).toISOString(),(null!=(r=this.typeMenu)&&null!=(o=r.$popover)?o.length:void 0)?(this.typeMenu.remove(),this.isAdding&&(this.isAdding=null,this.renderData()),this):this.eventListView&&this.eventListView.$popover&&!this.eventListView.$popover.is(":hidden")?this:(null!=(s=E.APP.panelView)?s.isIn:void 0)?this:(null!=(c=this.typeMenu)&&c.remove(),this.typeMenu=this.requestSubView(b,{$toggler:e,hideDelay:0,ListTemplate:v,placement:function(){var t;return 0===(t=i.day())||6===t?"left":"right"},dataList:[{_id:0,title:tb_i18n.get("create.task")},{_id:1,title:tb_i18n.get("create.event")}],onHidden:function(t){return function(){return t.isAdding=null,t.renderData()}}(this),select:function(t){return function(e){return 0===e?t.openTaskCreator(l):t.openEventCreator(l),t.typeMenu.remove()}}(this)}).show(),this.isAdding=n,this.renderData(),this)):this},e.prototype.openTaskCreator=function(t){return this.requestSubView(S).open(_,{dueDate:t,tasksCollection:this.tasksCollection,onClose:function(t){return function(){return t.isAdding=null,t.assembleData(function(){return t.renderData()})}}(this)})},e.prototype.openEventCreator=function(t){return this.requestSubView(S).open(p,{startDate:t,endDate:z(t).add(1,"hours").toISOString(),eventsCollection:this.eventsCollection,onClose:function(t){return function(){return t.isAdding=null,t.assembleData(function(){return t.renderData()})}}(this)}),this},e.prototype.setWidth=function(){return this.$el.css("left",N.instance.getShowFilter()?f:0)},e.prototype.onUpdateSelects=function(){return this.selectedMemberIds=N.instance.getSelectsIdsWithType(T),this.selectedProjectIds=N.instance.getSelectsIdsWithType(y),this.refreshData()},e.prototype.onTableFilterChange=function(){var t,e;if(e=N.instance.getTableFilterWithKey(w),t=N.instance.getTableFilterWithKey(c),this.shouldShowTasks!==e&&this.showTasks(e),this.shouldShowEvents!==t)return this.showEvents(t)},e}(C)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="calendar-month-inner"> <div class="calendar-month-header"> ',n=t.weekdays;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <div class="week-name ',5!=o&&6!=o||(i+="weekend"),i+='">'+e(r)+"</div> ";i+=' </div> <div class="calendar-month-body thin-scroll"> ';var a=t.rows;if(a)for(var c,l=-1,p=a.length-1;l<p;){c=a[l+=1],i+=' <div class="month-row ',t.fiveRows||(i+="six"),i+=' thin-scroll"> ';var u=c;if(u)for(var d,h=-1,m=u.length-1;h<m;)d=u[h+=1],i+=' <div class="month-day ',d.secondary&&(i+="secondary"),i+=" ",d.current&&(i+="current"),i+=" ",d.weekend&&(i+="weekend"),i+='"> <div class="date">'+e(d.dayOfMonth)+'</div> <a class="total" data-date="'+e(d.formatted)+'"></a> </div> ';i+=" </div> "}return i+=' <div class="month-events thin-scroll ',t.fiveRows||(i+="six"),i+='"></div> </div></div>'}},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty,p=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};s=i(358),a=i(678),o=i(813),n=i(1441),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.viewName="EventListPopoverView",e.prototype.className="event-list-popover-view",e.prototype.events={"click .event":"openEventOrTaskDetail"},e.prototype.initialize=function(t){return this.options=t||{},this.popoverTitle=t.popoverTitle,this.allMembers=this.options.allMembers,e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){var t;return t=this.setInvisibleEventContent(this.options.data),this.$el.html(n({data:t})),this},e.prototype.setInvisibleEventContent=function(t){var e;return e=[],s.each(t,function(t){return function(i){var n,r,o;return i.invisible&&(n=s.pluck(s.filter(t.allMembers,function(t){var e;return e=t._id,p.call(i.involveMembers,e)>=0}),"name"),o=n.length,r=n[0],n.length>1?i.title=tb_i18n.get("calendar.invisivle.event.tip1",r,o):i.title=tb_i18n.get("calendar.invisivle.event.tip2",r),i.tooltip=n.join(",")),e.push(i)}}(this)),e},e.prototype.openEventOrTaskDetail=function(t){if(t.currentTarget)return this.options.openDetail(t),this.remove(),this},e}(o)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<ul class="event-list"> ',n=t.data;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li class="event flex-horiz flex-vcenter ',r.invisible&&(i+="invisible hinted"),i+=" ",r.isCrossday&&(i+="multi"),i+=" ",r.isAllday&&(i+="all-day"),i+='" data-id="'+e(r._id)+'" data-type="',i+=r.isEvent?"event":"task",i+='" data-title="'+r.tooltip+'"> <span class="title flex-fill">'+e(r.title)+"</span> ",r.isEvent?(i+=" ",r.isAllday||(i+='<span class="time flex-static">'+e(r.startTime)+"</span>"),i+=" "):(i+=' <span class="avatar no-avatar flex-static" ',r.avatarUrl&&(i+='style="background-image: url('+r.avatarUrl+');"'),i+="></span> "),i+=" </li> ";return i+="</ul>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},v={}.hasOwnProperty;m=i(678),f=i(1431),h=i(1426),o=i(1427),u=i(788),a=i(1443),n=i(1444),d=o.SELECTS_TYPES,p=d.USER,l=d.PROJECT,s=o.FILTER_VIEW_WIDTH,c=o.MIN_SUBSCRIBERS_LENGTH,t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.viewName="CalendarFilterView",e.prototype.className="calendar-filter-view",e.prototype.events={"blur .search-form-input":"onBlurSearchForm","click .cell-item":"onSelect","click .btn-delete":"onDeleteSubscriber","click .btn-open-subscriber":"onOpenSubscriberModel","focus .search-form-input":"onFocusSearchForm","input .search-form-input":"onSearch"},e.prototype.initialize=function(t){return this.options=t||{},this.status="initial",this.setWidth(),this.renderBefore()},e.prototype.update=function(t){return this.calendarModel=t.calendarModel,this.status="ready",this.listen(),this.renderBasic()},e.prototype.listen=function(){return this.listenTo(this.calendarModel,"change",function(t){return function(){return t.renderList()}}(this))},e.prototype.setWidth=function(){return this.$el.css("left",h.instance.getShowFilter()?0:-s)},e.prototype.onBlurSearchForm=function(){var t;return t=this.$(".calendar-filter-search-form"),t.removeClass("focus")},e.prototype.onFocusSearchForm=function(){var t;return t=this.$(".calendar-filter-search-form"),t.addClass("focus")},e.prototype.onSelect=function(t){var e,i,n,r,o,s;return e=$(t.currentTarget),o=e.data("id"),s=e.data("type"),r=h.instance.getSelects(),n=function(t){switch(t){case!0:return function(t){return t.id===o};case!1:return function(t){return t.id!==o}}},i=r.some(n(!0))?r.filter(n(!1)):r.concat([{id:o,type:s}]),h.instance.setSelects(i),this.renderList(),this.parentView.onUpdateSelects()},e.prototype.onSearch=function(t){var e;return e=f.searchIdByString($(t.target).val(),this.calendarModel.getFlatten()),this.$(".filter-list-cell").each(function(t,i){var n,r;return n=$(i),r=n.data("id"),~e.indexOf(r)?n.show():n.hide()})},e.prototype.onDeleteSubscriber=function(t){var e,i,n,r,o;switch(t.stopPropagation(),i=$(t.currentTarget),e=i.parent(),r=i.data("id"),o=i.data("type"),n={},o){case p:n.$del={"body.users":[r]};break;case l:n.$del={"body.projects":[r]}}return e.hide(),this.calendarModel.update(n).then(function(t){return function(){var i;if(e.remove(),i=function(t){return t.id===r},h.instance.getSelects().some(i))return h.instance.deleteSelects(r),t.parentView.onUpdateSelects()}}(this))["catch"](function(){return e.show()}),m.gta.event({action:"remove subscribe",control:"calendar button"})},e.prototype.onOpenSubscriberModel=function(){return this.parentView.onOpenSubscriberModel()},e.prototype.onRefreshList=function(){return this.renderList()},e.prototype.renderBefore=function(){var t;return this.$el.html(n()),t=this.$(".calendar-filter-list"),this.showLoadingIndicator(t)},e.prototype.renderBasic=function(){var t;return t=this.$(".calendar-filter-list"),this.hideLoadingIndicator(t),this.renderPlaceholder(),this.renderList()},e.prototype.renderList=function(){var t;if("ready"===this.status)return t=this.$(".calendar-filter-list"),t.html(a({me:m.user.get("_id"),users:this.calendarModel.get("body").users,projects:this.calendarModel.get("body").projects,selectesIds:h.instance.getSelectsIds(),USER:p,PROJECT:l}))},e.prototype.renderPlaceholder=function(){
var t;return t=this.$(".calendar-filter-placeholder"),this.calendarModel.getFlatten().length<=c?t.show():t.hide()},e}(u)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<ul class="filter-list"> ',n=t.users;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='  <li class="filter-list-cell" data-id="'+r._id+'"> ',t.me!==r._id&&(i+=' <button class="btn-delete" data-id="'+r._id+'" data-type="'+t.USER+'"> <i class="icon icon-remove"></i> </button> '),i+=' <a class="cell-item" data-id="'+r._id+'" data-type="'+t.USER+"\" data-gta=\"{action: 'toggle calendar display', type: 'user', control: 'calendar name list'}\"> <i class=\"cell-avatar circle no-avatar\"",r.avatarUrl&&(i+=' style="background-image:url('+r.avatarUrl+');"'),i+='></i> <span class="cell-name">'+e(r.name),t.me===r._id&&(i+=" ("+tb_i18n.get("me")+")"),i+="</span> ",~t.selectesIds.indexOf(r._id)&&(i+=' <i class="cell-selected icon icon-tick"></i> '),i+=" </a> </li> ";i+=" ";var a=t.projects;if(a)for(var c,l=-1,p=a.length-1;l<p;)c=a[l+=1],i+='  <li class="filter-list-cell" data-id="'+c._id+'"> <button class="btn-delete" data-id="'+c._id+'" data-type="'+t.PROJECT+'"> <i class="icon icon-remove"></i> </button> <a class="cell-item" data-id="'+c._id+'" data-type="'+t.PROJECT+"\" data-gta=\"{action: 'toggle calendar display', type: 'project', control: 'calendar name list'}\"> <i class=\"cell-avatar square no-avatar\"",c.logo&&(i+=' style="background-image:url('+c.logo+');"'),i+='></i> <span class="cell-name">'+e(c.name)+"</span> ",~t.selectesIds.indexOf(c._id)&&(i+=' <i class="cell-selected icon icon-tick"></i> '),i+=" </a> </li> ";return i+="</ul>"}},function(t,e){t.exports=function(t){var e='<div class="calendar-filter-search-form"> <i class="icon icon-search"></i> <input class="search-form-input" type="search" placeholder="'+tb_i18n.get("calendar.search.subscriber")+'" /></div><div class="calendar-filter-list thin-scroll"> <!-- ./list.html --></div><div class="calendar-filter-action"> <center><p class="calendar-filter-placeholder">'+tb_i18n.get("calendar.subscriber.is.empty")+'</p></center> <button class="btn-open-subscriber" data-gta="{action: \'begin add subscribe\', control: \'calendar button\'}"> <i class="icon icon-circle-cross"></i> <span>'+tb_i18n.get("calendar.add.subscriber")+"</span> </button></div>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b=function(t,e){function i(){this.constructor=t}for(var n in e)k.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},k={}.hasOwnProperty;m=i(429),y=i(1431),v=i(1426),o=i(1427),f=o.TABLE_MODE,d=f.WEEK,a=f.MONTH,g=o.TABLE_FILTERS,c=g.TASK,s=g.EVENT,h=g.WEEKEND,u=i(788),n=i(1446),p=i(1447),l=i(1448),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.viewName="CalendarHeaderView",e.prototype.className="calendar-header-view",e.prototype.events={"click .btn-table-mode":"onChangeTableMode","click .btn-today":"onGotoToday","click .btn-anchor":"onChangeCurrentDay","click .btn-option":"onChangeTableFilter","click .btn-toggle-filter":"onToggleShowFilterButton"},e.prototype.initialize=function(t){return this.options=t||{},this.currentDay=v.instance.getCurrentDay(),this.renderBasic()},e.prototype.onChangeTableMode=function(t){var e,i;if(e=$(t.currentTarget),i=e.data("mode"),i!==v.instance.getTableMode())return v.instance.setTableMode(i),this.renderTableMode(),this.parentView.onChangeTableMode()},e.prototype.onChangeTableFilter=function(t){var e,i;return e=$(t.currentTarget),i=e.data("key"),v.instance.setTableFilterWithKey(i),this.renderTableFilter(),this.parentView.onChangeTableFilter()},e.prototype.onChangeCurrentDay=function(t){var e,i,n;switch(e=$(t.currentTarget),n=v.instance.getTableMode(),i=e.data("period")){case"prev":this.currentDay=y.changeTime("subtract",this.currentDay,n);break;case"next":this.currentDay=y.changeTime("add",this.currentDay,n)}return v.instance.setCurrentDay(this.currentDay),this.renderCurrentDay(),this.parentView.onChangeCurrentDay()},e.prototype.onGotoToday=function(){if(!y.isToday(this.currentDay))return this.currentDay=m(),v.instance.setCurrentDay(this.currentDay),this.renderCurrentDay(),this.parentView.onChangeCurrentDay(this.currentDay)},e.prototype.onToggleShowFilterButton=function(){var t;return t=v.instance.getShowFilter(),v.instance.setShowFilter(!t),this.renderShowFilterButton(),this.parentView.onToggleShowFilterButton()},e.prototype.renderBasic=function(){return this.$el.html(n()),this.renderCurrentDay(),this.renderShowFilterButton(),this.renderTableFilter(),this.renderTableMode()},e.prototype.renderCurrentDay=function(){var t,e,i,n;return n=m(this.currentDay),e=this.$(".current-day"),t=this.$(".btn-today"),y.isToday(n)?t.addClass("active"):t.removeClass("active"),i="en"===tb_i18n.getLanguage()?n.format("MMM, YYYY"):n.format(tb_i18n.get("moment.MMMMYYYY")),e.html(i)},e.prototype.renderShowFilterButton=function(){var t;return t=this.$(".btn-toggle-filter"),v.instance.getShowFilter()?t.addClass("active"):t.removeClass("active")},e.prototype.renderTableMode=function(){var t;return t=this.$(".calendar-table-modes"),t.html(p({target:v.instance.getTableMode(),WEEK:d,MONTH:a}))},e.prototype.renderTableFilter=function(){var t;return t=this.$(".calendar-header-right"),t.html(l({target:v.instance.getTableFilter(),TASK:c,EVENT:s}))},e}(u)},function(t,e){t.exports=function(t){var e='<div class="calendar-header-left"> <span class="btn-group"> <a class="btn-toggler btn-toggle-filter"> <i class="icon icon-menu"></i> </a> </span> <span class="btn-group tab-style calendar-table-modes"> <!-- ./table-mode.html --> </span> <span class="btn-group"> <a class="btn-toggler btn-today"> '+tb_i18n.get("today")+' </a> </span></div><div class="calendar-header-center"> <a class="btn-anchor" data-period="prev"> <i class="icon icon-chevron-left"></i> </a> <span class="current-day"></span> <a class="btn-anchor" data-period="next"> <i class="icon icon-chevron-right"></i> </a></div><div class="calendar-header-right"> <!-- "./show-option.html" --></div>';return e}},function(t,e){t.exports=function(t){var e='<a class="btn-toggler btn-table-mode';return t.target===t.WEEK&&(e+=" active"),e+='" data-mode="'+t.WEEK+'"> '+tb_i18n.get("week")+'</a><a class="btn-toggler btn-table-mode',t.target===t.MONTH&&(e+=" active"),e+='" data-mode="'+t.MONTH+'"> '+tb_i18n.get("month")+"</a>"}},function(t,e){t.exports=function(t){var e='<a class="btn-checkbox btn-option ';return t.target[t.TASK]&&(e+="is-checked"),e+='" data-key="'+t.TASK+'"> <div class="check-box"> <i class="icon icon-tick"></i> </div> <span>'+tb_i18n.get("calendar.show.task")+'</span></a><a class="btn-checkbox btn-option ',t.target[t.EVENT]&&(e+="is-checked"),e+='" data-key="'+t.EVENT+'"> <div class="check-box"> <i class="icon icon-tick"></i> </div> <span>'+tb_i18n.get("calendar.show.event")+"</span></a>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},v={}.hasOwnProperty,y=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};p=i(358),l=i(788),m=i(678),f=i(1431),d=i(1425),h=i(1426),o=i(1427),c=i(1450),n=i(1451),a=i(1452),s=i(1453),u=function(t){var e,i;return i="",t&&(e=function(t,i,n){return null==i&&(i=[]),null==n&&(n=0),t.parent?(n>0&&(i=[t.name].concat(i)),e(t.parent,i,n+1)):i.join(" > ")},i=e(t)),i},t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.viewName="CalendarSubscriberView",e.prototype.className="calendar-subscriber-view",e.prototype.events={"click .add-handler":"onAdd","click .close-handler":"onClose","click .tab-item":"onSwitchTab","keyup .search-input":"onStartSearch","blur .search-input":"onBlurSearch","focus .search-input":"onFocusSearch"},e.prototype.initialize=function(t){var e;return null==t&&(t={}),this.options=t,this.tabs=[{key:"recommend",iconName:"dig-line",text:tb_i18n.get("calendar.subscriber.tab.recommend")},{key:"member",iconName:"user",text:tb_i18n.get("calendar.subscriber.tab.member")},{key:"project",iconName:"project",text:tb_i18n.get("calendar.subscriber.tab.project")},{key:"team",iconName:"users",text:tb_i18n.get("calendar.subscriber.tab.team")}],this.activeTab=this.options.activeTab||"recommend",this.calendarModel=this.options.calendarModel,this.originSelectsIds=this.options.originSelectsIds,this.onCloseFn=this.options.onClose,this.onRefreshList=this.options.onRefreshList,this.renderBefore(),e=this.$(".panel-right"),this.showLoadingIndicator(e),this.fetchAll().then(function(t){return function(){return t.hideLoadingIndicator(e),t.render()}}(this))["catch"](function(t){return function(){return t.hideLoadingIndicator(e),t.renderError()}}(this)),this.onSearch=p.debounce(this.onSearch,100)},e.prototype.fetchAll=function(){return Promise.all([this.fetchOrganizations(),this.fetchProjects(),this.fetchRecommenMembers(),this.fetchRelativeMembers(),this.fetchRelativeTeams()])},e.prototype.fetchOrganizations=function(){return d.getOrganizations().then(function(t){return function(e){return t.organizations=e}}(this))},e.prototype.fetchProjects=function(){return d.getProjects().then(function(t){return function(e){return t.projects=e}}(this))},e.prototype.fetchRecommenMembers=function(){return d.getRecommendMembers().then(function(t){return function(e){return t.recommendMembers=e}}(this))},e.prototype.fetchRelativeMembers=function(){return d.getRelativeMembers().then(function(t){return function(e){return t.relativeMembers=e}}(this))},e.prototype.fetchRelativeTeams=function(){return d.getRelativeTeams().then(function(t){return function(e){return t.relativeTeams=e}}(this))},e.prototype.getResults=function(t){var e,i,n,r,o,s;switch(null==t&&(t=""),s=function(t){return t.toJSON()},e=function(t){return function(e){return p.extend({},e,{displayType:t})}},n=function(t){return function(i,n){var r,o;return r=function(t){return t._organizationId},o=p.groupBy(i,r),t.organizations.toJSON().map(function(t){var i;return(null!=(i=o[t._id])?i.length:void 0)>0?{data:o[t._id].map(e(n)),text:t.name}:null}).filter(function(t){return null!=t})}}(this),r=function(t){return function(){var e;return e=t.projects.getInvolvedOrganizationProjects().map(s),n(e,"project")}}(this),o=function(t){return function(){var e;return e=t.relativeTeams.getNoneDefaultTeams().map(s).map(function(t){return p.extend({},t,{icon:t.style.split(",")[0]||"",color:t.style.split(",")[1]||"",belongsTo:u(t)})}),n(e,"team")}}(this),this.activeTab){case"recommend":i=o().concat([{data:this.recommendMembers.toJSON().map(e("member")),text:tb_i18n.get("calendar.subscriber.display.title.recommend.members")},{data:this.projects.getInvolvedStarProjects().map(s).map(e("project")),text:tb_i18n.get("calendar.subscriber.display.title.starred.projects")}]);break;case"member":i=[{data:this.relativeMembers.toJSON().map(e("member"))}];break;case"project":i=[{data:this.projects.getInvolvedStarProjects().map(s).map(e("project")),text:tb_i18n.get("calendar.subscriber.display.title.starred.projects")},{data:this.projects.getSelfProject().map(s).map(e("project")),text:tb_i18n.get("calendar.subscriber.display.title.self.projects")}].concat(r());break;case"team":i=o()}return t.length>0&&(i=i.map(function(e){return p.extend({},e,{data:f.searchByString(t,e.data)})})),i},e.prototype.getSearchStatus=function(){switch(this.activeTab){case"recommend":return!1;default:return!0}},e.prototype.getSearchPlaceholder=function(){switch(this.activeTab){case"member":return tb_i18n.get("calendar.subscriber.search.placeholder.member");case"project":return tb_i18n.get("calendar.subscriber.search.placeholder.project");case"team":return tb_i18n.get("calendar.subscriber.search.placeholder.team");default:return""}},e.prototype.onAdd=function(t){var e,i,n,r,o,s,a,c;switch(i=$(t.currentTarget),e=i.parent(),s=i.data("id"),c=i.data("type"),r={action:"added subscriber",control:this.activeTab,type:c},n={},c){case"team":a=this.relativeTeams.getTeamById(s).get("hasMembers").map(function(t){return t._id}),n.$add={"body.users":a};break;case"user":a=[s],n.$add={"body.users":a};break;case"project":a=[s],n.$add={"body.projects":a}}return m.gta.event(r),o="<span>"+tb_i18n.get("added")+"</span>",e.html(o),this.calendarModel.update(n).then(function(t){return function(){var e,i,n;return n=h.instance.getSelects(),i=function(t){return function(e){return e.id===t}},e=a.reduce(function(t,e){return t.some(i(e))||("team"===c&&(c="user"),t=t.concat({id:e,type:c})),t},n),h.instance.setSelects(e),t.onRefreshList()}}(this))["catch"](function(){return o='<a class="add-handler" data-id='+s+" data-type="+c+">"+tb_i18n.get("add")+"</a>",e.html(o)})},e.prototype.onClose=function(){var t,e;return e=function(t){return function(e){return y.call(t.options.originSelectsIds,e)>=0}}(this),t=h.instance.getSelectsIds(),t.every(e)||this.onCloseFn(),this.parentView.close()},e.prototype.onBlurSearch=function(){return this.$(".search-container").removeClass("is-active")},e.prototype.onFocusSearch=function(){return this.$(".search-container").addClass("is-active")},e.prototype.onSwitchTab=function(t){var e;if(e=$(t.currentTarget).data("tab"),this.activeTab!==e)return this.activeTab=e,this.onUpdateTabItems(),this.onUpdatePanelRight()},e.prototype.onStartSearch=function(t){var e;return e=$(t.currentTarget).val(),this.onSearch(e)},e.prototype.onSearch=function(t){var e;return e=this.getResults(t),this.renderResultList(e)},e.prototype.onUpdateTabItems=function(){var t;return t=this.$(".tab-item"),t.each(function(t){return function(e,i){var n;return n=$(i),n.data("tab")===t.activeTab?n.addClass("is-active"):n.removeClass("is-active")}}(this))},e.prototype.onUpdatePanelRight=function(){var t,e,i;return t=this.getResults(),i=this.getSearchStatus(),e=this.getSearchPlaceholder(),this.renderResult(t,i,e)},e.prototype.renderBefore=function(){return this.$el.html(n()),this.renderTabs()},e.prototype.renderError=function(){},e.prototype.render=function(){var t,e,i;return t=this.getResults(),i=this.getSearchStatus(),e=this.getSearchPlaceholder(),this.renderResult(t,i,e)},e.prototype.renderTabs=function(){var t;return t=this.$(".panel-left"),t.html(c({tabs:this.tabs,activeTab:this.activeTab}))},e.prototype.renderResult=function(t,e,i){return this.renderResultBasic(e,i),this.renderResultList(t)},e.prototype.renderResultBasic=function(t,e){var i;return i=this.$(".panel-right"),i.html(a({hasEnableSearch:t,searchPlaceholder:e}))},e.prototype.renderResultList=function(t){var e,i,n,r;return i=function(t,e){return t+e.data.length},r=t.reduce(i,0),e=this.$(".result-content"),n=0===r?{isEmpty:!0}:{results:t,selectedUsers:this.calendarModel.get("body").users.map(function(t){return t._id}),selectedProjects:this.calendarModel.get("body").projects.map(function(t){return t._id})},e.html(s(n))},e}(l)},function(t,e){t.exports=function(t){var e='<ul class="tab-list"> ',i=t.tabs;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <li class="tab-cell"> <a class="tab-item',t.activeTab===n.key&&(e+=" is-active"),e+='" data-tab="'+n.key+'"> <span class="icon icon-'+n.iconName+'"></span> <span class="text">'+n.text+"</span> </a> </li> ";return e+="</ul>"}},function(t,e){t.exports=function(t){var e='<div class="calendar-subscriber-view-header"> <div class="title"><center>'+tb_i18n.get("calendar.subscriber.title")+'</center></div> <a class="close-handler"> <span class="icon icon-remove"></span> </a></div><div class="calendar-subscriber-view-body"> <div class="panel-left"></div> <div class="panel-right"></div></div>';return e}},function(t,e){t.exports=function(t){var e='<div class="results-container"> ';return t.hasEnableSearch&&(e+=' <div class="search-container"> <span class="icon icon-search"></span> <input class="search-input" type="text" placeholder="'+t.searchPlaceholder+'"> </div> '),e+=' <div class="result-content thin-scroll"> </div></div>'}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="";if(t.isEmpty)i+=' <div class="empty-indicator"> <center>'+tb_i18n.get("calendar.search.no.result")+"</center> </div>";else{i+=" ";var n=t.results;if(n)for(var r,o=-1,s=n.length-1;o<s;){if(r=n[o+=1],i+=" ",r.data&&r.data.length>0){i+=" ",r.text&&r.text.length>0&&(i+=' <div class="result-title">'+r.text+"</div> "),i+=' <ul class="result-list"> ';var a=r.data;if(a)for(var c,l=-1,p=a.length-1;l<p;)c=a[l+=1],i+=" ","member"===c.displayType?(i+='  <li class="result-cell"> <span class="cell-avatar circle no-avatar"',c.avatarUrl&&c.avatarUrl.length>0&&(i+=' style="background-image: url('+c.avatarUrl+')"'),i+='></span> <div class="cell-content"> ',c.name&&c.name.length>0&&(i+=' <span class="cell-title">'+e(c.name)+"</span> "),i+=" ",c.title&&c.title.length>0&&(i+=' <span class="cell-subtitle">'+e(c.title)+"</span> "),i+=' </div> <div class="cell-handlers"> ',i+=~t.selectedUsers.indexOf(c._id)?" <span>"+tb_i18n.get("added")+"</span> ":' <a class="add-handler" data-id='+c._id+' data-type="user">'+tb_i18n.get("add")+"</a> ",i+=" </div> </li> "):"project"===c.displayType?(i+='  <li class="result-cell"> <span class="cell-avatar square"',c.logo&&c.logo.length>0&&(i+=' style="background-image: url('+c.logo+')"'),i+='></span> <div class="cell-content"> ',c.name&&c.name.length>0&&(i+=' <span class="cell-title">'+e(c.name)+"</span> "),i+=' </div> <div class="cell-handlers"> ',i+=~t.selectedProjects.indexOf(c._id)?" <span>"+tb_i18n.get("added")+"</span> ":' <a class="add-handler" data-id='+c._id+' data-type="project">'+tb_i18n.get("add")+"</a> ",i+=" </div> </li> "):"team"===c.displayType&&(i+='  <li class="result-cell"> <span class="cell-icon icon icon- ',i+="default"!==c.type&&c.icon&&c.icon.length>0?" "+c.icon+" ":" icon-team-tie ",i+='"  ',i+="default"===c.type?' style="border-color: #03A9F4; color: #03A9F4" ':c.color&&c.color.length>0?' style="border-color: '+c.color+"; color: "+c.color+'" ':' style="border-color: #8193BA; color: #8193BA" ',i+='> </span> <div class="cell-content"> ',c.name&&c.name.length>0&&(i+=' <span class="cell-title"> '+e(c.name)+"・"+c.hasMembers.length+" </span> "),i+=" ",c.belongsTo&&c.belongsTo.length>0&&(i+=' <span class="cell-subtitle"> '+tb_i18n.get("team.belongsTo",c.belongsTo)+" </span> "),i+=' </div> <div class="cell-handlers"> ',i+=c.hasMembers.some(function(e){return!~t.selectedUsers.indexOf(e._id)})?' <a class="add-handler" data-id='+c._id+' data-type="team">'+tb_i18n.get("add")+"</a> ":" <span>"+tb_i18n.get("added")+"</span> ",i+=" </div> </li> "),i+=" ";i+=" </ul> "}i+=" "}}return i}},function(t,e){t.exports=function(t){var e='<div class="slide-view-wrapper" id="slide-view-wrapper"></div>';return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S,I,z,P,D,O,N=function(t,e){function i(){this.constructor=t}for(var n in e)E.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},E={}.hasOwnProperty;z=i(358),O=i(678),P=i(679),p=i(429),_=i(681),C=i(677),x=i(788),a=i(680),m=i(684),y=i(696),s=i(1456),d=i(1341),h=i(1458),v=i(1460),M=i(1385),T=i(1001),o=i(1071),f=i(1043),I=i(1063),k=i(1468),l=i(1483),c=i(1484),S=i(786),w=i(1469),j=i(1487),g=i(1489),r=i(1492),n=i(1494),D=_.namespace("temp").namespace("navigation_task_badge"),b="on-search-active",t.exports=u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return N(e,t),e.prototype.viewName="NavigationView",e.prototype.className="navigation-view nav-inner row-flex",e.prototype.$parent=$("#navigator"),e.prototype.events={"click .logo":"enterProjects","click .projects-handler":"returnProjects","click .organization-switcher-handler":"toggleOrganizationSwitcher","click .my-handler":"enterMy","click .calendar-handler":"enterCalendar","click .inbox-handler":"enterInbox","click .nav-footer-handler[data-mark=help]":"toggleSubmitTicket","shown.bs.dropdown":"hideSubmitTicket","click .nav-footer-handler[data-mark=search]":"toggleSearch","click .navigation-search-layer":"hideSearch","input .nav-search-input":"openSearchPopover","keydown .nav-search-input":"onSearchInputKeyDown","click .new-ribbon":"updateUserPreference","click .my-settings-handler":"showUserSettings","click .hotkey-handler":"showHotkeys","click .login-handler":"loginHandler","click .register-handler":"registerHandler","click .logout-handler":"logoutHandler","click .switch-version-handler":"switchVersion","shown.bs.dropdown .user-footer-wrap":"showInternationalTip","click .nav-footer-handler":"initUploader","click .create-project":"openProjectCreator","click .create-organization":"openOrganizationCreator","click .create-task":"openTaskCreator","click .create-event":"openEventCreator","click .create-sharing":"openSharingCreator","click .nav-footer-handler[data-mark=chat]":"onToggleChatView"},e.prototype.initialize=function(){var t;return this.projectsCollection=y.get(0),this.$parent.html(this.$el),this.renderBasic().listen(),t=O.user.toJSON(),t.isGhost?this:(O.user.fetchTodayTasks(),P.FEATURES.userMenu_international&&O.ab.hasTest("international")&&O.user.fetchCrossNotify(),z.delay(function(t){return function(){return t.refreshTasksBadge(),t.refreshNormalBadge(),t.refreshPrivateBadge()}}(this),100),this)},e.prototype.listen=function(){return this.listenTo(O.user,"change:name change:avatarUrl change:crossNotify",this.renderBasic),this.listenTo(O.user,"change:normal",this.refreshNormalBadge),this.listenTo(O.user,"change:private",this.refreshPrivateBadge),this.listenTo(O.user,"change:todayTasks",this.refreshTasksBadge),this.listenTo(O.PREFERENCE,"change:hasNew",this.refreshNew),this.listenTo(this.projectsCollection,"add",function(){if(1===this.projectsCollection.length)return this.renderBasic()}),this.listenTo(this.projectsCollection,"remove",function(){if(0===this.projectsCollection.length)return this.renderBasic()}),window.clearInterval(this.holidayLoop),this.holidayLoop=window.setInterval(function(t){return function(){return t.refreshHoliday()}}(this),36e5),this},e.prototype.renderBasic=function(){var t,e;return t=O.user.getPaymentPlan(),e=z.extend(O.user.toJSON(),{logo:C.getHoliday()||"logo",siteHost:P.SITE_HOST,accountHost:P.ACCOUNT_HOST,isExpiring:t.isExpiring||t.isOverdue,language:tb_i18n.getLanguage(),hasNewVersion:this.hasNewVersion(),hasProject:this.projectsCollection.length}),this.$el.html(n(e)),this.$messageBadge=this.$(".nav-badge[data-mark=message]"),this.$tasksBadge=this.$(".nav-badge[data-mark=task]"),this.$myHandler=this.$(".my-handler"),this.$inboxHandler=this.$(".inbox-handler"),this.$search=this.$(".nav-search"),this.$searchInput=this.$(".nav-search-input"),this},e.prototype.refreshNormalBadge=function(){var t,e;return t=O.user.get("normal"),this.$messageBadge.text(t||""),O.favico.inbox_count=0|t,(null!=(e=O.favico)?e.browser.supported:void 0)||O.APP.dynamicTitle(),this},e.prototype.refreshTasksBadge=function(){var t,e,i;return i=D(O.user.id),e=p(),O.user.isNew()||i&&e.isSame(i,"day")?this.$tasksBadge.text(""):(t=O.user.get("todayTasks"),this.$tasksBadge.text(t||"")),this},e.prototype.refreshHoliday=function(){var t,e;return t=C.getHoliday(),e=t?"on-"+t:"",this.$(".logo").attr("class","logo "+e)},e.prototype.hasNewVersion=function(){return O.PREFERENCE.get("hasNew")===!0&&!O.user.isNew()},e.prototype.refreshNew=function(){return this.hasNewVersion()?this.$(".new-ribbon").show():this.$(".new-ribbon").hide(),this},e.prototype.enterProjects=function(){return O.user.get("isGhost")?O.router.gotoTeambition():(O.APP.Float.close(),O.router.navigate("projects",{trigger:!0}),this)},e.prototype.returnProjects=function(t){return O.APP.Float.currentView?O.APP.Float.close():this.enterProjects(),this},e.prototype.toggleOrganizationSwitcher=function(t){return this.organizationSwitcherView||(this.organizationSwitcherView=this.requestSubView(h,{$toggler:$(t.currentTarget),organizationsCollection:m.get(0)}).show()),this},e.prototype.enterMy=function(t){var e;return O.user.get("todayTasks")&&(D(O.user.id,p().toISOString()),this.$tasksBadge.text("")),e=O.APP.Float.toggleMy(),e||t.stopPropagation(),this},e.prototype.enterCalendar=function(t){var e;return e=O.APP.Float.toggleCalendar(),e||t.stopPropagation(),this},e.prototype.enterInbox=function(t){var e;return e=O.APP.Float.toggleInbox(),e||t.stopPropagation(),this},e.prototype.toggleSubmitTicket=function(t){var e,i,n,r;return e=$(t.currentTarget),i=m.get(0).any(function(t){var e;return e=t.getPaymentPlan(),"paid"===e.status&&!e.isOverdue}),e.data("bs.popover")||(null!=(r=this.submitTicketView)&&r.remove(),n=i?g:j,this.submitTicketView=this.requestSubView(n,{$toggler:e,fixed:!0}).show()),this},e.prototype.hideSubmitTicket=function(){var t;return null!=(t=this.submitTicketView)?t.hide():void 0},e.prototype.toggleSearch=function(t){var e;return this.$el.hasClass(b)?(this.hideSearch(t),e="finish"):(this.showSearch(t),e="begin"),O.gta.event({action:e+" search",control:"Navigation Tab"})},e.prototype.hideSearch=function(t){var e;return this.$el.removeClass(b),null!=(e=this.searchPopView)?e.hide():void 0},e.prototype.showSearch=function(t){var e;return this.$el.addClass(b),e=this.$searchInput.val(""),z.delay(function(){return e.focus()},300)},e.prototype.openSearchPopover=function(t){return this._openSearchPopover||(this._openSearchPopover=z.debounce(function(t){return function(e){var i,n,r;if(i=$(e.currentTarget),n=i.val().trim(),null!=(r=t.searchPopView)&&r.remove(),n&&t.$el.hasClass("on-search-active"))return t.searchPopView=t.requestSubView(k,{$toggler:i,trigger:"manual",query:n,hideDelay:0,width:t.$searchInput.outerWidth(),onSearch:function(){return t.hideSearch()},onSelect:function(){return t.hideSearch()}}).show()}}(this),400)),this.gtaInputMarker||(this.gtaInputMarker=!0,O.gta.event({action:"type search content",type:"all project"})),this._openSearchPopover(t)},e.prototype.onSearchInputKeyDown=function(t){var e,i,n,r,o,s,a,c,l;return i=$(t.currentTarget),(n=i.val().trim())?(13===t.which?(this.hideSearch(),(null!=(o=this.searchPopView)?o.$popover:void 0)&&(e=this.searchPopView.$(".li-item.active")).length?e.click():(null!=(s=O.APP.Float)&&s.open(w,{animateType:"fade",query:n},"search"),null!=(a=this.searchPopView)&&a.remove()),i.blur(),this.gtaInputMarker=!1,O.gta.event({action:"begin full search",type:"all project",method:"keyboard"})):38!==(c=t.which)&&40!==c||(t.preventDefault(),null!=(l=this.searchPopView)&&l.slide(t)),this):null!=(r=this.searchPopView)?r.remove():void 0},e.prototype.switchVersion=function(t){var e,i;if(e=$(null!=t?t.currentTarget:void 0),i=e.data("version"),!e.hasClass("on-active")&&i!==O.env)switch(i){case"br":return O.PREFERENCE.gotoBrEnvironment();case"release":return O.PREFERENCE.gotoReleaseEnvironment()}},e.prototype.updateUserPreference=function(){return this.$(".new-ribbon").hide(),O.PREFERENCE.save(null,{attrs:{hasNew:!1}}),this},e.prototype.showUserSettings=function(t){return this.requestSubView(S).open(M),this},e.prototype.showHotkeys=function(){return this.requestSubView(S).open(s),this},e.prototype.loginHandler=function(t){return O.router.gotoLogin(),this},e.prototype.logoutHandler=function(t){return window.location=P.ACCOUNT_HOST+"/logout",this},e.prototype.registerHandler=function(t){return O.router.gotoRegister(),this},e.prototype.openProjectCreator=function(){return this.requestSubView(S).open(v),this},e.prototype.openOrganizationCreator=function(){return this.requestSubView(S).open(d),this},e.prototype.openTaskCreator=function(){return this.requestSubView(S).open(T)},e.prototype.openEventCreator=function(){return this.requestSubView(S).open(o)},e.prototype.openSharingCreator=function(){return this.requestSubView(S).open(f,{backdrop:"static",gta_from:"Global New Post"})},e.prototype.initUploader=function(t){if(!this._initedUploader)return this._initedUploader=!0,this.requestSubView(I,{isBackground:!0,pick:{id:this.$(".create-file"),multiple:!0},gta_from:"Global New File"})},e.prototype.showInternationalTip=function(t){var e,i;if(e=this.$(".international-wrap"),e.length&&c.isShowTip())return i=this.requestSubView(l),e.append(i.$el)},e.prototype.remove=function(){return e.__super__.remove.apply(this,arguments),window.clearInterval(this.holidayLoop)},e.prototype.onToggleChatView=function(t){return null==this.chatNavPopoverView?(this.chatNavPopoverView=this.requestSubView(r,{$toggler:$(t.currentTarget)}),this.chatNavPopoverView.show()):this.chatNavPopoverView.isHidden?(this.chatNavPopoverView.remove(),this.chatNavPopoverView=this.requestSubView(r,{$toggler:$(t.currentTarget)}),this.chatNavPopoverView.show()):(this.chatNavPopoverView.remove(),this.chatNavPopoverView=null)},e.prototype.refreshPrivateBadge=function(){var t;return t=O.user.get("private"),O.favico.chat_count=0|t,0===t&&(t=""),this.$(".nav-badge[data-mark=chat]").text(t)},e}(x)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;n=i(1457),o=i(788),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.viewName="HotkeyHelperView",e.prototype.className="hotkey-helper modal-dialog card",e.prototype.initialize=function(){return this.renderBasic(),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this},e}(o)},function(t,e){t.exports=function(t){var e='<header class="card-header"> <p class="card-title">'+tb_i18n.get("helper.shortcuts")+'</p> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a></header><div class="hotkey-content"> <h3>'+tb_i18n.get("helper.shortcuts.for.global")+'</h3> <div class="cheat-sheet-part"> <ul class="cheat-sheet-list"> <li> <span class="key">h</span> <span class="function">'+tb_i18n.get("helper.shortcuts.for.global.portal")+'</span> </li> <li> <span class="key">i</span> <span class="function">'+tb_i18n.get("helper.shortcuts.for.global.inbox")+'</span> </li> <li> <span class="key">m</span> <span class="function">'+tb_i18n.get("helper.shortcuts.for.global.myboard")+'</span> </li> <li> <span class="key">s</span> <span class="function">'+tb_i18n.get("helper.shortcuts.for.global.search")+'</span> </li> <li> <span class="key">shift + m</span> <span class="function">'+tb_i18n.get("helper.shortcuts.for.markdown")+"</span> </li> </ul> </div> <h3>"+tb_i18n.get("helper.shortcuts.for.inbox")+'</h3> <div class="cheat-sheet-part"> <ul class="cheat-sheet-list"> <li> <span class="key">j</span> <span class="function">'+tb_i18n.get("helper.shortcuts.for.inbox.next")+'</span> </li> <li> <span class="key">k</span> <span class="function">'+tb_i18n.get("helper.shortcuts.for.inbox.previous")+"</span> </li> </ul> </div> <h3>"+tb_i18n.get("helper.shortcuts.for.wall")+'</h3> <div class="cheat-sheet-part"> <ul class="cheat-sheet-list"> <li> <span class="key">c</span> <span class="function">'+tb_i18n.get("helper.shortcuts.for.wall.new")+"</span> </li> </ul> </div> <h3>"+tb_i18n.get("helper.shortcuts.for.board")+'</h3> <div class="cheat-sheet-part"> <ul class="cheat-sheet-list"> <li> <span class="key">c</span> <span class="function">'+tb_i18n.get("helper.shortcuts.for.board.new")+'</span> </li> <li> <span class="key">g</span> <span class="function">'+tb_i18n.get("helper.shortcuts.for.taskgroup")+"</span> </li> </ul> </div> <h3>"+tb_i18n.get("helper.shortcuts.for.event")+'</h3> <div class="cheat-sheet-part"> <ul class="cheat-sheet-list"> <li> <span class="key">c</span> <span class="function">'+tb_i18n.get("helper.shortcuts.for.event.new")+"</span> </li> </ul> </div></div>";
return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h=function(t,e){function i(){this.constructor=t}for(var n in e)m.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},m={}.hasOwnProperty;u=i(358),d=i(678),n=i(1459),r=i(1341),s=i(813),a=i(696),c=i(797),l=i(677),p=i(786),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.viewName="OrganizationSwitcherView",e.prototype.className="organization-switcher-view",e.prototype.popoverTitle="Menu",e.prototype.width=320,e.prototype.hotkeys={"up|down|enter":"searchOrganizations",esc:function(t){var e;return t.preventDefault(),null!=(e=this.$popover)&&e.parent().trigger("click"),this.hide()}},e.prototype.events={"click .organization-item":"switchOrganization","click .organization-create-handler":"openOrganizationCreator","mousewheel .organization-list":l.mousewheel},e.prototype.render=function(){var t,e,i,o;if(this.options.organizationsCollection)return e=this.options.organizationsCollection.filter(function(t){return t.getRoleScope()>=0}).map(function(t){var e;return e=t.toJSON(),e.isOverdue=t.isOverdue(),e}),0===e.length?(this.requestSubView(p,{cssClass:"enterprise-mask",onRemove:function(t){return function(){return t.hide()}}(this)}).open(r,{backdrop:"static",isAnimation:!1}),this):1===e.length?this.enterOrganizationDirect(e[0]):(this.$el.html(n({organizations:e})),this.$list=this.$(".organization-list"),t=d.router.getUrl().split("/"),this.selectedId=null,"project"===t[0]?(i=a.findOne(0,t[1]),this.selectedId=null!=i?i.get("_organizationId"):void 0):"organization"===t[0]&&(this.selectedId=t[1]),this.selectedId&&(null!=(o=this.options.organizationsCollection.get(this.selectedId))?o.getRoleScope():void 0)>=0||(this.selectedId=null),this.selectedId&&this.$list.find(".organization-item[data-id="+this.selectedId+"]").addClass("selected"),"organization"!==t[0]&&(this.selectedId=null),this.layout(),this.setupScroll(this.$list),this.listenTo(d.router,"route",function(){return this.hide()}),this)},e.prototype.layout=function(){return this.$list.css("maxHeight",Math.max(.7*$(window).height(),300)),this},e.prototype.enterOrganizationDirect=function(t){return d.APP.Float.currentView&&d.APP.Float.close(),d.router.navigate("/organization/"+t._id+"/projects",{trigger:!0}),this},e.prototype.switchOrganization=function(t){var e,i;return e=$(t.currentTarget),i=this.options.organizationsCollection.get(e.data("id")),i&&i.id!==this.selectedId?(this.selectedId=i.id,d.router.navigate("/organization/"+i.id+"/projects",{trigger:!0})):d.APP.Float.close(),this.hide(),this},e.prototype.searchOrganizations=function(t){var e;switch(t.keyCode){case 38:return this.switchActive("up");case 40:return this.switchActive("down");case 13:return e=this.$list.find(".active"),e.length||(e=this.$list.find("li:first")),e.trigger("click")}return this},e.prototype.switchActive=function(t){var e,i,n,r,o;return e=this.$list.find(".active"),e.length||(e=this.$list.find(".selected")),"up"===t&&(o=e.removeClass("active").prevAll(".organization-item:first"),n=this.$list.find("li.organization-item:last"),o.length>0?o.addClass("active"):n.addClass("active")),"down"===t&&(r=e.removeClass("active").nextAll(".organization-item:first"),i=this.$list.find("li.organization-item:first"),r.length>0?r.addClass("active"):i.addClass("active")),this.slideTo(this.$list.find(".active"))},e.prototype.openOrganizationCreator=function(){return this.requestSubView(p).open(r),this.hide(),this},e}(s),u.extend(o.prototype,c),t.exports=o},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(679);if(t.organizations.length){n+=' <ul class="organization-list list-underscore thin-scroll"> ';var o=t.organizations;if(o)for(var s,a=-1,c=o.length-1;a<c;)s=o[a+=1],n+=' <li class="organization-item" data-id="'+s._id+'" data-gta="{action: \'enter organization',s.isOverdue&&(n+=" expiration"),n+='\', control: \'Navigation Tab Org List\', type: \'organization\'}"> <a class="clearfix"> <div class="organization-logo pull-left" style="background-image: url('+s.logo+')"></div> <p class="organization-title">'+e(s.name)+'</p> <p class="muted">'+e(s.description)+"</p> </a> </li> ";n+=" </ul>"}else n+=' <div class="organization-intro"> <header> <span>'+tb_i18n.get("organization.switcher.intro.title")+'</span> </header> <a class="organization-features" href="'+r.BUSINESS_URL+'" target="_blank"> <p class="org-feature"> <span class="org-feature-icon org-feature-permission"></span> '+tb_i18n.get("organization.switcher.intro.feature.permission")+' </p> <p class="org-feature"> <span class="org-feature-icon org-feature-statistics"></span> '+tb_i18n.get("organization.switcher.intro.feature.statistics")+' </p> <p class="org-feature"> <span class="org-feature-icon org-feature-weekreport"></span> '+tb_i18n.get("organization.switcher.intro.feature.weekReport")+" </p> </a> </div>";return n+='<div class="organization-create-wrap ',t.organizations.length&&(n+="has-divider"),n+='"> <a class="btn btn-primary organization-create-handler" data-gta="{action: add content, type: organization, control: Navigation Tab Org List}"> ',n+=t.organizations.length?" "+tb_i18n.get("navigation.create.organization")+" ":" "+tb_i18n.get("navigation.create.organization.try.now")+" ",n+=" </a></div>"}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;a=i(358),s=i(788),c=i(678),n=i(1461),o=i(1465),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="ProjectCreatorView",e.prototype.className="project-creator modal-dialog modal-padding",e.prototype.events={"click .fsm-action":"transition"},e.prototype.initialize=function(t){return this.options=null!=t?t:{},this._fsm_state="simple-creator",this.options.view=this,this.renderBasic(),this.renderState(this._fsm_state)},e.prototype.pickView=function(t){return this.currentView=function(){switch(t){case"from-template":return new n(this.options);case"simple-creator":return new n(this.options);case"template-wall":return new o(this.options)}}.call(this)},e.prototype.transition=function(t){var e,i;if(e=$(t.target).data("fsm-action"),this.currentView["onbefore"+e]()&&(i=function(){switch(this._fsm_state){case"simple-creator":switch(e){case"go":return"template-wall"}break;case"template-wall":switch(e){case"go":return"from-template"}break;case"from-template":switch(e){case"back":return"template-wall"}}}.call(this),i!==this._fsm_state))return this.renderState(i)},e.prototype.renderState=function(t){var e;return e=this.pickView(t),this.$el.find(".modal-content").replaceWith(e.$el),this.undelegateEvents(),this.delegateEvents(a.extend({},e.modalEvents,this.events)),this.$el.removeClass(this._fsm_state).addClass(this._fsm_state=t),this},e.prototype.renderBasic=function(){return this.$el.html('<div class="modal-content"></div>')},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.remove(),this},e}(s)},function(t,e,i){var n,r,o,s,a,c,l,p,u;p=i(358),o=i(401),u=i(678),c=i(697),s=i(684),l=i(696),a=i(1021),n=null,t.exports=r=function(){function t(t){var e,r;return this.options=null!=t?t:{},this.$el=$('<div class="modal-content"></div>'),this.modalEvents={"submit .form-create-project":this.onCreateProjectFormSubmit.bind(this)},n=i(1462)("./"+(this.options.selectedTemplate?"template":"simple")),this._organizationId=this.options._organizationId||(null!=(r=this.options.selectedOrganizationModel)?r.id:void 0),this._organizationId||(e=u.router.getPrefix().split("/"),"organization"===e[0]?this._organizationId=e[1]:"project"===e[0]&&(this._organizationId=c.get(e[1]).get("_organizationId"))),s.fetch(0,{success:function(t){return function(e){var i;return t.organizationsCollection=e,t._organizationId&&p.find(t.getOwnOrgs(),function(e){return e._id===t._organizationId})||(t._organizationId=null),(i=t.options).selectedOrganizationModel||(i.selectedOrganizationModel=e.get(t._organizationId)),t.reset().renderBasic().initOwnerSelector().initSectionSelector()}}(this)}),this}return t.prototype.getOwnOrgs=function(){var t;return t=[],t.push({title:tb_i18n.get("me"),_id:u.user.id}),this.organizationsCollection.each(function(e){if(!e.isOverdue()&&e.hasPermission("post.project"))return t.push({_id:e.id,title:e.get("name")})}),t},t.prototype.reset=function(){return this.projectModel=new c({_organizationId:this._organizationId||null}),this.options.view.listenTo(this.organizationsCollection,"add remove",function(t){return function(){var e;return null!=(e=t.ownerMenuView)?e.update(t.getOwnOrgs()):void 0}}(this)),this},t.prototype.renderBasic=function(){var t;return this.$el.html(n({selectedTemplate:this.options.selectedTemplate,organizationName:(null!=(t=this.options.selectedOrganizationModel)?t.get("name"):void 0)||tb_i18n.get("project.creator.me")})),this.$projectNameInput=this.$el.find(".project-name"),this.$btnCreateProject=this.$el.find(".btn-create-project"),this.$projectOwner=this.$el.find(".project-owner"),this.$projectOwnerToggler=this.$el.find(".project-owner .open-selector-handler"),this.$projectOwnerSelectorTitle=this.$el.find(".project-owner .selector-title"),this.$projectSection=this.$el.find(".project-section"),this.$projectSectionToggler=this.$el.find(".project-section .open-selector-handler"),this.$projectSectionSelectorTitle=this.$el.find(".project-section .selector-title"),this},t.prototype.onbeforego=function(){return!0},t.prototype.onbeforeback=function(){return!this.$btnCreateProject.isCreating},t.prototype.onOpen=function(){var t;return null!=(t=this.$projectNameInput)&&t.focusAtEnd(),this},t.prototype.onCreateProjectFormSubmit=function(t){return t.preventDefault(),this.createProject()},t.prototype.createProject=function(){var t,e,i;if(!this.$btnCreateProject.isCreating)return(e=this.$projectNameInput.val().trim())?(this.projectModel.set({name:e,_projecttemplateId:null!=(i=this.options.selectedTemplate)?i._id:void 0}),t=this.projectModel.toJSON(),l.get(0).create(t,{url:this.options.selectedTemplate?"projects/from-template":void 0,wait:!0,beforeSend:function(t){return function(){return t.$btnCreateProject.isCreating=!0,t.$btnCreateProject.addClass("is-submitting"),t.$btnCreateProject.find("span").text(tb_i18n.get("project.creator.creating"))}}(this),success:function(t){return function(e){var i,n;if(i=e.get("_organizationId"),i&&null!=(n=t.organizationsCollection.get(i))&&n.fetch({reset:!0}),t.options.view.close(),e.set("_roleId",2),u.router.navigate("project/"+e.id+"/home",{trigger:!0}),t.options.selectedTemplate)return u.gta.event({action:"added content",type:"project",category:t.options.selectedTemplate.name,control:"template list"})}}(this),error:function(t){return function(e){if(t.$btnCreateProject.isCreating=!1,t.$btnCreateProject.addClass("is-submitting"),t.$btnCreateProject.find("span").text(tb_i18n.get("done")),t.options.selectedTemplate)return o.show({status:"error",message:tb_i18n.get("project.creator.template.failed")})}}(this)}),this):this.$projectNameInput.focusAtEnd()},t.prototype.initOwnerSelector=function(){return this.getOwnOrgs().length<=1?(this.$projectOwner.hide(),this):(this.ownerMenuView=this.options.view.requestSubView(a,{$toggler:this.$projectOwnerToggler,width:320,dataList:this.getOwnOrgs(),selected:(this.options.selectedOrganizationModel||u.user).id,select:function(t){return function(e){var i,n,r;return e===u.user.id&&(e=null),e&&(n=null!=(r=t.organizationsCollection.get(e))?r.toJSON():void 0),t.projectModel.set({organization:n,_organizationId:e}),i=n?n.name:tb_i18n.get("project.creator.me"),t.$projectOwnerSelectorTitle.html(i),t.initSectionSelector()}}(this)}),this)},t.prototype.initSectionSelector=function(){var t,e,i,n;return null!=(i=this.sectionMenuView)&&i.remove(),this.$projectSection.hide(),e=this.organizationsCollection.get(this.projectModel.get("_organizationId")),t=(null!=e?e.get("dividers"):void 0)||[],n=function(e){return function(i){var n,r;return r=null!=(n=t[i])?n.name:void 0,r?e.projectModel.set("dividerIndex",i):e.projectModel.unset("dividerIndex"),e.$projectSectionSelectorTitle.text(r)}}(this),(null!=e?e.getRoleScope():void 0)>=0&&t.length&&(this.sectionMenuView=this.options.view.requestSubView(a,{$toggler:this.$projectSectionToggler,width:320,dataList:t.map(function(t,e){return{_id:e,title:t.name}}),selected:0,select:function(t){return n(t)},unselect:function(t){return n(-1)}}),n(0),this.$projectSection.show()),this},t}()},function(t,e,i){function n(t){return i(r(t))}function r(t){return o[t]||function(){throw new Error("Cannot find module '"+t+"'.")}()}var o={"./simple":1463,"./simple.html":1463,"./template":1464,"./template.html":1464};n.keys=function(){return Object.keys(o)},n.resolve=r,t.exports=n,n.id=1462},function(t,e,i){t.exports=function(t){var e="",n=i(679),r=i(678);return e+='<form class="form-create-project form-horizontal"> <header class="modal-header text-center"> <h4 class="modal-title">'+tb_i18n.get("project.creator.create.project")+'</h4> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </header> <div class="modal-body text-center"> <section class="project-creator-content"> <div class="illustration"></div> <p class="intro"> '+tb_i18n.get("project.creator.intro")+' </p> <div class="form-group"> <input class="project-name form-control" placeholder="'+tb_i18n.get("project.creator.porject.name.placeholder")+'"> </div> <div class="project-owner"> <h5>'+tb_i18n.get("project.creator.belongsTo")+'</h5> <div class="form-group"> <div class="open-selector-handler form-control is-placeholder"> <div class="selector-title"> '+t.organizationName+' </div> <span class="icon icon-chevron-down icon-on-bar"></span> </div> </div> </div> <div class="project-section"> <h5>'+tb_i18n.get("project.creator.section")+'</h5> <div class="form-group"> <div class="open-selector-handler form-control is-placeholder"> <div class="selector-title"></div> <span class="icon icon-chevron-down icon-on-bar"></span> </div> </div> </div> </section> </div> <div class="project-creator-footer modal-footer"> <button type=\'submit\' class="btn btn-primary btn-create-project" data-gta="{action: \'added content\', type: \'project\', control: \'new project button\'}"> <span>'+tb_i18n.get("project.creator.doneAndCreate")+"</span> </button> ",n.FEATURES.project_template&&"zh"===r.PREFERENCE.getLanguage()&&(e+=' <hr/> <button type="button" data-gta="{action: \'view project template\'}" class="btn btn-default btn-project-template fsm-action" data-fsm-action=\'go\'> '+tb_i18n.get("project.creator.createFromTemplate")+" </button> "),e+=" </div></form>"}},function(t,e,i){t.exports=function(t){var e="";i(679);return e+='<form class="form-create-project form-horizontal"> <header class="modal-header text-center"> <a class="pull-left icon icon-chevron-left fsm-action" data-fsm-action="back"></a> <h4 class="modal-title">'+tb_i18n.get("project.creator.fillTemplate")+'</h4> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </header> <div class="modal-body text-center"> <img class="banner" src="'+t.selectedTemplate.banners[0]+'"></img> <section class="creator-content"> <p class="intro"> '+tb_i18n.get("project.creator.teamplate.intro",t.selectedTemplate.name)+' </p> <div class="form-group"> <input class="project-name form-control" value="'+t.selectedTemplate.name+'" placeholder="'+tb_i18n.get("project.creator.porject.name.placeholder")+'"> </div> <div class="project-owner"> <h5>'+tb_i18n.get("project.creator.belongsTo")+'</h5> <div class="form-group"> <div class="open-selector-handler form-control is-placeholder"> <div class="selector-title"> '+t.organizationName+' </div> <span class="icon icon-chevron-down icon-on-bar"></span> </div> </div> </div> <div class="project-section"> <h5>'+tb_i18n.get("project.creator.section")+'</h5> <div class="form-group"> <div class="open-selector-handler form-control is-placeholder"> <div class="selector-title"></div> <span class="icon icon-chevron-down icon-on-bar"></span> </div> </div> </div> <button type="submit" class="btn btn-primary btn-create-project"> <span>'+tb_i18n.get("project.creator.teamplate.create")+"</span> </button> </section> </div></form>"}},function(t,e,i){var n,r,o,s,a,c,l,p=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};c=i(358),r=i(680),l=i(678),s=i(1466),n=i(1467),o=4,t.exports=a=function(){function t(t){this.options=null!=t?t:{},this.$el=$('<div class="modal-content"></div>'),this.modalEvents={"click .template-card":this.toggleSelect.bind(this)},this.renderBasic(),this.options.view.showLoadingIndicator(this.$el.find(".modal-body")),this.loadData().then(function(t){return function(e){if(t.options.view.hideLoadingIndicator(),t.renderTemplates(e),t.options.selectedTemplate)return t.$btnNextStep.prop("disabled",0===t.$el.find(".template-item[data-id="+t.options.selectedTemplate._id+"] > .template-card").addClass("selected").length)}}(this))}return t.prototype.loadData=function(){return Promise.all([r.get("projecttemplates"),new Promise(function(t){return c.delay(t,600)})]).then(function(t){var e,i,n,r;for(r=t[0],e=i=0,n=o-r.length%o;0<=n?i<n:i>n;e=0<=n?++i:--i)r.push({dummy:!0,_id:"dummy-"+e});return r}).then(function(t){return function(e){var i;return i=Date.now(),t.usedTemplates=l.PREFERENCE.get("usedTemplates")||[],c.each(e,function(e){var n;return e.isNew=i-new Date(e.updated)<432e6&&(n=e._id,p.call(t.usedTemplates,n)<0)}),e}}(this))},t.prototype.toggleSelect=function(t){var e;return e=$(t.target).closest(".template-card"),$(".template-card.selected").not(e).removeClass("selected"),e.toggleClass("selected"),this.$btnNextStep.prop("disabled",!$(".template-card.selected").length)},t.prototype.renderBasic=function(){return this.$el.html(n()),this.$btnNextStep=this.$el.find(".btn-nextstep")},t.prototype.renderTemplates=function(t){var e;return this.templates=t,e=this.$el.find(".template-list"),this.templates.forEach(function(t){return function(i){var n;return n=t.$el.find(".template-item[data-id="+i._id+"]"),n.length?n.replaceWith(s(i)):e.append(s(i))}}(this))},t.prototype.onbeforego=function(){var t,e;return t=$(".template-card.selected").closest(".template-item"),t.length&&(e=t.data("id"),this.options.selectedTemplate=c.findWhere(this.templates,{_id:e}),this.options.selectedTemplate.isNew&&p.call(this.usedTemplates,e)<0&&(this.usedTemplates=c.filter(this.usedTemplates,function(t){return function(e){return c.findWhere(t.templates,{_id:e._id,isNew:!0})}}(this)),this.usedTemplates.push(e),l.PREFERENCE.set("usedTemplates",this.usedTemplates)),l.gta.event({action:"add content",type:"project",control:"template list",category:this.options.selectedTemplate.name})),!!t.length},t}()},function(t,e){t.exports=function(t){var e='<li class="template-item';return t.dummy&&(e+=" dummy"),e+='" data-id="'+t._id+'"> <div class="template-card" style="background-image: url('+t.logo+');"> ',t.dummy||(e+=" ",t.isNew&&(e+=' <div class="card-badge">new</div> '),e+=' <p class="template-name">'+t.name+'</p> <p class="template-intro">'+t.description+"</p> "),e+=" </div></li>"}},function(t,e,i){t.exports=function(t){var e="",n=i(679);return e+='<form class="form-create-project form-horizontal flex-vert flex-fill"> <header class="modal-header text-center flex-static"> <h4 class="modal-title"> '+tb_i18n.get("project.creator.createFromTemplate")+' </h4> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </header> <div class="modal-body text-center flex-fill thin-scroll"> <ul class="template-list flex flex-between"></ul> </div> <div class="project-creator-footer modal-footer flex-static"> <a class="template-feedback" target="_blank" href="'+n.TEMPLATE_FEEDBACK_URL+'"> '+tb_i18n.get("project.creator.template.feedback")+' </a> <button type="button" data-fsm-action=\'go\' disabled class="btn btn-primary btn-nextstep fsm-action"> '+tb_i18n.get("project.creator.nextStep")+" </button> </div></form>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w=function(t,e){function i(){this.constructor=t}for(var n in e)_.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},_={}.hasOwnProperty,j=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};k=i(678),y=i(358),b=i(429),f=i(677),m=i(1114),s=i(813),l=i(797),h=i(818),u=i(1469),o=i(1473),v=i(792),g=i(786),a=i(982),r=i(794),c=i(696),d=i(815),n=i(1482),p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.viewName="SearchPopoverView",e.prototype.className="search-popover-view",e.prototype.popoverTitle="Search",e.prototype.hotkeys={esc:function(t){var e;return t.preventDefault(),null!=(e=this.$popover)&&e.parent().trigger("click"),this.remove()}},e.prototype.events={"click .wrapper li":"onItemClick","click .search-current":"onSearchCurrent","click .search-all":"onSearchAll","keyup .li-item":"slide","mousewheel .search-result-popover":f.mousewheel},e.prototype.initialize=function(){var t,i;return this.collection=d.get(0),this.uniqueTaskCollection=new d([]),this.currentProjectId=null!=(t=k.APP.projectModel)?t.get("_id"):void 0,this.currentProjectName=null!=(i=k.APP.projectModel)?i.get("name"):void 0,this.projectsCollection=c.get(0),e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){var t;if(t=this.options.query)return this.showLoadingIndicator(),Promise.all([m.searchForUniqueTask(this.uniqueTaskCollection,t,!1),this.fetchSearchResults(t)]).then(function(e){return function(){var i,r;if(e.$el)return e.hideLoadingIndicator(),r=e.getMatchedProjects(t),i=e.assembleData(r),e.$el.html(n(i)),e.$resultList=e.$(".search-result-popover"),e.renderTaskIdLabel(),e.setupScroll(e.$resultList),e.layout()}}(this))["catch"](function(t){return console.error(t)}),this},e.prototype.fetchSearchResults=function(t){return this.collection.reset(),new Promise(function(e){return function(i,n){return e.collection.fetch({silent:!0,url:"v2/search",attrs:{q:t},success:i,error:n})}}(this))},e.prototype.getMatchedProjects=function(t){var e;return null==t&&(t=""),t=t.toLowerCase(),e=function(e){return(e||"").replace(new RegExp("("+t+")","gi"),"<em>$1</em>")},this.projectsCollection.filter(function(e){return~(e.get("name")||"").toLowerCase().indexOf(t)||~(e.get("pinyin")||"").toLowerCase().indexOf(t)||~(e.get("py")||"").toLowerCase().indexOf(t)}).map(function(t){return{_id:t.get("_id"),title:e(t.get("name")),logo:t.get("logo"),type:"project"}})},e.prototype.getVisibleUniqueIdTasks=function(){return this.uniqueTaskCollection.filter(function(t){return function(e){var i,n;return i=e.get("_projectId"),n=t.projectsCollection.get(i),n.isAppEnabled("taskUniqueId")}}(this)).map(function(t){return t.toJSON()})},e.prototype.assembleData=function(t){var e,i,n,r;return i=[],e={},t.length&&(i.push("project"),e.project=t),r=this.getVisibleUniqueIdTasks(),r.length&&(i.push("task"),e.task||(e.task=[]),e.task=e.task.concat(r)),this.collection.each(function(t){return function(n){var r,o,s,a;if(r=n.toJSON(),t.highlightPostContent(r),s=t.projectsCollection.get(r._projectId),!t.uniqueTaskCollection.get(r._id)||!s.isAppEnabled("taskUniqueId"))return a=r.type,j.call(i,a)<0&&i.push(r.type),(e[o=r.type]||(e[o]=[])).push(r)}}(this)),{orderedTypes:i,data:e,isInProject:!!this.currentProjectId,query:null!=(n=this.options)?n.query:void 0}},e.prototype.renderTaskIdLabel=function(){return this.getVisibleUniqueIdTasks().forEach(function(t){return function(e){var i,n;return i=t.$resultList.find(".task-item[data-id="+e._id+"]"),n=t.projectsCollection.get(e._projectId),t.requestSubView(h,{projectModel:n,uniqueId:e.uniqueId}).bind(i.find(".task-id-placeholder"))}}(this))},e.prototype.highlightPostContent=function(t){var e,i;if(t.text&&(e=null!=(i=this.options)?i.query:void 0))return t.text=t.text.replace(e,"<em>"+e+"</em>"),t},e.prototype.slide=function(t){var e,i,n,r,o;if(this.$el)return n=this.$(".li-item"),e=n.filter(".active"),o=n.length,r=n.index(e),38===t.which?r===-1||0===r?r=o-1:r-=1:40===t.which&&(r===o-1?r=0:r+=1),i=n.removeClass("active").eq(r).addClass("active"),this.slideTo(i),this},e.prototype.onItemClick=function(t){var e,i,n,s,c,l;if(e=$(t.currentTarget),i=e.data("id"),l=e.data("type"),k.gta.event({action:"open detail",type:l,control:"quick result"}),i)return n=this.collection.get(i),"function"==typeof(s=this.options).select&&s.select(i),"project"===l?(k.gta.event(null,"click","projects - enter project"),c=this.projectsCollection.get(i),e.val(""),c.getPaymentPlan().isOverdue?this.requestSubView(g).open(o,{_organizationId:c.get("_organizationId"),projectModel:c}):k.router.navigate("project/"+i+"/"+c.getFirstApp(),{trigger:!0})):"work"===l?this.requestSubView(g).open(a,{_projectId:n.get("_projectId"),workModel:new v(n.toJSON())}):this.requestSubView(g).open(r,{objectType:l,objectId:i,fixedModal:!0}),this.hide()},e.prototype.onSearchCurrent=function(t){var e;e=$(t.currentTarget),k.gta.event({action:"begin full search",type:"current project"}),this.gotoResultPage({_projectId:this.currentProjectId,projectName:this.currentProjectName})},e.prototype.onSearchAll=function(t){var e;e=$(t.currentTarget),k.gta.event({action:"begin full search",type:"all project"}),this.gotoResultPage()},e.prototype.gotoResultPage=function(t){var e,i;t||(t={}),t=y.extend({animateType:"fade",query:this.options.query},t),null!=(i=k.APP.Float)&&i.open(u,t,"search"),"function"==typeof(e=this.options).onSearch&&e.onSearch(this.options.query),this.hide()},e.prototype.layout=function(){return this.$resultList.css("maxHeight",Math.max(.7*$(window).height(),300)),this},e}(s),y.extend(p.prototype,l),t.exports=p},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S,I=function(t,e){function i(){this.constructor=t}for(var n in e)z.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},z={}.hasOwnProperty;M=i(358),S=i(678),x=i(429),f=i(797),k=i(677),w=i(788),r=i(817),T=i(792),h=i(696),a=i(699),v=i(815),p=i(1021),l=i(794),j=i(786),u=i(982),y=i(818),b=i(1114),m=i(1470),c=i(1471),n=i(1472),d=i(1118),s=i(1119),_=i(351),o={task:"board",post:"wall",event:"calendar",work:"file",entry:"bookkeeping-logo"},C=function(){return{task:tb_i18n.get("navigation.task"),post:tb_i18n.get("navigation.sharing"),work:tb_i18n.get("navigation.work"),event:tb_i18n.get("navigation.event"),entry:tb_i18n.get("bookkeeping")}},g=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return I(e,t),e.prototype.viewName="SearchResultView",e.prototype.className="search-result-view float-view",e.prototype.events={mousewheel:"onScroll","click .result-item":"openDetail","click .type-toggler":"toggleTypeSelector","click .project-toggler":"toggleProjectSelector","click .member-toggler":"toggleMemberSelector","click .close-handler":"closeView","click .type-item":"filterType","click .back-to-top":"scrollToTop","keydown .search-input":"onSearchInputKeyDown"},e.prototype.initialize=function(t){if(this.options=t||{},this.query=t.query)return this.attrs={q:this.query,type:t.type,_projectId:t._projectId},this.uniqueTaskCollection=new v([]),this.collection=v.get(0),this.projectsCollection=h.get(0),this.membersCollection=a.get(0),this.renderBasic(),this},e.prototype.renderBasic=function(){var t,e,i,r,o,s;return s=C(),o=this.selectedType||this.options.type,e={type:o,typeName:o?s[o]:tb_i18n.get("search.result.all.type"),projectName:(null!=(i=this.projectsCollection.get(this.selectedProjectId))?i.get("name"):void 0)||tb_i18n.get("all.project"),memberName:(null!=(r=this.membersCollection.get(this.selectedMemberId))?r.get("name"):void 0)||tb_i18n.get("all.member"),query:this.query},this.$el.html(n(e)),this.$list=this.$(".result-list"),this.fetchOriginResult(),t=this.$(".search-input"),M.delay(function(){return t.focusAtEnd()},300),this},e.prototype.fetchOriginResult=function(){return b.searchForUniqueTask(this.uniqueTaskCollection,this.query).then(function(t){return function(){return t.fetchResult()}}(this))["catch"](function(t){return console.error(t)})},e.prototype.fetchResult=function(){return this.load({silent:!0,url:"v2/search",attrs:this.attrs,beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$list)}}(this),success:function(t){return function(){return t.hideLoadingIndicator(),t.renderUniqueIdTasks(),t.renderResult(),t.checkForPlaceholder(),t.collection.hasMore?t.setupScroll(t.$el):t.collection.length&&t.showEndPoint(t.$list),S.gta.event(null,"view","search result|start search",t.query.length)}}(this)})},e.prototype.checkForPlaceholder=function(){if(!this.getVisibleUniqueIdTasks().length&&!this.collection.length)return this.$list.html(c({keyword:this.query}))},e.prototype.renderTaskIdLabel=function(t,e,i){return this.requestSubView(y,{projectModel:e,uniqueId:i}).bind(t)},e.prototype.renderUniqueIdTasks=function(){if(this.uniqueTaskCollection.length)return this.getVisibleUniqueIdTasks().map(function(t){return function(e){var i,n,r;return n=t.formData(e.toJSON()),r=t.projectsCollection.get(n._projectId),i=$(m(n)),t.$list.append(i),t.renderTaskIdLabel(i.find(".task-id-placeholder"),r,n.uniqueId)}}(this))},e.prototype.renderResult=function(t){var e;return e=t&&null!=t.length?new v(t):this.collection,e.map(function(t){return function(e){var i,n;if(!t.getVisibleUniqueIdTasks().length||!t.getVisibleUniqueIdTasks().get(e.id))return n=t.formData(e.toJSON()),i=$("<div>"+n.note+"</div>"),n.text=i.text(),t.$list.append(m(n))}}(this)),this},e.prototype.getVisibleUniqueIdTasks=function(){var t;return t=this.uniqueTaskCollection.filter(function(t){return function(e){var i,n,r,o;if(e=e.toJSON(),o=t.projectsCollection.get(e._projectId),o.isAppEnabled("taskUniqueId"))return n=!t.selectedProjectId||e._projectId===t.selectedProjectId,r=!t.selectedType||"task"===t.selectedType,i=!t.selectedMemberId||t.selectedMemberId===e.executor._id,n&&r&&i}}(this)).map(function(t){return t.toJSON()}),new v(t,{parse:!1})},e.prototype.highlightPostContent=function(t){if(t.text&&this.query)return t.text=t.text.replace(this.query,"<em>"+this.query+"</em>"),t},e.prototype.formData=function(t){var e,i;return i=t.type||"task",this.highlightPostContent(t),e=M.extend(t,{type:i,typeName:C()[i],iconName:o[i],isUniqueIdResult:!t.type})},e.prototype.load=function(t){return this.collection.resetSoft(),this.collection.fetch(t),this},e.prototype.loadMore=function(t){return this.collection.loadMore({silent:!0,url:"v2/search",attrs:this.attrs,beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$list)}}(this),success:function(e){return function(i,n,r){if(e.$el)return e.hideLoadingIndicator({animated:!0}),n.length&&e.renderResult(n),e.collection.hasMore?"function"==typeof t&&t():e.showEndPoint(e.$list),S.gta.event(null,"view","search result|load more",e.pageIndex+1)}}(this)}),this},e.prototype.filterSearchResult=function(t){return this.attrs=M.extend(this.attrs,t),this.$list.html(""),this.fetchResult(),this},e.prototype.filterType=function(t){var e,i,n;return n=C(),e=$(t.currentTarget),e.siblings("li").removeClass("active"),e.addClass("active"),i=e.data("type")||"",this.$(".active-type").text(i?n[i]:tb_i18n.get("search.result.all.type")),this.filterSearchResult({type:i}),S.gta.event({action:"filter search",type:i||"all"}),this.selectedType=i,this},e.prototype.filterProject=function(t){var e;if(S.gta.event({action:"filter search",type:"project"}),t){if(e=this.projectsCollection.get(t),!e)return;this.$(".active-project").text(e.get("name"))}else this.$(".active-project").text(tb_i18n.get("all.project"));
return this.filterSearchResult({_projectId:t||""}),this.selectedProjectId=t,this},e.prototype.filterMember=function(t){var e;if(S.gta.event({action:"filter search",type:"member"}),t){if(e=this.membersCollection.get(t),!e)return;this.$(".active-member").text(e.get("name"))}else this.$(".active-member").text(tb_i18n.get("all.member"));return this.filterSearchResult({_creatorId:t||""}),this.selectedMemberId=t,this},e.prototype.openDetail=function(t){var e,i,n,r;if(e=$(t.currentTarget),i=e.data("id"),r=e.data("type"),i)return n=null!=e.data("unique-id")?this.uniqueTaskCollection.get(i):this.collection.get(i),"work"===r?this.requestSubView(j).open(u,{_projectId:n.get("_projectId"),workModel:new T(n.toJSON())}):this.requestSubView(j).open(l,{objectType:r,objectId:i,_projectId:n.get("_projectId"),fixedModal:!0}),S.gta.event({action:"open detail",type:r,control:"full result"}),S.gta.event(null,"view","search click|show detail",e.index()),this},e.prototype.toggleTypeSelector=function(t){var e,i;return null!=(e=this.projectPopover)&&e.remove(),null!=(i=this.memberPopover)&&i.remove(),this},e.prototype.toggleProjectSelector=function(t){var e,i;if(e=$(t.currentTarget),!e.data("bs.popover"))return i=[{_id:0,all:!0,title:tb_i18n.get("all.project")}],h.fetch(0,{success:function(t){return function(n){return t.projectPopover=t.requestSubView(p,{container:t.$el,ListTemplate:d,hideDelay:0,$toggler:e,searchPlaceholder:tb_i18n.get("task.menu.search.project"),dataList:i.concat(t.projectsCollection.filter(function(t){return t.getRoleScope()>=0}).map(function(t){return{_id:t.get("_id"),logo:t.get("logo"),title:t.get("name"),pinyin:t.get("pinyin")}})),selected:t.selectedProjectId||t.options._projectId||0,select:function(e){return t.filterProject(e)}}).show()}}(this)})},e.prototype.toggleMemberSelector=function(t){var e,i;if(e=$(t.currentTarget),!e.data("bs.popover"))return i=[{_id:0,all:!0,title:tb_i18n.get("all.member")}],a.fetch(0,{url:"projects/members",success:function(t){return function(n){return t.memberPopover=t.requestSubView(p,{container:t.$el,ListTemplate:s,hideDelay:0,$toggler:e,searchPlaceholder:tb_i18n.get("member.menu.search"),dataList:i.concat(t.membersCollection.map(function(t){return{_id:t.get("_id"),avatarUrl:t.get("avatarUrl"),title:t.get("name"),pinyin:t.get("pinyin")}})),selected:t.selectedMemberId||0,select:function(e){return t.filterMember(e)}}).show()}}(this)})},e.prototype.onSearchInputKeyDown=function(t){var e;if(e=$(t.currentTarget).val().trim(),13===t.which){if(!e||e===this.query)return;return this.attrs.q=this.query=e,this.renderBasic()}},e.prototype.onScroll=function(t){var e,i;return e=this.$(".search-result-body")[0],i=e.getBoundingClientRect(),i.top<=0?this.showBackToTop():this.hideBackToTop()},e.prototype.scrollToTop=function(t){if(this.$el.hasClass("on-back-to-top"))return this.slideTo(this.$(".search-input-wrap"),!0),this.hideBackToTop()},e.prototype.showBackToTop=function(){return this.$el.addClass("on-back-to-top")},e.prototype.hideBackToTop=function(){return this.$el.removeClass("on-back-to-top")},e.prototype.closeView=function(t){return S.APP.Float.close(),this},e.prototype.beforeClose=function(){return _(".search-input").val("")},e}(w),M.extend(g.prototype,f),t.exports=g},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(932).fileIconT,o=i(963).calculateColor;if(n+='<li class="result-item '+e(t.type)+'-wrapper card" data-type="'+e(t.type)+'" data-id="'+e(t._id)+'" ',t.isUniqueIdResult&&(n+=' data-unique-id="'+t.uniqueId+'"'),n+='> <div class="item-header"> <span class="project-name hinted" data-title="'+tb_i18n.get("search.project")+'">'+(t.projectName||"projectName")+'</span> </div> <div class="item-title clearfix"> <span class="icon icon-'+e(t.iconName)+" ","entry"!=t.type&&(n+="title-icon"),n+=" ","work"==t.type&&(n+="is-work"),n+=' pull-left hinted" data-title="'+e(t.typeName)+'"></span> ',"task"==t.type?(n+=' <span class="img img-24 img-circle avatar no-avatar pull-left hinted" data-title="'+tb_i18n.get("task.detail.executor")+'" ',t.avatarUrl&&(n+='style="background-image:url('+t.avatarUrl+')"'),n+="></span> "):"work"==t.type&&(n+=" "+r(t)+" "),n+=' <div class="title ',"work"==t.type&&(n+="work-title"),n+='"> <p> <span class="title-text">'+(t.title||tb_i18n.get("post.un.title"))+"</span> ","work"==t.type&&(n+=' <span class="file-size"> ('+t._fileSize+") </span> "),n+=' <span class="task-id-placeholder"></span> ',t.tagIds&&t.tagIds.length>0){n+=" ";var s=t.tagIds;if(s)for(var a,c=-1,l=s.length-1;c<l;)a=s[c+=1],n+=' <span class="label tag ',0==c&&(n+="first-tag"),n+='"> <span class="tag-label" style="background-color: '+o(a.color,a.colorRGBA)+'"></span> <span class="tag-name">'+a.name+"</span> </span> ";n+=" "}if(n+=" ",t.isArchived&&(n+=' <span class="label archived"> <span class="icon icon-archive"></span> '+tb_i18n.get("search.archived")+" </span> "),n+=" </p> </div> ","task"==t.type&&(n+=" ",!t.isDone&&t.deadLine?(n+=' <time data-title="'+tb_i18n.get("due.date")+'" class="task-duedate hinted label ',"overdue"===t.deadLine.dateClass?n+="label-important":"today"===t.deadLine.dateClass?n+="label-warning":"upcoming"===t.deadLine.dateClass&&(n+="label-info"),n+='"> <span class="icon icon-calendar2 ',"normal"!==t.deadLine.dateClass&&(n+="icon-white"),n+='"></span> ',n+="today"===t.deadLine.dateClass?" <span>"+t.deadLine.dateTimeString+"</span> ":" <span>"+t.deadLine.dateString+"</span> ",n+=" </time> "):t.isDone&&t.doneDate&&(n+=' <time data-title="'+tb_i18n.get("due.date")+'" class="label hinted task-accomplished-date"> <span class="icon icon-calendar2 icon-white"></span> '+t.doneDate.dateString+" </time> "),n+=" "),n+=" ","event"==t.type&&t.freqString&&(n+=' <span class="recurrence label"> <span class="icon icon-repeat"></span> '+t.freqString+" </span> "),n+=" ","entry"==t.type&&(n+=' <div class="entry-amount ',n+=1==t._type?"income":"expense",n+='">'+t.amount+"</div> "),n+=" </div> <!-- end of `.item-title`--> ","event"==t.type&&(n+=' <time class="event-date">'+t.eventDateString+"</time> ",t.location&&(n+=' <div class="address">'+t.location+"</div> "),n+=" "),n+=" ","work"!=t.type&&t.text&&(n+=' <div class="item-content"> <div class="'+e(t.type)+'-content">'+e(t.text)+"</div> </div> "),n+=" ","task"==t.type){if(n+=" ",t.subtasks&&t.subtasks.length>0){n+=' <ul class="subtask-list"> ';var p=t.subtasks;if(p)for(var u,d=-1,h=p.length-1;d<h;)u=p[d+=1],n+=' <li class="subtask"> <span class="icon icon-checkbox-thin pull-left"></span> <span class="subtask-name">'+(u.text||u.highlight)+"</span> ",!u.isDone&&u.deadLine?(n+=' <time class="task-duedate label ',"overdue"===u.deadLine.dateClass?n+="label-important":"today"===u.deadLine.dateClass?n+="label-warning":"upcoming"===u.deadLine.dateClass&&(n+="label-info"),n+='"> <span class="icon icon-calendar2 ',"normal"!==u.deadLine.dateClass&&(n+="icon-white"),n+='"></span> ',n+="today"===u.deadLine.dateClass?" <span>"+u.deadLine.dateTimeString+"</span> ":" <span>"+u.deadLine.dateString+"</span> ",n+=" </time> "):u.isDone&&u.doneDate&&(n+=' <time class="label task-accomplished-date"> <span class="icon icon-calendar2 icon-white"></span> '+u.doneDate.dateString+" </time> "),n+=" </li> ";n+=" </ul> "}n+=" "}return n+="</li>"}},function(t,e){t.exports=function(t){var e='<div class="search-no-result"> <span class="icon icon-search-warning"></span> <p>'+tb_i18n.get("search.no.result",t.keyword)+"</p></div>";return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<header class="search-input-wrap"> <i class="icon icon-search"></i> <input class="search-input" placeholder="'+tb_i18n.get("search")+'" value="'+e(t.query)+'"> <a class="close-handler icon icon-remove"></a></header><header class="search-result-header"> <div class="search-result-filter clearfix"> <div class="filter type-filter" data-gta="{action: \'toggle filter search\', type: \'type list\'}"> <a class="type-toggler" data-toggle="dropdown"> <span class="active-type">'+t.typeName+'</span> <span class="icon icon-chevron-down"></span> </a> <div class="type-selector dropdown-menu card"> <ul class="type-list"> <li class="type-item ';return t.type||(i+="active"),i+='"> <a class="clearfix"> <span class="icon icon-th"></span> '+tb_i18n.get("search.result.all.type")+' </a> </li> <li class="type-item ',"task"==t.type&&(i+="active"),i+='" data-type="task"> <a class="clearfix"> <span class="icon icon-board"></span> '+tb_i18n.get("navigation.task")+' </a> </li> <li class="type-item ',"post"==t.type&&(i+="active"),i+='" data-type="post"> <a class="clearfix"> <span class="icon icon-wall"></span> '+tb_i18n.get("navigation.sharing")+' </a> </li> <li class="type-item ',"work"==t.type&&(i+="active"),i+='" data-type="work"> <a class="clearfix"> <span class="icon icon-file"></span> '+tb_i18n.get("navigation.work")+' </a> </li> <li class="type-item ',"event"==t.type&&(i+="active"),i+='" data-type="event"> <a class="clearfix"> <span class="icon icon-calendar"></span> '+tb_i18n.get("navigation.event")+' </a> </li> <li class="type-item ',"entry"==t.type&&(i+="active"),i+='" data-type="entry"> <a class="clearfix"> <span class="icon icon-bookkeeping-logo"></span> '+tb_i18n.get("bookkeeping")+' </a> </li> </ul> </div> </div> <div class="filter project-filter" data-gta="{action: \'toggle filter search\', type: \'project list\'}"> <a class="project-toggler"> <span class="active-project">'+t.projectName+'</span> <span class="icon icon-chevron-down"></span> </a> </div> <div class="filter member-filter" data-gta="{action: \'toggle filter search\', type: \'member list\'}"> <a class="member-toggler"> <span class="active-member">'+t.memberName+'</span> <span class="icon icon-chevron-down"></span> </a> </div> </div></header><section class="search-result-body"> <div class="search-result-content"> <ul class="result-list"></ul> </div></section><a class="back-to-top icon icon-top-up"></a>'}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y=function(t,e){function i(){this.constructor=t}for(var n in e)b.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},b={}.hasOwnProperty;f=i(358),v=i(678),g=i(679),m=i(786),r=i(680),o=i(699),c=i(684),p=i(696),d=i(1011),h=i(788),s=i(794),u=i(1474),n=i(1480),l=i(1481),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.viewName="OrgOrProjectOverdueView",e.prototype.className="it-is-overdue modal-dialog modal-padding",e.prototype.events={"click .export-projects":"openProjectsExportTransfer","click .contact-owner":"close","click .enter-teambition":"close","click .enter-free-version":"enterFreeVersion"},e.prototype.initialize=function(t){var e;return this.options=t,this.projectModel=this.options.projectModel,e={action:"reach plan limit",control:"renew"},this.options._organizationId?(this.organizationsCollection=c.get(0),this.organizationModel=this.organizationsCollection.get(this.options._organizationId),this.renderBasic(),e.type="business"):(this.renderProfession(),e.type="plus"),v.gta.event(e),this},e.prototype.renderBasic=function(){var t,e,i,r,o;return this.organizationModel&&this.organizationModel.get("_roleId")>=0?(i=this.organizationModel.get("name"),o=this.organizationModel.get("_roleId"),e=this.organizationModel.hasPermissions("put.transferOut"),r="",r=o>=0&&e?tb_i18n.get("organization.overdue.renew",i):tb_i18n.get("organization.overdue.contact",i),t={message:r,_organizationId:this.organizationModel.id,_roleId:o,permissions:e,projectsCount:this.organizationModel.get("projectIds").length,header:tb_i18n.get("organization.overdue.title"),plan:this.organizationModel.getPaymentPlan()}):(i=this.projectModel.get("organization").name,o=this.projectModel.get("_orgRoleId"),e={putTransferOut:this.projectModel.get("_creatorId")===v.user.id},r="",r=o>=0&&e?tb_i18n.get("organization.overdue.renew",i):tb_i18n.get("organization.overdue.contact",i),t={message:r,_organizationId:this.projectModel.get("organization")._id,_roleId:o,permissions:e,projectsCount:1,header:tb_i18n.get("organization.overdue.title")}),this.$el.html(n(t)),this},e.prototype.renderProfession=function(){var t,e;return this.projectModel.get("_roleId")>0?(e=tb_i18n.get("profession.warning.tip2"),t=!1):(e=tb_i18n.get("profession.warning.tip1"),t=!0),this.$el.html(l({message:e,_roleId:this.projectModel.get("_roleId"),permissions:t,header:tb_i18n.get("globalGuide.version.profession.overdue")})),this},e.prototype.openProjectsExportTransfer=function(){var t,e;return t=c.get(0).getOrganizationsByRight(2),e=f.pluck(t,"id"),e.push(0),this.requestSubView(m).open(u,{sourceId:this.organizationModel.id,sourceTitle:this.organizationModel.get("name"),targetIds:e,action:"export"}),this},e.prototype.enterFreeVersion=function(){return r.ajax({method:"PUT",url:"/api/users/me/trial",success:function(t){return function(){return t.close()}}(this)})},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.remove(),this},e.prototype.remove=function(){var t;return"function"==typeof(t=this.options).onclose&&t.onclose(),e.__super__.remove.apply(this,arguments)},e}(h)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y=function(t,e){function i(){this.constructor=t}for(var n in e)b.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},b={}.hasOwnProperty,k=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};g=i(358),v=i(678),m=i(788),o=i(401),s=i(684),l=i(696),u=i(1475),r=i(805),f=i(786),c=i(689),n=i(1476),a=i(1477),d=i(1478),h=i(1479),t.exports=p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.viewName="ProjectsTransferView",e.prototype.className="projects-transfer-view modal-dialog modal-padding",e.prototype.events={"click .confirm-handler":"submit","click .cancel-handler":"close","click .transfer-handle":"addToSelected","click .remove-handle":"removeSelected"},e.prototype.initialize=function(t){return!!t&&(this.options=g.extend({action:"import"},t),0===this.options.sourceId&&(this.options.sourceId=null),this.isTransferring=!1,this.loadData(function(t){return function(){return t.renderBasic().renderSourceProjects().renderTargetSelect().renderTargetProjects()}}(this)),this)},e.prototype.loadData=function(t){return this.sourceTitle=this.options.sourceTitle,this.sourceTitle||(this.sourceTitle=null===this.options.sourceId?tb_i18n.get("my.projects"):tb_i18n.get("organization.projects")),this.options.targetIds=g.without(this.options.targetIds,this.options.sourceId),l.fetch(this.options.sourceId,{success:function(e){return function(i){var n,r,o;return n=[],i.each(function(t){var e;if(e=t.get("_organizationId")||0,i._boundToObjectId===e&&t.hasPermission("put.transfer"))return n.push(t.toJSON())}),r=s.get(0).getOrganizationsByIds(e.options.targetIds),e.projectsCollection=new l(n),e.organizationsCollection=new s(r),e.ownerId=(null!=(o=r[0])?o._id:void 0)||v.user.id,t()}}(this)}),this},e.prototype.loadOrgData=function(t){var e;return e=t.toJSON(),k.call(this.options.targetIds,0)>=0&&e.unshift({name:tb_i18n.get("my.projects"),_id:v.user.id}),e},e.prototype.renderBasic=function(){var t;return t=this.loadOrgData(this.organizationsCollection),this.$el.html(n({sourceTitle:this.sourceTitle,organizations:t,action:this.options.action})),this.$transferFrom=this.$(".transfer-from .transfer-list"),this.$transferTo=this.$(".transfer-to .transfer-list"),this.$transferToSelectTitle=this.$(".transfer-to-selector-handler strong"),this.$submitter=this.$(".confirm-handler"),this.$cancel=this.$(".cancel-handler"),this},e.prototype.renderSourceProjects=function(){var t;return t=this.projectsCollection.reject(function(t){return t._selected}),t=g.map(t,function(t){return t.toJSON()}),this.$transferFrom.html(d({projects:t,action:this.options.action})),this},e.prototype.renderTargetProjects=function(){var t;return t=this.getSelected(this.ownerId),t=g.map(t,function(t){return t.toJSON()}),this.$transferTo.html(h({projects:t})),this.$submitter[t.length>0?"removeClass":"addClass"]("disabled"),this},e.prototype.renderTargetSelect=function(){var t,e;return this.$(".transfer-to-selector-handler").length?(this.$(".selector").remove(),t=this.loadOrgData(this.organizationsCollection),this.requestSubView(u,{$container:this.$el,$opener:this.$(".transfer-to-selector-handler"),selected:t[0],collection:t,template:a,position:{left:529,top:105,right:"none"},select:function(t){return function(e){var i;i=$(e.currentTarget).data("id"),t.ownerId=i,t.refreshSelectedOrg(),g.map(t.projectsCollection.models,function(t){return t._selected=!1}),t.refreshView()}}(this)}),this.ownerId=(null!=(e=t[0])?e.id:void 0)||v.user.id,this):this},e.prototype.refreshView=function(){return this.renderSourceProjects().renderTargetProjects(),this},e.prototype.refreshSelectedOrg=function(){var t;return this.ownerId===v.user.id?this.$transferToSelectTitle.html(tb_i18n.get("my.projects")):(t=s.get(0).get(this.ownerId),this.$transferToSelectTitle.html(t.get("name"))),this},e.prototype.checkMembersExceed=function(t,e){var i,n,o,s,a,c,l;return n=t.get("membersCount"),l=t.getPaymentPlan().payType,s=this.ownerId===v.user.id?v.user:this.organizationsCollection.get(this.ownerId),c=s.getPaymentPlan(),o=c.membersLimit,a=c.payType,i=n>o,i?this.requestSubView(f).open(r,{title:tb_i18n.get("project.setting.members.exceed.limit"),content:this.getMembersExceedText(a,o)}):this.requestSubView(f).open(r,{title:tb_i18n.get("confirm")+tb_i18n.get("project.settings.transfer"),content:this.getRolesChangeText(l,a),confirmText:tb_i18n.get("project.settings.transfer.confirm"),confirmStyle:"danger",onConfirm:function(){return e.success()}})},e.prototype.getMembersExceedText=function(t,e){var i,n;return i={action:"reach plan limit",control:"project member number",category:"transfer"},"organization"===t?(n=tb_i18n.get("project.settings.transfer.members.exceed.2org",e),i.type="plus"):(n=tb_i18n.get("project.settings.transfer.members.exceed.2user",e),i.type="business"),v.gta.event(i),n},e.prototype.getRolesChangeText=function(t,e){var i,n,r,o;return n={free:0,professional:1,organization:2},i=n[t],o=n[e],i<=o?r=tb_i18n.get("project.settings.transfer.roles.change.1"):2===i?r=tb_i18n.get("project.settings.transfer.roles.change.2"):1===i&&(r=tb_i18n.get("project.settings.transfer.roles.change.3")),r},e.prototype.addToSelected=function(t){var e,i;if(e=$(t.currentTarget).closest("li").data("id"),e&&!this.isTransferring)return i=this.projectsCollection.find(function(t){return t.id===e}),this.checkMembersExceed(i,{success:function(t){return function(){return i._selected=!0,i.ownerId=t.ownerId,t.refreshView()}}(this)}),this},e.prototype.removeSelected=function(t){var e,i;if(e=$(t.currentTarget).closest("li").data("id"),e&&!this.isTransferring)return i=this.projectsCollection.find(function(t){return t.id===e}),i.ownerId=null,i._selected=!1,this.refreshView(),this},e.prototype.getSelected=function(t){var e;return e=[],this.projectsCollection.each(function(i){if(i._selected&&(!t||i.ownerId===t))return e.push(i)}),e},e.prototype.submit=function(){if(!this.$submitter.hasClass("disabled")&&this.getSelected().length)return this.isTransferring=!0,g.reduce(this.getSelected(),function(t){return function(e,i){return e.then(function(){return new Promise(function(e,n){return i.transfer(t.ownerId,{wait:!0,ownerType:t.ownerId===v.user.id?"user":"organization",beforeSend:function(){return t.$submitter.addClass("disabled").html(tb_i18n.get("project.transferring")),t.$cancel.addClass("disabled")},success:e,error:n})})})}}(this),Promise.resolve()).then(function(t){return function(){var e;return o.success(tb_i18n.get("project.transfer.success")),"function"==typeof(e=t.options).success&&e.success(),t.close()}}(this))["catch"](function(t){return function(e){var i;switch(i=e.message,e.code){case 207:i=tb_i18n.get("project.settings.over.plan.warn");break;case 301:i=tb_i18n.get("project.settings.no.right.warn");break;case 302:i=tb_i18n.get("project.settings.no.exist.warn")}return o.error(i),t.$submitter.removeClass("disabled").html(tb_i18n.get("confirm")),t.$cancel.removeClass("disabled"),t.isTransferring=!1}}(this))},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.remove(),this},e.prototype.remove=function(){var t;return"function"==typeof(t=this.options).onclose&&t.onclose(),e.__super__.remove.apply(this,arguments)},e}(m)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=i(358),r=i(788),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.viewName="SelectorView",e.prototype.className="selector",e.prototype.events={"click .selector-item":"select","input input":"checkCreateCondition","click .create-handler":"create"},e.prototype.initialize=function(t){return this.options=t,this.reset(t).render().bindEvents(),this.$el.appendTo(this.options.$container),o.delay(function(t){return function(){if(t.options)return t.position()}}(this),200),this},e.prototype.reset=function(t){return this.collection=t.collection,this},e.prototype.render=function(){return this.$el.html(this.options.template({selected:this.options.selected,collection:this.options.collection})),this.$input=this.$("input"),this.$createHandler=this.$(".create-handler"),this},e.prototype.position=function(){var t,e,i,n,r;return t=this.options.$container||$("body"),e=this.options.$opener,i=this.options.collection.length,i>6&&(i=6),r=e.offset().top-t.offset().top-25*i-10,n={position:"absolute",top:r,left:90,right:10},null!=this.options.position&&(n=o.extend(n,this.options.position)),this.$el.css(n),this},e.prototype.bindEvents=function(){return this.options.$opener.click(function(t){return function(){return t.show()}}(this))},e.prototype.bindBlueHandler=function(){return $(document).one("click",function(t){return function(e){if(t.$el)return 0===$(e.target).closest(".selector").length||$(e.target).closest(".selector-item").length?t.hide():t.bindBlueHandler()}}(this))},e.prototype.select=function(t){return this.$(".active").removeClass("active"),$(t.currentTarget).addClass("active"),this.options.select(t)},e.prototype.show=function(){return this.position(),this.$el.show(),o.delay(function(t){return function(){return t.bindBlueHandler()}}(this)),this},e.prototype.hide=function(){return this.$el.hide(),this},e.prototype.checkCreateCondition=function(){return this.$createHandler.prop("disabled",!this.$input.val())},e.prototype.create=function(t){return this.options.create(this.$input.val())?(this.$input.val(""),this.hide()):this.$input.focusAtEnd()},e}(r)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<header class="modal-header"> <h4 class="modal-title"> ';return"import"===t.action?i+=" "+tb_i18n.get("projects.transferIn")+" ":"export"===t.action&&(i+=" "+tb_i18n.get("projects.transferOut")+" "),i+=' </h4></header><div class="modal-body row-flex"> <div class="transfer-from"> <div class="transfer-title">'+e(t.sourceTitle)+'</div> <ul class="transfer-list thin-scroll"></ul> </div> <div class="transfer-to"> <div class="transfer-title"> <span> ',"import"===t.action?i+=" "+tb_i18n.get("projects.transferIn.to")+" ":"export"===t.action&&(i+=" "+tb_i18n.get("projects.transferOut.to")+" "),i+=" </span> ",t.organizations.length>1?i+=' <div class="transfer-to-selector-handler form-control"> <b class="caret"></b> <strong>'+e(t.organizations[0].name)+"</strong> </div> ":t.organizations.length>0&&(i+=" "+e(t.organizations[0].name)+" "),i+=' </div> <ul class="transfer-list thin-scroll"></ul> </div></div><div class="modal-footer"> <button class="confirm-handler btn btn-primary pull-right disabled">'+tb_i18n.get("confirm")+'</button> <button class="cancel-handler btn btn-link pull-right">'+tb_i18n.get("cancel")+"</button></div>"}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<ul class="organization-list selector-options thin-scroll"> ',n=t.collection;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li class="organization-item clearfix selector-item ',r._id==t.selected._id&&(i+="active"),i+='" data-id="'+r._id+'"> <div class="organization-info selector-item-content pull-left"> <strong class="organization-name">'+e(r.name)+'</strong> </div> <span class="icon icon-tick pull-right"></span> </li> ';return i+="</ul>"}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t.projects;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li data-id="'+r._id+'" class="cleafix"> <div class="logo" style="background-image:url('+r.logo+');"></div> <div class="project-name hinted" data-title="'+r.name+'">'+e(r.name)+'</div> <span class="btn btn-primary btn-small transfer-handle"> ',"import"===t.action?i+=" "+tb_i18n.get("projects.transferIn.btn")+" ":"export"===t.action&&(i+=" "+tb_i18n.get("projects.transferOut.btn")+" "),i+=" </span> </li>";return i}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t.projects;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li data-id="'+r._id+'" class="cleafix"> <div class="logo" style="background-image:url('+r.logo+');"></div> <div class="project-name hinted" data-title="'+r.name+'">'+e(r.name)+'</div> <span class="btn btn-default btn-small remove-handle">'+tb_i18n.get("remove")+"</span> </li>";return i}},function(t,e,i){t.exports=function(t){var e="",n=i(798),r=i(679);return e+='<div class="modal-content"> <header class="modal-header text-center"> <h4 class="modal-title">'+t.header+'</h4> <a class="modal-close icon icon-remove" data-dismiss="modal"></a> </header> <div class="modal-boday"> <p class="organization-overdue-message"> '+t.message+" ",r.ENTERPRISE_URL&&(e+=' <a class="tips" href="'+r.ENTERPRISE_URL+'" target="_blank">'+tb_i18n.get("organization.learn.more")+"</a> "),e+=' </p> <div class="organization-overdue-set"> ',t._roleId>=0?(e+=" ",e+="trial"===t.plan.status?' <a class="btn-primary btn" href="'+n.pay.orgNew(t._organizationId)+'" target="_blank">'+tb_i18n.get("organization.payment.buy")+"</a> ":' <a class="btn-primary btn" href="'+n.pay.orgRenew(t._organizationId)+'" target="_blank">'+tb_i18n.get("organization.buy.now")+"</a> ",e+=" ",t.projectsCount>0&&t.permissions.putTransferOut&&(e+=' <a class="btn btn-primary ghost export-projects">'+tb_i18n.get("projects.export")+"</a> "),e+=" "):e+=' <a class="btn btn-primary contact-owner">'+tb_i18n.get("organization.overdue.btn.ok")+"</a> ",e+=" </div> </div></div>"}},function(t,e,i){t.exports=function(t){var e="",n=i(798);return e+='<div class="modal-content"> <header class="modal-header text-center"> <h4 class="modal-title">'+t.header+'</h4> <a class="modal-close icon icon-remove" data-dismiss="modal"></a> </header> <div class="modal-boday"> <p class="organization-overdue-message">'+t.message+'</p> <div class="organization-overdue-set"> ',e+=2!=t._roleId?' <button class="btn btn-primary first-btn enter-teambition">'+tb_i18n.get("guide.create.project7.btn")+"</button> ":' <a class="btn btn-primary first-btn" href="'+n.pay.userRenew+'" target="_blank">'+tb_i18n.get("globalGuide.prefession.paynow")+'</a> <a class="btn btn-primary enter-free-version second-btn" data-gta="{action: \'enter new version\'}"> '+tb_i18n.get("globalGuide.prefession.goonfree")+" </a> ",e+=" </div> </div></div>"}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(932).fileIconT;n+='<div class="search-result-popover thin-scroll"> <div class="goto-search-result"> ',t.isInProject&&(n+=' <div class="li-item search search-current"> <span class="icon icon-search pull-left"></span> <a class="search-current-text">'+tb_i18n.get("popover.search.current",t.query)+"</a> </div> "),n+=' <div class="li-item search search-all"> <span class="icon icon-search pull-left"></span> <a class="search-all-text">'+tb_i18n.get("popover.search.whole",t.query)+"</a> </div> </div> ";var o=t.orderedTypes;if(o)for(var s,a=-1,c=o.length-1;a<c;){if(s=o[a+=1],n+=" ","project"==s){n+=' <div class="wrapper projects-wrapper"> <div class="type">'+tb_i18n.get("projects")+'</div> <ul class="project-list"> ';var l=t.data[s];if(l)for(var p,u=-1,d=l.length-1;u<d;)p=l[u+=1],n+=' <li class="li-item project-item" data-id="'+p._id+'" data-type="project"> <a class="clearfix"> <div class="project-logo avatar pull-left" style="background-image: url('+p.logo+')"></div> <div class="project-name">'+p.title+"</div> ","all"==p.visibility?n+=' <span class="label visibility-label">'+tb_i18n.get("public")+"</span> ":"organization"==p.visibility&&(n+=' <span class="label visibility-label">'+tb_i18n.get("organization.visible")+"</span> "),n+=" </a> </li> ";n+=" </ul> </div> "}else if("task"==s){n+=' <div class="wrapper tasks-wrapper"> <div class="type">'+tb_i18n.get("navigation.task")+'</div> <ul class="task-list"> ';var h=t.data[s];if(h)for(var m,u=-1,f=h.length-1;u<f;)m=h[u+=1],n+=" ",u<3&&(n+=' <li class="li-item task-item" data-id="'+m._id+'" data-type="task"> <a class="clearfix"> <span class="icon icon-checkbox pull-left"></span> <div class="title task-title"> '+m.title+' <span class="task-id-placeholder"></span> </div> </a> </li> '),n+=" ";n+=" </ul> </div> "}else if("event"==s){n+=' <div class="wrapper events-wrapper"> <div class="type">'+tb_i18n.get("navigation.event")+'</div> <ul class="event-list"> ';var g=t.data[s];if(g)for(var v,u=-1,y=g.length-1;u<y;)v=g[u+=1],n+=" ",u<3&&(n+=' <li class="li-item event-item" data-id="'+v._id+'" data-type="event"> <a class="clearfix"> <span class="event-time pull-left">'+v.dateStr+'</span> <div class="title event-title">'+v.title+"</div> </a> </li> "),n+=" ";n+=" </ul> </div> "}else if("post"==s){n+=' <div class="wrapper posts-wrapper"> <div class="type">'+tb_i18n.get("navigation.sharing")+'</div> <ul class="post-list"> ';var b=t.data[s];if(b)for(var k,u=-1,w=b.length-1;u<w;)k=b[u+=1],n+=" ",u<3&&(n+=' <li class="li-item post-item" data-id="'+k._id+'" data-type="post"> <a class="clearfix"> <span class="avatar pull-left img-circle img-24" ',k.avatarUrl&&(n+='style="background-image:url('+k.avatarUrl+');"'),n+='></span> <div class="title post-title">'+(k.title||tb_i18n.get("post.un.title"))+'</div> <div class="post-content">'+k.text+"</div> </a> </li> "),
n+=" ";n+=" </ul> </div> "}else if("work"==s){n+=' <div class="wrapper works-wrapper"> <div class="type">'+tb_i18n.get("navigation.work")+'</div> <ul class="work-list"> ';var _=t.data[s];if(_)for(var j,u=-1,T=_.length-1;u<T;)j=_[u+=1],n+=" ",u<3&&(n+=' <li class="li-item work-item" data-id="'+j._id+'" data-type="work"> <a class="clearfix"> '+r(j)+' <span class="title work-title">'+j.title+"</span> </a> </li> "),n+=" ";n+=" </ul> </div> "}else if("entry"==s){n+=' <div class="wrapper entries-wrapper"> <div class="type">'+tb_i18n.get("bookkeeping")+'</div> <ul class="entry-list"> ';var M=t.data[s];if(M)for(var C,u=-1,x=M.length-1;u<x;)C=M[u+=1],n+=" ",u<3&&(n+=' <li class="li-item entry-item" data-id="'+C._id+'" data-type="entry"> <a class="clearfix"> <div class="title entry-title">'+C.title+'</div> <div class="entry-amount ',n+=1==C._type?"income":"expense",n+='">'+e(C.amount)+"</div> </a> </li> "),n+=" ";n+=" </ul> </div> "}n+=" "}return n+="</div>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;a=i(358),p=i(678),l=i(679),c=i(1484),s=i(788),n=i(1485),o=i(1486),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="InternationalTipView",e.prototype.className="international-tip-view col-flex",e.prototype.events={"click .close-handler":"hide"},e.prototype.initialize=function(t){return this.type=t,e.__super__.initialize.apply(this,arguments),this.show()},e.prototype.show=function(){var t;return c.isInternational()?this.$el.html(n()):this.$el.html(o()),t=this.$el.css({opacity:0}),a.delay(function(){return t.transition({opacity:1},400,"ease-in")},300)},e.prototype.hide=function(){if(!this.isHidden)return this.isHidden=!0,this.$el.transition({opacity:0},218,function(t){return function(){return t.remove()}}(this))},e}(s)},function(t,e,i){var n,r,o;o=i(678),r=i(679),n="international-tip",e.isInternational=function(){var t,e,i,n;return t=0===(null!=(i=r.INTERNATIONAL_HOST)?i.indexOf("http://"+location.host):void 0),e=0===(null!=(n=r.INTERNATIONAL_HOST)?n.indexOf("https://"+location.host):void 0),t||e},e.isShowTip=function(){var t,e;return!!r.FEATURES.userMenu_international&&(e=o.PREFERENCE.get("tips")||{},t=!e[n],t&&o.PREFERENCE.updateFeatureGuide(n),t)}},function(t,e,i){t.exports=function(t){var e="",n=i(679);return e+='<h3 class="international-tip-title"> <p>Teambition</p> <p>'+tb_i18n.get("international.inner.title")+'</p></h3><p class="international-tip-description on-china"> '+tb_i18n.get("international.tip.inner.description")+'</p><a class="btn btn-primary" href="'+n.CHINA_HOST+'"> '+tb_i18n.get("international.tip.inner.switch")+'</a><a class="btn close-handler international-tip-cancel">'+tb_i18n.get("cancel")+"</a>"}},function(t,e,i){t.exports=function(t){var e="",n=i(679);return e+='<h3 class="international-tip-title"> <p>Teambition</p> <p>'+tb_i18n.get("international.outer.title")+'</p></h3><p class="international-tip-description on-international"> '+tb_i18n.get("international.tip.outer.description")+'</p><a class="btn btn-primary" href="'+n.INTERNATIONAL_HOST+'"> '+tb_i18n.get("international.tip.outer.switch")+'</a><a class="btn close-handler international-tip-cancel">'+tb_i18n.get("cancel")+"</a>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y=function(t,e){function i(){this.constructor=t}for(var n in e)b.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},b={}.hasOwnProperty;f=i(358),v=i(678),g=i(679),u=i(677),l=i(681),a=i(680),r=i(401),d=i(792),m=i(810),c=i(813),o=i(1322),s=i(1324),h=i(966),n=i(1488),t.exports=p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.viewName="SubmitTicketView",e.prototype.className="submit-ticket-view",e.prototype.events={"input .help-type":"switchType","input .email-input":"cacheTicket","focusin .help-input":"focusInput","focusout .help-input":"blurInput","click .add-work-handler":"toggleWorksPicker","click .submit-handler":"submit","mousewheel .help-input":u.mousewheel},e.prototype.initialize=function(t){return this.popoverTitle=tb_i18n.get("submit.ticket.title"),this.localCache=l.namespace("temp"),this.localCacheId="submitTicket",e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){var t,e;return this.ticket=this.localCache(this.localCacheId)||{},t=f.filter(this.ticket.attachments,function(t){return t.completed!==!1}),this.attachments=new m(t,{boundToObjectType:"collection",_boundToObjectId:null}),e=/@mail\.teambition\.com$/.test(v.user.get("email")),this.$el.html(n({isAutoEmail:e})),this.$typeSelect=this.$(".help-type"),this.$helpInput=this.$(".help-input"),this.$emailInput=this.$(".email-input"),this.$inputWrap=this.$(".input-wrap"),this.$editorWrap=this.$(".editor-wrap"),this.$attachmentsList=this.$(".attachments-list"),this.$submit=this.$(".submit-handler"),this.$typeSelect[0].selectedIndex=this.ticket.typeIndex,this.switchType(),e||this.$emailInput.val(this.ticket.email||v.user.get("email")),this.$helpInput.val(this.ticket.content).flexText(function(t){return function(){return t.cacheTicket()}}(this)),this.$helpInput.focusAtEnd(),this.attachments.each(function(t){return function(e){return t.renderAttachment(e)}}(this)),this.initUploader().listen(),this},e.prototype.listen=function(){return this.listenTo(this.attachments,"add",this.renderAttachment),this.listenTo(this.attachments,"add change remove",this.cacheTicket),this},e.prototype.initUploader=function(){var t,e;return null!=(e=this.FileUploaderView)&&e.remove(),t={collection:this.attachments,pick:null,dnd:this.$inputWrap,paste:this.$helpInput,server:g.INTEGRATION_HOST+"/zendesk/attachments/upload",fileSingleSizeLimit:10485760},this.FileUploaderView=this.requestSubView(s,t),this},e.prototype.toggleWorksPicker=function(t){var e;return e=$(t.currentTarget),e.data("bs.popover")||this.requestSubView(o,{collection:this.attachments,server:g.INTEGRATION_HOST+"/zendesk/attachments/upload",fileSingleSizeLimit:10485760,$toggler:e,placement:"auto top"}).show(),this},e.prototype.switchType=function(){var t,e;return t=this.$typeSelect.find("option:selected").index(),e=function(){switch(t){case 0:return tb_i18n.get("submit.ticket.pl.help");case 1:return tb_i18n.get("submit.ticket.pl.suggestion");case 2:return tb_i18n.get("submit.ticket.pl.anything")}}(),this.$helpInput.attr("placeholder",e),this.cacheTicket(),this},e.prototype.focusInput=function(){return this.$editorWrap.addClass("focus"),this},e.prototype.blurInput=function(){return this.$editorWrap.removeClass("focus"),this},e.prototype.renderAttachment=function(t){return this.requestSubView(h,{workModel:t}).$el.appendTo(this.$attachmentsList),this.$attachmentsList.scrollTop(999),this.$helpInput.focusAtEnd(),this},e.prototype.cacheTicket=function(){var t,e,i;return i=this.$typeSelect.find("option:selected").index(),t=this.$helpInput.val().trim(),e=this.$emailInput.val().trim(),this.disableSubmit(!t.length||!u.isEmail(e)),this.localCache(this.localCacheId,{typeIndex:i,content:t,email:e,attachments:this.attachments.toJSON()}),this},e.prototype.disableSubmit=function(t){return this.$submit.prop("disabled",t),this.$submit[t?"addClass":"removeClass"]("disabled"),this},e.prototype.submit=function(){var t,e,i,n,o,s,c;if(!this.$submit.prop("disabled")){if(e=this.attachments.getUploadingCount())return void r.show({message:tb_i18n.get("works.uploader.uploading.total",e),status:"warning"});if(c=this.$helpInput.val().trim(),c||this.attachments.length)return i=this.$emailInput.val().trim(),o=this.$typeSelect.val(),t=c,n=("["+o+"] "+t).slice(0,60),s=[],this.attachments.each(function(t){return s.push(t.get("upload").token)}),this.disableSubmit(!0),Promise.resolve().then(function(){return a.ajax({url:g.INTEGRATION_HOST+"/zendesk/tickets/create",type:"POST",data:{name:v.user.get("name"),email:v.user.get("email"),title:n,content:t,uploads:s}})}).then(function(t){return function(){var e;if(e="<a class=essage-url href=mailto:"+i+">"+i+"</a>",r.show({message:tb_i18n.get("submit.ticket.success",e),status:"success"}),t.$el)return t.localCache.remove(t.localCacheId),t.remove()}}(this))["catch"](function(t){return function(e){if(console.error(e),r.show({message:e,status:"error"}),t.$el)return t.disableSubmit(!1),t.$helpInput.focusAtEnd()}}(this)),this}},e}(c)},function(t,e,i){t.exports=function(t){var e="",n=i(679);return e+='<div class="help-form"> <label class="form-control-select"> <select class="help-type form-control"> <option value="问题" selected>'+tb_i18n.get("submit.ticket.question")+'</option> <option value="建议">'+tb_i18n.get("submit.ticket.suggestion")+'</option> <option value="其它">'+tb_i18n.get("submit.ticket.other")+'</option> </select> </label> <div class="editor-wrap"> <div class="input-wrap"> <textarea type="text" class="form-control help-input"></textarea> <a class="add-work-handler hinted" data-title="Attachment"> <span class="icon icon-paperclip"></span> </a> </div> <ul class="attachments-list"> </ul> </div> <div class="email-wrap ',t.isAutoEmail||(e+="hide"),e+='"> <input type="text" placeholder="'+tb_i18n.get("submit.ticket.email")+'" class="form-control email-input"> </div> <a class="btn btn-primary btn-block submit-handler disabled">'+tb_i18n.get("submit.ticket.send")+"</a></div>",n.HELP_CENTER_URL&&(e+='<ul class="menu help-menu"> <li> <a href="'+n.HELP_CENTER_URL+'" target="_blank" data-gta="{action: enter help center, control: Avatar Menu}"> '+tb_i18n.get("submit.ticket.menu.support")+' </a> </li> <li> <a href="/support#video" target="_blank">'+tb_i18n.get("submit.ticket.menu.video")+'</a> </li> <li> <a href="http://e.vhall.com/416648885" target="_blank">'+tb_i18n.get("submit.ticket.menu.online.classroom")+"</a> </li></ul>"),e}},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;r=i(1490),o=i(813),n=i(1491),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="PremiumHelpView",e.prototype.className="premium-help-view",e.prototype.events={"click .intercom-handler":"openIntercom"},e.prototype.initialize=function(t){return this.popoverTitle=tb_i18n.get("submit.ticket.title"),this.intercom=r.getInstance(),e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){return this.$el.html(n()),this},e.prototype.openIntercom=function(){return this.intercom.boot().show(),this.remove(),this},e}(o)},function(t,e,i){var n,r,o,s,a,c=[].slice;o=i(358),s=i(679),a=i(678),r=i(684),n=function(){function t(t){var e,i;this.app_id=t,window.Intercom=function(){return window.Intercom.action(arguments)},window.Intercom.q=[],window.Intercom.action=function(t){return window.Intercom.q.push(t)},e=document.createElement("script"),e.type="text/javascript",e.async=!0,e.src="https://widget.intercom.io/widget/"+this.app_id,i=document.getElementsByTagName("script")[0],i.parentNode.insertBefore(e,i)}return t.prototype.boot=function(){var t,e,i,n,s,c,l;return t=a.user.get("created"),e=a.user.get("locationByIP"),l=r.get(0).filter(function(t){var e;return e=t.getPaymentPlan(),"paid"===e.status&&!e.isOverdue&&t.get("_roleId")>=0}),i={app_id:this.app_id,userKey:a.user.id,name:a.user.get("name"),email:a.user.get("email"),created_at:new Date(t).valueOf()/1e3|0,language:a.PREFERENCE.getLanguage(),env:a.env,version:a.version,daysSinceRegistered:Math.floor((Date.now()-new Date(t))/864e5),city:e.city,country:e.country,region:e.region},l.length&&(c=o.sample(l),s=c.getPaymentPlan(),o.extend(i,{company:{id:c.get("_id"),name:c.get("name"),plan:s.membersLimit,memberCount:s.membersLimit,created_at:new Date(t).valueOf()/1e3|0,expired:new Date(s.expired).valueOf()/1e3|0},organizations:function(){var t,e,i;for(i=[],t=0,e=l.length;t<e;t++)n=l[t],i.push(n.get("_id"));return i}().join(),orgRole:function(){switch(c.get("_roleId")){case 2:return"拥有者";case 1:return"管理员";case 0:return"成员"}}()})),window.Intercom("boot",i),this},t.prototype.update=function(){var t;return t=1<=arguments.length?c.call(arguments,0):[],window.Intercom.apply(window,["update"].concat(c.call(t))),this},t.prototype.shutdown=function(){return window.Intercom("shutdown"),this},t.prototype.hide=function(){return window.Intercom("hide"),this},t.prototype.show=function(){return window.Intercom("show"),this},t.prototype.showMessages=function(){return window.Intercom("showMessages"),this},t.prototype.showNewMessage=function(){var t;return t=1<=arguments.length?c.call(arguments,0):[],window.Intercom.apply(window,["showNewMessage"].concat(c.call(t))),this},t.prototype.onHide=function(t){return window.Intercom("onHide",t),this},t.prototype.onShow=function(t){return window.Intercom("onShow",t),this},t.prototype.onActivatorClick=function(t){return window.Intercom("onActivatorClick",t),this},t.prototype.trackEvent=function(){var t;return t=1<=arguments.length?c.call(arguments,0):[],window.Intercom.apply(window,["trackEvent"].concat(c.call(t))),this},t}(),t.exports={getInstance:function(){return a.intercom?a.intercom:a.intercom=new n(s.INTERCOM_APP_ID)}}},function(t,e,i){t.exports=function(t){var e="",n=i(679);return e+='<div class="help-container flex"> <a class="help-item illustration illustration-consultant intercom-handler" data-gta="{action: \'chat with us\'}"> <p class="item-name">'+tb_i18n.get("submit.ticket.chat.with.us")+'</p> </a> <a href="'+n.HELP_CENTER_URL+'" target="_blank" class="help-item illustration illustration-help-center" data-gta="{action: \'enter help center\'}"> <p class="item-name">'+tb_i18n.get("submit.ticket.menu.support")+'</p> </a> <a href="/support#video" target="_blank" class="help-item illustration illustration-usage-videos"> <p class="item-name">'+tb_i18n.get("submit.ticket.menu.video")+'</p> </a> <a href="http://e.vhall.com/416648885" target="_blank" class="help-item illustration illustration-online-course"> <p class="item-name">'+tb_i18n.get("submit.ticket.menu.online.classroom")+"</p> </a></div>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m=function(t,e){function i(){this.constructor=t}for(var n in e)f.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},f={}.hasOwnProperty;d=i(358),h=i(678),p=i(797),c=i(1307),a=i(1305),u=i(786),l=i(813),s=i(1308),r=i(1312),n=i(1493),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.viewName="ChatNavPopoverView",e.prototype.className="chat-nav-popover-view",e.prototype.popoverTitle="Chat Navigation Popover",e.prototype.isHidden=!0,e.prototype.events={"click .close-handler":"onClose","click .open-modal-handler":"onOpenModal","click .start-chat-handler":"onStartChat","click .clear-unread-handler":"onReadAll"},e.prototype.initialize=function(t){return null==t&&(t={}),this.options=t,this.chatsCollection=c.get("chats"),e.__super__.initialize.apply(this,arguments),this},e.prototype.listen=function(){return this.listenTo(this.chatsCollection,"add",function(t){return function(e){return t.messageListView.onAdd(e)}}(this)),this.listenTo(this.chatsCollection,"change:unreadActivitiesCount",function(t){return function(e,i){if(i>0)return t.messageListView.onLead(e)}}(this)),this.listenTo(this.chatsCollection,"destroy remove",function(t){return function(e){return 0===t.chatsCollection.getAllMessagesCount()?t.messageListView.onEmpty():t.messageListView.onRemove(e)}}(this))},e.prototype.show=function(){return this.isHidden=!1,e.__super__.show.apply(this,arguments)},e.prototype.hide=function(){return this.isHidden=!0,e.__super__.hide.apply(this,arguments)},e.prototype.loadMore=function(){if(!this.chatsCollection.isComplete)return this.onRequestMore()},e.prototype.onClose=function(t){return t.stopPropagation(),this.hide()},e.prototype.onOpenModal=function(){return this.hide(),this.onShowChatModel(null)},e.prototype.onReadAll=function(){return this.chatsCollection.onMarkAllMessagesReaded()},e.prototype.onRequest=function(){return this.stopListening(),this.messageListView.onLoading(),this.chatsCollection.reset(),this.chatsCollection.fetch().then(function(t){return function(){var e;return t.messageListView?(t.messageListView.onLoaded(),e=t.chatsCollection.getAllMessages(),t.messageListView.onSetup(e),t.listen()):Promise.reject()}}(this))["catch"](function(t){return function(e){if(e)return t.messageListView.onError()}}(this))},e.prototype.onRequestMore=function(){var t;return t={remove:!1},this.messageListView.onLoading(),this.chatsCollection.fetch(t).then(function(t){return function(){return t.messageListView?t.messageListView.onLoaded():Promise.reject()}}(this))["catch"](function(t){return function(e){if(e)return t.messageListView.onError()}}(this))},e.prototype.onShowChatModel=function(t){return a.open({hasRequested:!0,activeMessageId:t})},e.prototype.onShown=function(){return e.__super__.onShown.apply(this,arguments),this.onRequest(),this},e.prototype.onStartChat=function(t){return t.stopPropagation(),this.hide(),this.requestSubView(u).open(s,{onItemClick:function(t){return function(e){var i;return i=t.chatsCollection.getMessage(e),t.onShowChatModel(i.id)}}(this)}),h.gta.event({action:"begin new chat",control:"Navigation Tab Chat List"})},e.prototype.render=function(){var t;return this.$el.html(n()),this.messageListView=this.requestSubView(r,{from:"Navigation Tab Chat List",onClick:function(t){return function(e){return t.hide(),t.onShowChatModel(e)}}(this),onRefresh:function(t){return function(){return t.messageListView.onReset(),t.onRequest()}}(this)}),t=this.$(".chat-nav-popover-body"),t.html(this.messageListView.$el),this.setupScroll(this.messageListView.$el),this},e}(l),d.extend(o.prototype,p),t.exports=o},function(t,e){t.exports=function(t){var e='<div class="chat-nav-popover-container"> <div class="chat-nav-popover-header"> <div class="chat-nav-popover-title"> <center> '+tb_i18n.get("chat.modal.title")+' </center> </div> <a class="close-handler"> <i class="icon icon-remove"></i> </a> </div> <div class="chat-nav-popover-body"> <!-- chat messages --> </div> <div class="chat-nav-popover-footer"> <a class="start-chat-handler"> <i class="icon icon-circle-cross"></i> '+tb_i18n.get("chat.nav.popover.new.chat")+" </a> </div></div>";return e}},function(t,e,i){t.exports=function(t){var e="",n=i(679),r=i(798),o=i(1495)("./"+t.logo+".svg"),s=n.FEATURES,a=i(1484),c=a.isInternational();return e+='<header class="nav-header"> <a class="logo on-'+t.logo+'" style="background-image: url('+o+')" data-gta="{action: \'open projects page\', control: \'Logo\'}"></a></header><section class="nav-body"> ',t.isGhost||(e+=' <div class="nav-body-handler-set clearfix"> <a class="nav-body-handler projects-handler" data-gta="{action: \'open projects page\', control: \'Navigation Tab\'}"> '+tb_i18n.get("projects")+" </a> <a class=\"nav-body-handler organization-switcher-handler\" data-gta=\"{action: 'open organization tab', control: 'Navigation Tab'}\"> "+tb_i18n.get("organization")+" </a> <a class=\"nav-body-handler my-handler\" data-gta=\"{action: 'open me tab', control: 'Navigation Tab'}\"> "+tb_i18n.get("my")+' <span class="nav-badge" data-mark="task"></span> </a> <a class="nav-body-handler calendar-handler" data-gta="{action: \'open calendar tab\', control: \'Navigation Tab\'}"> '+tb_i18n.get("calendar")+" </a> <a class=\"nav-body-handler inbox-handler\" data-gta=\"{action: 'open inbox tab', control: 'Navigation Tab'}\"> "+tb_i18n.get("inbox")+' <span class="nav-badge" data-mark="message">',t.normal>0&&(e+=""+t.normal),e+='</span> </a> </div> <div class="nav-search"> <span class="icon icon-search"></span> <input class="nav-search-input" type="search" placeholder="'+tb_i18n.get("search")+'" /> </div> '),e+='</section><footer class="nav-footer"> ',t.isGhost?e+=' <div class="nav-ghost-btns"> <button class="btn btn-default login-handler">'+tb_i18n.get("login")+'</button> <button class="btn btn-primary register-handler">'+tb_i18n.get("register")+"</button> </div> ":(e+=' <a class="new-ribbon ',t.hasNewVersion||(e+="hide"),e+="\" data-gta=\"{action: 'new ribbon', control: 'Navigation Tab'}\" href=\"",e+="zh"==t.language?""+r.blog.zh.updates:""+r.blog.en.updates,e+='" target="_blank">'+tb_i18n.get("new.ribbon")+'</a> <div class="nav-footer-wrap user-footer-wrap"> <a class="nav-footer-handler" data-mark="my" data-toggle="dropdown" data-gta="{action: \'open avatar menu\', control: \'Navigation Tab\'}" > <span class="avatar img-circle personal-avatar" style="background-image:url('+t.avatarUrl+');"> ',"paid"!==t.plan.status||t.isExpiring?"paid"===t.plan.status&&t.isExpiring&&(e+=' <span class="img-circle pro-spot pro-spot-danger"></span> '):e+=' <span class="img-circle pro-spot pro-spot-star"></span> ',e+=' </span> <span class="nav-badge" data-mark="international">'+(t.crossNotify&&t.crossNotify.badge||"")+'</span> </a> <ul class="dropdown-menu card my-menu-list"> ',s.userMenu_personalCenter&&(e+=' <li> <a href="'+t.accountHost+'/my" target="_blank" data-gta="{action: \'enter account center\', control: \'Avatar Menu\'}">'+tb_i18n.get("navigation.account.personalCenter")+"</a> </li> "),e+=" <li> <a class=\"my-settings-handler\" data-gta=\"{action: 'enter my settings', control: 'Avatar Menu'}\">"+tb_i18n.get("user.settings.setting")+"</a> </li> ","trial"===t.plan.status?e+=' <li class="uponscore"> <a class="url-handler" href="'+r.pay.plans+"\" target=\"_blank\" data-gta=\"{action: 'view plan option', control: 'upgrade', type: 'plus'}\"> "+tb_i18n.get("upgrade")+" </a> </li> ":"paid"===t.plan.status&&t.isExpiring&&(e+=' <li class="uponscore"> <a class="url-handler renew-handler" href="'+r.pay.userRenew+'" target="_blank" data-gta="{action: \'view plan option\', control: \'renew\', type: \'plus\'}"> <div class="profession-expired"> '+tb_i18n.get("profession.expired")+" </div> "+tb_i18n.get("renew")+" </a> </li> "),e+=' <li class="uponscore line"></li> ',s.userMenu_community&&(e+=' <li> <a href="'+r.bbs.root+'" data-gta="{action: \'enter community\', control: \'Avatar Menu\'}" target="_blank">'+tb_i18n.get("navigation.enterBBS")+"</a> </li> "),e+=' <li> <a class="hotkey-handler" data-gta="{action: \'show hotkey list\', control: \'Avatar Menu\'}" data-label="hotkey helper">'+tb_i18n.get("helper.shortcuts")+"</a> </li> ",s.userMenu_app&&(e+=' <li> <a href="/apps" data-gta="{action: \'enter app download\', control: \'Avatar Menu\'}"target="_blank">'+tb_i18n.get("app.download")+"</a> </li> "),e+=' <li class="uponscore line"></li> ',s.userMenu_international&&teambition.ab.hasTest("international")&&(e+=" ",e+=c?' <li class="international-wrap"> <a href="'+n.CHINA_HOST+'">'+tb_i18n.get("international.tip.inner.switch")+'</a> <span class="nav-badge" data-mark="international-link">'+(t.crossNotify&&t.crossNotify.badge||"")+"</span> </li> ":' <li class="international-wrap"> <a href="'+n.INTERNATIONAL_HOST+'">'+tb_i18n.get("international.tip.outer.switch")+'</a> <span class="nav-badge" data-mark="international-link">'+(t.crossNotify&&t.crossNotify.badge||"")+"</span> </li> ",e+=" "),e+=" <li> <a class=\"logout-handler\" data-gta=\"{action: 'log out', control: 'Avatar Menu'}\">"+tb_i18n.get("logout")+'</a> </li> </ul> </div> <div class="nav-footer-wrap"> <a class="nav-footer-handler" data-mark="create" data-gta="{action: \'open global add menu\', control: \'Global Add Button\'}" data-toggle="dropdown"> <span class="img-icon img-icon-circle-cross-32"></span> </a> <div class="nav-creator-menu dropdown-menu card"> <ul class="pro-org-list"> <li class="create-project" data-gta="{action: \'add content\', type: \'project\' control: \'Global Add Menu\'}"> <span class="icon icon-project"></span>'+tb_i18n.get("navigation.project")+" </li> <li class=\"create-organization\" data-gta=\"{action: 'add content', type: 'organization' control: 'Global Add Menu'}\"> <span class=\"icon icon-building\"></span>"+tb_i18n.get("navigation.organization")+" </li> </ul> ",t.hasProject&&(e+=' <ul class="meta-list uponscore"> <li class="create-task" data-gta="{action: \'add content\', type: \'task\' control: \'Global Add Menu\'}"> <span class="icon icon-board"></span>'+tb_i18n.get("navigation.task")+' </li> <li class="create-file" data-gta="{action: \'add content\', type: \'file\' control: \'Global Add Menu\'}" data-gta-ignore="input"> <div class="create-file-replace"> <span class="icon icon-file"></span>'+tb_i18n.get("navigation.work")+" </div> </li> <li class=\"create-event\" data-gta=\"{action: 'add content', type: 'event' control: 'Global Add Menu'}\"> <span class=\"icon icon-calendar\"></span>"+tb_i18n.get("navigation.event")+" </li> <li class=\"create-sharing\" data-gta=\"{action: 'add content', type: 'post' control: 'Global Add Menu'}\"> <span class=\"icon icon-wall\"></span>"+tb_i18n.get("navigation.sharing")+" </li> </ul> "),e+=' </div> </div> <div class="nav-footer-wrap"> <a class="nav-footer-handler" data-gta="{action: \'open chat list\', control: \'Navigation Tab\'}" data-mark="chat"> <span class="icon icon-chat-group"></span> <span class="nav-badge" data-mark="chat"></span> </a> </div> <div class="nav-footer-wrap"> <a class="nav-footer-handler" data-mark="search"> <span class="icon icon-search"></span> <span class="icon icon-remove"></span> </a> </div> ',n.HELP_CENTER_URL&&(e+=' <div class="nav-footer-wrap nav-question"> <a class="nav-footer-handler" data-mark="help" data-gta="{action: \'add feedback\', control: \'Navigation Tab\'}"> <span class="icon icon-circle-question"></span> </a> </div> '),e+=" "),e+='</footer><div class="navigation-search-layer"></div>'}},function(t,e,i){function n(t){return i(r(t))}function r(t){return o[t]||function(){throw new Error("Cannot find module '"+t+"'.")}()}var o={"./chinese-valentines.svg":1496,"./european-cup.svg":1497,"./logo.svg":1498,"./olympic.svg":1499,"./rio-olympic.svg":1500};n.keys=function(){return Object.keys(o)},n.resolve=r,t.exports=n,n.id=1495},function(t,e,i){t.exports=i.p+"images/chinese-valentines.1bb92c63.svg"},function(t,e,i){t.exports=i.p+"images/european-cup.31ba5b27.svg"},function(t,e,i){t.exports=i.p+"images/logo.532c7f46.svg"},function(t,e,i){t.exports=i.p+"images/olympic.b83b0c71.svg"},function(t,e,i){t.exports=i.p+"images/rio-olympic.103aa098.svg"},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_=function(t,e){function i(){this.constructor=t}for(var n in e)j.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},j={}.hasOwnProperty;k=i(358),w=i(678),v=i(788),g=i(677),b=i(786),y=i(1502),o=i(1506),p=i(1562),c=i(1707),l=i(1720),s=i(1721),m=i(1736),d=i(1854),h=i(1473),u=i(1779),r=i(1901),a="tasks",n={posts:y,tasks:o,works:p,events:c,groupchat:l,bookkeeping:s,plugin:m},t.exports=f=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return _(e,t),e.prototype.viewName="ProjectAppView",e.prototype.className="project-app-view",e.prototype.initialize=function(t){if(this.$el){if(!t.projectModel)throw new Error("initialize "+this.viewName+" must have projectModel");return this.options=k.extend({},t),this.projectModel=t.projectModel,this.renderNavigation(),k.delay(function(t){return function(){return t.navigationView.refreshNavs(),t.projectModel.getPaymentPlan().isExpiring?t.renderExpiring():t.projectModel.getPaymentPlan().isOverdue?t.renderOverdue():void 0}}(this))}},e.prototype.render=function(){return this.$el.html(r()),this.$nav=this.$(".project-app-navigation"),this.$left=this.$(".project-app-content > header"),this.$body=this.$(".project-app-content > section"),this.$right=this.$(".project-app-content > footer")},e.prototype.renderNavigation=function(){var t;return t={projectModel:this.projectModel},this.navigationView=this.requestSubView(u,t),this.$el.append(this.navigationView.$el)},e.prototype.renderApp=function(t,e){var i,r,o;if(r=this.projectModel.getNavigations(),~r[t]||(t=a),i=n[t],this.currentAppName!==t){if(this.currentAppName=t,null!=(o=this.currentAppView)&&o.remove(),this.currentAppView=this.requestSubView(i,e),!this.$el)return;this.$el.append(this.currentAppView.$el)}return this.navigationView.setApp(t),w.router.checkRoute(e.routeString,this.currentAppView)},e.prototype.renderOverdue=function(){return this.requestSubView(b).open(h,{inProject:!0,_organizationId:this.projectModel.get("_organizationId"),projectModel:this.projectModel,onclose:function(){return w.router.navigate("/projects",{trigger:!0})}}),this},e.prototype.renderExpiring=function(){return this.requestSubView(d,{_organizationId:this.projectModel.get("_organizationId")}),this},e.prototype.updateUrl=function(t,e){var i;return"function"==typeof(i=this.currentAppView).updateUrl?i.updateUrl(t,e):void 0},e}(v)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M=function(t,e){function i(){this.constructor=t}for(var n in e)C.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},C={}.hasOwnProperty;w=i(358),T=i(678),r=i(401),_=i(679),h=i(797),m=i(1299),g=i(677),v=i(788),j=i(1044),k=i(792),l=i(1042),s=i(699),u=i(1041),d=i(696),f=i(1053),a=i(1043),c=i(1277),b=i(786),n=i(1503),o=i(1504),p=i(1505),y=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return M(e,t),e.prototype.viewName="WallView",e.prototype.className="wall-view card fade",e.prototype.orderBy="created",e.prototype.hotkeys={c:"openPostCreator"},e.prototype.routes={":section(/:type)(/:_modelId)":"enterSection","*paramString":"home"},e.prototype.events={"click .post":"onClickPost","click .open-post-creator-handler, .post-creator-btn":"openPostCreator","click .yiqixie-creator-btn":"openYiqixieEditor","click .wall-switcher-btn":"nav","click .sort-handler":"switchSort"},e.prototype.initialize=function(t){var e;if(null!=t?t._projectId:void 0)return this.options=t,this._projectId=t._projectId,e=_.HOST+_.API_HOST+"/shimo/create?_projectId="+this._projectId+"&_userId="+T.user.get("_id"),this.shimoUrl=_.SHIMO_HOST+"/sso/login/teambition?callback="+encodeURIComponent(e)+"&providerUser="+T.user.get("_id"),this.projectModel=d.getOne(0,this._projectId),this.postsCollection=u.get(this._projectId,{boundToObjectType:"project"}),this.membersCollection=s.get(this._projectId),this.tagsCollection=f.get(this._projectId),this.renderBasic().listen().setupScroll(this.$(".posts-navigator")),w.delay(function(t){return function(){return t.$el.addClass("in")}}(this)),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$header=this.$(".wall-left-column-header"),this.$postsWrapper=this.$(".posts-wrapper"),this.$posts=this.$(".posts-list"),this.$nav=this.$(".wall-switcher-nav"),this.$detail=this.$(".post-detail-wrapper"),this.$postsPlaceholder=this.$(".posts-placeholder"),this},e.prototype.listen=function(){return this.listenTo(this.postsCollection,"add",function(t){return function(e){return t.checkPlaceholder(),t.renderPost(e,!0)}}(this)),this.listenTo(this.postsCollection,"change",this.renderPost),this.listenTo(this.postsCollection,"change:pin change:lastCommentedAt",function(t){return function(){return t.renderPosts()}}(this)),this.listenTo(this.postsCollection,"remove",function(t){return function(e){return t.removePost(e),t.checkPlaceholder()}}(this)),this.listenTo(this.projectModel,"change:applications",function(){var t,e,i,n,r;for(e=!1,r=["markdown","shimo","yiqixie"],t=0,i=r.length;t<i;t++)if(n=r[t],this.projectModel.isAppChanged(n)){e=!0;break}if(e)return this.renderHeader().renderSort()}),this},e.prototype.home=function(){return this.enterSection("all"),this},e.prototype.enterSection=function(t,e,i){var n;return n=this.postsCollection.getType(t),t!==n&&(i=e,e=t,t=n),t!==this.section&&(this.section=t,this.renderHeader({section:t}),this.postsCollection.reset()),this.load({type:e,_modelId:i}),this},e.prototype.load=function(t){
return new Promise(function(t){return function(e,i){return u.fetch(t._projectId,{remove:!1,silent:!0,section:t.section,beforeSend:function(){return t.showLoadingIndicator(t.$posts,{isPrepend:!0})},success:function(i){if(t.$el)return t.hideLoadingIndicator(),t.renderPosts(),t.checkPlaceholder(),e()},error:function(t,e){return i(e)}})}}(this)).then(function(e){return function(){var i;return i=t._modelId,new Promise(function(t,n){return i&&!e.postsCollection.get(i)?e.postsCollection.fetchOne(i,{success:function(i){return e.renderPosts(),t()},error:function(t,e){return n(e)}}):t()})}}(this)).then(function(e){return function(){var i,n;return i=t._modelId,i||(i=null!=(n=e.postsCollection.at(0))?n.id:void 0),e.openDetail(i,null,!0)}}(this))["catch"](function(t){return console.error(t)}),this},e.prototype.loadMore=function(t){var e,i,n;return n=e=0,i=this.postsCollection.getType(this.section),this.postsCollection.loadMore({silent:!0,section:i,beforeSend:function(t){return function(){return n=(new Date).getTime(),t.showLoadingIndicator(t.$posts)}}(this),success:function(i){return function(r,o,s){var a,c;if(i.$el)return e=(new Date).getTime(),c=e-n,a=c<1e3?1e3-c:0,w.delay(function(){return i.hideLoadingIndicator({animated:!0}),i.renderPosts(o),i.postsCollection.hasMore?"function"==typeof t?t():void 0:i.showEndPoint(i.$posts)},a)}}(this)}),this},e.prototype.renderHeader=function(t){return null==t&&(t={}),t.section||(t.section=this.section),t.shimoUrl=this.shimoUrl,t.permissions=this.projectModel.hasPermissions("post.post"),t.plugins=this.projectModel.getPlugins(),t.projectId=this.projectModel.get("_id"),t.orgId=this.projectModel.get("_organizationId"),this.$header.html(o(t)),this},e.prototype.renderPosts=function(t){var e;return t?e=w.isArray(t)?t:[t]:(this.$posts.empty(),this.postsCollection.orderBy=this.orderBy,this.postsCollection.sort(),this.renderSort(),e=this.postsCollection.toJSON()),w.each(e,function(t){return function(e){return t.renderPost(e)}}(this)),this.checkPlaceholder(),this},e.prototype.renderPost=function(t,e){var i,n,r,o,s,a,c;return i=this.$posts,(s="function"==typeof t.toJSON?t.toJSON():void 0)||(s=g.parsePost(t)),s.orderBy=this.orderBy,s.creator=null!=(a=this.membersCollection.get(s._creatorId))?a.toJSON():void 0,s.creator||(s.creator={_id:"",avatarUrl:"",name:""}),s.latestActivity&&(s.latestActivity.creator=(null!=(c=this.membersCollection.get(s.latestActivity._creatorId))?c.toJSON():void 0)||{_id:"",avatarUrl:"",name:""}),s.tags=this.tagsCollection.getTagsbyIds(s.tagIds),r=$(p(s)),e===!0?(n=this.$(".pin").last(),n.length?n.afterH(r):i.prepend(r)):(o=i.find("[data-id="+s._id+"]"),o.length?o.replaceWith(r):i.append(r)),r.find("time").timesince(),this.currentPostId===t.id&&r.addClass("active"),r},e.prototype.renderSort=function(){var t,e,i;return i=this.orderBy,e=".sort-handler",this.$el.find(e+" .icon").remove(),t=this.$el.find(e+"[data-type="+i+"]"),t.append("<span class='icon icon-tick'></span>"),this},e.prototype.removePost=function(t){var e,i;return this.$posts.find("[data-id="+t.id+"]").remove(),this.currentPostId=null,e=this.prevPostId||(null!=(i=this.postsCollection.at(0))?i.id:void 0),e?this.openDetail(e):this.checkPlaceholder(),this},e.prototype.checkPlaceholder=function(){return this.$postsPlaceholder[this.postsCollection.length?"hide":"show"](),this},e.prototype.onClickPost=function(t){var e;return e=$(t.currentTarget),this.openDetail(e.data("id"),e),this},e.prototype.openDetail=function(t,e,i){if(t&&!(t===this.currentPostId&&this.currentView instanceof c))return this.prevPostId=this.currentPostId,this.currentPostId=t,this.open(c,this.$detail,{_projectId:this._projectId,where:"wall",postModel:this.postsCollection.get(t)}),this.$posts.find(".post.active").removeClass("active"),e||(e=this.$posts.find("[data-id="+t+"]")),e.addClass("active"),this.updateUrl({type:"post",_modelId:t},{trigger:!1,replace:i}),this},e.prototype.openPostCreator=function(t){var e,i;return e=$(null!=t?t.currentTarget:void 0).data("type"),"md"!==e&&(e="html"),null!=(i=this.postCreatorView)&&i.remove(),this.postCreatorView=this.requestSubView(b).open(a,{backdrop:"static",_projectId:this._projectId,postMode:e,isEssage:!1,isYiqixie:!1,onsave:function(t){return function(e){return t.postsCollection.add(e),t.openDetail(e.id)}}(this)}),this},e.prototype.openYiqixieEditor=function(t){return j.createYiqixie(this._projectId).then(function(t){return function(e){return t.postCreatorView=t.requestSubView(b).open(a,{backdrop:"static",_projectId:t._projectId,postMode:"html",isEssage:!1,isYiqixie:!0,yiqixieUrl:e,onsave:function(e){return t.postsCollection.add(e),t.openDetail(e.id)}})}}(this))["catch"](function(t){return r.show({message:t,status:"error"})})},e.prototype.switchSort=function(t){var e,i;return e=$(t.currentTarget),(i=e.data("type"))?(i!==this.orderBy&&(this.orderBy=i,this.renderPosts()),this):this},e.prototype.open=function(t,e,i){var n;return null!=(n=this.currentView)&&n.remove(),this.currentView=this.requestSubView(t,i),e.html(this.currentView.$el),this},e.prototype.nav=function(t){var e,i;if(e=$(t.currentTarget),i=e.data("section"),i!==this.section)return this.updateUrl({section:i},{trigger:!0}),this},e.prototype.updateUrl=function(t,e){var i,n;return e=e||{},n=T.router.getPrefix()+"/posts",i=t.section?this.postsCollection.getType(t.section):this.section,"all"!==i&&(n+="/"+i),t.type&&(n+="/"+t.type),t._modelId&&(n+="/"+t._modelId),t.params&&(n+="/"+t.params),T.router.navigate(n,e),this},e}(v),w.extend(y.prototype,h),t.exports=y},function(t,e){t.exports=function(t){var e='<div class="wall-wrap"> <div class="wall-left-column"> <header class="wall-left-column-header clearfix"></header> <nav class="posts-navigator thin-scroll"> <ul class="posts-list"></ul> <div class="posts-placeholder placeholder muted"> <a class="icon icon-wall"></a> <br /> '+tb_i18n.get("post.placeholder")+' </div> </nav> </div> <div class="wall-right-column"> <div class="post-detail-wrapper"></div> </div></div>';return e}},function(t,e){t.exports=function(t){var e='<div class="btn-group wall-switcher pull-left"> <a class="btn btn-link dropdown-toggle" data-toggle="dropdown" data-gta="event" data-label="expand post list menu"> ';return e+="my"===t.section?""+tb_i18n.get("my.post"):""+tb_i18n.get("all"),e+=' <span class="icon icon-chevron-down"></span> </a> <ul class="dropdown-menu"> <li> <a class="wall-switcher-btn" data-section="all" data-gta="event" data-label="show all posts">'+tb_i18n.get("all")+'</a> </li> <li> <a class="wall-switcher-btn" data-section="my" data-gta="event" data-label="show my posts">'+tb_i18n.get("my.post")+'</a> </li> <li class="divider"></li> <li> <a class="wall-order-btn sort-handler" data-type="created" data-gta="event" data-label="post order by issue date">'+tb_i18n.get("wall.view.post.order.create.time")+'</a> </li> <li> <a class="wall-order-btn sort-handler" data-type="lastCommentedAt" data-gta="event" data-label="post order by reply date">'+tb_i18n.get("wall.view.post.order.reply.time")+"</a> </li> </ul></div>",t.permissions.postPost&&(e+="<div class=\"btn-group post-create-wrap pull-right\"> <a class=\"btn btn-link open-post-creator-handler link-add-handler\" data-gta=\"{action: 'add content', type: 'post', control: 'Add Post', method: 'normal'}\"> <span class=\"icon icon-circle-cross\"></span>"+tb_i18n.get("wall.view.create.post")+" </a> ",(t.plugins.markdown||t.plugins.shimo||t.plugins.yiqixie)&&(e+=' <a class="btn btn-link dropdown-toggle post-mode-handler" data-toggle="dropdown" data-gta="{action: \'toggle add post menu\', type: \'post\', control: \'Add Post\'}"> <span class="icon icon-chevron-down"></span> </a> '),e+=" <ul class=\"dropdown-menu\"> <li> <a class=\"post-creator-btn\" data-type=\"html\" data-gta=\"{action: 'add content', type: 'post', control: 'Add Post', method: 'normal'}\"> "+tb_i18n.get("wall.view.html.post")+" </a> </li> ",t.plugins.markdown&&(e+=" <li> <a class=\"post-creator-btn\" data-type=\"md\" data-gta=\"{action: 'add content', type: 'post', control: 'Add Post', method: 'markdown' ",t.projectId&&(e+=", projectid: '"+t.projectId+"'"),t.orgId&&(e+=", organizationid: '"+t.orgId+"'"),e+='}"> '+tb_i18n.get("wall.view.markdown.post")+" </a> </li> "),e+=" ",(t.plugins.shimo||t.plugins.yiqixie)&&(e+=' <li class="divider"></li> '),e+=" ",t.plugins.shimo&&(e+=" <li> <a class=\"shimo-creator-btn\" data-type=\"shimo\" data-gta=\"{action: 'add content', type: 'post', control: 'Add Post', method: 'shimo' ",t.projectId&&(e+=", projectid: '"+t.projectId+"'"),t.orgId&&(e+=", organizationid: '"+t.orgId+"'"),e+='}" href="'+t.shimoUrl+'" target="_blank">'+tb_i18n.get("wall.view.shimo.post")+"</a> </li> "),e+=" ",t.plugins.yiqixie&&(e+=" <li> <a class=\"yiqixie-creator-btn\" data-type=\"yiqixie\" data-gta=\"{action: 'add content', type: 'post', control: 'Add Post', method: 'cowrite' ",t.projectId&&(e+=", projectid: '"+t.projectId+"'"),t.orgId&&(e+=", organizationid: '"+t.orgId+"'"),e+='}"> '+tb_i18n.get("wall.view.yiqixie.post")+" </a> </li> "),e+=" </ul></div>"),e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li class="post" data-id="'+t._id+"\" data-type=\"post\" data-gta=\"{action: 'open detail', type: 'post', control: 'Post List'}\"> <section> <div class=\"avatar img-36 img-circle pull-left ";return t.creator.avatarUrl||(i+="no-avatar"),i+='" style="background-image: url('+t.creator.avatarUrl+');"></div> <div class="post-content"> <p class="post-title"> <span class="post-title hinted" data-title="'+t.description+'">'+e(t.description)+'</span> </p> <p class="post-info muted"> '+tb_i18n.get("wall.view.post.creator.info",t.creator.name)+' <time datetime="'+t.created+'"></time> </p> </div> </section> <div class="post-icons"> ',"involves"==t.visible&&(i+=' <span class="icon icon-lock hinted" data-title="'+tb_i18n.get("visible.to.involve")+'"></span> '),i+=" ",t.pin&&(i+=' <span class="icon icon-pin"></span> '),i+=" </div> ","shimo"===t.source&&(i+=' <div class="shimo-logo"> <span class="partition"></span> </div> '),i+="</li>"}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(678),a=i(788),s=i(994),r=i(1507),o=i(1534),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="BoardView",e.prototype.className="board-view ",e.prototype.hotkeys={g:"toggleTasklistBar",f:"toggleFilterPanel"},e.prototype.routes={"":"enterScrum","scrum(/:_tasklistId)":"enterScrum","scrum/:_tasklistId(/task/:_taskId)":"enterScrum","*paramString":"enterHome"},e.prototype.initialize=function(t){return this._projectId=t._projectId,this.projectModel=t.projectModel,this.listenTo(c.PREFERENCE,"change:pinTasklistBar",this.checkTasklistBar),this.listenTo(this.projectModel,"change:applications",function(){if(this.projectModel.isAppChanged("tasklist"))return this.checkTasklistBar()}),this.load(),this},e.prototype.load=function(){return s.fetch(this._projectId,{success:function(t){return function(e){return t.tasklistsCollection=e,t.checkTasklistBar()}}(this)})},e.prototype.enterHome=function(){return c.router.home(),this},e.prototype.enterScrum=function(t,e){var i;return null!=(i=this.currentView)&&i.remove(),this.projectModel.set({currentTasklistId:t,currentTaskId:e}),this.currentView=this.requestSubView(r,{_tasklistId:t,_taskId:e,_projectId:this._projectId}),this.currentView.$el.appendTo(this.$el),this},e.prototype.updateUrl=function(t,e,i){var n;if(t)return n=c.router.getPrefix()+"/tasks/scrum/"+t,e&&(n=n+"/task/"+e),c.router.navigate(n,{trigger:!1,replace:i}),this},e.prototype.checkTasklistBar=function(){var t,e,i;return i=this.projectModel.isAppEnabled("tasklist"),t=this.tasklistsCollection.length>1,e=c.PREFERENCE.get("pinTasklistBar")&&(t||i),e?this.showTasklistBar():this.hideTasklistBar()},e.prototype.showTasklistBar=function(){var t;return this.$el.addClass("on-pin-tasklist-bar"),this.tasklistBarView=this.requestSubView(o,{_projectId:this._projectId,appendTo:this.$el,holdon:!0}),this.tasklistBarView.show(),t=this.tasklistBarView.$el.css({x:0}),t.transition({x:300},218,"ease")},e.prototype.hideTasklistBar=function(){var t,e;if(null!=(t=this.tasklistBarView)?t.$el:void 0)return this.$el.removeClass("on-pin-tasklist-bar"),null!=(e=this.tasklistBarView)?e.hide():void 0},e.prototype.toggleTasklistBar=function(){if(!c.PREFERENCE.get("pinTasklistBar"))return $(".project-navigation .tasklist-pop-handler").click()},e.prototype.toggleFilterPanel=function(){return $(".project-navigation .nav-menu-handler[data-menu=filter]").click()},e}(a)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m=function(t,e){function i(){this.constructor=t}for(var n in e)f.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},f={}.hasOwnProperty;d=i(358),h=i(678),p=i(677),u=i(788),c=i(995),a=i(992),l=i(994),s=i(1508),o=i(1531),n=i(1533),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.viewName="ScrumView",e.prototype.className="board-scrum-view fade",e.prototype.hotkeys={c:"openTaskCreator"},e.prototype.events={"mousedown .board-scrum-stages":"dragStart"},e.prototype.initialize=function(t){return!(null==t||!t._projectId)&&(this.options=t,this._projectId=t._projectId,this._tasklistId=t._tasklistId,this._taskId=t._taskId,this.tasklistsCollection=null,this.stagesCollection=null,this.preferenceModel=h.PREFERENCE,this.renderBasic(),this.showLoadingIndicator(),this.load().then(function(t){return function(){if(t.$el)return t.hideLoadingIndicator({animated:!0}),t.initView(),t.renderStages(),t.listen()}}(this))["catch"](function(t){return console.error(t)}),d.delay(function(t){return function(){return t.$el.addClass("in")}}(this)),this)},e.prototype.initView=function(){var t,e,i,n;return e=this._tasklistId,t=this._taskId,n=h.router.getPrefix()+"/tasks/scrum/"+e,t&&(n=n+"/task/"+t),h.router.navigate(n,{trigger:!1,replace:!0}),i={isUsePanel:!0,hasLink:!0},t&&h.APP.openTaskPreviewer(t,i),this},e.prototype.listen=function(){return this.listenTo(this.tasklistModel,"remove",function(){var t;return t=h.router.getPrefix()+"/tasks/scrum",h.router.navigate(t,{trigger:!0,replace:!0})}),this.listenTo(this.tasklistModel,"change:stageIds",function(t,e){if(!d.isEqual(e,t.previous("stageIds")))return this.stagesCollection.updateSort(e,!0),this.updateStagesSort()}),this.listenTo(this.stagesCollection,"add",function(t){var e;return e=this.tasklistModel.checkStageIds(t.id,t.get("_prevId")),this.addStage(t),this.stagesCollection.updateSort(e,!0)}),this.listenTo(this.stagesCollection,"remove",function(t){return this.removeStage(t.id)}),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$stages=this.$(".board-scrum-stages"),this},e.prototype.renderStages=function(){return this.$stages.removeClass("sortable").empty(),this.stagesCollection.each(function(t){return function(e,i){var n;if(n=t.renderStage(e),n.$el.appendTo(t.$stages),!i)return t.firstStage=n}}(this)),this.renderStageAppender(),this.tasklistModel.hasPermission("put.stageSort")&&(this.setupStageSortable(),this.$stages.addClass("sortable")),this},e.prototype.renderStage=function(t){var e,i;return e=this.stagesCollection.last(),i=this.requestSubView(s,{_projectId:this._projectId,stageModel:t,tasklistModel:this.tasklistModel,_taskId:this._taskId,isLocked:e.get("isLocked")})},e.prototype.renderStageAppender=function(){return this.tasklistModel.hasPermission("post")&&!this.stagesCollection.last().get("isLocked")&&(this.stageAddView||(this.stageAddView=this.requestSubView(o,{stagesCollection:this.stagesCollection})),this.stageAddView.$el.appendTo(this.$stages)),this},e.prototype.updateStageAppender=function(t){var e,i;return this.stagesCollection.last().get("isLocked")?(null!=(i=this.stageAddView)&&i.$el.remove(),this.stageAddView=null):(this.renderStageAppender(),t?(e=this.$stages.scrollLeft(),this.$stages.scrollLeft(e+290)):void 0)},e.prototype.addStage=function(t){var e,i;return e=this.renderStage(t),i=this.stagesCollection.getPreviousStage(t.id,this.tasklistModel.get("stageIds")),e.$el.insertAfterH(this.$el.find(".scrum-stage[data-id="+i.id+"]")),this},e.prototype.removeStage=function(t){return this.$stages.find(".scrum-stage[data-id="+t+"]").remove()},e.prototype.updateStagesSort=function(){var t,e;if(e=this.tasklistModel.get("stageIds"),t=this.$stages.children().map(function(t,e){return $(e).data("id")}),e.length===t.length&&!d.isEqual(e,t))return d.each(e,function(t){return function(e){return t.$stages.find(".scrum-stage[data-id="+e+"]").appendTo(t.$stages)}}(this)),this.updateStageAppender()},e.prototype.setupStageSortable=function(){var t;return t=$(),this.$(".board-scrum-stages").sortable({items:".scrum-stage",handle:".scrum-stage-header",axis:"x",cancel:".locked-stage",helper:"clone",placeholder:"scrum-stage sortable-placeholder",tolerance:"pointer",zIndex:2001,scroll:!0,start:function(e){return function(i,n){return t=e.$(".scrum-stage.locked-stage"),h.gta.event({action:"reorder",type:"task stage",control:"Stage Handler",method:"drag"})}}(this),sort:function(e,i){if(t.length&&t.nextAll(".sortable-placeholder").length)return i.placeholder.insertBeforeH(t)},update:function(t){return function(e,i){var n,r;return n=$(e.target),r=n.sortable("toArray",{attribute:"data-id"}),t.updateStages(r.filter(function(t){return!!t}))}}(this)}),this},e.prototype.updateStages=function(t){return this.tasklistModel.setStageIds(t),this},e.prototype.dragStart=function(t){var e,i;return 1!==t.which||this.dragMove||$(t.target).closest(".scrum-stage-header, li.task, .task-creator-wrap",t.currentTarget).length||(this.dragMove=!0,e=$(t.currentTarget),i=t.pageX,e.one("mouseup.dragMove mouseleave.dragMove",function(t){return function(){return t.dragMove=!1,e.off(".dragMove")}}(this)),e.on("mousemove.dragMove",function(t){return function(n){var r;return r=p.isIE()?1===n.buttons:0===n.button,r?(e.scrollLeft(i-n.pageX+e.scrollLeft()),i=n.pageX):(t.dragMove=!1,e.off(".dragMove"))}}(this))),this},e.prototype.openTaskCreator=function(){return this.firstStage&&this.firstStage.openTaskCreator(),this},e.prototype.showMask=function(){var t,e,i;return e=this.firstStage.$el.find(".task-creator-wrap").first(),i=e.find(".task-content-input"),i.after('<div class="task-creator-mask"></div>'),t=e.find(".submit-handler"),i.one("keyup",function(){return e.find(".task-creator-mask").remove(),t.addClass("submit-handler-jump"),t.one("click",function(){return t.removeClass("submit-handler-jump")})}),this},e.prototype.load=function(){return new Promise(function(t){return function(e,i){return l.fetch(t._projectId,{success:function(i){return t.tasklistsCollection=i,t.tasklistsCollection.updateSort(h.PREFERENCE.tasklistSortInProject(t._projectId),!0),t.tasklistModel=i.get(t._tasklistId),t.tasklistModel||(t.tasklistModel=i.at(0),t._tasklistId=t.tasklistModel.id),e()},error:i})}}(this)).then(function(t){return function(){return new Promise(function(e,i){return a.fetch(t._tasklistId,{success:function(i){return t.stagesCollection=i,e()},error:i})})}}(this)).then(function(t){return function(){return t.stagesCollection.updateSort(t.tasklistModel.get("stageIds"),!0)}}(this))},e}(u)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y=function(t,e){function i(){this.constructor=t}for(var n in e)b.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},b={}.hasOwnProperty;g=i(358),v=i(678),a=i(797),f=i(788),r=i(401),s=i(696),h=i(996),u=i(1207),c=i(1509),d=i(1523),m=i(1525),p=i(1526),n=i(1529),o=i(1530),l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.viewName="StageView",e.prototype.className="scrum-stage toggler-parent",e.prototype.tagName="li",e.prototype.events={"click .stage-menu-toggler":"toggleStageMenu","click .task-content-set":"openTaskDetail","click .task-creator-handler":"openTaskCreator"},e.prototype.initialize=function(t){return!!(t._projectId||t._tasklistId||t.stageModel)&&(this.options=t,this._projectId=t._projectId,this._tasklistId=t.tasklistModel.id,this.projectModel=s.getOne(0,this._projectId),this.tasklistModel=t.tasklistModel,this.filtering=this.tasklistModel.hasFilter(),this.stageModel=t.stageModel,this.stages=t.stageModel.collection,this.renderBasic(),this.debouncedScrollCheck=g.debounce(function(t){return function(){return t.checkScrollState()}}(this),100),this.load({beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$tasksDone)}}(this),success:function(t){return function(e){if(t.$el)return t.tasksCollection=e,t.renderHeader(),t.renderTasks(),t.listen(),t.setupTaskSortable(),t.setupScroll(t.$content),t.registerAsResponsive(),t.setupLoadMore(10),t.checkScrollState(),t.hideLoadingIndicator({animated:!1}),t.$content.scroll(t.debouncedScrollCheck),g.delay(function(){return t.layout()})}}(this)}),this)},e.prototype.load=function(t){return null==t&&(t={}),"function"==typeof t.beforeSend&&t.beforeSend(),this.options.isLocked?this.stageModel.isLast()?h.fetch(this.stageModel.id,{attrs:{isDone:!0},success:function(e){return"function"==typeof t.success?t.success(e):void 0}}):h.fetch(this.stageModel.id,{attrs:{isDone:!1},success:function(e){return"function"==typeof t.success?t.success(e):void 0}}):h.fetch(this.stageModel.id,{attrs:{isDone:!1},success:function(e){return e.pageIndex=0,e.fetch({silent:!0,remove:!1,attrs:{isDone:!0},success:function(e){return"function"==typeof t.success?t.success(e):void 0}})}}),this},e.prototype.listen=function(){return this.stopListening(),this.listenTo(this.tasksCollection,"add",this.checkAddCount),this.listenTo(this.tasksCollection,"remove",this.checkRemoveCount),this.listenTo(this.tasksCollection,"add change:isDone",this.renderTask),this.listenTo(this.tasksCollection,"remove",this.removeTask),this.listenTo(this.tasksCollection,"change:pos change:priority change:dueDate",g.debounce(function(t){return function(e){return t.renderTasks()}}(this),100)),this.listenTo(this.tasksCollection,"add remove change",this.checkLayout),this.listenTo(this.tasklistModel,"change:sortMethod",this.renderTasks),this.listenTo(this.stageModel,"change",this.renderHeader),this.listenTo(this.stageModel,"destroy",this.remove),this.listenTo(this.stageModel,"refresh",this.renderTasks),this.listenTo(this.stageModel,"change:isLocked",function(t){return function(e,i){return t.$el[i?"addClass":"removeClass"]("locked-stage"),t.$el.closest(".board-scrum-view")[i?"addClass":"removeClass"]("workflow-mode")}}(this)),this.listenTo(this.tasklistModel,"change:filter",function(t){return this.filtering=t.hasFilter(),this.filter(),this.renderHeader(),this.checkLayout()}),this},e.prototype.layout=function(){var t;if(this.$content)return t=this.$content[0].scrollHeight-this.$content[0].offsetHeight,this.$el[t>0?"addClass":"removeClass"]("fixed-creator"),this},e.prototype.loadMore=function(t){var e;return null!=(e=this.tasksCollection)&&e.loadMore({silent:!0,attrs:{isDone:!0},beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$tasksDone)}}(this),success:function(e){return function(i,n){var r;if(e.$el)return e.tasksCollection.trigger("genFilterList"),e.hideLoadingIndicator({animated:!0}),g.each(n,function(t){return e.renderTask(e.tasksCollection.get(t._id))}),"function"==typeof(r=e.options).loadMore&&r.loadMore(),e.tasksCollection.hasMore?"function"==typeof t?t():void 0:e.showEndPoint(e.$content)}}(this)}),this},e.prototype.renderBasic=function(){var t;return t=this.stageModel.toJSON(),t.permissions=this.projectModel.hasPermissions("task.post"),this.$el.html(n(t)),this.$el.attr("data-id",this.stageModel.id),this.$wrap=this.$el.find(".scrum-stage-wrap"),this.$header=this.$el.find(".scrum-stage-header"),this.$content=this.$el.find(".scrum-stage-content"),this.$tasks=this.$el.find(".scrum-stage-tasks"),this.$tasksDone=this.$el.find(".scrum-stage-tasks-done"),this.$creatorWrap=this.$(".task-creator-wrap"),this.stageModel.get("isLocked")&&g.delay(function(t){return function(){return t.$el.addClass("locked-stage"),t.$el.closest(".board-scrum-view").addClass("workflow-mode")}}(this),100),this.todoTasksBox=new d(this.$tasks,this),this.doneTasksBox=new d(this.$tasksDone,this),this},e.prototype.renderHeader=function(){var t;return t=this.stageModel.toJSON(),t.index=this.stageModel.collection.indexOf(this.stageModel),this.filtering===!0&&(t.totalCount=this.$("li.task").filter(function(){return!$(this).hasClass("hide")}).length),t.permissions=this.stageModel.hasPermissions("post","put","del"),this.$header.html(o(t)),this},e.prototype.renderTasks=function(){var t;return this.tasksCollection.orderBy=this.tasklistModel.get("sortMethod"),this.tasksCollection.sort(),t=this.tasksCollection.groupBy("isDone"),this.todoTasksBox.renderTasks(t["false"]),this.doneTasksBox.renderTasks(t["true"]),this.filtering&&this.filter(),this},e.prototype.renderTask=function(t){var e,i;return e=this.tasksCollection.findIndex(function(e){return e.id===t.id}),e>0&&(i=this.tasksCollection.at(e-1)),t.get("isDone")?(this.doneTasksBox.add(t,i),this.todoTasksBox.remove(t)):(this.todoTasksBox.add(t,i),this.doneTasksBox.remove(t))},e.prototype.removeTask=function(t){var e;return e=t.get("isDone")?this.doneTasksBox:this.todoTasksBox,e.remove(t)},e.prototype.checkScrollState=function(){return this.$content.scrollTop()<=0?this.$el.addClass("reached-top").removeClass("reached-bottom"):this.$content[0].scrollHeight-this.$content.scrollTop()===this.$content[0].clientHeight?this.$el.addClass("reached-bottom").removeClass("reached-top"):this.$el.removeClass("reached-top reached-bottom")},e.prototype.setupTaskSortable=function(){return this.stageModel.getRoleScope()>=0?new m(this.$wrap,this.projectModel,this.tasklistModel,this.stageModel):this},e.prototype.openTaskCreator=function(){return this.stageModel.get("isLocked")||!this.projectModel.hasPermission("task.post")?this:(this.requestSubView(p,{_projectId:this._projectId,_tasklistId:this._tasklistId,_stageId:this.stageModel.id,tasksCollection:this.tasksCollection,beforeClose:function(t){return function(){return t.$wrap.addClass("hidden-creator"),g.delay(function(){return t.layout()},10)}}(this),success:function(t){return function(){return g.delay(function(){return t.slideTo(t.$creatorWrap)})}}(this)}).$el.appendTo(this.$creatorWrap),this.$wrap.removeClass("hidden-creator"),g.delay(function(t){return function(){return t.slideTo(t.$creatorWrap)}}(this)),this)},e.prototype.checkAddCount=function(t){var e;return e=Math.max(this.stageModel.get("totalCount")+1,this.tasksCollection.length),this.stageModel.set("totalCount",e),this},e.prototype.checkRemoveCount=function(t){var e;return e=Math.max(this.stageModel.get("totalCount")-1,this.tasksCollection.length),this.stageModel.set("totalCount",e),this},e.prototype.checkLayout=function(t){return g.delay(function(t){return function(){return t.layout()}}(this)),this},e.prototype.filter=function(){return this.doneTasksBox.filter(this.tasklistModel.get("filter")),this.todoTasksBox.filter(this.tasklistModel.get("filter"))},e.prototype.toggleStageMenu=function(t){var e;return 0===(null!=(e=this.stageMenuView)?e.$toggler.closest("body").length:void 0)&&(this.stageMenuView.remove(),this.stageMenuView=null),this.stageMenuView||(this.stageMenuView=this.requestSubView(c,{$toggler:$(t.currentTarget),tasksCollection:this.tasksCollection,projectModel:this.projectModel,tasklistModel:this.tasklistModel,stageModel:this.stageModel,keepPositionOnBottom:!0}).show()),this},e.prototype.openTaskDetail=function(t){var e,i,n;return e=t.target?$(t.target).closest(".task").data("id"):t,n=this.tasksCollection.get(e),i={isUsePanel:!0,hasLink:!1},v.APP.openTaskPreviewer(n,i),v.APP.currentView.updateUrl(this._tasklistId,e),this},e.prototype.scrollToBottom=function(){return g.delay(function(t){return function(){return t.slideTo()}}(this)),this},e}(f),g.extend(l.prototype,a),t.exports=l},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k=function(t,e){function i(){this.constructor=t}for(var n in e)w.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},w={}.hasOwnProperty;y=i(358),b=i(678),p=i(401),m=i(429),f=i(813),h=i(699),v=i(1025),d=i(1510),a=i(1513),n=i(1516),o=i(1517),c=i(1518),l=i(1519),u=i(1520),r=i(1521),s=i(1522),t.exports=g=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return k(e,t),e.prototype.className="stage-menu-view",e.prototype.viewName="StageMenuView",e.prototype.popoverTitle="",e.prototype.width=280,e.prototype.events={"click .edit-stage-handler":"enterEditSubMenu","click .move-stage-tasks-handler":"enterMoveStageTasksSubMenu","click .add-next-stage-handler":"enterAddNextSubMenu","click .archive-stage-tasks-handler":"enterArchiveStageTasksSubMenu","click .toggle-stage-tasks-executor-handler":"enterToggleStageTasksExecutorSubMenu","click .date-picker-handler":"enterDatePickerSubMenu","submit .datepicker-form":"submitDatePicker","click .delete-stage-handler":"enterDeleteSubMenu","click .locked-stage-handler":"enterLockedSubMenu","submit .stage-edit-form":"submitEditForm","submit .stage-add-form":"submitAddForm","submit .stage-archive-tasks-form":"submitArchiveTasksForm","submit .stage-delete-form":"submitDeleteForm","submit .stage-locked-form":"submitLocked"},e.prototype.initialize=function(t){return null==t&&(t={}),this.popoverTitle=tb_i18n.get("stage.menu.title"),this._projectId=t.projectModel.id,this.projectModel=t.projectModel,this.tasklistModel=t.tasklistModel,this.stageModel=t.stageModel,this.tasksCollection=t.tasksCollection,this.stagesCollection=this.stageModel.collection,h.fetch(this.projectModel.id,{success:function(t){return function(e){return t.membersCollection=e}}(this)}),e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){var t,e;if(this.stageModel&&this.tasklistModel&&this.tasksCollection)return t=this.stageModel.toJSON(),t.permissions=this.stageModel.hasPermissions("post","put","del"),t.canBatchPut=this.projectModel.get("_roleId")>=1,t.permissions.putMode=this.tasklistModel.hasPermission("put.mode"),t.isLast=this.stageModel.isLast(),t.stagesCount=this.stagesCollection.length,e=this.stagesCollection.last().get("isLocked"),t.stageNum=e?2:1,t.isntLastNorLocked=!(t.isLast&&this.stageModel.get("isLocked")),this.$el.html(o(t)),this.triggerHook("render"),this},e.prototype.enterEditSubMenu=function(){return this.enterSubMenu(tb_i18n.get("stage.menu.edit.title"),function(t){return function(){return t.$el.html(l(t.stageModel.toJSON())),t.$("input").focusAtEnd()}}(this)),this},e.prototype.enterDatePickerSubMenu=function(){return this.enterSubMenu(tb_i18n.get("stage.menu.date.picker.title"),function(t){return function(){var e,i,n,r;return t.$el.html(s()),e=t.$(".datepicker-el"),i=function(e){return y.chain(t.tasksCollection.filter(e)).sortBy(function(t){return t.get(e)}).last().value()},n=i("startDate"),t.startDate=null!=n?n.get("startDate"):void 0,null!=(r=t.dateTimePickerView)&&r.remove(),t.dateTimePickerView=t.requestSubView(a,{showTimeInput:t.projectModel.isAppEnabled("preciseDate"),startDate:t.startDate,onChange:function(e){return t.setDueDate(e)}}),e.html(t.dateTimePickerView.$el)}}(this)),this},e.prototype.setDueDate=function(t){return this.dueDate=t,t||this.submitDatePicker(),this},e.prototype.submitDatePicker=function(t){return t&&t.preventDefault(),void 0===this.dueDate&&(this.dueDate=this.dateTimePickerView.getDateTime()),this.startDate&&this.dueDate&&!m(this.startDate).isBefore(this.dueDate)?p.show({message:tb_i18n.get("stage.menu.date.picker.error"),status:"error"}):(this.hide(),
this.projectModel.isAppEnabled("preciseDate")||null==this.dueDate||(this.dueDate.setHours(0),this.dueDate.setMinutes(0)),this.stageModel.editDueDate({attrs:{dueDate:this.dueDate},success:function(t){return function(){var e;return e=t.dueDate?tb_i18n.get("stage.menu.date.picker.success"):tb_i18n.get("stage.menu.date.picker.clear.success"),p.show({message:e,status:"success"})}}(this)}),this)},e.prototype.enterMoveStageTasksSubMenu=function(){if(this.projectModel)return this.enterSubMenu(tb_i18n.get("stage.menu.move.tasks.title"),function(t){return function(){var e;return null!=(e=t.stageSelectorView)&&e.remove(),t.stageSelectorView=t.requestSubView(v,{projectModel:t.projectModel,tasklistModel:t.tasklistModel,stageModel:t.stageModel,success:function(e){if(t.hide(),t.stageModel.id!==e.stageModel.id)return t.stageModel.moveStageTasks({attrs:{_newStageId:e.stageModel.id},success:function(){return p.show({message:tb_i18n.get("stage.menu.move.tasks.success"),status:"success"})}})}}),t.$el.html(t.stageSelectorView.$el)}}(this)),this},e.prototype.enterAddNextSubMenu=function(){return this.enterSubMenu(tb_i18n.get("stage.menu.add.title"),function(t){return function(){return t.$el.html(n()),t.$el.find("input").focusAtEnd()}}(this)),this},e.prototype.enterLockedSubMenu=function(){var t,e;return t=this.stageModel.get("isLocked"),e=t?tb_i18n.get("stage.menu.unlock.stage"):tb_i18n.get("stage.menu.lock.stage"),this.enterSubMenu(e,function(e){return function(){return e.$el.html(u({isLocked:t}))}}(this)),this},e.prototype.enterDeleteSubMenu=function(){var t,e;return e=null!=(t=this.tasksCollection)?t.length:void 0,this.enterSubMenu(tb_i18n.get("stage.menu.delete.title"),function(t){return function(){return t.$el.html(c({deletable:0===e}))}}(this)),this},e.prototype.enterArchiveStageTasksSubMenu=function(){return this.enterSubMenu(tb_i18n.get("stage.menu.archive.tasks.title"),function(t){return function(){return t.$el.html(r())}}(this)),this},e.prototype.enterToggleStageTasksExecutorSubMenu=function(){if(this.membersCollection)return this.enterSubMenu(tb_i18n.get("stage.menu.toggle.stage.tasks.executor.title"),function(t){return function(){var e;return null!=(e=t.MemberSelectorView)&&e.remove(),t.MemberSelectorView=t.requestSubView(d,{noAssign:!0,membersCollection:t.membersCollection,selectCallback:function(e){var i;return t.hide(),i=1===e.length&&24===e[0].length?e[0]:null,t.stageModel.setStageTasksExecutor({attrs:{_executorId:i},success:function(){return p.show({message:tb_i18n.get("stage.menu.toggle.stage.tasks.executor.success"),status:"success"})}})}}),t.$el.html(t.MemberSelectorView.$el)}}(this))},e.prototype.submitEditForm=function(t){var e,i;return t.preventDefault(),e=$(t.currentTarget),i=e.find("input").val().trim().replace(/,/g,""),i?this.stageModel.save(null,{attrs:{name:i},success:function(t){return function(){return t.hide()}}(this)}):e.find("input").focusAtEnd(),this},e.prototype.submitAddForm=function(t){var e,i;return t.preventDefault(),e=$(t.currentTarget),i=e.find("input").val().trim(),i?this.stagesCollection.create({name:i,_tasklistId:this.stageModel.get("_tasklistId"),_prevId:this.stageModel.id},{wait:!0,success:function(t){return function(){return b.gta.event(null,"submit","add_stage"),t.hide()}}(this)}):e.find("input").focusAtEnd(),this},e.prototype.submitArchiveTasksForm=function(t){return t.preventDefault(),this.stageModel.archiveTasks({success:function(t){return function(){return p.show({message:tb_i18n.get("archived.task.success"),status:"success"}),t.hide()}}(this)}),this},e.prototype.submitDeleteForm=function(t){if(t.preventDefault(),this.stagesCollection.length>=2)return this.stageModel.destroy({success:function(t){return function(){return t.hide()}}(this)}),this},e.prototype.submitLocked=function(t){var e;if(t.preventDefault(),e=this.stageModel.get("isLocked"),this.stageModel.isLast())return this.stageModel.save(null,{attrs:{isLocked:!e},success:function(t){return function(){var i,n;return e?b.gta.event(null,"click","switch_to_free_mode"):b.gta.event(null,"click","switch_to_process_mode"),null!=(i=t.parentView)&&null!=(n=i.parentView)?n.updateStageAppender(!0):void 0}}(this)}),this.hide(),this},e}(f)},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty,d=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};l=i(358),n=i(1511),o=i(1512),s=i(797),c=i(788),a=i(677),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="MemberSelectorView",e.prototype.className="member-selector-view",e.prototype.popoverTitle="Menu",e.prototype.width=200,e.prototype.events={"click .one":"toggleMember","input .filter-input":"onchange","click .submit-handler":"submit"},e.prototype.initialize=function(t){if(null==t&&(t={}),t.membersCollection||t.selectCallback)return this.resident=t.resident||[],this.excludes=t.excludes||[],this.noAssign=t.noAssign,this.selected=t.selected||[],this.selectCallback=t.selectCallback,this.membersCollection=t.membersCollection,this.members=l.filter(this.membersCollection.toJSON(),function(t){return function(e){var i;return e.isMember=!0,i=e._id,d.call(t.excludes,i)<0}}(this)),this.listen(),this.render(),e.__super__.initialize.apply(this,arguments),this},e.prototype.listen=function(){return this.listenTo(this.membersCollection,"add remove",this.render),this},e.prototype.render=function(){return this.$el.html(n),this.$list=this.$("ul"),this.renderMembers(this.assembleAll()),setTimeout(function(t){return function(){return t.$("input").focus()}}(this),100),this},e.prototype.renderMembers=function(t){return this.$list.html(o(t)),this.refreshSelected(),this},e.prototype.refreshSelected=function(){return this.$(".member-item").removeClass("selected"),this.$(".member-item").each(function(t){return function(e,i){var n,r;if(n=$(i),r=n.data("id"),d.call(t.selected,r)>=0||d.call(t.resident,r)>=0)return n.addClass("selected")}}(this)),this},e.prototype.assembleAll=function(){var t;return t=[],this.noAssign&&t.push({isNoAssign:!0}),this.members.slice(0).sort(function(t){return function(e,i){var n,r,o,s,a,c;return r=e._id,n=d.call(t.selected,r)>=0||(o=e._id,d.call(t.resident,o)>=0)?0:1,s=i._id,c=d.call(t.selected,s)>=0||(a=i._id,d.call(t.resident,a)>=0)?0:1,n-c?n-c:e.pinyi>i.pinyi?1:e.pinyi<i.pinyi?-1:0}}(this)).map(function(e){return t.push(e)}),t},e.prototype.toggleMember=function(t){var e,i;return e=$(t.currentTarget),i=e.data("id"),this.selectSingleMember(i),this},e.prototype.selectSingleMember=function(t){return this.selected=[t],this.$("button").removeAttr("disabled"),this.refreshSelected(),this},e.prototype.submit=function(t){if(t.preventDefault(),this.selected)return"function"==typeof this.selectCallback&&this.selectCallback(this.selected),this},e.prototype.onchange=function(t){var e,i;return t.preventDefault(),e=$(t.currentTarget),i=e.val().trim().toLowerCase(),i?(this.query=i,this.renderMembers(a.memberFilter(this.members,this.query))):this.renderMembers(this.assembleAll()),this},e}(c),l.extend(r.prototype,s),t.exports=r},function(t,e){t.exports=function(t){var e='<div class="menu-input"> <input class="filter-input form-control" autofocus placeholder="'+tb_i18n.get("member.menu.search")+'"/></div><ul class="list-unstyled thin-scroll"></ul><form> <button class="btn btn-primary submit-handler" disabled>'+tb_i18n.get("confirm")+"</button></form>";return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t;if(n)for(var r,o=-1,s=n.length-1;o<s;)if(r=n[o+=1],i+=" ",r.isNoAssign)i+=' <li class="member-item one" data-id=""> <a> <div class="avatar img-circle no-avatar"></div> '+tb_i18n.get("task.detail.no.executor")+" </a> </li> ";else if(r.isMember){i+=" ";var a=r;i+=' <li class="member-item one" data-id="'+a._id+'"> <a> <div class="avatar img-circle" style="background-image:url('+a.avatarUrl+');"></div> '+e(a.name)+" </a> </li> "}return i}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;a=i(677),c=i(788),s=i(429),n=i(1514),o=i(1515),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="DateTimePickerView",e.prototype.className="date-time-picker-view",e.prototype.events={"input .hour-input":"inputHourHandler","input .minute-input":"inputMinuteHandler","click .input-section":"preventClickEvent"},e.prototype.initialize=function(t){var i;return null==t&&(t={}),this.showTimeInput=null==t.showTimeInput||t.showTimeInput,this.startDate=t.startDate,this.onChange=t.onChange,this.startDate?(i=new s(this.startDate).add(1,"m"),this.startDate=new Date(i.toString()),i.add(59,"m"),this.date=new Date(i.toString()),this.defaultHour=this.date.getHours(),this.defaultMinute=this.date.getMinutes()):(this.date=new Date,this.defaultHour=this.showTimeInput?18:0,this.defaultMinute=0),this.date.setHours(this.defaultHour),this.date.setMinutes(this.defaultMinute),this.render(),e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){return this.$el.html(n()),this.$inputSection=this.$(".input-section"),this.$target=this.$(".datepicker-el"),this.renderInputSection(),this.renderDatePicker()},e.prototype.renderInputSection=function(){var t;return t={year:this.date.getFullYear().toString(),month:a.formatMonthString(this.date.getMonth()),date:a.formatDateString(this.date.getDate()),hour:a.formatHourString(this.date.getHours()),minute:a.formatMinuteString(this.date.getMinutes()),showTimeInput:this.showTimeInput},this.$inputSection.html(o(t))},e.prototype.renderDatePicker=function(){var t;return"function"==typeof(t=this.$target).datepicker&&t.datepicker("remove"),this.$target.datepicker({format:"yyyy-mm-dd",language:tb_i18n.getLanguage(),todayHighlight:!0,placement:"left",startDate:this.startDate,todayBtn:"linked",tomorrowBtn:"linked",clearBtn:"linked"}).datepicker("update",this.parseDate(this.date)).focus().on("changeDate",function(t){return function(e){return t.changeDateHandler(e.date)}}(this))},e.prototype.preventClickEvent=function(t){return t.preventDefault(),t.stopPropagation(),this},e.prototype.parseDate=function(t){var e;return t instanceof Date||(t=new Date(t)),e=new Date(t.getFullYear(),t.getMonth(),t.getDate())},e.prototype.inputHourHandler=function(t){var e,i,n,r,o;return e=$(t.currentTarget),r=e.val(),o=this.parseInputToNum(r),n=a.formatHourString(o),e.val(n),i=parseInt(n),this.date.setHours(i),this.onChange(this.date),this},e.prototype.inputMinuteHandler=function(t){var e,i,n,r,o;return e=$(t.currentTarget),i=e.val(),n=this.parseInputToNum(i),o=a.formatMinuteString(n),e.val(o),r=parseInt(o),this.date.setMinutes(r),this.onChange(this.date),this},e.prototype.parseInputToNum=function(t){var e;return e=+t,isNaN(e)&&(e=0),e},e.prototype.changeDateHandler=function(t){return t?(this.date=new Date(t),this.date.setHours(this.defaultHour),this.date.setMinutes(this.defaultMinute),this.renderInputSection(),this.onChange(this.date)):this.onChange(null)},e.prototype.getDateTime=function(){return this.date},e}(c)},function(t,e){t.exports=function(t){var e='<div class="input-section"></div><div class="datepicker-el"></div>';return e}},function(t,e){t.exports=function(t){var e="";return t.showTimeInput&&(e+='<div class="date-section"> <p>'+tb_i18n.get("datetimepicker.date")+'</p> <div class="date-group"> <span>'+t.year+'</span> <span class="date-seperator"> - </span> <span>'+t.month+'</span> <span class="date-seperator"> - </span> <span>'+t.date+'</span> </div></div><div class="time-section"> <p>'+tb_i18n.get("datetimepicker.time")+'</p> <div class="time-group input-group"> <input type="number" class="hour-input" value="'+t.hour+'"> <span class="time-seperator">:</span> <input type="number" class="minute-input" value="'+t.minute+'"> </div></div>'),e}},function(t,e){t.exports=function(t){var e='<form class="stage-add-form"> <p>'+tb_i18n.get("stage.menu.add.stage.hint")+'</p> <input class="form-control" type="text" placeholder="'+tb_i18n.get("stage.menu.stage.name")+'"></input> <button class="btn btn-primary" type="submit" data-gta="{action: \'added content\', type: \'task stage\', control: \'Stage Menu\'}"> '+tb_i18n.get("create")+" </button></form>";return e}},function(t,e){t.exports=function(t){var e="";return t.permissions.post&&t.isntLastNorLocked||t.permissions.put||t.permissions.del||t.permissions.putMode?(e+=' <ul class="list"> ',t.permissions.put&&(e+=' <li> <a class="edit-stage-handler" data-gta="{action: \'edit stage\', control: \'Stage Menu\'}"> <span class="icon icon-pencil"></span>'+tb_i18n.get("stage.menu.edit.title")+" </a> </li> "),e+=" ",t.permissions.post&&t.isntLastNorLocked&&(e+=' <li> <a class="add-next-stage-handler"> <span class="icon icon-plus"></span>'+tb_i18n.get("stage.menu.add.next.stage.title")+" </a> </li> "),e+=" ",(t.permissions.put||t.permissions.post&&t.isntLastNorLocked)&&(e+=' <li class="divider"></li> '),e+=" ",t.canBatchPut&&(e+=' <li> <a class="toggle-stage-tasks-executor-handler"> <span class="icon icon-user"></span>'+tb_i18n.get("stage.menu.toggle.stage.tasks.executor")+' </a> </li> <li> <a class="date-picker-handler"> <span class="icon icon-calendar2"></span>'+tb_i18n.get("stage.menu.date.picker")+' </a> </li> <li> <a class="archive-stage-tasks-handler"> <span class="icon icon-archive"></span>'+tb_i18n.get("stage.menu.archive.tasks.title")+" </a> </li> ",t.isntLastNorLocked&&(e+=' <li> <a class="move-stage-tasks-handler"> <span class="icon icon-move-task"></span>'+tb_i18n.get("stage.menu.move.tasks.title")+" </a> </li> "),e+=" "),e+=" ",t.canBatchPut&&(e+=' <li class="divider"></li> '),e+=" ",t.isLast&&t.permissions.putMode&&(e+=" ",e+=t.isLocked?' <li> <a class="locked-stage-handler" data-gta="{action: \'toggle free mode\', control: \'Stage Menu\'}"> <span class="icon icon-stage"></span>'+tb_i18n.get("stage.menu.unlock.stage")+" </a> </li> ":' <li> <a class="locked-stage-handler"> <span class="icon icon-tick"></span>'+tb_i18n.get("stage.menu.lock.stage")+" </a> </li> ",e+=" "),e+=" ",t.permissions.del&&t.stagesCount>t.stageNum&&t.isntLastNorLocked&&(e+=" <li> <a class=\"delete-stage-handler\" data-gta=\"{action: 'delete content', type: 'task stage', control: 'Stage Menu'}\"> <span class=\"icon icon-trash\"></span>"+tb_i18n.get("stage.menu.delete.title")+" </a> </li> "),e+=" </ul>"):e+=' <p class="muted"> '+tb_i18n.get("noRight")+tb_i18n.get("this.stage")+" </p>",e}},function(t,e){t.exports=function(t){var e='<form class="stage-delete-form"> ';return e+=t.deletable?" <p>"+tb_i18n.get("stage.menu.confirm.delete")+'?</p> <button class="btn btn-danger" type="submit" data-gta="event" data-label="delete stage">'+tb_i18n.get("delete")+"</button> ":" <p>"+tb_i18n.get("stage.menu.cannot.delete")+".</p> ",e+="</form>"}},function(t,e){t.exports=function(t){var e='<form class="stage-edit-form"> <input class="form-control" placeholder="'+tb_i18n.get("stage.menu.stage.name")+'" type="text" value="'+t.name+'"></input> <button class="btn btn-primary" type="submit" data-gta="event" data-label="edit stage">'+tb_i18n.get("save")+"</button></form>";return e}},function(t,e){t.exports=function(t){var e='<form class="stage-locked-form"> <p class="stage-template-success"> ';return e+=t.isLocked?""+tb_i18n.get("stage.menu.unlock.stage.msg"):""+tb_i18n.get("stage.menu.lock.stage.msg"),e+=" </p> <button class=\"btn btn-primary\" data-gta=\"{action: 'toggle free mode', control: 'Stage Menu'}\">"+tb_i18n.get("confirm")+"</button></form>"}},function(t,e){t.exports=function(t){var e='<form class="stage-archive-tasks-form"> <p>'+tb_i18n.get("stage.menu.confirm.archive.tasks")+'?</p> <button class="btn btn-danger" type="submit" data-gta="event" data-label="archive stage">'+tb_i18n.get("archive")+"</button></form>";return e}},function(t,e){t.exports=function(t){var e='<form class="datepicker-form"> <div class="datepicker-el"></div> <button class="btn btn-primary submitDatePicker">'+tb_i18n.get("confirm")+"</button></form>";return e}},function(t,e,i){var n,r,o,s;o=i(358),n=i(1207),s=i(1524).filterOne,t.exports=r=function(){function t(t,e){this.context=e,this.$el=t,this.$elements={}}return t.prototype.renderTasks=function(t){var e;return e=$(document.createDocumentFragment()),o.each(t,function(t){return function(i){return e.append(t.createTask(i))}}(this)),this.$el.html(e)},t.prototype.add=function(t,e){var i,n,r;if(i=this.findElement(t),null==i||!i.length)return r=this.createTask(t),e&&(n=this.findElement(e)),n?n.after(r):this.$el.prepend(r)},t.prototype.remove=function(t){var e;return e=this.findElement(t),e&&e.remove(),this.$elements[t.id]=null},t.prototype.filter=function(t){return o.each(this.$elements,function(e){var i,n;if(e)return n=e.data("model").toJSON(),i=s(n,e,t)?"removeClass":"addClass",e[i]("hide")})},t.prototype.createTask=function(t){var e,i,r;return r="card",(e=this.findElement(t))?e:(i=this.context.requestSubView(n,{model:t,viewType:r}).$el,i.data("model",t),this.$elements[t.id]=i,i)},t.prototype.findElement=function(t){return this.$elements[t.id||t._id||t]},t.prototype.isSame=function(t,e){return(null!=t?t.data("id"):void 0)===(null!=e?e.data("id"):void 0)},t}()},function(t,e,i){var n,r,o,s,a;s=i(358),o=i(677),r=i(437),n=i(700),e.filterOne=function(t,e,i){var n,o,s;if(s=r().startOf("day").valueOf(),i){if((null!=(n=i.tagIds)?n.length:void 0)&&!a.tag(t,i.tagIds))return!1;if((null!=(o=i.executorIds)?o.length:void 0)&&!a.executor(t,i.executorIds))return!1;if(i.query&&!a.query(t,e,i.query))return!1;if(i.isHideDone&&!a.done(t))return!1;if(i.onlyTodayUpdate&&!a.todayUpdate(t,s))return!1}return!0},a={tag:function(t,e){return s.some(t.tagIds,function(t){return s.contains(e,t)})},executor:function(t,e){return s.contains(e,t._executorId)},query:function(t,e,i){var r,s,a;return a=o.matchString(t.content.toLowerCase(),i)||o.matchString((t.note||"").toLowerCase(),i)||~e.text().toLowerCase().indexOf(i),r=null!=(s=n.find(t._executorId))?s.toJSON():void 0,r&&!a&&(a=~r.name.toLowerCase().indexOf(i)||~r.pinyin.indexOf(i)),a},done:function(t){return!t.isDone},todayUpdate:function(t,e){return e<new Date(t.updated)}}},function(t,e,i){var n,r,o,s,a,c;c=i(678),n=i(401),s=null,a=null,o=function(t,e){var i,n;if(n=e.closest(".board-scrum-stages")[0],n&&t[0]){if(i=t[0].getBoundingClientRect(),i.left<30){if(n.scrollLeft<5)return;return n.scrollLeft-=15}if(i.right+30>n.offsetWidth){if(n.scrollLeft+n.offsetWidth>n.scrollWidth-5)return;return n.scrollLeft+=15}}},t.exports=r=function(){function t(t,e,i,r){var l,p;this.$element=t,this.projectModel=e,this.tasklistModel=i,this.stageModel=r,p=null,l=void 0,this.$element.sortable({items:".task",connectWith:".scrum-stage-wrap",helper:"clone",placeholder:"scrum-drag-placeholder",tolerance:"pointer",zIndex:2001,scroll:!0,scrollSensitivity:30,start:function(t,e){return p=e.item.data("model"),e.placeholder.height(e.helper.height())},sort:function(t){return function(e,i){var n,r,c,u,d,h,m,f,g;if(r=p.get("_stageId"),g=null!=(m=i.placeholder)&&null!=(f=m.parents("li"))?f.data("id"):void 0,h=!1,r===g){if(s&&a&&t.clearBlurStagePanel(l),i.placeholder.show(),l=void 0,o(i.helper,t.$element),n=i.placeholder.parent(),p.get("isDone")){if(!n.hasClass("scrum-stage-tasks-done"))return i.placeholder.prependTo(n.parent().find(".scrum-stage-tasks-done"))}else if(!n.hasClass("scrum-stage-tasks"))return i.placeholder.appendTo(n.parent().find(".scrum-stage-tasks"))}else{if(c=p.hasPermission("put.move"),u=t.projectModel.hasPermission("task.put.pos"),d="custom"===t.tasklistModel.get("sortMethod"),!(c&&u&&d))return i.placeholder.hide(),t.blurStagePanel(g,l),l=g;if(i.placeholder.show(),o(i.helper,t.$element),n=i.placeholder.parent(),p.get("isDone")){if(!n.hasClass("scrum-stage-tasks-done"))return i.placeholder.prependTo(n.parent().find(".scrum-stage-tasks-done"))}else if(!n.hasClass("scrum-stage-tasks"))return i.placeholder.appendTo(n.parent().find(".scrum-stage-tasks"))}}}(this),receive:function(t){return function(e,i){return t.clearBlurStagePanel(t.stageModel.id),p=i.item.data("model"),(null!=p?p.hasPermission("put.status"):void 0)?!(!p||!t.chargeMovePermission(p))&&(p.get("_stageId")!==t.stageModel.id&&(t.projectModel.hasPermission("task.put.pos")?t.jumpHandler(p,i.item):t.moveStage(p)),c.gta.event({action:"move content",type:"task",method:"drag"})):(n.error(""+tb_i18n.get("noRight")+tb_i18n.get("this.task")),!1)}}(this),update:function(t){return function(e,i){return p=i.item.data("model"),!(!p||!t.chargeMovePermission(p))&&(t.$element.find("[data-id="+p.id+"]").length?t.sortHandler(p,i.item):void 0)}}(this)})}return t.prototype.blurStagePanel=function(t,e){if(t!==e)return s=s?s:$('<div class="sort-blur-placeholder"></div>'),a=a?a:$("<div class='sort-header-placeholder'>"+tb_i18n.get("board.stage.sortplaceholder")+"</div>"),this.clearBlurStagePanel(e),$("li[data-id='"+t+"']").addClass("sort-blur").append(s).prepend(a).children(".scrum-stage-header").hide()},t.prototype.clearBlurStagePanel=function(t){if(t)return null!=s&&s.remove(),null!=a&&a.remove(),$("li[data-id='"+t+"']").children(".scrum-stage-header").show(),$("li.sort-blur").removeClass("sort-blur")},t.prototype.chargeMovePermission=function(t){var e,i,n,r;return r=this.stageModel.id,i=t.get("_stageId"),i===r?(e=this.projectModel.hasPermission("task.put.pos"),n="custom"===this.tasklistModel.get("sortMethod"),!t.get("isDone")&&e&&n):t.hasPermission("put.move")},t.prototype.sortHandler=function(t,e){var i;return i=this.calculatePos(e),t.saveAttr("pos",null,{attrs:{pos:i}})},t.prototype.jumpHandler=function(t,e){var i,n;return i=this.stageModel.id,n=this.calculatePos(e),t.saveAttr("move",null,{attrs:{_stageId:i,pos:n}})},t.prototype.moveStage=function(t){var e;return e=this.stageModel.id,t.saveAttr("move",null,{attrs:{_stageId:e}})},t.prototype.calculatePos=function(t){var e,i,n;return e=(null!=(i=t.prev())&&null!=(n=i.data("model"))?n.get("pos"):void 0)||0,e+1},t}()},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M=function(t,e){function i(){this.constructor=t}for(var n in e)C.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},C={}.hasOwnProperty,x=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};_=i(358),T=i(678),s=i(680),o=i(401),m=i(681),k=i(677),h=i(804),w=i(788),y=i(803),a=i(699),d=i(696),v=i(1031),c=i(1002),l=i(1005),p=i(1019),f=i(1052),b=i(1208),u=i(1027),n=i(1527),r=i(1528),j=null,t.exports=g=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return M(e,t),e.prototype.viewName="TaskCreatorView",e.prototype.tagName="form",e.prototype.className="task-creator fade",e.prototype.hotkeys={esc:"remove"},e.prototype.events={"keydown .task-content-input":"quickSubmit","change .task-content-input":"cacheTask","click .submit-handler":"submit","click a.creator-visible":"switchVisible","click .more-handler":"toggleMore","click a.repeat-handler":"toggleRepeatSelector"},e.prototype.initialize=function(t){return(null!=j?j.$el:void 0)&&j.remove(),!!(t._projectId||t._tasklistId||t._stageId||t.tasksCollection)&&(j=this,this.options=t,this._projectId=t._projectId,this._tasklistId=t._tasklistId,this._stageId=t._stageId,this.projectModel=d.getOne(0,this._projectId),this.tasksCollection=t.tasksCollection,this.membersCollection=a.get(this._projectId),this.localCache=m.namespace("temp").namespace("tasks_board"),this.localCacheId=t._projectId+"_"+T.user.id,this.render().reset().initExecutor().initInvolve().initPriority().initTagPicker().renderVisible().renderDateHanlders().renderExecutor().renderPriority().renderRepeat().focus().cacheTask(),this.handleClickOutside(),_.delay(function(t){return function(){return t.$el.addClass("in")}}(this)),this)},e.prototype.reset=function(){var t,e,i;return i=this.localCache(this.localCacheId)||{},null==this._executorId&&(this._executorId=i._executorId||T.user.id),this.taskModel?(this.stopListening(this.taskModel),this.taskModel.set("content",""),k.removeItem(this.taskModel.get("involveMembers"),i._executorId)):this.taskModel=new y({_creatorId:T.user.id,_executorId:this._executorId,_projectId:this._projectId,_tasklistId:this._tasklistId,_stageId:this._stageId,priority:i.priority||0,startDate:i.startDate||null,dueDate:i.dueDate||null,content:i.content||"",involveMembers:i.involveMembers||[T.user.id]}),null!=(t=this.executorView)&&t.hide(),null!=(e=this.involveView)&&e.hideMemberMenu(),this.$input.val(this.taskModel.get("content")),this.listenTo(this.taskModel,"change:_executorId",this.renderExecutor),this.listenTo(this.taskModel,"change:_executorId",function(t,e){var i;if(i=t.get("involveMembers")||[],e&&x.call(i,e)<0)return i.push(e),t.set("involveMembers",i)}),this.listenTo(this.taskModel,"change:startDate change:dueDate",this.renderDateHanlders),this.listenTo(this.projectModel,"change:applications",function(){if(this.projectModel.isAppChanged("preciseDate"))return this.renderDateHanlders()}),this.listenTo(this.taskModel,"change:visible",this.renderVisible),this.listenTo(this.taskModel,"change:recurrence",this.renderRepeat),this.listenTo(this.taskModel,"change",this.cacheTask),this},e.prototype.handleClickOutside=function(){return this.$el.handleClickOutside(function(t){return function(e){var i;return(null!=(i=t.$input)?i.val().trim():void 0)?t.handleClickOutside():t.remove()}}(this),"click",".member-menu-view, .popover-menu-view"),this},e.prototype.render=function(){return this.$el.html(n()),this.$input=this.$(".task-content-input"),this.$executorHandler=this.$(".executor-handler"),this.$submit=this.$(".submit-handler"),this.$visibleTitle=this.$(".visible-title"),this.$visibleSwitchers=this.$(".creator-visible"),this},e.prototype.toggleMore=function(){return this.$el.toggleClass("show-more"),this},e.prototype.focus=function(){return _.delay(function(t){return function(){var e;return null!=(e=t.$input)?e.focusAtEnd():void 0}}(this),100),this},e.prototype.initExecutor=function(){return this.executorView=this.requestSubView(l,{$toggler:this.$executorHandler,noAssign:!0,membersCollection:this.membersCollection,selected:[this._executorId],select:function(t){return function(e){var i,n;return i=e[0],t._executorId=i,t.taskModel.set({_executorId:i}),n=t.taskModel.get("involveMembers"),i&&t.taskModel.set("involveMembers",_.union(n,[i])),t.focus()}}(this)}),this},e.prototype.initInvolve=function(){return this.$(".involve-view").remove(),this.involveView=this.requestSubView(c,{_projectId:this._projectId,objectModel:this.taskModel,membersCollection:this.membersCollection,resident:[T.user.id]}),this.involveView.$el.prependTo(this.$(".involve-wrap")),this},e.prototype.initTagPicker=function(){return this.$(".tag-picker-view").remove(),this.tagPickerView=this.requestSubView(f,{_projectId:this._projectId,objectModel:this.taskModel}),this.tagPickerView.$el.prependTo(this.$(".tags-wrap")),this},e.prototype.toggleRepeatSelector=function(t){var e,i,n;return e=$(t.currentTarget),i="toggleRepeatSelector",e.data(i)?this:(e.data(i,!0),null!=(n=this.repeatSelectorView)&&n.remove(),this.repeatSelectorView=this.requestSubView(u,{$toggler:e,recurrence:this.taskModel.get("recurrence"),select:function(t){return function(e){return t.taskModel.set("recurrence",e)}}(this)}).show(),this)},e.prototype.initPriority=function(){return this.requestSubView(b,{currentPriority:this.taskModel.get("priority"),select:function(t){return function(e){return t.taskModel.set({priority:e}),t.renderPriority(),T.gta.event({action:"select priority",control:"New Task"})}}(this)}).setup(this.$(".priority-handler")),this},e.prototype.switchVisible=function(t){var e,i;return e=$(t.currentTarget),i=e.data("visible"),this.taskModel.set("visible",i),this},e.prototype.renderVisible=function(){var t;return t=this.taskModel.get("visible"),"involves"!==t&&(t="members"),this.$visibleSwitchers.filter("[data-visible="+t+"]").addClass("hide"),this.$visibleSwitchers.filter(":not([data-visible="+t+"])").removeClass("hide"),this},e.prototype.renderExecutor=function(){var t,e;return t=null!=(e=this.membersCollection.get(this._executorId))?e.toJSON():void 0,t||(t={name:tb_i18n.get("task.detail.no.executor")}),t.avatarUrl?this.$executorHandler.find(".avatar").css({"background-image":"url("+t.avatarUrl+")"}):this.$executorHandler.find(".avatar").css({"background-image":""}).addClass("no-avatar"),this.$executorHandler.find(".name").text(""+t.name),this},e.prototype.renderDateHanlders=function(){var t,e;return e=[_.extend(this.taskModel.getDateFormatObj("dueDate"),{hint:tb_i18n.get("task.creator.set.duedate")})],this.projectModel.isAppEnabled("startDate")&&e.unshift(_.extend(this.taskModel.getDateFormatObj("startDate"),{hint:tb_i18n.get("task.creator.set.startdate")})),t={preciseDate:this.projectModel.isAppEnabled("preciseDate"),dateItems:e,projectId:this.projectModel.get("_id"),orgId:this.projectModel.get("_organizationId")},this.$(".task-date-wrap").html(r(t)),this.requestSubView(v,{el:this.$(".task-date-wrap")[0],taskModel:this.taskModel,projectModel:this.projectModel,onSelect:function(t){return function(e,i){return t.taskModel.set(e,i),t.focus()}}(this)}),this},e.prototype.renderRepeat=function(){var t;return t=this.taskModel.getRepeatTitle()||tb_i18n.get("task.detail.repeat.info"),this.$(".repeat-text").text(t),this},e.prototype.renderPriority=function(){var t,e;return t=this.taskModel.get("priority"),e=t?k.getPriorityDisplay(t):tb_i18n.get("task.detail.priority.info"),this.$(".priority-label").removeClass("color-priority-0 color-priority-1 color-priority-2").addClass("color-priority-"+t),this.$(".priority-text").text(e),this},e.prototype.quickSubmit=function(t){return 13===t.keyCode&&(t.preventDefault(),this.submit()),this},e.prototype.cacheTask=function(){var t;return t=this.taskModel.toJSON(),t.content=this.$input.val().trim(),this.localCache(this.localCacheId,t.content?t:null),this},e.prototype.submit=function(t){var e,i;if(null!=t&&t.preventDefault(),!this.$submit.prop("disabled"))return e=this.$input.val().trim(),i=_.compact(e.split(/\r\n|\r|\n/)),i.length>1?this.createMultipleTasks(i,e):1===i.length?this.createTask(e):this.focus(),T.gta.event({action:"added content",type:"task",control:"New Task"}),this},e.prototype.createTask=function(t){var e;return this.disableSubmit(!0),e=this.taskModel.toJSON(),e.content=t,this.tasksCollection.create(_.clone(e),{wait:!0,error:function(t){return function(e,i){return t.disableSubmit(!1),o.show({message:i,status:"error"})}}(this),success:function(t){return function(e){var i;return t.localCache.remove(t.localCacheId),t.reset(),t.disableSubmit(!1),"function"==typeof(i=t.options).success&&i.success(),t.focus(),T.gta.event(null,"click","add tasks success",1)}}(this)})},e.prototype.batchCreateTasks=function(t){var e;return e=_.extend(_.omit(this.taskModel.toJSON(),"content"),{tasks:t}),s.post("tasklists/"+this.taskModel.get("_tasklistId")+"/import_tasks",e).then(function(e){return function(i){var n;return _.each(i,function(t,i){return t=new y(t),e.tasksCollection.add(t)}),e.localCache.remove(e.localCacheId),e.reset(),e.disableSubmit(!1),"function"==typeof(n=e.options).success&&n.success(),e.focus(),T.gta.event(null,"click","add tasks success",t.length)}}(this))["catch"](function(t){return this.disableSubmit(!1),o.show({message:t,status:"error"})})},e.prototype.createMultipleTasks=function(t,e){var i;return i=50,t.length>i?this.requestSubView(p,{$toggler:this.$submit,title:tb_i18n.get("task.creator.multiple.too.many"),description:tb_i18n.get("task.creator.multiple.too.many.desc",i,t.length),
cancelStr:tb_i18n.get("task.creator.multiple.too.many.confirm"),onCancel:function(t){return function(){return t.focus()}}(this)}).show():this.requestSubView(p,{$toggler:this.$submit,title:tb_i18n.get("task.creator.multiple"),description:tb_i18n.get("task.creator.multiple.desc",t.length),cancelStr:tb_i18n.get("task.creator.multiple.one"),confirmStr:tb_i18n.get("task.creator.multiple.all",t.length),onCancel:function(t){return function(){return t.createTask(e)}}(this),onConfirm:function(e){return function(){return e.batchCreateTasks(t)}}(this)}).show()},e.prototype.disableSubmit=function(t){return this.$submit.prop("disabled",t),this.$submit[t?"addClass":"removeClass"]("disabled"),this},e.prototype.remove=function(){var t;return"function"==typeof(t=this.options).beforeClose&&t.beforeClose(),e.__super__.remove.apply(this,arguments)},e}(w)},function(t,e){t.exports=function(t){var e='<textarea class="task-content-input form-control" placeholder="'+tb_i18n.get("task.creator.content")+'" data-gta="{action: \'edit title\', type: \'task\', control: \'New Task\'}"></textarea><div class="handler-wrap"> <a class="executor-handler" data-gta="{action: \'select assignee\', control: \'New Task\'}"> <span class="avatar img-circle img-24"></span> <span class="creator-handler-text name"></span> </a></div><div class="involve-wrap clearfix"></div><div class="handler-wrap more-handler-wrap"> <a class="more-handler"> <span class="icon icon-more"></span> <span class="creator-handler-text">'+tb_i18n.get("more")+'</span> </a></div><div class="task-date-wrap"></div><div class="handler-wrap more-set"> <a class="priority-handler"> <span class="icon icon-circle priority-label"></span> <span class="creator-handler-text priority-text">'+tb_i18n.get("task.detail.priority.info")+'</span> </a></div><div class="handler-wrap more-set"> <a class="repeat-handler"> <span class="icon icon-repeat"></span> <span class="creator-handler-text repeat-text">'+tb_i18n.get("task.detail.repeat.info")+'</span> </a></div><div class="tags-wrap clearfix more-set"></div><div class="submit-set clearfix"> <a class="creator-visible hide" data-visible="involves" data-gta="{action: \'Toggle visibility\', type: \'task\', control: \'New Task\'}"> <span class="icon icon-unlock"></span>'+tb_i18n.get("visible.mode")+' <span class="mode-explanation">'+tb_i18n.get("visible.to.member")+'</span> </a> <a class="creator-visible hide" data-visible="members" data-gta="{action: \'Toggle visibility\', type: \'task\', control: \'New Task\'}"> <span class="icon icon-lock"></span>'+tb_i18n.get("visible.mode")+' <span class="mode-explanation">'+tb_i18n.get("visible.to.involve")+'</span> </a> <button class="btn btn-primary submit-handler">'+tb_i18n.get("create")+"</button></div>";return e}},function(t,e){t.exports=function(t){var e="",i=t.dateItems;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+='<div class="handler-wrap more-set"> <a class="task-datepicker ',n.dateString&&(e+="has-data"),e+='" data-type="'+n.type+'" data-gta="{action: \'edit ',e+="startDate"===n.type?"start ":"due ",e+="date', control: 'New Task' ",t.projectId&&(e+=", projectid: '"+t.projectId+"'"),t.orgId&&(e+=", organizationid: '"+t.orgId+"'"),e+='}}"> <span class="icon icon-calendar2"></span> <span class="creator-handler-text">'+(n.dateString||n.hint)+"</span> </a> ",t.preciseDate&&n.timeString&&(e+=' <a class="task-timepicker ',n.timeString&&(e+="has-data"),e+='" data-type="'+n.type+'" data-gta="{action: \'edit ',e+="startDate"===n.type?"start ":"due ",e+="time', control: 'New Task' ",t.projectId&&(e+=", projectid: '"+t.projectId+"'"),t.orgId&&(e+=", organizationid: '"+t.orgId+"'"),e+='}}"> <span class="creator-handler-text">'+n.timeString+"</span> </a> "),e+="</div>";return e}},function(t,e){t.exports=function(t){var e='<header class="scrum-stage-header"></header><div class="scrum-stage-wrap hidden-creator ';return t.permissions.taskPost||(e+="no-permission"),e+='"> <section class="scrum-stage-content thin-scroll"> <ul class="scrum-stage-tasks"></ul> <div class="task-creator-wrap card" data-stage="'+t._id+'"></div> <ul class="scrum-stage-tasks-done"></ul> ',t.permissions.taskPost&&(e+=' <div class="task-creator-handler-wrap"> <a class="task-creator-handler link-add-handler" data-gta="{action: \'add content\', type: \'task\', control: \'Stage List\'}"> <span class="icon icon-plus"></span>'+tb_i18n.get("task.creator.add")+" </a> </div> "),e+=" </section></div>"}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="stage-name"> <span class="icon icon-tick"></span>'+e(t.name)+" ";return t.totalCount&&(i+=' <span class="task-count"> · '+t.totalCount+"</span> "),i+=' <span class="icon icon-chevron-right"></span></div>',(t.permissions.post||t.permissions.put||t.permissions.del)&&(i+='<a class="stage-menu-toggler icon icon-circle-down hinted" data-title="'+tb_i18n.get("stage.edit.title")+'" data-gta="{action: \'toggle stage menu\'}"></a>'),i}},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(678),o=i(788),n=i(1532),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="StageAddView",e.prototype.className="locked-stage scrum-stage toggler-parent stage-add-view",e.prototype.tagName="li",e.prototype.hotkeys={esc:"contract"},e.prototype.events={"click .expand-creator-handler":"expand","click .contract-creator-handler":"contract","click .submit-add-stage":"onSubmitAddStage","keydown .stage-name":"onQuickSubmit"},e.prototype.initialize=function(t){return this.stagesCollection=t.stagesCollection,this.renderBasic()},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$handlerWrap=this.$(".handler-wrap"),this.$creatorWrap=this.$(".creator-wrap"),this.$stageName=this.$(".stage-name"),this},e.prototype.handleClickOutside=function(){return this.$el.handleClickOutside(function(t){return function(){return t.$stageName.val().trim()||t.$creatorWrap.hasClass("hidden")?t.handleClickOutside():t.contract()}}(this),"click"),this},e.prototype.expand=function(){return this.$handlerWrap.addClass("hidden"),this.$creatorWrap.removeClass("hidden"),this.$stageName.focusAtEnd(),this.handleClickOutside(),this},e.prototype.contract=function(){return this.$handlerWrap.removeClass("hidden"),this.$creatorWrap.addClass("hidden"),this},e.prototype.onQuickSubmit=function(t){return 13===t.keyCode&&(t.preventDefault(),this.onSubmitAddStage()),this},e.prototype.onSubmitAddStage=function(){var t,e,i;return t=this.$(".btn"),i=this.$stageName.val().trim(),e=this.stagesCollection.last(),i?(t.addClass("disabled"),this.stagesCollection.create({name:i,_tasklistId:e.get("_tasklistId"),_prevId:e.id},{wait:!0,success:function(t){return function(){return s.gta.event(null,"submit","add_stage_last"),t.renderBasic().expand()}}(this)})):this.$stageName.focusAtEnd(),this},e}(o)},function(t,e){t.exports=function(t){var e='<div class="handler-wrap"> <a class="expand-creator-handler"><span class="icon icon-plus"></span>'+tb_i18n.get("stage.add.tip")+'</a></div><div class="creator-wrap hidden"> <input type="text" placeholder="'+tb_i18n.get("stage.add.tip")+'" class="form-control stage-name"> <div class="buttons"> <a class="btn btn-link contract-creator-handler">'+tb_i18n.get("cancel")+"</a> <a class=\"btn btn-primary submit-add-stage\" data-gta=\"{action: 'added content', type: 'task stage', control: 'new stage button', method: 'click'}\">"+tb_i18n.get("save")+"</a> </div></div>";return e}},function(t,e){t.exports=function(t){var e='<ul class="board-scrum-stages horizontal-scroll"></ul>';return e}},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;n=i(1535),r=i(1536),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.viewName="TasklistPanelView",e.prototype.className="tasklist-panel hack-render-bug",e.prototype.appendTo=".board-view",e.prototype.panelWidth=300,e.prototype.useTransformAnimation=!0,e.prototype.initialize=function(t){return!(null==t||!t._projectId)&&(t.appendTo&&(this.appendTo=t.appendTo),this.options=t,this._projectId=this.options._projectId,e.__super__.initialize.apply(this,arguments))},e.prototype.isSame=function(t){return t._projectId===this._projectId},e.prototype.getHiddenStatus=function(){return{left:-this.panelWidth}},e.prototype.getShownStatus=function(){return{left:0}},e.prototype.defaultLayer=function(t){return this.requestSubView(r,this.options).$el.appendTo(t),this},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;l=i(358),p=i(678),a=i(677),c=i(788),r=$(document),n=$("body"),o=function(t){return"<div class='panel-layer panel-layer-"+t.depth+"'\n     data-depth='"+t.depth+"'></div>"},t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="PanelView",e.prototype.className="panel-view",e.prototype.panelWidth=580,e.prototype.duration=400,e.prototype.isIn=!1,e.prototype.$layers=[],e.prototype.useTransformAnimation=!0,e.prototype.appendTo="body",e.prototype.direction="right-to-left",e.prototype.excludeSelectors=[".delete-handler",".datepicker",".popover",".activity-destroyer",".subtask-check-box",".check-box",".modal",".pen-menu","#atwho-container"],e.prototype.isSame=function(){return!0},e.prototype.initialize=function(t){return this.options=l.extend({holdon:!1,showing:function(t){return function(){return t}}(this),shown:function(t){return function(){return t}}(this),hidden:function(t){return function(){return t}}(this),entered:function(t){return function(){return t}}(this),backed:function(t){return function(){return t}}(this)},t),this.$el.width(this.panelWidth),this},e.prototype.getHiddenStatus=function(){return l.isNumber(this.rightOffset)?{right:this.rightOffset-this.panelWidth}:{right:0-this.panelWidth}},e.prototype.getShownStatus=function(){return l.isNumber(this.rightOffset)?{right:this.rightOffset}:{right:0}},e.prototype.renderLayer=function(){var t,e,i,n,r,s,a;return(2===arguments.length||"object"==typeof arguments[1])&&(this.options.holdon?t=$(o({depth:0})).appendTo(this.$el):(t=$(o({depth:this.$layers.length+1})).appendTo(this.$el),this.$layers.push(t)),e=arguments[0].Constructor||arguments[0],e.prototype.viewName?(a=arguments[0],r=arguments[1],i=l.extend({where:"panel"},r),s=this.requestSubView(a,i),s.$el.appendTo(t)):(n=arguments[0],n.apply(this,[t])),t)},e.prototype.show=function(t){var e,i,n,r,o;return this.isIn?this:("function"==typeof(n=this.options).showing&&n.showing(),this.isIn=!0,e=this.getHiddenStatus(),i=this.getShownStatus(),this.$el.css(e).appendTo(this.appendTo),this.useTransformAnimation&&(null!=i.right?(i.x=e.right-i.right,delete i.right):null!=i.left&&(i.x=i.left-e.left,delete i.left)),r=this.options.holdon?0:this.duration,o=this.delayRatio?r*this.delayRatio:0,l.delay(function(t){return function(){return t.renderLayer(t.defaultLayer,t.options)}}(this),o),this.$el.transition(i,r,"ease",function(e){return function(){return e.options.holdon||e.$el.handleClickOutside(function(){return e.hide()},"click.panel",e.excludeSelectors.join(",")),e.options.shown(),"function"==typeof t?t():void 0}}(this)),this)},e.prototype.hide=function(t){var e,i;if(this.$el)return e=this.getHiddenStatus(),i=this.getShownStatus(),this.useTransformAnimation&&(e.x=0),null==e.opacity&&(e.opacity=0),this.$el.transition(e,300,"ease",function(e){return function(){if(e.$el){if(e.isIn=!1,!e.options.holdon)for(;e.$layers.length>0;)e.$layers.pop().remove();return e.options.hidden(),e.remove(),"function"==typeof t?t():void 0}}}(this)),this},e.prototype.enter=function(t,e){var i,n,r;return r=l.last(this.subViews),"function"==typeof r.undelegateEvents&&r.undelegateEvents(),n=l.last(this.$layers),i=this.renderLayer(t,e),n.transition({x:-30,opacity:0},300,"ease"),i.css({right:-this.panelWidth}).transition({x:-this.panelWidth},400,"ease",function(t){return function(){return t.options.entered(),"function"==typeof e.entered?e.entered():void 0}}(this)),this},e.prototype.back=function(t){var e,i;return this.$layers.length<=1?this.hide(t):(e=this.$layers.pop(),i=l.last(this.$layers),e.transition({x:0},300,"ease"),i.transition({x:0,opacity:1},400,"ease",function(i){return function(){var n;return e.remove(),i.subViews.pop().remove(),n=l.last(i.subViews),null!=n&&"function"==typeof n.delegateEvents&&n.delegateEvents(),i.options.backed(),"function"==typeof t?t():void 0}}(this))),this},e}(c)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w=function(t,e){function i(){this.constructor=t}for(var n in e)_.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},_={}.hasOwnProperty;b=i(358),k=i(678),g=i(677),v=i(788),y=i(786),r=i(699),s=i(696),f=i(994),o=i(1005),h=i(1537),m=i(1542),l=i(1551),p=i(1557),a=i(1558),u=i(1559),c=i(1560),n=i(1561),t.exports=d=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.viewName="TasklistBarView",e.prototype.className="tasklist-bar hack-render-bug thin-scroll",e.prototype.events={"input .filter-input-wrap input":"renderTasklists","click .tasklist-creator-toggler":"toggleTasklistCreator","click .tasklist-bar-pin":"pinTasklistBar","click .tasklist-tab":"goToTasklist","click .tasklist-smart-link":"openSmartTasklist"},e.prototype.initialize=function(t){return!(null==t||!t._projectId)&&(e.__super__.initialize.call(this,t),t.appendTo&&(this.appendTo=t.appendTo),this.options=t,this._projectId=t._projectId,this.projectModel=s.getOne(0,this._projectId),this.membersCollection=r.get(this._projectId),this.load(function(t){return function(){return t.renderBasic(),t.renderTasklistCreator(),t.renderTasklists(),t.renderMemberMenu(),t.listen()}}(this)))},e.prototype.listen=function(){return this.listenTo(this.tasklistsCollection,"change add remove",this.renderTasklists),this.listenTo(k.router,"route",this.refreshActiveTasklist),this},e.prototype.load=function(t){return f.fetch(this._projectId,{success:function(e){return function(i){return e.tasklistsCollection=i,t()}}(this),error:function(t,e){return console.error(e)}}),this},e.prototype.renderBasic=function(){var t;return t=this.projectModel.hasPermission("tasklist.post")&&this.projectModel.isAppEnabled("tasklist"),this.$el.html(n({isTasklistCreatorShow:t,isPined:k.PREFERENCE.get("pinTasklistBar")})),this.$tasklists=this.$(".tasklist-bar-tasklists"),this.$tasklistCreator=this.$(".tasklist-creator-wrap"),this.$tasklistSmartMember=this.$(".tasklist-smart-member"),this},e.prototype.renderTasklists=function(t){var e;return(null!=t?t.type:void 0)&&(e=$(t.currentTarget).val().trim().toLowerCase()),this.$tasklists.empty(),this.tasklistsCollection.updateSort(k.PREFERENCE.tasklistSortInProject(this._projectId),!0),this.tasklistsCollection.each(function(t){return function(i){if(!e||~i.get("title").toLowerCase().indexOf(e))return t.renderTasklist(i)}}(this)),e?this.$tasklists.sortable("destroy"):this.setupSortable(),this.refreshActiveTasklist(),this},e.prototype.renderTasklist=function(t,e){return this.requestSubView(m,{tasklistModel:t,tasklistsCollection:this.tasklistsCollection}).$el.appendTo(this.$tasklists),this},e.prototype.renderTasklistCreator=function(){return this.projectModel.hasPermissions("tasklist.post")&&(this.tasklistCreator=this.requestSubView(h,{_projectId:this._projectId,tasklistsCollection:this.tasklistsCollection,success:function(t){return function(e){return b.delay(function(){if(t.$el)return t.$el.removeClass("creator-on"),t.$("[data-id="+e.id+"]").trigger("click")},100)}}(this)}),this.tasklistCreator.$el.appendTo(this.$tasklistCreator)),this},e.prototype.renderMemberMenu=function(){var t,e,i;return i=k.router.getUrl(),t=null!=(e=i.match(/\/membertasks\/([\w]{24})/))?e[1]:void 0,this.requestSubView(o,{$toggler:this.$tasklistSmartMember,selected:[t],multi:!1,select:function(e){return function(i){return t=i[0],e.openMemberTasks(t)}}(this),membersCollection:this.membersCollection}),this},e.prototype.toggleTasklistCreator=function(t){if(this.$el.toggleClass("creator-on"),this.$el.hasClass("creator-on"))return this.$(".tasklist-create-new input").focusAtEnd()},e.prototype.pinTasklistBar=function(t){var e;return e=!k.PREFERENCE.get("pinTasklistBar"),k.PREFERENCE.set("pinTasklistBar",e),$(t.currentTarget)[e?"addClass":"removeClass"]("pin"),this},e.prototype.setupSortable=function(t){return this.projectModel.getRoleScope()>=0?(this.$tasklists.disableSelection(),this.$tasklists.sortable({axis:"y",items:".tasklist-tab",stop:function(t){return function(e,i){var n,r;return n=$(e.target),r=n.sortable("toArray",{attribute:"data-id"}),k.PREFERENCE.tasklistSortInProject(t._projectId,r)}}(this)}),this):this},e.prototype.getActiveTasklistId=function(){var t,e;return e=k.router.getUrl(),t=null,this.tasklistsCollection.each(function(i){if(~e.indexOf(i.id))return t=i.id}),t},e.prototype.refreshActiveTasklist=function(){var t;return t=this.getActiveTasklistId(),this.$(".tasklist-tab").removeClass("on-active"),this.$(".tasklist-tab[data-id="+t+"]").addClass("on-active")},e.prototype.goToTasklist=function(t){var e,i,n;if(e=$(t.currentTarget),i=e.data("id"),n=k.router.getPrefix(),i)return k.router.navigate(n+"/tasks/scrum/"+i,!0)},e.prototype.openSmartTasklist=function(t){var e,i;return"function"==typeof(e=this.options).onSmartItemSelect&&e.onSmartItemSelect(),i={todaytasks:l,totaltasks:p,donetasks:a,unassignedtasks:u},this.requestSubView(y).open(i[$(t.currentTarget).data("id")],{_projectId:this._projectId})},e.prototype.openMemberTasks=function(t){var e,i;if(t)return"function"==typeof(e=this.options).onSmartItemSelect&&e.onSmartItemSelect(),i=this.membersCollection.get(t),this.requestSubView(y).open(c,{_projectId:this._projectId,memberModel:i})},e}(v)},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;l=i(678),n=i(1538),r=i(1539),s=i(1541),a=i(788),c=function(){return[{_id:"tasklist0",title:tb_i18n.get("tasklist.temp1title"),"class":"tasklist_design",stages:[tb_i18n.get("tasklist.temp1stage1"),tb_i18n.get("tasklist.temp1stage2"),tb_i18n.get("tasklist.temp1stage3"),tb_i18n.get("tasklist.temp1stage4"),tb_i18n.get("tasklist.temp1stage5")]},{_id:"tasklist1",title:tb_i18n.get("tasklist.temp2title"),"class":"tasklist_develope",stages:[tb_i18n.get("tasklist.temp2stage1"),tb_i18n.get("tasklist.temp2stage2"),tb_i18n.get("tasklist.temp2stage3"),tb_i18n.get("tasklist.temp2stage4"),tb_i18n.get("tasklist.temp2stage5")]},{_id:"tasklist2",title:tb_i18n.get("tasklist.temp3title"),"class":"tasklist_support",stages:[tb_i18n.get("tasklist.temp3stage1"),tb_i18n.get("tasklist.temp3stage2"),tb_i18n.get("tasklist.temp3stage3"),tb_i18n.get("tasklist.temp3stage4")]}]},t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="TasklistCreatorView",e.prototype.className="tasklist-creator",e.prototype.events={"submit .tasklist-create-form":"submitCreateForm","click .tab-handler":"switchTabs","click .temp-handler":"getCreateTemp","click .temp-delete":"deleteTemp"},e.prototype.initialize=function(t){return!!((null!=t?t._projectId:void 0)&&t.tasklistsCollection)&&(this.options=t,this.renderBasic().focus(),r.fetch(0,{success:function(t){return function(e){return t.stageTemplatesCollection=e,e.add(c()),t._selectId=e.at(0).id,t.renderTemplates().listen()}}(this)}),this)},e.prototype.listen=function(){return this.listenTo(this.stageTemplatesCollection,"add",this.renderTemplates),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$temps=this.$(".tasklist-create-temps"),this},e.prototype.renderTemplates=function(){return this.stageTemplatesCollection.sort(),this.$temps.html(s({templates:this.stageTemplatesCollection.toJSON(),_selectId:this._selectId})),this},e.prototype.focus=function(){return this.$("input").focusAtEnd(),this},e.prototype.switchTabs=function(t){var e;return e=$(t.currentTarget),e.parent().hasClass("active")||(this.$(".tab-pane.active, .nav >li.active").removeClass("active"),e.parent().addClass("active"),this.$(""+e.data("id")).addClass("active")),this},e.prototype.getCreateTemp=function(t){var e;return e=$(t.currentTarget),e.hasClass("active")||(this.$(".temp-handler.active").removeClass("active"),e.addClass("active"),this._selectId=e.data("id")),this},e.prototype.deleteTemp=function(t){var e,i;return t.preventDefault(),e=$(t.currentTarget).parent(),i=e.data("id"),this.$(".temp-handler[data-id="+i+"]").remove(),this.stageTemplatesCollection.get(i).destroy(),this},e.prototype.submitCreateForm=function(t){var e,i,n,r,o,s;return t.preventDefault(),e=$(t.currentTarget),"tasklist-create-new"===this.$(".tab-pane.active").attr("id")?(s=e.find("input").val(),n=e.find("textarea").val(),i=null):(r=this.stageTemplatesCollection.get(this._selectId),s=r.get("title"),n=s,24===this._selectId.length?i=this._selectId:o=r.get("stages")),s=s.trim(),s?this.options.tasklistsCollection.create({title:s,description:n||"",_projectId:this.options._projectId,_templateId:i,stages:o},{wait:!0,success:function(t){return function(i){var n;return e.find("input").val(""),e.find("textarea").val(""),"function"==typeof(n=t.options).success&&n.success(i),l.gta.event({action:"added content",type:"task group",control:"tasks group menu"+("tasklist-create-new"!==t.$(".tab-pane.active").attr("id")?" template":"")})}}(this)}):this.focus(),this},e}(a)},function(t,e){t.exports=function(t){var e='<ul class="nav nav-tabs"> <li class="active"> <a class="tab-handler" data-id="#tasklist-create-new">'+tb_i18n.get("tasklist.creator.new")+'</a> </li> <li> <a class="tab-handler" data-id="#tasklist-create-temps">'+tb_i18n.get("tasklist.creator.temp")+'</a> </li></ul><form class="tasklist-create-form"> <div class="tab-content"> <div class="tab-pane active" id="tasklist-create-new"> <div class="tasklist-create-new"> <input class="form-control" type="text" data-gta="event" data-label="enter tasklist title" placeholder="'+tb_i18n.get("tasklist.creator.tasklist.title")+'"/> <textarea class="form-control" data-gta="event" data-label="enter tasklist description" placeholder="'+tb_i18n.get("tasklist.creator.tasklist.desc")+'"></textarea> </div> </div> <div class="tab-pane" id="tasklist-create-temps"> <ul class="tasklist-create-temps list"></ul> </div> </div> <div class="submit-button-wrapper"> <button class="submit-button btn btn-primary" type="submit"> '+tb_i18n.get("tasklist.creator.submit")+" </button> </div></form>";return e}},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;n=i(685),r=i(1540),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.name="stagetemplates",e.prototype.model=r,e.prototype.orderBy="latest-created",e}(n)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(688),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.name="stagetemplate",e.prototype.urlRoot="stagetemplates",e.prototype.defaults={title:"",description:"","class":"tasklist_custom",stages:[]},e}(n)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t.templates;if(n)for(var r,o=-1,s=n.length-1;o<s;){r=n[o+=1],i+='<li class="temp-handler ',t._selectId==r._id&&(i+="active"),i+='" data-id="'+r._id+'"> <div class="temp-icon '+r["class"]+' pull-left"></div> <span class="icon icon-tick temp-selected pull-right"></span> ',"tasklist_custom"==r["class"]&&(i+=' <a class="icon icon-remove temp-delete pull-right"></a> '),i+=' <div class="temp-info"> <strong class="temp-title">'+e(r.title)+'</strong> <div class="temp-stages"> <span class="stage-name">'+e(r.stages[0])+"</span> ";var a=r.stages.slice(1);if(a)for(var c,l=-1,p=a.length-1;l<p;)c=a[l+=1],i+=' <span class="stage-name">&gt; '+e(c)+"</span> ";i+=" </div> </div></li>"}return i}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;a=i(788),c=i(678),o=i(1543),n=i(1550),r="change:title\nchange:description\nchange:totalCount\nchange:undoneCount\nchange:recentCount\nchange:expiredCount\nchange:doneCount",t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="tasklistTab",e.prototype.tagName="li",e.prototype.className="tasklist-tab",e.prototype.events={"click .tasklist-editor-handler":"openTasklistMenu"},e.prototype.initialize=function(t){return!(null==t||!t.tasklistModel)&&(this.options=t,this._projectId=t.tasklistModel.get("_projectId"),this.tasklistModel=t.tasklistModel,this.tasklistsCollection=t.tasklistsCollection,this.renderBasic().listen(),this)},e.prototype.listen=function(){return this.listenTo(this.tasklistModel,r,this.renderBasic),this.listenTo(this.tasklistModel,"destroy remove",this.remove),this},e.prototype.renderBasic=function(){var t;return t=this.tasklistModel.toJSON(),t.tasksPercent=this.tasklistsCollection.getTasksPercent(t.totalCount),this.$el.attr("data-id",this.tasklistModel.id),this.$el.html(n(t)),this.$el.attr({"data-gta":"{action: 'switch task group'}"}),this},e.prototype.openTasklistMenu=function(t){var e;return t.stopPropagation(),c.gta.event({action:"toggle task group menu",type:"task group",control:"tasks group title menu",method:"click"}),e=$(".tasklist-editor-handler").not(t.currentTarget),e.each(function(t,e){var i;return i=$(e).data("bs.popover"),null!=i?i.hide():void 0}),this.tasklistMenuView||(this.tasklistMenuView=this.requestSubView(o,{$toggler:$(t.currentTarget),tasklistModel:this.tasklistModel}).show())},e}(a)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y=function(t,e){function i(){this.constructor=t}for(var n in e)b.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},b={}.hasOwnProperty;f=i(358),v=i(678),g=i(679),l=i(813),c=i(401),h=i(1539),p=i(992),o=i(1544),r=i(1545),s=i(1546),a=i(1547),d=i(1548),u=i(1549),n=$("body"),t.exports=m=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.className="tasklist-menu-view",e.prototype.viewName="TasklistMenuView",e.prototype.popoverTitle="",e.prototype.width=250,e.prototype.events={click:"stopPropagation","click .edit-tasklist-handler":"enterEditSubMenu","click .stage-template-handler":"enterStageTemplateMenu","click .archive-tasklist-handler":"enterArchiveSubMenu","click .delete-tasklist-handler":"enterDeleteSubMenu","click .export-tasklist-handler":"exportTasklistHandler","submit .tasklist-edit-form":"submitEditForm","submit .stage-template-form":"submitStageTemplateForm","submit .tasklist-delete-form":"submitDeleteForm","submit .tasklist-archive-form":"submitArchiveForm","submit .stage-template-created":"createdForm"},e.prototype.initialize=function(t){return null==t&&(t={}),this.tasklistModel=t.tasklistModel,this._projectId=t.tasklistModel.get("_projectId"),this.popoverTitle=tb_i18n.get("tasklist.menu.title"),e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){return this.renderMenu(),this},e.prototype.stopPropagation=function(t){return t.stopPropagation()},e.prototype.renderMenu=function(){var t,e;return this.$popover.removeClass("in-submenu"),this.$title.text(this.popoverTitle),t=f.extend(this.tasklistModel.toJSON(),{permissions:this.tasklistModel.hasPermissions("put","put.archive","del"),tasklistCount:(null!=(e=this.tasklistModel.collection)?e.length:void 0)||0}),this.$el.html(o(t)),this.triggerHook("render"),this},e.prototype.enterEditSubMenu=function(){return this.enterSubMenu(tb_i18n.get("tasklist.menu.edit.title"),function(t){return function(){return t.$el.html(a(t.tasklistModel.toJSON())),t.$("input").focusAtEnd()}}(this)),this},e.prototype.enterStageTemplateMenu=function(){return p.fetch(this.tasklistModel.id,{success:function(t){return function(e){return t.stages=[],e.each(function(e){return t.stages.push(e.get("name").replace(/,/g,""))}),t.enterSubMenu(tb_i18n.get("tasklist.menu.templates"),function(){return t.$el.html(d({stages:t.stages})),t.$("input").focusAtEnd()})}}(this)}),this},e.prototype.enterStageTemplateCreatedMenu=function(t){var e;return e=t.get("title"),this.$el.html(u({successInfo:tb_i18n.get("tasklist.menu.add.templates.success",e)})),this},e.prototype.enterArchiveSubMenu=function(){return this.enterSubMenu(tb_i18n.get("archive.taskgroup"),function(t){return function(){var e;return t.$el.html(r({isLast:1===(null!=(e=t.tasklistModel.collection)?e.length:void 0)}))}}(this)),this},e.prototype.enterDeleteSubMenu=function(){return this.enterSubMenu(tb_i18n.get("tasklist.menu.delete.title"),function(t){return function(){var e;return t.$el.html(s({isLast:1===(null!=(e=t.tasklistModel.collection)?e.length:void 0)}))}}(this)),this},e.prototype.exportTasklistHandler=function(){var t;return t=g.API_HOST+"/tasklists/"+this.tasklistModel.id+"/export",t&&$.fileDownload(t),this},e.prototype.submitEditForm=function(t){var e,i,n;return t.preventDefault(),e=$(t.currentTarget),n=e.find("input").val().trim(),i=e.find("textarea").val(),n?this.tasklistModel.save(null,{attrs:{title:n,description:i},success:function(t){return function(){return t.renderMenu()}}(this)}):e.find("input").focusAtEnd(),this},e.prototype.submitStageTemplateForm=function(t){var e,i,n;return t.preventDefault(),e=$(t.currentTarget),n=e.find("input").val().trim(),n?(i=h.get(0),i.create(null,{wait:!0,attrs:{title:n,stages:this.stages.join(",")},success:function(t){return function(e){return t.enterStageTemplateCreatedMenu(e)}}(this)}),v.gta.event(null,"create","board|create stage template")):e.find("input").focusAtEnd(),this},e.prototype.submitArchiveForm=function(t){return t.preventDefault(),this.tasklistModel.archive({success:function(){return c.show({message:tb_i18n.get("archived.taskgroup.success"),status:"success"})}}),this},e.prototype.submitDeleteForm=function(t){return t.preventDefault(),this.tasklistModel.destroy({wait:!0,success:function(){return c.show({message:tb_i18n.get("delete.success"),status:"success"})}}),this},e.prototype.createdForm=function(t){return t.preventDefault(),this.renderMenu(),this},e}(l)},function(t,e){t.exports=function(t){var e='<ul class="list"> ';return t.permissions.put&&(e+=' <li> <a class="edit-tasklist-handler" data-gta="event" data-label="open tasklist editor"> <span class="icon icon-pencil"></span> '+tb_i18n.get("tasklist.menu.edit.title")+" </a> </li> "),e+=' <li> <a class="stage-template-handler" data-gta="event" data-label="create stage template"> <span class="icon icon-plus"></span> '+tb_i18n.get("tasklist.menu.add.templates")+" </a> </li> ",
t.permissions.putArchive&&t.tasklistCount>1&&(e+=' <li> <a class="archive-tasklist-handler" data-gta="event" data-label="archive tasklist"> <span class="icon icon-archive"></span> '+tb_i18n.get("archive.taskgroup")+" </a> </li> "),e+=" ",t.permissions.del&&t.tasklistCount>1&&(e+=' <li> <a class="delete-tasklist-handler" data-gta="event" data-label="delete tasklist"> <span class="icon icon-trash"></span> '+tb_i18n.get("tasklist.menu.delete.title")+" </a> </li> "),e+="</ul>"}},function(t,e){t.exports=function(t){var e="";return e+=t.isLast?' <p class="edit-info muted"> '+tb_i18n.get("tasklist.menu.last.cannot.edit")+". </p>":' <form class="tasklist-archive-form"> <p>'+tb_i18n.get("tasklist.menu.confirm.archive")+'</p> <button class="btn btn-primary" type="submit">'+tb_i18n.get("confirm")+"</button> </form>"}},function(t,e){t.exports=function(t){var e="";return e+=t.isLast?' <p class="edit-info muted"> '+tb_i18n.get("tasklist.menu.last.cannot.edit")+". </p>":' <form class="tasklist-delete-form"> <p>'+tb_i18n.get("tasklist.menu.confirm.delete")+'</p> <button class="btn btn-danger" type="submit">'+tb_i18n.get("delete")+"</button> </form>"}},function(t,e){t.exports=function(t){var e='<form class="tasklist-edit-form"> <input class="form-control" placeholder="'+tb_i18n.get("tasklist.menu.tasklist.title")+'" type="text" value="'+t.title+'" /> <textarea class="form-control" placeholder="'+tb_i18n.get("tasklist.menu.tasklist.desc")+'">'+t.description+'</textarea> <button class="btn btn-primary" type="submit">'+tb_i18n.get("save")+"</button></form>";return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<form class="stage-template-form"> <p class="muted">'+tb_i18n.get("tasklist.menu.add.templates.detail")+'</p> <input class="form-control" placeholder="'+tb_i18n.get("tasklist.menu.templates")+'" type="text" /> <p class="stage-template-stages muted"> <span class="stage-name">'+e(t.stages[0])+"</span> ",n=t.stages.slice(1);if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <span class="stage-name">&gt; '+e(r)+"</span> ";return i+=' </p> <button class="btn btn-primary" type="submit">'+tb_i18n.get("save")+"</button></form>"}},function(t,e){t.exports=function(t){var e='<form class="stage-template-created"> <p class="stage-template-success">'+t.successInfo+'</p> <p class="muted">'+tb_i18n.get("tasklist.menu.add.templates.desc")+'</p> <button class="btn btn-primary">'+tb_i18n.get("confirm")+"</button></form>";return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<h4 class="tasklist-title"> <strong>'+e(t.title)+'</strong><span class="muted"> · '+(t.doneCount||0)+"/"+(t.totalCount||0)+'</span> <a class="icon icon-circle-down pull-right tasklist-editor-handler"></a></h4><p class="tasklist-description muted">'+e(t.description)+"</p>";return t.totalCount>0&&(i+=' <div class="tasklist-strip-wrap" style="width:'+t.tasksPercent+'%"> <div class="tasklist-strip"> <div class="strip-part done-part hinted" style="width:'+t.doneCount/t.totalCount*100+'%;" data-title="'+tb_i18n.get("tasklist.tab.status.done")+" "+t.doneCount+'"> <div class="strip-part-bar"></div> </div> <div class="strip-part undone-part hinted" style="width:'+(t.undoneCount-t.recentCount-t.expiredCount)/t.totalCount*100+'%;" data-title="'+tb_i18n.get("tasklist.tab.status.normal")+" "+(t.undoneCount-t.recentCount-t.expiredCount)+'"> <div class="strip-part-bar"></div> </div> <div class="strip-part recent-part hinted" style="width:'+t.recentCount/t.totalCount*100+'%;" data-title="'+tb_i18n.get("tasklist.tab.status.upcoming")+" "+t.recentCount+'"> <div class="strip-part-bar"></div> </div> <div class="strip-part expire-part hinted" style="width:'+t.expiredCount/t.totalCount*100+'%;" data-title="'+tb_i18n.get("tasklist.tab.status.overdue")+" "+t.expiredCount+'"> <div class="strip-part-bar"></div> </div> </div> </div>'),i}},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=i(1552),n=i(429),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.smartType="today",e.prototype.viewName="ScrumSmartTodayView",e.prototype.getViewName=function(){return tb_i18n.get("tasklist.bar.today.tasks")},e.prototype.getViewId=function(){return"todaytasks"},e.prototype.getQueryType=function(){return"today"},e.prototype.getQueryAttrs=function(){return{isDone:!1,dueDate__lt:n().endOf("day").toISOString()}},e}(o)},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;l=i(358),p=i(678),c=i(788),o=i(797),r=i(1e3),a=i(1553),n=i(1556),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="ScrumSmartView",e.prototype.className="scrum-smart-view modal-dialog flex-vert",e.prototype.events={"click .task":"gtaEvent"},e.prototype.initialize=function(t){return!(null==t||!t._projectId)&&(this.options=t,this._projectId=t._projectId,this.tasksCollection=null,this.queryType="smart",this.renderBasic(),this.showLoadingIndicator(this.$content),this.load(function(t){return function(){if(t.$el)return t.hideLoadingIndicator(),t.renderTasks(),t.initView(),t.listen()}}(this)),this)},e.prototype.initView=function(){return this.setupScroll(this.$content),this.setupLoadMore(10)},e.prototype.listen=function(){return this.listenTo(this.tasksCollection,"change:dueDate",this.renderTasks)},e.prototype.renderBasic=function(){return this.$el.html(n({name:this.getViewName()})),this.$content=this.$(".modal-body")},e.prototype.renderTasks=function(){var t;if(this.tasksCollection.sort(),t=this.requestSubView(a,{isInBoard:!0,isPrepend:!1,tasksCollection:this.tasksCollection,onTaskTagClick:function(t){return function(){var e;return"function"==typeof(null!=(e=t.parentView)?e.close:void 0)?t.parentView.close():t.$el.hide()}}(this)}),this.$content.html(t.$el),this.tasksCollection.length&&!this.tasksCollection.hasMore)return this.showEndPoint(this.$content)},e.prototype.getViewName=function(){return""},e.prototype.getViewId=function(){return""},e.prototype.getRenderTitle=function(){return""},e.prototype.getQueryType=function(){return"smart"},e.prototype.getQueryAttrs=function(){return{}},e.prototype.getQueryId=function(t){return this._projectId+"_"+t},e.prototype.gtaEvent=function(){return p.gta.event({action:"open detail",type:"task",control:this.smartType+" task"})},e.prototype.load=function(t){var e,i;return this.queryAttrs=l.extend(this.getQueryAttrs(),{_projectId:this._projectId,withTasklist:!0,withTags:!0}),i=this.getQueryType(),e=this.getQueryId(i),r.fetch(e,{_projectId:this._projectId,queryType:i,_executorId:"excutor"===i?this.getQueryAttrs()._executorId:void 0,attrs:this.queryAttrs,success:function(e){return function(i){return e.tasksCollection=i,"function"==typeof t?t():void 0}}(this)}),this},e.prototype.loadMore=function(t){if(this.$el)return this.tasksCollection.loadMore({attrs:this.queryAttrs,beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$content)}}(this),success:function(e){return function(i,n){if(e.$el)return e.hideLoadingIndicator({animated:!0}),e.tasksCollection.hasMore?"function"==typeof t?t():void 0:e.showEndPoint(e.$content)}}(this)})},e}(c),l.extend(s.prototype,o),t.exports=s},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m=function(t,e){function i(){this.constructor=t}for(var n in e)f.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},f={}.hasOwnProperty;d=i(358),h=i(678),l=i(677),p=i(788),u=i(786),r=i(794),s=i(1285),c=i(1207),n=i(1554),o=i(1555),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.viewName="TaskListView",e.prototype.className="task-list",e.prototype.tagName="ul",e.prototype.initialize=function(t){return!!t.tasksCollection&&(this.options=t,this.tasksCollection=t.tasksCollection,this.$placeholder=$(o()),this.renderBasic().checkPlaceholder().listen(),this)},e.prototype.listen=function(){return this.listenTo(this.tasksCollection,"add",this.addTask),this.listenTo(this.tasksCollection,"remove destroy",this.checkGroupBy),this.listenTo(this.tasksCollection,"add remove destroy",this.checkPlaceholder),this},e.prototype.renderBasic=function(){return this.tasksCollection.each(function(t){return function(e){return t.renderTask(e)}}(this)),"executor"===this.options.groupBy&&this.options.membersCollection&&this.options.membersCollection.each(function(t){return function(e){return t.getOrRenderGroup(e.toJSON())}}(this)),this.options._taskId&&this.openTaskDetail(this.options._taskId),this},e.prototype.renderTask=function(t,e){var i,n,r,o,s;return o=e?"prependTo":"appendTo",s=this.requestSubView(c,{model:t,noExecutor:this.options.noExecutor,onTaskTagClick:this.options.onTaskTagClick,showTaskDetail:function(e){return function(){return e.showTaskDetail(t)}}(this)}),i=s.$el,r=null,this.options.groupBy&&(r=t.get("project"),"executor"===this.options.groupBy&&(r=t.get("executor"))),r?(n=this.getOrRenderGroup(r),n.next(".member-no-task").remove(),i.insertAfterH(n)):i[o](this.$el),this},e.prototype.getOrRenderGroup=function(t){var e,i,r;for(t=d.clone(t),this.options.groupHandler&&(t.groupHandler=this.options.groupHandler),e=this.$("[data-id="+t._id+"]"),e.length||(e=$(n(t)),e.appendTo(this.$el)),r=e,i=r.next();i.length&&!i.hasClass("task-group-by")&&!i.hasClass("member-no-task");)r=i,i=r.next();return r},e.prototype.addTask=function(t){return this.renderTask(t,null==this.options.isPrepend||this.options.isPrepend),this},e.prototype.showTaskDetail=function(t){var e,i,n,o;if(t)return e=t.id,this.options.modalDetail?o=this.requestSubView(u).open(r,{fixedModal:!0,DetailView:s,_projectId:t.get("_projectId"),_tasklistId:t.get("_tasklistId"),taskModel:t}):this.options.isInBoard&&(null!=(n=h.APP.currentView)?n.renderTaskDetail:void 0)?(i={isUsePanel:!0,hasLink:!1},h.APP.openTaskPreviewer(t,i),h.APP.currentView.updateUrl(this._tasklistId,e)):h.APP.openTaskPreviewer(t),this},e.prototype.checkGroupBy=function(t){var e,i,n;if(this.options.groupBy&&(n=t.get("project")))return e=this.$(".task-group-by[data-id="+n._id+"]"),i=e.next(),i.length&&!i.hasClass("task-group-by")||e.remove(),this},e.prototype.checkPlaceholder=function(){return"executor"===this.options.groupBy&&this.options.membersCollection||(this.$placeholder.remove(),this.tasksCollection.length||this.$el.html(this.$placeholder)),this},e}(p)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li class="task-group-by" data-id="'+t._id+'"> ';return t.avatarUrl&&(i+=' <div class="avatar img-circle img-36 pull-left" style="background-image:url('+t.avatarUrl+');"></div> '),i+=' <span class="task-group-name">'+e(t.name)+"</span> ",t.groupHandler&&(i+=' <a class="group-handler link-add-handler">'+t.groupHandler+"</a> "),i+='</li><li class="member-no-task"> <span class="muted">'+tb_i18n.get("task.list.no.task")+"</span></li>"}},function(t,e){t.exports=function(t){var e='<div class="task-placeholder placeholder muted"> <span class="icon icon-board"></span> <br /> '+tb_i18n.get("task.placeholder")+"</div>";return e}},function(t,e){t.exports=function(t){var e='<div class="modal-header text-center flex-static"> <div class="modal-title text-center">'+t.name+'</div> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a></div><div class="modal-body flex-fill thin-scroll"></div>';return e}},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;r=i(1552),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.smartType="unfinished",e.prototype.viewName="ScrumSmartTodoView",e.prototype.getViewName=function(){return tb_i18n.get("tasklist.bar.total.tasks")},e.prototype.getViewId=function(){return"totaltasks"},e.prototype.getQueryType=function(){return"todo"},e.prototype.getQueryAttrs=function(){return{isDone:!1}},e}(r)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;r=i(1552),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.smartType="done",e.prototype.viewName="ScrumSmartDoneView",e.prototype.getViewName=function(){return tb_i18n.get("tasklist.bar.done.tasks")},e.prototype.getViewId=function(){return"donetasks"},e.prototype.getQueryType=function(){return"done"},e.prototype.getQueryAttrs=function(){return{isDone:!0}},e}(r)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;r=i(1552),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.smartType="unassigned",e.prototype.viewName="ScrumSmartUnassignedView",e.prototype.getViewName=function(){return tb_i18n.get("tasklist.bar.unassigned.tasks")},e.prototype.getViewId=function(){return"unassignedtasks"},e.prototype.getQueryType=function(){return"unassigned"},e.prototype.getQueryAttrs=function(){return{_executorId:"",isDone:!1}},e}(r)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;r=i(1552),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.smartType="member",e.prototype.viewName="ScrumSmartMemberView",e.prototype.getViewName=function(){var t;return t=this.options.memberModel.get("name"),tb_i18n.get("tasklist.bar.memberOf.tasks",t)},e.prototype.getViewId=function(){return"membertasks/"+this.options.memberModel.id},e.prototype.getQueryType=function(){return"excutor"},e.prototype.getQueryId=function(){return"member_"+this.options.memberModel.id},e.prototype.getQueryAttrs=function(){return{_executorId:this.options.memberModel.id,isDone:!1}},e}(r)},function(t,e){t.exports=function(t){var e='<div class="filter-input-wrap"> <input class="form-control" placeholder="'+tb_i18n.get("tasklist.bar.search.group")+'"></div><ul class="tasklist-bar-tasklists"></ul>';return t.isTasklistCreatorShow&&(e+="<div class=\"tasklist-bar-header clearfix\"> <a class=\"tasklist-creator-toggler\" data-gta=\"{action: 'add content', type: 'task group', control: 'tasks group menu', method: 'click'}\"> <span class=\"icon icon-circle-cross pull-left\"></span> <strong>"+tb_i18n.get("tasklist.bar.add.group")+'</strong> <span class="icon icon-chevron-up pull-right"></span> </a></div>'),e+='<div class="tasklist-creator-wrap"></div><ul class="tasklist-smart-group"> <li class="smart-group"> <a class="tasklist-smart-link" data-id="todaytasks" data-gta="{action: \'switch smart task group\', type: \'today\', control: \'Task Group Menu\'}"> <i class="icon icon-calendar2"></i> '+tb_i18n.get("tasklist.bar.today.tasks")+' </a> </li> <li class="smart-group"> <a class="tasklist-smart-link" data-id="totaltasks" data-gta="{action: \'switch smart task group\', type: \'unfinished\', control: \'Task Group Menu\'}"> <i class="icon icon-checkbox"></i> '+tb_i18n.get("tasklist.bar.total.tasks")+' </a> </li> <li class="smart-group"> <a class="tasklist-smart-link" data-id="donetasks" data-gta="{action: \'switch smart task group\', type: \'done\', control: \'Task Group Menu\'}"> <i class="icon icon-checkbox-checked"></i> '+tb_i18n.get("tasklist.bar.done.tasks")+' </a> </li> <li class="smart-group"> <a class="tasklist-smart-link" data-id="unassignedtasks" data-gta="{action: \'switch smart task group\', type: \'unassigned\', control: \'Task Group Menu\'}"> <i class="icon icon-circle-user"></i> '+tb_i18n.get("tasklist.bar.unassigned.tasks")+' </a> </li> <li class="smart-group"> <a class="tasklist-smart-member" data-gta="{action: \'switch smart task group\', type: \'members\', control: \'Task Group Menu\'}"> <i class="icon icon-users"></i> '+tb_i18n.get("tasklist.bar.member.tasks")+' <span class="caret"></span> </a> </li></ul><div class="pin-btn"> <a class="tasklist-bar-pin" data-gta="{action: \'pin task group menu\'}"> <i class="icon icon-pin"></i> ',e+=t.isPined?" "+tb_i18n.get("tasklist.bar.unpin")+" ":" "+tb_i18n.get("tasklist.bar.pin")+" ",e+=" </a></div>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S,I,z,P,D=function(t,e){return function(){return t.apply(e,arguments)}},O=function(t,e){function i(){this.constructor=t}for(var n in e)N.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},N={}.hasOwnProperty,E=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};I=i(358),P=i(678),z=i(679),h=i(401),_=i(797),j=i(677),T=i(788),c=i(793),u=i(928),g=i(699),w=i(696),S=i(810),s=i(1563),a=i(1565),l=i(927),p=i(1567),b=i(982),M=i(786),C=i(924),x=i(1573),k=i(1579),n=i(1700),r=i(1701),o=i(1702),d=i(1703),m=i(1704),v=i(1705),y=i(1706),f=function(t){function e(){return this.moveToCollection=D(this.moveToCollection,this),this.forkToCollection=D(this.forkToCollection,this),e.__super__.constructor.apply(this,arguments)}return O(e,t),e.prototype.viewName="LibraryView",e.prototype.tagName="div",e.prototype.className="library-view fade",e.prototype.defaultOrderBy=["name","updated"],e.prototype.order="",e.prototype.orderBy="",e.prototype.events={"click .collection-creator-toggler":"initCollectionCreator","click .collection-title":"enterCollection","click .work-icon[icon-type=folder]":"enterCollection","click .work-title":"openPreivewer","click .work-icon[icon-type=file]":"openPreivewer","click .work-icon[icon-type=image]":"openPreivewer","click .select-all":"togglerSelect","click .breadcrumb-handler":"breadcrumbNav","click .test-handler":"openPicker","click .library-download-handler":"downloadSelected","click .library-copy-handler":"copySelected","click .library-move-handler":"moveSelected","click .library-delete-handler":"deleteSelected","click .move-collection-handler":"moveCollection","click .move-work-handler":"moveWork","click .library-sort":"sortHandler"},e.prototype.routes={":_collectionId(/work/:_workId)":"enterCollection","":"enterCollection","*paramString":"home"},e.prototype.initialize=function(t){if(null!=t?t._projectId:void 0)return this._projectId=t._projectId,this.projectModel=w.getOne(0,this._projectId),this.membersCollection=g.get(t._projectId),this._defaultCollectionId=this.projectModel.get("_defaultCollectionId"),this._rootCollectionId=this.projectModel.get("_rootCollectionId"),I.delay(function(t){return function(){return t.$el.addClass("in")}}(this)),$(window).on("resize",this.reset=function(t){return function(){return t.renderBreadcrumbs()}}(this)),this},e.prototype.home=function(){return this.updateUrl({_collectionId:null,_workId:null},{trigger:!0}),this},e.prototype.listen=function(){return this.listenTo(this.projectModel,"change:currentPanel",this.renderBreadcrumbs)},e.prototype.resetCollections=function(t){return this.collections&&this.stopListening(this.collections),this.collections=t,this.listenTo(t,"add",this.renderCollection),this.listenTo(t,"add remove destroy",this.checkPlaceholder),this.listenTo(t,"add remove destroy change:_selected_",this.checkSelectedAll),this.listenTo(t,"change:_parentId",function(e,i){var n;return t.remove(e),null!=(n=u.find(i))?n.add(e):void 0}),this},e.prototype.resetWorks=function(t){return this.works&&this.stopListening(this.works),this.works=t,this.listenTo(t,"add",this.renderWork),this.listenTo(t,"add remove destroy",this.checkPlaceholder),this.listenTo(t,"add remove destroy change:_selected_",this.checkSelectedAll),this},e.prototype.enterCollection=function(t,e){var i;return i=!t,t||(t=this._rootCollectionId),t.currentTarget&&(t=$(t.currentTarget).closest(".collection").data("id")),this._parentId=t,this.resetView(),this.renderBasic().initUploader(),this.updateUrl({_collectionId:t,_workId:e},{trigger:!1,replace:i}),this.showLoadingIndicator(this.$el),new Promise(function(e){return function(i,n){return u.fetch(t,{attrs:{all:!0,_parentId:t,_projectId:e._projectId},success:function(t){if(e.$el)return t._boundToObjectId===e._parentId&&e.resetCollections(t),i()},error:function(t,e){return n(e)}})}}(this)).then(function(e){return function(){return new Promise(function(i,n){return S.fetch(t,{attrs:{_parentId:t,_projectId:e._projectId},success:function(t){if(e.$el)return t._boundToObjectId===e._parentId&&e.resetWorks(t),i()},error:function(t,e){return n(e)}})})}}(this)).then(function(t){return function(){if(t.renderCollectionsAndWorks(),t.genBreadcrumbs(),t.listen(),t.setupScroll(),e&&"thumbnails"!==e)return t.openPreivewer(e)}}(this))["catch"](function(t){return h.show({message:t.message||t,status:"error"})}).then(function(t){return function(){return t.hideLoadingIndicator({animated:!0}),t.checkPlaceholder(),P.gta.event({action:"open detail",type:"folder",control:"File List"})}}(this)),this},e.prototype.loadMore=function(t){var e;return null!=(e=this.works)&&e.loadMore({silent:!0,attrs:{_parentId:this._parentId,_projectId:this._projectId},beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$list)}}(this),success:function(e){return function(i,n){if(e.$el)return e.hideLoadingIndicator({animated:!0}),I.each(n,function(t){return e.renderWork(e.works.get(t._id),!0)}),e.works.hasMore?"function"==typeof t?t():void 0:e.showEndPoint(e.$list)}}(this)}),this},e.prototype.initUploader=function(){return this.projectModel.hasPermission("work.post")?(this.workUploader=this.requestSubView(C,{dnd:$("#content"),_parentId:this._parentId,isBackground:!0,projectModel:this.projectModel,fileSingleSizeLimit:this.projectModel.getPaymentPlan().fileSizeLimit,pick:{id:this.$(".upload-works-handler"),multiple:!0}}),this.workUploader.uploader.on("dndAccept",function(){return P.gta.event({action:"add content",type:"work",control:"Upload File",method:"drag"})}),this.workUploader.uploader.on("uploadSuccess",function(){return P.gta.event({action:"added content",type:"work",control:"Upload File"})}),this):this},e.prototype.addUploaderBtn=function(t){var e;return this.projectModel.hasPermission("work.post")?(null!=(e=this.workUploader)&&e.uploader.addButton({id:t,multiple:!0}),this):this},e.prototype.initCollectionCreator=function(){var t;return null!=(t=this.collectionCreator)&&t.remove(),this.collectionCreator=this.requestSubView(s,{collection:this.collections,_projectId:this._projectId,_parentId:this._parentId}),this.collectionCreator.$el.prependTo(this.$list),this.collectionCreator.focus(),this},e.prototype.renderBasic=function(){return this.$el.html(n({permissions:this.projectModel.hasPermissions("collection.post","work.post")})),this.$title=this.$(".library-title"),this.$headerHandler=this.$(".library-header-handler"),this.$list=this.$(".library-list"),this.$selectAll=this.$(".select-all"),this.$libraryInfo=this.$(".library-info"),this.$libraryHandlers=this.$(".library-handlers"),this.$placeholder=$(y({permissions:this.projectModel.hasPermissions("work.post")})),this.$placeholderNocreate=$(v({permissions:this.projectModel.hasPermissions("work.post")})),this.$el[this.projectModel.getRoleScope()>=0?"removeClass":"addClass"]("no-right"),this},e.prototype.renderCollectionsAndWorks=function(){var t;return this.$list.empty(),this.renderSort(),t=this.sortCollectionsAndWorks(),I.each(t,function(t){return function(e){return"work"===e.get("objectType")?t.renderWork(e,!0):t.renderCollection(e,!0)}}(this))},e.prototype.getOrder=function(){var t,e;return t=this.order,e=this.getOrderBy(),t||(t="name"===e?"asc":"desc"),t},e.prototype.getOrderBy=function(){var t;return t=this.orderBy,t||(t=this.works.hasMore?this.defaultOrderBy[1]:this.defaultOrderBy[0]),t},e.prototype.getCollectionSortValue=function(t){var e,i,n,r;return i={name:"title",size:"subCount"},n=this.getOrderBy(),e=n in i?i[n]:n,r=t.get(e)||"","updated"!==n&&"created"!==n||(r=r?new Date(r).valueOf():0),"function"==typeof r.toLowerCase&&(r=r.toLowerCase()),r},e.prototype.getWorkSortValue=function(t){var e,i,n,r;return r={name:"fileName",size:"fileSize"},e=this.getOrderBy(),n=e in r?r[e]:e,i=t.get(n)||"","updated"!==e&&"created"!==e||(i=i?new Date(i).valueOf():0),"function"==typeof i.toLowerCase&&(i=i.toLowerCase()),i},e.prototype.sortCollectionsAndWorks=function(){var t,e;return t=[],this.collections.each(function(e){return t.push(e)}),this.works.each(function(e){return t.push(e)}),e=this.getOrder(),t.sort(function(t){return function(i,n){var r,o,s;return o="work"===i.get("objectType")?t.getWorkSortValue(i):t.getCollectionSortValue(i),s="work"===n.get("objectType")?t.getWorkSortValue(n):t.getCollectionSortValue(n),r=o<s?-1:o>s?1:0,"desc"===e&&(r=-1*r),r}}(this)),t},e.prototype.renderCollection=function(t,e){var i;return this._defaultCollectionId!==t.id&&(i=this.requestSubView(p,{membersCollection:this.membersCollection,collectionModel:t}).$el,i[e===!0?"appendTo":"prependTo"](this.$list),t.hasPermission("put.move")&&this.renderDragHandler(i),this.renderDropHandler(i)),this},e.prototype.renderWork=function(t,e){var i;return i=this.requestSubView(x,{membersCollection:this.membersCollection,workModel:t,projectModel:this.projectModel}).$el,i[e===!0?"appendTo":"prependTo"](this.$list),t.hasPermission("put.move")&&this.renderDragHandler(i),this},e.prototype.renderHandlers=function(t){var e,i,n,r,o,s;return null==t&&(t={}),r=this.checkSelectPermission("get.download")&&(t.works||t.collections),s=this.checkSelectPermission("put.version")&&1===t.works&&!t.collections,o=this.checkSelectPermission("put.move")&&(t.works||t.collections),n=this.checkSelectPermission("del")&&(t.works||t.collections),e=this.checkSelectPermission("put.fork")&&t.works&&!t.collections,r||s||o||n||e?(i={download:r,update:s,move:o,del:n,copy:e},this.$libraryInfo.hide(),this.$libraryHandlers.html(m(i)),s&&this.initUploaderHandlers()):(this.$libraryInfo.show(),this.$libraryHandlers.empty()),this},e.prototype.initUploaderHandlers=function(){var t;return t=this.works.find("_selected_"),this.requestSubView(C,{_parentId:t.get("_parentId"),projectModel:this.projectModel,isBackground:!0,pick:{id:this.$(".library-update-handler"),multiple:!1},onComplete:function(e,i){return e.version=!0,delete e._id,e.thumbnailUrl||(e.thumbnailUrl=null),e.thumbnail=e.thumbnailUrl,e.previewUrl||(e.previewUrl=null),t.createVersion(e,{wait:!0}),i.set({isUpdateVersion:!0,completed:!0})}}),this},e.prototype.renderSort=function(){var t,e,i;return e=this.getOrder(),i=this.getOrderBy(),this.$el.find(".library-info .dropup").removeClass("dropup"),this.$el.find(".library-info .caret").remove(),t=this.$el.find(".library-info [data-orderby='"+i+"']"),t.append("<span class='caret'></span>"),"asc"===e&&t.addClass("dropup"),this},e.prototype.genBreadcrumbs=function(){var t;return this.breadcrumbs=[],t=function(e){return function(i){var n;return i===e._rootCollectionId?(n={_id:e.breadcrumbs.length?e._rootCollectionId:null,title:tb_i18n.get("library.title")},e.breadcrumbs.unshift(n),e.renderBreadcrumbs()):i?c.fetch(i,{success:function(i){var r;return r=i.toJSON(),n={_id:r._id!==e._parentId?r._id:null,title:r.title},"default"===r.collectionType&&e.$headerHandler.remove(),e.breadcrumbs.unshift(n),t(r._parentId||e._rootCollectionId)}}):void 0}}(this),t(this._parentId),this},e.prototype.renderBreadcrumbs=function(){var t,e;if(!(this.breadcrumbs.length<2))return t=$(o({breadcrumbs:this.breadcrumbs})).appendTo(this.$el),t.width()<this.$title.width()?this.$title.html(t.css("visibility","visible")):(e=this.breadcrumbs.slice(0).reverse(),this.$title.html(r({title:e[0].title,breadcrumbs:e.slice(1)}))),this},e.prototype.renderDragHandler=function(t){var e;return e=!1,t.draggable({scope:"library-move",zIndex:1e4,appendTo:this.$el,addClasses:!1,scroll:!1,cursorAt:{top:-10,left:-10},helper:function(i){return function(n){var r,o,s,a,c;return t.hasClass("selected")||(e=!0,i.triggerSelectOne(t)),r=(null!=(o=i.collections)?o.getSelected():void 0)||[],c=(null!=(s=i.works)?s.getSelected():void 0)||[],null!=(a=i.$drag)&&a.remove(),i.$drag=$(d({counts:c.length+r.length,collection:r[0]?r[0].toJSON():void 0,work:c[0]?c[0].toJSON():void 0})),i.renderHandlers(),i.$drag}}(this),start:function(t){return $("body").css("cursor","not-allowed")},stop:function(i){return function(n){return $("body").css("cursor","default"),i.$drag.remove(),e&&i.triggerSelectOne(t),i.checkSelectedAll()}}(this)}),this},e.prototype.renderDropHandler=function(t){return t.droppable({scope:"library-move",hoverClass:"dragover",tolerance:"pointer",drop:function(e){return function(){var i,n,r,o,s;return o=e.collections.get(t.data("id")),!!e.checkSelectPermission("put.move")&&(i=(null!=(n=e.collections)?n.getSelected():void 0)||[],s=(null!=(r=e.works)?r.getSelected():void 0)||[],e.selectAll(!1),o?e.moveToCollection(o,i,s):void 0)}}(this)}),this},e.prototype.checkPlaceholder=function(){var t,e,i,n,r;return(null!=(e=this.collections)?e.length:void 0)>1||(null!=(i=this.works)?i.length:void 0)?this.$(".library-placeholder").remove():1===(null!=(n=this.collections)?n.length:void 0)&&this.collections.at(0).id===this._defaultCollectionId?(this.$list.html(this.$placeholderNocreate),this.addUploaderBtn(this.$(".library-placeholder .upload-handler"))):0===(null!=(r=this.collections)?r.length:void 0)?(this.$list.html(this.$placeholder),t=this.$(".library-placeholder .upload-handler"),this._parentId!==this._defaultCollectionId?this.addUploaderBtn(t):t.addClass("disabled")):this.$(".library-placeholder").remove(),this},e.prototype.togglerSelect=function(){return this.$selectAll.toggleClass("selected"),this.selectAll(this.$selectAll.hasClass("selected")),this},e.prototype.triggerSelectOne=function(t){return t.find(".check-box").trigger("click"),this.checkSelectedAll(),this},e.prototype.selectAll=function(t){var e,i;return this.selecting=!0,null!=(e=this.works)&&e.each(function(e){return e.set({_selected_:t})}),null!=(i=this.collections)&&i.each(function(e){return function(i){if(!(e._defaultCollectionId===i.id||i.getRoleScope()<1))return i.set({_selected_:t})}}(this)),this.selecting=!1,this.checkSelectedAll(),this},e.prototype.checkSelectedAll=function(){var t,e,i,n,r,o;if(!this.selecting)return n=!0,i=0,o=0,null!=(t=this.works)&&t.each(function(t){return t.get("_selected_")&&(i+=1,o+=1),n&&(n=t.get("_selected_"))}),r=0,null!=(e=this.collections)&&e.each(function(t){return t.get("_selected_")&&(r+=1,i+=1),n&&(n="default"===t.get("collectionType")||t.getRoleScope()<1||t.get("_selected_"))}),this.$selectAll[i&&n?"addClass":"removeClass"]("selected"),this.$selectAll[i&&!n?"addClass":"removeClass"]("indeterminate"),this.renderHandlers({works:o,collections:r}),this},e.prototype.openPreivewer=function(t){var e;return P.gta.event({
action:"open detail",type:"file",control:"File List",method:"preview"}),t.currentTarget&&(t=$(t.currentTarget).closest(".work").data("id")),e=this.works.get(t),e.getParent(function(t){return function(i){if(i)return t.requestSubView(M).open(b,{_projectId:t._projectId,collectionModel:i,workModels:I.filter(t.sortCollectionsAndWorks(),function(t){return"work"===t.get("objectType")}),workModel:e,isUpdateUrl:!0})}}(this)),this},e.prototype.breadcrumbNav=function(t){return this.enterCollection($(t.currentTarget).data("id")),P.gta.event({action:"open detail",type:"folder",control:"File Path"}),this},e.prototype.moveCollection=function(t){var e,i,n,r;if(null!=(n=this.picker)&&n.remove(),e=$(t.currentTarget).closest(".collection"),i=this.collections.get(e.data("id")),this._defaultCollectionId!==i.id)return r=i.get("title"),this.picker=this.requestSubView(M).open(l,{_projectId:this._projectId,_parentId:i.get("_parentId"),onlyCollections:!0,exclude:[i.id],isForkOrMove:"move",title:tb_i18n.get("collection.move.message",r),select:function(t){return function(e){var n,r,o;if(o=(null!=e?e.id:void 0)||t._rootCollectionId,o!==i.get("_parentId")&&o!==i.id)return n=u.get(o),r=e.get("title"),i.moveToCollection(n,{success:function(){var t;return t=i.get("title"),h.show({message:tb_i18n.get("library.success.moveTo",t,r),status:"success"})}})}}(this)}),this},e.prototype.moveWork=function(t){var e,i,n,r;if(null!=(n=this.picker)&&n.remove(),e=$(t.currentTarget).closest(".work"),r=this.works.get(e.data("id")))return i=r.get("fileName"),this.picker=this.requestSubView(M).open(l,{_projectId:this._projectId,_parentId:r.get("_parentId"),onlyCollections:!0,allProjects:!0,isForkOrMove:"move",title:tb_i18n.get("work.move.message",i),select:function(t){var e;if(t.id!==r.get("_parentId"))return e=S.get(t.id),r.moveToCollection(e,{success:function(){return h.success(tb_i18n.get("work.move.success"))}})}}),this},e.prototype.forkToCollection=function(t,e,i){var n,r,o;return r=(null!=t?t.id:void 0)||this._rootCollectionId,n=u.get(r),o=S.get(r),Promise.resolve().then(function(t){return function(){return Promise.all(I.map(e,function(e){return new Promise(function(i,o){return r===e.get("_parentId")||r===e.id||t._defaultCollectionId===e.id?i():e.forkToCollection(n,{success:i,error:function(t,e){return o(e)}})})}))}}(this)).then(function(){return Promise.all(I.map(i,function(t){return new Promise(function(e,i){return r===t.get("_parentId")?e():t.forkToCollection(o,{success:e,error:function(t,e){return i(e)}})})}))}).then(function(){var n,r;return r=t.parse(t.toJSON()).title,i=i.length,e=e.length,n="",i>0&&(n+=tb_i18n.get("library.works.count",i)),i>0&&e>0&&(n+=tb_i18n.get("library.and")),e>0&&(n+=tb_i18n.get("library.collections.count",e)),h.show({message:tb_i18n.get("library.success.forkTo",n,r),status:"success"})})["catch"](function(t){return h.show({message:t.message||t,status:"error"})}),this},e.prototype.moveToCollection=function(t,e,i){var n,r,o;return r=(null!=t?t.id:void 0)||this._rootCollectionId,n=u.get(r),o=S.get(r),Promise.resolve().then(function(t){return function(){return Promise.all(I.map(e,function(e){return new Promise(function(i,o){return r===e.get("_parentId")||r===e.id||t._defaultCollectionId===e.id?i():e.moveToCollection(n,{success:i,error:function(t,e){return o(e)}})})}))}}(this)).then(function(){return Promise.all(I.map(i,function(t){return new Promise(function(e,i){return r===t.get("_parentId")?e():t.moveToCollection(o,{success:e,error:function(t,e){return i(e)}})})}))}).then(function(){var n,r;return r=t.parse(t.toJSON()).title,i=i.length,e=e.length,n="",i>0&&(n+=tb_i18n.get("library.works.count",i)),i>0&&e>0&&(n+=tb_i18n.get("library.and")),e>0&&(n+=tb_i18n.get("library.collections.count",e)),h.show({message:tb_i18n.get("library.success.moveTo",n,r),status:"success"})})["catch"](function(t){return h.show({message:t.message||t,status:"error"})}),this},e.prototype.copySelected=function(){return this.copyOrMoveSelected("fork")},e.prototype.moveSelected=function(){return this.copyOrMoveSelected("move")},e.prototype.copyOrMoveSelected=function(t){var e,i,n,r,o,s,a,c,p;if("fork"!==t||null==(r=this.collections)||!r.getSelected().length)return null!=(o=this.picker)&&o.remove(),p=(null!=(s=this.works)?s.getSelected():void 0)||[],i=(null!=(a=this.collections)?a.getSelected():void 0)||[],e=!("move"===t&&i.length),n=this.genMessage(p.length,i.length),c=function(){switch(t){case"fork":return tb_i18n.get("library.fork.to",n);case"move":return tb_i18n.get("library.move.to",n)}}(),this.picker=this.requestSubView(M).open(l,{_projectId:this._projectId,_parentId:this._parentId,onlyCollections:!0,exclude:I.pluck(i,"id"),allProjects:e,isForkOrMove:t,title:c,select:function(e){return function(n){switch(e.selectAll(!1),t){case"fork":return e.forkToCollection(n,i,p);case"move":return e.moveToCollection(n,i,p)}}}(this)})},e.prototype.deleteSelected=function(){var t,e,i,n,r,o;return o=(null!=(i=this.works)?i.getSelected():void 0)||[],t=(null!=(n=this.collections)?n.getSelected():void 0)||[],e=this.genMessage(o.length,t.length),null!=(r=this.collectionDestroyerView)&&r.remove(),this.collectionDestroyerView=this.requestSubView(M,{backdrop:"static"}).open(a,{works:o,collections:t,message:e,success:function(t){return function(){return t.selectAll(!1)}}(this)}),this},e.prototype.downloadSelected=function(){var t,e,i,n;return n=(null!=(e=this.works)?e.getSelected():void 0)||[],t=(null!=(i=this.collections)?i.getSelected():void 0)||[],n.length||t.length?n.length>1||t.length?this.dowloadCollectionsOrWorks(t,n):n.length?$.fileDownload(n[0].get("downloadUrl"),""):void 0:this},e.prototype.dowloadCollectionsOrWorks=function(t,e){var i,n,r;return null==t&&(t=[]),null==e&&(e=[]),r=this.genZipName(t,e),i=j.getStrikerDownloadConfig(),n={httpMethod:"POST"},t.length?j.getFilesDownloadInfo(this._projectId,r,{collectionIds:I.pluck(t,"id"),workIds:I.pluck(e,"id")}).then(function(t){return n.data=t,$.fileDownload(i,n)})["catch"](function(t){}):(n.data={zipName:r,downloadUrls:e.map(function(t){return t.get("downloadUrl")})},$.fileDownload(i,n))},e.prototype.genZipName=function(t,e){var i,n,r,o,s,a,c,l;return null==t&&(t=[]),null==e&&(e=[]),n=null!=(o=t[0])?o.get("title"):void 0,c=null!=(s=e[0])?s.get("fileName").split(".")[0]:void 0,r=t.length+e.length,n&&c?(i=new Date(t[0].get("updated")),a=new Date(e[0].get("updated")),l=a>i?c:n):l=n||c,r>1&&(l=tb_i18n.get("library.files.zipname",l,r)),l},e.prototype.genMessage=function(t,e){var i;return i="",t&&(i+=tb_i18n.get("library.works.count",t)),t&&e&&(i+=tb_i18n.get("library.and")),e&&(i+=tb_i18n.get("library.collections.count",e)),i},e.prototype.updateUrl=function(t,e){var i;return i=P.router.getPrefix()+"/works",t._collectionId&&(i+="/"+t._collectionId,t._workId&&(i+="/work/"+t._workId)),P.router.navigate(i,e),this},e.prototype.sortHandler=function(t){var e,i,n,r,o;return t.currentTarget?(e=$(t.currentTarget),o=e.data("orderby")):o=t,n=this.getOrder(),r=this.getOrderBy(),r===o?this.order="asc"===n?"desc":"asc":(i=["name"],this.order=E.call(i,o)>=0?"asc":"desc"),this.orderBy=o,this.renderCollectionsAndWorks(),P.gta.event({action:"change view order",type:this.orderBy})},e.prototype.checkSelectPermission=function(t){return this.works.filter(function(t){return t.get("_selected_")}).every(function(e){return e.hasPermission(t)})&&this.collections.filter(function(t){return t.get("_selected_")}).every(function(e){return e.hasPermission(t)})},e.prototype.remove=function(){return $(window).off("resize",this.reset),e.__super__.remove.apply(this,arguments)},e}(T),I.extend(f.prototype,_),t.exports=f},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;l=i(678),n=i(1564),r=i(928),a=i(677),c=i(788),s=i(401),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="CollectionCreatorView",e.prototype.tagName="li",e.prototype.className="collection-view collection-creator-view collection clearfix",e.prototype.events={"keydown .collection-title input":"quickSubmit","click .submit-edit-handler":"submit","click .cancel-edit-handler":"cancel","click *":"stopPropagation"},e.prototype.initialize=function(t){return this.options=t,this.render(),this},e.prototype.render=function(){return this.$el.html(n()),this.$input=this.$(".collection-title input"),this.$createBtn=this.$(".collection-title .submit-edit-handler"),this.$(".collection-edit").handleClickOutside(function(t){return function(){var e;if(!(null!=(e=t.$input)?e.val().trim():void 0))return t.cancel()}}(this)),this},e.prototype.quickSubmit=function(t){return 13===t.keyCode&&(t.preventDefault(),this.submit(t)),this},e.prototype.submit=function(t){var e,i;return i=this.$input.val().trim(),e=this.options.collection,i?e.find(function(t){return t.get("title")===i})?s.show({message:tb_i18n.get("collection.creator.duplication.title"),status:"error"}):e.create({title:i,_projectId:this.options._projectId,_parentId:this.options._parentId},{wait:!0,success:function(t){return function(){var e;return s.show({message:tb_i18n.get("collection.creator.create.success"),status:"success"}),l.gta.event({action:"added content",type:"folder",control:"File List"}),null!=(e=t.parentView)&&e.checkSelectedAll(),t.remove()}}(this)}):this.$input.focusAtEnd(),this},e.prototype.cancel=function(t){var e;return null!=(e=this.parentView)&&e.checkSelectedAll(),this.remove(),this},e.prototype.focus=function(){return this.$input.focusAtEnd(),this},e.prototype.stopPropagation=function(t){return t.stopPropagation(),this},e}(c)},function(t,e,i){t.exports=function(t){var e="",n=i(932).folderIconT;return e+='<div class="check-box pull-left disabled"> <span class="icon icon-tick"></span></div><div class="content-wrap collection-edit clearfix"> <div class="collection-content pull-left"> '+n({})+' <div class="collection-title"> <input type="text" placeholder="'+tb_i18n.get("collection.creator.collection.title")+'" class="form-control pull-left"> <button class="btn btn-primary btn-small submit-edit-handler pull-left">'+tb_i18n.get("create")+'</button> <button class="btn btn-link btn-small cancel-edit-handler pull-left">'+tb_i18n.get("cancel")+"</button> </div> </div></div>"}},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=i(358),r=i(1566),s=i(788),o=i(401),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.viewName="CollectionDestroyerView",e.prototype.className="collection-destroyer modal-dialog modal-padding card",e.prototype.events={"click .confirm-destroy-handler":"onConfirm","click .cancel-destroy-handler":"onCancel"},e.prototype.initialize=function(t){if(t.works.length||t.collections.length)return this.options=t,this.works=t.works,this.collections=t.collections,this.render(),this},e.prototype.render=function(){var t;return t=this.options.message,this.$el.html(r({title:tb_i18n.get("collection.destroyer.title"),message:tb_i18n.get("collection.destroyer.confirm.delete",t)})),this},e.prototype.onConfirm=function(){return this.$(".confirm-destroy-handler").text(tb_i18n.get("collection.destroyer.deleting")+"..."),this.$(".cancel-destroy-handler").hide(),Promise.resolve().then(function(t){return function(){return Promise.all(a.map(t.collections,function(t){return new Promise(function(e,i){return t.destroy({success:e,error:function(t,e){return i(e)}})})}))}}(this)).then(function(t){return function(){return Promise.all(a.map(t.works,function(t){return new Promise(function(e,i){return t.destroy({success:e,error:function(t,e){return i(e)}})})}))}}(this)).then(function(t){return function(){var e;return o.show({message:tb_i18n.get("collection.destroyer.delete.success"),status:"success"}),"function"==typeof(e=t.options).success&&e.success(),t.close()}}(this))["catch"](function(t){return function(e){return t.$(".confirm-destroy-handler").text(tb_i18n.get("collection.destroyer.delete.fail")),t.$(".cancel-destroy-handler").show(),o.show({message:e.message||e,status:"error"})}}(this)),this},e.prototype.onCancel=function(){return this.close(),this},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.remove(),this},e}(s)},function(t,e){t.exports=function(t){var e='<div class="modal-content"> <header class="modal-header"> <h4 class="modal-title">'+t.title+'</h4> </header> <div class="modal-body"> '+t.message+' </div> <div class="modal-footer"> <button class="confirm-destroy-handler btn btn-primary pull-right">'+tb_i18n.get("delete")+'</button> <button class="cancel-destroy-handler btn btn-link pull-right">'+tb_i18n.get("cancel")+"</button> </div></div>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f=function(t,e){return function(){return t.apply(e,arguments)}},g=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},v={}.hasOwnProperty;u=i(358),m=i(678),h=i(679),d=i(963),c=i(429),l=i(677),p=i(788),s=i(401),n=i(1568),o=i(1571),a=i(1572),t.exports=r=function(t){function e(){return this.stopPropagation=f(this.stopPropagation,this),this.editCancel=f(this.editCancel,this),this.editSubmit=f(this.editSubmit,this),e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.viewName="CollectionView",e.prototype.tagName="li",e.prototype.className="collection-view collection clearfix",e.prototype.events={click:"checkCollection","click .collection-menu-toggler":"toggleMenu","click .edit-collection-handler":"renderEditForm","keydown .collection-title input":"quickEditSubmit","click .submit-edit-handler":"editSubmit","click .cancel-edit-handler":"editCancel","click .download-collection-handler":"downloadCollection","click .collection-edit *":"stopPropagation"},e.prototype.initialize=function(t){if((null!=t?t.collectionModel:void 0)&&t.membersCollection)return this.options=t,this.collectionModel=t.collectionModel,this.isEdit=!1,this.membersCollection=t.membersCollection,this.hasBatchPermission=this.collectionModel.hasPermission("put.move")||this.collectionModel.hasPermission("del")||this.collectionModel.hasPermission("work.get.download"),this.collectionModel.set({_selected_:!1},{silent:!0}),this.renderBasic().listen(),this.$el.attr("data-id",t.collectionModel.id).addClass(t.viewType),this},e.prototype.listen=function(){var t;return t="change:workCount change:collectionCount change:title change:_selected_",this.listenTo(this.collectionModel,t,this.renderBasic),this.listenTo(this.collectionModel,"change:color",this.refreshColor),this.listenTo(this.collectionModel,"remove destroy",this.remove),this},e.prototype.renderBasic=function(){var t;if(!this.isEdit)return t=this.getData(),this.$el.html(a(t)),this.$thumbnail=this.$(".collection-thumbnail"),this.$title=this.$(".collection-title"),this.count=this.$(".collection-count"),this.author=this.$(".collection-author"),this.updated=this.$(".collection-updated"),this.$el[t._selected_?"addClass":"removeClass"]("selected"),this},e.prototype.renderEditForm=function(t){var e;return null!=t&&t.stopPropagation(),this.isEdit=!0,e=this.getData(),this.$el.html(o(e)),this.$editInput=this.$(".collection-title input"),this.$editInput.focusAtEnd(),this.$(".collection-edit").handleClickOutside(function(t){return function(){var e;if((null!=(e=t.$editInput)?e.val().trim():void 0)===t.collectionModel.get("title"))return t.quitEdit()}}(this)),m.gta.event({action:"edit title",control:"File List",type:"folder"}),this},e.prototype.refreshColor=function(){var t,e;return e=this.getData(),t=this.$(".collection-content").find(".svg-icon"),t.css("fill",d.calculateColor(e.color,e.colorRGBA)),this.$(".collection-updated").data("title",e.updated).text(e.updatedDataString.dateString),this},e.prototype.getData=function(){var t,e;return t=this.collectionModel.toJSON(),t.subCount=t.workCount+(t.collectionCount||0),t.creator=(null!=(e=this.membersCollection.get(t._creatorId))?e.toJSON():void 0)||{},t.updatedDataString=l.formatDate(t.updated),t.updated=c(t.updated).format("YYYY-MM-DD HH:mm"),t.permissions=this.collectionModel.hasPermissions("put","put.move","put.archive","del","work.get.download"),t.hasBatchPermission=this.hasBatchPermission,t},e.prototype.checkCollection=function(t){var e;if(e=[".work-icon[icon-type=folder]",".collection-title",".collection-handler-set"],"default"!==this.collectionModel.get("collectionType")&&this.hasBatchPermission&&!$(t.target).closest(e.join(", ")).length)return this.collectionModel.set("_selected_",!this.collectionModel.get("_selected_")),this},e.prototype.toggleMenu=function(t){var e;return e=$(t.currentTarget),e.data("bs.popover")||this.requestSubView(n,{$toggler:e,collectionModel:this.collectionModel,onShown:function(t){return function(){return t.$el.addClass("active")}}(this),onHidden:function(t){return function(){return t.$el.removeClass("active")}}(this)}).show(),this},e.prototype.quickEditSubmit=function(t){return 13===t.keyCode&&(t.preventDefault(),this.editSubmit(t)),this},e.prototype.editSubmit=function(t){var e,i,n;return null!=t&&t.stopPropagation(),n=this.$editInput.val().trim(),e={},n&&this.collectionModel.get("title")!==n&&(e.title=n),u.isEmpty(e)?n?this.quitEdit():this.$editInput.focusAtEnd():(i=this.collectionModel.collection.find(function(t){return function(e){return e.get("title")===n&&t.collectionModel.get("_id")!==e.get("_id")}}(this)),i?s.show({message:tb_i18n.get("collection.edit.duplication.title"),status:"error"}):(this.quitEdit(),this.collectionModel.save(null,{attrs:e}))),this},e.prototype.editCancel=function(t){var e;return null!=t&&t.stopPropagation(),null!=(e=this.parentView)&&e.checkSelectedAll(),this.quitEdit(),this},e.prototype.downloadCollection=function(){var t,e;return t=this.collectionModel.get("_projectId"),e=this.collectionModel.get("title"),l.getFilesDownloadInfo(t,e,{collectionIds:[this.collectionModel.id]}).then(function(t){var e,i;return e=l.getStrikerDownloadConfig(),i={httpMethod:"POST",data:t},$.fileDownload(e,i)})["catch"](function(t){})},e.prototype.quitEdit=function(){return this.isEdit=!1,this.renderBasic(),this.$el.removeClass("active"),this},e.prototype.stopPropagation=function(t){return t.stopPropagation(),this},e}(p)},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;n=i(1569),o=i(1570),a=i(813),c=i(963),s=i(401),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="CollectionMenuView",e.prototype.popoverTitle="",e.prototype.events={"click .color":"changeColor","click .archive-collection-handler":"archiveCollection","click .delete-collection-handler":"enterDeleteSubMenu","submit .collection-delete-form":"submitDeleteForm"},e.prototype.initialize=function(){return this.popoverTitle=tb_i18n.get("collection.menu.title"),e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){var t;return this.collectionModel=this.options.collectionModel,t=this.collectionModel.toJSON(),t.color=c.calculateColor(t.color,t.colorRGBA),t.permissions=this.collectionModel.hasPermissions("put","put.archive","del"),this.$el.html(n(t)),this},e.prototype.changeColor=function(t){var e,i;return e=$(t.currentTarget),this.$(".active").removeClass("active"),i=e.data("color"),e.addClass("active"),this.collectionModel.save(null,{attrs:{color:c.transformToServerColor(i)}}),this},e.prototype.archiveCollection=function(){return this.collectionModel.archive({success:function(t){return function(){return s.show({message:tb_i18n.get("archived.folder.success"),status:"success"}),t.hide()}}(this)}),this},e.prototype.enterDeleteSubMenu=function(){return this.enterSubMenu(tb_i18n.get("collection.menu.delete.title"),function(t){return function(){return t.$el.html(o())}}(this)),this},e.prototype.submitDeleteForm=function(t){return t.preventDefault(),this.collectionModel.destroy({success:function(t){return function(){return s.show({message:tb_i18n.get("delete.success"),status:"success"}),t.hide()}}(this)}),this},e}(a)},function(t,e,i){t.exports=function(t){var e="",n=i(963).COLORS;if(e+='<ul class="list collection-menu-list"> ',"default"!=t.collectionType&&(e+=" ",t.permissions.putArchive&&(e+=' <li> <a class="archive-collection-handler" data-gta="event" data-label="archive collection"> <span class="icon icon-archive"></span>'+tb_i18n.get("archive.folder")+" </a> </li> "),e+=" ",t.permissions.del&&(e+=' <li> <a class="delete-collection-handler" data-gta="event" data-label="delete collection"> <span class="icon icon-trash"></span>'+tb_i18n.get("collection.menu.delete.title")+" </a> </li> "),e+=" "),e+=" ",t.permissions.put){e+=' <li class="list-divider"></li> <li class="color-choise"> <ul class="clearfix"> ';var r=n;if(r)for(var o,s=-1,a=r.length-1;s<a;)o=r[s+=1],e+=' <li class="color ',t.color==o&&(e+="active"),e+='" data-color="'+o+'" style="background-color: '+o+'"> <span class="icon icon-tick icon-white"></span> </li> ';e+=" </ul> </li> "}return e+="</ul>"}},function(t,e){t.exports=function(t){var e='<form class="collection-delete-form"> <p>'+tb_i18n.get("collection.menu.confirm.delete")+'?</p> <button class="btn btn-danger" type="submit">'+tb_i18n.get("delete")+"</button></form>";return e}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(932).folderIconT;return n+='<div class="check-box pull-left disabled"> <span class="icon icon-tick"></span></div><div class="content-wrap collection-edit clearfix"> <div class="collection-content pull-left"> '+r(t)+' <span class="collection-title"> <input type="text" placeholder="'+tb_i18n.get("collection.creator.collection.title")+'" class="form-control pull-left" value="'+t.title+'" /> <button class="btn btn-primary btn-small submit-edit-handler pull-left">'+tb_i18n.get("save")+'</button> <button class="btn btn-link btn-small cancel-edit-handler pull-left">'+tb_i18n.get("cancel")+'</button> </span> </div> <div class="collection-info pull-right row-flex"> <div class="collection-count">'+t.subCount+'</div> <div class="collection-author">'+e(t.creator.name||tb_i18n.get("unknown"))+'</div> <div class="collection-updated"> <time class="hinted" data-title="'+t.updated+'">'+t.updatedDataString.dateString+"</time> </div> </div></div>"}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(932).folderIconT;return"default"!=t.collectionType?(n+='<div class="check-box pull-left ',t.hasBatchPermission||(n+="disabled"),n+='" data-gta="event" data-label="select file or directory"> <span class="icon icon-tick"></span></div>'):n+='<div class="default-lock pull-left"> <span class="icon icon-lock"></span></div>',n+='<div class="content-wrap clearfix"> <div class="collection-content pull-left"> '+r(t)+" ",n+="default"!=t.collectionType?' <span class="collection-title">'+e(t.title)+"</span> ":' <span class="collection-title">'+tb_i18n.get("library.default.collection")+"</span> ",n+=' </div> <div class="collection-info pull-right row-flex"> <div class="collection-count">-</div> <div class="collection-author">'+e(t.creator.name||tb_i18n.get("unknown"))+'</div> <div class="collection-updated"> <time class="hinted" data-title="'+t.updated+'">'+t.updatedDataString.dateString+'</time> </div> <div class="collection-handler-set clearfix"> ',"default"!=t.collectionType&&(n+=" ",(t.permissions.put||t.permissions.putArchive||t.permissions.del)&&(n+=' <a class="collection-menu-toggler icon icon-chevron-down hinted" data-title="'+tb_i18n.get("more.operations")+'"></a> '),n+=" ",t.permissions.put&&(n+=' <a class="edit-collection-handler icon icon-pencil hinted" data-title="'+tb_i18n.get("collection.rename.title")+'"></a> '),n+=" ",t.permissions.putMove&&(n+=' <a class="move-collection-handler icon icon-file-move2 hinted" data-title="'+tb_i18n.get("collection.move.title")+"\" data-gta=\"{action: 'move content', type: 'file', control: 'File List'}\"></a> "),n+=" ",t.permissions.workGetDownload&&(n+=' <a class="download-collection-handler icon icon-circle-arrow-down-o hinted" data-title="'+tb_i18n.get("collection.download.title")+'" data-gta="event" data-label="download collection"></a> '),n+=" "),n+=" </div> </div></div>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h=function(t,e){return function(){return t.apply(e,arguments)}},m=function(t,e){function i(){this.constructor=t}for(var n in e)f.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},f={}.hasOwnProperty;u=i(358),d=i(678),o=i(429),s=i(677),a=i(788),c=i(1574),l=i(924),n=i(1577),r=i(1578),t.exports=p=function(t){function e(){return this.stopPropagation=h(this.stopPropagation,this),this.editCancel=h(this.editCancel,this),this.editSubmit=h(this.editSubmit,this),e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.viewName="WorkView",e.prototype.tagName="li",e.prototype.className="work-view work clearfix",e.prototype.events={click:"checkCollection","click .work-menu-toggler":"toggerMenu","click .edit-work-handler":"renderEditForm","keydown .work-title input":"quickEditSubmit","click .submit-edit-handler":"editSubmit","click .cancel-edit-handler":"editCancel","click .work-edit *":"stopPropagation","click .work-download-handler":"downloadWork","click .work-open-handler":"openWork"},e.prototype.initialize=function(t){if((null!=t?t.workModel:void 0)&&t.membersCollection)return this.options=t,this.workModel=t.workModel,this.projectModel=t.projectModel,this.membersCollection=t.membersCollection,this.workModel.set({_selected_:!1},{silent:!0}),this.renderBasic().listen(),this.$el.attr("data-id",t.workModel.id).addClass(t.viewType),this},e.prototype.listen=function(){return this.listenTo(this.workModel,"change",this.renderBasic),this.listenTo(this.workModel,"remove destroy",this.remove),null!=window.WebExtensionWin10&&this.listenTo(window.clientEvents,"fileDownloaded:"+this.workModel.get("fileKey"),this.renderBasic),this},e.prototype.renderBasic=function(){var t;return t=this.getData(),this.$el.html(r(t)),this.initUploader(),this.$el[t._selected_?"addClass":"removeClass"]("selected"),this},e.prototype.getData=function(){var t,e,i,n;return t=this.workModel.getFormatData(),t.creator=(null!=(i=this.membersCollection.get(t._creatorId))?i.toJSON():void 0)||{},e=t.updated,o(e).isSame("2014-02-11T06:30:00.000Z","day")&&(e=t.created),t.updatedDataString=s.formatDate(e),t.updated=o(e).format("YYYY-MM-DD HH:mm"),t.permissions=this.workModel.hasPermissions("get.download","put","put.move","put.archive","put.version","del"),t.isFileLocalExist="undefined"!=typeof window&&null!==window&&null!=(n=window.WebExtensionWin10)&&"function"==typeof n.fileIsExist?n.fileIsExist(t.fileKey):void 0,t},e.prototype.renderEditForm=function(t){var e;return null!=t&&t.stopPropagation(),this.isEdit=!0,e=this.getData(),this.$el.html(n(e)),this.$editInput=this.$(".work-title input"),this.$editInput.focusAtEnd(),this.$(".work-edit").handleClickOutside(function(t){return function(){var e;if((null!=(e=t.$editInput)?e.val().trim():void 0)===t.workModel.get("fileName"))return t.quitEdit()}}(this)),d.gta.event({action:"edit title",control:"File List",type:"work"}),this},e.prototype.quickEditSubmit=function(t){return 13===t.keyCode&&(t.preventDefault(),this.editSubmit(t)),this},e.prototype.editSubmit=function(t){var e,i;return null!=t&&t.stopPropagation(),i=this.$(".work-title input").val().trim(),e={},i&&this.workModel.get("fileName")!==i&&(e.fileName=i),u.isEmpty(e)?i?this.quitEdit():this.$editInput.focusAtEnd():(this.quitEdit(),this.workModel.save(null,{attrs:e})),this},e.prototype.editCancel=function(t){var e;return null!=t&&t.stopPropagation(),null!=(e=this.parentView)&&e.checkSelectedAll(),this.quitEdit(),this},e.prototype.quitEdit=function(){return this.isEdit=!1,this.renderBasic(),this.$el.removeClass("active"),this},e.prototype.checkCollection=function(t){var e;if(e=[".work-icon[icon-type=file]",".work-icon[icon-type=image]",".work-title",".work-handler-set"],!$(t.target).closest(e.join(", ")).length)return this.workModel.set("_selected_",!this.workModel.get("_selected_")),this},e.prototype.toggerMenu=function(t){var e;return e=$(t.currentTarget),e.data("bs.popover")||this.requestSubView(c,{$toggler:e,workModel:this.workModel,onShown:function(t){return function(){return t.$el.addClass("active")}}(this),onHidden:function(t){return function(){return t.$el.removeClass("active")}}(this)}).show(),this},e.prototype.stopPropagation=function(t){return t.stopPropagation(),this},e.prototype.downloadWork=function(){var t,e;return t=this.workModel.toJSON(),e=t.downloadUrl,null!=window.WebExtensionWin10&&(e+="&filekey="+t.fileKey+"&workid="+t._id),$.fileDownload(e),this},e.prototype.openWork=function(){var t;return null!=(t=window.WebExtensionWin10)&&"function"==typeof t.openFile&&t.openFile(this.workModel.get("fileKey")),this},e.prototype.initUploader=function(){var t;return t=this.workModel,this.requestSubView(l,{_parentId:t.get("_parentId"),projectModel:this.projectModel,isBackground:!0,pick:{id:this.$(".work-update-handler"),multiple:!1},onComplete:function(e,i){return e.version=!0,delete e._id,e.thumbnailUrl||(e.thumbnailUrl=null),e.thumbnail=e.thumbnailUrl,e.previewUrl||(e.previewUrl=null),t.createVersion(e,{wait:!0}),i.set({isUpdateVersion:!0,completed:!0})}}),this},e}(a)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;u=i(678),n=i(1575),o=i(1576),a=i(813),s=i(401),c=i(786),r=i(927),p=i(810),t.exports=l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.viewName="WorkMenuView",e.prototype.popoverTitle="",e.prototype.events={"click .copy-work-handler":"forkWork","click .archive-work-handler":"archiveWork","click .delete-work-handler":"enterDeleteSubMenu","click .favorite-work-handler":"favoriteWork","submit .work-delete-form":"submitDeleteForm","click .switch-visible-handler":"switchVisible"},e.prototype.initialize=function(t){return this._projectId=t.workModel.get("_projectId"),this.popoverTitle=tb_i18n.get("work.menu.title"),this.workModel=t.workModel,e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){var t;return t=this.workModel.getFormatData(),t.permissions=this.workModel.hasPermissions("put.fork","put.archive","del","put.visible"),this.$el.html(n(t)),this.triggerHook("render"),this},e.prototype.forkWork=function(){var t,e;return!this.workModel.get("isArchived")&&(this.hide(),t=this.workModel.get("fileName"),e=tb_i18n.get("work.copy.message",t),this.picker=this.requestSubView(c).open(r,{_projectId:this.workModel.get("_projectId"),_parentId:this.workModel.get("_parentId"),onlyCollections:!0,allProjects:!0,isForkOrMove:"fork",title:e,select:function(t){return function(e){var i;if(e.id!==t.workModel.get("_parentId"))return i=p.get(e.id),t.workModel.forkToCollection(i,{success:function(){return s.success({message:tb_i18n.get("work.copy.success")})}})}}(this)}),this)},e.prototype.archiveWork=function(){
return this.workModel.archive({success:function(t){return function(){return s.show({message:tb_i18n.get("archived.file.success"),status:"success"}),t.hide()}}(this)}),this},e.prototype.favoriteWork=function(){var t;return t=this.workModel.get("isFavorite"),this.workModel[t?"unFavorite":"doFavorite"]({success:function(t){return function(e){var i;if(t.workModel.set("isFavorite",e.isFavorite),t.render(),!e.isFavorite&&t.options.onUnfavorite)return"function"==typeof(i=t.options).onUnfavorite&&i.onUnfavorite(t.workModel.get("_id")),t.parentView.close()}}(this)}),this},e.prototype.enterDeleteSubMenu=function(){return this.enterSubMenu(tb_i18n.get("work.menu.delete.title"),function(t){return function(){return t.$el.html(o())}}(this)),this},e.prototype.submitDeleteForm=function(t){return t.preventDefault(),this.workModel.destroy({success:function(t){return function(){return s.show({message:tb_i18n.get("delete.success"),status:"success"}),t.hide()}}(this)}),this},e.prototype.switchVisible=function(t){var e;return e=$(t.currentTarget),this.workModel.saveAttr("visible",e.data("type"),{success:function(t){return function(){return t.render()}}(this)}),this},e}(a)},function(t,e){t.exports=function(t){var e='<ul class="list work-menu-list"> ';return t.permissions.putFork&&(e+=" <li> <a class=\"copy-work-handler\" data-gta=\"{action: 'copy', type: 'work', control: 'File List'}\"> <span class=\"icon icon-copy\"></span>"+tb_i18n.get("work.menu.copy.file")+" </a> </li> "),e+=" <li> <a class=\"favorite-work-handler\" data-gta=\"{action: 'add to favourite', type: 'work', control: 'File List'}\"> <span class=\"icon icon-favorite ",t.isFavorite&&(e+="favorited"),e+='"></span>',e+=t.isFavorite?""+tb_i18n.get("unfavorite"):""+tb_i18n.get("favorite")+tb_i18n.get("navigation.work"),e+=" </a> </li> ",t.permissions.putArchive&&(e+=" <li> <a class=\"archive-work-handler\" data-gta=\"{action: 'archive', type: 'work', control: 'File List'}\"> <span class=\"icon icon-archive\"></span>"+tb_i18n.get("archive.file")+" </a> </li> "),e+=" ",t.permissions.del&&(e+=" <li> <a class=\"delete-work-handler\" data-gta=\"{action: 'delete content', type: 'work', control: 'File List'}\"> <span class=\"icon icon-trash\"></span>"+tb_i18n.get("work.menu.delete.title")+" </a> </li> "),e+=" ",t.permissions.putVisible&&(e+=' <li class="divider"></li> <li> ',"members"==t.visible||"all"==t.visible?e+=' <a class="switch-visible-handler" data-type="involves" data-gta="{action: \'toggle visibility\', type: \'work\', control: \'File List\'}"> <div class="main-mode"> <span class="icon icon-unlock"></span> <span class="mode">'+tb_i18n.get("visible.mode")+'</span> <span class="ifClose">'+tb_i18n.get("visible.close")+'</span> </div> <span class="mode-explanation">'+tb_i18n.get("visible.to.member")+"</span> </a> ":"involves"==t.visible&&(e+=' <a class="switch-visible-handler" data-type="members" data-gta="{action: \'toggle visibility\', type: \'work\', control: \'File List\'}"> <div class="main-mode"> <span class="icon icon-lock"></span> <span class="mode">'+tb_i18n.get("visible.mode")+'</span> <span class="ifClose">'+tb_i18n.get("visible.open")+'</span> </div> <span class="mode-explanation">'+tb_i18n.get("visible.to.involve")+"</span> </a> "),e+=" </li> "),e+="</ul>"}},function(t,e){t.exports=function(t){var e='<form class="work-delete-form"> <p>'+tb_i18n.get("work.menu.confirm.delete")+'?</p> <button class="btn btn-danger" type="submit">'+tb_i18n.get("delete")+"</button></form>";return e}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(932).fileIconT;return n+='<div class="check-box pull-left disabled"> <span class="icon icon-tick"></span></div><div class="content-wrap work-edit clearfix"> <div class="work-content pull-left"> '+r(t)+' <span class="work-title"> <input type="text" placeholder="'+tb_i18n.get("work.edit.title")+'" class="form-control pull-left" value="'+t.fileName+'"> <button class="btn btn-primary btn-small submit-edit-handler pull-left">'+tb_i18n.get("save")+'</button> <button class="btn btn-link btn-small cancel-edit-handler pull-left">'+tb_i18n.get("cancel")+'</button> </span> </div> <div class="work-info pull-right row-flex"> <div class="work-size">'+t.fileSizeFix+'</div> <div class="work-author">'+e(t.creator.name||tb_i18n.get("unknown"))+'</div> <div class="work-updated"> <time class="hinted" data-title="'+t.updated+'">'+t.updatedDataString.dateString+"</time> </div> </div></div>"}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(932).fileIconT;return n+='<div class="check-box pull-left" data-gta="event" data-label="select file or directory"> <span class="icon icon-tick"></span></div><div class="content-wrap clearfix"> <div class="work-content pull-left"> '+r(t)+' <span class="work-title" data-gta="event" data-label="open previewer">'+e(t.fileName)+"</span> ","involves"===t.visible&&(n+=' <span class="icon icon-lock hinted" data-title="'+tb_i18n.get("visible.to.involve")+'"></span> '),n+=' </div> <div class="work-info pull-right row-flex"> <div class="work-size">'+t.fileSizeFix+'</div> <div class="work-author">'+e(t.creator.name||tb_i18n.get("unknown"))+'</div> <div class="work-updated"> <time class="hinted" data-title="'+t.updated+'">'+t.updatedDataString.dateString+'</time> </div> <div class="work-handler-set clearfix"> <a class="work-menu-toggler icon icon-chevron-down hinted" data-title="'+tb_i18n.get("more.operations")+'" data-gta="event" data-label="more action from list"></a> ',t.permissions.put&&(n+=' <a class="edit-work-handler icon icon-pencil hinted" data-title="'+tb_i18n.get("work.rename.title")+'"></a> '),n+=" ",t.permissions.putMove&&(n+=' <a class="move-work-handler icon icon-file-move2 hinted" data-title="'+tb_i18n.get("work.move.title")+'" data-gta="event" data-label="move from list"></a> '),n+=" ",t.permissions.putVersion&&(n+=' <a class="work-update-handler icon icon-circle-arrow-down-o hinted" data-title="'+tb_i18n.get("update.file")+"\" data-gta=\"{action: 'update file', type: 'file', control: 'File List', method: 'update'}\"></a> "),n+=" ",t.permissions.getDownload&&(n+=" ",n+=t.isFileLocalExist?' <a class="work-open-handler icon icon-file3 hinted" data-title="'+tb_i18n.get("open.file")+"\" data-gta=\"{action: 'open detail', type: 'file', control: 'File List', method: 'open'}\"></a> ":' <a class="work-download-handler icon icon-circle-arrow-down-o hinted" data-title="'+tb_i18n.get("library.download")+"\" data-gta=\"{action: 'open detail', type: 'file', control: 'File List', method: 'download'}\"></a> ",n+=" "),n+=" </div> </div></div>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;p=i(358),u=i(678),l=i(788),a=i(696),r=i(1580),c=i(1673),o=i(1677),n="with-full-project-panel",t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.viewName="ProjectPanelView",e.prototype.className="project-panel",e.prototype.currentView=null,e.prototype.events={"click .close-handler":"closeHandler"},e.prototype.initialize=function(t){var e;if(null==t&&(t={}),this.options=t,this.projectModel=t.projectModel,(e=t._projectId)&&!this.projectModel&&(this.projectModel=a.getOne(0,e)),!this.projectModel)throw new Error(this.viewName+" need dependency projectModel");return this.render(),this.listenTo(this.projectModel,"change:currentPanel",this.render)},e.prototype.render=function(){var t;switch(t=this.projectModel.get("currentPanel")){case"filter":this.renderFilter();break;case"member":this.renderMember();break;case"activity":this.renderActivity()}return t?this.show():this.hide()},e.prototype.renderFilter=function(){var t,e;return e={_projectId:this.projectModel.id},this.taskFilterView||(this.taskFilterView=this.requestSubView(c,e)),this.switchToView(this.taskFilterView),t=this.currentView.$el,p.delay(function(){return t.find(".filter-input-wrap input").focus()},100)},e.prototype.renderMember=function(){var t;return this.memberBarView||(this.memberBarView=this.requestSubView(o,{_projectId:this.projectModel.id,projectModel:this.projectModel})),this.switchToView(this.memberBarView),t=this.currentView.$el,p.delay(function(){return t.find(".filter-input").focus()},100)},e.prototype.renderActivity=function(){var t;return this.activityPanelView||(this.activityPanelView=this.requestSubView(r,{projectModel:this.projectModel})),t=this.activityPanelView,t.renderChild("all"),this.switchToView(t)},e.prototype.switchToView=function(t){var e,i,n;return null!=(e=this.currentView)&&null!=(i=e.$el)&&i.detach(),this.currentView=t,null!=(n=this.currentView)?n.$el.appendTo(this.$el):void 0},e.prototype.toggle=function(){return this.isShowing?this.hide():this.show()},e.prototype.show=function(){if(!this.isShowing&&this.projectModel.get("currentPanel"))return this.isShowing=!0,u.APP.$el.addClass(n)},e.prototype.hide=function(){if(this.isShowing)return this.isShowing=!1,u.APP.$el.removeClass(n)},e.prototype.closeHandler=function(t){return this.projectModel.set("currentPanel",null)},e.prototype.remove=function(){return this.projectModel.set("currentPanel",null),u.APP.$el.removeClass(n),e.__super__.remove.apply(this,arguments)},e}(l)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k=function(t,e){function i(){this.constructor=t}for(var n in e)w.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},w={}.hasOwnProperty;v=i(358),b=i(678),f=i(677),g=i(788),m=i(797),h=i(696),s=i(1581),l=i(1658),u=i(1663),a=i(1665),c=i(1670),d=i(1672),n="on-active",r="with-full-member-bar",o="with-mini-member-bar",y=function(){return{all:{title:tb_i18n.get("activity.panel.title.all"),backTo:"all",View:s},plugins:{backTo:"all",View:l},share:{backTo:"plugins",View:u},copy:{backTo:"plugins",View:a},dump:{backTo:"plugins",View:c}}},p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return k(e,t),e.prototype.viewName="ActivityPanelView",e.prototype.className="activity-panel",e.prototype.currentView=null,e.prototype.events={"click .switch-handler":"switchHandler","click .close-handler":"toggle","mousewheel .activity-panel-body":f.mousewheel},e.prototype.initialize=function(t){var e;if(null==t&&(t={}),this.projectModel=t.projectModel,(e=t._projectId)&&!this.projectModel&&(this.projectModel=h.getOne(0,e)),!this.projectModel)throw new Error(this.viewName+" need dependency projectModel");return this.options=t,this.children={},this.renderBasic(),this.setupScroll(this.$body),this.setupLoadMore(10)},e.prototype.loadMore=function(t){var e;return null!=(e=this.currentView)&&"function"==typeof e.loadMore&&e.loadMore(),"function"==typeof t?t():void 0},e.prototype.renderBasic=function(){var t;return t=y(),this.$el.html(d(t.all)),this.$body=this.$(".activity-panel-body"),this.$backButton=this.$(".activity-panel-header .activity-back")},e.prototype.refreshHeader=function(t){var e,i;return e=y(),this.$backButton.attr("data-type",e[t].backTo),i="all"!==t,this.$el[i?"addClass":"removeClass"]("with-back")},e.prototype.renderChild=function(t){var e,i,n,r,o;return i=y(),this.projectModel.clearUnreadCount(),i[t]||(t="all"),n=this.children[t],(null!=n?n.$el:void 0)||(e=i[t],r=v.extend({},this.options),r._projectId||(r._projectId=this.projectModel.id),r.projectModel||(r.projectModel=this.projectModel),this.children[t]=n=this.requestSubView(e.View,r)),null!=(o=this.currentView)&&o.$el.detach(),this.refreshHeader(t),this.scrollToTop(),this.$body.html(n.$el),this.currentView=n},e.prototype.switchHandler=function(t){var e;if(e=$(null!=t?t.currentTarget:void 0).attr("data-type"))return"all"===e?this.backToAll():this.enterChild(e)},e.prototype.backToAll=function(){return this.renderChild("all"),this.leftIn()},e.prototype.enterChild=function(t){return this.renderChild(t),this.rightIn()},e.prototype.scrollToTop=function(){return this.slideTo(null,!0),this},e.prototype.leftIn=function(){var t;return t=this.currentView.$el,t.css({x:"-100%",opacity:0}),t.transition({x:"0",opacity:1},128,"out")},e.prototype.rightIn=function(){var t;return t=this.currentView.$el,t.css({x:"100%",opacity:0}),t.transition({x:"0",opacity:1},128,"out")},e}(g),v.extend(p.prototype,m),t.exports=p},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v=function(t,e){function i(){this.constructor=t}for(var n in e)y.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},y={}.hasOwnProperty;g=i(678),m=i(788),l=i(684),d=i(696),u=i(1329),f=i(786),n=i(1582),s=i(1650),r=i(1651),c=i(1653),p=i(1359),h=i(1610),a=i(1657),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return v(e,t),e.prototype.viewName="ActivityPanelAllView",e.prototype.className="activity-panel-all",e.prototype.events={"click .app":"showProjectSettings","click .project-tags-handler":"showTags","click .project-powerup-handler":"showPowerUpConfig","click .project-activies-handler":"showAllProjectInfos"},e.prototype.initialize=function(t){return this.options=t,this._projectId=t._projectId,this.projectModel=d.getOne(0,this._projectId),this.organizationsCollection=l.get(0),this.render(),this.listen()},e.prototype.loadMore=function(){var t;return null!=(t=this.activitiesView)?t.loadMore():void 0},e.prototype.render=function(){return this.renderBasic(),this.toggleProjectStaticsAndTable(),this.renderActivities()},e.prototype.listen=function(){return this.listenTo(this.projectModel,"change:applications",function(){if(this.projectModel.isAppChanged("tasks"))return this.toggleProjectStaticsAndTable()}),this},e.prototype.toggleProjectStaticsAndTable=function(){return this.projectModel.isAppEnabled("tasks")?(this.renderProjectStatics(),this.renderTable()):(this.$projectStatistics.html(null),this.$cardTable.html(null)),this},e.prototype.renderBasic=function(){return this.$el.html(a({isGhost:g.user.get("isGhost")})),this.$wrap=this.$(".activity-panel-activities-wrap"),this.$projectStatistics=this.$(".activity-panel-statistics"),this.$cardTable=this.$(".activity-panel-card-table"),this.$dataStatistic=this.$(".activity-panel-activities")},e.prototype.renderProjectStatics=function(){return this.showLoadingIndicator(this.$dataStatistic),this.$projectStatistics.html(this.requestSubView(r,{_projectId:this._projectId}).$el)},e.prototype.renderTable=function(){return this.$cardTable.html(this.requestSubView(c,{_projectId:this._projectId}).$el)},e.prototype.renderActivities=function(){var t;return t={isJustToday:!0,_projectId:this._projectId},this.activitiesView=this.requestSubView(n,t),this.activitiesView.$el.appendTo(this.$wrap)},e.prototype.showProjectSettings=function(){return new u({projectModel:this.projectModel}),this},e.prototype.showPowerUpConfig=function(){return this.requestSubView(f).open(p,{projectModel:this.projectModel}),this},e.prototype.showAllProjectInfos=function(){var t;return t={_projectId:this._projectId},this.requestSubView(f).open(s,t),this},e.prototype.showTags=function(){var t;return t={_projectId:this._projectId},this.requestSubView(f).open(h,t),this},e}(m)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M=function(t,e){function i(){this.constructor=t}for(var n in e)C.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},C={}.hasOwnProperty;_=i(358),j=i(678),T=i(1583),h=i(680),f=i(688),w=i(788),g=i(429),k=i(681),b=i(797),l=i(401),d=i(1584),c=i(1268),m=i(699),y=i(696),v=i(1021),r=i(1586),s=i(1647),u=i(1648),p=i(1649),a="activity-card",n="all",t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return M(e,t),e.prototype.viewName="ActivityPanelActivitiesView",e.prototype.className="activity-panel-activities",e.prototype.events={"click .member-filter":"toggleMemberFilter","click .type-filter":"toggleTypeFilter","click .date-filter":"toggleDateFilter","click .activity-card.on-openable":"openDetail",mousewheel:"mousewheelHandler"},e.prototype.initialize=function(t){if(t._projectId)return this.isJustToday=!!t.isJustToday,this._projectId=t._projectId,this.filterModel=new f({filterTypes:[],filterMembers:[]}),this.projectModel=y.getOne(0,this._projectId),this.localCache=k.namespace("temp").namespace(this.viewName),this.localCacheId=this.projectModel.id+"_"+j.user.id,this.filterTypes=[],this.filterMembers=[],this.renderBasic(),this.load().then(function(t){return function(){if(t.$el)return t.listen(),t.renderActivities(),_.delay(function(){if(t.$el)return t.loadMore()},100)}}(this))["catch"](function(t){return console.error(t)})},e.prototype.load=function(){return this.showLoadingIndicator(this.$list),Promise.all([new Promise(function(t){return function(e,i){return d.fetch(t._projectId+"_"+t.isJustToday,{_projectId:t._projectId,attrs:t.getLoadData(),success:function(i,n){return t.activitiesCollection=i,e()},error:i})}}(this)),new Promise(function(t){return function(e,i){return m.fetch(t._projectId,{success:function(i){return t.membersCollection=i,e()},error:i})}}(this))]).then(function(t){return function(){return t.hideLoadingIndicator()}}(this))},e.prototype.loadMore=function(t){var e;if(!this.loadingMore)return null!=(e=this.activitiesCollection)?e.loadMore({attrs:this.getLoadData(),beforeSend:function(t){return function(){if(t.$el)return t.loadingMore=!0,t.showLoadingIndicator(t.$list)}}(this),success:function(e){return function(i,n){if(e.$el)return e.activitiesCollection.hasMore&&"function"==typeof t&&t(),(null!=n?n.length:void 0)?void 0:e.renderActivities()}}(this),complete:function(t){return function(){if(t.$el)return t.loadingMore=!1,t.hideLoadingIndicator({animated:!0})}}(this)}):void 0},e.prototype.loadFive=function(){return h.ajax("projects/"+this._projectId+"/activities",{data:{count:10,page:1},success:function(t){return function(e){return null==e&&(e=[]),t.activitiesCollection.add(e.slice(0,5))}}(this)})},e.prototype.listen=function(){return this.listenTo(this.filterModel,"change",this.refreshFilter),this.listenTo(this.filterModel,"change",this.filter),this.listenTo(this.activitiesCollection,"add",this.renderActivities),this},e.prototype.renderBasic=function(){var t;return t={isJustToday:this.isJustToday},this.$el.html(s(t)),this.$list=this.$(".activity-panel-activities-body"),this.$placeholder=this.$(".activity-panel-activities-placeholder"),this.$memberFilter=this.$(".member-filter"),this.$typeFilter=this.$(".type-filter"),this.$dateFilter=this.$(".date-filter")},e.prototype.refreshFilter=function(){var t,e,i;return t=this.filterModel.toJSON(),e="on-filtered",i=t.filterMembers.length?"addClass":"removeClass",this.$memberFilter[i](e),i=t.filterTypes.length?"addClass":"removeClass",this.$typeFilter[i](e),i=t.filterDate?"addClass":"removeClass",this.$dateFilter[i](e)},e.prototype.renderActivities=function(){return this._renderActivities||(this._renderActivities=_.debounce(function(t){return function(){if(t.datas=t.formatCollection(),_.each(t.datas,function(e,i){return t.renderActivity(e,t.nextElement(t.datas,i))}),t.activitiesCollection.hasMore||t.datas.length?t.$placeholder.addClass("hide"):t.$placeholder.removeClass("hide"),!t._loadedFive&&!t.activitiesCollection.hasMore&&t.activitiesCollection.length<5)return t._loadedFive=!0,t.loadFive()}}(this),10)),this._renderActivities()},e.prototype.nextElement=function(t,e){var i,n,r,o,s,c,l;if(e+1>t.length-1)return null;for(r=s=c=e+1,l=t.length-1;c<=l?s<=l:s>=l;r=c<=l?++s:--s)if(n=t[r],o=null!=n?n._id:void 0,i=this.$("."+a+"[data-id="+o+"]"),i.length)return i;return null},e.prototype.renderActivity=function(t,e){var i,n,o,s,c,l,p,u;return null==t&&(t={}),l={data:t},c=r.getNewCardView(t.action),c?(s=c.view,l.openable=c.openable):(s=r.getView(t.objectType||(null!=(p=t.content)?p.objectType:void 0)),l._projectId=this._projectId),n=this.$("."+a+"[data-id="+t._id+"]"),o=this.$list,n.length||(u=this.requestSubView(s,l),i=u.$el,null!=i&&i.attr("data-type",t.boundToObjectType),null!=i&&i.attr("data-gta","{ action: 'open detail', type: '"+t.boundToObjectType+"', control: 'Side Menu'}"),e?e.before(i):o.append(i)),i||n},e.prototype.formatCollection=function(){var t;return this.activitiesCollection.sort(),t=this.activitiesCollection.toJSON(),this.activitiesCollection.hasMore||this.insertProjectCreateData(t),t.filter(this.getActivityFilter())},e.prototype.insertProjectCreateData=function(t){var e,i;return null==t&&(t=[]),this.isJustToday&&(i=g().startOf("day"),e=g(this.projectModel.get("created")),!e.isAfter(i))?t:(t.push({_id:"activity-card-create",_creatorId:this.projectModel.get("_creatorId"),isHomeActivity:!1,objectType:"create",created:this.projectModel.get("created")}),t)},e.prototype.getLoadData=function(){var t,e,i,n;return t={},this.isJustToday&&(t.created__gte=g().startOf("day").toISOString()),e=this.filterModel.get("filterMembers"),e.length&&(t._creatorId=e.join(",")),i=this.filterModel.get("filterTypes"),i.length&&(t.type=i.join(",")),this.filterTime&&(n=T.getWeek(this.filterTime),t.created__gte=new Date(n.startTime).toISOString(),t.created__lte=new Date(n.endTime).toISOString()),t},e.prototype.getActivityFilter=function(){var t,e,i;return i=_.without(this.filterTypes,n),t=_.without(this.filterMembers,n),e=this.filterTime,function(n){var r,o;return!(t.length&&_.indexOf(t,n._creatorId)<0)&&(!(i.length&&n.isHomeActivity===!1&&_.indexOf(i,"others")<0)&&(!e||n.isHomeActivity!==!1&&(o=T.getWeek(e),r=new Date(n.created).valueOf(),o.startTime<=r&&r<=o.endTime)))}},e.prototype.toggleMemberFilter=function(t){var e,i,r,o;if(e=$(t.currentTarget),r="toggleMemberFilter",!e.data(r))return e.data(r,!0),i=this.getAllMembers(),this.filterMembers.length||this.filterMembers.push(n),null!=(o=this.memberFilterView)&&o.remove(),this.memberFilterView=this.requestSubView(v,{$toggler:e,width:200,height:270,multi:!0,dataList:i,selected:this.filterMembers,searchPlaceholder:tb_i18n.get("activity.panel.placeholder.searchMember"),ListTemplate:p,select:function(t){return function(e){return e===n?t.filterMembers=[e]:(t.filterMembers=_.without(t.filterMembers,n,e),t.filterMembers.push(e)),t.memberFilterView.update(i,t.filterMembers),t.setFilter()}}(this),unselect:function(t){return function(e){return t.filterMembers=_.without(t.filterMembers,e),t.filterMembers.length||t.filterMembers.push(n),t.memberFilterView.update(i,t.filterMembers),t.setFilter()}}(this)}).show(),this.memberFilterView.$el.addClass("activity-panel-activities-popover"),this},e.prototype.getAllMembers=function(){var t;return t=this.membersCollection.toJSON(),t.unshift({_id:n,title:tb_i18n.get("activity.panel.filter.allMember")}),t},e.prototype.toggleTypeFilter=function(t){var e,i,o,s,a;if(e=$(t.currentTarget),s="toggleTypeFilter",!e.data(s))return e.data(s,!0),i=r.getFilterTypes(),o=this.filterTypes||[],o.length||o.push(n),null!=(a=this.typeFilterView)&&a.remove(),this.typeFilterView=this.requestSubView(v,{$toggler:e,width:200,height:270,multi:!0,dataList:i,selected:o,ListTemplate:u,select:function(t){return function(e){return e===n?t.filterTypes=[e]:(t.filterTypes=_.without(t.filterTypes,n,e),t.filterTypes.push(e)),t.typeFilterView.update(i,t.filterTypes),t.setFilter()}}(this),unselect:function(t){return function(e){return t.filterTypes=_.without(t.filterTypes,e),t.filterTypes.length||t.filterTypes.push(n),t.typeFilterView.update(i,t.filterTypes),t.setFilter()}}(this)}).show(),this.typeFilterView.$el.addClass("activity-panel-activities-popover"),this},e.prototype.toggleDateFilter=function(t){var e,i,n,r,o;if(e=$(t.currentTarget),r="toggleDateFilter",!e.data(r))return e.data(r,!0),n=[this.filterTime||T.all],i=T.getWeeks(this.projectModel.toJSON()),null!=(o=this.dateFilterView)&&o.remove(),this.dateFilterView=this.requestSubView(v,{$toggler:e,width:200,height:270,dataList:i,selected:n,multi:!0,select:function(t){return function(e){return t.filterTime=T.translateSelect(e),t.setFilter(),t.dateFilterView.update(i,e)}}(this),unselect:function(t){return function(e){return t.filterTime=null,t.setFilter(),t.dateFilterView.update(i,T.all)}}(this)}).show(),this.dateFilterView.$el.addClass("activity-panel-activities-popover"),this},e.prototype.setFilter=function(){return this.filterModel.set({filterMembers:_.without(this.filterMembers,n),filterTypes:_.without(this.filterTypes,n),filterDate:this.filterTime})},e.prototype.filter=function(){return this.$list.empty(),this.activitiesCollection.reset(),this.activitiesCollection.hasMore=!0,this.loadMore()},e.prototype.mousewheelHandler=function(){var t,e,i;return null!=(t=this.memberFilterView)&&t.hide(),null!=(e=this.typeFilterView)&&e.hide(),null!=(i=this.dateFilterView)?i.hide():void 0},e.prototype.openDetail=function(t){var e,i,n,r;return e=$(null!=t?t.currentTarget:void 0),i=e.find(".activity-child").data("id"),r=e.attr("data-type"),i&&"undefined"!==i?(n={},e.is(".comment-handler")&&(n.where="activity-comment"),j.APP.openObjectPreviewer(i,r,n)):this.openError(tb_i18n.get("error"))},e.prototype.openError=function(t){return l.show({message:tb_i18n.get("activity.card.error.notFound",t),status:"error"})},e}(w)},function(t,e,i){var n,r,o;r=i(429),n="all",o={all:n,getWeeks:function(t){var e,i,o,s,a,c,l;for(c=[{_id:n,title:tb_i18n.get("activity.panel.weeker.all")}],i=r(),e=a=null,s=52;s>0;)l=i.clone().startOf("week"),o=i.clone().endOf("week"),c.push({_id:i.valueOf(),title:l.format("MM.DD")+" - "+o.format("MM.DD")+" ("+i.format("wo")+")"}),s--,l.valueOf()<r(t.created).valueOf()&&(s=0),i.add(-1,"weeks");return c},getWeek:function(t){var e;return e=r(t),{startTime:e.clone().startOf("week").valueOf(),endTime:e.clone().endOf("week").valueOf()}},translateSelect:function(t){return t===n?null:t}},t.exports=o},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(686),n=i(685),o=i(1585),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.name="homeActivities",e.prototype.boundToObjectType="project",e.prototype.model=o,e.prototype.pageNum=10,e.prototype.initialize=function(t,i){return null==i&&(i={}),e.__super__.initialize.apply(this,arguments),this._projectId=i._projectId},e.prototype.listen=function(){var t;if(!this.listened)return this.listened=!0,t=this.name+"/"+(this._projectId||this._boundToObjectId),s.on(":new:"+t,function(t){return function(e){return t.add(e)}}(this)),s.on(":change:"+t,function(t){return function(e){return t.set(e)}}(this)),s.on(":remove:"+t,function(t){return function(e){return t.remove(e)}}(this)),s.on(":remove:"+this.name,function(t){return function(e){return t.remove(e)}}(this)),this},e.prototype.url=function(){return"projects/"+(this._projectId||this._boundToObjectId)+"/activities"},e.prototype.sync=function(t,i,n){return null==n&&(n={}),n.url=this.url(),e.__super__.sync.call(this,t,i,n)},e}(n)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=i(358),r=i(688),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.name="homeActivity",e.prototype.parse=function(t){var e,i;return null==t&&(t={}),i=t.locales||{},e=i[tb_i18n.getLanguage()],o.extend(this.toJSON(),t,e)},e.prototype.urlRoot=function(){return"projects/"+(this.get("_projectId")||this._projectId)+"/activities"},e.prototype.initSubscribe=function(){var t,e;return t=null!=(e=this.get("content"))?e.objects:void 0,o.each(t,function(t){return function(e){if(e._id)return t.subscribeTo(e._id,"change",function(e){return t.updateObjects(e.toJSON())}),t.subscribeTo(e._id,"destroy",function(e){return t.removeObject(e)})}}(this)),this},e.prototype.updateObjects=function(t){var e,i,n;return e=o.clone(this.get("content")||{}),n=e.objects,i=[],o.each(n,function(e){return e._id===t._id?i.push(t):i.push(e)}),e.objects=i,this.set({content:e})},e.prototype.removeObject=function(t){var e,i,n;return e=o.clone(this.get("content")||{}),n=e.objects,i=[],o.each(n,function(e){if(e._id!==t)return i.push(e)}),e.objects=i,this.set("content",e)},e}(r)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x;T=i(358),a=i(1587),r=i(1591),s=i(1594),o=i(1596),d=i(1598),_=i(1599),y=i(1600),m=i(1602),p=i(1603),j=i(1604),l=i(1606),c=i(1607),b=i(1608),v=i(1609),f=i(1638),n=i(1639),u=i(1640),w=i(1643),k=i(1644),g=i(1645),h=i(1646),C=function(){return[{_id:"all",icon:"icon-th",title:tb_i18n.get("activity.panel.filter.allType")},{_id:"task",icon:"icon-checkbox-checked",title:tb_i18n.get("task")},{_id:"post",icon:"icon-wall",title:tb_i18n.get("post")},{_id:"work",icon:"icon-file",title:tb_i18n.get("file")},{_id:"event",icon:"icon-calendar",title:tb_i18n.get("event")},{_id:"entry",icon:"icon-bookkeeping-logo",title:tb_i18n.get("entry")},{_id:"tag",icon:"icon-tag",title:tb_i18n.get("tags")},{_id:"system",icon:"icon-info",title:tb_i18n.get("activity.panel.filter.system")}]},x={task:r,event:r,post:r,entry:r,work:a,user:s,create:o},M=T.once(function(){var t,e,i,r,o,s,a,d,_,M,C,x,$,S,I,z,P;return z={},t=function(t,e){return T.mapObject(t,function(t){return t.view=e}),T.extend(z,t)},x={"activity.project.remove.task":{},"activity.project.redo.task":{openable:!0},"activity.project.finish.task":{openable:!0},"activity.project.unarchive.task":{openable:!0},"activity.project.archive.task":{openable:!0},"activity.project.create.task":{openable:!0}},t(x,y),_={"activity.project.remove.post":{},"activity.project.create.post":{openable:!0},"activity.project.archive.post":{openable:!0},"activity.project.unarchive.post":{openable:!0}},t(_,m),o={"activity.project.remove.event":{},"activity.project.create.event":{openable:!0},"activity.project.archive.event":{openable:!0},"activity.project.unarchive.event":{openable:!0}},t(o,p),P={"activity.project.remove.work":{},"activity.project.create.works":{},"activity.project.archive.work":{},"activity.project.unarchive.work":{}},t(P,j),r={"activity.project.remove.entry":{},"activity.project.create.entry":{openable:!0},"activity.project.archive.entry":{openable:!0},"activity.project.unarchive.entry":{openable:!0}},t(r,l),i={"activity.project.remove.collection":{},"activity.project.create.collection":{openable:!0},"activity.project.archive.collection":{},"activity.project.unarchive.collection":{openable:!0}},t(i,c),$={"activity.project.create.tasklist":{openable:!0},"activity.project.remove.tasklist":{},"activity.project.archive.tasklist":{},"activity.project.unarchive.tasklist":{}},t($,b),C={"activity.project.create.tag":{openable:!0},"activity.project.remove.tag":{},"activity.project.archive.tag":{},"activity.project.unarchive.tag":{}},t(C,v),M={"activity.project.remove":{},"activity.project.archive":{},"activity.project.unarchive":{},"activity.project.update.name":{},"activity.project.update.description":{},"activity.project.update.logo":{},"activity.project.update.visibility":{}},t(M,f),e={"activity.project.enable.application":{openable:!0},"activity.project.disable.application":{openable:!0},"activity.project.enable.plugin":{openable:!0},"activity.project.disable.plugin":{openable:!0}},t(e,n),s={"activity.project.invite.members":{},"activity.project.join.from.user.invite.link":{},"activity.project.join.from.user.qrcode":{}},t(s,u),a={"activity.project.join.from.qrcode":{},
"activity.project.join.from.invite.link":{},"activity.project.join.from.weixin":{},"activity.project.remove.self":{},"activity.project.join.as.organization.owner":{}},t(a,g),I={"activity.project.transfer.to.user":{},"activity.project.transfer.to.organization":{}},t(I,w),S={"activity.project.add.team.and.members":{},"activity.project.remove.member":{},"activity.project.remove.team.and.members":{}},t(S,k),d={"activity.project.remove.team":{}},t(d,h),z}),t.exports={getView:function(t){return x[t]||_},getFilterTypes:C,getNewCardView:function(t){return M()[t]}}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;a=i(358),c=i(678),s=i(792),n=i(1588),o=i(1590),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="ActivityCardWroks",e.prototype.className="activity-card-works",e.prototype.events={"click .on-openable":"openDetail"},e.prototype.initialize=function(t){if(e.__super__.initialize.apply(this,arguments),this.projectModel&&this.activityModel)return this.renderBasic(),this.listen()},e.prototype.listen=function(){return this.listenTo(this.activityModel,"change",this.renderBasic),this.listenTo(this.activityModel,"destroy",this.renderBasic)},e.prototype.renderBasic=function(){var t;if(!this.checkRemove())return this.$el.html(this.getWrapString()),t=this.$(".activity-card-body"),t.html(o({works:this.getWorks()})),this.$("time").timesince()},e.prototype.checkRemove=function(){var t,e;return e=this.getWorks(),t=!e.length,t&&this.remove(),t},e.prototype.getWorks=function(){var t,e,i;return t=this.activityModel.toJSON(),i=[],a.each(null!=(e=t.content)?e.objects:void 0,function(t){if(t._id)return i.push(s.formatWork(t))}),i},e.prototype.openDetail=function(t){var e,i,n,r,o,s;if(e=$(null!=t?t.currentTarget:void 0),n=e.data("id"))return i=this.activityModel.toJSON(),s=null!=(r=i.content)&&null!=(o=r.objects)?o.map(function(t){return t._id}):void 0,c.APP.openWorksPreviewer(n,s,{isAnimation:!1})},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;p=i(678),c=i(788),r=i(401),o=i(1585),a=i(696),s=i(699),l=i(1589),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.cardClass="activity-card",e.prototype.initialize=function(t){if(t._projectId&&t.data)return this.options=t,this.data=t.data,this._projectId=t._projectId,this.projectModel=a.find(0).get(this._projectId),this.data.isHomeActivity!==!1&&(this.activityModel=new o(this.data),this.listenTo(this.activityModel,"change:content",function(t){return function(e,i){if(!(null!=i?i.objects[0]:void 0))return t.remove()}}(this))),this.$el.addClass(this.cardClass),this.$el.attr("data-id",this.data._id)},e.prototype.getWrapString=function(){var t,e,i,n,r;return t=this.activityModel.toJSON(),e=t.content||{},i=e.objects||[],t.me=p.user.toJSON(),1===i.length&&(t.objectId=i[0]._id),r=t.creator.name,n=t.title.replace(r,"<b>"+r+"</b>"),t.title=n,l(t)},e.prototype.findProjectMember=function(t){var e,i;return i=s.get(this._projectId),e=i.get(t),(null!=e?e.toJSON():void 0)||{}},e.prototype.openError=function(t){return r.show({message:tb_i18n.get("activity.card.error.notFound",t),status:"error"})},e}(c)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<header class="activity-card-header"> <i class="avatar img-circle" style="background:url('+e(t.creator.avatarUrl)+')"></i></header><div class="activity-content"> <span class="activity-card-title"> ';return t.isNewCard?(i+=" ",t.unknownAction?i+=" "+t.unknownAction+" ":(i+=" <b>"+t.creator.name+'</b> <span class="action">'+t.actionDes+"</span> ",t.targetDes&&(i+='<span class="target">'+e(t.targetDes)+"</span>"),i+=' <span class="breascrumb-wrapper"></span> '),i+=" "):i+=" "+t.title+tb_i18n.get("colon")+" ",i+=' </span> <section class="activity-card-body"></section> <footer class="activity-card-footer"> <time datetime="'+t.created+'"></time> </footer></div>'}},function(t,e,i){t.exports=function(t){var e="",n=i(968),r=t.works;if(r)for(var o,s=-1,a=r.length-1;s<a;)o=r[s+=1],e+=' <div class="work ',o._id&&(e+="on-openable"),e+='" data-id="'+o._id+'"> '+n(o)+" </div>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h=function(t,e){function i(){this.constructor=t}for(var n in e)m.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},m={}.hasOwnProperty;u=i(358),d=i(678),p=i(677),a=i(439),r=i(1588),o=i(1592),s=i(1269),l=i(818),c=i(1593),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.viewName="ActivityCardCommon",e.prototype.className="activity-card-common on-openable",e.prototype.initialize=function(t){if(e.__super__.initialize.apply(this,arguments),this.projectModel&&this.activityModel)return this.renderBasic(),this.listen()},e.prototype.listen=function(){return this.listenTo(this.activityModel,"change",this.renderBasic),this.listenTo(this.activityModel,"destroy",this.remove)},e.prototype.renderBasic=function(){var t,e,i,n,r;return this.$el.html(this.getWrapString()),t=this.$(".activity-card-body"),e=this.activityModel.toJSON(),i=null!=(r=e.content)?r.objects[0]:void 0,(null!=i?i._id:void 0)?(i.boundToObjectType=this.data.boundToObjectType,n=u.clone(this.parseCommon(i)),t.html(o(n)),"task"===n.objectType&&this.renderTaskIdLabel(n),this.$("time").timesince()):this.remove()},e.prototype.renderTaskIdLabel=function(t){return this.requestSubView(l,{projectModel:this.projectModel,uniqueId:t.uniqueId}).bind(this.$(".task-id-placeholder"))},e.prototype.parseCommon=function(t){var e,i,n;switch(t.objectType=t.boundToObjectType,t.boundToObjectType){case"task":return t.dueDate&&(n=p.formatDate(t.dueDate)),u.extend(t,{executor:this.findProjectMember(t._executorId),dateString:n?n.dateString:"",dateClass:n?n.dateClass:"",title:t.content});case"event":return u.extend(t,{startDateString:c.eventUtil.getStartDateString(t),endDateString:c.eventUtil.getEndDateString(t)});case"entry":return e=s.find(t._entryCategoryId),t.categoryTitle=null!=e?e.get("title"):void 0,t.title=t.content,t;case"post":return i=this.getContent(t),i=p.cutString(i,56,"..."),t.content=i,t}},e.prototype.getContent=function(t){var e,i;return"html"===t.postMode?(t.html||(t.html=t.content),e=$("<div>"+t.html+"</div>")):(i=$(a(t.content)),e=$("<div>").html(i)),e.text()},e}(r)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="activity-'+t.objectType+" activity-child ";return t.isDone&&(i+="on-done"),i+='" data-id="'+t._id+'"> ',t.startDateString&&(i+=' <div class="activity-event-date"> '+t.startDateString+" - "+t.endDateString+" </div> "),i+=' <div class="activity-'+t.objectType+'-title activity-title flex-horiz"> <span class="title">'+e(t.title)+'</span> <span class="task-id-placeholder flex-static"></span> </div> ',"entry"===t.objectType&&(i+=" ",i+=1===t.type?' <span class="activity-entry-amount on-income"> '+tb_i18n.get("bookkeeping.settings.income.tips")+" "+t.amount+tb_i18n.get("rmb")+" </span> ":' <span class="activity-entry-amount on-expense"> '+tb_i18n.get("bookkeeping.settings.expense.tips")+" "+t.amount+tb_i18n.get("rmb")+" </span> ",i+=" "),i+="</div>"}},function(t,e,i){var n,r,o,s;r=i(429),o=i(677),n=i(817),s={getStartDateString:function(t){var e,i;return i=r(t.startDate),e=new n(t,{bindByMatrix:!1}),e.checkAllDay()?this.calculatAllDayString(i):this.calculatDateString(i)},getEndDateString:function(t){var e,i;return e=r(t.endDate),i=new n(t,{bindByMatrix:!1}),i.checkAllDay()?(e=e.subtract(1,"day"),this.calculatAllDayString(e)):this.calculatDateString(e)},calculatAllDayString:function(t){return t=r(t),""+o.formatDate(t).dateString+tb_i18n.get("event.all.day.tips")},calculatDateString:function(t){var e;return e=r(),t=r(t),e.isSame(t,"day")?t.format("HH:mm"):o.formatDate(t).dateString+" "+t.format("HH:mm")}},t.exports={eventUtil:s}},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=i(358),r=i(1588),o=i(1595),s=i(699),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.viewName="ActivityCardInvite",e.prototype.className="activity-card-invite",e.prototype.initialize=function(t){if(e.__super__.initialize.apply(this,arguments),this.projectModel&&this.activityModel)return this.renderBasic(),this.listen()},e.prototype.listen=function(){return this.listenTo(this.activityModel,"change",this.renderBasic),this.listenTo(this.activityModel,"destroy",this.remove)},e.prototype.renderBasic=function(){var t,e,i,n,r,c;return e=s.get(this._projectId),t=this.activityModel.toJSON(),i=[],a.each(null!=(n=t.content)?n.objects:void 0,function(t){var n;return n=e.get(t._id),n&&a.extend(t,n.toJSON()),i.push(t)}),t.objects=i,c=t.creator.name,r=t.title.replace(c,"<b>"+c+"</b>"),t.title=r,this.$el.html(o(t)),this.$("time").timesince()},e}(r)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<header class="activity-card-header"> <i class="avatar img-circle" style="background:url('+e(t.creator.avatarUrl)+')"></i></header><div class="activity-content"> <span class="activity-card-title hinted" data-title="'+e(t.title)+'"> '+t.title+' </span> <section class="activity-card-body clearfix"> <div class="activity-invite-body"> ';if(t.objects&&t.objects.length>1){i+=" ";var n=t.objects;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <div class="avatar img-circle hinted pull-left on-more" data-id="'+r._id+'" data-title="'+e(r.name)+'" style="background-image:url('+r.avatarUrl+')"></div> ';i+=" "}else{i+=" ";var a=t.objects;if(a)for(var r,c=-1,l=a.length-1;c<l;)r=a[c+=1],i+=' <div class="activity-member-one row-flex"> <div class="avatar img-circle pull-left" data-id="'+r._id+'" style="background-image:url('+r.avatarUrl+')"></div> <div class="activity-member-infos"> <div class="activity-member-name"> '+e(r.name)+' </div> <div class="activity-member-email"> '+e(r.email)+" </div> </div> </div> ";i+=" "}return i+=' </div> </section> <footer class="activity-card-footer"> <time datetime="'+t.created+'"></time> </footer></div>'}},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=i(1588),r=i(1597),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.viewName="ActivityCreateTable",e.prototype.className="activity-card-create",e.prototype.initialize=function(t){if(e.__super__.initialize.apply(this,arguments),this.projectModel)return this.renderBasic(),this.listen()},e.prototype.listen=function(){return this.listenTo(this.projectModel,"change",this.renderBasic)},e.prototype.renderBasic=function(){var t;return t=this.projectModel.toJSON(),t.creator||(t.creator=this.findProjectMember(t._creatorId)),this.$el.html(r(t)),this.$("time").timesince()},e}(o)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<header class="activity-card-header"> <i class="avatar img-circle" style="background:url('+e(t.creator.avatarUrl)+')"></i></header><div class="activity-content"> <span class="activity-card-title"> <b>'+e(t.creator&&t.creator.name)+"</b> "+tb_i18n.get("activity.card.create.headerTips")+'</span> <section class="activity-card-body"> <span class="icon icon-project"></span> <span class="activity-create-name">'+e(t.name)+"</span> </section></div>";return i}},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;l=i(358),p=i(678),c=i(788),a=i(697),o=i(699),r=i(1191),n=i(1589),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="NewCardView",e.prototype.className="activity-card",e.prototype.events={click:"openDetail"},e.prototype.initialize=function(t){if(t.data)return this.data=t.data,this.openable=t.openable,this.render()},e.prototype.render=function(){return this.openable&&this.$el.addClass("openable"),this.parseData(this.data),l.extend(this.data,{isNewCard:!0}),this.$el.attr("data-id",this.data._id),this.$el.html(n(this.data)),this.$breadcrumbWrapper=this.$(".breascrumb-wrapper"),this.$innerWrapper=this.$(".activity-card-body"),this.breadcrumbHTML&&this.$breadcrumbWrapper.html(this.breadcrumbHTML),this.innerHTML&&this.$innerWrapper.html(this.innerHTML),this.$("time").timesince()},e.prototype.parseData=function(t){return t.actionDes=this._actionI18NParse(t.action)},e.prototype._actionI18NParse=function(t,e){return null==e&&(e=""),tb_i18n.get("project.panel."+t,e)},e.prototype.openDetail=function(){!this.openable},e.prototype._openObjectView=function(t,e){return p.APP.openObjectPreviewer(t,e)},e.prototype._initMemberCard=function(t,e,i){null==t&&(t=this.$el)},e}(c)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(1598),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.parseData=function(t){return t.unknownAction=t.title},e}(n)},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;r=i(697),s=i(818),n=i(1598),a=i(1601),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.className="activity-card common activity-task",e.prototype.render=function(){return e.__super__.render.apply(this,arguments),this.$breadcrumbWrapper.html(a({targetDes:this.data.content.task.content})),this.renderTaskIdLabel()},e.prototype.renderTaskIdLabel=function(){return this.requestSubView(s,{projectModel:r.find(this.data._boundToObjectId),uniqueId:this.data.content.task.uniqueId}).bind(this.$(".task-id-label-wrapper"))},e.prototype.parseData=function(t){return t.actionDes=this._actionI18NParse(t.action)},e.prototype.openDetail=function(){if(this.openable)return this._openObjectView(this.data.content.task._id,"task")},e}(n)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="bread-crumb-task flex-horiz"> <span class="task-title">'+e(t.targetDes)+'</span> <span class="task-id-label-wrapper"></span></div>';return i}},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(1598),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.className="activity-card common",e.prototype.parseData=function(t){return t.actionDes=this._actionI18NParse(t.action),t.targetDes=t.content.post.title},e.prototype.openDetail=function(){if(this.openable)return this._openObjectView(this.data.content.post._id,"post")},e}(n)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=i(1598),n=i(1593),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.className="activity-card common",e.prototype.render=function(){return this.parseData(this.data),e.__super__.render.apply(this,arguments)},e.prototype.parseData=function(t){var e,i,r,o;return r=t.content.event,o=n.eventUtil.getStartDateString(r),i=n.eventUtil.getEndDateString(r),e=o+" - "+i,t.actionDes=this._actionI18NParse(t.action,e),t.targetDes=t.content.event.title},e.prototype.openDetail=function(){if(this.openable)return this._openObjectView(this.data.content.event._id,"event")},e}(o)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(358),n=i(1598),o=i(1605),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.className="activity-card work",e.prototype.render=function(){if(this.isRemoved=/remove/.test(this.data.action),e.__super__.render.apply(this,arguments),this.isRemoved&&this.$el.addClass("removed"),!this.isRemoved)return this.renderWorks()},e.prototype.renderWorks=function(){var t;return t=this.data.content.works||[this.data.content.work],s.each(t,function(t){return function(e){return t.requestSubView(o,{activityId:t.data._id,workData:e}).$el.appendTo(t.$innerWrapper)}}(this))},e.prototype.parseData=function(t){if(t.actionDes=this._actionI18NParse(t.action),this.isRemoved)return t.targetDes=t.content.work.fileName},e.prototype.openDetail=function(){if(this.openable)return this._openObjectView(this.data.content.work._id,"post")},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;c=i(358),l=i(678),r=i(788),a=i(792),n=i(1585),s=i(968),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.className="work-card-item openable",e.prototype.events={click:"openDetail"},e.prototype.initialize=function(t){var e;if(e=t.activityId,this.activityModel=n.find(e),this.workData=t.workData,this.activityModel&&this.workData)return this.render()},e.prototype.render=function(){var t;return t=a.formatWork(this.workData),this.$el.html(s(t))},e.prototype.openDetail=function(){var t,e;if(t=this.workData._id)return e=this.getWorkIds(),l.APP.openWorksPreviewer(t,e,{isAnimation:!1})},e.prototype.getWorkIds=function(){var t,e;return t=this.activityModel.get("content"),e=t.works||[t.work],c.pluck(e,"_id")},e}(r)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;r=i(1598),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.className="activity-card common",e.prototype.render=function(){return this.breadcrumbHTML=this.getAmountDes(),e.__super__.render.apply(this,arguments)},e.prototype.parseData=function(t){return t.actionDes=this._actionI18NParse(t.action),t.targetDes=t.content.entry.content},e.prototype.getAmountDes=function(){var t;switch(t=this.data.content.entry.amount,this.data.content.entry.type){case 1:return tb_i18n.get("project.panel.entry.income",t);case-1:return tb_i18n.get("project.panel.entry.outcome",t)}},e.prototype.openDetail=function(){if(this.openable)return this._openObjectView(this.data.content.entry._id,"entry")},e}(r)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=i(1129),r=i(1598),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.className="activity-card common",e.prototype.parseData=function(t){return t.actionDes=this._actionI18NParse(t.action),t.targetDes=t.content.collection.title},e.prototype.openDetail=function(){if(this.openable)return o.enterCollection(this.data.content.collection._id)},e}(r)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=i(678),n=i(1598),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.className="activity-card common",e.prototype.parseData=function(t){return t.actionDes=this._actionI18NParse(t.action),t.targetDes=t.content.tasklist.title},e.prototype.openDetail=function(){var t,e;if(this.openable)return t=this.data._boundToObjectId,e=this.data.content.tasklist._id,o.router.navigate("project/"+t+"/tasks/scrum/"+e,{trigger:!0})},e}(n)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(786),n=i(1598),o=i(1610),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.className="activity-card common",e.prototype.parseData=function(t){return t.actionDes=this._actionI18NParse(t.action),t.targetDes=t.content.tag.name},e.prototype.openDetail=function(){var t;if(this.openable)return t=this.data._boundToObjectId,this.requestSubView(s).open(o,{_projectId:t,tagId:this.data.content.tag._id})},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w=function(t,e){function i(){this.constructor=t}for(var n in e)_.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},_={}.hasOwnProperty;b=i(358),k=i(678),p=i(797),v=i(677),y=i(788),l=i(696),f=i(1053),r=i(1611),o=i(1615),s=i(1617),c=i(1621),u=i(1625),g=i(1627),d=i(1629),n=i(1636),a=i(1637),h=i(1635),m=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.viewName="TagView",e.prototype.className="tags-view card col-flex modal-dialog",e.prototype.events={"click .tag-item:not(.active)":"switchHandler","click .tag-creator-handler":"toggleCreator","click .tag-info":"scrollToSection","click .task":"gtaTaskDetail","click .entry":"gtaEntryDetail","click .event":"gtaEventDetail","click .post":"gtaPostDetail","click .work":"gtaWorkDetail"},e.prototype.initialize=function(t){if(null!=t?t._projectId:void 0)return this.tagId=t.tagId,this._projectId=t._projectId,this.projectModel=l.getOne(0,this._projectId),this.currentTagId=null,this.prevTagId=null,this.renderBasic(),this.setupScroll(this.$contentWrap),this.load(function(t){return function(){return t.renderTags(),t.showContent(),t.listen()}}(this))},e.prototype.load=function(t){return f.fetch(this._projectId,{beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$tags,{isPrepend:!0})}}(this),success:function(e){return function(i){if(e.$el)return e.tagsCollection=i,e.hideLoadingIndicator(),t()}}(this)}),this},e.prototype.onOpen=function(){var t,e;if(this.tagId)return t=this.$(".tag-item[data-id="+this.tagId+"]"),t.length&&null!=(e=this.tagListView)&&"function"==typeof e.slideTo?e.slideTo(t):void 0},e.prototype.renderBasic=function(){return this.$el.html(n({permissions:this.projectModel.hasPermissions("tag.post")})),this.$header=this.$(".right-header"),this.$tags=this.$(".tag-list"),this.$contentWrap=this.$(".tag-content-wrap"),this.$placeholder=this.$(".placeholder"),this},e.prototype.listen=function(){return this.listenTo(this.projectModel,"change:applications",function(){if(this.projectModel.isNavAppChanged())return this.renderHeader()}),this.listenTo(this.tagsCollection,"add",function(t){if(!this.currentTagId)return this.showContent(t.id)}),this.listenTo(this.tagsCollection,"change",this.updateTag),this.listenTo(this.tagsCollection,"remove destroy",this.removeTag),this},e.prototype.renderHeader=function(t){var e;return t||(t=this.tagsCollection.get(this.currentTagId)),t&&(e=t.toJSON(),e.hasEntry=this.projectModel.isAppEnabled("bookkeeping"),this.$header.html(a(e))),this},e.prototype.renderTags=function(){return this.tagListView=this.requestSubView(d,{$el:this.$tags,tagsCollection:this.tagsCollection})},e.prototype.updateTag=function(t){return t.id===this.currentTagId&&(this.$tags.find(".tag-item[data-id="+t.id+"]").addClass("active"),this.renderHeader(t)),this},e.prototype.removeTag=function(t){return t.id!==this.currentTagId?this:(this.currentTagId=null,this.showContent(this.prevTagId),this)},e.prototype.showContent=function(t){var e,i,n,a,l,p,u,d;return u=this.tagsCollection.get(t||this.currentTagId||this.tagId),u||(u=this.tagsCollection.get(this.prevTagId)),u||(u=this.tagsCollection.at(0)),u?(this.$placeholder.hide(),e=this.$(".tag-item[data-id="+u.id+"]"),this.prevTagId=this.currentTagId,this.currentTagId=u.id,e.addClass("active").siblings().removeClass("active"),this.renderHeader(u),null!=(i=this.tasksView)&&i.remove(),null!=(n=this.eventsView)&&n.remove(),null!=(a=this.postsView)&&a.remove(),null!=(l=this.filesView)&&l.remove(),null!=(p=this.entriesView)&&p.remove(),this.$contentWrap.empty(),d=[{constructor:g,view:"tasksView"},{constructor:o,view:"eventsView"},{constructor:c,view:"postsView"},{constructor:s,view:"filesView"},{constructor:r,view:"entriesView"}],b.reduce(d,function(t){return function(e,i){return t.currentTagId===u.id?e.then(function(){return new Promise(function(e,n){return t[i.view]=t.requestSubView(i.constructor,{tagModel:u,onFinish:function(){return b.defer(e)}}),t[i.view].$el.appendTo(t.$contentWrap)})}):Promise.reject()}}(this),Promise.resolve())["catch"](b.noop),this):this.$placeholder.show()},e.prototype.checkNameExist=function(t){var e;return e=this.tagsCollection.map(function(t){return t.get("name")}),b.contains(e,t)},e.prototype.toggleCreator=function(t){var e;return e=$(t.currentTarget),e.data("bs.popover")||this.requestSubView(u,{$toggler:e,_projectId:this._projectId,tagsCollection:this.tagsCollection,checkNameExist:this.checkNameExist.bind(this),onShown:function(){return e.addClass("active")},onHidden:function(){return e.removeClass("active")}}).show(),this},e.prototype.switchHandler=function(t){return this.showContent($(t.currentTarget).data("id"))},e.prototype.scrollToSection=function(t){var e;if(e=$(t.currentTarget),!e.hasClass("disabled"))return this.slideTo(this.$(e.data("target")),!0),this},e.prototype.gtaTaskDetail=function(){return this.gtaObjectDetail("task")},e.prototype.gtaEntryDetail=function(){return this.gtaObjectDetail("entry")},e.prototype.gtaEventDetail=function(){return this.gtaObjectDetail("event")},e.prototype.gtaPostDetail=function(){return this.gtaObjectDetail("post")},e.prototype.gtaWorkDetail=function(){return this.gtaObjectDetail("file")},e.prototype.gtaObjectDetail=function(t){return k.gta.event({action:"open detail",page:"Tag Page",type:t,control:"Tag Detail"})},e}(y),b.extend(m.prototype,p),t.exports=m},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;l=i(358),p=i(678),n=i(1612),r=i(1264),o=i(1267),s=i(1613),c=i(788),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="TagEntriesView",e.prototype.className="tag-entries-view fade",e.prototype.events={"click .open-detail":"openDetail"},e.prototype.initialize=function(t){return this.tagModel=t.tagModel,this.entriesCollection=o.get("tag_"+this.tagModel.id),this.bookkeepingModel=new r,this.load().then(function(t){return function(){return t.listen(),t.renderBasic(),t.renderItems(),t.refreshCount()}}(this))["catch"](function(t){return console.error(t)}).then(function(){return"function"==typeof t.onFinish?t.onFinish():void 0}),this},e.prototype.load=function(){return new Promise(function(t){return function(e,i){return t.tagModel.fetchRelation("entries",{attrs:{page:1,count:500},success:function(i){return t.entriesCollection.reset(i),e()},error:function(t,e){return i(e)}})}}(this))},e.prototype.listen=function(){return this.listenTo(this.entriesCollection,"add",this.renderItems),this.listenTo(this.entriesCollection,"remove",this.removeItem),this.listenTo(this.entriesCollection,"change:tagIds",function(t){return function(e,i){if(!((null!=i?i.indexOf(t.tagModel.id):void 0)>=0))return t.entriesCollection.remove(e),t.tagModel.refreshCache()}}(this)),this},e.prototype.renderBasic=function(){return this.$el.html(n()).hide(),this.$list=this.$(".tag-entries-list"),this},e.prototype.renderItems=function(t){var e;return t?(l.isArray(t)||(t=[t]),e=!0):(this.$list.empty(),t=this.entriesCollection.toJSON()),l.each(t,function(t){return function(i){return t.renderItem(i,e)}}(this)),this.refreshCount(),this},e.prototype.renderItem=function(t,e){var i,n,r;return r=t.id||t._id||t,i=this.requestSubView(s,{_entryId:r,displayFields:this.bookkeepingModel.getFields(["category","content"]),viewType:"open-detail"}).$el,n=this.$(".entry-view[data-id="+r+"]"),n.length?n.replaceWith(i):this.$list[e?"prepend":"append"](i),this},e.prototype.removeItem=function(t){var e,i;return i=t.id||t._id||t,e=this.$(".entry-view[data-id="+i),e.remove(),this.refreshCount(),this},e.prototype.refreshCount=function(){var t;return t=this.entriesCollection.length,this.tagModel.set("entriesCount",t),this.$(".entries-count").text(t),t?this.$el.show().addClass("in"):this.$el.hide(),this},e.prototype.openDetail=function(t){var e,i;if((null!=t?t.currentTarget:void 0)?(e=$(t.currentTarget),i=e.data("id")):i=t,i)return p.APP.openEntryPreviewer(i),this},e}(c)},function(t,e){t.exports=function(t){var e="<h3>"+tb_i18n.get("entry")+' ・ <span class="entries-count">0</span></h3><ul class="tag-entries-list"></ul>';return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},v={}.hasOwnProperty;f=i(678),h=i(677),m=i(788),r=i(1264),c=i(1269),p=i(1265),o=i(1266),s=i(1267),a=i(1268),d=i(1053),l=i(1270),n=i(1614),t.exports=u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.viewName="EntryView",e.prototype.tagName="li",e.prototype.className="entry-view",e.prototype.events={"click .entry-handler":"handler"},e.prototype.initialize=function(t){if(!(null!=t?t._entryId:void 0))throw new Error(this.viewName+":wrong options");return this.options=t,this._entryId=t._entryId,t.displayFields&&(this.displayFields=t.displayFields,this.noSettings=!0),this.load().then(function(t){
return function(){return t.listen(),t.renderBasic()}}(this))["catch"](function(t){return console.error(t)}),this.$el.attr("data-id",this._entryId).addClass(t.viewType)},e.prototype.load=function(){return new Promise(function(t){return function(e,i){return p.fetch(t._entryId,{success:function(i){return t.entryModel=i,t._projectId=i.get("_projectId"),e()},error:i})}}(this)).then(function(t){return function(){return new Promise(function(e,i){return o.fetch(t._projectId,{success:function(i){return t.bookkeepingModel=i.at(0),t.displayFields||(t.displayFields=t.bookkeepingModel.getDisplayFields()),e()},error:i})})}}(this)).then(function(t){return function(){return new Promise(function(e,i){return a.fetch(t._projectId,{success:function(i){return t.entryCategoriesCollection=i,t.entryCategoryModel=t.entryCategoriesCollection.getCategory(t.entryModel.get("_entryCategoryId")),e()},error:i})})}}(this)).then(function(t){return function(){return new Promise(function(e,i){return d.fetch(t._projectId,{success:function(i){return t.tagsCollection=i,e()},error:i})})}}(this))},e.prototype.listen=function(){return this.stopListening(),this.listenTo(this.bookkeepingModel,"change:approveRight",this.renderBasic),this.listenTo(this.entryModel,"change",this.renderBasic),this.listenTo(this.entryModel,"remove",this.remove),this.listenTo(this.entryCategoryModel,"change",this.renderBasic),this.listenTo(this.entryModel,"change:_entryCategoryId",function(t){return function(){return t.entryCategoryModel=t.entryCategoriesCollection.getCategory(t.entryModel.get("_entryCategoryId")),t.listen()}}(this)),this.listenTo(this.entryCategoryModel,"remove destroy",function(t){return function(){return t.entryCategoryModel=t.entryCategoriesCollection.getCategory(t.entryModel.get("_entryCategoryId")),t.listen(),t.renderBasic()}}(this)),this},e.prototype.renderBasic=function(){var t,e,i,r,o,s,a,c,l,p;for(this.$el.removeClass("active"),r=this.entryModel.toJSON(),r.category=this.entryCategoryModel.toJSON(),r.creator||(r.creator={}),p=[],a=r.tagIds,o=0,s=a.length;o<s;o++)t=a[o],l=this.tagsCollection.get(t),l&&p.push(l.toJSON());return e={displayFields:this.displayFields,noSettings:this.noSettings,entry:r,approveRight:this.bookkeepingModel.get("approveRight"),tags:p,permissions:this.entryModel.hasPermissions("put","put.archive","put.visible","del")},e.entry.dateStr=(i=this.entryModel.get("date"))?null!=(c=h.formatDate(i))?c.dateString:void 0:"",this.$el.html(n(e)),this},e.prototype.handler=function(t){var e,i;if(e=this.$(t.currentTarget),i=e.data("type"))return"approve"===i?this.entryModel.approve():"revoke"===i?this.entryModel.revoke():"menu"===i&&this.toggleMenu(t),!1},e.prototype.toggleMenu=function(t){var e;return e=$(t.currentTarget),e.data("bs.popover")||this.requestSubView(l,{status:"list",$toggler:e,entryModel:this.entryModel,onShown:function(t){return function(){return t.$el.addClass("active")}}(this),onHidden:function(t){return function(){return t.$el.removeClass("active")}}(this)}).show(),this},e}(m)},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(963).calculateColor;n+='<div class="entry-wrap"> ';var o=t.displayFields;if(o)for(var s,a=-1,c=o.length-1;a<c;){if(s=o[a+=1],n+=' <div class="entry-'+s.attr+'"> ',"category"==s.attr)n+=' <span class="entry-category-icon icon icon-'+t.entry.category.iconStr+" ",n+=1==t.entry.category.type?"income":"expense",n+='"></span> <span class="entry-category-title">'+e(t.entry.category.title)+"</span> ";else if("content"==s.attr){n+=" ","involves"==t.entry.visible&&(n+=' <span class="icon icon-lock hinted" data-title="'+tb_i18n.get("visible.to.involve")+'"></span> '),n+=' <span class="entry-content-case">'+e(t.entry[s.attr])+"</span> ";var l=t.tags;if(l)for(var p,u=-1,d=l.length-1;u<d;)p=l[u+=1],n+=' <span class="label tag"> <span class="tag-label" style="background-color: '+r(p.color,p.colorRGBA)+'"></span> <span class="tag-name">'+e(p.name)+"</span> </span> ";n+=" "}else"creator"==s.attr?n+=" "+e(t.entry.creator.name)+" ":"amount"==s.attr?(n+=' <strong class="',n+=1==t.entry.type?"income":"expense",n+='">'+t.entry[s.attr]+"</strong> "):n+="date"==s.attr?" "+t.entry.dateStr+" ":" "+e(t.entry[s.attr])+" ";n+=" </div> "}return n+=" ",t.noSettings||(n+=' <div class="entry-status"> ',"approved"==t.entry.status&&(n+=" "+tb_i18n.get("entry.list.status.approved")+" "),n+=" </div> ",(t.approveRight||t.permissions.put||t.permissions.putArchive||t.permissions.putVisible||t.permissions.del)&&(n+=' <div class="entry-settings"> ',t.approveRight&&(n+=" ",n+="approved"==t.entry.status?' <a class="entry-handler" data-type="revoke">'+tb_i18n.get("entry.list.action.revoke")+"</a> ":' <a class="entry-handler" data-type="approve">'+tb_i18n.get("entry.list.action.approve")+"</a> ",n+=" "),n+=" ",n+=t.permissions.put||t.permissions.putArchive||t.permissions.putVisible||t.permissions.del?' <a class="entry-handler icon icon-chevron-down hinted" data-type="menu" data-title="'+tb_i18n.get("more.operations")+'"></a> ':' <span class="entry-handler icon icon-chevron-down entry-icon-empty"></span> ',n+=" </div> "),n+=" "),n+="</div>"}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(678),n=i(1616),o=i(1079),r=i(1226),a=i(788),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="TagEventsView",e.prototype.className="tag-events-view fade",e.prototype.initialize=function(t){return this.tagModel=t.tagModel,this.eventsCollection=o.get("tag_"+this.tagModel.id),this.renderBasic(),this.tagModel.fetchRelation("events",{attrs:{page:1,count:500},success:function(e){return function(i){if(e.$el)return e.eventsCollection.reset(i),e.requestSubView(r,{groupBy:!1,eventsCollection:e.eventsCollection}).$el.appendTo(e.$el),e.refreshCount(),e.eventsCollection.length&&e.$el.show().addClass("in"),e.listen(),"function"==typeof t.onFinish?t.onFinish():void 0}}(this),error:function(){return"function"==typeof t.onFinish?t.onFinish():void 0}}),this},e.prototype.renderBasic=function(){return this.$el.html(n()).hide(),this},e.prototype.listen=function(){return this.listenTo(this.eventsCollection,"add remove",this.refreshCount),this.listenTo(this.eventsCollection,"change:tagIds",function(t){return function(e,i){if(!((null!=i?i.indexOf(t.tagModel.id):void 0)>=0))return t.eventsCollection.remove(e),t.tagModel.refreshCache()}}(this)),this},e.prototype.refreshCount=function(){var t;return this.tagModel.set("eventsCount",this.eventsCollection.length),this.$(".events-count").text(this.eventsCollection.length),t=this.eventsCollection.length?"show":"hide",this.$el[t](),this},e}(a)},function(t,e){t.exports=function(t){var e="<h3>"+tb_i18n.get("event")+' ・ <span class="events-count">0</span></h3>';return e}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(678),n=i(1618),o=i(788),a=i(810),s=i(1619),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="TagWorksView",e.prototype.className="tag-works-view fade",e.prototype.initialize=function(t){return this.tagModel=t.tagModel,this.worksCollection=a.get("tag_"+this.tagModel.id),this.renderBasic(),this.tagModel.fetchRelation("works",{attrs:{page:1,count:500},success:function(e){return function(i){if(e.$el)return e.worksCollection.reset(i),e.requestSubView(s,{_projectId:e.tagModel.get("_projectId"),worksCollection:e.worksCollection}).$el.appendTo(e.$el),e.refreshCount(),e.worksCollection.length&&e.$el.show().addClass("in"),e.listen(),"function"==typeof t.onFinish?t.onFinish():void 0}}(this),error:function(){return"function"==typeof t.onFinish?t.onFinish():void 0}}),this},e.prototype.renderBasic=function(){return this.$el.html(n()).hide(),this},e.prototype.listen=function(){return this.listenTo(this.worksCollection,"add remove",this.refreshCount),this.listenTo(this.worksCollection,"change:tagIds",function(t){return function(e,i){if(!((null!=i?i.indexOf(t.tagModel.id):void 0)>=0))return t.worksCollection.remove(e),t.tagModel.refreshCache()}}(this)),this},e.prototype.refreshCount=function(){var t;return this.tagModel.set("worksCount",this.worksCollection.length),this.$(".works-count").text(this.worksCollection.length),t=this.worksCollection.length?"show":"hide",this.$el[t](),this},e}(o)},function(t,e){t.exports=function(t){var e="<h3>"+tb_i18n.get("file")+' ・ <span class="works-count">0</span></h3>';return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;n=i(1620),r=i(699),o=i(429),s=i(982),a=i(677),c=i(788),l=i(786),t.exports=p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="WorkListView",e.prototype.tagName="ul",e.prototype.className="work-list-view",e.prototype.events={"click .work":"openDetail"},e.prototype.initialize=function(t){if((null!=t?t.worksCollection:void 0)&&t._projectId)return this.options=t,this._projectId=t._projectId,this.worksCollection=t.worksCollection,r.fetch(this._projectId,{success:function(t){return function(e){return t.membersCollection=e,t.renderBasic().listen()}}(this)}),this},e.prototype.listen=function(){return this.listenTo(this.worksCollection,"add change",function(t){return function(e){return t.renderWork(e,!0)}}(this)),this.listenTo(this.worksCollection,"remove destroy",this.removeWork),this},e.prototype.renderBasic=function(){return this.worksCollection.each(function(t){return function(e){return t.renderWork(e)}}(this)),this},e.prototype.renderWork=function(t,e){var i,r;return i=this.$(".work[data-id="+t.id+"]"),r=$(n(this.getData(t))),i.length?i.replaceWith(r):this.$el[e?"prepend":"append"](r),r.find("time").timesince(),this},e.prototype.removeWork=function(t){return this.$(".work[data-id="+t.id+"]").remove(),this},e.prototype.getData=function(t){var e,i,n;return i=t.getFormatData(),i.creator=(null!=(n=this.membersCollection.get(i._creatorId))?n.toJSON():void 0)||{},(e=i.creator).name||(e.name=tb_i18n.get("unknown")),i},e.prototype.openDetail=function(t){var e;return e=this.worksCollection.get($(t.currentTarget).data("id")),this.requestSubView(l).open(s,{_projectId:this._projectId,workModel:e,workModels:this.worksCollection.models}),this},e}(c)},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(932).fileIconT;return n+='<li class="work" data-id="'+t._id+'"> '+r(t)+' <span class="work-title">'+e(t.fileName)+'</span> <div class="work-info muted"> '+tb_i18n.get("work.creator.info",t.creator.name)+' <time datetime="'+t.created+'"></time> </div></li>'}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(678),n=i(1622),o=i(1041),r=i(1623),a=i(788),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="TagPostsView",e.prototype.className="tag-posts-view fade",e.prototype.initialize=function(t){return this.tagModel=t.tagModel,this.postsCollection=o.get("tag_"+this.tagModel.id),this.renderBasic(),this.tagModel.fetchRelation("posts",{attrs:{page:1,count:500},success:function(e){return function(i){if(e.$el)return e.postsCollection.reset(i),e.requestSubView(r,{_projectId:e.tagModel.get("_projectId"),postsCollection:e.postsCollection}).$el.appendTo(e.$el),e.refreshCount(),e.postsCollection.length&&e.$el.show().addClass("in"),e.listen(),"function"==typeof t.onFinish?t.onFinish():void 0}}(this),error:function(){return"function"==typeof t.onFinish?t.onFinish():void 0}}),this},e.prototype.renderBasic=function(){return this.$el.html(n()).hide(),this},e.prototype.listen=function(){return this.listenTo(this.postsCollection,"add remove",this.refreshCount),this.listenTo(this.postsCollection,"change:tagIds",function(t){return function(e,i){if(!((null!=i?i.indexOf(t.tagModel.id):void 0)>=0))return t.postsCollection.remove(e),t.tagModel.refreshCache()}}(this)),this},e.prototype.refreshCount=function(){var t;return this.tagModel.set("postsCount",this.postsCollection.length),this.$(".posts-count").text(this.postsCollection.length),t=this.postsCollection.length?"show":"hide",this.$el[t](),this},e}(a)},function(t,e){t.exports=function(t){var e="<h3>"+tb_i18n.get("post")+' ・ <span class="posts-count">0</span></h3>';return e}},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=i(678),n=i(1624),r=i(699),s=i(788),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.viewName="PostListView",e.prototype.tagName="ul",e.prototype.className="post-list-view",e.prototype.events={"click .post":"openDetail"},e.prototype.initialize=function(t){if((null!=t?t.postsCollection:void 0)&&t._projectId)return this.options=t,this._projectId=t._projectId,this.postsCollection=t.postsCollection,r.fetch(this._projectId,{success:function(t){return function(e){return t.membersCollection=e,t.renderBasic().listen()}}(this)}),this},e.prototype.listen=function(){return this.listenTo(this.postsCollection,"add change",function(t){return function(e){return t.renderPost(e,!0)}}(this)),this.listenTo(this.postsCollection,"remove destroy",this.removePost),this},e.prototype.renderBasic=function(){return this.postsCollection.each(function(t){return function(e){return t.renderPost(e)}}(this)),this},e.prototype.renderPost=function(t,e){var i,r,o,s;return r=this.$(".post[data-id="+t.id+"]"),o=t.toJSON(),o.creator=null!=(s=this.membersCollection.get(o._creatorId))?s.toJSON():void 0,o.creator||(o.creator={_id:"",avatarUrl:"",name:tb_i18n.get("unknown")}),i=$(n(o)),r.length?r.replaceWith(i):this.$el[e?"prepend":"append"](i),i.find("time").timesince(),this},e.prototype.removePost=function(t){return this.$(".post[data-id="+t.id+"]").remove(),this},e.prototype.openDetail=function(t){return a.APP.openPostPreviewer($(t.currentTarget).data("id")),this},e}(s)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li class="post" data-id="'+t._id+'"> <span class="post-title" >'+e(t.description)+'</span> <div class="post-info muted"> '+tb_i18n.get("wall.view.post.creator.info",t.creator.name)+' <time datetime="'+t.created+'"></time> </div></li>';return i}},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;r=i(401),a=i(963),n=i(1626),o=i(813),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.viewName="TagCreatorView",e.prototype.className="tag-creator-view",e.prototype.popoverTitle="",e.prototype.events={"click .tag-label":"changeLabel","click .submit-handler":"submit"},e.prototype.initialize=function(){return this.popoverTitle=tb_i18n.get("tag.creator.title"),e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){return this.$el.html(n()),this.color&&this.$("[data-color='"+this.color+"']").addClass("active"),this.$input=this.$("input"),this},e.prototype.changeLabel=function(t){var e;return e=$(t.currentTarget),e.addClass("active").siblings().removeClass("active"),this.color=e.data("color"),this},e.prototype.submit=function(t){var e;if(e=this.$input.val().trim())return this.options.checkNameExist(e)?r.show({message:tb_i18n.get("tag.creator.warning.name.exit"),status:"warning"}):(this.options.tagsCollection.create({_projectId:this.options._projectId,name:e,color:a.transformToServerColor(this.color)},{wait:!0,success:function(t){return function(){return t.$input.val(""),t.remove()}}(this)}),this)},e}(o)},function(t,e,i){t.exports=function(t){var e="",n=i(963).COLORS;e+='<input class="add-input form-control" placeholder="'+tb_i18n.get("tag.creator.placeholder")+'"/><ul class="clearfix"> ';var r=n;if(r)for(var o,s=-1,a=r.length-1;s<a;)o=r[s+=1],e+=' <li class="tag-label" data-color="'+o+'" style="background-color: '+o+'"> <span class="icon icon-tick icon-white"></span> </li> ';return e+="</ul><button class=\"btn btn-primary submit-handler\" data-gta=\"{action: 'added content', type: 'tag', control: 'New Tag'}\"> "+tb_i18n.get("create")+"</button>"}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(678),n=i(1628),s=i(996),o=i(1553),a=i(788),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="TagTasksView",e.prototype.className="tag-tasks-view fade",e.prototype.initialize=function(t){return this.tagModel=t.tagModel,this.tasksCollection=s.get("tag_"+this.tagModel.id),this.renderBasic(),this.tagModel.fetchRelation("tasks",{attrs:{all:!0},success:function(e){return function(i){if(e.$el)return e.tasksCollection.reset(i),e.requestSubView(o,{tasksCollection:e.tasksCollection}).$el.appendTo(e.$el),e.refreshCount(),e.tasksCollection.length&&e.$el.show().addClass("in"),e.listen(),"function"==typeof t.onFinish?t.onFinish():void 0}}(this),error:function(){return"function"==typeof t.onFinish?t.onFinish():void 0}}),this},e.prototype.renderBasic=function(){return this.$el.html(n()).hide(),this},e.prototype.listen=function(){return this.listenTo(this.tasksCollection,"add remove",this.refreshCount),this.listenTo(this.tasksCollection,"change:tagIds",function(t){return function(e,i){if(!((null!=i?i.indexOf(t.tagModel.id):void 0)>=0))return t.tasksCollection.remove(e),t.tagModel.refreshCache()}}(this)),this},e.prototype.refreshCount=function(){var t;return this.tagModel.set("tasksCount",this.tasksCollection.length),this.$(".tasks-count").text(this.tasksCollection.length),t=this.tasksCollection.length?"show":"hide",this.$el[t](),this},e}(a)},function(t,e){t.exports=function(t){var e="<h3>"+tb_i18n.get("task")+' ・ <span class="tasks-count">0</span></h3>';return e}},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=i(358),s=i(788),n=i(797),r=i(1630),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.viewName="TagListView",e.prototype.initialize=function(t){if(this.$el=t.$el,this.tagsCollection=t.tagsCollection,this.$el&&this.tagsCollection)return this.setupScroll(this.$el),this.render(),this.listen()},e.prototype.render=function(){return this.tagsCollection.each(function(t){return function(e){return t.renderTag(e)}}(this))},e.prototype.renderTag=function(t,e){var i;return null==e&&(e=!1),i=e?"prependTo":"appendTo",this.requestSubView(r,{tagModel:t}).$el[i](this.$el)},e.prototype.listen=function(){return this.listenTo(this.tagsCollection,"add",function(t){return this.renderTag(t,!0)})},e}(s),a.extend(o.prototype,n)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(788),r=i(1631),o=i(1635),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="TagListItemView",e.prototype.tagName="li",e.prototype.className="tag-item",e.prototype.initialize=function(t){if(this.tagModel=t.tagModel,this.tagModel)return this.render(),this.listen()},e.prototype.render=function(){var t;return t=this.tagModel.toJSON(),t.permissions=this.tagModel.hasPermissions("put","put.archive","del"),this.$el.html(o(t)),this.$el.attr("data-id",this.tagModel.id),this._initMenu()},e.prototype.listen=function(){return this.listenTo(this.tagModel,"change",this.render),this.listenTo(this.tagModel,"remove destroy",this.remove)},e.prototype._initMenu=function(){var t;return t=this.$(".tag-menu-toggler"),this.requestSubView(r,{$toggler:t,_projectId:this.tagModel.get("_projectId"),tagModel:this.tagModel,onShown:function(){return t.addClass("active")},onHidden:function(){return t.removeClass("active")}})},e}(s)},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;l=i(963),n=i(1632),r=i(1633),o=i(1634),a=i(813),s=i(401),t.exports=c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="TagMenuView",e.prototype.className="tag-menu-view",e.prototype.popoverTitle="",e.prototype.events={"click .archive-handler":"archiveTag","click .unarchive-handler":"unarchiveTag","click .edit-handler":"enterEditSubMenu","click .delete-handler":"enterDeleteSubMenu","click .delete-submit":"submitDelete","click .edit-submit":"submitEdit","click .tag-label":"changeLabel"},e.prototype.initialize=function(){return this.popoverTitle=tb_i18n.get("tag.menu.title"),e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){var t;return t=this.options.tagModel.toJSON(),t.permissions=this.options.tagModel.hasPermissions("put","put.archive","del"),this.$el.html(n(t)),this},e.prototype.archiveTag=function(){return this.options.tagModel.archive({success:function(t){return function(){return s.show({message:tb_i18n.get("archived.tag.success"),status:"success"}),t.hide()}}(this)}),this},e.prototype.unarchiveTag=function(){return this.options.tagModel.unarchive({success:function(t){return function(){return s.show({message:tb_i18n.get("unarchived.tag.success"),status:"success"}),t.hide()}}(this)}),this},e.prototype.changeLabel=function(t){var e;return e=$(t.currentTarget),e.addClass("active").siblings().removeClass("active"),this.color=e.data("color"),this},e.prototype.enterEditSubMenu=function(){return this.enterSubMenu(tb_i18n.get("tag.menu.edit.title"),function(t){return function(){var e;return e=t.options.tagModel.toJSON(),t.$el.html(o(e)),t.color=l.calculateColor(e.color,e.colorRGBA),t.$("[data-color='"+t.color+"']").addClass("active"),t.$editInput=t.$(".add-input")}}(this)),this},e.prototype.enterDeleteSubMenu=function(){return this.enterSubMenu(tb_i18n.get("tag.menu.delete.title"),function(t){return function(){return t.$el.html(r())}}(this)),this},e.prototype.submitEdit=function(){var t,e,i;if(e=null!=(i=this.$editInput)?i.val().trim():void 0)return t={name:e,color:l.transformToServerColor(this.color)},this.options.tagModel.save(t,{attrs:t,wait:!0,success:function(t){return function(){return t.hide()}}(this)}),this},e.prototype.submitDelete=function(){return this.options.tagModel.destroy({success:function(t){return function(){return t.hide()}}(this)}),this},e}(a)},function(t,e){t.exports=function(t){var e='<ul class="list"> ';return t.permissions.put&&(e+=' <li> <a class="edit-handler" data-gta="{action: \'edit tag\', control: \'More Menu\'}"> <span class="icon icon-pencil"></span>'+tb_i18n.get("tag.menu.edit.title")+" </a> </li> "),e+=" ",t.permissions.putArchive&&(e+=" <li> ",e+=t.isArchived?' <a class="unarchive-handler" data-gta="{action: \'unarchive tag\', control: \'More Menu\'}"> <span class="icon icon-archive"></span>'+tb_i18n.get("unarchive")+" </a> ":' <a class="archive-handler" data-gta="{action: \'archive tag\', control: \'More Menu\'}"> <span class="icon icon-archive"></span>'+tb_i18n.get("archive.tag")+" </a> ",e+=" </li> "),e+=" ",t.permissions.del&&(e+=' <li> <a class="delete-handler" data-gta="{action: \'delete tag\', control: \'More Menu\'}"> <span class="icon icon-trash"></span>'+tb_i18n.get("tag.menu.delete.title")+" </a> </li> "),e+="</ul>"}},function(t,e){t.exports=function(t){var e='<div class="delete-wrap"> <p>'+tb_i18n.get("tag.menu.confirm.delete")+'</p> <button class="btn btn-danger delete-submit">'+tb_i18n.get("delete")+"</button></div>";return e}},function(t,e,i){t.exports=function(t){var e="",n=i(963).COLORS;e+='<div class="edit-wrap"> <input class="add-input form-control" placeholder="'+tb_i18n.get("tag.creator.placeholder")+'" value="'+t.name+'"> <ul class="clearfix"> ';var r=n;if(r)for(var o,s=-1,a=r.length-1;s<a;)o=r[s+=1],e+=' <li class="tag-label" data-color="'+o+'" style="background-color: '+o+'"> <span class="icon icon-tick icon-white"></span> </li> ';return e+=" </ul> <button class=\"btn btn-primary edit-submit\" data-gta=\"{action: 'added content', type: 'tag', control: 'New Tag'}\"> "+tb_i18n.get("save")+" </button></div>"}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(963).calculateColor;return n+='<a class="tag tag-handler" data-gta="{action: \'open detail\', type: \'tag\', control: \'Tag List\'}"> <span class="tag-label" style="background-color: '+r(t.color,t.colorRGBA)+'"></span> <span class="tag-name">'+e(t.name)+"</span></a>",(t.permissions.put||t.permissions.putArchive||t.permissions.del)&&(n+='<a class="tag-menu-toggler icon icon-chevron-down hinted" data-title="'+tb_i18n.get("more.operations")+'"></a>'),n}},function(t,e){t.exports=function(t){var e='<header class="tag-header"> <b>'+tb_i18n.get("project.tags")+'</b> <a class="close-handler icon icon-remove" data-dismiss="modal"></a></header><section class="tag-body row-flex"> <aside class="tag-left"> <div class="left-header second-header"> ';return t.permissions.tagPost&&(e+=" <a class=\"tag-creator-handler link-add-handler\" data-gta=\"{action: 'add content', type: 'tag', control: 'New Tag'}\"> <span class=\"icon icon-circle-cross\"></span>"+tb_i18n.get("tag.view.create")+" </a> "),e+=' </div> <ul class="tag-list thin-scroll hack-render-bug"></ul> </aside> <section class="tag-right"> <div class="right-header second-header"></div> <div class="tag-content-wrap thin-scroll"></div> <div class="placeholder"> <h3>'+tb_i18n.get("tag.view.placeholder.title")+"</h3> <p> "+tb_i18n.get("tag.view.placeholder.info")+" ",t.isPublicServe&&(e+=" "+tb_i18n.get("tag.view.placeholder.infoLink")+" "),e+=" </p> </div> </section></section>"}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(963).calculateColor;return n+='<div class="tag-detail" data-id="'+t._id+'"> <span class="tag"> <span class="tag-label" style="background-color: '+r(t.color,t.colorRGBA)+'"></span> <span class="tag-name">'+e(t.name)+'</span> </span> <a class="tag-info ',t.tasksCount||(n+="disabled"),n+='" data-target=".tag-tasks-view">'+tb_i18n.get("tag.view.task.info",t.tasksCount)+"</a>"+tb_i18n.get("comma")+' <a class="tag-info ',t.eventsCount||(n+="disabled"),n+='" data-target=".tag-events-view">'+tb_i18n.get("tag.view.event.info",t.eventsCount)+"</a>"+tb_i18n.get("comma")+' <a class="tag-info ',t.postsCount||(n+="disabled"),n+='" data-target=".tag-posts-view">'+tb_i18n.get("tag.view.post.info",t.postsCount)+"</a>"+tb_i18n.get("comma")+' <a class="tag-info ',t.worksCount||(n+="disabled"),n+='" data-target=".tag-works-view">'+tb_i18n.get("tag.view.file.info",t.worksCount)+"</a>",(t.hasEntry||t.entriesCount>0)&&(n+=""+tb_i18n.get("comma")),n+=" ",(t.hasEntry||t.entriesCount>0)&&(n+=' <a class="tag-info ',t.entriesCount||(n+="disabled"),n+='" data-target=".tag-entries-view">'+tb_i18n.get("tag.view.entry.info",t.entriesCount)+"</a> "),n+="</div>"}},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(1598),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.className="activity-card common",e.prototype.parseData=function(t){var e,i,n,r;if(t.actionDes=this._actionI18NParse(t.action),n=t.content.project,i=n.name,e=n.description,r=n.visibility,!/archive/.test(t.action))return t.targetDes=i||e||r},e}(n)},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(678),s=i(697),a=i(786),o=i(1360),r=i(1598),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.className="activity-card common",e.prototype.parseData=function(t){return t.actionDes=this._actionI18NParse(t.action),t.targetDes=t.content.application.name},e.prototype.openDetail=function(){if(this.openable)return this.openItemDetailModal()},e.prototype.openItemDetailModal=function(){var t,e,i;return e=c.applications.get(this.data.content.application._id),t=c.applications.checkIsPremiumApp(e.get("name")),i=s.get(this.data._boundToObjectId),this.requestSubView(a).open(o,{type:e.get("name"),isPremium:t,projectModel:i})},e}(r)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(358),o=i(1598),r=i(1641),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.className="activity-card invite",e.prototype.render=function(){if(e.__super__.render.apply(this,arguments),null!=this.data.content.users&&this.renderMembers(),this.data.content.user)return this._initMemberCard(this.$el,this.data.content.user.id)},e.prototype.renderMembers=function(){var t;return this.$el.addClass("multi"),1===(null!=(t=this.data.content.users)?t.length:void 0)&&this.$el.addClass("single"),s.each(this.data.content.users,function(t){return function(e){return t.requestSubView(r,{data:t.data,memberData:e}).$el.appendTo(t.$innerWrapper)}}(this))},e.prototype.parseData=function(t){var e,i;return i=t.content.users||[t.content.user],e=s.pluck(i,"name"),t.actionDes=this._actionI18NParse(t.action,e.join(" , "))},e}(o)},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=i(788),o=i(699),s=i(1598),n=i(1642),t.exports=r=function(t){
function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.className="member-card-item",e.prototype.initialize=function(t){if(this.data=t.data,this.memberData=t.memberData,this.data||this.memberData)return this.render(),this._initMemberCard(this.$el,this.memberData._id)},e.prototype.render=function(){return this.$el.html(n(this.memberData))},e}(s)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="activity-member flex flex-vcenter"> <div class="avatar img-circle" style="background-image:url('+t.avatarUrl+')"> </div> <div class="activity-member-infos"> <div class="name">'+e(t.name)+'</div> <div class="email">'+e(t.email)+"</div> </div></div>";return i}},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(1598),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.className="activity-card common",e.prototype.parseData=function(t){var e;return t.actionDes=this._actionI18NParse(t.action),e=t.content.user||t.content.organization,t.targetDes=e.name},e}(n)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(1598),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.className="activity-card common",e.prototype.parseData=function(t){var e,i,n;return t.actionDes=this._actionI18NParse(t.action),e=t.content,i=e.team,n=e.user,t.targetDes=(i||n).name},e}(n)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(1598),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.className="activity-card common",e.prototype.initialize=function(){if(e.__super__.initialize.apply(this,arguments),this.openable)return this._initMemberCard(this.$el,this.data.creator._id)},e}(n)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(1598),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.className="activity-card common",e.prototype.parseData=function(t){return t.actionDes=this._actionI18NParse(t.action,t.content.team.name)},e}(n)},function(t,e){t.exports=function(t){var e='<div class="activities-content detail-content"> <div class="activities-header"> <header>'+tb_i18n.get("activity.panel.title.activities")+'</header> <a href="" class="close-handler icon icon-remove" data-dismiss="modal"></a> </div> ';return t.isJustToday||(e+=' <div class="activity-panel-filter-wrap row-flex"> <section> <a class="activity-panel-filter member-filter"> <span class="activity-panel-filter-title">'+tb_i18n.get("activity.panel.filter.member")+'</span> <i class="icon icon-caret"></i> <i class="icon icon-state-check"></i> </a> </section> <section> <a class="activity-panel-filter type-filter"> <span class="activity-panel-filter-title">'+tb_i18n.get("activity.panel.filter.type")+'</span> <i class="icon icon-caret"></i> <i class="icon icon-state-check"></i> </a> </section> <section> <a class="activity-panel-filter date-filter"> <span class="activity-panel-filter-title">'+tb_i18n.get("activity.panel.filter.date")+'</span> <i class="icon icon-caret"></i> <i class="icon icon-state-check"></i> </a> </section> </div> '),e+=' <div class="activity-panel-activities-body"> </div> ',t.isJustToday||(e+=' <div class="activity-panel-activities-placeholder hide"> <span class="icon icon-search-warning"></span> <p>'+tb_i18n.get("search.no.content")+"</p> </div> "),e+="</div>"}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t.dataList;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li class="activity-filter-item menu-item ',r.selected&&(i+="selected"),i+='" data-id="'+r._id+'"> <a><span class="icon '+r.icon+'"></span>'+e(r.title)+"</a></li>";return i}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t.dataList;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li class="activity-filter-item menu-item ',r.selected&&(i+="selected"),i+='" data-id="'+r._id+'"> ',i+="all"===r._id?' <a><span class="icon icon-users"></span>'+e(r.title)+"</a> ":' <a><span class="avatar img-circle img-24 pull-left" style="background:url('+e(r.avatarUrl)+')"></span>'+e(r.name)+"</a> ",i+="</li>";return i}},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;l=i(358),p=i(678),a=i(677),c=i(788),s=i(797),o=i(696),n=i(1582),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="ActivityProjectAllView",e.prototype.className="activity-project-all object-modal-view modal-dialog thin-scroll fixed",e.prototype.currentView=null,e.prototype.initialize=function(t){var e;if(null==t&&(t={}),this.projectModel=t.projectModel,(e=t._projectId)&&!this.projectModel&&(this.projectModel=o.getOne(0,e)),!this.projectModel)throw new Error(this.viewName+" need dependency projectModel");return this.options=t,this.renderBasic()},e.prototype.loadMore=function(t){var e;return null!=(e=this.activitiesView)&&e.loadMore(),"function"==typeof t?t():void 0},e.prototype.renderBasic=function(){return this.scrollToTop(),this.activitiesView=this.requestSubView(n,this.options),this.$el.html(this.activitiesView.$el),this.setupScroll(this.$el),this.setupLoadMore(10)},e.prototype.scrollToTop=function(){return this.slideTo(null,!0),this},e}(c),l.extend(r.prototype,s),t.exports=r},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;p=i(788),s=i(429),u=i(786),o=i(1079),a=i(696),c=i(1551),l=i(1559),r=i(1652),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.viewName="ActivityDatas",e.prototype.className="activity-card-datas activity-card",e.prototype.events={"click .activity-link-unassign":"openUnassignedTasks","click .activity-link-today":"openTodayTasks"},e.prototype.initialize=function(t){if(this._projectId=t._projectId)return this.projectModel=a.findOne(0,this._projectId),this.load().then(function(t){return function(){return t.renderBasic(),t.listen()}}(this))["catch"](function(t){return console.error(t)})},e.prototype.load=function(){return Promise.all([new Promise(function(t){return function(e,i){return o.fetch(t._projectId,{url:"projects/"+t._projectId+"/events",silent:!0,attrs:{startDate:s().startOf("day").toISOString()},success:function(i){return t.todayEventsCollection=i,e()},error:i})}}(this)),new Promise(function(t){return function(e,i){return t.projectModel.getStatistic({success:e,error:i})}}(this))]).then(function(t){return function(){return t.hideLoadingIndicator()}}(this))},e.prototype.renderBasic=function(){var t,e;return t=this.projectModel.get("task"),e=t.today+this.getEvents().length,this.$el.html(r({unassignedtasksLength:t.unassigned,todayDatasLength:e}))},e.prototype.listen=function(){return this.listenTo(this.todayEventsCollection,"remove add change",this.renderBasic)},e.prototype.getEvents=function(){var t,e;return e=s(),t=this.todayEventsCollection.filter(function(t){return e.isSame(t.get("startDate"),"day")})},e.prototype.openTodayTasks=function(){return this.requestSubView(u).open(c,{_projectId:this._projectId})},e.prototype.openUnassignedTasks=function(){return this.requestSubView(u).open(l,{_projectId:this._projectId})},e}(p)},function(t,e){t.exports=function(t){var e='<header class="activity-card-header"> <i class="icon icon-alert-clock"></i> <span class="activity-card-title">'+tb_i18n.get("activity.card.project.title")+'</span></header><div class="data-statistics"> <div class="activity-unassignedtasks activity-link-unassign data-handler" data-gta="{action: \'switch smart task group\', type: \'unassigned\', control: \'Side Menu\'}"> <div class="activity-unassignedtasks-title">'+tb_i18n.get("activity.card.unassigned.title")+'</div> <a class="activity-link"> <span class="unassignedtasks-number">'+t.unassignedtasksLength+"</span> </a> </div> <div class=\"activity-today activity-link-today data-handler\" data-gta=\"{action: 'switch smart task group', type: 'today', control: 'Side Menu'}\"> <div class=\"activity-today-title\">"+tb_i18n.get("activity.card.today.title")+'</div> <a class="activity-link"> <span class="todayDatas-number">'+t.todayDatasLength+"</span> </a> </div></div>";return e}},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=i(788),o=i(696),s=i(1654),r=i(1656),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.viewName="ActivityCardTable",e.prototype.className="activity-card-table activity-card",e.prototype.initialize=function(t){var e;if(e=t._projectId)return this.projectModel=o.findOne(0,e),this.renderBasic(),this.listen(),this},e.prototype.listen=function(){return this.listenTo(this.projectModel,"change",this.renderBasic)},e.prototype.renderBasic=function(){var t;if(t=this.projectModel.get("task"),this.$el.html(r(t)),this.$chart=this.$("#chart"),t.total)return this.renderTasksChart()},e.prototype.renderTasksChart=function(){return this.showLoadingIndicator(this.$chart),this.$chart.html(this.requestSubView(s,{projectModel:this.projectModel}).$el)},e}(a)},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;c=i(358),l=i(678),o=i(429),n=i(1655),a=i(788),r=function(){function t(t,e){var i,n,r,o,s,a,l;for(this.projectModel=t,this.options=e,s=c.clone(this.projectModel.get("days"))||[],this.dataList={total:[],done:[],todo:[]},l=0,i=0,s.pop(),r=0,o=s.length;r<o;r++)n=s[r],l+=n[0],i+=n[1],this.dataList.total.push(l),this.dataList.done.push(i),this.dataList.todo.push(l-i);a=this.projectModel.get("task"),this.dataList.total.push(a.total),this.dataList.done.push(a.done),this.dataList.todo.push(a.total-a.done)}return t}(),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="TasksChartView",e.prototype.className="tasks-chart-view",e.prototype.events={"mousemove svg":"showHint","mouseout svg":"resetHint","mousemove .chart-hint":"showHint"},e.prototype.defaults={width:266,height:95,count:14,marginTop:20,marginBottom:0,marginLeft:0,marginRight:0,paddingRight:10,lineWidth:1,lineColorA:"#03A9F4",areaColorA:"#CDEEFD",lineColorB:"#259B24",areaColorB:"#D1EBD0",pointCircle:8,pointRadius:3},e.prototype.initialize=function(t){if(t.projectModel)return this.projectModel=t.projectModel,this.chartDataProcess(),this.width=this.defaults.width,this.height=this.defaults.height,this.dataMax=c.max([c.max(this.setA),c.max(this.setB)]),this.marginTop=this.defaults.marginTop,this.marginBottom=this.defaults.marginBottom,this.marginLeft=this.defaults.marginLeft,this.marginRight=this.defaults.marginRight,this.paddingRight=this.defaults.paddingRight,this.count=this.defaults.count,this.setA.length>this.defaults.count&&(this.count=this.setA.length),this.dataLength=this.setA.length,this.lineWidth=this.defaults.lineWidth,this.heightLimit=this.height-this.marginTop-this.marginBottom,this.widthLimit=this.width-this.marginLeft-this.marginRight-this.paddingRight,this.axisUnit=~~(this.widthLimit/(this.count-1)),this.lineSetGen(),this.graphPointsGen(),this.originPointPosGen(),this.render(),this.setTooltip(this.dataLength-1),this},e.prototype.chartDataProcess=function(){var t,e,i,n,o,s,a,l,p;for(this.chartData=new r(this.projectModel),t=this.chartData.dataList,this.setA=t.total.slice(-14),this.setB=t.done.slice(-14),this.setAReal=t.todo.slice(-14),this.setBReal=t.done.slice(-14),1===this.setA.length&&(this.setA.unshift(0),this.setB.unshift(0),this.setAReal.unshift(0),this.setBReal.unshift(0)),p=c.max(this.setAReal),e=c.min(this.setBReal),l=e-p,l<0&&(l=0),a=this.setA,i=o=0,s=a.length;o<s;i=++o)n=a[i],this.setA[i]=n-l,this.setB[i]=this.setB[i]-l;return this},e.prototype.render=function(){return this.$el.html(n({width:this.width,height:this.height,linePointsStrA:this.linePointsStrA,lineColorA:this.defaults.lineColorA,lineWidth:this.lineWidth,areaPointsStrA:this.areaPointsStrA,areaColorA:this.defaults.areaColorA,linePointsStrB:this.linePointsStrB,lineColorB:this.defaults.lineColorB,areaPointsStrB:this.areaPointsStrB,areaColorB:this.defaults.areaColorB,originXA:this.originX,originYA:this.originYA,originXB:this.originX,originYB:this.originYB,pointCircle:this.defaults.pointCircle,pointRadius:this.defaults.pointRadius})),this.tooltip=this.$(".chart-hint")[0],this},e.prototype.yScale=function(t){return 0===this.dataMax?0:this.heightLimit*t/this.dataMax+this.marginBottom+this.lineWidth/2},e.prototype.lineSetGen=function(){var t,e,i,n,r,o,s,a;for(this.lineSetA=new Array(this.setA.length),this.lineSetB=new Array(this.setA.length),s=this.setA,t=i=0,r=s.length;i<r;t=++i)e=s[t],this.lineSetA[t]=parseInt(this.height-this.yScale(e));for(a=this.setB,t=n=0,o=a.length;n<o;t=++n)e=a[t],this.lineSetB[t]=parseInt(this.height-this.yScale(e));return this},e.prototype.graphPointsGen=function(){var t,e,i,n,r,o,s,a,c,l,p;for(c=this.height-this.marginBottom+this.lineWidth/2,this.linePointsStrA="",this.areaPointsStrA="",l=this.lineSetA,e=n=0,o=l.length;n<o;e=++n)i=l[e],e===this.count-1?(a=this.width-this.marginRight-this.paddingRight+","+i+" "+(this.width-this.marginRight+","+i),t=this.width-this.marginRight-this.paddingRight+","+(i+this.lineWidth/2)+" "):(a=this.axisUnit*e+this.marginLeft+","+i+" ",t=this.axisUnit*e+this.marginLeft+","+(i+this.lineWidth/2)+" "),this.linePointsStrA+=a,this.areaPointsStrA+=t;for(this.dataLength<this.count&&(this.linePointsStrA+=this.width-this.marginRight+","+this.lineSetA.slice(-1)[0]),this.dataLength===this.count?this.areaPointsStrA+=this.width-this.marginRight-this.paddingRight+","+c+" "+(this.marginLeft+","+c+" "+this.marginLeft+","+this.lineSetA[0]):this.areaPointsStrA+=""+(this.axisUnit*(this.dataLength-1)+this.marginLeft)+(","+c+" "+this.marginLeft+","+c+" "+this.marginLeft+",")+(""+this.lineSetA[0]),this.linePointsStrA=this.linePointsStrA.trim(),this.areaPointsStrA=this.areaPointsStrA.trim(),this.linePointsStrB="",this.areaPointsStrB="",p=this.lineSetB,e=r=0,s=p.length;r<s;e=++r)i=p[e],e===this.count-1?(a=this.width-this.marginRight-this.paddingRight+","+i+" ",t=this.width-this.marginRight-this.paddingRight+","+(i+this.lineWidth/2)+" "):(a=this.axisUnit*e+this.marginLeft+","+i+" ",t=this.axisUnit*e+this.marginLeft+","+(i+this.lineWidth/2)+" "),this.linePointsStrB+=a,this.areaPointsStrB+=t;return this.dataLength===this.count?this.areaPointsStrB+=this.width-this.marginRight-this.paddingRight+","+c+" "+(this.marginLeft+","+c+" "+this.marginLeft+","+this.lineSetB[0]):this.areaPointsStrB+=""+(this.axisUnit*(this.dataLength-1)+this.marginLeft)+(","+c+" "+this.marginLeft+","+c+" "+this.marginLeft+",")+(""+this.lineSetB[0]),this.linePointsStrB=this.linePointsStrB.trim(),this},e.prototype.originPointPosGen=function(){return this.dataLength===this.count?this.originX=this.originX=this.width-this.marginRight-this.paddingRight:this.originX=this.originX=this.axisUnit*(this.dataLength-1)+this.marginLeft,this.originYA=this.lineSetA.slice(-1)[0],this.originYB=this.lineSetB.slice(-1)[0],this},e.prototype.showHint=function(t){var e,i,n,r,o,s,a,c,l,p;if(c=this.$("svg").offset(),e=.5+(t.pageX-c.left-this.marginLeft)/this.axisUnit,i=~~e,p=c.top+this.marginTop,l=c.top+this.height-this.marginBottom,r=c.left+this.marginLeft,o=c.left+this.width-this.marginRight,!(t.pageY<p||t.pageY>l||t.pageX<r||t.pageX>o))return i<this.dataLength-1?(n=this.axisUnit*i+this.marginLeft,i===this.count-1&&(n=this.width-this.marginRight),s={cx:n,cy:this.lineSetA[i]},a={cx:n,cy:this.lineSetB[i]},this.setPointsHint(s,a),this.setTooltip(e)):this.resetHint()},e.prototype.resetHint=function(){return this.setPointsHint(),this.setTooltip(this.dataLength-1)},e.prototype.setTooltip=function(t){var e,i,n,r,s,a,c,l,p;return p=.3*this.height,s=t>this.count/2?(t-this.count/3)*this.axisUnit:t*this.axisUnit,e=~~t,l=this.setAReal[e],r=this.setBReal[e],a=new o,n=this.dataLength-1-e,a.subtract(n,"day"),i=a.calendar(),c="<p>"+i+"</p> <p>"+l+" "+tb_i18n.get("activity.card.table.todoTasks")+"</p> <p>"+r+" "+tb_i18n.get("activity.card.table.doneTasks")+"</p>",this.$(".chart-hint").html(c),this.tooltip.style.top=p+"px",this.tooltip.style.left=s+"px",this.tooltip.style.display="inline-block",this},e.prototype.setPointsHint=function(t,e){return t||(t={cx:this.originX,cy:this.originYA}),e||(e={cx:this.originX,cy:this.originYB}),this.$("#pointA circle:first").attr({cx:t.cx,cy:t.cy}),this.$("#pointA circle:last").attr({cx:t.cx,cy:t.cy}),this.$("#pointB circle:first").attr({cx:e.cx,cy:e.cy}),this.$("#pointB circle:last").attr({cx:e.cx,cy:e.cy}),this},e}(a)},function(t,e){t.exports=function(t){var e='<svg width="'+t.width+'" height="'+t.height+'"> <g class="main-graph"> <polyline points="'+t.linePointsStrA+'" style="fill:none;stroke:'+t.lineColorA+";stroke-width:"+t.lineWidth+'"> </polyline> <polygon points="'+t.areaPointsStrA+'" style="fill:'+t.areaColorA+';"> </polygon> <polyline points="'+t.linePointsStrB+'" style="fill:none;stroke:'+t.lineColorB+";stroke-width:"+t.lineWidth+'"> </polyline> <polygon points="'+t.areaPointsStrB+'" style="fill:'+t.areaColorB+';"> </polygon> </g> <g class="point show" id="pointA"> <circle cx="'+t.originXA+'" cy="'+t.originYA+'" r="'+t.pointCircle+'" fill="'+t.lineColorA+'" fill-opacity="0.2"></circle> <circle cx="'+t.originXA+'" cy="'+t.originYA+'" r="'+t.pointRadius+'" fill="'+t.lineColorA+'" stroke="white" stroke-width="'+t.lineWidth+'"></circle> </g> <g class="point show" id="pointB"> <circle cx="'+t.originXB+'" cy="'+t.originYB+'" r="'+t.pointCircle+'" fill="'+t.lineColorB+'" fill-opacity="0.2"></circle> <circle cx="'+t.originXB+'" cy="'+t.originYB+'" r="'+t.pointRadius+'" fill="'+t.lineColorB+'" stroke="white" stroke-width="'+t.lineWidth+'"></circle> </g></svg><div class="chart-hint"></div>';return e}},function(t,e){t.exports=function(t){var e='<header class="activity-card-header"> <span class="activity-card-title">'+tb_i18n.get("activity.card.table.title")+'</span></header><section class="activity-card-body"> <div id="chart" class="activity-table-chart"> ';return t.total||(e+=' <div class="activity-table-placeholder-tips">'+tb_i18n.get("activity.card.table.placeholder")+'</div> <svg width="100" height="60" class="activity-table-placeholder"> <rect width="10" height="12" x="30" y="44"></rect> <rect width="10" height="24" x="44" y="32"></rect> <rect width="10" height="36" x="58" y="20"></rect> </svg> '),e+=" </div></section>"}},function(t,e){t.exports=function(t){var e='<div class="project-menus"> <ul class="list activities-panel-menu-list"> <li> <a class="app" data-app="settings" data-gta="{action: \'open project settings\', control: \'Side Menu\'}"> <span class="icon icon-cog"></span>'+tb_i18n.get("project.settings")+' </a> </li> <li> <a class="project-tags-handler" data-gta="{action: \'open project tags\', control: \'Side Menu\'}"> <span class="icon icon-tag"></span>'+tb_i18n.get("project.tags")+" </a> </li> ";return t.isGhost||(e+=' <li> <a class="project-powerup-handler" data-gta="{action: \'show power-ups\', control: \'Side Menu\'}"> <span class="icon icon-config"></span>'+tb_i18n.get("activity.panel.menu.config")+" </a> </li> "),e+=' <li> <a class="activity-panel-all-plugin switch-handler" data-type="plugins"> <i class="icon icon-more"></i>'+tb_i18n.get("activity.card.body.checkMore")+' </a> </li> </ul></div><div class="activity-panel-statistics"></div><div class="activity-panel-card-table"></div><ul class="list activity-panel-activities-list"> <li class="activity-panel-activities-title"> <div class="project-activies-title"> <i class="icon icon-align-left"></i> <span class="activity-card-title">'+tb_i18n.get("activity.panel.title.activities")+'</span> </div> </li> <li class="activity-panel-activities-wrap"></li> <li> <a class="activity-panel-all-footer project-activies-handler" data-type="activities"> <i class="icon icon-more"></i>'+tb_i18n.get("activity.panel.checkAll")+" </a> </li></ul>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m=function(t,e){function i(){this.constructor=t}for(var n in e)f.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},f={}.hasOwnProperty;h=i(678),d=i(679),p=i(788),u=i(786),a=i(684),c=i(696),l=i(994),s=i(1398),r=i(1659),o=i(1662),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.viewName="ActivityPanelPluginsView",e.prototype.className="activity-panel-plugins",e.prototype.events={"click .project-archives-handler":"showProjectArchives","click .project-calendar-handler":"showICalendar","click [data-type=dump]":"getDumpTasks"},e.prototype.initialize=function(t){return this.options=t,this._projectId=t._projectId,this.projectModel=c.getOne(0,this._projectId),this.organizationsCollection=a.get(0),this.tasklistsCollection=l.get(this._projectId),this.listen(),this.renderBasic()},e.prototype.listen=function(){return this.listenTo(this.projectModel,"change:applications",function(t){if(this.projectModel.isAppChanged("tasks"))return this.renderBasic()}),this.listenTo(this.tasklistsCollection,"add remove",this.renderBasic)},e.prototype.renderBasic=function(){var t,e,i;return e=this.projectModel.get("_organizationId"),t={roleScope:this.projectModel.getRoleScope(),visibility:this.projectModel.get("visibility"),permissions:this.projectModel.hasPermissions("get.subscribe","put.info","put.fork"),isGhost:h.user.get("isGhost")},t.permissions.organizationGetInfo=null!=(i=this.organizationsCollection.get(e))?i.hasPermission("get.info"):void 0,t.permissions.dumpTasks=this.tasklistsCollection.at(0).hasPermission("get.dumpTasks"),t.isSingleTasklist=1===this.tasklistsCollection.length,t.isTasksEnabled=this.projectModel.isAppEnabled("tasks"),this.$el.html(o(t)),this.triggerHook("render"),this},e.prototype.showICalendar=function(){return this.projectModel.fetchCallink({success:function(t){return function(e){return t.requestSubView(u).open(s,{title:t.projectModel.get("name"),webcal:e.taskCalLink})}}(this)}),this},e.prototype.showProjectArchives=function(){return this.requestSubView(u).open(r,{_projectId:this._projectId}),this},e.prototype.getDumpTasks=function(){var t;return 1===this.tasklistsCollection.length&&(t=d.API_HOST+"/tasklists/"+(this.tasklistsCollection.at(0).id+"/export"),t&&$.fileDownload(t)),this},e}(p)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C=function(t,e){function i(){this.constructor=t}for(var n in e)x.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},x={}.hasOwnProperty,S=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};w=i(358),M=i(678),l=i(401),a=i(998),d=i(696),y=i(994),f=i(992),v=i(803),r=i(1660),c=i(1661),h=i(797),k=i(788),n=i(1186),s=i(1185),m=i(1024),b=i(1188),u=i(1019),g=i(818),T=function(){return[{type:"task",label:"task",title:tb_i18n.get("tasks"),icon:"icon-board"},{type:"post",label:"post",title:tb_i18n.get("post"),icon:"icon-wall"},{type:"work",label:"file",title:tb_i18n.get("files"),icon:"icon-file"},{type:"event",label:"event",title:tb_i18n.get("events"),icon:"icon-calendar"},{type:"entry",label:"entry",title:tb_i18n.get("entries"),icon:"icon-bookkeeping-logo"},{type:"tag",label:"tag",title:tb_i18n.get("tags"),icon:"icon-tag"},{type:"collection",label:"folder",title:tb_i18n.get("collection"),icon:"icon-folder"},{type:"tasklist",label:"task group",title:tb_i18n.get("tasklist"),icon:"icon-ul"}]},j=function(){return{task:{icon:"icon-board",deleteTitle:tb_i18n.get("delete.task"),confirmDelete:tb_i18n.get("task.menu.confirm.delete"),successMessage:tb_i18n.get("unarchived.task.success")},post:{icon:"icon-wall",deleteTitle:tb_i18n.get("delete.post"),confirmDelete:tb_i18n.get("post.menu.confirm.delete"),successMessage:tb_i18n.get("unarchived.post.success")},event:{icon:"icon-calendar",deleteTitle:tb_i18n.get("delete.event"),confirmDelete:tb_i18n.get("event.menu.confirm.delete"),successMessage:tb_i18n.get("unarchived.event.success")},work:{icon:"icon-file",deleteTitle:tb_i18n.get("delete.file"),confirmDelete:tb_i18n.get("previewer.menu.confirm.delete"),successMessage:tb_i18n.get("unarchived.file.success")},entry:{icon:"icon-bookkeeping-logo",deleteTitle:tb_i18n.get("entry.menu.action.delete"),confirmDelete:tb_i18n.get("entry.menu.confirm.delete"),successMessage:tb_i18n.get("entry.archives.success.unarchive")},tag:{icon:"icon-tag",deleteTitle:tb_i18n.get("delete.tag"),confirmDelete:tb_i18n.get("tag.menu.confirm.delete"),successMessage:tb_i18n.get("unarchived.tag.success")},collection:{icon:"icon-folder",deleteTitle:tb_i18n.get("delete.folder"),confirmDelete:tb_i18n.get("collection.menu.confirm.delete"),successMessage:tb_i18n.get("unarchived.folder.success")},tasklist:{icon:"icon-ul",deleteTitle:tb_i18n.get("delete.taskgroup"),confirmDelete:tb_i18n.get("tasklist.menu.confirm.delete"),successMessage:tb_i18n.get("unarchived.taskgroup.success")}}},_={posts:"post",files:"work",events:"event",bookkeeping:"entry",tasks:"task"},p=["task","post","event","entry","work"],o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return C(e,t),e.prototype.viewName="ArchiveView",e.prototype.className="archive-view modal-dialog col-flex flex-fill",e.prototype.events={"click .archive-item":"switchArchive","click .unarchive-handler":"openUnarchiveMenu","click .remove-handler":"deleteModelObject","click .archive-body":"openDetail"},e.prototype.initialize=function(t){var e;return this._projectId=t._projectId,t.appName||(t.appName=M.APP.currentAppName),this.currentArchive=(e=_[t.appName])?e:_.tasks,this.projectModel=d.getOne(0,this._projectId),this.renderBasic(),this.reset(),this},e.prototype.reset=function(){return this.refreshSelected(),this.load({success:function(t){return function(){return t.listen(),t.renderArchives(),t.setupScroll(t.$archiveList),t.setupLoadMore(10)}}(this)})},e.prototype.load=function(t){return new a(null,{boundToObjectType:"",_boundToObjectId:this._projectId+"_"+this.currentArchive,_projectId:this._projectId,attrs:{objectType:this.currentArchive}}).fetch({attrs:{objectType:this.currentArchive},beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$archiveList)}}(this),success:function(e){return function(i){if(e.$el)return e.hideLoadingIndicator({animated:!1}),e.archivesCollection=i,null!=t&&"function"==typeof t.success?t.success():void 0}}(this)}),this},e.prototype.loadMore=function(t){var e;return null!=(e=this.archivesCollection)&&e.loadMore({attrs:{objectType:this.currentArchive},beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$archiveList)}}(this),success:function(e){return function(i,n){if(e.$el)return e.hideLoadingIndicator({animated:!0}),e.archivesCollection.hasMore?"function"==typeof t?t():void 0:e.showEndPoint(e.$archiveList)}}(this)}),this},e.prototype.listen=function(){return this.listenTo(this.archivesCollection,"add",this.renderArchive),this.listenTo(this.archivesCollection,"remove destroy",this.removeArchive),this},e.prototype.renderBasic=function(){var t;return t={archives:T()},this.$el.html(c(t)),this.$archiveList=this.$(".archive-list"),this},e.prototype.renderArchives=function(){return this.$archiveList.empty(),this.archivesCollection.each(function(t){return function(e){return t.renderArchive(e)}}(this)),this},e.prototype.renderArchive=function(t){var e,i,n,o;return n=j(),o=t.toJSON(),o.permissions=t.hasPermissions("put.archive","del"),o=w.extend(o,n[o.boundToObjectType]),e=$(r(o)),i=this.$(".archive[data-id="+o._id+"]"),i.length?i.replaceWith(e):this.$archiveList.append(e),this.renderTaskIdLabel(e.find(".task-id-placeholder"),o.uniqueId),e.find("time").timesince(),this},e.prototype.renderTaskIdLabel=function(t,e){return this.requestSubView(g,{projectModel:this.projectModel,uniqueId:e}).bind(t)},e.prototype.openDetail=function(t){var e,i,n,r,o,s,a;return n=j(),e=$(t.currentTarget).closest(".archive"),r=this.archivesCollection.get(e.data("id")),i=r.toJSON(),s=e.data("id").split("_archived")[0],s&&"undefined"!==s?(a={},a.hasLink=!1,e.is(".comment-handler")&&(a.where="activity-comment"),o=i.boundToObjectType,S.call(p,o)>=0&&M.APP.openObjectPreviewer(s,o,a)):this.openError(tb_i18n.get(i.boundToObjectType)),this},e.prototype.refreshSelected=function(){var t;return t=this.$(".archive-item[data-type="+this.currentArchive+"]"),t.addClass("selected").siblings().removeClass("selected"),this},e.prototype.removeArchive=function(t){return this.$archiveList.find(".archive[data-id="+t.id+"]").remove(),this},e.prototype.switchArchive=function(t){var e;return e=t.currentTarget?$(t.currentTarget):t,this.currentArchive=e.data("type"),this.reset(),this},e.prototype.openUnarchiveMenu=function(t){var e,i,n,r,o,s,a,c;if(null!=this.unarchiveMenuView)return this.unarchiveMenuView.remove(),void(this.unarchiveMenuView=null);switch(r=j(),e=$(t.currentTarget).closest(".archive").addClass("active"),o=this.archivesCollection.get(e.data("id")),n=o.toJSON(),a=r[n.boundToObjectType],i=$(t.currentTarget),c={$toggler:i,$target:e,projectModel:this.projectModel,currentModel:o,msg:a.successMessage,type:"work"===n.boundToObjectType?"file":void 0,onHidden:function(){return e.removeClass("active")}},s=function(t){return function(){return c=t.assembleObjectUnarchiveOptions(o,a,c),t.unarchiveMenuView=t.requestSubView(b,c).show()}}(this),n.boundToObjectType){case"task":return c=this.assembleTaskUnarchiveOptions(o,a,c),Promise.all([new Promise(function(t,e){return v.fetch(o.get("_boundToObjectId"),{success:t,error:e})}),new Promise(function(t){return function(e,i){return y.fetch(t._projectId,{success:e,error:i})}}(this))]).then(function(t){return function(e){var i,n;return i=e[0],n=e[1],f.fetch(i.get("_tasklistId"),{success:function(e){var r,o;return o=n.get(i.get("_tasklistId")),r=e.get(i.get("_stageId")),w.extend(c,{tasklistModel:o,stageModel:r}),t.unarchiveMenuView=t.requestSubView(m,c).show()}})}}(this));case"tasklist":return this.projectModel.isAppEnabled("tasklist")?s():this.unarchiveMenuView=this.requestSubView(u,{$toggler:i,
title:tb_i18n.get("unarchive"),description:tb_i18n.get("unarchived.tasklist.tip")}).show();default:return s()}},e.prototype.assembleTaskUnarchiveOptions=function(t,e,i){return w.extend(i,{isFrozenProject:!0,success:function(i){return function(n){return i.stageModel=n.stageModel,t.unarchiveObject({_stageId:i.stageModel.id?i.stageModel.id:void 0,success:function(){return l.show({message:e.successMessage,status:"success"})}})}}(this)})},e.prototype.assembleObjectUnarchiveOptions=function(t,e,i){return w.extend(i,{title:tb_i18n.get("unarchive"),success:function(){}})},e.prototype.deleteModelObject=function(t){var e,i,r,o,s,a;return o=j(),i=$(t.currentTarget),e=$(t.currentTarget).closest(".archive").addClass("active"),s=this.archivesCollection.get(e.data("id")),r=s.toJSON(),a=o[r.boundToObjectType],e.data("bs.popover")||this.requestSubView(n,{$toggler:i,title:a.deleteTitle,confirmDelete:a.confirmDelete,currentModel:s,success:function(){return i.addClass("active")},onHidden:function(){return e.removeClass("active")}}).show(),this},e}(k),w.extend(o.prototype,h),t.exports=o},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li class="archive ';return(t.permissions.putArchive||t.permissions.del)&&(i+="editable"),i+='" data-id="'+t._id+'"> <div class="archive-body clearfix" data-type="'+t.boundToObjectType+"\" data-gta=\"{action: 'show archived content', type: '"+t.boundToObjectType+'\', control: \'Side Menu\'}"> <p class="archive-content flex-horiz"> <span class="icon '+t.icon+' flex-static"></span> <span class="title hinted auto-hint" data-title="'+t.subTitle+'">'+e(t.subTitle)+'</span> <span class="task-id-placeholder flex-static"></span> </p> </div> <div class="time-stamp"> <time class="muted" datetime="'+t.created+'"></time> </div> ',(t.permissions.putArchive||t.permissions.del)&&(i+=' <div class="archive-handler-set"> ',t.permissions.putArchive&&(i+=" <a class=\"unarchive-handler\" data-gta=\"{action: 'unarchive content', type: '"+t.boundToObjectType+'\', control: \'Side Menu\'}"> <span class="icon icon-putback"></span> <span class="archived-button archived-cancel">'+tb_i18n.get("unarchive")+"</span> </a> "),i+=" ",t.permissions.del&&(i+=" <a class=\"remove-handler\" data-gta=\"{action: 'delete archived content', type: '"+t.boundToObjectType+'\', control: \'Side Menu\'}"> <span class="icon icon-trash"></span> <span class="archived-button archived-delete">'+t.deleteTitle+"</span> </a> "),i+=" </div> "),i+="</li>"}},function(t,e){t.exports=function(t){var e='<header class="modal-header"> <h4 class="modal-title"> '+tb_i18n.get("archive.title")+' </h4> <a class="modal-close icon icon-remove" data-dismiss="modal"></a></header><section class="modal-body flex-horiz"> <ul class="archive-menu thin-scroll flex-static"> ',i=t.archives;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=" ",n.hasLine&&(e+=' <li class="divider"></li> '),e+=' <li class="archive-item" data-type="'+n.type+'" data-gta="event" data-label="show '+n.label+' archives"> <span class="icon '+n.icon+'"></span> <span class="archive-title">'+n.title+"</span> </li> ";return e+=' </ul> <ul class="archive-list thin-scroll flex-fill"></ul></section>'}},function(t,e){t.exports=function(t){var e='<ul class="list plugins clearfix"> ';return t.roleScope>=0&&(e+=" <li> <a class=\"project-archives-handler\" data-gta=\"{action: 'show archived content', type: 'content menu', control: 'Side Menu'}\"> <span class=\"icon icon-archive\"></span>"+tb_i18n.get("activity.panel.menu.checkArchive")+" </a> </li> "),e+=" ",t.isGhost||!t.permissions.putFork&&"all"!=t.visibility||(e+=' <li class="plugin"> <a class="copy-project-handler switch-handler" data-type="copy" data-gta="event" data-label="copy project"> <span class="icon icon-copy"></span>'+tb_i18n.get("activity.panel.menu.copy")+" </a> </li> "),e+=" ","all"==t.visibility&&(e+=' <li class="plugin"> <a class="share-project-handler switch-handler" data-type="share" data-gta="event" data-label="share project"> <span class="icon icon-share"></span>'+tb_i18n.get("activity.panel.menu.share")+" </a> </li> "),e+=" ",t._organizationId&&t.permissions.organizationGetInfo&&(e+=' <li class="plugin"> <a class="enter-organization-handler" data-gta="event" data-label="enter organization from project"> <span class="icon icon-users"></span>'+tb_i18n.get("activity.panel.menu.enterOrg")+" </a> </li> "),e+=" ",t.permissions.getSubscribe&&(e+=' <li class="plugin"> <a class="project-calendar-handler" data-gta="{action: \'subscribe to calendar\', type: \'task\', control: \'Side Menu\'}"> <span class="icon icon-calendar"></span>'+tb_i18n.get("activity.panel.menu.calendar")+" </a> </li> "),e+=" ",t.permissions.dumpTasks&&t.isTasksEnabled&&(e+=' <li class="plugin ',t.isSingleTasklist||(e+="switch-handler"),e+='" data-type="dump"> <a data-gta="{action: \'downlaod tasklist\', type: \'tasklist\', control: \'Side Menu\'}"> <span class="icon icon-move-task"></span> '+tb_i18n.get("activity.panel.menu.export.tasks")+" </a> </li> "),e+="</ul>"}},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(678),o=i(788),r=i(1664),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="ActivityPanelShareView",e.prototype.className="activity-panel-share",e.prototype.initialize=function(t){return this.projectModel=t.projectModel,this.renderBasic()},e.prototype.renderBasic=function(){var t,e,i,n,o,a,c;return a=s.user.get("name"),o=this.projectModel.get("name"),n=this.projectModel.get("shortLink"),i=this.projectModel.get("description"),e=i?tb_i18n.get("project.menu.mail.content.desc",a,o,i,n):tb_i18n.get("project.menu.mail.content",a,o,n),c=i?tb_i18n.get("project.menu.weibo.content.desc",o,i):tb_i18n.get("project.menu.weibo.content",o),t={shareLink:n,mailTitle:encodeURIComponent(tb_i18n.get("project.menu.mail.title",o)),mailBody:encodeURIComponent(e),weiboLink:encodeURIComponent(n),weiboBody:encodeURIComponent(c)},this.$el.html(r(t))},e}(o)},function(t,e){t.exports=function(t){var e='<div class="form-group"> <h5>'+tb_i18n.get("project.menu.share.link")+'</h5> <input class="project-name form-control margin-bottom" value='+t.shareLink+"/></div><div> <h5>"+tb_i18n.get("project.menu.share.to")+'</h5> <div class="share-project-btn"> <a href="http://service.weibo.com/share/share.php?ralateUid=2673498793&url='+t.weiboLink+"&title="+t.weiboBody+'" target="_blank" title="'+tb_i18n.get("project.menu.share.to.weibo")+'" class="share-handler"><span class="icon icon-weibo"></span></a> <a href="mailto:?subject='+t.mailTitle+"&body="+t.mailBody+'" title="'+tb_i18n.get("project.menu.share.to.mail")+'" class="share-handler"><span class="icon icon-td-envelope"></span></a> </div></div>';return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f=function(t,e){function i(){this.constructor=t}for(var n in e)g.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},g={}.hasOwnProperty;h=i(358),m=i(678),d=i(788),u=i(677),o=i(401),s=i(684),l=i(696),a=i(1021),c=i(1666),r=i(1668),p=i(1669),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.viewName="ActivityPanelCopyView",e.prototype.className="activity-panel-copy",e.prototype.events={"click .owner-handler":"showOwnerSelector","click .visibility-handler":"renderVisibilitySelector","click button":"submitCopy","input .project-name":"checkSubmit"},e.prototype.initialize=function(t){return this.projectModel=t.projectModel,this.organizationsCollection=s.get(0),this.selectedVisibility="project",this.selectedOrgId=this.projectModel.get("_organizationId"),this.organization=this.organizationsCollection.get(this.selectedOrgId),this.renderBasic(),this.renderOwner(),this.renderSectionInfo(),this.checkSubmit(),this.$input.focusAtEnd()},e.prototype.renderBasic=function(){return this.$el.html(r(this.projectModel.toJSON())),this.$input=this.$("input.project-name"),this.$submit=this.$("button")},e.prototype.renderOwner=function(){return this.organization=this.organizationsCollection.get(this.selectedOrgId),this.$(".project-owner .selector-title").text(this.organization?this.organization.get("name"):tb_i18n.get("me")),this},e.prototype.renderSectionInfo=function(){var t,e,i,n,r,o,s,c;return null!=(o=this.$(".project-section"))&&o.remove(),i=h.map(null!=(s=this.organization)?s.get("dividers"):void 0,function(t,e){return{_id:e,title:t.name,pos:t.pos}}),i.length?(r=this.organization.get("projectIds").indexOf(this.projectModel.id),t=this.organization.get("dividers"),e=h.find(t,function(e,i){var n,o;return o=e.pos,i===t.length-1?o<=r:(n=t[i+1].pos,o<=r&&r<n)}),e?(c=h.find(i,function(t){return t.pos===e.pos&&t.title===e.name})._id,n=e.name):(c=i.length-1,n=i[c].title),this.dividerIndex=c,this.$(".project-owner").after(p({name:n})),this.sectionMenuView=this.requestSubView(a,{$toggler:this.$(".project-section .open-selector-handler"),width:320,dataList:i,selected:c,select:function(t){return function(e){return t.dividerIndex=e,t.$(".project-section .selector-title").html(i[e].title)}}(this)}),this):this},e.prototype.getOwners=function(){var t;return t=[],t.push({_id:m.user.id,title:tb_i18n.get("me"),plan:m.user.get("plan")}),t._userMeId=m.user.id,this.organizationsCollection.each(function(e){if(e.hasPermission("post.project"))return t.push({_id:e.id,title:e.get("name"),plan:e.get("plan")})}),t},e.prototype.showOwnerSelector=function(t){var e,i,n,r;if(e=$(null!=t?t.currentTarget:void 0),i="showOwnerSelector_"+this.cid,!e.data(i))return e.data(i,!0),null!=(r=this.ownerMenuView)&&r.remove(),n=this.getOwners(),this.ownerMenuView=this.requestSubView(a,{$toggler:e,width:320,dataList:n,selected:this.selectedOrgId,select:function(t){return function(e){return t.selectedOrgId=e===m.user.id?null:e,t.renderOwner(),t.renderSectionInfo(),t.renderVisibilitySelector()}}(this)}),e.click(),this},e.prototype.renderVisibilitySelector=function(t){return $(null!=t?t.currentTarget:void 0).hasClass("visibility-handler")?($(t.currentTarget).remove(),this.projectVisibilityView=this.requestSubView(c,{selected:this.selectedVisibility,projectModel:this.projectModel,select:function(t){return function(e){return t.visibilityCallBack(e)}}(this),isOrganization:this.organization}),this.projectVisibilityView.$el.appendTo(this.$(".project-visibility"))):this.projectVisibilityView&&(this.projectVisibilityView.remove(),this.projectVisibilityView=this.requestSubView(c,{selected:this.selectedVisibility,projectModel:this.projectModel,select:function(t){return function(e){return t.visibilityCallBack(e)}}(this),isOrganization:this.organization}),this.projectVisibilityView.$el.appendTo(this.$(".project-visibility"))),this},e.prototype.visibilityCallBack=function(t){var e;return this.selectedVisibility=t,this.$(".project-visibility .selector-title").text(tb_i18n.get("project.setting.visibility."+this.selectedVisibility)),this.$(".visibility-handler").attr("value",this.selectedVisibility),this.$(".visibility-handler .icon:not(.icon-chevron-down)").removeClass("icon-lock icon-earth icon-building").addClass(e=function(){switch(this.selectedVisibility){case"project":return"icon-lock";case"organization":return"icon-building";case"all":return"icon-earth"}}.call(this)),this.$(".visibility-handler").click()},e.prototype.checkSubmit=function(){return this.disableSubmit(!this.$input.val().trim())},e.prototype.disableSubmit=function(t){return this.$submit.prop("disabled",t),this.$submit[t?"addClass":"removeClass"]("disabled"),this},e.prototype.submitCopy=function(t){var e;if(!this.$submit.prop("disabled")&&("all"===this.projectModel.get("visibility")||this.projectModel.hasPermission("put.fork"))&&(e=this.$input.val().trim()))return this.disableSubmit(!0),this.projectModel.copy({attrs:{_id:this.projectModel.id,name:e,_organizationId:this.selectedOrgId,dividerIndex:this.dividerIndex,visibility:this.selectedVisibility},success:function(t){return function(e){var i,n,r,o;return l.get(0).add(e),i=e._organizationId,i&&(null!=(n=l.find(i))&&n.add(e),null!=(r=t.organizationsCollection.get(i))&&r.fetch({reset:!0})),u.message({tips:tb_i18n.get("project.menu.copy.success"),url:"/project/"+e._id,title:e.name}),null!=(o=t.parentView)&&o.backToAll(),t.remove()}}(this),error:function(t){return function(){return t.disableSubmit(!1),o.show({message:tb_i18n.get("project.menu.copy.fail"),status:"error"})}}(this)})},e}(d)},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;l=i(678),c=i(788),a=i(677),r=i(684),s=i(696),n=i(1667),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="ProjectVisibilityView",e.prototype.className="activity-panel-visibility",e.prototype.events={"click .visibility-menu li":"selectVisibility"},e.prototype.initialize=function(t){return this.projectModel=t.projectModel,this.selected=t.selected,this.select=t.select,this.isOrganization=t.isOrganization,this.renderBasic(),this},e.prototype.renderBasic=function(){switch(this.$el.html(n({isOrganization:this.isOrganization})),this.selectedVisibility=this.selected||this.projectModel.get("visibility")||"project",this.selectedVisibility){case"project":this.$(".visibility-project").addClass("selected");break;case"organization":this.$(".visibility-organization").addClass("selected");break;case"all":this.$(".visibility-all").addClass("selected")}return this},e.prototype.selectVisibility=function(t){var e;return e=$(t.currentTarget),this.$(".visibility-menu li").removeClass("selected"),e.addClass("selected"),this.selectedVisibility=e.data("id"),this.select(this.selectedVisibility),this},e}(c)},function(t,e){t.exports=function(t){var e='<div class="visibility-selector"> <ul class="visibility-menu"> <li class="visibility-project" data-id="project"> <a> <span class="icon icon-lock"></span> <span class="menu-item-title">'+tb_i18n.get("project.setting.visibility.project")+'</span> <p class="menu-item-info">'+tb_i18n.get("project.setting.visibility.info.project")+"</p> </a> </li> ";return t.isOrganization&&(e+=' <li class="visibility-organization" data-id="organization"> <a> <span class="icon icon-building"></span> <span class="menu-item-title">'+tb_i18n.get("project.setting.visibility.organization")+'</span> <p class="menu-item-info">'+tb_i18n.get("project.setting.visibility.info.organization")+"</p> </a> </li> "),e+=' <li class="visibility-all" data-id="all"> <a> <span class="icon icon-earth"></span> <span class="menu-item-title">'+tb_i18n.get("project.setting.visibility.all")+'</span> <p class="menu-item-info">'+tb_i18n.get("project.setting.visibility.info.all")+"</p> </a> </li> </ul></div>"}},function(t,e){t.exports=function(t){var e='<div class="copy-project-wrap"> <div class="form-group"> <h5>'+tb_i18n.get("project.name")+'</h5> <input class="project-name form-control margin-bottom"/> </div> <div class="project-owner form-group"> <h5>'+tb_i18n.get("project.creator.owner")+'</h5> <div class="open-selector-handler form-control owner-handler"> <span class="selector-title"></span> <span class="icon icon-chevron-down"></span> </div> </div> <div class="project-visibility formgroup"> <div class="visibility-handler"> <a> <span class="icon icon-lock"></span> <span class="menu-item-title">'+tb_i18n.get("copyAs")+tb_i18n.get("project.setting.visibility.project")+'</span> </a> </div> </div> <button class="btn btn-primary">'+tb_i18n.get("confirm")+"</button></div>";return e}},function(t,e){t.exports=function(t){var e='<div class="project-section form-group"> <h5>'+tb_i18n.get("project.grouping")+'</h5> <div class="open-selector-handler form-control"> <span class="selector-title">'+t.name+'</span> <span class="icon icon-chevron-down"></span> </div></div>';return e}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;o=i(679),c=i(788),a=i(994),s=i(1021),r=i(1671),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="ActivityDumpTasksView",e.prototype.className="activity-panel-dump-tasks",e.prototype.events={"click .download":"download"},e.prototype.initialize=function(t){return this._projectId=t._projectId,this.tasklistsCollection=a.get(this._projectId),this.listenTo(this.tasklistsCollection,"add remove",function(t){return t.id===this.selectedId?this.renderBasic():this.listMenu.update(this.tasklistsCollection.toJSON())}),this.renderBasic()},e.prototype.renderBasic=function(){var t;return t=this.tasklistsCollection.at(0),this.selectedId=t.id,this.$el.html(r(t.toJSON())),this.initListsMenu()},e.prototype.initListsMenu=function(){var t,e;return null!=(t=this.listMenu)&&t.remove(),e=this.tasklistsCollection.toJSON(),this.listMenu=this.requestSubView(s,{$toggler:this.$(".list-menu-toggler"),width:320,dataList:e,selected:this.selectedId,select:function(t){return function(e){var i,n;return t.selectedId=e,n=t.tasklistsCollection.get(e),null!=(i=t.$(".name"))?i.text(null!=n?n.get("title"):void 0):void 0}}(this)})},e.prototype.download=function(){var t;return t=o.API_HOST+"/tasklists/"+this.selectedId+"/export",$.fileDownload(t)},e}(c)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="<p>"+tb_i18n.get("tasklist.dump.hint")+'</p><a class="btn list-menu-toggler"> <p class="name">'+e(t.title)+'</p> <span class="icon icon-chevron-down"></span></a><button class="btn btn-primary btn-block download">'+tb_i18n.get("tasklist.dump.confirm")+"</button>";return i}},function(t,e){t.exports=function(t){var e='<div class="header activity-panel-header"> <a class="switch-handler activity-back" data-type="all"> <span class="icon icon-chevron-left"></span> <span class="get-back">'+tb_i18n.get("back")+'</span> </a> <div class="title">'+tb_i18n.get("activity.panel.title.all")+'</div> <a class="icon icon-remove close-handler"></a></div><div class="activity-panel-body thin-scroll"></div>';return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b=function(t,e){function i(){this.constructor=t}for(var n in e)k.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},k={}.hasOwnProperty;v=i(358),y=i(678),s=i(429),f=i(677),g=i(788),a=i(696),o=i(699),p=i(1053),m=i(996),l=i(992),d=i(994),h=i(995),n=i(1674),r=i(1675),u=i(1676),t.exports=c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.viewName="ScrumPanelView",e.prototype.className="scrum-panel",e.prototype.events={"click .task-sort-checkbox.list .item":"selectTaskSort","click .sort-item-created i.icon":"selectCreated","click .save-sort":"saveSortMethod","click .filter-done-handler":"toggleHideDone","click .filter-today-handler":"toggleTodayUpdate","click .filter-clear-handler":"clearFilter","click .scrum-filter-wrap .tag":"filterByTag","click .scrum-filter-wrap .member":"filterByExecutor","input .scrum-filter-wrap input":"filterByQuery","mousewheel .scrum-panel-body":f.mousewheel},e.prototype.initialize=function(t){if(!t._projectId)throw new Error("initialize "+this.viewName+" should has _projectId");return this.options=t,this._projectId=t._projectId,this.projectModel=a.getOne(0,this._projectId),this.tagsCollection=p.get(this._projectId),this.membersCollection=o.get(this._projectId),this.tasks=[],this.tagIds={},this.executorIds={},this.resetData(),this.resetFilter(),this.renderBasic(),this.genFilterList(),e.__super__.initialize.apply(this,arguments)},e.prototype.resetData=function(){var t;return t=this.projectModel.get("currentTasklistId"),t?this.tasklistModel=h.get(t):this.tasklistModel=d.get(this.projectModel.id).at(0),this.stagesCollection=l.get(this.tasklistModel.id),this.stopListening(),this.listen()},e.prototype.resetFilter=function(){var t;return t=this.tasklistModel.get("filter")||{},this.isHideDone=t.isHideDone||!1,this.onlyTodayUpdated=t.onlyTodayUpdate||!1,this.selectedExecutorIds=t.executorIds||[],this.selectedTagIds=t.tagIds||[],this.queryWord=t.query||"",this},e.prototype.listen=function(){var t;return t="add remove change:_executorId change:tagIds",this.stagesCollection.each(function(e){return function(i){return e.listenTo(m.get(i.id),t,e.genFilterList)}}(this)),this.listenTo(this.tasklistModel,"change:sortMethod",this.renderStatus),this.listenTo(this.tasklistModel,"change:filter",this.toggleFilterClear),this.listenTo(this.projectModel,"change:currentTasklistId",function(){return this.resetData(),this.genFilterList()}),this},e.prototype.renderBasic=function(){return this.permissions={taskPutPos:this.projectModel.hasPermission("task.put.pos"),hasSort:!!this.tasklistModel,hasStartDate:this.projectModel.isAppEnabled("startDate")},this.$el.html(n(this.permissions)),this.$tags=this.$(".scrum-filter-tags"),this.$executors=this.$(".scrum-filter-executors"),this.$input=this.$(".filter-input-wrap input"),this.renderStatus()},e.prototype.renderStatus=function(){var t,e;if(this.tasklistModel)return e=this.tasklistModel.get("sortMethod"),this.$("input[type=radio][value="+e+"]").prop("checked",!0),v.contains(["created_asc","created_desc"],e)?(this.$(".sort-item-created i.icon").css("display","inline-block"),t=e.split("_")[1],this.$("i.active").removeClass("active"),this.$("i[data-sort="+t+"]").addClass("active")):this.$(".sort-item-created i.icon").hide(),this.permissions.taskPutPos&&"custom"!==e?this.$(".task-sort-title .save-sort").show():this.$(".task-sort-title .save-sort").hide()},e.prototype.renderTags=function(){var t;return t=[],v.each(this.tagIds,function(e){return function(i,n){var r;if(r=e.tagsCollection.get(n))return t.push(r.toJSON())}}(this)),t.sort(function(t){return function(e,i){return t.tagIds[i._id]-t.tagIds[e._id]}}(this)),this.$tags.html(u({tags:t,selected:this.selectedTagIds})),this},e.prototype.renderExecutors=function(){var t;return t=[],v.each(this.executorIds,function(e){return function(i,n){var r;if(r=e.membersCollection.get(n))return t.push(r.toJSON())}}(this)),t.sort(function(t){return function(e,i){return t.executorIds[i._id]-t.executorIds[e._id]}}(this)),this.executorIds[""]&&t.unshift({_id:""}),this.$executors.html(r({executors:t,selected:this.selectedExecutorIds})),this},e.prototype.genFilterList=function(){return this._genFilterList||(this._genFilterList=v.debounce(function(t){return function(){var e;if(t.$el)return t.tasks=[],t.tagIds={},t.executorIds={},e=function(e){var i;return t.tasks.push(e),i=e.get("_executorId"),i&&t.membersCollection.get(i)||(i=""),t.executorIds[i]=(t.executorIds[i]||0)+1,v.each(e.get("tagIds"),function(e){return t.tagIds[e]=(t.tagIds[e]||0)+1})},t.stagesCollection.each(function(t){return m.get(t.id).each(e)}),t.renderExecutors(),t.renderTags()}}(this),500)),this._genFilterList(),this},e.prototype.toggleFilterClear=function(){var t;return t=this.tasklistModel.hasFilter(),this.$(".filter-clear-handler")[t?"addClass":"removeClass"]("active")},e.prototype.filterByTag=function(t){var e;return e=$(t.currentTarget).parent(),e.toggleClass("selected"),e.hasClass("selected")?this.selectedTagIds=v.union(this.selectedTagIds,[e.data("id")]):this.selectedTagIds=v.without(this.selectedTagIds,e.data("id")),this.setFilter("tagIds",this.selectedTagIds),this},e.prototype.filterByExecutor=function(t){var e;return e=$(t.currentTarget).parent(),e.toggleClass("selected"),e.hasClass("selected")?this.selectedExecutorIds=v.union(this.selectedExecutorIds,[e.data("id")]):this.selectedExecutorIds=v.without(this.selectedExecutorIds,e.data("id")),this.setFilter("executorIds",this.selectedExecutorIds),this},e.prototype.filterByQuery=function(t){return this.throttleFilter||(this.throttleFilter=v.throttle(function(t){return function(){if(t.$el)return t.queryWord=t.$input.val().trim().toLowerCase(),t.setFilter("query",t.queryWord)}}(this),400,{leading:!1})),this.throttleFilter(),this},e.prototype.setFilter=function(t,e){var i,n;return n=this.tasklistModel.get("filter")||{},i=v.clone(n),i[t]=e,this.tasklistModel.set("filter",i)},e.prototype.selectTaskSort=function(t){var e;if(!$(t.target).is("label"))return e=$(t.currentTarget).find("input").val(),this.tasklistModel.set("sortMethod",e)},e.prototype.selectCreated=function(t){var e,i,n;if(this.tasklistModel&&(e=$(t.currentTarget),i=e.data("sort")))return n="created_"+i,this.tasklistModel.set("sortMethod",n),this.$("i.active").removeClass("active"),e.addClass("active"),!1},e.prototype.saveSortMethod=function(t){var e;return this.$(".save-sort").html(tb_i18n.get("scrum.sort.in.save")),e=this.tasklistModel.get("sortMethod"),this.tasklistModel.saveAttr("resort",null,{attrs:{sortMethod:e},success:function(t){return function(){return t.tasklistModel.set("sortMethod","custom",{silent:!0}),t.renderStatus()}}(this),complete:function(t){return function(){return t.$(".save-sort").html(tb_i18n.get("scrum.sort.save"))}}(this)})},e.prototype.toggleHideDone=function(t){var e;return e=$(t.currentTarget),e.toggleClass("active"),this.isHideDone=e.hasClass("active"),this.setFilter("isHideDone",this.isHideDone),this},e.prototype.toggleTodayUpdate=function(t){var e;return e=$(t.currentTarget),e.toggleClass("active"),this.onlyTodayUpdated=e.hasClass("active"),this.setFilter("onlyTodayUpdate",this.onlyTodayUpdated),this},e.prototype.clearFilter=function(){return this.tasklistModel.set("filter",null),this.$input.val(""),this.$tags.find(".selected").removeClass("selected"),this.$executors.find(".selected").removeClass("selected"),this.$(".filter-done-handler").removeClass("active"),this.$(".filter-today-handler").removeClass("active"),this.resetFilter(),this},e.prototype.remove=function(){return this.tasklistModel.set("sortMethod","default"),this.clearFilter(),e.__super__.remove.apply(this,arguments)},e}(g)},function(t,e){t.exports=function(t){var e='<div class="scrum-panel-header"> <span class="title">'+tb_i18n.get("scrum.sortandfilter.title")+'</span> <a class="icon icon-remove close-handler"></a></div><div class="scrum-panel-body thin-scroll"> <div class="scrum-filter-wrap"> ';return t.hasSort&&(e+=' <div class="task-sort-wrap"> <div class="task-sort-title"> <span>'+tb_i18n.get("scrum.sort.title")+"</span> ",t.taskPutPos&&(e+=' <span class="save-sort">'+tb_i18n.get("scrum.sort.save")+"</span> "),e+=' </div> <div class="task-sort-checkbox list"> <label class="sort-item-custom item item-input"> <input type="radio" name="group" value="custom" data-gta="{action: \'order in filter\', type: \'manual\', control: \'task panel menu\'}"> '+tb_i18n.get("scrum.sort.custom")+' </label> <label class="sort-item-priority item item-input"> <input type="radio" name="group" value="priority" data-gta="{action: \'order in filter\', type: \'priority\', control: \'task panel menu\'}"> '+tb_i18n.get("scrum.sort.priority")+" </label> ",t.hasStartDate&&(e+=' <label class="sort-item-startdate item item-input"> <input type="radio" name="group" value="startdate" data-gta="{action: \'order in filter\', type: \'start date\', control: \'task panel menu\'}"> '+tb_i18n.get("scrum.sort.startdate")+" </label> "),e+=' <label class="sort-item-duedate item item-input"> <input type="radio" name="group" value="duedate" data-gta="{action: \'order in filter\', type: \'due date\', control: \'task panel menu\'}"> '+tb_i18n.get("scrum.sort.duedate")+' </label> <label class="sort-item-created item item-input"> <input type="radio" name="group" value="created_asc" data-gta="{action: \'order in filter\', type: \'created date\', control: \'task panel menu\'}"> '+tb_i18n.get("scrum.sort.created")+' <i class="icon icon-sharp-down2" data-sort="desc"></i> <i class="icon icon-sharp-up2" data-sort="asc"></i> </label> </div> </div> '),e+=' <div class="filter-input-wrap"> <div class="filter-title">'+tb_i18n.get("scrum.filter.title")+'</div> <a class="filter-clear-handler">'+tb_i18n.get("scrum.filter.clear")+'</a> <input class="form-control" placeholder="'+tb_i18n.get("scrum.filter.search")+'" data-gta="{action: \'filter\', type: \'task\', control: \'task panel menu\', method: \'keyworkd\'}"/> </div> <ul class="scrum-filter-tags list"></ul> <ul class="scrum-filter-executors list"></ul> </div> <div class="scrum-filter-done-wrap"> <a class="filter-done-handler" data-gta="{action: \'filter\', type: \'task\', control: \'task panel menu\', method: \'hide done\'}"> <div class="check-box pull-left"> <span class="icon icon-tick"></span> </div> <span>'+tb_i18n.get("scrum.filter.hide.done")+'</span> </a> </div> <div class="scrum-filter-today-wrap"> <a class="filter-today-handler" data-gta="{action: \'filter\', type: \'task\', control: \'task panel menu\', method: \'today update\'}"> <div class="check-box pull-left"> <span class="icon icon-tick"></span> </div> <span>'+tb_i18n.get("scrum.filter.today.update")+"</span> </a> </div></div>"}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t.executors;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li class="member-wrap ',t.selected.indexOf(r._id)>=0&&(i+="selected"),i+='" data-id="'+r._id+"\"> <a class=\"member\" data-gta=\"{action: 'filter', type: 'task', control: 'task panel menu', method: 'member'}\"> ",i+=r._id?' <div class="avatar img-circle img-24" style="background-image:url('+r.avatarUrl+');"></div> '+e(r.name)+" ":' <div class="avatar img-circle img-24 no-avatar"></div> '+tb_i18n.get("task.detail.no.executor")+" ",i+=" </a></li>";return i}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(963).calculateColor,o=t.tags;if(o)for(var s,a=-1,c=o.length-1;a<c;)s=o[a+=1],n+='<li class="tag-wrap ',t.selected.indexOf(s._id)>=0&&(n+="selected"),n+='" data-id="'+s._id+"\"> <a class=\"tag\" data-gta=\"{action: 'filter', type: 'task', control: 'task panel menu', method: 'tag'}\"> <span class=\"tag-label\" style=\"background-color: "+r(s.color,s.colorRGBA)+'"></span> <span class="tag-name">'+e(s.name)+"</span> </a></li>";return n}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x=function(t,e){function i(){this.constructor=t}for(var n in e)S.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},S={}.hasOwnProperty,I=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};C=i(678),T=i(358),w=i(677),_=i(788),M=i(679),d=i(699),v=i(1358),b=i(1010),f=i(689),k=i(798),m=i(1008),s=i(401),j=i(786),o=i(805),c=i(1191),l=i(1678),u=i(1680),g=i(1682),p=i(1693),y=i(1695),r=i(1697),h=i(1698),n=i(1699),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return x(e,t),e.prototype.viewName="MemberBarView",e.prototype.className="member-bar-view",e.prototype.events={
"click .back-to-project-members":"backToProjectMembers","click .team":"enterTeamMembers","click .add-members-handler":"openAddMember","click .member-detail":"showMemberDetail","input .filter-input":"renderList","click .item-menu-handler":"toggleMenu","mousewheel .member-bar-body":w.mousewheel},e.prototype.initialize=function(t){return this._projectId=t._projectId,this.projectModel=t.projectModel,this.isOrgProject=Boolean(this.projectModel.get("_organizationId")),this.membersCollection=d.get(this._projectId),this.showMemberProgress=this.projectModel.getPaymentPlan().membersLimit<f.UNLIMIT_MEMBERS,this.isOrgMember=this.projectModel.get("_orgRoleId")>=0,this.load({success:function(t){return function(){return t.renderBasic(),t.renderList(),t.initMemberFinder(),t.showMemberProgress&&t.renderMemberProgress(),t.listen()}}(this)})},e.prototype.load=function(t){var e;return e=[],this.isOrgProject&&!C.user.get("isGhost")?(e.push(new Promise(function(t){return function(e,i){return v.fetch(t.projectModel.get("_organizationId"),{success:function(n){return t.rolesCollection=n,t.$el?e():i()},error:function(t,e){return i(e)}})}}(this))),this.isOrgMember&&e.push(new Promise(function(t){return function(e,i){return d.fetch(t.projectModel.get("_organizationId"),{boundToObjectType:"organization",success:function(n){return t.orgMembersCollection=n,t.$el?e():i()},error:function(t,e){return i(e)}})}}(this))),e.push(new Promise(function(t){return function(e,i){return b.fetch(t.projectModel.id,{boundToObjectType:"project",success:function(n){return t.teamsCollection=n,t.$el?e():i()},error:function(t,e){return i(e)}})}}(this))),Promise.all(e).then(function(){return t.success()})["catch"](function(t){if(t)return console.error(t)})):t.success()},e.prototype.listen=function(){return this.listenTo(this.membersCollection,"add destroy remove",function(){if(this.renderList(),this.showMemberProgress)return this.renderMemberProgress()}),this.listenTo(this.membersCollection,"change refresh",function(){return this.renderList()}),this.listenTo(this.teamsCollection,"add destroy remove",function(){return T.delay(function(t){return function(){return t.renderList()}}(this),100)})},e.prototype.renderBasic=function(){return this.$el.html(r()),this.$header=this.$(".member-bar-header"),this.$body=this.$(".member-bar-boday"),this.$backButton=this.$(".member-bar-header .back-to-project-members"),this.$title=this.$(".member-bar-header .title"),this.showMemberProgress&&this.$el.addClass("show-member-progress"),this.$input=this.$(".filter-input"),this.$membersList=this.$(".members-list"),this.$memberProgress=this.$(".member-progress")},e.prototype.refreshHeader=function(t,e){return t||(t=tb_i18n.get("member.bar.title")),e?this.$header.addClass("with-back"):this.$header.removeClass("with-back"),this.$title.text(t)},e.prototype.renderList=function(){var t;return t=!!this.$header.hasClass("with-back"),t?this.renderTeamMemberList():this.renderMainList()},e.prototype.renderMainList=function(){var t,e,i,n;return n=this.getTeams(),e=this.parseMembers(),i=this.$input.val().trim(),i&&(e=w.memberFilter(e,i),n=w.memberFilter(n,i)),t={teams:n,permissions:this.projectModel.hasPermissions("post.member","del.member"),members:T.map(e,function(t){return function(e){return T.extend(e,w.getMemberPermissions(t.projectModel,e))}}(this))},this.$membersList.html(h(t)),this.initDragHandler()},e.prototype.renderTeamMemberList=function(){var t,e,i;return e=this.parseTeamMembers(),i=this.$input.val().trim(),i&&(e=w.memberFilter(e,i)),t={permissions:this.projectModel.hasPermissions("del.member"),members:T.map(e,function(t){return function(e){return T.extend(e,w.getMemberPermissions(t.projectModel,e))}}(this))},this.$membersList.html(h(t)),this.initDragHandler()},e.prototype.getTeams=function(){var t;return this.teamsCollection?(t=this.teamsCollection.toJSON(),t=T.sortBy(t,function(t){return new Date(t.created).valueOf()}),t.forEach(function(t){var e;return e=m.getTeamStyle(t),t.styleName=e.styleName,t.styleColor=e.styleColor,t.belongsTo=m.getTeamBelongsTo(t)}),t):[]},e.prototype.parseTeamMembers=function(){var t,e,i;return i=this.teamsCollection.get(this.currentTeamId),e=i.get("hasMembers").map(function(t){return t._id}),t=this.membersCollection.toJSON().filter(function(t){var i;return i=t._id,I.call(e,i)>=0}),t.forEach(function(t){return function(e){return e.roleName=t.membersCollection.get(e._id).getRole()}}(this)),t},e.prototype.parseMembers=function(){var t;return t=this.membersCollection.toJSON(),t.forEach(function(t){return function(e){return e.roleName=t.membersCollection.get(e._id).getRole()}}(this)),t},e.prototype.renderMemberProgress=function(){var t;return null!=(t=this.memberProgressView)&&t.remove(),this.memberProgressView=this.requestSubView(u,{exist:this.membersCollection.length,projectModel:this.projectModel}),this.$memberProgress.html(this.memberProgressView.$el),this},e.prototype.showMemberDetail=function(t){var e,i,n,r,o,s;return t.target&&$(t.target).closest(".member-menu-handler").length?this:(null!=(r=this.memberMenuView)&&r.remove(),e=$(t.currentTarget),i=e.data("id"),null!=(o=this.memberCardView)&&o.remove(),n=d.get(this._projectId).get(i),this.memberCardView=this.requestSubView(c,{$toggler:e,placement:"left",projectModel:this.projectModel,affixToggler:!0,roles:(null!=(s=this.rolesCollection)?s.toJSON():void 0)||[],memberModel:n,orgMembersCollection:this.isOrgMember?this.orgMembersCollection:void 0}),this.memberCardView.show(),this)},e.prototype.backToProjectMembers=function(t){var e;return this.$input.val(""),e=$(t.currentTarget),this.renderMainList(),this.leftIn(),this.refreshHeader(e.data("title"),!1),this},e.prototype.enterTeamMembers=function(t){var e;return this.$input.val(""),e=$(t.currentTarget),this.currentTeamId=e.data("id"),this.renderTeamMemberList(),this.rightIn(),this.refreshHeader(e.data("title"),!0)},e.prototype.leftIn=function(){return this.$el.find(".member-bar-body").css({x:"-100%",opacity:0}),this.$el.find(".member-bar-body").transition({x:"0",opacity:1},128,"out")},e.prototype.rightIn=function(){return this.$el.find(".member-bar-body").css({x:"100%",opacity:0}),this.$el.find(".member-bar-body").transition({x:"0",opacity:1},128,"out")},e.prototype.toggleMenu=function(t){var e,i,n,r,o,s,a,c;if(t.stopPropagation(),e=$(t.currentTarget),i=e.data("id"),e.data("bs.popover"))return this;switch(e.data("toggle")){case"team":n=y,r=this.teamsCollection.get(i);break;case"member":n=p,r=this.membersCollection.get(i)}return null!=(o=this.memberCardView)&&o.remove(),null!=(s=this.memberMenuView)&&s.remove(),this.memberMenuView=this.requestSubView(n,{$toggler:e,projectModel:this.projectModel,roles:(null!=(a=this.rolesCollection)?a.toJSON():void 0)||[],objModel:r,teamsCollection:this.teamsCollection,cannotRemove:null!=(c=this.teamsCollection)?c.isInTeams(i):void 0}).show(),this},e.prototype.checkMembersFull=function(){var t,e;return t=this.membersCollection.length,e=this.projectModel.getPaymentPlan().membersLimit,t>=e},e.prototype.showMemberExceed=function(){var t,e,i,n,r;return t=this.projectModel.get("_organizationId"),r=this.projectModel.getPaymentPlan().membersLimit,this.isOrgProject?(n=tb_i18n.get("project.settings.member.reach.limit.org",r),i=tb_i18n.get("organization.settings.add.member.toplimit"),e=k.pay.orgAddMember(t)):(n=tb_i18n.get("project.settings.member.reach.limit",r),i=tb_i18n.get("upgrade"),e=k.pay.plans),this.requestSubView(j).open(o,{title:tb_i18n.get("project.setting.members.reach.limit"),content:n,confirmText:i,confirmHref:e}),C.gta.event({action:"reach plan limit",type:this.isOrgProject?"business":"plus",control:"project member number",category:"add member"}),this},e.prototype.openAddMember=function(t){return this.checkMembersFull()?this.showMemberExceed():this.requestSubView(j).open(g,{projectModel:this.projectModel}),this},e.prototype.initDragHandler=function(t){return this.projectModel.getRoleScope()>=0?(t||(t=this.$(".member[data-id]")),t.draggable({zIndex:"10000",appendTo:"body",addClasses:!1,scroll:!1,cursorAt:{top:18,left:18},helper:function(t){return function(e){var i,r;return i=$(e.currentTarget).data("id"),r=t.membersCollection.get(i),$(n(r.toJSON()))}}(this),start:function(){return C.gta.event(null,"drag","member bar|drag member")}}),this):this},e.prototype.initMemberFinder=function(){return this.requestSubView(l,{collection:this.membersCollection,$searchbox:this.$input,select:function(t){return function(e){return T.delay(function(){return t.renderList()}),t.addMember(e,{success:function(){return s.show({message:tb_i18n.get("project.settings.add.member.success",e.item.name),status:"success"}),C.gta.event({action:"added member",type:"single",control:"Side Menu",category:"project"})}})}}(this)})},e.prototype.addMember=function(t,e){var i,n,r,o;return this.checkMembersFull()?this.showMemberExceed():(i=T.extend({boundToObjectType:"project"},e),n={},r=t.item.type,n[r]=t.item[r]||t.item.value,this.membersCollection.where(n).length?(o=t.item.name,s.show({message:tb_i18n.get("project.settings.add.member.repetitive",o),status:"success"})):this.membersCollection.addMember(n,i)),this},e}(_)},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty,u=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};c=i(358),n=i(699),o=i(1679),s=i(677),a=i(788),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="MemberFinderView",e.prototype.initialize=function(t){if((null!=t?t.collection:void 0)&&t.$searchbox)return this.options=t,this.reset(t.collection)},e.prototype.reset=function(t){return this.$searchbox=this.options.$searchbox,this.collection=t||new n,this.initAutoComplete(),this},e.prototype.initAutoComplete=function(){return this.$searchbox.autocomplete({appendTo:"body",autoFocus:!0,create:function(t,e){return $("body > .ui-autocomplete.ui-menu").addClass("dropdown-menu").css({zIndex:1e4,visibility:"visible",opacity:1})},select:function(t){return function(e,i){var n;return i.item.isNew&&"phone"===i.item.type||"function"==typeof(n=t.options).select&&n.select(i),t.$searchbox.val(""),t.$searchbox.trigger("change"),!1}}(this),source:function(t){return function(e,i){return e.term=e.term.trim(),t.search(e.term.trim(),{beforeSend:function(e){return t.showLoadingIndicator(t.$searchbox,{isPrepend:!0})},success:function(n){var r;return t.hideLoadingIndicator(),n=t.analysisResult(n,e.term),r=t.options.newEmailPrefix||"",c.each(n,function(t){if(t.name||(t.name=t.value),t.isNew&&"phone"===t.type&&(t.value=tb_i18n.get("member.finder.unregistered.phone")),t.isNew&&"email"===t.type)return t.name=""+r+t.name}),i(n)}})}}(this)}),this.autocomplete=this.$searchbox.data("ui-autocomplete"),this.autocomplete._renderItem=function(t,e){return $(o(e)).appendTo(t)},this.autocomplete.liveRegion=$("<span>"),this},e.prototype.getSearchType=function(t){var e;return e=s.isEmail(t)?"email":"phone"},e.prototype.search=function(t,e){var i,n;return t=t.trim(),i=s.formatPhone(t),(s.isEmail(t)||s.isPhone(i))&&(n=this.getSearchType(t),"phone"===n&&(t=i),this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(i){return function(){return i.doSearch(n,t,e)}}(this),200)),!0},e.prototype.doSearch=function(t,e,i){return this.collection.search(t,e,i)},e.prototype.analysisResult=function(t,e){var i,n,r,o,s,a,c;if(i=this.collection.getMemberIds(),c=this.getSearchType(e),a=[],(null!=t?t.length:void 0)>0)for(n=0,r=t.length;n<r;n++)o=t[n],o.type="email",s=o._id,u.call(i,s)>=0&&(o.invited=!0),a.push(o);else a.push({isNew:!0,value:e,type:c});return a},e}(a)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="";return t.isNew?i+=' <li> <a class="member-item" data-param="'+t.params+'"> '+e(t.name||t.value)+" </a> </li>":(i+=' <li> <a class="member-item ',t.invited&&(i+="added"),i+='"> <div class="avatar img-circle img-24" style="background-image:url('+t.avatarUrl+');"> </div> '+e(t.name)+" ",t.isActive&&(i+=" "+e(t.title||t.location||"")+" "),i+=" </a> </li>"),i}},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty,p=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};s=i(358),o=i(788),n=i(1681),a=i(679),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.viewName="MemberProgressView",e.prototype.className="member-progress-view",e.prototype.initialize=function(t){var e,i,n;return this.exist=t.exist,this.options=t,e=(null!=(i=t.projectModel)?i.getPaymentPlan():void 0)||(null!=(n=t.organizationModel)?n.getPaymentPlan():void 0),this.limit=e.membersLimit,this.payType=e.payType,this.render(),this.renderProgressBarWidth()},e.prototype.hasKeys=function(t,e){var i;return i=s.keys(t),e.every(function(t){return p.call(i,t)>=0})},e.prototype.render=function(){var t,e,i,r,o,s;return t=(null!=(r=this.options.organizationModel)?r.id:void 0)||this.options.projectModel.get("_organizationId"),i=(null!=(o=this.options.projectModel)?o.get("_orgRoleId"):void 0)>=0||(null!=(s=this.options.organizationModel)?s.get("_roleId"):void 0)>=0,e={exist:this.exist,limit:this.limit,payType:this.payType,isOrgMember:i,_organizationId:t},this.$el.html(n(e))},e.prototype.renderProgressBarWidth=function(){var t;return t=Math.floor(this.exist/this.limit*100),this.$(".progress-bar").css("width",t+"%")},e}(o)},function(t,e,i){t.exports=function(t){var e="",n=i(798);return e+='<div class="progress',t.exist>=t.limit&&(e+=" is-full"),e+='"> <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"> </div></div>',"organization"===t.payType?(e+=" <span>"+tb_i18n.get("member.progress.title.organization",t.exist,t.limit)+"</span> ",t.isOrgMember&&(e+=' <a href="'+n.pay.orgAddMember(t._organizationId)+'" target="_blank" class="pull-right upgrade-handler" data-gta="{action: \'view plan option\', type: \'business\', control: \'member number\'}"> '+tb_i18n.get("organization.settings.add.member.toplimit")+" </a> ")):e+=" <span>"+tb_i18n.get("member.progress.title.project",t.exist,t.limit)+'</span> <a href="'+n.pay.plans+'" target="_blank" class="pull-right upgrade-handler" data-gta="{action: \'view plan option\', type: \'plus\', control: \'member number\'}"> '+tb_i18n.get("upgrade")+" </a>",e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M=function(t,e){function i(){this.constructor=t}for(var n in e)C.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},C={}.hasOwnProperty;_=i(358),T=i(678),k=i(788),b=i(677),j=i(679),h=i(689),y=i(798),s=i(401),c=i(700),v=i(1010),u=i(699),w=i(786),f=i(1683),n=i(1685),a=i(1678),l=i(1680),o=i(805),d=i(1008),g=i(1690),r=i(1691),p=i(1692),t.exports=m=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return M(e,t),e.prototype.viewName="ProjectMemberaddView",e.prototype.className="project-memberadd-view modal-dialog flex-vert flex-fill",e.prototype.events={"click .qrcode-handler":"openQRcode","click .batch-add-handler":"openBatchAdd","click .add-team-handler":"addTeam","click .add-member-handler":"addMember","input .member-info-input":"filterTeamAndMember","change .member-info-input":"filterTeamAndMember"},e.prototype.initialize=function(t){if(null!=t?t.projectModel:void 0)return this.projectModel=t.projectModel,this.isOrgProject=Boolean(this.projectModel.get("_organizationId")),this.isOrgMember=this.projectModel.get("_orgRoleId")>=0,this.showMemberProgress=this.projectModel.getPaymentPlan().membersLimit<h.UNLIMIT_MEMBERS,this.ready=!1,this.renderBasic(),this.renderContent(),this},e.prototype.renderBasic=function(){return this.$el.html(r(this.projectModel.toJSON())),this.showMemberProgress&&this.$el.addClass("show-member-progress"),this.$emptySearchPlaceHolder=this.$(".empty-search-placeholder"),this.$emptyProjectPlaceHolder=this.$(".empty-project-placeholder"),this.$teamContainer=this.$(".team-wrapper"),this.$memberContainer=this.$(".member-wrapper"),this.$teamList=this.$(".team-list"),this.$memberList=this.$(".member-list"),this.$invitedMemberList=this.$(".invited-member-list"),this.$memberProgress=this.$(".member-progress"),this},e.prototype.renderContent=function(){return this.$(".placeholder-wrapper, .list-wrapper").hide(),this.showLoadingIndicator(this.$invitedMemberList),this.loadData({success:function(t){return function(){return t.ready=!0,t.renderList(),t.hideLoadingIndicator(),t.initMemberFinder(),t.showMemberProgress&&t.renderMemberProgress(),t.listen()}}(this)})},e.prototype.loadData=function(t){var e;return e=[],e.push(new Promise(function(t){return function(e,i){return u.fetch(t.projectModel.id,{boundToObjectType:"project",success:function(i){return t.projectMembersCollection=i,e()},error:function(t,e){return i(e)}})}}(this))),this.isOrgProject&&this.isOrgMember?(e.push(new Promise(function(t){return function(e,i){return v.fetch(t.projectModel.id,{boundToObjectType:"project",success:function(i){return t.projectTeamsCollection=i,e()},error:function(t,e){return i(e)}})}}(this))),e.push(new Promise(function(t){return function(e,i){return v.fetch(t.projectModel.get("_organizationId"),{boundToObjectType:"organization",success:function(i){return t.teamsCollection=i,e()},error:function(t,e){return i(e)}})}}(this))),e.push(new Promise(function(t){return function(e,i){return u.fetch(t.projectModel.get("_organizationId"),{boundToObjectType:"organization",success:function(i){return t.membersCollection=i,e()},error:function(t,e){return i(e)}})}}(this)))):e.push(new Promise(function(t){return function(e,i){return t.projectModel.getRecommendMembers({success:function(i){return t.membersCollection=new u,i.forEach(function(e){return t.membersCollection.push(new c(e))}),e()},error:function(t,e){return i(e)}})}}(this))),Promise.all(e).then(function(){return null!=t?t.success():void 0})["catch"](function(t){return console.error(t)})},e.prototype.renderList=function(){var t,e,i;return this.isOrgProject&&this.isOrgMember&&(i=this.renderTeams())&&this.$teamContainer.show(),e=this.renderMembers(),e&&(t=this.$memberContainer.children("header"),t.html(this.isOrgProject&&this.isOrgMember?tb_i18n.get("project.memberadd.orgMember"):tb_i18n.get("project.memberadd.cooperatedMember")),this.$memberContainer.show()),i||e||(this.$emptyProjectPlaceHolder.show(),this.$emptyProjectPlaceHolder.find(".tip").html(1===this.projectMembersCollection.length?tb_i18n.get("project.memberadd.noMemberInviteSomeone"):tb_i18n.get("project.memberadd.allRecommendInvited"))),this.filterTeamAndMember()},e.prototype.renderTeams=function(){var t,e;return t=0,e=this.teamsCollection.toJSON(),e=_.sortBy(e,function(t){return new Date(t.created).valueOf()}),_.each(e,function(e){return function(i){var n;if(i.style=d.getTeamStyle(i),i.belongsTo=d.getTeamBelongsTo(i),!e.projectTeamsCollection.get(i._id))return n=e.$teamList.find(".team[data-id="+i._id+"]"),n.length?n.replaceWith(g(i)):e.$teamList.append(g(i)),++t}}(this)),t},e.prototype.addTeam=function(t){var e,i,n;if(e=$(t.currentTarget),i=e.closest(".team").data("id"),n=this.teamsCollection.get(i))return n.addProject(this.projectModel.id,{success:function(t){return function(){var i;return t.projectTeamsCollection.add(n.toJSON()),e.replaceWith("<p class='added'>"+tb_i18n.get("project.memberadd.imported")+"</p>"),i=t.$(".member-info-input").val()?"filter":"click",T.gta.event({action:"added member",type:"org member",control:"team import",method:i,category:"project"})}}(this)}),this},e.prototype.renderMembers=function(){var t;return t=0,this.membersCollection.each(function(e){return function(i){var n,r;if(r=i.toJSON(),r._userMeId=T.user.id,!e.projectMembersCollection.get(i.id)&&"teambition@teambition.com"!==r.email)return n=e.$memberList.find(".member[data-id="+i.id+"]"),n.length?n.replaceWith(p(r)):e.$memberList.append(p(r)),++t}}(this)),t},e.prototype.checkMembersExceed=function(){var t,e,i;return i=Boolean(this.projectModel.get("_organizationId")),t=this.projectModel.get("_organizationId"),e=this.projectMembersCollection.length>=this.projectModel.getPaymentPlan().membersLimit,e&&(this.requestSubView(w).open(o,{title:tb_i18n.get("project.setting.members.reach.limit"),content:tb_i18n.get("project.settings.member.reach.limit",this.projectModel.getPaymentPlan().membersLimit),confirmText:tb_i18n.get("upgrade"),confirmHref:i?y.pay.orgAddMember(t):y.pay.plans}),T.gta.event({action:"reach plan limit",type:this.isOrgProject?"business":"plus",control:"project member number",category:"add member"})),e},e.prototype.addMember=function(t,e){var i,n,r,o;if(null==e&&(e={}),!this.checkMembersExceed()&&(n="currentTarget"in t?(i=$(t.currentTarget)).closest(".member").data("email"):t.item.email||("email"===t.item.type?t.item.value:void 0)))return(o=this.projectMembersCollection.where({email:n}),r=o[0],o).length?s.show({message:tb_i18n.get("project.memberadd.addRepetitive",r.get("name")),status:"success"}):this.projectMembersCollection.addMember({email:n},{success:function(){return null!=i&&i.replaceWith("<p class='added'>"+tb_i18n.get("project.memberadd.added")+"</p>"),"function"==typeof e.success?e.success():void 0}}),null==e.ignoreGTA&&T.gta.event({action:"added member",category:"project",type:this.isOrgProject?"org member":"worked with",control:this.isOrgProject?"single import":"button",method:this.$(".member-info-input").val()?"filter":"click"}),this},e.prototype.initMemberFinder=function(){return this.requestSubView(a,{collection:this.membersCollection,$searchbox:this.$(".member-info-input"),newEmailPrefix:tb_i18n.get("member.finder.sendInvitationMailTo"),select:function(t){return function(e){return t.addMember(e,{ignoreGTA:!0,success:function(){var i,n;if(e.item.inProject=!0,!$(".invited-member-list > .member[data-id='"+e.item._id+"']").length){if(n=t.projectMembersCollection.where({email:e.item.email||e.item.value}),0===n.length)return;i=n[0].toJSON(),i._userMeId=T.user.id,i.inProject=!0,t.$invitedMemberList.append(p(i)),t.$emptyProjectPlaceHolder.hide()}return s.show({message:tb_i18n.get("project.memberadd.addSuccess",e.item.value||e.item.name),status:"success"}),T.gta.event({action:"added member",type:"single",control:"invite "+(e.item.isNew?"new":"existing")+" user",category:"project"})}})}}(this)})},e.prototype.filterTeamAndMember=function(t){var e,i,n;if(this.ready&&(n=$(".member-info-input").val(),this.query!==n))return this.query=n,this.isOrgProject&&this.isOrgMember&&(i=this.filterTeam(n)),e=this.filterMember(n),i||e||this.$emptyProjectPlaceHolder.is(":visible")?(this.$invitedMemberList.show(),this.$emptySearchPlaceHolder.hide()):(this.$invitedMemberList.hide(),this.$emptySearchPlaceHolder.show(),this.$emptySearchPlaceHolder.find(".tip").html(tb_i18n.get("project.memberadd.searchCantfind",n)))},e.prototype.filterTeam=function(t){var e,i,n;return n=!t,n?this.$teamContainer.find("header, li.team").show():(i=this.$teamList,i.find("li.team").hide(),e=this.$teamContainer.children("header").hide(),this.teamsCollection.filter(function(e){return~e.get("name").indexOf(t)}).map(function(t){return n=!0,e.show(),i.find(".team[data-id="+t.id+"]").show()})),n},e.prototype.filterMember=function(t){var e,i,n;return n=!t,n?this.$memberContainer.find("header, li.member").show():(i=this.$memberList,i.find("li.member").hide(),e=this.$memberContainer.children("header").hide(),this.membersCollection.filter(function(e){var i,r,o,s;if("teambition@teambition.com"===e.get("email"))return!1;for(s=["name","py","pinyin","email"],r=0,o=s.length;r<o;r++)if(i=s[r],~(e.get(i)||"").indexOf(t))return n=!0;return!1}).map(function(t){return e.show(),i.find(".member[data-id="+t.id+"]").show()})),n},e.prototype.listen=function(){return this.listenTo(this.projectModel,"remove",this.close),this.listenTo(this.projectMembersCollection,"add",function(t,e){var i;return null!=(i=$(".member[data-id="+t.id+"] .add-member-handler"))?i.replaceWith("<p class='added'>"+tb_i18n.get("project.memberadd.added")+"</p>"):void 0}),this.listenTo(this.projectMembersCollection,"remove",function(t,e){var i;return null!=(i=$(".member[data-id="+t.id+"] .add-member-handler"))?i.replaceWith("<button class='button-add add-member-handler'>"+tb_i18n.get("project.memberadd.add")+"</button>"):void 0}),this.listenTo(this.teamsCollection,"add",function(t,e){var i;return null!=(i=$(".team[data-id="+t.id+"] .add-team-handler"))?i.replaceWith("<p class='added'>"+tb_i18n.get("project.memberadd.imported")+"</p>"):void 0}),this.listenTo(this.teamsCollection,"remove",function(t,e){var i;return null!=(i=$(".team[data-id="+t.id+"] .add-team-handler"))?i.replaceWith("<button class='button-add add-team-handler'>"+tb_i18n.get("project.memberadd.import")+"</button>"):void 0}),this.listenTo(this.projectMembersCollection,"add destroy remove",function(t){return function(){if(t.showMemberProgress)return t.renderMemberProgress()}}(this)),this},e.prototype.renderMemberProgress=function(){var t;return null!=(t=this.memberProgressView)&&t.remove(),this.memberProgressView=this.requestSubView(l,{exist:this.projectMembersCollection.length,projectModel:this.projectModel}),this.$memberProgress.html(this.memberProgressView.$el),this},e.prototype.openQRcode=function(){if(!this.checkMembersExceed())return this.requestSubView(w).open(f,{model:this.projectModel}),this},e.prototype.openBatchAdd=function(){var t;return t=this.projectModel.getPaymentPlan().membersLimit-this.projectMembersCollection.length,t=t>0?t:0,this.requestSubView(w).open(n,{type:"emails",model:this.projectModel,isOrganization:!1,membersLeft:t,addHandler:function(t){return function(e){if(e.length)return t.projectMembersCollection.addMember({email:e},{success:function(t){var e;return e=t.length,s.show({message:tb_i18n.get("organization.settings.add.members.success",e),status:"success"}),T.gta.event({action:"added member",type:"batch",control:"button",category:"project"})}})}}(this)})},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.close(),this},e}(k)},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;l=i(358),p=i(678),a=i(677),c=i(788),o=i(429),n=i(1684),r=i(401),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="QrcodeView",e.prototype.className="qrcode-view modal-dialog card",e.prototype.events={"click .reset-invite-url":"resetInvite","focus input":"focusLink","click .copy-invite-url":"copyLink"},e.prototype.initialize=function(t){return this.model=t.model,this.supportCopy="function"==typeof document.queryCommandSupported?document.queryCommandSupported("copy"):void 0,this.model.fetchInvitelink({success:function(t){return function(){if(t.$el)return t.renderBasic(),t.listen()}}(this)}),this},e.prototype.renderBasic=function(){var t;return t=o(this.model.get("expiration")).format("LLL"),this.$el.html(n({projectPutInfo:this.model.hasPermission("put.info"),inviteLink:this.model.get("inviteLink"),supportCopy:this.supportCopy,qrCodeString:tb_i18n.get("project.settings.add.member.through.url.or.tip1")+" "+t})),this.$qr=this.$(".qrcode-img"),this.$input=this.$("input"),this.$copyBtn=this.$(".copy-invite-url"),this.renderQr(),this},e.prototype.selectLink=function(){return this.$input.selectRange(0,this.$input.val().length),this},e.prototype.focusLink=function(){return l.delay(function(t){return function(){return t.selectLink()}}(this),100)},e.prototype.copyLink=function(t){var e,i,n;this.selectLink(),e=!1;try{e=document.execCommand("copy")}catch(n){i=n}return this.$copyBtn.width(this.$copyBtn.width()),this.$copyBtn.text(e?tb_i18n.get("copy.link.success"):tb_i18n.get("copy.link.failed"))},e.prototype.listen=function(){return this.listenTo(this.model,"change:inviteLink",this.renderBasic),this},e.prototype.renderQr=function(){return this.$qr.qrcode({size:150,text:this.model.get("mobileInviteLink"),background:"white"})},e.prototype.resetInvite=function(t){var e,i;if(e=$(t.currentTarget),!e.hasClass("disabled"))return i=this.model,i.resetInvite({beforeSend:function(){return e.addClass("disabled")},success:function(t){return e.removeClass("disabled")},error:function(){return e.removeClass("disabled"),r.show({message:tb_i18n.get("project.setting.reset.error"),status:"error"})}})},e}(c)},function(t,e){t.exports=function(t){var e='<div class="card-content"> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> <div class="qrcode-img"></div> <p class="qrcode-tip">'+tb_i18n.get("project.settings.add.member.through.url.or.qrcode")+'</p> <div class="input-group member-invite ';return t.supportCopy||(e+="no-copy"),e+='"> <input type="text" class="form-control" value="'+t.inviteLink+'"> <div class="input-group-btn"> ',t.projectPutInfo&&(e+=' <a class="icon icon-refresh hinted reset-invite-url" data-title="'+tb_i18n.get("project.setting.reset.invite")+'"></a> '),e+=' <button class="btn btn-primary copy-invite-url" type="button">'+tb_i18n.get("copy.link")+'</button> </div> </div> <span class="period-of-validity">'+t.qrCodeString+"</span></div>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h=function(t,e){function i(){this.constructor=t}for(var n in e)m.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},m={}.hasOwnProperty;u=i(358),d=i(678),l=i(677),p=i(788),a=i(401),r=i(1686),s=i(1687),o=i(1688),c=i(1689),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.viewName="AddMembersView",e.prototype.className="add-members-view modal-dialog card",e.prototype.events={"click .member":"toggleCheck","input .members-email textarea":"onEmailTextarea","click .submit":"submit"},e.prototype.initialize=function(t){switch(this.type=t.type,this.addHandler=t.addHandler,this.model=t.model,this.isOrganization=t.isOrganization,this.membersLeft=t.membersLeft||0,this.emails=[],this.renderBasic().renderMembersCount(),this.type){case"emails":this.renderEmailsView();break;case"cooperated":this.renderCooperatedView()}return this},e.prototype.renderBasic=function(){var t;return t=function(){switch(this.type){case"emails":return tb_i18n.get("add.members.by.emails");case"cooperated":return tb_i18n.get("add.members.by.cooperated")}}.call(this),this.$el.html(r({title:t,isOrganization:this.isOrganization})),this.$content=this.$(".modal-body"),this.$submit=this.$(".submit"),this.$membersCount=this.$(".members-count"),this},e.prototype.renderEmailsView=function(){var t;return t=this.membersLeft>20?tb_i18n.get("add.members.by.emails.placeholder.unlimit"):tb_i18n.get("add.members.by.emails.placeholder",this.membersLeft),this.$content.html(s({placeholder:t})),this},e.prototype.renderCooperatedView=function(){return this.showLoadingIndicator(this.$content),this.model.getRecommendMembers({success:function(t){return function(e){return t.hideLoadingIndicator(),t.$content.html(o({members:e}))}}(this)}),this},e.prototype.renderMembersCount=function(){var t,e;return this.isOrganization&&(t=this.model.toJSON(),this.membersCurrent=t.membersCount,this.membersLimit=t.plan.membersCount,this.membersTotal=this.membersCurrent+this.emails.length,e=Math.abs(this.membersLimit-this.membersTotal),this.$membersCount.html(c({isOrganization:this.isOrganization,
membersCurrent:this.membersCurrent,membersTotal:this.membersTotal,membersLimit:this.membersLimit,gap:e})),this.checkStatusOfSubmit()),this},e.prototype.checkStatusOfSubmit=function(){return this.membersLimit===-1||this.membersLimit>=this.membersTotal&&this.membersLimit!==this.membersCurrent?this.$submit.removeClass("disabled"):this.$submit.addClass("disabled"),this},e.prototype.onEmailTextarea=function(t){var e,i;return i=$(t.currentTarget).val(),i=i.replace(/，|；|,|;/g," ").replace(/\s+/g," ").trim(),e=i.split(" "),e=u.filter(u.uniq(e),function(t){return l.isEmail(t)}),this.emails=e,this.renderMembersCount(),this},e.prototype.toggleCheck=function(t){return $(t.currentTarget).find(".check-box").toggleClass("checked"),this.emails=$.makeArray(this.$(".cooperated-members .checked").map(function(){return $(this).data("email")})),this.renderMembersCount(),this},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.remove(),this},e.prototype.submit=function(){var t;return this.emails.length>20?a.show({message:tb_i18n.get("add.members.error.limit"),status:"error"}):(this.addHandler(this.emails),t="emails"===this.type?"batch":"worked with",d.gta.event({type:t,control:"button",action:"added "+(this.isOrganization?"org ":"")+"member"}),this.close())},e}(p)},function(t,e){t.exports=function(t){var e='<header class="card-header"> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> <p class="modal-title card-title">'+t.title+'</p></header><div class="card-content"> <div class="modal-body"></div> <div class="modal-footer"> ';return t.isOrganization&&(e+=' <span class="members-count"></span> '),e+=' <button type="button" class="btn btn-primary submit" data-action="submit">'+tb_i18n.get("confirm")+"</button> </div></div>"}},function(t,e){t.exports=function(t){var e='<form  class="members-email"> <textarea class="form-control" rows="10" placeholder="'+t.placeholder+'"></textarea></form>';return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<ul  class="cooperated-members thin-scroll"> ';if(t.members.length){i+=" ";var n=t.members;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li class="member clearfix" data-id="'+r._id+'"> <div class="check-box" data-email="'+r.email+'"> <span class="icon icon-tick"></span> </div> <div class="avatar img-circle img-24" style="background-image:url('+r.avatarUrl+');"></div> <span class="info-name">'+e(r.name)+'</span> <span class="info-email muted">('+e(r.email)+")</span> </li> ";i+=" "}else i+=' <p class="placeholder muted">'+tb_i18n.get("add.members.by.cooperated.placeholder")+"</p> ";return i+="</ul>"}},function(t,e,i){t.exports=function(t){var e="",n=i(798);return t.membersLimit!=-1&&(e+=" ",t.membersLimit>=t.membersTotal&&t.membersLimit!=t.membersCurrent?e+=" <span>"+tb_i18n.get("add.members.tips.add.remian",t.gap)+"</span> ":(e+=" <span> ",e+=t.membersLimit==t.membersTotal?" "+tb_i18n.get("organization.settings.upperLimit")+" ":" "+tb_i18n.get("add.members.tips.add.exceed",t.gap)+" ",e+=" "+tb_i18n.get("comma")+' <a href="'+n.pay.orgAddMember(t._id)+'" target="_blank" class="link-add-handler"> '+tb_i18n.get("organization.settings.update.plan")+" </a> </span> ")),e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li class="team';return t.belongsTo&&(i+=" team-has-parent"),i+=' flex" data-id="'+t._id+'"> <div class="avatar"> <span class="icon '+t.style.styleName+'" style="color:'+t.style.styleColor+'"></span> </div> <p class="abstract"> <span class="name">'+e(t.name)+"&#12539;"+t.hasMembers.length+"</span> ",t.belongsTo&&(i+='<span class="team-breadcrumbs">'+tb_i18n.get("team.belongsTo",t.belongsTo)+"</span>"),i+=' </p> <div class="status"> ',i+=t.inProject?' <p class="added">'+tb_i18n.get("project.memberadd.imported")+"</p> ":' <button class="btn btn-default button-add add-team-handler">'+tb_i18n.get("project.memberadd.import")+"</button> ",i+=" </div></li>"}},function(t,e){t.exports=function(t){var e='<div class="modal-header text-center flex-static"> <div class="modal-title text-center">'+tb_i18n.get("project.memberadd.header.title")+'</div> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a></div><div class="guide-settings-content modal-body thin-scroll flex-fill"> <div class="add-member-header"> <span class="title">'+tb_i18n.get("project.memberadd.inviteViaAccount")+"</span> <div class=\"pull-right\"> <a class=\"link-add-handler batch-add-handler\" data-gta=\"{action: 'add member', type: 'batch', control: 'button', category: 'project'}\"> <i class=\"icon icon-mail\"></i> "+tb_i18n.get("project.settings.add.members.by.emails")+" </a> <a class=\"link-add-handler qrcode-handler\" data-gta=\"{action: 'add member', type: 'qr', control: 'button', category: 'project'}\"> <i class=\"icon icon-qrcode\"></i> "+tb_i18n.get("project.memberadd.addMembersByLink")+' </a> </div> </div> <div class="member-finder"> <input type="text" class="form-control member-info-input" ';return e+=t._organizationId?' placeholder="'+tb_i18n.get("project.memberadd.placeholderForOrg")+'" ':' placeholder="'+tb_i18n.get("project.memberadd.placeholder")+'" ',e+=' > </div> <div class="placeholder-wrapper empty-project-placeholder"> <div class="illustration"></div> <p class="tip"></p> </div> <div class="placeholder-wrapper empty-search-placeholder"> <div class="illustration"></div> <p class="tip"></p> </div> <ul class="list invited-member-list"></ul> <div class="list-wrapper team-wrapper"> <header>'+tb_i18n.get("project.memberadd.orgTeam")+'</header> <ul class="list team-list"></ul> </div> <div class="list-wrapper member-wrapper"> <header></header> <ul class="list member-list"></ul> </div></div><div class="member-progress"></div>'}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li class="member flex" data-id="'+t._id+'" data-email="'+t.email+'"> <div class="avatar img-circle img-24" style="background-image:url('+t.avatarUrl+');"></div> <p class="abstract"> ';return i+=t._userId===t._userMeId?' <span class="name" data-title="'+e(t.name)+"("+tb_i18n.get("me")+')">'+e(t.name)+"("+tb_i18n.get("me")+")</span> ":' <span class="name" data-title="'+t.name+'">'+e(t.name)+"</span> ",i+=' </p> <div class="status"> ',i+=t.inProject?' <p class="added">'+tb_i18n.get("project.memberadd.added")+"</p> ":' <button class="btn btn-default button-add add-member-handler">'+tb_i18n.get("project.memberadd.add")+"</button> ",i+=" </div></li>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;l=i(358),u=i(678),p=i(679),n=i(1694),s=i(813),o=i(699),r=i(401),c=i(677),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.className="project-settings-member-menu-view",e.prototype.viewName="ProjectSettingsMemberMenuView",e.prototype.popoverTitle="",e.prototype.width=250,e.prototype.events={"click .resend-handler":"resendMember","click .role-handler":"setRole","click .delete-handler":"deleteMember","click .upgrade-handler":"upgradeHandler","click .set-role-handler":"setRoleHandler","click li":"hide"},e.prototype.initialize=function(t){if(null==t&&(t={}),t.projectModel||t.memberModel)return this.popoverTitle=tb_i18n.get("project.settings.member.menu"),this.projectModel=t.projectModel,this.memberModel=t.objModel,this.roles=t.roles||[],this.cannotRemove=t.cannotRemove,e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){var t,e;return e=c.getMemberPermissions(this.projectModel,this.memberModel),t=l.extend(this.memberModel.toJSON(),{payType:this.projectModel.getPaymentPlan().payType,_organizationId:this.projectModel.get("_organizationId"),roles:this.roles,teamRelated:this.cannotRemove,myRoleId:this.projectModel.getRoleScope()},e),this.$el.html(n(t)),this},e.prototype.resendMember=function(t){var e;return e=$(t.currentTarget),this.memberModel.saveAttr("resend",null,{wait:!0,success:function(){return r.success(tb_i18n.get("project.settings.email.sent30"))}}),this},e.prototype.deleteMember=function(t){var e;return e=$(t.currentTarget),this.memberModel.destroy({wait:!0,success:function(){return{message:tb_i18n.get("remove.success"),status:"success"}}}),this.hide(),this},e.prototype.setRole=function(t){var e,i;if(e=$(t.currentTarget),i=e.data("role"),1===i.length&&(i=+i),i!==this.memberModel.get("_roleId"))return this.memberModel.saveAttr("_roleId",i,{wait:!0}),this},e.prototype.upgradeHandler=function(t){return this.hide(),this},e.prototype.setRoleHandler=function(t){return this.hide(),this},e}(s)},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(798);if(n+='<ul class="list"> ',(0!=t.isActive||!t.password)&&t.canManageMemberRole){n+=" ","organization"===t.payType&&2===t.myRoleId&&(n+=' <li class="',2==t._roleId&&(n+="selected"),n+='"> <a class="role-handler" data-role="2"> '+tb_i18n.get("owner")+" </a> </li> "),n+=" ","organization"!==t.payType&&"professional"!==t.payType||(n+=' <li class="',1==t._roleId&&(n+="selected"),n+='"> <a class="role-handler" data-role="1"> '+tb_i18n.get("manager")+" </a> </li> "),n+=' <li class="',0==t._roleId&&(n+="selected"),n+='"> <a class="role-handler" data-role="0"> '+tb_i18n.get("member")+" </a> </li> ";var o=t.roles;if(o)for(var s,a=-1,c=o.length-1;a<c;)s=o[a+=1],n+=' <li class="',t._roleId==s._id&&(n+="selected"),n+=" ",0==a&&(n+="underscore"),n+='"> <a class="role-handler" data-role="'+s._id+'"> '+e(s.name)+" </a> </li> ";n+=" <hr/> "}return n+=" ","organization"===t.payType?n+=' <div class="set-role-wrapper"> <a class="set-role-handler" href="/applications/permissions/'+t._organizationId+'" target="_blank"> '+tb_i18n.get("project.settings.member.menu.set.role")+" </a> </div> ":(n+=' <div class="upgrade-wrapper"> <a class="upgrade-handler" href="'+r.pay.plans+"\" target=\"_blank\" data-gta=\"{action: 'view plan option', control: 'permission', type: '",n+=t._organizationId?"business":"plus",n+="'}\"> "+tb_i18n.get("project.settings.member.menu.upgrade.button")+' </a> <p class="description"> '+tb_i18n.get("project.settings.member.menu.upgrade.description")+" </p> </div> "),n+=" ",t.canDeleteMember&&2!==t._roleId&&(n+=' <hr/> <div class="remove-wrapper"> ',n+=t.teamRelated?' <p class="description"> '+tb_i18n.get("project.settings.cannot.remove")+" </p> ":' <a class="delete-member delete-handler"> '+tb_i18n.get("project.settings.remove.member")+" </a> ",n+=" </div> "),n+="</ul>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;p=i(678),l=i(679),r=i(401),s=i(813),o=i(699),n=i(1696),c=i(677),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.className="project-settings-team-menu-view",e.prototype.viewName="ProjectSettingsTeamMenuView",e.prototype.popoverTitle="",e.prototype.width=280,e.prototype.events={"click .remove-handler":"removeTeam"},e.prototype.initialize=function(t){if(null==t&&(t={}),t.projectModel||t.memberModel)return this.popoverTitle=tb_i18n.get("team.menu"),this.projectModel=t.projectModel,this.teamModel=t.objModel,this.cannotRemove=t.cannotRemove,this.projectTeamsCollection=t.projectTeamsCollection,e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){return this.$el.html(n()),this},e.prototype.removeTeam=function(t){var e,i;return this.hide(),e=$(t.currentTarget),i=e.data("action"),this.removeMember="remove"===i,this.teamModel.removeProject(this.projectModel.id,{attrs:{removeMember:this.removeMember},success:function(){return r.success(tb_i18n.get("remove.success"))}})},e}(s)},function(t,e){t.exports=function(t){var e='<ul class="list"> <li> <a class="remove-handler" data-action="remain"> '+tb_i18n.get("project.remove.team.remain.members")+' </a> </li> <li> <a class="remove-handler text-danger" data-action="remove"> '+tb_i18n.get("project.remove.team.remove.members")+" </a> </li></ul>";return e}},function(t,e){t.exports=function(t){var e='<div class="header member-bar-header"> <a class="switch-handler back-to-project-members"> <span class="icon icon-chevron-left"></span> <span class="get-back">'+tb_i18n.get("back")+'</span> </a> <div class="title">'+tb_i18n.get("member.bar.title")+'</div> <a class="icon icon-remove close-handler"></a></div><div class="member-bar-body thin-scroll"> <div class="member-bar-input-wrap"> <input class="filter-input form-control" placeholder="'+tb_i18n.get("member.bar.input")+'" /> </div> <ul class="members-list clearfix"></ul></div><div class="member-progress"></div>';return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="";t.permissions.postMember&&(i+='<li class="member add-members-handler" data-gta="{action: \'begin add member\', control: \'Side Member Menu\'}"> <div class="add-members"> <i class="img-icon img-icon-circle-cross-36 add-member-icon"></i> </div> <p class="add-members-p">'+tb_i18n.get("activity.panel.invite")+"</p></li>");var n=t.teams;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+='<li class="team ',i+="default"==r.type?"all-member":"team-member",i+='" data-id="'+r._id+"\" data-gta=\"{action: 'view team member', control: 'Side Member Menu'}\" data-title=\""+r.name+'"> <div class="team-avatar avatar img-circle img-36 pull-left" ',"default"!=r.type&&r.styleColor&&(i+='style="border-color: '+r.styleColor+'"'),i+='> <span class="icon ',i+="default"!=r.type&&r.styleName?""+r.styleName:"icon-team-tie",i+='" ',"default"!=r.type&&r.styleColor&&(i+='style="color: '+r.styleColor+'"'),i+=' ></span> </div> <div class="team-info flex-vert flex-center"> <div class="team-name item-name hinted" data-title="'+r.name+'"> <span>'+r.name+"</span>・"+r.hasMembers.length+" </div> ",r.belongsTo&&(i+=' <p class="team-child muted"> '+tb_i18n.get("team.belongsTo",r.belongsTo)+" </p> "),i+=" </div> ",t.permissions.delMember&&(i+=' <a class="item-menu-handler icon icon-chevron-down" data-id="'+r._id+'" data-toggle="team"></a> '),i+="</li>";var a=t.members;if(a)for(var c,o=-1,l=a.length-1;o<l;)c=a[o+=1],i+='<li class="member member-detail ui-draggable-handle" data-id="'+c._id+'" data-gta="{action: \'view member info\', control: \'Side Member Menu\'}"> <div class="avatar img-circle img-36 pull-left" style="background-image: url('+c.avatarUrl+')"> ',c.hasVisited||(i+=' <span class="icon icon-leave-state never-visit"></span> '),i+=' </div> <div class="member-info"> <div class="member-name item-name"> <span>'+c.name+'</span> <span class="member-role-icon icon color-role-'+c._roleId+' hinted" data-title="'+c.roleName+'"></span> </div> <p class="member-email muted"> '+e(c.email)+" </p> </div> ",(c.canManageMemberRole||c.canDeleteMember)&&teambition.user.id!==c._id&&(i+=' <a class="item-menu-handler icon icon-chevron-down" data-id="'+c._id+'" data-toggle="member"></a> '),i+="</li>";return i}},function(t,e){t.exports=function(t){var e='<div class="member member-in-drag img-circle img-36" data-id="'+t._id+'" style="background-image:url('+t.avatarUrl+');"></div>';return e}},function(t,e){t.exports=function(t){var e='<div class="library-header-wrap body-wrap"> <header class="library-header"> <div class="library-title">'+tb_i18n.get("library.title")+'</div> <div class="library-header-handler"> ';return t.permissions.collectionPost&&(e+=" <a class=\"collection-creator-toggler link-add-handler\" data-gta=\"{action: 'add content', type: 'folder', control: 'File List'}\"> <span class=\"icon icon-circle-cross\"></span>"+tb_i18n.get("library.create.folder")+" </a> "),e+=" ",t.permissions.workPost&&(e+=" <a class=\"upload-works-handler link-add-handler\" data-gta-ignore='input' data-gta=\"{action: 'add content', type: 'file', control: 'Upload File', method: 'uploader'}\"> <span class=\"icon icon-upload\"></span>"+tb_i18n.get("library.upload.file")+" </a> "),e+=' </div> </header> <div class="library-handler-set clearfix"> <div class="check-box select-all pull-left"> <span class="icon icon-tick"></span> </div> <div class="library-info"> <span class="library-info-name"> <a class="library-sort" data-orderby="name">'+tb_i18n.get("library.name")+'</a> </span> <span class="library-info-size"> <a class="library-sort" data-orderby="size">'+tb_i18n.get("library.size")+'</a> </span> <span class="library-info-author"> '+tb_i18n.get("library.author")+' </span> <span class="library-info-update"> <a class="library-sort" data-orderby="updated">'+tb_i18n.get("library.update")+'</a> </span> </div> <div class="library-handlers"> </div> </div></div><div class="library-content card body-wrap"> <ul class="library-list list clearfix"></ul></div>'}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="dropdown breadcrumbs-dropdown"> <a data-toggle="dropdown" href="#">'+e(t.title)+' <span class="caret"></span></a> <ul class="dropdown-menu" role="menu"> ',n=t.breadcrumbs;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li><a class="breadcrumb-handler" data-id="'+r._id+'">'+e(r.title)+"</a></li> ";return i+=" </ul></div>"}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<ol class="breadcrumbs"> ',n=t.breadcrumbs;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=" ",i+=r._id?' <li><a class="breadcrumb-handler" data-id="'+r._id+'">'+e(r.title)+"</a></li> ":' <li class="active">'+e(r.title)+"</li> ",i+=" ";return i+="</ol>"}},function(t,e,i){t.exports=function(t){var e="",n=i(932),r=n.folderIconT,o=n.fileIconT;return e+='<div class="',e+=t.collection?"collection":"work",e+=' library-drag"> ',e+=t.collection?" "+r(t.collection)+" ":" "+o(t.work)+" ",e+=' <span class="library-badge">'+t.counts+"</span></div>"}},function(t,e){t.exports=function(t){var e="";return t.download&&(e+="<a class=\"library-download-handler\" data-gta=\"{action: 'open detail', type: 'work', control: 'batch', method: 'download'}\"> <span class=\"icon icon-circle-arrow-down-o\"></span> "+tb_i18n.get("library.download")+"</a>"),t.update&&(e+="<a class=\"library-update-handler\" data-gta=\"{action: 'update content', type: 'work', control: 'batch'}\"> <span class=\"icon icon-circle-arrow-down-o\"></span> "+tb_i18n.get("library.file.update")+"</a>"),t.move&&(e+="<a class=\"library-move-handler\" data-gta=\"{action: 'move content', type: 'work', control: 'batch'}\"> <span class=\"icon icon-file-move2\"></span> "+tb_i18n.get("library.move")+"</a>"),t.copy&&(e+="<a class=\"library-copy-handler\" data-gta=\"{action: 'copy content', type: 'work', control: 'batch'}\"> <span class=\"icon icon-copy\"></span> "+tb_i18n.get("library.copy")+"</a>"),t.del&&(e+="<a class=\"library-delete-handler\" data-gta=\"{action: 'delete content', type: 'work', control: 'batch'}\"> <span class=\"icon icon-trash\"></span> "+tb_i18n.get("delete")+"</a>"),e}},function(t,e){t.exports=function(t){var e='<div class="library-placeholder placeholder muted"> ';return t.permissions.workPost&&(e+=' <a class="upload-handler"><span class="icon icon-folder"></span></a> <br /> '),e+=" "+tb_i18n.get("library.placeholder.no.create")+"</div>"}},function(t,e){t.exports=function(t){var e='<div class="library-placeholder placeholder muted"> ';return t.permissions.workPost&&(e+=' <a class="upload-handler"><span class="icon icon-folder"></span></a> '),e+=" <br /> "+tb_i18n.get("library.placeholder")+"</div>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b=function(t,e){function i(){this.constructor=t}for(var n in e)k.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},k={}.hasOwnProperty;v=i(358),y=i(678),p=i(429),m=i(797),f=i(788),a=i(1079),l=i(699),d=i(696),o=i(817),s=i(1708),r=i(1071),u=i(1714),g=i(786),n=i(1719),h=i(804),c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.viewName="EventsView",e.prototype.className="events-view body-wrap fade",e.prototype.hotkeys={c:"openEventCreator"},e.prototype.routes={"":"loadEvents","event/:_eventId":"loadEvents","*paramString":"home"},e.prototype.events={"click .event-create-handler":"openEventCreator","click .event-open-handler":"openEventDetail"},e.prototype.initialize=function(t){if(null!=t?t._projectId:void 0)return this.options=t,this.eventsCache={recent:[],past:[]},this._projectId=this.options._projectId,this.projectModel=d.getOne(0,this._projectId),this.dayView={},this.eventsCollection=a.get(this._projectId,{boundToObjectType:"project"}),this.membersCollection=l.get(this._projectId),this.renderBasic().setupScroll(),v.delay(function(t){return function(){return t.$el.addClass("in")}}(this)),this},e.prototype.home=function(){return this.updateUrl({_eventId:null},{trigger:!0})},e.prototype.listen=function(){return this.listenTo(this.eventsCollection,"add change remove destroy",this.refreshEvents)},e.prototype.loadEvents=function(t){return a.fetch(this._projectId,{url:"projects/"+this._projectId+"/events",silent:!0,attrs:{startDate:p().startOf("day").toISOString()},beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$el,{isPrepend:!1})}}(this),success:function(e){return function(i){if(e.$el)return e.eventsCollection||(e.eventsCollection=i),e.hideLoadingIndicator(),e.listen(),e.renderEvents(),e.renderPastEvents(),t?e.openEventDetail(t):void 0}}(this)}),this},e.prototype.refreshEvents=function(){return a.fetch(this._projectId,{url:"projects/"+this._projectId+"/events",silent:!0,attrs:{startDate:p().startOf("day").toISOString()},success:function(t){return function(e){if(t.$el)return t.eventsCollection||(t.eventsCollection=e),t.renderEvents()}}(this)})},e.prototype.renderBasic=function(){return this.$el.html(n({permissions:this.projectModel.hasPermissions("event.post")})),this.$eventsCardWrap=this.$(".events-card-wrap"),this.$eventsPastWrap=this.$(".past-wrap"),this.$placeholder=this.$(".event-placeholder"),this.$creatorHandler=this.$(".event-create-handler"),this},e.prototype.renderEvents=function(){var t,e;return t=h.fakeWeek(this.eventsCollection,!0),this.eventsCache.recent=t,e=v.groupBy(t,function(t){return p(t.startDate).format("YYYYMMDD")}),this.$eventsCardWrap.empty(),v.mapObject(e,function(t){return function(e,i){return t.renderEventsCard(i,e)}}(this)),this.checkPlaceholder(),this},e.prototype.renderEventsCard=function(t,e){var i;return e=e.map(function(t){return new o(t,{bindByMatrix:!1})}),i=this.requestSubView(s,{day:t,events:e}),i.$el.appendTo(this.$eventsCardWrap)},e.prototype.renderPastEvents=function(){var t;return null!=(t=this.pastEventsView)&&t.remove(),this.pastEventsView=this.requestSubView(u,{_projectId:this._projectId,setCache:function(t){return function(e){return t.eventsCache.past=e}}(this)}),this.$eventsPastWrap.html(this.pastEventsView.$el),this},e.prototype.openEventCreator=function(){return this.requestSubView(g).open(r,{eventsCollection:this.eventsCollection,_projectId:this._projectId,isEssage:!1}),this},e.prototype.openEventDetail=function(t){var e,i,n,r,s;return t.target&&$(t.target).closest(".add-involvement-handler, .remove-member-handler").length?this:(e=t.currentTarget?$(t.currentTarget).data("id"):t,s=v.union(this.eventsCache.recent,this.eventsCache.past),(n=v.find(s,function(t){return t._id===e}))?(i=24===n._id.length?n:v.extend({},n,{_id:n._originEventId}),r=new o(i,{bindByMatrix:!1}),r.collection=this.eventsCollection,y.APP.openEventPreviewer(r||e,{onOpen:function(t){return function(){return t.updateUrl({_eventId:e},{trigger:!1})}}(this)}),y.gta.event({action:"open detail",type:"event",control:"Event List"}),this):void 0)},e.prototype.checkPlaceholder=function(){return this.$placeholder[this.eventsCache.recent.length?"hide":"show"](),this},e.prototype.updateUrl=function(t,e){var i;return i=y.router.getPrefix()+"/events",t._eventId&&(i+="/event/"+t._eventId),y.router.navigate(i,e),this},e}(f),v.extend(c.prototype,m),t.exports=c},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;n=i(1709),r=i(1710),s=i(429),a=i(677),c=i(788),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="EventsCard",e.prototype.tagName="div",e.prototype.className="events-card card",e.prototype.initialize=function(t){if(null==t&&(t={}),t.day||t.events)return this.options=t,this.renderBasic(t.day),this.renderEvents(t.events),this.$el.attr("data-date",t.day),this},e.prototype.renderBasic=function(t){var e;return e="zh"===tb_i18n.getLanguage()?"MMMDo":"MMM Do",t=s(t,"YYYYMMDD"),this.$el.html(n({dayString:t.calendar(),dateString:t.format(e)})),this.$eventList=this.$(".events-card-list"),this},e.prototype.renderEvents=function(t){return t.forEach(function(t){return function(e){var i;return i=t.requestSubView(r,{eventModel:e}),i.$el.appendTo(t.$eventList)}}(this))},e}(c)},function(t,e){t.exports=function(t){var e='<header class="events-card-header card-header"> <span class="witch-day">'+t.dayString+"</span> ";return t.dateString!=t.dayString&&(e+=' <span class="date"> · '+t.dateString+"</span> "),e+='</header><section class="events-card-content"> <ul class="events-card-list"></ul></section>'}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m=function(t,e){function i(){this.constructor=t}for(var n in e)f.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},f={}.hasOwnProperty;a=i(1002),c=i(429),l=i(447),d=i(677),p=i(804),h=i(788),s=i(699),n=i(1711),o=i(1712),u=i(1713),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.viewName="EventView",e.prototype.tagName="li",e.prototype.className="event-view clearfix event-open-handler",e.prototype.initialize=function(t){if(t.eventModel)return this.options=t,this.eventModel=t.eventModel,this.renderBasic(),this.renderTime(),this.renderInfo(),this.options.hideInvolve||this.renderInvolve(),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$el.attr({"data-id":this.eventModel.id}),this.$eventTime=this.$(".event-time"),this.$eventInfoContainer=this.$(".event-content-container"),this.$involveSet=this.$(".involve-set"),this},e.prototype.renderTime=function(){var t,e,i,n,r;return t=this.eventModel.toJSON(),t.isAllDay=this.eventModel.checkAllDay(),t.title=d.escape(t.title),t.content=d.escape(t.content),t.location=d.escape(t.location),t.isAllDay?(t.startDateString=""+d.formatDate(t.startDate).dateString+tb_i18n.get("event.all.day.tips"),e=c(t.endDate).subtract(1,"day"),i=""+d.formatDate(e).dateString+tb_i18n.get("event.all.day.tips"),t.startDateString!==i&&(t.endDateString=i)):(r=d.formatDate(new Date).dateString,n=d.formatDate(new Date(t.startDate)).dateString,n===r?t.startDateString=c(t.startDate).format("LT"):t.startDateString=n+" "+c(t.startDate).format("LT"),t.endDate&&(i=d.formatDate(t.endDate).dateString,i===r?t.endDateString=c(t.endDate).format("LT"):t.endDateString=i+" "+c(t.endDate).format("LT"))),this.eventModel.isRecurrenceEventInstance()&&(t.freqString=p.freq2Title(this.eventModel.getRRuleSet())),this.$eventTime.html(u(t)),this},e.prototype.renderInfo=function(){var t;return t=this.eventModel.toJSON(),this.$eventInfoContainer.html(o(t)),this},e.prototype.renderInvolve=function(){return this.requestSubView(a,{_projectId:this.eventModel.get("_projectId"),objectModel:this.eventModel,membersCollection:s.get(this.eventModel.get("_projectId")),saveOnHidden:!0,dropArea:this.$el,undeletable:!1}).$el.prependTo(this.$involveSet),this},e}(h),t.exports=r},function(t,e){t.exports=function(t){var e='<div class="event-time"></div><div class="event-content"> <div class="event-content-container"></div> <div class="involve-set"></div></div><a class="button more icon icon-chevron-right"></a>';return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<h3 class="event-title">'+e(t.title)+"</h3>";return t.location&&(i+=' <p class="event-place"> <span class="icon-location icon"></span> '+e(t.location)+" </p>"),"involves"==t.visible&&(i+=' <span class="icon icon-lock hinted" data-title="'+tb_i18n.get("visible.to.involve")+'"></span>'),i}},function(t,e){t.exports=function(t){var e=" <time>"+t.startDateString+"</time> ";return t.endDateString&&(e+=" ~ <time>"+t.endDateString+"</time> "),e+=" ",t.freqString&&(e+=' <span class="label label-info event-recurrence"><span class="icon icon-repeat"></span>'+t.freqString+"</span> "),e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f=function(t,e){function i(){this.constructor=t}for(var n in e)g.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},g={}.hasOwnProperty;m=i(358),c=i(429),d=i(677),h=i(788),o=i(1710),s=i(1079),r=i(817),l=i(1715),u=i(804),n=i(1717),a=i(1718),t.exports=p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.viewName="PastEventsView",e.prototype.className="past-events-view accordion",e.prototype.events={"click .past-events-toggler":"togglePastEvents","show.bs.collapse":"loadPastEvents","hidden.bs.collapse":"clearPastEvents"},e.prototype.initialize=function(t){return!!t._projectId&&(this._projectId=t._projectId,this.setCache=t.setCache,this.renderBasic(),l.get(this._projectId).fetch({url:"projects/"+this._projectId+"/events_count",attrs:{endDate:c().startOf("day").toISOString()},beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$el,{isPrepend:!1})}}(this),success:function(t){return function(e){if(t.$el)return t.pastEventsGroupsCollection=e,t.hideLoadingIndicator(),t.renderGroup()}}(this)}),this)},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$pastEvents=this.$(".past-events-wrap"),this},e.prototype.renderGroup=function(){var t,e;return t=[],e=0,m.each(this.pastEventsGroupsCollection.toJSON(),function(i){
if(i.count)return e+=i.count,i.monthString=c(i.month,"YYYYMM").format(tb_i18n.get("moment.MMMMYYYY")),t.push(i)}),t.sort(function(t,e){return e.month-t.month}),this.$pastEvents.html(a({groups:t})),this.$(".past-events-total").text(e),this},e.prototype.loadPastEvents=function(t){var e,i,n;return this.clearPastEvents(t),e=$(t.target),this.$eventList=e.find(".events-list"),i=e.data("month"),this.showLoadingIndicator(this.$eventList,{isPrepend:!1}),this.fromDate=c(i,"YYYYMM").startOf("month"),this.toDate=c(i,"YYYYMM").endOf("month"),n=c().subtract(1,"days").endOf("day"),this.fromDate.isBefore(n)&&(this.toDate.isAfter(n)&&(this.toDate=n),s.get(this._projectId+"_"+i).fetch({url:"projects/"+this._projectId+"/events",silent:!0,fromDate:this.fromDate.toISOString(),toDate:this.toDate.toISOString(),attrs:{startDate:this.fromDate.toISOString(),endDate:this.toDate.toISOString()},success:function(t){return function(e){if(t.$el)return t.hideLoadingIndicator(),t.renderEvents(e)}}(this)})),this},e.prototype.clearPastEvents=function(t){return $(t.target).find(".events-list").empty(),this},e.prototype.renderEvents=function(t){return t=u.fakeByCollection(t,this.fromDate,this.toDate).reverse(),this.setCache(t),t=t.map(function(t){return new r(t,{bindByMatrix:!1})}),t.forEach(function(t){return function(e){var i;return i=t.requestSubView(o,{eventModel:e,hideInvolve:!0}),i.$el.appendTo(t.$eventList)}}(this)),this},e.prototype.togglePastEvents=function(t){var e;if(this.pastEventsGroupsCollection.length)return this.$pastEvents.toggleClass("active"),e=this.$pastEvents.hasClass("active"),$(t.currentTarget).text(e?tb_i18n.get("hide"):tb_i18n.get("show")),e?this.scrollToView(this.$pastEvents):void 0},e.prototype.scrollToView=function(t){return m.delay(function(e){return function(){var i;return null!=(i=e.parentView)&&"function"==typeof i.slideTo?i.slideTo(t,!0,150):void 0}}(this)),this},e}(h)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;n=i(685),r=i(1716),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.name="pastEventsGroups",e.prototype.model=r,e.prototype.comparator=function(t,e){return t.get("month")-e.get("month")},e}(n)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(688),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.name="pastEventsGroup",e.prototype.urlRoot="",e.prototype.idAttribute="month",e.prototype.defaults={month:"",count:0},e}(n)},function(t,e){t.exports=function(t){var e='<header class="past-events-header"> <div class="past-events-title"> '+tb_i18n.get("events.past")+'・<span class="past-events-total">0</span> <a class="past-events-toggler" data-gta="{action: \'toggle past events\'}">'+tb_i18n.get("show")+'</a> </div></header><div class="past-events-wrap card accordion"></div>';return e}},function(t,e){t.exports=function(t){var e='<ul id="past-events-accordion"> ',i=t.groups;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <li class="panel"> <div class="accordion-title collapsed" data-toggle="collapse" data-parent="#past-events-accordion" href="#past-events-group'+r+'" data-gta="event" data-label="events|show past events"> <span class="caret pull-left"></span> <span>'+n.monthString+'</span> </div> <div id="past-events-group'+r+'" class="collapse" data-month="'+n.month+'"> <ul class="accordion-list events-list"></ul> </div> </li> ';return e+="</ul>"}},function(t,e){t.exports=function(t){var e="";return t.permissions.eventPost&&(e+='<div class="events-header body-wrap"> <div class="card"> <a class="event-create-handler link-add-handler" data-gta="{action: \'add content\', type: \'event\', control: \'New Event\'}"> <span class="icon icon-circle-cross"></span>'+tb_i18n.get("events.add")+"</a> </div></div>"),e+='<div class="events-card-wrap"></div><div class="event-placeholder placeholder muted card"> <span class="icon icon-calendar"></span> <br /> '+tb_i18n.get("events.placeholder")+'</div><div class="past-wrap"></div>'}},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(358),o=i(788),n=i(1327),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="ProjectMessageView",e.prototype.className="project-message-view body-wrap card fade",e.prototype.initialize=function(t){return this.panelView=this.requestSubView(n,{modelId:t._projectId}),this.renderBasic(),s.delay(function(t){return function(){return t.$el.addClass("in")}}(this))},e.prototype.renderBasic=function(){return this.$el.html(this.panelView.$el),this},e}(o)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T=function(t,e){function i(){this.constructor=t}for(var n in e)M.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},M={}.hasOwnProperty,C=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};w=i(358),j=i(678),f=i(797),y=i(677),b=i(788),r=i(1264),h=i(697),m=i(696),a=i(1266),l=i(1267),p=i(1268),o=i(1722),u=i(1273),d=i(1613),g=i(1723),v=i(1728),k=i(786),n=i(1734),c=i(1735),_={category:"_entryategoryId",creator:"_creatorId"},s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return T(e,t),e.prototype.viewName="BookkeepingView",e.prototype.tagName="div",e.prototype.className="bookkeeping-view fade body-wrap",e.prototype.order="asc",e.prototype.orderBy="update",e.prototype.routes={"":"enterHome","entry/:_entryId":"enterHome","*paramString":"onRouteError"},e.prototype.events={"click .bookkeeping-creator":"openCreator","click .open-detail":"openDetail","click .bookkeeping-sort":"sortHandler","click .bookkeping-setting-approver":"openSettingsApprover","click .bookkeping-setting-displayFields":"openSettingsDisplayFields","click .bookkeeping-header-tips-close":"closeHeaderTips","click .bookkeeping-panel-toggler":"togglePanel"},e.prototype.initialize=function(t){if(t)return this.options=t,this._projectId=t._projectId,this.projectModel=m.getOne(0,this._projectId),this.renderBasic(),this.load().then(function(t){return function(){return t.listen(),t.renderContent(),t.renderItems(),t.initCreator(),t.initPanel(),t.calculateAmount(),t.checkPlaceholder(),t.checkApproveTips()}}(this))["catch"](function(t){return console.error(t)}),this.registerAsResponsive(),this.setupScroll(),w.delay(function(t){return function(){return t.$el.addClass("in"),t.layout()}}(this),100)},e.prototype.enterHome=function(t){return this.openDetail(t,{isRouter:!0})},e.prototype.onRouteError=function(){return j.router.home(),this},e.prototype.layout=function(){var t,e;return t=$(window).height()-this.$content.offset().top,this.$content.css("min-height",t+"px"),null!=(e=this.bookkeepingPanel)&&e.layout(),this},e.prototype.load=function(){return this.showLoadingIndicator(this.$content,{isPrepend:!0}),new Promise(function(t){return function(e,i){return a.fetch(t._projectId,{success:function(i){return t.bookkeepingModel=i.at(0),e()},error:i})}}(this)).then(function(t){return function(){return new Promise(function(e,i){return l.fetch(t._projectId,{success:function(i){return t.entriesCollection=i,e()},error:i})})}}(this)).then(function(t){return function(){return new Promise(function(e,i){return p.fetch(t._projectId,{success:function(i){return t.entryCategoriesCollection=i,e()},error:i})})}}(this)).then(function(t){return function(){return t.hideLoadingIndicator()}}(this))},e.prototype.loadMore=function(t){return this.entriesCollection.loadMore({silent:!0,beforeSend:function(t){return function(){return t.showLoadingIndicator(t.$itemList)}}(this),success:function(e){return function(i,n,r){if(e.hideLoadingIndicator({animated:!0}),e.renderItems(n),e.bookkeepingPanel.refilter(),e.calculateAmount(),e.entriesCollection.hasMore)return"function"==typeof t?t():void 0}}(this)}),this},e.prototype.listen=function(){return this.stopListening(),this.listenTo(this.bookkeepingModel,"change:displayFields",function(t){return function(e){return t.renderContent(),t.renderItems(),t.bookkeepingPanel.filterEntries(),t.calculateAmount()}}(this)),this.listenTo(this.bookkeepingModel,"change:tipsClosed change:_approverIds",this.checkApproveTips),this.listenTo(this.entriesCollection,"add",function(t){return function(e){return t.renderItems(e,!0)}}(this)),this.listenTo(this.entriesCollection,"add remove",function(t){return function(){return t.checkPlaceholder(),t.checkApproveTips()}}(this)),this.listenTo(this.entriesCollection,"add change:amount remove",function(t){return function(){return t.calculateAmount()}}(this)),this.listenTo(this.entriesCollection,"remove",this.removeItem),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$content=this.$(".bookkeeping-content"),this},e.prototype.renderContent=function(){var t;return t=this.bookkeepingModel.getDisplayFields(),this.$content.html(c(t)),this.$itemList=this.$content.find(".bookkeeping-list"),this.$placeholder=this.$(".bookkeeping-placeholder"),this},e.prototype.renderItems=function(t,e){var i,n;return this.renderSort(),t&&w.isArray(t)?i=t:t?i=[t]:(this.$itemList.empty(),n=(_[this.orderBy]?_[this.orderBy]:void 0)||this.orderBy,this.entriesCollection.orderBy=n,this.entriesCollection.sort(),i=this.entriesCollection.toJSON(),"desc"===this.order&&i.reverse()),w.each(i,function(t){return function(i){return t.renderItem(i,e)}}(this)),this},e.prototype.renderItem=function(t,e){var i,n,r;return r=t.id||t._id,n=this.$itemList.find(".entry-view[data-id="+r+"]"),i=this.requestSubView(d,{_entryId:r,viewType:"open-detail"}).$el,n.length?n.replaceWith(i):i[e===!0?"prependTo":"appendTo"](this.$itemList),this},e.prototype.removeItem=function(t){var e;return e=t.id||t._id,this.$itemList.find(".entry-view[data-id="+e+"]").remove(),this},e.prototype.renderSort=function(){var t,e,i,n;return i=this.order,n=this.orderBy,e=".bookkeeping-sort",this.$el.find(e+".dropup").removeClass("dropup"),this.$el.find(e+" .caret").remove(),t=this.$el.find(e+"[data-orderby='"+n+"']"),t.append("<span class='caret'></span>"),"asc"===i&&t.addClass("dropup"),this},e.prototype.initCreator=function(){return this.projectModel.hasPermission("entry.post")&&this.$(".bookkeeping-creator").removeClass("hide"),this},e.prototype.initPanel=function(){var t;return null!=(t=this.bookkeepingPanel)&&t.remove(),this.bookkeepingPanel=this.requestSubView(o,{_projectId:this._projectId}),this.listenTo(this.bookkeepingPanel,"filtering",function(t){return function(){return t.isFiltering=!0,t.$el.addClass("filtering"),t.calculateAmount()}}(this)),this.listenTo(this.bookkeepingPanel,"stopFilter",function(t){return function(){return t.isFiltering=!1,t.$el.removeClass("filtering"),t.calculateAmount()}}(this)),this.listenTo(this.bookkeepingPanel,"show",function(t){return function(){return t.$el.addClass("pannel-showing")}}(this)),this.listenTo(this.bookkeepingPanel,"hide",function(t){return function(){return t.$el.removeClass("pannel-showing")}}(this)),this.bookkeepingPanel.$el.appendTo(this.$(".bookkeeping-header-wrap")),this},e.prototype.calculateAmount=function(){var t,e,i;return t=0,i=0,this.isFiltering?(e=[],this.$itemList.children().filter(":visible").each(function(){var t,i;if(t=$(this),i=t.data("id"))return e.push(i)}),this.entriesCollection.each(function(n){var r;if(r=n.id,!(C.call(e,r)<0))return n.get("type")===-1?t+=n.get("amount")||0:i+=n.get("amount")||0})):this.entriesCollection.each(function(e){return e.get("type")===-1?t+=e.get("amount")||0:i+=e.get("amount")||0}),this.$(".bookkeeping-expense .bookkeeping-amount").text(t.toFixed(2)),this.$(".bookkeeping-income .bookkeeping-amount").text(i.toFixed(2)),this},e.prototype.checkApproveTips=function(){var t,e,i,n,r,o;return r=this.bookkeepingModel,i=this.entriesCollection,t=this.$(".bookkeeping-header-tips"),e=this.$(".bookkeeping-approve-tips"),o="header-tips-showing",n=this.bookkeepingModel.hasPermission("put.approvers"),n&&0===r.get("_approverIds").length&&i.length&&!r.get("tipsClosed")?(t.show(),this.layout()):(t.hide(),this.layout()),n&&0===r.get("_approverIds").length&&0===i.length?e.show():e.hide(),this},e.prototype.checkPlaceholder=function(){var t;return t=this.entriesCollection.length>0?"hide":"show",this.$placeholder[t](),this},e.prototype.openCreator=function(t){var e,i;if((null!=t?t.currentTarget:void 0)?(e=this.$(t.currentTarget),i=e.data("type")):i=t,i=parseInt(i),1===i||i===-1)return this.requestSubView(k).open(u,{type:i,_projectId:this._projectId})},e.prototype.openSettingsDisplayFields=function(t){return this.requestSubView(k).open(v,{bookkeepingModel:this.bookkeepingModel})},e.prototype.openSettingsApprover=function(t){return this.requestSubView(k).open(g,{bookkeepingModel:this.bookkeepingModel})},e.prototype.openDetail=function(t,e){var i,n,r;if((null!=t?t.currentTarget:void 0)?(i=$(t.currentTarget),n=i.data("id")):n=t,n)return j.APP.openEntryPreviewer(n),(null!=e?e.isRouter:void 0)?void 0:(r=j.router.getPrefix()+("/bookkeeping/entry/"+n),j.router.navigate(r))},e.prototype.closeHeaderTips=function(){return this.bookkeepingModel.set("tipsClosed",!0),this},e.prototype.togglePanel=function(){return this.bookkeepingPanel.toggle(),this},e.prototype.sortHandler=function(t){var e,i,n;return t.currentTarget?(e=$(t.currentTarget),n=e.data("orderby")):n=t,this.orderBy===n?this.order="asc"===this.order?"desc":"asc":(this.orderBy=n,i=["category","content","creator","receiver"],this.order=C.call(i,n)>=0?"asc":"desc"),this.renderItems(),this.bookkeepingPanel.filterEntries()},e}(b),w.extend(s.prototype,f),t.exports=s},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k=function(t,e){function i(){this.constructor=t}for(var n in e)w.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},w={}.hasOwnProperty,_=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};b=i(358),p=i(688),g=i(677),v=i(788),o=i(1266),c=i(1267),l=i(1268),m=i(1053),u=i(1723),d=i(1725),h=i(1728),y=i(786),n=i(1730),s=i(1731),a=i(1732),f=i(1733),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return k(e,t),e.prototype.viewName="BookkeepingPanelView",e.prototype.tagName="div",e.prototype.className="bookkeeping-panel-view",e.prototype.events={"click .bookkeeping-panel-toggler":"hide","click a.bookkeeping-panel-settings-toggler":"toggleSettings","click .filter-date-hanlder":"showDatePicker","input .filter-query-input":"setQuery","click .tag":"setTagIds","click .member":"setCreatorId","click .category":"setCategoryId","click .filter-approved-handler":"toggleIsFilterApproved","click .filter-clear-handler":"resetFilter","click .bookkeeping-panel-settings-handler":"settingsHandler","mousewheel .scrollable":g.mousewheel},e.prototype.initialize=function(t){if(!t._projectId)throw new Error(this.viewName+":options should have _projectId");return this.options=t,this._projectId=t._projectId,this.load().then(function(t){return function(){return t.resetFilter().listen().renderBasic().renderCategories().renderCreators().renderTags().refreshStatus()}}(this))["catch"](function(t){return console.error(t)}),b.delay(function(t){return function(){return t.layout()}}(this),100),e.__super__.initialize.apply(this,arguments)},e.prototype.load=function(){return Promise.all([new Promise(function(t){return function(e,i){return o.fetch(t._projectId,{success:function(i){return t.bookkeepingModel=i.at(0),e()},error:i})}}(this)),new Promise(function(t){return function(e,i){return c.fetch(t._projectId,{success:function(i){return t.entriesCollection=i,e()},error:i})}}(this)),new Promise(function(t){return function(e,i){return l.fetch(t._projectId,{success:function(i){return t.entryCategoriesCollection=i,e()},error:i})}}(this)),new Promise(function(t){return function(e,i){return m.fetch(t._projectId,{success:function(i){return t.tagsCollection=i,e()},error:i})}}(this))])},e.prototype.resetFilter=function(){return this.filterModel||(this.filterModel=new p),this.filterModel.set({query:"",startDate:"",endDate:"",categoryId:"",tagIds:[],creatorId:"",isFilterApproved:!1}),this},e.prototype.listen=function(){return this.listenTo(this.filterModel,"change",function(t){return function(){return t.refreshStatus(),t.filterEntries()}}(this)),this.listenTo(this.entriesCollection,"change:date change:content",function(t){return function(){return t.filterEntries(!0)}}(this)),this.listenTo(this.entriesCollection,"change:_entryCategoryId",function(t){return function(){return t.renderCategories(),t.refreshStatus(),t.filterEntries(!0)}}(this)),this.listenTo(this.entriesCollection,"change:tagIds",function(t){return function(){return t.renderTags(),t.refreshStatus(),t.filterEntries(!0)}}(this)),this.listenTo(this.entriesCollection,"add",function(t){return function(){return t.renderCategories(),t.renderTags(),t.renderCreators(),t.refreshStatus(),t.filterEntries(!0)}}(this)),this.listenTo(this.entriesCollection,"remove",function(t){return function(){return t.renderCategories(),t.renderTags(),t.renderCreators(),t.refreshStatus()}}(this)),this.listenTo(this.entryCategoriesCollection,"remove",function(t){return function(){return t.renderCategories()}}(this)),this},e.prototype.layout=function(){var t,e;return t=$(window),e=t.height()-this.$el.offset().top+t.scrollTop(),this.$el.css("height",e+"px"),this},e.prototype.renderBasic=function(){return this.$el.html(n({permissions:this.bookkeepingModel.hasPermissions("put.approvers","put.categories","put.fields")})),this.triggerHook("render"),this},e.prototype.renderCategories=function(){var t,e,i,n,r,o,a,c;a=[],o=!1,c=this.entriesCollection.getEntryCategoryIdsCount();for(e in c)n=c[e],i=this.entryCategoriesCollection.get(e),n>0&&i?a.push(i.toJSON()):n>0&&(o=!0);return o&&a.push(this.entryCategoriesCollection.getCategory().toJSON()),r={categories:a},t=this.$(".bookkeeping-panel-filter-categories"),t.html(s(r)),this},e.prototype.renderCreators=function(){var t,e,i;return i=this.entriesCollection.getCreators(),e={creators:i},t=this.$(".bookkeeping-panel-filter-creators"),t.html(a(e)),this},e.prototype.renderTags=function(){var t,e,i,n,r,o,s,a,c;for(o=[],s=this.entriesCollection.getTagIdsCount(),a=this.tagsCollection.toJSON(),n=0,r=a.length;n<r;n++)c=a[n],e=s[c._id],e&&(c.count=e,o.push(c));return i={tags:o},t=this.$(".bookkeeping-panel-filter-tags"),t.html(f(i)),this},e.prototype.refreshStatus=function(){var t,e,i,n,r,o,s,a,c,l,p,u,d,h;if(r=this.filterModel.toJSON(),this.$("input").val(r.query),h=(d=this.filterModel.get("startDate"))?null!=(l=g.formatDate(d))?l.dateString:void 0:tb_i18n.get("bookkeeping.panel.filter.start.date"),this.$(".filter-start-date").text(h),n=(i=this.filterModel.get("endDate"))?null!=(p=g.formatDate(i))?p.dateString:void 0:tb_i18n.get("bookkeeping.panel.filter.end.date"),this.$(".filter-end-date").text(n),this.$(".selected").removeClass("selected"),r.categoryId&&this.$(".category[data-id="+r.categoryId+"]").parent().addClass("selected"),r.tagIds.length)for(u=r.tagIds,o=0,c=u.length;o<c;o++)s=u[o],this.$(".tag[data-id="+s+"]").parent().addClass("selected");return r.creatorId&&this.$(".member[data-id="+r.creatorId+"]").parent().addClass("selected"),t=this.$(".filter-clear-handler"),r.categoryId||r.tagIds.length||r.creatorId||r.query||r.startDate||r.endDate?t.addClass("active"):t.removeClass("active"),a=this.filterModel.get("isFilterApproved"),e=this.$(".filter-approved-handler"),e[a?"addClass":"removeClass"]("active"),this},e.prototype.showDatePicker=function(t){var e,i,n,r;return e=$(t.currentTarget),n=e.data("type"),e.data("datepicker")?(r=!e.data("showDatepicker"),e.data("showDatepicker",r),e.data("datepicker").picker.toggle(r)):(i=this.filterModel.get(n),i=i?new Date(i):new Date,e.datepicker({format:"yyyy-mm-dd",language:tb_i18n.getLanguage(),todayHighlight:!0,placement:"left",todayBtn:"linked",tomorrowBtn:"linked",clearBtn:"linked"}).datepicker("update",i).datepicker("show").focus().on("changeDate",function(t){return function(i){return t.filterModel.set(n,i.date),e.datepicker("hide")}}(this)).on("hide",function(t){return e.data("showDatepicker",!1)}),e.data("showDatepicker",!0)),this},e.prototype.setQuery=function(t){var e;return e=$(t.currentTarget),this.filterModel.set("query",e.val()),this},e.prototype.setTagIds=function(t){var e,i,n;return e=$(t.currentTarget),i=e.data("id"),n=b.clone(this.filterModel.get("tagIds")),_.call(n,i)>=0?n=b.without(n,i):n.push(i),this.filterModel.set("tagIds",n),this},e.prototype.setCategoryId=function(t){var e,i,n;return e=$(t.currentTarget),n=e.data("id"),i=this.filterModel.get("categoryId"),i===n&&(n=""),this.filterModel.set("categoryId",n),this},e.prototype.setCreatorId=function(t){var e,i,n;return e=$(t.currentTarget),n=e.data("id"),i=this.filterModel.get("creatorId"),i===n&&(n=""),this.filterModel.set("creatorId",n),this},e.prototype.toggleIsFilterApproved=function(t){var e;return e=this.filterModel.get("isFilterApproved"),this.filterModel.set("isFilterApproved",!e),this},e.prototype.filterEntries=function(t){var e,i,n,r,o,s,a,c,l,p,u,d,h;if(t&&!this.filtering)return this;for(this.filtering=!1,a=this.filterModel.toJSON(),r=this.entriesCollection.toJSON(),l=0,p=r.length;l<p;l++)o=r[l],e=this.parentView.$el.find(".entry-view[data-id="+o._id+"]"),c=!1,a.isFilterApproved&&"approved"===o.status&&(c=!0),!c&&a.startDate&&o.date&&(h=new Date(a.startDate).getTime(),i=new Date(o.date).getTime(),i<h&&(c=!0)),!c&&a.endDate&&o.date&&(n=new Date(a.endDate).getTime(),i=new Date(o.date).getTime(),i>n&&(c=!0)),!c&&a.creatorId&&a.creatorId!==o._creatorId&&(c=!0),!c&&a.categoryId&&(u=this.entryCategoriesCollection.getCategory(o._entryCategoryId).toJSON(),u._id!==a.categoryId&&(c=!0)),c||!a.tagIds.length||b.find(o.tagIds,function(t){return b.contains(a.tagIds,t)})||(c=!0),!c&&(d=a.query)&&(d=d.toLowerCase(),!g.matchString(o.note.toLowerCase(),d)&&!g.matchString(o.content.toLowerCase(),d)&&e.text().toLowerCase().indexOf(d)<0&&(c=!0)),e[c?"addClass":"removeClass"]("hide"),c&&(this.filtering=!0);return s=this.filtering?"filtering":"stopFilter",this.trigger(s),this},e.prototype.refilter=function(){return this.renderCategories(),this.renderTags(),this.renderCreators(),this.refreshStatus(),this.filterEntries(!0)},e.prototype.settingsHandler=function(t){var e,i;switch(e=$(t.currentTarget),i=e.data("type")){case"approve":return this.openSettingsApprover(t);case"displayFields":return this.openSettingsDisplayFields(t);case"category":return this.openSettingsCategory(t)}},e.prototype.openSettingsDisplayFields=function(t){return this.requestSubView(y).open(h,{bookkeepingModel:this.bookkeepingModel})},e.prototype.openSettingsApprover=function(t){return this.requestSubView(y).open(u,{bookkeepingModel:this.bookkeepingModel})},e.prototype.openSettingsCategory=function(t){return this.requestSubView(y).open(d,{_projectId:this._projectId})},e.prototype.toggleSettings=function(){return this.$el.toggleClass("open"),this},e.prototype.hide=function(t){return this.$el.removeClass("panel-active"),this.trigger("hide"),!1},e.prototype.show=function(t){return this.$el.addClass("panel-active"),this.trigger("show"),!1},e.prototype.toggle=function(t){return this.$el.hasClass("panel-active")?this.hide():this.show(),!1},e.prototype.remove=function(){return this.resetFilter(),e.__super__.remove.apply(this,arguments)},e}(v)},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;l=i(358),p=i(678),n=i(1724),r=i(1264),a=i(699),s=i(1002),c=i(980),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="BookkeepingSettingsApproverView",e.prototype.tagName="div",e.prototype.className="bookkeeping-settings-approver-view",e.prototype.modalTitle="",e.prototype.events={"click .settings-in-hanlder":"inHandler","click .settings-out-hanlder":"outHandler","submit .settings-form":"submit"},e.prototype.initialize=function(t){if(!t.bookkeepingModel)throw new Error(this.viewName+":options should have bookkeepingModel");return this.modalTitle=tb_i18n.get("bookkeeping.settings.approver.title"),this.options=t,this.bookkeepingModel=t.bookkeepingModel,this._projectId=this.bookkeepingModel.get("_projectId"),this.model=new r({_projectId:this.bookkeepingModel.get("_projectId"),involveMembers:this.bookkeepingModel.get("_approverIds")}),l.delay(function(t){return function(){return t.$el.addClass("in")}}(this),100),e.__super__.initialize.apply(this,arguments)},e.prototype.renderMain=function(t){return t.html(n()),this.load().then(function(t){return function(){return t.initMemberPicker()}}(this))["catch"](function(t){return console.error(t),this.close()})},e.prototype.load=function(){return new Promise(function(t){return function(e,i){return a.fetch(t._projectId,{success:function(i){return t.membersCollection=i,e()},error:i})}}(this))},e.prototype.initMemberPicker=function(){return this.involveView=this.requestSubView(s,{_projectId:this._projectId,objectModel:this.model,customPermission:"put.approvers",membersCollection:this.membersCollection,saveOnHidden:!0,dropArea:this.$el}),this.involveView.$el.prependTo(this.$(".settings-members")),this},e.prototype.saveApprovers=function(){if(!l.isEqual(this.bookkeepingModel.get("_approverIds"),this.model.get("involveMembers")))return this.bookkeepingModel.save(null,{attrs:{_approverIds:this.model.get("involveMembers")}})},e.prototype.onClose=function(){return this.saveApprovers()},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.remove(),this},e}(c)},function(t,e){t.exports=function(t){var e='<form class="settings-form"> <div class="settings-approve">'+tb_i18n.get("bookkeeping.settings.approver.member")+'</div> <div class="settings-members"></div> <div class="settings-tips">'+tb_i18n.get("bookkeeping.settings.approver.tips")+"</div></form>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;p=i(358),u=i(678),n=i(1726),o=i(1727),s=i(1267),a=i(1268),c=i(980),l=i(677),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.viewName="BookkeepingSettingsCategoriesView",e.prototype.tagName="div",e.prototype.className="bookkeeping-settings-categories-view",e.prototype.modalTitle="",e.prototype.type=1,e.prototype.events={"keyup .add-input":"keyupAddInput","click .link-add-handler":"createCategory","click .settings-switcher":"switchType","click .settings-event-source":"triggerEvent","keyup .category-input":"keyeupCategoryInput","deleteCategory .category":"deleteCategory","enterEditing .category":"enterEditing","updateCategory .category":"updateCategory","exitEditing .category":"exitEditing"},e.prototype.initialize=function(t){if(!t._projectId)throw new Error(this.viewName+":options should have _projectId");return this.modalTitle=tb_i18n.get("bookkeeping.settings.category.title"),this.options=t,this._projectId=t._projectId,p.delay(function(t){return function(){return t.$el.addClass("in")}}(this),100),e.__super__.initialize.apply(this,arguments)},e.prototype.renderMain=function(){return this.$modalBody.html(n()),this.$list=this.$(".settings-list"),this.load().then(function(t){return function(){return t.listen(),t.renderCategories()}}(this))["catch"](function(t){return console.error(t)})},e.prototype.load=function(){return new Promise(function(t){return function(e,i){return a.fetch(t._projectId,{success:function(i){return t.entryCategoriesCollection=i,e()},error:i})}}(this)).then(function(t){return function(){return new Promise(function(e,i){return s.fetch(t._projectId,{success:function(i){return t.entriesCollection=i,e()},error:i})})}}(this))},e.prototype.listen=function(){return this.listenTo(this.entryCategoriesCollection,"remove destroy",this.removeCategory),this.listenTo(this.entryCategoriesCollection,"add change",function(t){return function(e){return t.renderCategory(e.toJSON(),!0)}}(this)),this},e.prototype.renderCategories=function(){var t,e;return this.$list.empty(),t=!1,e=this.entryCategoriesCollection.getCategories(this.type,t),p.each(e,function(t){return function(e){return t.renderCategory(e)}}(this)),this},e.prototype.renderCategory=function(t,e){var i,n;return n=t.id||t._id,t.toJSON&&(t=t.toJSON()),i=this.$(".category[data-id="+n+"]"),i.length?i.replaceWith(o(t)):this.$list[e?"prepend":"append"](o(t)),this},e.prototype.removeCategory=function(t){var e,i;return i=t.id||t._id,e=this.$(".category[data-id="+i+"]"),e.remove()},e.prototype.switchType=function(t){var e,i;if(e=$(t.currentTarget),i=parseInt(e.data("type")),i&&i!==this.type)return this.type=i,this.$(".settings-switcher-wrap").removeClass("active"),this.$(".settings-switcher[data-type="+i+"]").parent().addClass("active"),this.renderCategories(),this},e.prototype.keyupAddInput=function(t){return 13===t.keyCode?this.createCategory():this.filterCategory()},e.prototype.filterCategory=function(){var t;return t=this.$(".add-input").val(),t?this.entryCategoriesCollection.each(function(e){var i,n,r,o;return n=e.toJSON(),i=this.$(".category[data-id="+n._id+"]"),o=i.text(),r=o.indexOf(t)<0,i[r?"addClass":"removeClass"]("hide")}):this.$(".category").removeClass("hide"),this},e.prototype.createCategory=function(t){var e,i;return e=this.$(".add-input"),(i=e.val())?(this.entryCategoriesCollection.create({title:i,type:this.type,_projectId:this._projectId},{wait:!0,success:function(t){return function(i){return e.val(""),t.filterCategory()}}(this),error:function(t,e){return e.status="error",l.message(e)}}),this):this},e.prototype.keyeupCategoryInput=function(t){var e;return e=$(t.currentTarget),13===t.keyCode&&e.trigger("updateCategory"),this},e.prototype.triggerEvent=function(t){var e,i,n;return e=$(t.currentTarget),i=e.prop("disabled"),e.hasClass("disabled")?this:(n=e.data("type"),n&&e.trigger(n),this)},e.prototype.deleteCategory=function(t){var e,i,n;return e=$(t.currentTarget),n=e.data("id"),i=this.entryCategoriesCollection.get(n),i&&i.destroy(),this},e.prototype.enterEditing=function(t){var e,i,n,r,o,s;return i=$(t.currentTarget),e=i.find("input"),o=i.data("id"),n=null!=(s=this.entryCategoriesCollection.get(o))?s.toJSON():void 0,r="editing",this.$("."+r).removeClass(r),i.addClass(r),e.val(n.title),e.focusAtEnd(),this},e.prototype.exitEditing=function(t){var e;return e=$(t.currentTarget),e.removeClass("editing"),this},e.prototype.updateCategory=function(t){var e,i,n,r,o;return e=$(t.currentTarget),n=e.data("id"),i=this.entryCategoriesCollection.get(n),o="updating",r=e.find("input").val(),e.find("input").focusAtEnd(),e.hasClass(o)||!r?this:(e.addClass(o),i.save(null,{wait:!0,attrs:{title:r},success:function(){return e.removeClass(o)},error:function(t,e){return e.status="error",l.message(e)}}),this)},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.remove(),this},e}(c)},function(t,e){t.exports=function(t){var e='<div class="settings-navigation"> <ul class="settings-switcher-set nav nav-tabs"> <li class="settings-switcher-wrap active"> <a class="settings-switcher" data-type="1">'+tb_i18n.get("bookkeeping.settings.income.tips")+'</a> </li> <li class="settings-switcher-wrap"> <a class="settings-switcher" data-type="-1">'+tb_i18n.get("bookkeeping.settings.expense.tips")+'</a> </li> </ul></div><div class="settings-input-wrap clearfix"> <a class="icon icon-plus-sign pull-left"></a> <input class="add-input form-control pull-left" placeholder="'+tb_i18n.get("entry.creator.other.add.placeholder")+'" /> <button class="btn btn-link link-add-handler pull-right">'+tb_i18n.get("create")+'</button></div><ul class="settings-list"></ul>';
return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li class="category" data-id="'+t._id+'"> <span class="icon icon-menu pull-left"></span> <div class="settings-handlers-editing clearfix"> <input type="text" class="form-control pull-left category-input" placeholder="'+tb_i18n.get("bookkeeping.settings.category.edit.placeholder")+'" value=""> <button class="btn btn-primary btn-small settings-event-source pull-left" data-type="updateCategory">'+tb_i18n.get("save")+'</button> <button class="btn btn-link btn-small settings-event-source pull-left" data-type="exitEditing">'+tb_i18n.get("cancel")+'</button> </div> <div class="settings-handlers-without-state clearfix"> <span class="settings-category-case">'+e(t.title)+'</span> <a class="icon icon-trash settings-event-source pull-right" data-type="deleteCategory" ></a> <a class="icon icon-pencil settings-event-source pull-right" data-type="enterEditing"></a> </div></li>';return i}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;a=i(358),c=i(678),n=i(1729),o=i(980),s=i(677),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="BookkeepingSettingsDisplayFieldsView",e.prototype.tagName="div",e.prototype.className="bookkeeping-settings-displayFields-view",e.prototype.modalTitle="",e.prototype.events={"click .settings-in .switch-handler":"removeField","click .settings-out .switch-handler":"addField"},e.prototype.initialize=function(t){if(!t.bookkeepingModel)throw new Error(this.viewName+":options should have bookkeepingModel");return this.modalTitle=tb_i18n.get("bookkeeping.settings.fields.title"),this.options=t,this.bookkeepingModel=t.bookkeepingModel,this.displayFields=this.bookkeepingModel.getDisplayFields(),this.hiddenFields=this.bookkeepingModel.getHiddenFields(),a.delay(function(t){return function(){return t.$el.addClass("in")}}(this),100),e.__super__.initialize.apply(this,arguments)},e.prototype.renderMain=function(){var t;return t={"in":this.displayFields,out:this.hiddenFields},this.$modalBody.html(n(t)),this.checkOutFields(),this.initSortable()},e.prototype.initSortable=function(){var t;return t=!1,this.$(".list-inline").sortable({items:".ui-sortable-handle",connectWith:".list-inline",helper:"clone",placeholder:"settings-field settings-field-placeholder",tolerance:"pointer",zIndex:2001,scroll:!1,update:function(t){return function(e,i){var n;return n=$(i.item[0]),!(n.closest(".settings-out").length&&!n.hasClass("switch-handler"))&&(t.$(".settings-in").find(".icon-tick").removeClass("icon-tick").addClass("icon-remove"),t.$(".settings-out").find(".icon-remove").removeClass("icon-remove").addClass("icon-tick"),t.parseFromUI())}}(this)}),this},e.prototype.parseFromUI=function(){var t,e;return t=[],this.$(".settings-in .settings-field").each(function(){return t.push($(this).data("attr"))}),this.displayFields=this.bookkeepingModel.getFields(t),e=[],this.$(".settings-out .settings-field").each(function(){return e.push($(this).data("attr"))}),this.hiddenFields=this.bookkeepingModel.getFields(e),this.checkOutFields()},e.prototype.checkOutFields=function(){return this.hiddenFields.length?this.$(".setting-out").show():this.$(".setting-out").hide()},e.prototype.removeField=function(t){var e;if(e=(null!=t?t.currentTarget:void 0)?$(t.currentTarget).data("attr"):t)return this.displayFields=a.reject(this.displayFields,function(t){return function(i){return i.attr===e&&(t.hiddenFields.unshift(i),!0)}}(this)),this.renderMain()},e.prototype.addField=function(t){var e;if(e=(null!=t?t.currentTarget:void 0)?$(t.currentTarget).data("attr"):t)return this.hiddenFields=a.reject(this.hiddenFields,function(t){return function(i){return i.attr===e&&(t.displayFields.push(i),!0)}}(this)),this.renderMain()},e.prototype.saveFields=function(){var t;if(t=a.map(this.displayFields,"attr"),!a.isEqual(t,this.bookkeepingModel.get("displayFields")))return this.bookkeepingModel.save(null,{attrs:{displayFields:t},success:function(t){return function(){return t.close()}}(this),error:function(t,e){return e.status="error",s.message(e)}})},e.prototype.onClose=function(){return this.saveFields(),this},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.remove(),this},e}(o)},function(t,e){t.exports=function(t){var e='<form class="settings-form"> <div class="settings-set settings-in"> <div class="settings-title">'+tb_i18n.get("bookkeeping.settings.fields.in")+'</div> <ul class="clearfix list-inline ui-sortable"> ',i=t["in"];if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=" ","category"==n.attr?(e+=' <li class="settings-field ',n.isDefault!==!0&&(e+="switch-handler"),e+='" data-attr="'+n.attr+'"> '+n.title+" </li> "):(e+=' <li class="settings-field ui-sortable-handle ',n.isDefault!==!0&&(e+="switch-handler"),e+='" data-attr="'+n.attr+'"> '+n.title+" </li> "),e+=" ";e+=' </ul> </div> <div class="settings-set settings-out hide"> <div class="settings-title">'+tb_i18n.get("bookkeeping.settings.fields.out")+'</div> <ul class="clearfix list-inline ui-sortable"> ';var s=t.out;if(s)for(var n,a=-1,c=s.length-1;a<c;)n=s[a+=1],e+=' <li class="settings-field switch-handler" data-attr="'+n.attr+'"> '+n.title+" </li> ";return e+=" </ul> </div></form>"}},function(t,e){t.exports=function(t){var e='<div class="bookkeeping-panel-wrap scrollable"> <div class="bookkeeping-panel-header"> ';return e+=t.permissions.putApprovers||t.permissions.putCategories||t.permissions.putFields?' <a class="bookkeeping-panel-settings-toggler" data-type="approve" data-gta="event" data-label="bkp panel settings toggle"> <strong>'+tb_i18n.get("bookkeeping.panel.title.settings")+'</strong> <span class="icon icon-chevron-down pull-right"></span> </a> ':' <span class="bookkeeping-panel-settings-toggler"> <strong>'+tb_i18n.get("bookkeeping.panel.title.settings")+"</strong> </span> ",e+=' <a class="icon icon-remove pull-right bookkeeping-panel-toggler"></a> </div> <ul class="bookkeeping-panel-settings-set list"> ',t.permissions.putApprovers&&(e+=' <li> <a class="bookkeeping-panel-settings-handler" data-type="approve" data-gta="event" data-label="bkp panel settings approve"> '+tb_i18n.get("bookkeeping.settings.approver.title")+" </a> </li> "),e+=" ",t.permissions.putFields&&(e+=' <li> <a class="bookkeeping-panel-settings-handler" data-type="displayFields" data-gta="event" data-label="bkp panel settings displayFields"> '+tb_i18n.get("bookkeeping.settings.fields.title")+" </a> </li> "),e+=" ",t.permissions.putCategories&&(e+=' <li> <a class="bookkeeping-panel-settings-handler" data-type="category" data-gta="event" data-label="bkp panel settings category"> '+tb_i18n.get("bookkeeping.settings.category.title")+" </a> </li> "),e+=' </ul> <div class="bookkeeping-panel-filter-set panel-set"> <div class="panel-title"> <strong>'+tb_i18n.get("bookkeeping.panel.title.filter")+'</strong> <a class="filter-clear-handler pull-right" data-gta="event" data-label="bkp panel filter clear">'+tb_i18n.get("bookkeeping.panel.title.filter.clear")+'</a> </div> <div class="filter-input-wrap"> <input class="form-control filter-query-input" placeholder="'+tb_i18n.get("bookkeeping.panel.input.placeholder")+'" /> </div> <div class="filter-date-wrap"> <a class="filter-start-date filter-date-hanlder" data-type="startDate" data-gta="event" data-label="bkp panel filter startDate"></a> <div class="filter-date-line"></div> <a class="filter-end-date filter-date-hanlder" data-type="endDate" data-gta="event" data-label="bkp panel filter endDate"></a> </div> </div> <div class="bookkeeping-panel-filter-categories panel-set"></div> <div class="bookkeeping-panel-filter-tags panel-set"></div> <div class="bookkeeping-panel-filter-creators panel-set"></div> <div class="bookkeeping-panel-filter-approved-wrap"> <a class="filter-approved-handler" data-gta="event" data-label="bkp panel approve handler"> <div class="check-box pull-left"> <span class="icon icon-tick"></span> </div> <span>'+tb_i18n.get("bookkeeping.panel.filter.hide.approved")+'</span> </a> </div></div><div class="bookkeeping-panel-layer"></div>'}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="";if(t.categories.length>0){i+=' <div class="panel-title"> <strong>'+tb_i18n.get("bookkeeping.home.fields.category")+'</strong> </div> <ul class="list"> ';var n=t.categories;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li> <a class="category" data-id="'+r._id+'">'+e(r.title)+'</a> <span class="icon icon-tick"></span> </li> ';i+=" </ul>"}return i}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="";if(t.creators.length>0){i+=' <div class="panel-title"> <strong>'+tb_i18n.get("bookkeeping.home.fields.creator")+'</strong> </div> <ul class="list"> ';var n=t.creators;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=" ",r._id&&(i+=' <li> <a class="member" data-id="'+r._id+'"> <div class="avatar img-circle img-24" style="background-image:url('+r.avatarUrl+');"></div> '+e(r.name)+' </a> <span class="icon icon-tick"></span> </li> '),i+=" ";i+=" </ul>"}return i}},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(963).calculateColor;if(t.tags.length>0){n+=' <div class="panel-title"> <strong>'+tb_i18n.get("bookkeeping.home.fields.tags")+'</strong> </div> <ul class="list"> ';var o=t.tags;if(o)for(var s,a=-1,c=o.length-1;a<c;)s=o[a+=1],n+=' <li> <a class="tag" data-id="'+s._id+'"> <span class="tag-label" style="background-color: '+r(s.color,s.colorRGBA)+'"></span> <span class="tag-name">'+e(s.name)+'</span> </a> <span class="icon icon-tick"></span> </li> ';n+=" </ul>"}return n}},function(t,e){t.exports=function(t){var e='<div class="test"></div><div class="bookkeeping-header-tips"> <div class="bookkeeping-header-tips-fixed body-wrap"> <div class="bookkeeping-header-tips-wrap card"> '+tb_i18n.get("bookkeeping.home.tips.header.approve")+' <a class="bookkeeping-header-tips-close icon icon-remove pull-right" data-gta="event" data-label="bkp home header tips"></a> </div> </div></div><div class="bookkeeping-header"> <div class="bookkeeping-header-fixed  body-wrap"> <div class="bookkeeping-header-wrap"> <a class="bookkeeping-creator link-add-handler hide" data-type="-1" data-gta="event" data-label="bkp home creator expense"> <span class="icon icon-bookkeeping"></span> <span>'+tb_i18n.get("entry.creator.expense.title")+'</span> </a> <a class="bookkeeping-creator link-add-handler hide" data-type="1" data-gta="event" data-label="bkp home creator income"> <span class="icon icon-income"></span> <span>'+tb_i18n.get("entry.creator.income.title")+'</span> </a> <a class="bookkeeping-panel-toggler pull-right" data-gta="event" data-label="bkp home panel toggle"> <span class="filtering-state">'+tb_i18n.get("bookkeeping.home.header.filtering")+"</span> <span>"+tb_i18n.get("bookkeeping.home.header.filter.toggler.title")+'</span> <span class="icon icon-chevron-down"></span> </a> </div> </div></div><div class="bookkeeping-content card"></div><div class="bookkeeping-placeholder"> <span class="icon icon-bookkeeping"></span> <br /> <span>'+tb_i18n.get("bookkeeping.home.tips.placeholder")+'</span> <br /> <span class="bookkeeping-approve-tips"> '+tb_i18n.get("bookkeeping.home.tips.placeholder.approve")+" </span></div>";return e}},function(t,e){t.exports=function(t){var e='<header class="bookkeeping-content-header"> <div  class="bookkeeping-content-header-fixed body-wrap"> <div class="bookkeeping-content-header-wrap"> ',i=t;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <div class="entry-'+n.attr+'"> ',e+=n.isSort?' <a class="bookkeeping-sort" data-orderby="'+n.attr+'">'+n.title+"</a> ":" "+n.title+" ",e+=" </div> ";return e+=' </div> </div></header><section> <ul class="bookkeeping-list"></ul></section><footer class="bookkeeping-content-footer body-wrap"> <div class="pull-left bookkeeping-expense"> <span class="bookkeeping-total-normal">'+tb_i18n.get("bookkeeping.home.total.expense")+'</span> <span class="bookkeeping-total-filtering">'+tb_i18n.get("bookkeeping.home.total.expense.filtered")+'</span> <br /> <span class="bookkeeping-amount">0</span> </div> <div class="pull-left bookkeeping-income"> <span class="bookkeeping-total-normal">'+tb_i18n.get("bookkeeping.home.total.income")+'</span> <span class="bookkeeping-total-filtering">'+tb_i18n.get("bookkeeping.home.total.income.filtered")+'</span> <br /> <span class="bookkeeping-amount">0</span> </div></footer>'}},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;i(1737),c=i(678),r=i(401),s=i(788),l=i(1739),a=i(1740),n=i(1900),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="PluginView",e.prototype.className="plugin-view",e.prototype.initialize=function(t){return this.options=t,this.projectModel=t.projectModel,this.pluginModel=a.getBy("project").get(this.options.routeString),this.isAppPlugin()?this.render().listen():c.router.navigate("projects",{trigger:!0})},e.prototype.listen=function(){return this.listenTo(this.pluginModel,"remove",function(){return r.log(tb_i18n.get("project.app.plugin.remove.essage")),c.router.navigate("projects",{trigger:!0})})},e.prototype.isAppPlugin=function(){var t;return!!this.pluginModel&&(t=this.pluginModel.toJSON(),"iframe"===t.mode&&"app_for_project"===t.consumer.appType)},e.prototype.render=function(){var t,e;return t=this.pluginModel.toJSON(),e=l.replaceMark(t.url,this.projectModel.toJSON()),this.$el.html(n({id:t._id,link:e})),this},e}(s)},function(t,e){},,function(t,e,i){var n,r;r=i(461),n=/\$([\s\S]*?)\$/g,e.addUrlQuery=function(t,e,i){var n;return n=r.parse(t,!0),n.search=null,n.query||(n.query={}),n.query[e]=i,r.format(n)},e.replaceMark=function(t,e){return t.replace(n,function(t,i){return e[i]||""})}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f;r=i(358),n=i(1741),l=i(1744),u=i(1746),d=u.register,h=u.registerPowerUps,p=null,a=null,c=null,o=function(t){switch(t){case"project":return p;case"me":return a;case"organization":return c}},m=function(t,e){switch(e){case"project":return p=t;case"me":return a=t;case"organization":return c=t}},f=function(t){switch(t){case"project":return i(1899).appsForProject(o(t));case"me":return i(1899).appsForMe(o(t));case"organization":return i(1899).appsForOrganization(o(t))}},s=function(t,e){var i,r;if(i=o(t),"me"!==t){if(!e)return console.error("Need boundToObjectId to fetch plugins."),Promise.resolve();if(i){if(i.boundToObjectId===e)return Promise.resolve();i.reset(),i.stopListening(),i.off()}}return r={boundToObjectType:t},e&&(r.boundToObjectId=e),i=new n([],r),m(i,t),i.on("add",function(t){return d(t)}),"project"===t&&h(p),i.fetch().then(function(){return l.listen()})},e.initProject=function(t){return s("project",t)},e.initMy=function(){return s("me")},e.initOrg=function(t){return s("organization",t)},e.getBy=o},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;a=i(358),n=i(357),r=i(1742),l=i(686),c=i(1743),s=i(783).SOCKET_NAMESPACE,t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.model=r,e.prototype.parse=function(t){return t=a.extend(this.toJSON(),t)},e.prototype.initialize=function(t,e){var i,n,r;return i=e.boundToObjectId,n=e.boundToObjectType,this.boundToObjectType=n,this.boundToObjectId=i,r=this.boundToObjectId?s+"/"+this.boundToObjectId:""+s,this.listenTo(l,":new:"+r,function(t){return function(e){return t.add(e)}}(this)),this.listenTo(l,":change:"+r,function(t){return function(e){return t.set(e)}}(this)),this.listenTo(l,":remove:"+r,function(t){return function(e){return t.remove(e)}}(this))},e.prototype.fetch=function(){return this.fetchApps().then(function(t){return function(e){return t.add(e)}}(this))},e.prototype.removeByModel=function(t,e){var i;return null==e&&(e={}),i=t.get("_id"),this.removeAppByModel(i).then(function(i){return function(){return i.remove(t),"function"==typeof e.success?e.success(t):void 0}}(this))["catch"](function(t){return"function"==typeof e.error?e.error(t):void 0})},e.prototype.fetchApps=function(){switch(this.boundToObjectType){case"project":return c.fetchProjectPlugins(this.boundToObjectId);case"me":return c.fetchMyPlugins();case"organization":return c.fetchOrgPlugins(this.boundToObjectId)}},e.prototype.removeAppByModel=function(t){switch(this.boundToObjectType){case"project":return c.removeProjectPlugin(this.boundToObjectId,t);case"me":return c.removeMyPlugin(t);case"organization":return c.removeOrgPlugin(this.boundToObjectId,t)}},e}(n.Collection)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;n=i(357),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.idAttribute="_id",e}(n.Model)},function(t,e,i){var n,r,o,s,a;o=i(679),s=i(680),a=i(783),n=a.CACHE_NAME,r=a.CACHE_TIME,e.fetchProjectPlugins=function(t){return s.ajax({url:o.HOST+"/appstore/api/projects/"+t+"/apps",silentError:!0,expireCache:{namespace:n,expire:r}})},e.removeProjectPlugin=function(t,e){return s.ajax({url:o.HOST+"/appstore/api/projects/"+t+"/apps/"+e,type:"DELETE"})},e.fetchMyPlugins=function(){return s.ajax({url:o.HOST+"/appstore/api/me/apps",silentError:!0,expireCache:{namespace:n,expire:r}})},e.removeMyPlugin=function(t){return s.ajax({url:o.HOST+"/appstore/api/me/apps/"+t,type:"DELETE"})},e.fetchOrgPlugins=function(t){return s.ajax({url:o.HOST+"/appstore/api/organizations/"+t+"/apps",silentError:!0,expireCache:{namespace:n,expire:r}})},e.removeOrgPlugin=function(t,e){return s.ajax({url:o.HOST+"/appstore/api/organizations/"+t+"/apps/"+e,type:"DELETE"})}},function(t,e,i){var n,r,o,s;o=i(1745),r=function(t,e){var i,n,r,a;return a=t.postId,i=t.method,r=t.params,n=t.origin,o[i]?(o[i](r,e),s(e,n,{postId:a})):s(e,n,{postId:a,error:i+" is not a fucntion"})},s=function(t,e,i){return null==i&&(i={}),null!=t?t.contentWindow.postMessage(i,e):void 0},n=function(t){var e,i,n,r;for(i=document.querySelectorAll("iframe"),n=0,r=i.length;n<r;n++)if(e=i[n],e.contentWindow===t.source)return e},e.listen=function(){return $(window).off("message"),$(window).on("message",function(t){var e,i;return i=t.origin||t.originalEvent,e=n(i),r(i.data,e)})}},function(t,e,i){var n,r;r=i(678),n=i(401),e.essage=function(t){return n.show(t)},e.open=function(t){var e,i,n;if(e=t._id,n=null!=(i=t.type)?i:"task",e)return r.APP.openObjectPreviewer(e,n)},e.navigate=function(t){var e,i,n,o,s,a,c;if(i=t._projectId,n=t._tasklistId,e=t._collectionId,a=null!=(o=t.type)?o:"project",i||(i=null!=(s=r.APP.projectModel)?s.id:void 0),i)return c=function(){switch(a){case"project":return"project/"+i+"/tasks";case"tasklist":return"project/"+i+"/tasks/scrum/"+n;case"collection":return"project/"+i+"/works/"+e}}(),c?r.router.navigate(c,{trigger:!0}):console.error("Invalid Type")},e.closeModal=function(t,e){return $(e).trigger("closeModal")}},function(t,e,i){var n,r,o,s,a;a=i(358),r=i(1747),n=i(1760),o=i(1761),s={plugin_for_tasklist:i(1769),plugin_for_project:i(1770),plugin_for_stage:i(1771),plugin_for_task:i(1772),plugin_for_bookkeeping:i(1773),plugin_for_entry:i(1774),plugin_for_event:i(1775),plugin_for_work:[r,n],plugin_for_post:i(1776),app_for_project:i(1777),app_for_me:i(1787),app_for_organization:i(1793)},e.register=function(t){var e,i;if(i=t.get("consumer").appType)return e=[].concat(s[i]),a.each(e,function(e){return new e(t)})},e.registerPowerUps=function(t){return new o(t)}},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;n=i(1748),r=i(1574),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.event=r.prototype.viewName+"_render",e.prototype.pluginHandler=function(t){return t.hide()},e.prototype.dataHandler=function(t){return t.workModel.toJSON()},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;i(1749),n=i(1751),a=i(1752),l=i(1757),p=i(1739),c=i(1758),s=i(1759),r=i(783).EVENT_NAMESPACE,t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.renderToView=function(t){var e,i,n,o;return this.view=t,n=this.plugin.toJSON(),e=$(c(n)),this.$divider=$(s()),e.on("click."+r,".plugin-handler",function(e){return function(){var i;switch(e.pluginHandler(t),i=p.replaceMark(n.url,e.dataHandler(t)),n.mode){case"iframe":return a.open(i,n.consumer.name);case"redirect":return window.open(i);case"api":return l.get(i)}}}(this)),i=t.$el.find(".menu-plugin").last(),i.length?i.after(e):this.isPrepend?(t.$el.find(this.container).prepend(e),e.after(this.$divider)):(t.$el.find(this.container).append(e),e.before(this.$divider)),null!=(o=this.$element)&&o.remove(),this.$element=e},e.prototype.remove=function(){var t,i,n;if(e.__super__.remove.apply(this,arguments),!(null!=(t=this.view)&&null!=(i=t.$el)?i.find(".menu-plugin").length:void 0))return null!=(n=this.$divider)?n.remove():void 0},e.prototype.pluginHandler=function(t){},e.prototype.dataHandler=function(t){},e}(n)},function(t,e){},,function(t,e,i){var n,r,o,s,a;o=i(358),a=i(678),n=i(357),s=i(1740),t.exports=r=function(){function t(t){this.plugin=t,this.listen(),this.triggerBefore()}return t.prototype.event="",t.prototype.view=null,t.prototype.plugin=null,t.prototype.$element=null,t.prototype.container=".list",t.prototype.isPrepend=!1,t.prototype.rerenderToView=function(){if(this.view)return this.renderToView(this.view)},t.prototype.listen=function(){var t;return t=s.getBy("project"),this.listenTo(a.hook,this.event,this.renderToView),this.listenTo(this.plugin,"change",this.rerenderToView),this.listenTo(this.plugin,"remove",this.remove),this.listenTo(t,"reset",this.remove)},t.prototype.triggerBefore=function(){return a.hook.triggerBefore(this.event,this.renderToView,this)},t.prototype.remove=function(){var t;return this.stopListening(),null!=(t=this.$element)?t.remove():void 0},t.prototype.renderToView=function(t){throw new Error("Not Implemented")},t}(),o.extend(r.prototype,n.Events)},function(t,e,i){var n,r,o;r=i(788),o=i(786),n=i(1753),e.open=function(t,e){return(new o).open(n,{link:t,title:e})}},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;i(1754),o=i(788),r=i(1756),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.viewName="PluginIframeView",e.prototype.className="plugin-iframe-view modal-dialog flex-vert",e.prototype.initialize=function(t){var i,n;return i=t.link,n=t.title,e.__super__.initialize.apply(this,arguments),this.$el.html(r({link:i,title:n})),this.listen()},e.prototype.listen=function(){return this.$el.on("closeModal",function(t){return function(){var e;return"function"==typeof(e=t.parentView).close?e.close():void 0}}(this))},e}(o)},function(t,e){},,function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<header class="plugin-iframe-header modal-header flex-static"> <h4>'+e(t.title)+'</h4> <a class="plugin-iframe-closer icon icon-remove" data-dismiss="modal"></a></header><iframe class="plugin-iframe flex-fill thin-scroll" src="'+e(t.link)+'" frameBorder="none"></iframe>';return i}},function(t,e,i){var n,r;r=i(680),n=i(401),e.get=function(t){return r.ajax({url:t}).then(function(t){var e,i,r;return e=t.message,r=t.statusText,i=t.status,n.log(e||r||i)})["catch"](function(t){var e,i,r;return e=t.message,r=t.statusText,i=t.status,n.error(e||r||i)})}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li class="menu-plugin"> <a class="plugin-handler" data-plugin-id="'+e(t._id)+"\" data-gta=\"{action: 'use plugin', control: '"+e(t.consumer.appType)+"', type: '"+e(t.consumer.pinyin)+"', pluginid: '"+e(t._id)+"', projectid: '"+e(t._projectId)+"'}\"> ";return i+=t.consumer.avatarUrl?' <span style="background-image: url('+t.consumer.avatarUrl+')" class="icon plugin-avatar"></span> ':' <span class="icon icon-pencil"></span> ',i+=" "+e(t.consumer.name)+" </a></li>"}},function(t,e){t.exports=function(t){var e='<li class="divider plugin-divider"></li>';return e}},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;n=i(1748),o=i(1172),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.event=o.prototype.viewName+"_render",e.prototype.pluginHandler=function(t){return t.hide()},e.prototype.dataHandler=function(t){return t.options.objectModel.toJSON()},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;i(1762),p=i(678),c=i(1359),o=i(1764),n=i(1751),r=i(783).EVENT_NAMESPACE,l=i(786),s=i(1765),t.exports=a=function(t){function e(t){this.collection=t,e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.event=c.prototype.viewName+"_render_plugins",e.prototype.collection=null,e.prototype.renderToView=function(t){var e,i,n;return this.view=t,e=$(o(this.collection.toJSON())),i=t.$el.find(".fns").last(),i.append(e),i.off("."+r),i.on("click."+r,".appstore-item",this.onClickHandler.bind(this)),null!=(n=this.$element)&&n.remove(),this.$element=e},e.prototype.listen=function(){return this.listenTo(p.hook,this.event,this.renderToView),this.listenTo(this.plugin,"add remove",this.rerenderToView)},e.prototype.onClickHandler=function(t){var e,i;if(e=$(t.currentTarget).data("id"),i=this.collection.get(e))return p.gta.event({action:"view project plugins",type:i.get("consumer").pinyin,control:"Power-ups Menu",pluginid:i.get("consumer")._id}),(new l).open(s,{pluginModel:i,collection:this.collection}),!1},e}(n)},function(t,e){},,function(t,e){t.exports=function(t){var e="",i=t;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+='<li class="plugin-item"> <div class="app-card appstore-item" data-id="'+n._id+'"> <span class="img-icon img-icon-appstore size-sd" style="background-image: url('+n.consumer.avatarUrl+')"></span> <!-- 0: public(默认); 1: pro; 2: enterprise --> ',1===n.consumer.version&&(e+=' <span class="pro-mark">Pro</span> '),e+=' </div> <div class="app-card-des text-center"> <span class="check-wrap img-circle"><span class="icon icon-tick-thin"></span></span> <span>'+n.consumer.name+"</span> </div></li>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;i(1766),l=i(358),p=i(678),s=i(697),r=i(401),c=i(788),n=i(1361),a=i(1768),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="PluginPowerUpsItemView",e.prototype.className="modal modal-dialog modal-padding power-up-common powerups-item-detail-view",e.prototype.events={"click .remove-handler":"removeApp"},e.prototype.initialize=function(t){var e,i,n;return e=t.collection,n=t.pluginModel,this.pluginModel=n,this.collection=e,this.projectModel=s.find(e.boundToObjectId),i=this.projectModel.hasPermission("project.put.applications"),this.$el.html(a(l.extend(n.toJSON(),{hasPermission:i})))},e.prototype.removeApp=function(){return this.requestSubView(n,{title:tb_i18n.get("powerups.app.delete"),description:tb_i18n.get("powerups.app.confirm.delete",this.projectModel.get("name"),this.pluginModel.get("consumer").name),confirm:tb_i18n.get("powerups.app.delete.btn"),onConfirm:function(t){return function(){return t.collection.removeByModel(t.pluginModel,{success:function(){var e;return r.show({message:tb_i18n.get("delete.success"),status:"success"}),null!=(e=t.parentView)&&e.modal.hide(),p.gta.event({action:"deactivated project plugins",type:t.pluginModel.get("consumer").pinyin,control:"Power-up App Detail",projectid:t.projectModel.id,pluginid:t.pluginModel.get("consumer")._id,organizationid:t.projectModel.get("_organizationId")||""})},error:function(t){return r.show({message:t.responseJSON.message,status:"error"})}})}}(this)}),this},e}(c)},function(t,e){},,function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="modal-content"> <div class="modal-header"> <div class="modal-title text-center">'+tb_i18n.get("powerups.modal.title.detail")+'</div> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </div> <div class="modal-body"> <div class="app-detail"> <div class="app-logo app-card"><span class="img-icon img-icon-appstore size-sd" style="background-image: url('+e(t.consumer.avatarUrl)+')"></span></div> <div class="app-content"> <h4 class="app-name">'+e(t.consumer.name)+'<span class="check-wrap img-circle"><span class="icon icon-tick-thin"></span></span></h4> <div class="app-author muted">'+tb_i18n.get("powerups.author",t.consumer.developer.name)+'</div> <div class="app-desc muted">'+e(t.consumer.description,"MD")+"</div> ";return t.hasPermission&&(i+=' <div class="app-handler-wrap on-off-toggle"> <a class="btn btn-danger remove-handler">'+tb_i18n.get("powerups.app.delete")+" </a> </div> "),i+=" </div> </div> </div></div>"}},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);
return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;o=i(1748),s=i(1543),r=s.prototype.viewName+"_render",n=$("body"),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.event=s.prototype.viewName+"_render",e.prototype.pluginHandler=function(t){return n.click()},e.prototype.dataHandler=function(t){return t.tasklistModel.toJSON()},e}(o)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;n=i(1748),o=i(1658),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.event=o.prototype.viewName+"_render",e.prototype.dataHandler=function(t){return t.projectModel.toJSON()},e}(n)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;n=i(1748),o=i(1509),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.event=o.prototype.viewName+"_render",e.prototype.pluginHandler=function(t){return t.hide()},e.prototype.dataHandler=function(t){return t.stageModel.toJSON()},e}(n)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;n=i(1748),o=i(1286),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.event=o.prototype.viewName+"_render",e.prototype.pluginHandler=function(t){return t.hide()},e.prototype.dataHandler=function(t){return t.options.taskModel.toJSON()},e}(n)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=i(1722),r=i(1748),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.event=o.prototype.viewName+"_render",e.prototype.dataHandler=function(t){return t.tasklistModel.toJSON()},e}(r)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;r=i(1748),o=i(1270),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.event=o.prototype.viewName+"_render",e.prototype.pluginHandler=function(t){return t.hide()},e.prototype.dataHandler=function(t){return t.entryModel.toJSON()},e}(r)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;r=i(1748),o=i(1229),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.event=o.prototype.viewName+"_render",e.prototype.pluginHandler=function(t){return t.hide()},e.prototype.dataHandler=function(t){return t.options.eventModel.toJSON()},e}(r)},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;n=i(1748),o=i(1278),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.event=o.prototype.viewName+"_render",e.prototype.pluginHandler=function(t){return t.hide()},e.prototype.dataHandler=function(t){return t.options.postModel.toJSON()},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},v={}.hasOwnProperty;p=i(358),m=i(678),f=i(1739),u=i(1752),h=i(1757),r=i(1751),o=i(1778),n=i(1356),d=i(783),a=d.PLUGIN_URL,s=d.EVENT_NAMESPACE,l=i(1779).Constructor,t.exports=c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.event=l.prototype.viewName+"_render",e.prototype.renderToView=function(t){var e,i,n;return this.view=t,i=this.plugin.toJSON(),e=$(o(i)),e.on("click."+s,".plugin-handler",function(e){return function(){var n;switch(n=f.replaceMark(i.url,e.dataHandler(t)),i.mode){case"iframe":return e.pluginHandler(i);case"redirect":return window.open(n);case"api":return h.get(n)}}}(this)),t.$el.find(".nav").append(e),null!=(n=this.$element)&&n.remove(),this.$element=e},e.prototype.pluginHandler=function(t){var e,i;return i=m.router.getUrl(),e=p.map(n.get().toJSON(),function(t){return t.name}).concat(a).join("|"),i=i.replace(new RegExp("("+e+")+\\S*"),a),m.router.navigate(i+"/"+t._id,{trigger:!0}),this.view.refreshAppActive()},e.prototype.dataHandler=function(t){return t.projectModel.toJSON()},e}(r)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li class="menu-plugin"> <a class="plugin-handler app" data-app="plugin" data-plugin-id="'+e(t._id)+"\" data-gta=\"{action: 'use plugin', control: '"+e(t.consumer.appType)+"', pluginid: '"+e(t._id)+"', projectid: '"+e(t._projectId)+"'}\"> "+e(t.consumer.name)+" </a></li>";return i}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T=function(t,e){function i(){this.constructor=t}for(var n in e)M.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},M={}.hasOwnProperty;_=i(358),j=i(678),a=i(401),k=i(788),v=i(995),o=i(1356),p=i(684),g=i(696),c=i(699),b=i(994),d=i(1682),f=i(1780),m=i(1579),y=i(1784),w=i(786),s=i(1785),l=i(1786),u=i(783).PLUGIN_URL,n=$(window),r="on-active",h=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return T(e,t),e.prototype.viewName="ProjectNavigationView",e.prototype.tagName="nav",e.prototype.className="project-navigation sub-nav sub-navigator",e.prototype.events={"click .app:not(.plugin-handler)":"appHandler","click .nav-menu-handler":"panelHandler","click a.project-switcher-handler":"toggleProjectSwitcher","click a.flag-handler":"toggleProjectStar","click .tasklist-pop-handler":"toggleTasklistPop"},e.prototype.initialize=function(t){var e,i,r;if(!t.projectModel)throw new Error("initialize "+this.viewName+" must have projectModel");return this.options=_.extend({},t),this.projectModel=t.projectModel,this.membersCollection=c.fetch(this.projectModel.id),this.tasklistsCollection=b.find(this.projectModel.id),this.tasklistsCollection.updateSort(j.PREFERENCE.tasklistSortInProject(this.projectModel.id),!0),i=this.projectModel.get("currentTasklistId"),r=this.tasklistsCollection.get(i),this.setTasklistModel(r),this.render(),this.renderMenu(),this.renderGuide(),this.listen(),this.initProjectPanel(),e=_.throttle(function(t){return function(){return t.refreshNavs()}}(this),10),n.on("resize."+this.viewName,e),_.delay(function(t){return function(){return t.refreshNavs()}}(this),100),this},e.prototype.listen=function(){return this.listenTo(this.projectModel,"change:currentPanel",this.renderMenu),this.listenTo(this.projectModel,"change:currentTasklistId",function(t,e){var i;return i=this.tasklistsCollection.get(e),this.setTasklistModel(i),this.refreshAppActive()}),this.listenTo(this.projectModel,"change:applications",function(){if(this.projectModel.isNavAppChanged()&&(this.render(),this.renderMenu(),this.refreshNavs()),this.projectModel.isAppChanged("tasklist"))return this.refreshAppActive(),this.refreshTasklistPop()}),this.listenTo(this.projectModel,"change:name change:isStar change:isPublic",this.refreshProject),this.listenTo(this.projectModel,"change:unreadCount change:unreadMessageCount change:pushStatus",this.renderMenu),this.listenTo(this.membersCollection,"add remove",function(t){if(this.render(),this.renderMenu(),this.refreshNavs(),t.id===j.user.id)return j.router.navigate("project/"+this.projectModel.id+"/tasks",{trigger:!0})}),this.listenTo(j.PREFERENCE,"change:pinTasklistBar",this.refreshTasklistPop),this.listenTo(this.projectModel,"change:visibility",this.refreshVisibility),this},e.prototype.setTasklistModel=function(t){return this.stopListening(this.tasklistModel),this.tasklistModel=t||this.tasklistsCollection.at(0),this.projectModel.set("currentTasklistId",this.tasklistModel.id),this.listenTo(this.tasklistModel,"change:title",this.refreshAppActive),this.listenTo(this.tasklistModel,"change:filter",this.renderMenu)},e.prototype.assembleRenderData=function(){var t,e,i,n,r;return e=this.projectModel.toJSON(),n=this.projectModel.getNavigations()||{},t=o.get(0).toJSON(),"project"===e.visibility||this.membersCollection.findWhere({_id:j.user.id})||(n.groupchat=-1),i=function(t){return n[t.name]>=0},r=function(t,e){return n[t.name]-n[e.name]},e.apps=t.filter(i).sort(r),e.appName=this.appName,this.isTasklistEnabled()?e.scrumName=this.tasklistModel.get("title"):e.scrumName=tb_i18n.get("tasks"),e.scrumId=this.tasklistModel.id,e.permissions=this.projectModel.hasPermissions("get.subscribe","put.fork"),e.isGhost=j.user.get("isGhost"),e},e.prototype.render=function(){var t;return t=_.extend(this.assembleRenderData(),{isTasklistTogglerHidden:this.isTasklistTogglerHidden()}),this.$el.html(s(t)),this.triggerHook("render"),this.$navHeader=this.$(".nav-header"),this.$navBody=this.$(".nav-body"),this.$navFooter=this.$(".nav-footer"),this.$navMore=this.$(".nav-more"),this.$navMoreUl=this.$(".nav-more > ul")},e.prototype.renderGuide=function(){return this.projectModel.get("isNew")&&(this.projectModel.set("isNew",!1),this.projectModel.set("currentPanel","member"),this.requestSubView(w).open(d,{projectModel:this.projectModel})),this},e.prototype.renderMenu=function(){var t,e;return t=this.projectModel.toJSON(),t.memberLength=this.membersCollection.length,t.hasFilter="tasks"===(e=this.appName),t.isFiltering=this.tasklistModel.hasFilter(),this.projectPanelView&&"filter"===t.currentPanel&&(t.hasFilter?this.projectPanelView.show():this.projectPanelView.hide()),_.delay(function(e){return function(){return e.$navFooter.html(l(t))}}(this))},e.prototype.isTasklistTogglerHidden=function(){var t,e;return t=j.PREFERENCE.get("pinTasklistBar"),e=!this.isTasklistEnabled(),e||t},e.prototype.isTasklistEnabled=function(){return this.tasklistsCollection.length>1||this.projectModel.isAppEnabled("tasklist")},e.prototype.initProjectPanel=function(){if(this.projectPanelView=this.requestSubView(m,{projectModel:this.projectModel}),this.projectPanelView.$el.appendTo($("body")),j.user.isNew())return this.projectModel.set("currentPanel","activity")},e.prototype.setApp=function(t){return this.appName=t,this.refreshAppActive(),this.renderMenu()},e.prototype.refreshProject=function(){var t,e,i,n;return n=this.projectModel.toJSON(),t=this.$navHeader.find(".project-name"),i=this.$navHeader.find(".icon-star"),e=this.$navHeader.find(".public-label"),t.text(n.name),i[n.isStar?"addClass":"removeClass"]("starred"),e[n.isPublic?"addClass":"removeClass"]("public"),this},e.prototype.refreshAppActive=function(){var t,e,i,n;if(this.$navBody.find(".active").removeClass("active"),e=this.$(".app[data-app=tasks]"),n=this.isTasklistEnabled()?this.tasklistModel.get("title"):tb_i18n.get("tasks"),e.text(n).data("scrum-id",this.tasklistModel.id),this.appName===u?(i=j.router.getUrl().split("/").pop(),t=this.$(".app[data-plugin-id="+i+"]")):t=this.$(".app[data-app="+this.appName+"]"),t.parent().addClass("active"),t.parent().is(".dropdown-menu"))return this.$navMore.addClass("active")},e.prototype.refreshTasklistPop=function(){var t;return t=this.isTasklistTogglerHidden(),this.$(".tasklist-pop-handler")[t?"addClass":"removeClass"]("on-pinned"),this.$(".tasklist-pop-replace")[t?"hide":"show"]()},e.prototype.refreshVisibility=function(){var t;return t=this.$navHeader.find(".public-label"),"all"===this.projectModel.get("visibility")?t.addClass("public"):t.removeClass("public"),this},e.prototype.refreshNavs=function(){var t;if(!this.$el)return this;if(this.$navMore.before(this.$navMoreUl.children()),this.$navMore.removeClass("on-show active"),this.checkNavWidth(!0))return this;for(;!this.checkNavWidth();)t=this.$navMore.prev(),this.$navMoreUl.prepend(t),this.$navMore.addClass("on-show");return this.$navMore.find(".active").length&&this.$navMore.addClass("active"),this},e.prototype.appHandler=function(t){var e,i,n,r,s;return e=$(t.currentTarget),i=e.data("app"),r=e.data("scrum-id"),"tasks"===this.appName&&"tasks"===i?(this.toggleTasklistPop(),j.gta.event({action:"toggle task group menu",control:"Project Tabbar"})):r?(this.appName=i,s=j.router.getPrefix()+"/tasks/scrum/"+r,j.router.navigate(s,{trigger:!0}),j.gta.event({action:"open tasks tab",control:"Project Tabbar"})):this.appName!==i?(this.appName=i,s=j.router.getUrl(),n=_.map(o.get().toJSON(),function(t){return t.name}).concat(u).join("|"),s=s.replace(new RegExp("("+n+")+\\S*"),i),j.router.navigate(s,{trigger:!0}),j.gta.event({action:"open "+this.appName+" tab",control:"Project Tabbar"})):void 0},e.prototype.panelHandler=function(t){var e,i,n;return e=$(t.currentTarget),i=this.projectModel.get("currentPanel"),n=e.data("menu"),i===n&&(n=null),this.projectModel.set("currentPanel",n)},e.prototype.toggleProjectSwitcher=function(t){return this.projectSwitcherView||(this.projectSwitcherView=this.requestSubView(f,{selectedId:this.projectModel.id,$toggler:$(t.currentTarget),projectsCollection:g.get(0),organizationsCollection:p.get(0),onSelectedChange:function(t){return function(e){var i;if(t.projectModel.id!==e.id)return i="project/"+e.id+"/"+t.options.appName,j.router.navigate(i,{trigger:!0})}}(this)}).show()),this},e.prototype.toggleProjectStar=function(t){var e;return e=this.projectModel,this.projectModel.toggleStar({success:function(t){return t.isStar?g.get(0).add(e):e.getRoleScope()>=0||g.get(0).remove(e.id,{silent:!0}),j.gta.event({action:(t.isStar?"":"un")+"star project",control:"Project Name"}),a.show({message:t.isStar?tb_i18n.get("portal.project.star.success"):tb_i18n.get("portal.project.un.star.success"),status:"success"})}}),this},e.prototype.checkNavWidth=function(t){var e,i,n;if(!this.$el)return!0;if(e=this.$navBody.find(">ul >li"),t){if(e=e.filter(":not(.nav-more)"),e.length<1)return!0}else if(e.length<=1)return!0;return i=0,e.each(function(t,e){return i+=$(e).outerWidth()}),n=this.$el.width()-this.$navHeader.width()-this.$navFooter.width(),n>=i},e.prototype.initTasklistPop=function(){return this.tasklistPopView=this.requestSubView(y,{_projectId:this.projectModel.id,projectModel:this.projectModel,$toggler:this.$(".app[data-app=tasks]")})},e.prototype.toggleTasklistPop=function(){var t;if(!this.isTasklistTogglerHidden())return(null!=(t=this.tasklistPopView)?t.isShowing:void 0)?this.hideTasklistPop():this.showTasklistPop()},e.prototype.showTasklistPop=function(){var t;return null!=(t=this.tasklistPopView)&&t.remove(),this.tasklistPopView=this.requestSubView(y,{_projectId:this.projectModel.id,projectModel:this.projectModel,$toggler:this.$(".tasklist-pop-replace")}),this.tasklistPopView.show()},e.prototype.hideTasklistPop=function(){var t;return null!=(t=this.tasklistPopView)?t.hide():void 0},e.prototype.remove=function(){return e.__super__.remove.apply(this,arguments),n.off("."+this.viewName)},e}(k),e.Constructor=h},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;p=i(358),n=i(1781),o=i(1782),r=i(1783),s=i(813),c=i(797),l=i(677),a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="ProjectSwitcherView",e.prototype.className="project-switcher-view",e.prototype.popoverTitle="Menu",e.prototype.hotkeys={"up|down|enter":"onkeydown",esc:function(t){var e;return t.preventDefault(),null!=(e=this.$popover)&&e.parent().trigger("click"),this.hide()}},e.prototype.events={"click .project-item":"switchProject","keydown input":"onkeydown","input input":"oninput","mousewheel .project-list":l.mousewheel},e.prototype.render=function(){if(this.options.projectsCollection)return this.genProjects(),this.$el.html(n()),this.$list=this.$(".project-list"),this.$el.find("input").focusAtEnd(),this.renderProjects(),this},e.prototype.renderProjects=function(){return this.$list.html(o({projects:this.projects,selectedId:this.options.selectedId})),this.$list.find(".project-item[data-id="+this.options.selectedId+"]:first").addClass("selected"),this.$(".group-by").next(".project-item").addClass("underscore"),this.layout(),this.setupScroll(this.$list)},e.prototype.genProjects=function(){var t,e,i,n,r;return r=this.options.projectsCollection,n=this.options.organizationsCollection,e=r.groupBy(function(t){var e;return e=t.get("_organizationId"),e&&!n.get(e)&&t.get("organization")&&n.add(t.get("organization")),e||null}),i=r.getStarProjects(),this.projects=[],i.length&&(this.projects.push({type:"groupBy",groupName:tb_i18n.get("flagged.projects")}),p.each(i,function(t){return function(e){return t.projects.push(e.toJSON())}}(this))),t=p.keys(e),t=p.map(t,function(t){var e;return{_id:t,name:(null!=(e=n.get(t))?e.get("name"):void 0)||""}}),t=p.sortBy(t,function(t){return t.name}),p.each(t,function(t){return function(i){return t.projects.push({type:"groupBy",groupName:i.name||tb_i18n.get("my.projects")}),p.each(e[i._id],function(e){if(e.getRoleScope()>=0)return t.projects.push(e.toJSON())})}}(this)),this},e.prototype.layout=function(){return this.$list.css("maxHeight",Math.max(.7*$(window).height(),300)),this},e.prototype.oninput=function(t){var e;return e=$(t.currentTarget).val().trim().toLowerCase(),this.searchProjects(e)},e.prototype.onkeydown=function(t){var e,i;switch(t.keyCode){case 38:return this.switchActive("up");case 40:return this.switchActive("down");case 13:return e=this.$list.find(".active"),e.length||(e=this.$list.find("li:first")),e.trigger("click")}return i=$(t.currentTarget).val().trim().toLowerCase(),this.searchProjects(i)},e.prototype.searchProjects=function(t){var e,i;return e={},t?(i=[],p.each(this.projects,function(n){var r;if(n.pinyin||n.name)return e[n._id]||!~n.name.toLowerCase().indexOf(t)&&!~(null!=(r=n.pinyin)?r.toLowerCase().indexOf(t):void 0)?void 0:(e[n._id]=!0,i.push(n))}),this.$list.html(r({projects:i,selectedId:this.options.selectedId}))):this.renderProjects(),this},e.prototype.switchProject=function(t){var e,i,n;return e=$(t.currentTarget),n=this.options.projectsCollection.get(e.data("id")),n&&"function"==typeof(i=this.options).onSelectedChange&&i.onSelectedChange(n),this},e.prototype.switchActive=function(t){var e,i,n,r,o;return e=this.$list.find(".active"),e.length||(e=this.$list.find(".selected")),"up"===t&&(o=e.removeClass("active").prevAll(".project-item:first"),n=this.$list.find("li.project-item:last"),o.length>0?o.addClass("active"):n.addClass("active")),"down"===t&&(r=e.removeClass("active").nextAll(".project-item:first"),i=this.$list.find("li.project-item:first"),r.length>0?r.addClass("active"):i.addClass("active")),this.slideTo(this.$list.find(".active"))},e}(s),p.extend(a.prototype,c),t.exports=a},function(t,e){t.exports=function(t){var e='<div class="project-search"> <input class="form-control" placeholder="'+tb_i18n.get("project.switcher.placeholder")+'"></div><ul class="project-list list-underscore thin-scroll"></ul>';return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t.projects;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=" ","groupBy"==r.type?i+=' <li class="group-by"> <p class="group-name">'+e(r.groupName)+"</p> </li> ":(i+=' <li class="project-item" data-id="'+r._id+"\" data-gta=\"{action: 'open detail', type: 'Project', control: 'Project Name', category: '"+r.category+'\'}"> <a class="clearfix"> <div class="project-logo pull-left" style="background-image: url('+r.logo+')"></div> <span>'+e(r.name)+"</span> ","all"==r.visibility?i+=' <span class="visibility-label icon icon-earth hinted" data-title="'+tb_i18n.get("public")+'"></span> ':"organization"==r.visibility&&(i+=' <span class="visibility-label icon icon-building hinted" data-title="'+tb_i18n.get("organization.visible")+'"></span> '),i+=" </a> </li> ");return i}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="";if(t.projects.length){var n=t.projects;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li class="project-item ',0==o&&(i+="active"),i+=" ",t.selectedId==r._id&&(i+="selected"),i+='" data-id="'+r._id+"\" data-gta=\"{action: 'open detail', type: 'Project', control: 'Project Name', category: '"+r.category+'\'}"> <a class="clearfix"> <div class="project-logo pull-left" style="background-image: url('+r.logo+')"></div> <span>'+e(r.name)+"</span> ","all"==r.visibility?i+=' <span class="visibility-label icon icon-earth"></span> ':"organization"==r.visibility&&(i+=' <span class="visibility-label icon icon-building"></span> '),i+=" </a> </li>"}else i+='<div class="placeholder no-result"> <span class="icon icon-search-warning"></span> <p>'+tb_i18n.get("project.switcher.no.result")+"</p></div>";return i}},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;s=i(358),a=i(678),n=i(813),r=i(1536),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.viewName="TasklistPopoverView",e.prototype.className="tasklist-popover-view",e.prototype.popoverTitle="TasklistPopover",e.prototype.width=300,e.prototype.initialize=function(t){return null==t&&(t={}),t.keepPositionOnBottom=!0,e.__super__.initialize.call(this,t),this.listenTo(a.PREFERENCE,"change:pinTasklistBar",this.hide),this.listenTo(a.router,"route",this.hide)},e.prototype.render=function(){var t,e;return e=s.extend({onSmartItemSelect:function(t){return function(){return t.hide()}}(this)},this.options),t=this.requestSubView(r,e).$el,this.$el.html(t),this},e.prototype.onShown=function(){var t;return e.__super__.onShown.apply(this,arguments),this.isShowing=!0,this.setMaxHeight(),t=this.$content,s.delay(function(){return t.find(".filter-input-wrap input").focus()},100),this},e.prototype.onHidden=function(){return e.__super__.onHidden.apply(this,arguments),this.isShowing=!1,this},e.prototype.setMaxHeight=function(){var t;return t=$(window).height(),this.$(".tasklist-bar").css("max-height",t-200+"px")},e}(n)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="row-flex"> <div class="nav-header"> ';t.isGhost?(i+=' <span class="project-switcher-handler"> <strong class="project-name">'+e(t.name)+'</strong> </span> <span class="icon icon-star ',t.isStar&&(i+="starred"),i+='"></span> '):(i+=' <a class="project-switcher-handler" data-gta="{action: \'toggle projects list\', control: \'Project Name\'}"> <strong class="project-name">'+e(t.name)+'</strong><span class="icon icon-chevron-down"></span> </a> <a class="flag-handler"> <span class="icon icon-star ',t.isStar&&(i+="starred"),i+='"></span> </a> '),i+=' <span class="label public-label ',t.isPublic&&(i+="public"),i+='"><span class="icon icon-earth"></span>'+tb_i18n.get("public")+'</span> </div> <section class="nav-body"> <ul class="nav nav-underscore pull-left"> ';var n=t.apps;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li class="',r.name===t.appName&&(i+="active"),i+='"> ',"tasks"===r.name?(i+=' <a class="app" data-app="'+r.name+'" data-scrum-id="'+(t.scrumId||"")+'"> '+(t.scrumName||tb_i18n.get(r.i18n))+' </a> <i class="',t.isTasklistTogglerHidden&&(i+="on-pinned"),i+=' tasklist-pop-handler" data-gta="{action: \'toggle task group menu\', type: \'task group\', control: \'task group titile menu\'}"> <span class="icon icon-chevron-down tasklist-icon"></span> </i> <span class="tasklist-pop-replace"></span> '):i+=' <a class="app" data-app="'+r.name+'"> '+tb_i18n.get(r.i18n)+" </a> ",i+=" </li> ";return i+=' <li class="nav-more ',t.isMoreApp&&(i+="active"),i+='"> <a data-toggle="dropdown" data-gta="{action: \'nav more\', control: \'Project Tabbar\'}"> '+tb_i18n.get("more")+' </a> <ul class="dropdown-menu card"></ul> </li> </ul> </section> <div class="nav-footer"></div></div>'}},function(t,e){t.exports=function(t){var e='<a class="nav-menu-handler ';return"activity"===t.currentPanel&&(e+="on-active"),e+='" data-menu="activity" data-gta="{action: \'toggle task panel menu\', control: \'tasks corner menu\'}"> <i class="icon icon-activities-trend"></i>'+tb_i18n.get("nav.menu.menu")+" ",t.unreadCount&&t.pushStatus?(e+=' <span class="nav-badge" data-mark="activity">',e+=t.unreadCount>99?"99+":""+t.unreadCount,e+="</span> "):t.unreadCount&&(e+=' <span class="nav-badge" data-mark="activity"></span> '),e+="</a>",t.hasFilter&&(e+='<a class="nav-menu-handler ',"filter"===t.currentPanel&&(e+="on-active"),e+='" data-menu="filter" data-gta="{action: \'toggle task filter\', control: \'tasks corner menu\'}"> <i class="icon icon-search-text"></i>'+tb_i18n.get("nav.menu.sortandfilter")+' <i class="icon icon-state-check ',t.isFiltering||(e+="hide"),e+='"></i></a>'),e+='<a class="nav-menu-handler ',"member"===t.currentPanel&&(e+="on-active"),e+='" data-menu="member" data-gta="{action: \'view members\', control: \'Side Member Menu\'}"> <i class="icon icon-users"></i>'+(t.memberLength||0)+"</a>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f=function(t,e){function i(){this.constructor=t}for(var n in e)g.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},g={}.hasOwnProperty;p=i(358),h=i(678),m=i(1739),u=i(1752),d=i(1757),r=i(1751),o=i(1788),n=i(1356),a=i(1789),l=i(1391),s=i(783).EVENT_NAMESPACE,t.exports=c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.event=l.prototype.viewName+"_render",e.prototype.renderToView=function(t){var e,i,n;return this.view=t,i=this.plugin.toJSON(),e=$(o(i)),e.on("click."+s,function(t){return function(){var e;switch(e=i.url,i.mode){case"iframe":return t.pluginHandler(i);case"redirect":return window.open(e);case"api":return d.get(e)}}}(this)),t.$el.find(".my-tab-wrap").append(e),null!=(n=this.$element)&&n.remove(),this.$element=e},e.prototype.listen=function(){return this.listenTo(h.hook,this.event,this.renderToView),this.listenTo(this.plugin,"change",this.rerenderToView),this.listenTo(this.plugin,"remove",this.remove)},e.prototype.pluginHandler=function(t){return this.view.renderSection(a,{targetView:this.view,pluginModel:this.plugin,link:t.url})},e}(r)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<a class="plugin-handler my-tab" data-plugin-id="'+e(t._id)+"\" data-gta=\"{action: 'use plugin', control: '"+e(t.consumer.appType)+"', pluginid: '"+e(t._id)+"'}\"> "+e(t.consumer.name)+"</a>";return i}},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;i(1790),r=i(401),s=i(788),n=i(1792),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="MyPluginView",e.prototype.className="my-plugin-view",e.prototype.initialize=function(t){return this.options=t,this.render().listen()},e.prototype.listen=function(){return this.listenTo(this.options.pluginModel,"remove",function(){return r.log(tb_i18n.get("project.app.plugin.remove.essage")),this.options.targetView.enterSection()})},e.prototype.render=function(){return this.$el.html(n({link:this.options.link})),this},e}(s)},function(t,e){},,function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<iframe class="my-iframe" src="'+e(t.link)+'" frameBorder="none"></iframe>';return i}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;p=i(678),u=i(1739),c=i(1752),l=i(1757),n=i(1751),r=i(1794),o=i(783).EVENT_NAMESPACE,a=i(1795),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.event=a.prototype.viewName+"_render",e.prototype.renderToView=function(t){var e,i,n;return this.view=t,i=this.plugin.toJSON(),e=$(r(i)),e.on("click."+o,".plugin-handler",function(){var e;switch(e=u.replaceMark(i.url,t.organization.toJSON()),i.mode){case"iframe":return t.enterPlugins(i._id);case"redirect":return window.open(e);case"api":return l.get(e)}}),t.$el.find(".nav").append(e),null!=(n=this.$element)&&n.remove(),this.$element=e},e.prototype.listen=function(){return this.listenTo(p.hook,this.event,this.renderToView),this.listenTo(this.plugin,"change",this.rerenderToView),this.listenTo(this.plugin,"remove",this.remove)},e}(n)},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li class="menu-plugin organization-nav-plugins" data-id="'+t._id+'"> <a data-tab-name="plugins" class="plugin-handler"> '+e(t.consumer.name)+" </a></li>";return i}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S,I,z,P,D=function(t,e){function i(){this.constructor=t}for(var n in e)O.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},O={}.hasOwnProperty;S=i(358),P=i(678),I=i(679),M=i(788),T=i(677),o=i(425),_=i(681),a=i(429),j=i(798),f=i(684),y=i(696),h=i(1796),c=i(1854),l=i(1856),p=i(1473),u=i(1861),d=i(1815),b=i(1876),k=i(1474),w=i(1881),v=i(1893),x=i(786),r=i(1897),g=i(1898),n=$(document),C={projects:b,reports:u,members:h,statistics:w,plugins:v},s={projects:"Projects",members:"Members",reports:"Reports",statistics:"Dashboards"},z=_.namespace("temp").namespace("organization_expiring"),t.exports=m=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return D(e,t),e.prototype.viewName="OrganizationView",
e.prototype.className="organization-view",e.prototype.routes={projects:"enterProjects",members:"enterMembers",reports:"enterReports","statistics(/:_tab)":"enterStatistics","plugin(/:_pluginId)":"enterPlugins","*paramString":"enterProjects"},e.prototype.events={"click .organization-nav a:not(.plugin-handler)":"onTabClick","click .organization-guide-enter":"openOrgGuide","click .export-projects":"openProjectsExportTransfer","click .plan-tips":"toggleUpgrade"},e.prototype.initialize=function(t){return this.options=null!=t?t:{},$("html, body").scrollTop(0),this.organization=this.options.organizationModel,this.onOpen(),this.renderBasic().openOrgGuideIntroduce(),y.fetchT(this.organization.id,{boundToObjectType:"organization"})(function(t){return function(e,i){return e?console.error(e):(t.organizationProjects=i,t.renderPlan().refreshPlanTip().listen())}}(this))},e.prototype.listen=function(){return this.listenTo(this.organization,"change:name",function(t){return function(){return t.$(".org-name").text(t.organization.get("name"))}}(this)),this.listenTo(this.organization,"change:plan",function(){var t,e;if(this.renderPlan(),this.renderProjects(),!this.organization.isOverdue())return null!=(t=this.expiringView)&&t.remove(),null!=(e=this.overdueView)?e.remove():void 0}),this.listenTo(this.organizationProjects,"add remove",this.renderPlan),this},e.prototype.beforeClose=function(){return $("#navigator .organization-switcher-handler").removeClass("active")},e.prototype.onOpen=function(){return $("#navigator .organization-switcher-handler").addClass("active")},e.prototype.renderBasic=function(){var t,e;return e=this.organization.toJSON(),e.roleScope=this.organization.getRoleScope(),this.$el.html(r(e)),this.triggerHook("render"),this.$organizationTabContent=this.$(".organization-tab-content"),this.organization.isExpiring()?S.delay(function(t){return function(){return t.showExpiring()}}(this)):this.organization.isOverdue()&&(t=P.router.getUrl().split("/"),"projects"===t[2]&&S.delay(function(t){return function(){return t.showOverdue()}}(this))),this},e.prototype.renderPlan=function(){var t,e,i,n;return n=this.organization.getPaymentPlan(),n.restDays<8?("trial"===n.status?(i=j.pay.orgNew(this.organization.id),e=tb_i18n.get("organization.payment.buy")):(i=j.pay.orgRenew(this.organization.id),e=tb_i18n.get("organization.buy.now")),t=n.restDays>0?tb_i18n.get("organization.dueday",n.restDays):tb_i18n.get("organization.overdue"),this.$(".plan-tips-wrap").html(g({payUrl:i,expireHint:t,payHint:e}))):this.$(".plan-tips-wrap").html(""),this},e.prototype.showOverdue=function(){var t;return null!=(t=this.overdueView)&&t.remove(),this.overdueView=this.requestSubView(x).open(p,{_organizationId:this.organization.id}),this},e.prototype.showExpiring=function(){var t,e,i;return this.organizationsCollection=f.get(0),this.organizationModel=this.organizationsCollection.get(this.organization.id),this.localCacheId=""+this.organization.id,i=z(this.localCacheId),e=a(),i&&e.isSame(i,"day")||(z(this.localCacheId,e),null!=(t=this.expiringView)&&t.remove(),this.expiringView=this.requestSubView(x).open(c,{_organizationId:this.organization.id})),this},e.prototype.switchTo=function(t,e){return this.$(".organization-nav li").removeClass("active"),"plugins"===t?this.$(".organization-nav-"+t+"[data-id="+e+"]").addClass("active"):this.$(".organization-nav-"+t).addClass("active"),this},e.prototype.enterProjects=function(){return this.enterTab("projects")},e.prototype.enterMembers=function(){return this.enterTab("members")},e.prototype.enterReports=function(){return this.enterTab("reports")},e.prototype.enterStatistics=function(t){return this.enterTab("statistics",{tab:t})},e.prototype.enterPlugins=function(t){return this.enterTab("plugins",{_pluginId:t})},e.prototype.enterTab=function(t,e){var i,n;if(null==t&&(t="projects"),~["reports","statistics","plugins"].indexOf(t)&&this.organization.getRoleScope()<0&&(t="projects",e=null),i={tabName:t},e)switch(i.options=e,t){case"plugins":n=e._pluginId,this.switchTo("plugins",n),this.navigateTo("/plugin/"+n,{trigger:!1});break;case"statistics":n=e.tab,this.switchTo(t),this.navigateTo("/"+t+"/"+n,{trigger:!1})}else this.switchTo(t),this.navigateTo("/"+t,{trigger:!1});return this.renderTab(i)},e.prototype.onTabClick=function(t){var e,i;return t.preventDefault(),e=$(t.target),i=e.data("tab-name"),"setting"===i?this.openOrganizationSettings():(this.enterTab(i),S.delay(function(t){return function(){return t.initPageGTA(i)}}(this)))},e.prototype.renderTab=function(t){var e,i,n,r;return r=t.tabName,e=t.options,null!=(i=this.contentView)&&i.remove(),e=S.extend({organizationModel:this.organization},e),this.contentView=this.requestSubView(C[r],e),null!=(n=this.$organizationTabContent)?n.append(this.contentView.$el):void 0},e.prototype.initPageGTA=function(t){if("plugins"!==t)return P.gta.setCurrentPage("Org "+s[t]+" Page")},e.prototype.openOrganizationSettings=function(){return new d({organizationModel:this.organization}),this},e.prototype.openProjectsExportTransfer=function(){var t,e;return t=f.get(0).getOrganizationsByRight(2),e=S.pluck(t,"id"),e.push(0),this.requestSubView(x).open(k,{sourceId:this.organization.id,targetIds:e,action:"export"}),this},e.prototype.openOrgGuideIntroduce=function(){return(this.organization.get("isNew")||P.router.getUrl().match(/isNew=true/)||P.router.getUrl().match(/form=business/i))&&(this.organization.unset("isNew",{silent:!0}),this.openOrgGuide()),this},e.prototype.openOrgGuide=function(){return this.requestSubView(x).open(l,{organizationModel:this.organization,initStep:"introduce"}),this},e.prototype.refreshPlanTip=function(){return this.organizationProjects.length||this.$(".export-projects").hide(),this},e.prototype.navigateTo=function(t,e){var i;return i="/organization/"+this.organization.get("_id"),t&&(i+=t),P.router.navigate(i,e),this},e.prototype.remove=function(){return this.beforeClose(),n.off("scroll.organization-auto-nav"),e.__super__.remove.apply(this,arguments)},e.prototype.toggleUpgrade=function(){return this.$(".plan-tips>a").trigger("click"),this},e}(M)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S,I=function(t,e){function i(){this.constructor=t}for(var n in e)z.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},z={}.hasOwnProperty,P=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};x=i(358),S=i(678),M=i(788),T=i(677),s=i(401),h=i(1008),l=i(700),p=i(699),_=i(1010),j=i(798),C=i(786),k=i(1797),c=i(1194),f=i(1815),w=i(1252),b=i(1837),n=i(1251),d=i(1843),m=i(1848),y=i(1245),o=i(805),r=i(1850),u=i(1851),a=i(1852),v=i(1853),t.exports=g=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return I(e,t),e.prototype.viewName="OrganizationStructureView",e.prototype.className="organization-structure-view flex flex-between flex-vstart",e.prototype.events={"click .add-member-handler.to-org":"showAddOrgMember","click .add-member-handler.to-team":"showAddTeamMember","click .add-team-handler":"showAddTeam","click .add-subteam-handler":"showAddSubTeam","click .assign-team":"showAssignTeam","click .org-member-menu-handler":"toggleOrgMemberMenu","click .team-member-menu-handler":"toggleTeamMemberMenu","click .team-more-menu":"showTeamMenu","keyup .filter-input":"filterMember","click li.team-node":"selectTeam","click .member":"showMemberCard","click .order-teams-handler":"openTeamStructureModalView"},e.prototype.initialize=function(t){if(t.organizationModel)return this.organizationModel=t.organizationModel,this.roleScope=this.organizationModel.getRoleScope(),this.load({success:function(t){return function(){return t.renderBasic(),t.switchSelected("all"),t.listen()}}(this)})},e.prototype.load=function(t){return this.showLoadingIndicator(),Promise.all([new Promise(function(t){return function(e,i){return p.fetch(t.organizationModel.id,{boundToObjectType:"organization",success:e,error:function(t,e){return i(e)}})}}(this)),new Promise(function(t){return function(e,i){return _.fetch(t.organizationModel.id,{boundToObjectType:"organization",success:e,error:function(t,e){return i(e)}})}}(this))]).then(function(e){return function(i){if(e.$el)return e.membersCollection=i[0],e.teamsCollection=i[1],e.teamTreeState=e.initTeamTreeState(),e.parseTeamTree(),t.success(),e.hideLoadingIndicator()}}(this))},e.prototype.listen=function(){return this.listenTo(this.teamsCollection,"add change remove",function(t){return function(e){return t.parseTeamTree()}}(this)),this.listenTo(this.teamsCollection,"add",function(t){return function(e){return t.teamTreeState[e.get("_parentId")]=!0,t.renderBasic(),t.switchSelected(e.id)}}(this)),this.listenTo(this.teamsCollection,"change",function(t){return function(e){if(t.renderTeamTree(),e.id===t.currentTeamId)return t.switchSelected(e.id)}}(this)),this.listenTo(this.teamsCollection,"remove",function(t){return function(e){if(t.renderBasic(),e.id===t.currentTeamId)return t.switchSelected("all")}}(this)),this.listenTo(this.membersCollection,"add change remove",this.renderTeamPanel),this.listenTo(this.teamsCollection,"change:pos",this.renderTeamTree)},e.prototype.initTeamTreeState=function(){var t;return t={},this.teamsCollection.toJSON().map(function(t){return t._id}).forEach(function(e){return t[e]=!1}),t},e.prototype.renderBasic=function(){return this.$el.html(r({_organizationId:this.organizationModel.id,canReorderTeam:this.organizationModel.hasPermission("team.move")&&this.teamsCollection.length>1,permissions:this.organizationModel.hasPermissions("team.post","role.post","role.put","role.del")})),this.renderTeamTree()},e.prototype.renderTeamTree=function(){var t;return null!=(t=this.teamTreeView)&&t.remove(),this.teamTreeView=this.requestSubView(w,{teamTree:this.teamTree,teamTreeState:this.teamTreeState,onSelect:function(t){return function(e){return t.currentTeamId=e[0],t.switchSelected(t.currentTeamId)}}(this)}),this.$(".teams-list").html(this.teamTreeView.$el)},e.prototype.parseTeamTree=function(){return this.teamTree=h.parseTree(this.teamsCollection.toJSON())},e.prototype.selectTeam=function(t){var e,i;return e=$(t.currentTarget),i=e.data("id"),this.switchSelected(i)},e.prototype.switchSelected=function(t){return this.currentTeamId=t,this.changeActive(this.currentTeamId),this.renderTeamPanelDebounce()},e.prototype.renderTeamPanelDebounce=function(){return this._renderTeamPanelDebounce||(this._renderTeamPanelDebounce=x.debounce(this.renderTeamPanel,100)),this._renderTeamPanelDebounce()},e.prototype.renderTeamPanel=function(){return this.renderTeamHeader(),this.renderMembers()},e.prototype.renderTeamHeader=function(){var t;return t=h.getTeamObject(this.currentTeamId,this.teamTree,this.membersCollection.toJSON()),t.permissions=this.organizationModel.hasPermissions("team.post","post.member"),this.$(".team-header").html(a(t)),this.updateFilterPlaceholder(t)},e.prototype.updateFilterPlaceholder=function(t){var e;return e=tb_i18n.get("team.member.search.placeholder",t.name),this.$(".filter-input").attr("placeholder",e),this.$(".filter-input").val("")},e.prototype.filterMember=function(){return this.renderMembers()},e.prototype.renderMembers=function(){var t,e,i;return e=h.getTeamMembers(this.currentTeamId,this.teamTree,this.membersCollection.toJSON()),i=this.$(".filter-input").val().trim(),i&&(e=T.memberFilter(e,i)),t=function(t){return function(e){var i;return i=t.currentTeamId,P.call(e.teams,i)>=0}}(this),this.isFakeTeam()||(e=e.sort(function(e,i){return Number(t(i))-Number(t(e))})),e.forEach(function(e){return function(i){var n,r;return n=h.getMemberTeams(i,e.teamTree),r=T.getMemberPermissions(e.organizationModel,i),i=x.extend(i,{roleName:e.membersCollection.get(i._id).getRole(),teamsText:n.map(function(t){return t.name}).join(tb_i18n.get("teams.split")),teamsColors:n.map(function(t){return t.style.split(",")[1]}).splice(0,3).reverse(),isDirectMember:t(i)},r)}}(this)),this.$(".member-list").html(u({isFakeTeam:this.isFakeTeam(),members:e,permissions:this.organizationModel.hasPermissions("del.member","put.defaultrole","post.member"),placeholder:v}))},e.prototype.isFakeTeam=function(t){return t||(t=this.currentTeamId),"all"===t||"new"===t||"unassigned"===t},e.prototype.changeActive=function(t){return this.$(".team-node").removeClass("active"),this.$(".team-"+t).addClass("active")},e.prototype.showAddTeam=function(t,e){var i,n;if(i=$(t.currentTarget),!i.data("bs.popover"))return null!=(n=this.TeamMenuView)&&n.remove(),this.TeamMenuView=this.requestSubView(b,{type:"create",$toggler:i,isLevelOneTeam:!Boolean(e),organizationModel:this.organizationModel,parentName:e?x.find(this.teamsCollection.toJSON(),function(t){return t._id===e}).name:"",onConfirm:function(t){return function(i){return i=x.extend(i,{_organizationId:t.organizationModel.id,_parentId:e||t.getRootTeam()._id}),t.teamsCollection.create(i,{wait:!0,success:function(t){return s.success(tb_i18n.get("team.create.success"))}})}}(this)}).show()},e.prototype.getRootTeam=function(){return x.find(this.teamsCollection.toJSON(),function(t){return"default"===t.type})},e.prototype.showAddSubTeam=function(t){return this.showAddTeam(t,this.currentTeamId)},e.prototype.showAddOrgMember=function(t){var e;return null!=(e=this.orgMemberAddView)&&e.remove(),this.orgMemberAddView=this.requestSubView(C).open(d,{title:tb_i18n.get("organization.member.add"),target:this.organizationModel,showMemberProgress:!0,onMembersExceed:this.showMemberExceed.bind(this),organizationModel:this.organizationModel,onBatchInvite:!0})},e.prototype.showAddTeamMember=function(t){var e;return null!=(e=this.orgMemberAddView)&&e.remove(),this.orgMemberAddView=this.requestSubView(C).open(d,{title:tb_i18n.get("team.member.add"),source:this.membersCollection,sourceTitle:tb_i18n.get("organization.member"),target:this.teamsCollection.get(this.currentTeamId),showMemberProgress:!0,onMembersExceed:this.showMemberExceed.bind(this),organizationModel:this.organizationModel,onBatchInvite:!0})},e.prototype.showMemberExceed=function(){return this.requestSubView(C).open(o,{title:tb_i18n.get("organization.member.exceed"),content:tb_i18n.get("organization.member.exceed.description",this.organizationModel.getPaymentPlan().membersLimit),confirmText:tb_i18n.get("organization.settings.add.member.toplimit"),confirmHref:j.pay.orgAddMember(this.organizationModel.id)}),S.gta.event({action:"reach plan limit",type:"business",control:"org member number"})},e.prototype.showTeamMenu=function(t){var e,i,n,r,o;if(e=$(t.currentTarget),!e.data("bs.popover"))return r=e.data("id"),o=this.teamsCollection.get(r),i=o.get("_parentId")===this.organizationModel.get("_defaultTeamId"),null!=(n=this.teamMenuView)&&n.remove(),this.teamMenuView=this.requestSubView(b,{$toggler:e,teamModel:o,organizationModel:this.organizationModel,isLevelOneTeam:i,parentName:i?void 0:this.teamsCollection.get(o.get("_parentId")).get("name")}).show()},e.prototype.showAssignTeam=function(t){var e,i;if(t.assignTeamClick=!0,e=$(t.currentTarget),!e.data("bs.popover"))return null!=(i=this.assignTeamView)&&i.remove(),this.assignTeamView=this.requestSubView(C).open(n,{memberModel:this.membersCollection.get(e.data("id")),teamTree:this.teamTree,teamTreeState:this.teamTreeState,gta:{type:"member info",control:"Org Member List"}})},e.prototype.toggleOrgMemberMenu=function(t){var e,i,n;if(e=$(t.currentTarget),!e.hasClass("disabled")&&(t.memberMenuClick=!0,i=e.data("id"),!e.data("bs.popover")))return null!=(n=this.orgMemberMenuView)&&n.remove(),this.orgMemberMenuView=this.requestSubView(m,{$toggler:e,memberModel:this.membersCollection.get(i),membersCollection:this.membersCollection,organizationModel:this.organizationModel,onRemove:function(t){return function(){return t.removeMember(i)}}(this)}).show()},e.prototype.toggleTeamMemberMenu=function(t){var e,i,n;if(e=$(t.currentTarget),!e.hasClass("disabled")&&(t.memberMenuClick=!0,i=e.data("id"),!e.data("bs.popover")))return null!=(n=this.teamMemberMenuView)&&n.remove(),this.teamMemberMenuView=this.requestSubView(y,{$toggler:e,memberModel:this.membersCollection.get(i),membersCollection:this.membersCollection,organizationModel:this.organizationModel,teamId:this.currentTeamId,onRemove:function(t){return function(){return t.removeMember(i)}}(this)}).show()},e.prototype.showMemberCard=function(t){var e,i,n,r;return this.roleScope<0?this:(null!=(r=this.memberCardView)&&r.remove(),t.memberMenuClick||t.assignTeamClick?this:(S.gta.event({action:"open detail",type:"org member",control:"Org Member List"}),e=$(t.currentTarget),n=e.data("id"),this.currentMember=i=this.membersCollection.get(n),this.memberCardView=this.requestSubView(C).open(c,{memberModel:i,organizationModel:this.organizationModel,teamsCollection:this.teamsCollection})))},e.prototype.openTeamStructureModalView=function(){return this.requestSubView(C).open(k,{membersCollection:this.membersCollection,teamsCollection:this.teamsCollection})},e.prototype.removeMember=function(t){return this.$(".member[data-id="+t+"]").remove()},e}(M)},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;c=i(358),l=i(1798),o=i(1811),a=i(1813),n=i(1814),r=i(1008),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="TeamStructureModalView",e.prototype.className="team-structure-modal-view modal-dialog",e.prototype.events={"click .team-item.has-child":"enterTeam","click .prev-handler":"leaveTeam"},e.prototype.initialize=function(t){return this.teamsCollection=t.teamsCollection,this.membersCollection=t.membersCollection,this.parseTree(),this.defaultTeamId=this.teamTree._id,this._parentId=this.teamTree._id,this.teamIds=[this._parentId],e.__super__.initialize.apply(this,arguments)},e.prototype.listen=function(){return this.stopListening(this.teamsCollection),this.listenTo(this.teamsCollection,"add change:pos remove",this.parseTree),this.listenTo(this.teamsCollection,"add change:pos",function(){return this.assembleContent(),this.renderBasic()}),this.listenTo(this.teamsCollection,"remove",function(t){var e;return e=this.teamIds.indexOf(t.id),~e&&t.get("_parentId")===this._parentId?(this.teamIds.pop(),this.assembleContent(),this["goto"](e)):(this.assembleContent(),this.renderBasic())})},e.prototype.onOpen=function(){return this.isReady=!0,this.componentUpdated()},e.prototype.componentUpdated=function(t){var e,i;if(this.isReady)return t||(t=0),e=this.getTeams(this.teamIds[t]),i=this.getTeamDatas(e),this.initJqTree(i),this.listen()},e.prototype.parseTree=function(){return this.teamTree=r.parseTree(this.teamsCollection.toJSON())},e.prototype.getTeamDatas=function(t){var e;return e=t.map(function(t,e){var i;return i=!!t.children.length,{hasChild:i,name:a({name:t.name,hasChild:i}),teamId:t._id}})},e.prototype.getTeams=function(t){var e;return e=t===this.defaultTeamId?this.teamTree.children:r.getTeamObject(t,this.teamTree,this.membersCollection.toJSON()).children},e.prototype.initJqTree=function(t){return this.$teamList=this.$(".team-list"),this.$teamList.tree({data:t,saveState:!0,autoEscape:!1,onCanMoveTo:function(t,e,i){return"inside"!==i},onCreateLi:function(t,e){var i;return i=t.hasChild?"team-item has-child":"team-item",e.addClass(i).attr("data-id",t.teamId)},dragAndDrop:!0}),this.listenEvent()},e.prototype.listenEvent=function(){return this.$teamList.bind("tree.move",function(t){return function(e){var i,n,r,o,s;return e.preventDefault(),s=e.move_info,r=s.moved_node.teamId,n=$(s.target_node.element),"before"===s.position?o=n.data("id"):(i=n.nextAll(".team-item").eq(0),o=i.length?i.data("id"):null),s.do_move(),t.updateTeamStatus(r,o)}}(this))},e.prototype.updateTeamStatus=function(t,e){var i,n;if(t)return n=this.teamsCollection.get(t),i={attrs:{_nextId:e}},n.move(i)},e.prototype.enterTeam=function(t){return this._parentId=$(t.target).closest(".team-item").data("id"),this.teamIds.push(this._parentId),this.assembleContent(),this.goNext()},e.prototype.leaveTeam=function(t){return t.stopPropagation(),this._parentId=this.teamIds.pop(),this.assembleContent(),this.goPrev()},e.prototype.assembleContent=function(){return this.contentList=this.teamIds.map(function(t){return function(e){var i,r;return r=e===t.defaultTeamId?tb_i18n.get("organization.team.order.title"):tb_i18n.get("oragnization.team.order.title.child"),i=n({teams:t.getTeams(e)}),{title:r,body:i}}}(this))},e}(o)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C=function(t,e){function i(){this.constructor=t}for(var n in e)x.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},x={}.hasOwnProperty;w=i(1799),j=i(1800),o=j.DragAndDropHandler,s=j.DragElement,p=j.HitAreasGenerator,a=i(1802),d=i(1805),h=i(1806),v=i(1808),y=i(1809),b=i(1810),k=i(1807),_=i(1801),m=_.Node,g=_.Position,M=i(1804),T=i(1803),r=T.BorderDropHint,c=T.FolderElement,l=T.GhostDropHint,f=T.NodeElement,n=jQuery,u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return C(e,t),e.prototype.BorderDropHint=r,e.prototype.DragElement=s,e.prototype.DragAndDropHandler=o,e.prototype.ElementsRenderer=a,e.prototype.GhostDropHint=l,e.prototype.HitAreasGenerator=p,e.prototype.Node=m,e.prototype.SaveStateHandler=v,e.prototype.ScrollHandler=y,e.prototype.SelectNodeHandler=b,e.prototype.defaults={autoOpen:!1,saveState:!1,dragAndDrop:!1,selectable:!0,useContextMenu:!0,onCanSelectNode:null,onSetStateFromStorage:null,onGetStateFromStorage:null,onCreateLi:null,onIsMoveHandle:null,onCanMove:null,onCanMoveTo:null,onLoadFailed:null,autoEscape:!0,dataUrl:null,closedIcon:null,openedIcon:"&#x25bc;",slide:!0,nodeClass:m,dataFilter:null,keyboardSupport:!0,openFolderDelay:500,rtl:null,onDragMove:null,onDragStop:null,buttonLeft:!0,onLoading:null},e.prototype.toggle=function(t,e){return null==e&&(e=null),null===e&&(e=this.options.slide),t.is_open?this.closeNode(t,e):this.openNode(t,e),this.element},e.prototype.getTree=function(){return this.tree},e.prototype.selectNode=function(t){return this._selectNode(t,!1),this.element},e.prototype._selectNode=function(t,e){var i,n,r,o;if(null==e&&(e=!1),this.select_node_handler){if(i=function(e){return function(){return e.options.onCanSelectNode?e.options.selectable&&e.options.onCanSelectNode(t):e.options.selectable}}(this),r=function(e){return function(){var i;if(i=t.parent,i&&i.parent&&!i.is_open)return e.openNode(i,!1)}}(this),o=function(t){return function(){if(t.options.saveState)return t.save_state_handler.saveState()}}(this),!t)return this._deselectCurrentNode(),void o();if(i())return this.select_node_handler.isNodeSelected(t)?e&&(this._deselectCurrentNode(),this._triggerEvent("tree.select",{node:null,previous_node:t})):(n=this.getSelectedNode(),this._deselectCurrentNode(),this.addToSelection(t),this._triggerEvent("tree.select",{node:t,deselected_node:n}),r()),o()}},e.prototype.getSelectedNode=function(){return this.select_node_handler?this.select_node_handler.getSelectedNode():null},e.prototype.toJson=function(){return JSON.stringify(this.tree.getData())},e.prototype.loadData=function(t,e){return this._loadData(t,e),this.element},e.prototype.loadDataFromUrl=function(t,e,i){return"string"===n.type(t)?this._loadDataFromUrl(t,e,i):this._loadDataFromUrl(null,t,e),this.element},e.prototype.reload=function(t){return this._loadDataFromUrl(null,null,t),this.element},e.prototype._loadDataFromUrl=function(t,e,i){var r,o,s,a,c,l,p,u;r=null,o=function(t){return function(){return r=e?n(e.element):t.element,r.addClass("jqtree-loading"),t._notifyLoading(!0,e,r)}}(this),u=function(t){return function(){if(r)return r.removeClass("jqtree-loading"),t._notifyLoading(!1,e,r)}}(this),p=function(){return"string"===n.type(t)?{url:t}:(t.method||(t.method="get"),t)},s=function(t){return function(r){if(u(),t._loadData(r,e),i&&n.isFunction(i))return i()}}(this),c=function(t){return function(e){var i;return i=n.isArray(e)||"object"==typeof e?e:null!=i?n.parseJSON(e):[],t.options.dataFilter&&(i=t.options.dataFilter(i)),s(i)}}(this),a=function(t){return function(e){if(u(),t.options.onLoadFailed)return t.options.onLoadFailed(e)}}(this),l=function(){return t=p(),n.ajax(n.extend({},t,{method:null!=t.method?t.method.toUpperCase():"GET",cache:!1,dataType:"json",success:c,error:a}))},t||(t=this._getDataUrlInfo(e)),o(),t?n.isArray(t)?s(t):l():u()},e.prototype._loadData=function(t,e){var i,n;if(null==e&&(e=null),i=function(t){return function(){var i,n,r,o;if(t.select_node_handler)for(o=t.select_node_handler.getSelectedNodesUnder(e),i=0,n=o.length;i<n;i++)r=o[i],t.select_node_handler.removeFromSelection(r);return null}}(this),n=function(i){return function(){return e.loadFromData(t),e.load_on_demand=!1,e.is_loading=!1,i._refreshElements(e)}}(this),t)return this._triggerEvent("tree.load_data",{tree_data:t}),e?(i(),n()):this._initTree(t),this.isDragging()?this.dnd_handler.refresh():void 0},e.prototype.getNodeById=function(t){return this.tree.getNodeById(t)},e.prototype.getNodeByName=function(t){return this.tree.getNodeByName(t)},e.prototype.getNodesByProperty=function(t,e){return this.tree.getNodesByProperty(t,e)},e.prototype.openNode=function(t,e){return null==e&&(e=null),null===e&&(e=this.options.slide),this._openNode(t,e),this.element},e.prototype._openNode=function(t,e,i){var n,r;if(null==e&&(e=!0),n=function(t){return function(e,i,n){var r;return r=new c(e,t),r.open(n,i)}}(this),t.isFolder()){if(t.load_on_demand)return this._loadFolderOnDemand(t,e,i);for(r=t.parent;r;)r.parent&&n(r,!1,null),r=r.parent;return n(t,e,i),this._saveState()}},e.prototype._loadFolderOnDemand=function(t,e,i){return null==e&&(e=!0),t.is_loading=!0,this._loadDataFromUrl(null,t,function(n){return function(){return n._openNode(t,e,i)}}(this))},e.prototype.closeNode=function(t,e){return null==e&&(e=null),null===e&&(e=this.options.slide),t.isFolder()&&(new c(t,this).close(e),this._saveState()),this.element},e.prototype.isDragging=function(){return!!this.dnd_handler&&this.dnd_handler.is_dragging},e.prototype.refreshHitAreas=function(){return this.dnd_handler.refresh(),this.element},e.prototype.addNodeAfter=function(t,e){var i;return i=e.addAfter(t),this._refreshElements(e.parent),i},e.prototype.addNodeBefore=function(t,e){var i;return i=e.addBefore(t),this._refreshElements(e.parent),i},e.prototype.addParentNode=function(t,e){var i;return i=e.addParent(t),this._refreshElements(i.parent),i},e.prototype.removeNode=function(t){var e;return e=t.parent,e&&(this.select_node_handler.removeFromSelection(t,!0),t.remove(),this._refreshElements(e)),this.element},e.prototype.appendNode=function(t,e){var i;return e=e||this.tree,i=e.append(t),this._refreshElements(e),i},e.prototype.prependNode=function(t,e){var i;return e||(e=this.tree),i=e.prepend(t),this._refreshElements(e),i},e.prototype.updateNode=function(t,e){var i;return i=e.id&&e.id!==t.id,i&&this.tree.removeNodeFromIndex(t),t.setData(e),i&&this.tree.addNodeToIndex(t),"object"==typeof e&&e.children&&e.children.length&&(t.removeChildren(),t.loadFromData(e.children)),this.renderer.renderFromNode(t),this._selectCurrentNode(),this.element},e.prototype.moveNode=function(t,e,i){var n;return n=g.nameToIndex(i),this.tree.moveNode(t,e,n),this._refreshElements(),this.element},e.prototype.getStateFromStorage=function(){return this.save_state_handler.getStateFromStorage()},e.prototype.addToSelection=function(t){return t&&(this.select_node_handler.addToSelection(t),this._getNodeElementForNode(t).select(),this._saveState()),this.element},e.prototype.getSelectedNodes=function(){return this.select_node_handler.getSelectedNodes()},e.prototype.isNodeSelected=function(t){return this.select_node_handler.isNodeSelected(t)},e.prototype.removeFromSelection=function(t){return this.select_node_handler.removeFromSelection(t),this._getNodeElementForNode(t).deselect(),this._saveState(),this.element},e.prototype.scrollToNode=function(t){var e,i;return e=n(t.element),i=e.offset().top-this.$el.offset().top,this.scroll_handler.scrollTo(i),this.element},e.prototype.getState=function(){return this.save_state_handler.getState()},e.prototype.setState=function(t){return this.save_state_handler.setInitialState(t),this._refreshElements(),this.element},e.prototype.setOption=function(t,e){return this.options[t]=e,this.element},e.prototype.moveDown=function(){return this.key_handler&&this.key_handler.moveDown(),this.element},e.prototype.moveUp=function(){return this.key_handler&&this.key_handler.moveUp(),this.element},e.prototype.getVersion=function(){return w},e.prototype._init=function(){if(e.__super__._init.call(this),this.element=this.$el,this.mouse_delay=300,this.is_initialized=!1,this.options.rtl=this._getRtlOption(),this.options.closedIcon||(this.options.closedIcon=this._getDefaultClosedIcon()),this.renderer=new a(this),null!=v?this.save_state_handler=new v(this):this.options.saveState=!1,null!=b&&(this.select_node_handler=new b(this)),null!=o?this.dnd_handler=new o(this):this.options.dragAndDrop=!1,null!=y&&(this.scroll_handler=new y(this)),null!=d&&null!=b&&(this.key_handler=new d(this)),this._initData(),this.element.click(n.proxy(this._click,this)),this.element.dblclick(n.proxy(this._dblclick,this)),this.options.useContextMenu)return this.element.bind("contextmenu",n.proxy(this._contextmenu,this))},e.prototype._deinit=function(){return this.element.empty(),this.element.unbind(),this.key_handler&&this.key_handler.deinit(),this.tree=null,e.__super__._deinit.call(this)},e.prototype._initData=function(){return this.options.data?this._loadData(this.options.data):this._loadDataFromUrl(this._getDataUrlInfo())},e.prototype._getDataUrlInfo=function(t){var e,i;return e=this.options.dataUrl||this.element.data("url"),i=function(i){return function(){var n,r,o;return o={url:e},t&&t.id?(n={node:t.id},o.data=n):(r=i._getNodeIdToBeSelected(),r&&(n={selected_node:r},o.data=n)),o}}(this),n.isFunction(e)?e(t):"string"===n.type(e)?i():e},e.prototype._getNodeIdToBeSelected=function(){return this.options.saveState?this.save_state_handler.getNodeIdToBeSelected():null},e.prototype._initTree=function(t){var e,i;return e=function(t){return function(){if(!t.is_initialized)return t.is_initialized=!0,t._triggerEvent("tree.init")}}(this),this.tree=new this.options.nodeClass(null,(!0),this.options.nodeClass),this.select_node_handler&&this.select_node_handler.clear(),this.tree.loadFromData(t),i=this._setInitialState(),this._refreshElements(),i?this._setInitialStateOnDemand(e):e()},e.prototype._setInitialState=function(){var t,e,i,n,r;return r=function(t){return function(){var e,i;return t.options.saveState&&t.save_state_handler?(i=t.save_state_handler.getStateFromStorage(),i?(e=t.save_state_handler.setInitialState(i),[!0,e]):[!1,!1]):[!1,!1]}}(this),t=function(t){return function(){var e,i;return t.options.autoOpen!==!1&&(e=t._getAutoOpenMaxLevel(),i=!1,t.tree.iterate(function(t,n){return t.load_on_demand?(i=!0,!1):!!t.hasChildren()&&(t.is_open=!0,n!==e)}),i)}}(this),n=r(),e=n[0],i=n[1],e||(i=t()),i},e.prototype._setInitialStateOnDemand=function(t){var e,i;if(i=function(e){return function(){var i;return!(!e.options.saveState||!e.save_state_handler)&&(i=e.save_state_handler.getStateFromStorage(),!!i&&(e.save_state_handler.setInitialStateOnDemand(i,t),!0))}}(this),e=function(e){return function(){var i,n,r,o;return r=e._getAutoOpenMaxLevel(),n=0,i=function(t){return n+=1,e._openNode(t,!1,function(){return n-=1,o()})},(o=function(){if(e.tree.iterate(function(t,n){return t.load_on_demand?(t.is_loading||i(t),!1):(e._openNode(t,!1),n!==r)}),0===n)return t()})()}}(this),!i())return e()},e.prototype._getAutoOpenMaxLevel=function(){return this.options.autoOpen===!0?-1:parseInt(this.options.autoOpen)},e.prototype._refreshElements=function(t){return null==t&&(t=null),this.renderer.render(t),this._triggerEvent("tree.refresh")},e.prototype._click=function(t){var e,i,n;if(e=this._getClickTarget(t.target)){
if("button"===e.type)return this.toggle(e.node,this.options.slide),t.preventDefault(),t.stopPropagation();if("label"===e.type&&(n=e.node,i=this._triggerEvent("tree.click",{node:n,click_event:t}),!i.isDefaultPrevented()))return this._selectNode(n,!0)}},e.prototype._dblclick=function(t){var e;if(e=this._getClickTarget(t.target),e&&"label"===e.type)return this._triggerEvent("tree.dblclick",{node:e.node,click_event:t})},e.prototype._getClickTarget=function(t){var e,i,r,o;if(r=n(t),e=r.closest(".jqtree-toggler"),e.length){if(o=this._getNode(e))return{type:"button",node:o}}else if(i=r.closest(".jqtree-element"),i.length&&(o=this._getNode(i)))return{type:"label",node:o};return null},e.prototype._getNode=function(t){var e;return e=t.closest("li.jqtree_common"),0===e.length?null:e.data("node")},e.prototype._getNodeElementForNode=function(t){return t.isFolder()?new c(t,this):new f(t,this)},e.prototype._getNodeElement=function(t){var e;return e=this._getNode(t),e?this._getNodeElementForNode(e):null},e.prototype._contextmenu=function(t){var e,i;if(e=n(t.target).closest("ul.jqtree-tree .jqtree-element"),e.length&&(i=this._getNode(e)))return t.preventDefault(),t.stopPropagation(),this._triggerEvent("tree.contextmenu",{node:i,click_event:t}),!1},e.prototype._saveState=function(){if(this.options.saveState)return this.save_state_handler.saveState()},e.prototype._mouseCapture=function(t){return!!this.options.dragAndDrop&&this.dnd_handler.mouseCapture(t)},e.prototype._mouseStart=function(t){return!!this.options.dragAndDrop&&this.dnd_handler.mouseStart(t)},e.prototype._mouseDrag=function(t){var e;return!!this.options.dragAndDrop&&(e=this.dnd_handler.mouseDrag(t),this.scroll_handler&&this.scroll_handler.checkScrolling(),e)},e.prototype._mouseStop=function(t){return!!this.options.dragAndDrop&&this.dnd_handler.mouseStop(t)},e.prototype._triggerEvent=function(t,e){var i;return i=n.Event(t),n.extend(i,e),this.element.trigger(i),i},e.prototype.testGenerateHitAreas=function(t){return this.dnd_handler.current_item=this._getNodeElementForNode(t),this.dnd_handler.generateHitAreas(),this.dnd_handler.hit_areas},e.prototype._selectCurrentNode=function(){var t,e;if(t=this.getSelectedNode(),t&&(e=this._getNodeElementForNode(t)))return e.select()},e.prototype._deselectCurrentNode=function(){var t;if(t=this.getSelectedNode())return this.removeFromSelection(t)},e.prototype._getDefaultClosedIcon=function(){return this.options.rtl?"&#x25c0;":"&#x25ba;"},e.prototype._getRtlOption=function(){var t;return null!==this.options.rtl?this.options.rtl:(t=this.element.data("rtl"),null!=t&&t!==!1)},e.prototype._notifyLoading=function(t,e,i){if(this.options.onLoading)return this.options.onLoading(t,e,i)},e}(h),u.getModule=function(t){var e;return e={node:_,util:M},e[t]},k.register(u,"tree")},function(t,e){t.exports="1.3.3"},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;l=i(1801),a=l.Position,n=jQuery,r=function(){function t(t){this.tree_widget=t,this.hovered_area=null,this.$ghost=null,this.hit_areas=[],this.is_dragging=!1,this.current_item=null}return t.prototype.mouseCapture=function(t){var e,i;return e=n(t.target),this.mustCaptureElement(e)?this.tree_widget.options.onIsMoveHandle&&!this.tree_widget.options.onIsMoveHandle(e)?null:(i=this.tree_widget._getNodeElement(e),i&&this.tree_widget.options.onCanMove&&(this.tree_widget.options.onCanMove(i.node)||(i=null)),this.current_item=i,null!==this.current_item):null},t.prototype.mouseStart=function(t){var e;return this.refresh(),e=n(t.target).offset(),this.drag_element=new o(this.current_item.node,t.page_x-e.left,t.page_y-e.top,this.tree_widget.element),this.is_dragging=!0,this.current_item.$element.addClass("jqtree-moving"),!0},t.prototype.mouseDrag=function(t){var e,i;return this.drag_element.move(t.page_x,t.page_y),e=this.findHoveredArea(t.page_x,t.page_y),i=this.canMoveToArea(e),i&&e?(e.node.isFolder()||this.stopOpenFolderTimer(),this.hovered_area!==e&&(this.hovered_area=e,this.mustOpenFolderTimer(e)?this.startOpenFolderTimer(e.node):this.stopOpenFolderTimer(),this.updateDropHint())):(this.removeHover(),this.removeDropHint(),this.stopOpenFolderTimer()),e||null!=this.tree_widget.options.onDragMove&&this.tree_widget.options.onDragMove(this.current_item.node,t.original_event),!0},t.prototype.mustCaptureElement=function(t){return!t.is("input,select")},t.prototype.canMoveToArea=function(t){var e;return!!t&&(!this.tree_widget.options.onCanMoveTo||(e=a.getName(t.position),this.tree_widget.options.onCanMoveTo(this.current_item.node,t.node,e)))},t.prototype.mouseStop=function(t){var e;return this.moveItem(t),this.clear(),this.removeHover(),this.removeDropHint(),this.removeHitAreas(),e=this.current_item,this.current_item&&(this.current_item.$element.removeClass("jqtree-moving"),this.current_item=null),this.is_dragging=!1,!this.hovered_area&&e&&null!=this.tree_widget.options.onDragStop&&this.tree_widget.options.onDragStop(e.node,t.original_event),!1},t.prototype.refresh=function(){if(this.removeHitAreas(),this.current_item&&(this.generateHitAreas(),this.current_item=this.tree_widget._getNodeElementForNode(this.current_item.node),this.is_dragging))return this.current_item.$element.addClass("jqtree-moving")},t.prototype.removeHitAreas=function(){return this.hit_areas=[]},t.prototype.clear=function(){return this.drag_element.remove(),this.drag_element=null},t.prototype.removeDropHint=function(){if(this.previous_ghost)return this.previous_ghost.remove()},t.prototype.removeHover=function(){return this.hovered_area=null},t.prototype.generateHitAreas=function(){var t;return t=new s(this.tree_widget.tree,this.current_item.node,this.getTreeDimensions().bottom),this.hit_areas=t.generate()},t.prototype.findHoveredArea=function(t,e){var i,n,r,o,s;if(n=this.getTreeDimensions(),t<n.left||e<n.top||t>n.right||e>n.bottom)return null;for(o=0,r=this.hit_areas.length;o<r;)if(s=o+r>>1,i=this.hit_areas[s],e<i.top)r=s;else{if(!(e>i.bottom))return i;o=s+1}return null},t.prototype.mustOpenFolderTimer=function(t){var e;return e=t.node,e.isFolder()&&!e.is_open&&t.position===a.INSIDE},t.prototype.updateDropHint=function(){var t;if(this.hovered_area)return this.removeDropHint(),t=this.tree_widget._getNodeElementForNode(this.hovered_area.node),this.previous_ghost=t.addDropHint(this.hovered_area.position)},t.prototype.startOpenFolderTimer=function(t){var e;return e=function(e){return function(){return e.tree_widget._openNode(t,e.tree_widget.options.slide,function(){return e.refresh(),e.updateDropHint()})}}(this),this.stopOpenFolderTimer(),this.open_folder_timer=setTimeout(e,this.tree_widget.options.openFolderDelay)},t.prototype.stopOpenFolderTimer=function(){if(this.open_folder_timer)return clearTimeout(this.open_folder_timer),this.open_folder_timer=null},t.prototype.moveItem=function(t){var e,i,n,r,o,s;if(this.hovered_area&&this.hovered_area.position!==a.NONE&&this.canMoveToArea(this.hovered_area)&&(n=this.current_item.node,s=this.hovered_area.node,r=this.hovered_area.position,o=n.parent,r===a.INSIDE&&(this.hovered_area.node.is_open=!0),e=function(t){return function(){return t.tree_widget.tree.moveNode(n,s,r),t.tree_widget.element.empty(),t.tree_widget._refreshElements()}}(this),i=this.tree_widget._triggerEvent("tree.move",{move_info:{moved_node:n,target_node:s,position:a.getName(r),previous_parent:o,do_move:e,original_event:t.original_event}}),!i.isDefaultPrevented()))return e()},t.prototype.getTreeDimensions=function(){var t;return t=this.tree_widget.element.offset(),{left:t.left,top:t.top,right:t.left+this.tree_widget.element.width(),bottom:t.top+this.tree_widget.element.height()+16}},t}(),c=function(){function t(t){this.tree=t}return t.prototype.iterate=function(){var t,e;return e=!0,(t=function(i){return function(r,o){var s,a,c,l,p,u,d,h;if(d=(r.is_open||!r.element)&&r.hasChildren(),r.element){if(s=n(r.element),!s.is(":visible"))return;e&&(i.handleFirstNode(r,s),e=!1),r.hasChildren()?r.is_open?i.handleOpenFolder(r,s)||(d=!1):i.handleClosedFolder(r,o,s):i.handleNode(r,o,s)}if(d){for(c=r.children.length,h=r.children,l=p=0,u=h.length;p<u;l=++p)a=h[l],l===c-1?t(r.children[l],null):t(r.children[l],r.children[l+1]);if(r.is_open)return i.handleAfterOpenFolder(r,o,s)}}}(this))(this.tree,null)},t.prototype.handleNode=function(t,e,i){},t.prototype.handleOpenFolder=function(t,e){},t.prototype.handleClosedFolder=function(t,e,i){},t.prototype.handleAfterOpenFolder=function(t,e,i){},t.prototype.handleFirstNode=function(t,e){},t}(),s=function(t){function e(t,i,n){e.__super__.constructor.call(this,t),this.current_node=i,this.tree_bottom=n}return p(e,t),e.prototype.generate=function(){return this.positions=[],this.last_top=0,this.iterate(),this.generateHitAreas(this.positions)},e.prototype.getTop=function(t){return t.offset().top},e.prototype.addPosition=function(t,e,i){var n;return n={top:i,node:t,position:e},this.positions.push(n),this.last_top=i},e.prototype.handleNode=function(t,e,i){var n;return n=this.getTop(i),t===this.current_node?this.addPosition(t,a.NONE,n):this.addPosition(t,a.INSIDE,n),e===this.current_node||t===this.current_node?this.addPosition(t,a.NONE,n):this.addPosition(t,a.AFTER,n)},e.prototype.handleOpenFolder=function(t,e){return t!==this.current_node&&(t.children[0]!==this.current_node&&this.addPosition(t,a.INSIDE,this.getTop(e)),!0)},e.prototype.handleClosedFolder=function(t,e,i){var n;return n=this.getTop(i),t===this.current_node?this.addPosition(t,a.NONE,n):(this.addPosition(t,a.INSIDE,n),e!==this.current_node?this.addPosition(t,a.AFTER,n):void 0)},e.prototype.handleFirstNode=function(t,e){if(t!==this.current_node)return this.addPosition(t,a.BEFORE,this.getTop(n(t.element)))},e.prototype.handleAfterOpenFolder=function(t,e,i){return t===this.current_node.node||e===this.current_node.node?this.addPosition(t,a.NONE,this.last_top):this.addPosition(t,a.AFTER,this.last_top)},e.prototype.generateHitAreas=function(t){var e,i,n,r,o,s;for(s=-1,e=[],i=[],n=0,r=t.length;n<r;n++)o=t[n],o.top!==s&&e.length&&(e.length&&this.generateHitAreasForGroup(i,e,s,o.top),s=o.top,e=[]),e.push(o);return this.generateHitAreasForGroup(i,e,s,this.tree_bottom),i},e.prototype.generateHitAreasForGroup=function(t,e,i,n){var r,o,s,a,c;for(c=Math.min(e.length,4),r=Math.round((n-i)/c),o=i,s=0;s<c;)a=e[s],t.push({top:o,bottom:o+r,node:a.node,position:a.position}),o+=r,s+=1;return null},e}(c),o=function(){function t(t,e,i,r){this.offset_x=e,this.offset_y=i,this.$element=n('<span class="jqtree-title jqtree-dragging">'+t.name+"</span>"),this.$element.css("position","absolute"),r.append(this.$element)}return t.prototype.move=function(t,e){return this.$element.offset({left:t-this.offset_x,top:e-this.offset_y})},t.prototype.remove=function(){return this.$element.remove()},t}(),t.exports={DragAndDropHandler:r,DragElement:o,HitAreasGenerator:s}},function(t,e){var i,n,r;i=jQuery,r={getName:function(t){return r.strings[t-1]},nameToIndex:function(t){var e,i,n;for(e=i=1,n=r.strings.length;1<=n?i<=n:i>=n;e=1<=n?++i:--i)if(r.strings[e-1]===t)return e;return 0}},r.BEFORE=1,r.AFTER=2,r.INSIDE=3,r.NONE=4,r.strings=["before","after","inside","none"],n=function(){function t(e,i,n){null==i&&(i=!1),null==n&&(n=t),this.name="",this.setData(e),this.children=[],this.parent=null,i&&(this.id_mapping={},this.tree=this,this.node_class=n)}return t.prototype.setData=function(t){var e,i,n;if(i=function(t){return function(e){if(null!==e)return t.name=e}}(this),"object"!=typeof t)i(t);else for(e in t)n=t[e],"label"===e?i(n):"children"!==e&&(this[e]=n);return null},t.prototype.initFromData=function(t){var e,i;return i=function(t){return function(i){if(t.setData(i),i.children)return e(i.children)}}(this),e=function(t){return function(e){var i,n,r,o;for(n=0,r=e.length;n<r;n++)i=e[n],o=new t.tree.node_class(""),o.initFromData(i),t.addChild(o);return null}}(this),i(t),null},t.prototype.loadFromData=function(t){var e,i,n,r;for(this.removeChildren(),e=0,i=t.length;e<i;e++)r=t[e],n=new this.tree.node_class(r),this.addChild(n),"object"==typeof r&&r.children&&n.loadFromData(r.children);return null},t.prototype.addChild=function(t){return this.children.push(t),t._setParent(this)},t.prototype.addChildAtPosition=function(t,e){return this.children.splice(e,0,t),t._setParent(this)},t.prototype._setParent=function(t){return this.parent=t,this.tree=t.tree,this.tree.addNodeToIndex(this)},t.prototype.removeChild=function(t){return t.removeChildren(),this._removeChild(t)},t.prototype._removeChild=function(t){return this.children.splice(this.getChildIndex(t),1),this.tree.removeNodeFromIndex(t)},t.prototype.getChildIndex=function(t){return i.inArray(t,this.children)},t.prototype.hasChildren=function(){return 0!==this.children.length},t.prototype.isFolder=function(){return this.hasChildren()||this.load_on_demand},t.prototype.iterate=function(t){var e;return e=function(i,n){var r,o,s,a,c;if(i.children){for(a=i.children,o=0,s=a.length;o<s;o++)r=a[o],c=t(r,n),c&&r.hasChildren()&&e(r,n+1);return null}},e(this,0),null},t.prototype.moveNode=function(t,e,i){if(!t.isParentOf(e))return t.parent._removeChild(t),i===r.AFTER?e.parent.addChildAtPosition(t,e.parent.getChildIndex(e)+1):i===r.BEFORE?e.parent.addChildAtPosition(t,e.parent.getChildIndex(e)):i===r.INSIDE?e.addChildAtPosition(t,0):void 0},t.prototype.getData=function(t){var e;return null==t&&(t=!1),(e=function(t){var i,n,r,o,s,a,c;for(i=[],n=0,o=t.length;n<o;n++){s=t[n],a={};for(r in s)c=s[r],"parent"!==r&&"children"!==r&&"element"!==r&&"tree"!==r&&Object.prototype.hasOwnProperty.call(s,r)&&(a[r]=c);s.hasChildren()&&(a.children=e(s.children)),i.push(a)}return i})(t?[this]:this.children)},t.prototype.getNodeByName=function(t){var e;return e=null,this.iterate(function(i){return i.name!==t||(e=i,!1)}),e},t.prototype.addAfter=function(t){var e,i;return this.parent?(i=new this.tree.node_class(t),e=this.parent.getChildIndex(this),this.parent.addChildAtPosition(i,e+1),"object"==typeof t&&t.children&&t.children.length&&i.loadFromData(t.children),i):null},t.prototype.addBefore=function(t){var e,i;return this.parent?(i=new this.tree.node_class(t),e=this.parent.getChildIndex(this),this.parent.addChildAtPosition(i,e),"object"==typeof t&&t.children&&t.children.length&&i.loadFromData(t.children),i):null},t.prototype.addParent=function(t){var e,i,n,r,o,s;if(this.parent){for(r=new this.tree.node_class(t),r._setParent(this.tree),o=this.parent,s=o.children,i=0,n=s.length;i<n;i++)e=s[i],r.addChild(e);return o.children=[],o.addChild(r),r}return null},t.prototype.remove=function(){if(this.parent)return this.parent.removeChild(this),this.parent=null},t.prototype.append=function(t){var e;return e=new this.tree.node_class(t),this.addChild(e),"object"==typeof t&&t.children&&t.children.length&&e.loadFromData(t.children),e},t.prototype.prepend=function(t){var e;return e=new this.tree.node_class(t),this.addChildAtPosition(e,0),"object"==typeof t&&t.children&&t.children.length&&e.loadFromData(t.children),e},t.prototype.isParentOf=function(t){var e;for(e=t.parent;e;){if(e===this)return!0;e=e.parent}return!1},t.prototype.getLevel=function(){var t,e;for(t=0,e=this;e.parent;)t+=1,e=e.parent;return t},t.prototype.getNodeById=function(t){return this.id_mapping[t]},t.prototype.addNodeToIndex=function(t){if(null!=t.id)return this.id_mapping[t.id]=t},t.prototype.removeNodeFromIndex=function(t){if(null!=t.id)return delete this.id_mapping[t.id]},t.prototype.removeChildren=function(){return this.iterate(function(t){return function(e){return t.tree.removeNodeFromIndex(e),!0}}(this)),this.children=[]},t.prototype.getPreviousSibling=function(){var t;return this.parent?(t=this.parent.getChildIndex(this)-1,t>=0?this.parent.children[t]:null):null},t.prototype.getNextSibling=function(){var t;return this.parent?(t=this.parent.getChildIndex(this)+1,t<this.parent.children.length?this.parent.children[t]:null):null},t.prototype.getNodesByProperty=function(t,e){return this.filter(function(i){return i[t]===e})},t.prototype.filter=function(t){var e;return e=[],this.iterate(function(i){return t(i)&&e.push(i),!0}),e},t.prototype.getNextNode=function(t){var e;return null==t&&(t=!0),t&&this.hasChildren()&&this.is_open?this.children[0]:this.parent?(e=this.getNextSibling(),e?e:this.parent.getNextNode(!1)):null},t.prototype.getPreviousNode=function(){var t;return this.parent?(t=this.getPreviousSibling(),t?t.hasChildren()&&t.is_open?t.getLastChild():t:this.getParent()):null},t.prototype.getParent=function(){return this.parent&&this.parent.parent?this.parent:null},t.prototype.getLastChild=function(){var t;return this.hasChildren()?(t=this.children[this.children.length-1],t.hasChildren()&&t.is_open?t.getLastChild():t):null},t}(),t.exports={Node:n,Position:r}},function(t,e,i){var n,r,o,s,a,c;a=i(1803),o=a.NodeElement,c=i(1804),s=c.html_escape,n=jQuery,r=function(){function t(t){this.tree_widget=t,this.opened_icon_element=this.createButtonElement(t.options.openedIcon),this.closed_icon_element=this.createButtonElement(t.options.closedIcon)}return t.prototype.render=function(t){return t&&t.parent?this.renderFromNode(t):this.renderFromRoot()},t.prototype.renderFromRoot=function(){var t;return t=this.tree_widget.element,t.empty(),this.createDomElements(t[0],this.tree_widget.tree.children,!0,!0,1)},t.prototype.renderFromNode=function(t){var e,i;if(e=n(t.element),i=this.createLi(t,t.getLevel()),this.attachNodeData(t,i),e.after(i),e.remove(),t.children)return this.createDomElements(i,t.children,!1,!1,t.getLevel()+1)},t.prototype.createDomElements=function(t,e,i,n,r){var o,s,a,c,l;for(l=this.createUl(i),t.appendChild(l),s=0,a=e.length;s<a;s++)o=e[s],c=this.createLi(o,r),l.appendChild(c),this.attachNodeData(o,c),o.hasChildren()&&this.createDomElements(c,o.children,!1,o.is_open,r+1);return null},t.prototype.attachNodeData=function(t,e){return t.element=e,n(e).data("node",t)},t.prototype.createUl=function(t){var e,i,n;return t?(e="jqtree-tree",i="tree",this.tree_widget.options.rtl&&(e+=" jqtree-rtl")):(e="",i="group"),n=document.createElement("ul"),n.className="jqtree_common "+e,n.setAttribute("role",i),n},t.prototype.createLi=function(t,e){var i,r;return i=this.tree_widget.select_node_handler&&this.tree_widget.select_node_handler.isNodeSelected(t),r=t.isFolder()?this.createFolderLi(t,e,i):this.createNodeLi(t,e,i),this.tree_widget.options.onCreateLi&&this.tree_widget.options.onCreateLi(t,n(r)),r},t.prototype.createFolderLi=function(t,e,i){var n,r,o,s,a,c,l;return n=this.getButtonClasses(t),s=this.getFolderClasses(t,i),a=t.is_open?this.opened_icon_element:this.closed_icon_element,l=document.createElement("li"),l.className="jqtree_common "+s,l.setAttribute("role","presentation"),o=document.createElement("div"),o.className="jqtree-element jqtree_common",o.setAttribute("role","presentation"),l.appendChild(o),r=document.createElement("a"),r.className=n,r.appendChild(a.cloneNode(!1)),r.setAttribute("role","presentation"),r.setAttribute("aria-hidden","true"),this.tree_widget.options.buttonLeft&&o.appendChild(r),o.appendChild(this.createTitleSpan(t.name,e,i,t.is_open,c=!0)),this.tree_widget.options.buttonLeft||o.appendChild(r),l},t.prototype.createNodeLi=function(t,e,i){var n,r,o,s,a;return a=["jqtree_common"],i&&a.push("jqtree-selected"),n=a.join(" "),s=document.createElement("li"),s.className=n,s.setAttribute("role","presentation"),r=document.createElement("div"),r.className="jqtree-element jqtree_common",r.setAttribute("role","presentation"),s.appendChild(r),r.appendChild(this.createTitleSpan(t.name,e,i,t.is_open,o=!1)),s},t.prototype.createTitleSpan=function(t,e,i,n,r){var o,s;return s=document.createElement("span"),o="jqtree-title jqtree_common",r&&(o+=" jqtree-title-folder"),s.className=o,s.setAttribute("role","treeitem"),s.setAttribute("aria-level",e),s.setAttribute("aria-selected",c.getBoolString(i)),s.setAttribute("aria-expanded",c.getBoolString(n)),i&&s.setAttribute("tabindex",0),s.innerHTML=this.escapeIfNecessary(t),s},t.prototype.getButtonClasses=function(t){var e;return e=["jqtree-toggler","jqtree_common"],t.is_open||e.push("jqtree-closed"),this.tree_widget.options.buttonLeft?e.push("jqtree-toggler-left"):e.push("jqtree-toggler-right"),e.join(" ")},t.prototype.getFolderClasses=function(t,e){var i;return i=["jqtree-folder"],t.is_open||i.push("jqtree-closed"),e&&i.push("jqtree-selected"),t.is_loading&&i.push("jqtree-loading"),i.join(" ")},t.prototype.escapeIfNecessary=function(t){return this.tree_widget.options.autoEscape?s(t):t},t.prototype.createButtonElement=function(t){var e;return"string"==typeof t?(e=document.createElement("div"),e.innerHTML=t,document.createTextNode(e.innerHTML)):n(t)[0]},t}(),t.exports=r},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;l=i(1801),c=l.Position,n=jQuery,a=function(){function t(t,e){this.init(t,e)}return t.prototype.init=function(t,e){return this.node=t,this.tree_widget=e,t.element||(t.element=this.tree_widget.element),this.$element=n(t.element)},t.prototype.getUl=function(){return this.$element.children("ul:first")},t.prototype.getSpan=function(){return this.$element.children(".jqtree-element").find("span.jqtree-title")},t.prototype.getLi=function(){return this.$element},t.prototype.addDropHint=function(t){return t===c.INSIDE?new r(this.$element):new s(this.node,this.$element,t)},t.prototype.select=function(){var t,e;return t=this.getLi(),t.addClass("jqtree-selected"),t.attr("aria-selected","true"),e=this.getSpan(),e.attr("tabindex",0)},t.prototype.deselect=function(){var t,e;return t=this.getLi(),t.removeClass("jqtree-selected"),t.attr("aria-selected","false"),e=this.getSpan(),e.attr("tabindex",-1)},t}(),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.open=function(t,e){var i,n;if(null==e&&(e=!0),!this.node.is_open)return this.node.is_open=!0,i=this.getButton(),i.removeClass("jqtree-closed"),i.html(""),i.append(this.tree_widget.renderer.opened_icon_element.cloneNode(!1)),n=function(e){return function(){var i,n;return i=e.getLi(),i.removeClass("jqtree-closed"),n=e.getSpan(),n.attr("aria-expanded","true"),t&&t(),e.tree_widget._triggerEvent("tree.open",{node:e.node})}}(this),e?this.getUl().slideDown("fast",n):(this.getUl().show(),n())},e.prototype.close=function(t){var e,i;if(null==t&&(t=!0),this.node.is_open)return this.node.is_open=!1,e=this.getButton(),e.addClass("jqtree-closed"),e.html(""),e.append(this.tree_widget.renderer.closed_icon_element.cloneNode(!1)),i=function(t){return function(){var e,i;return e=t.getLi(),e.addClass("jqtree-closed"),i=t.getSpan(),i.attr("aria-expanded","false"),t.tree_widget._triggerEvent("tree.close",{node:t.node})}}(this),t?this.getUl().slideUp("fast",i):(this.getUl().hide(),i())},e.prototype.getButton=function(){return this.$element.children(".jqtree-element").find("a.jqtree-toggler")},e.prototype.addDropHint=function(t){return this.node.is_open||t!==c.INSIDE?new s(this.node,this.$element,t):new r(this.$element)},e}(a),r=function(){function t(t){var e,i;e=t.children(".jqtree-element"),i=t.width()-4,this.$hint=n('<span class="jqtree-border"></span>'),e.append(this.$hint),this.$hint.css({width:i,height:e.outerHeight()-4})}return t.prototype.remove=function(){return this.$hint.remove()},t}(),s=function(){function t(t,e,i){this.$element=e,this.node=t,this.$ghost=n('<li class="jqtree_common jqtree-ghost"><span class="jqtree_common jqtree-circle"></span><span class="jqtree_common jqtree-line"></span></li>'),i===c.AFTER?this.moveAfter():i===c.BEFORE?this.moveBefore():i===c.INSIDE&&(t.isFolder()&&t.is_open?this.moveInsideOpenFolder():this.moveInside())}return t.prototype.remove=function(){return this.$ghost.remove()},t.prototype.moveAfter=function(){return this.$element.after(this.$ghost)},t.prototype.moveBefore=function(){return this.$element.before(this.$ghost)},t.prototype.moveInsideOpenFolder=function(){return n(this.node.children[0].element).before(this.$ghost)},t.prototype.moveInside=function(){return this.$element.after(this.$ghost),this.$ghost.addClass("jqtree-inside")},t}(),t.exports={BorderDropHint:r,FolderElement:o,GhostDropHint:s,NodeElement:a}},function(t,e){var i,n,r,o,s;i=function(t,e){var i,n,r,o;for(i=n=0,r=t.length;n<r;i=++n)if(o=t[i],o===e)return i;return-1},o=function(t,e){return t.indexOf?t.indexOf(e):i(t,e)},s=function(t){return"number"==typeof t&&t%1===0},r=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},n=function(t){return t?"true":"false"},t.exports={_indexOf:i,getBoolString:n,html_escape:r,indexOf:o,isInt:s}},function(t,e){var i,n,r=function(t,e){return function(){return t.apply(e,arguments)}};i=jQuery,n=function(){function t(t){this.selectNode=r(this.selectNode,this),this.tree_widget=t,t.options.keyboardSupport&&i(document).bind("keydown.jqtree",i.proxy(this.handleKeyDown,this))}var e,n,o,s;return n=37,s=38,o=39,e=40,t.prototype.deinit=function(){return i(document).unbind("keydown.jqtree")},t.prototype.moveDown=function(){var t;return t=this.tree_widget.getSelectedNode(),!!t&&this.selectNode(t.getNextNode())},t.prototype.moveUp=function(){var t;return t=this.tree_widget.getSelectedNode(),!!t&&this.selectNode(t.getPreviousNode())},t.prototype.moveRight=function(){var t;return t=this.tree_widget.getSelectedNode(),!t||(!t.isFolder()||(t.is_open?this.selectNode(t.getNextNode()):(this.tree_widget.openNode(t),!1)))},t.prototype.moveLeft=function(){var t;return t=this.tree_widget.getSelectedNode(),!t||(t.isFolder()&&t.is_open?(this.tree_widget.closeNode(t),!1):this.selectNode(t.getParent()))},t.prototype.handleKeyDown=function(t){var r;if(!this.tree_widget.options.keyboardSupport)return!0;if(i(document.activeElement).is("textarea,input,select"))return!0;if(!this.tree_widget.getSelectedNode())return!0;switch(r=t.which){case e:return this.moveDown();case s:return this.moveUp();case o:return this.moveRight();case n:return this.moveLeft()}return!0},t.prototype.selectNode=function(t){return!t||(this.tree_widget.selectNode(t),this.tree_widget.scroll_handler&&!this.tree_widget.scroll_handler.isScrolledIntoView(i(t.element).find(".jqtree-element"))&&this.tree_widget.scrollToNode(t),!1)},t}(),t.exports=n},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=i(1807),n=jQuery,r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.is_mouse_handled=!1,e.prototype._init=function(){return this.$el.bind("mousedown.mousewidget",n.proxy(this._mouseDown,this)),this.$el.bind("touchstart.mousewidget",n.proxy(this._touchStart,this)),this.is_mouse_started=!1,this.mouse_delay=0,this._mouse_delay_timer=null,this._is_mouse_delay_met=!0,this.mouse_down_info=null},e.prototype._deinit=function(){var t;return this.$el.unbind("mousedown.mousewidget"),this.$el.unbind("touchstart.mousewidget"),t=n(document),t.unbind("mousemove.mousewidget"),t.unbind("mouseup.mousewidget")},e.prototype._mouseDown=function(t){var e;if(1===t.which)return e=this._handleMouseDown(t,this._getPositionInfo(t)),e&&t.preventDefault(),e},e.prototype._handleMouseDown=function(t,i){if(!e.is_mouse_handled&&(this.is_mouse_started&&this._handleMouseUp(i),this.mouse_down_info=i,this._mouseCapture(i)))return this._handleStartMouse(),this.is_mouse_handled=!0,!0},e.prototype._handleStartMouse=function(){var t;if(t=n(document),t.bind("mousemove.mousewidget",n.proxy(this._mouseMove,this)),t.bind("touchmove.mousewidget",n.proxy(this._touchMove,this)),t.bind("mouseup.mousewidget",n.proxy(this._mouseUp,this)),t.bind("touchend.mousewidget",n.proxy(this._touchEnd,this)),this.mouse_delay)return this._startMouseDelayTimer()},e.prototype._startMouseDelayTimer=function(){return this._mouse_delay_timer&&clearTimeout(this._mouse_delay_timer),this._mouse_delay_timer=setTimeout(function(t){return function(){return t._is_mouse_delay_met=!0}}(this),this.mouse_delay),this._is_mouse_delay_met=!1},e.prototype._mouseMove=function(t){return this._handleMouseMove(t,this._getPositionInfo(t))},e.prototype._handleMouseMove=function(t,e){return this.is_mouse_started?(this._mouseDrag(e),t.preventDefault()):!(!this.mouse_delay||this._is_mouse_delay_met)||(this.is_mouse_started=this._mouseStart(this.mouse_down_info)!==!1,this.is_mouse_started?this._mouseDrag(e):this._handleMouseUp(e),!this.is_mouse_started)},e.prototype._getPositionInfo=function(t){return{page_x:t.pageX,page_y:t.pageY,target:t.target,original_event:t}},e.prototype._mouseUp=function(t){return this._handleMouseUp(this._getPositionInfo(t))},e.prototype._handleMouseUp=function(t){var e;e=n(document),e.unbind("mousemove.mousewidget"),e.unbind("touchmove.mousewidget"),e.unbind("mouseup.mousewidget"),e.unbind("touchend.mousewidget"),this.is_mouse_started&&(this.is_mouse_started=!1,this._mouseStop(t))},e.prototype._mouseCapture=function(t){return!0},e.prototype._mouseStart=function(t){return null},e.prototype._mouseDrag=function(t){return null},e.prototype._mouseStop=function(t){return null},e.prototype.setMouseDelay=function(t){return this.mouse_delay=t},e.prototype._touchStart=function(t){var e;if(!(t.originalEvent.touches.length>1))return e=t.originalEvent.changedTouches[0],this._handleMouseDown(t,this._getPositionInfo(e))},e.prototype._touchMove=function(t){var e;if(!(t.originalEvent.touches.length>1))return e=t.originalEvent.changedTouches[0],this._handleMouseMove(t,this._getPositionInfo(e))},e.prototype._touchEnd=function(t){var e;if(!(t.originalEvent.touches.length>1))return e=t.originalEvent.changedTouches[0],this._handleMouseUp(this._getPositionInfo(e))},e}(o),t.exports=r},function(t,e){var i,n,r=[].slice;i=jQuery,n=function(){function t(t,e){this.$el=i(t),this.options=i.extend({},this.defaults,e)}return t.prototype.defaults={},t.prototype.destroy=function(){return this._deinit()},t.prototype._init=function(){return null},t.prototype._deinit=function(){return null},t.register=function(e,n){var o,s,a,c,l;return c=function(){return"simple_widget_"+n},l=function(e,n){var r;return r=i.data(e,n),r&&r instanceof t?r:null},s=function(t,n){var r,o,s,a,p,u;for(r=c(),a=0,p=t.length;a<p;a++)o=t[a],s=l(o,r),s||(u=new e(o,n),i.data(o,r)||i.data(o,r,u),u._init());return t},a=function(t){var e,n,r,o,s,a;for(e=c(),s=[],r=0,o=t.length;r<o;r++)n=t[r],a=l(n,e),a&&a.destroy(),s.push(i.removeData(n,e));return s},o=function(e,n,r){var o,s,a,l,p,u;for(l=null,s=0,a=e.length;s<a;s++)o=e[s],p=i.data(o,c()),p&&p instanceof t&&(u=p[n],u&&"function"==typeof u&&(l=u.apply(p,r)));return l},i.fn[n]=function(){var t,i,n,c,l;return n=arguments[0],i=2<=arguments.length?r.call(arguments,1):[],t=this,void 0===n||"object"==typeof n?(l=n,s(t,l)):"string"==typeof n&&"_"!==n[0]?(c=n,"destroy"===c?a(t):"get_widget_class"===c?e:o(t,c,i)):void 0}},t}(),t.exports=n},function(t,e,i){var n,r,o,s,a;a=i(1804),o=a.indexOf,s=a.isInt,n=jQuery,r=function(){function t(t){this.tree_widget=t}return t.prototype.saveState=function(){var t;return t=JSON.stringify(this.getState()),this.tree_widget.options.onSetStateFromStorage?this.tree_widget.options.onSetStateFromStorage(t):this.supportsLocalStorage()?localStorage.setItem(this.getCookieName(),t):n.cookie?(n.cookie.raw=!0,n.cookie(this.getCookieName(),t,{path:"/"})):void 0},t.prototype.getStateFromStorage=function(){var t;return t=this._loadFromStorage(),t?this._parseState(t):null},t.prototype._parseState=function(t){var e;return e=n.parseJSON(t),e&&e.selected_node&&s(e.selected_node)&&(e.selected_node=[e.selected_node]),e},t.prototype._loadFromStorage=function(){return this.tree_widget.options.onGetStateFromStorage?this.tree_widget.options.onGetStateFromStorage():this.supportsLocalStorage()?localStorage.getItem(this.getCookieName()):n.cookie?(n.cookie.raw=!0,
n.cookie(this.getCookieName())):null},t.prototype.getState=function(){var t,e;return t=function(t){return function(){var e;return e=[],t.tree_widget.tree.iterate(function(t){return t.is_open&&t.id&&t.hasChildren()&&e.push(t.id),!0}),e}}(this),e=function(t){return function(){var e;return function(){var t,i,n,r;for(n=this.tree_widget.getSelectedNodes(),r=[],t=0,i=n.length;t<i;t++)e=n[t],r.push(e.id);return r}.call(t)}}(this),{open_nodes:t(),selected_node:e()}},t.prototype.setInitialState=function(t){var e;return!!t&&(e=this._openInitialNodes(t.open_nodes),this._selectInitialNodes(t.selected_node),e)},t.prototype._openInitialNodes=function(t){var e,i,n,r,o;for(n=!1,e=0,i=t.length;e<i;e++)o=t[e],r=this.tree_widget.getNodeById(o),r&&(r.load_on_demand?n=!0:r.is_open=!0);return n},t.prototype._selectInitialNodes=function(t){var e,i,n,r,o;for(o=0,e=0,i=t.length;e<i;e++)r=t[e],n=this.tree_widget.getNodeById(r),n&&(o+=1,this.tree_widget.select_node_handler.addToSelection(n));return 0!==o},t.prototype.setInitialStateOnDemand=function(t,e){return t?this._setInitialStateOnDemand(t.open_nodes,t.selected_node,e):e()},t.prototype._setInitialStateOnDemand=function(t,e,i){var n,r,o;return r=0,o=function(o){return function(){var s,a,c,l,p;for(c=[],s=0,a=t.length;s<a;s++)p=t[s],l=o.tree_widget.getNodeById(p),l?l.is_loading||(l.load_on_demand?n(l):o.tree_widget._openNode(l,!1)):c.push(p);if(t=c,o._selectInitialNodes(e)&&o.tree_widget._refreshElements(),0===r)return i()}}(this),n=function(t){return function(e){return r+=1,t.tree_widget._openNode(e,!1,function(){return r-=1,o()})}}(this),o()},t.prototype.getCookieName=function(){return"string"==typeof this.tree_widget.options.saveState?this.tree_widget.options.saveState:"tree"},t.prototype.supportsLocalStorage=function(){var t;return t=function(){var t,e,i;if("undefined"==typeof localStorage||null===localStorage)return!1;try{i="_storage_test",sessionStorage.setItem(i,!0),sessionStorage.removeItem(i)}catch(e){return t=e,!1}return!0},null==this._supportsLocalStorage&&(this._supportsLocalStorage=t()),this._supportsLocalStorage},t.prototype.getNodeIdToBeSelected=function(){var t;return t=this.getStateFromStorage(),t&&t.selected_node?t.selected_node[0]:null},t}(),t.exports=r},function(t,e){var i,n;i=jQuery,n=function(){function t(t){this.tree_widget=t,this.previous_top=-1,this.is_initialized=!1,this._initScrollParent()}return t.prototype._initScrollParent=function(){var t,e,n;return e=function(t){return function(){var e,n,r,o,s,a;if(e=["overflow","overflow-y"],(r=function(t){var n,r,o,s;for(r=0,o=e.length;r<o;r++)if(n=e[r],"auto"===(s=i.css(t,n))||"scroll"===s)return!0;return!1})(t.tree_widget.$el[0]))return t.tree_widget.$el;for(a=t.tree_widget.$el.parents(),o=0,s=a.length;o<s;o++)if(n=a[o],r(n))return i(n);return null}}(this),n=function(t){return function(){return t.scroll_parent_top=0,t.$scroll_parent=null}}(this),"fixed"===this.tree_widget.$el.css("position")&&n(),t=e(),t&&t.length&&"HTML"!==t[0].tagName?(this.$scroll_parent=t,this.scroll_parent_top=this.$scroll_parent.offset().top):n(),this.is_initialized=!0},t.prototype._ensureInit=function(){if(!this.is_initialized)return this._initScrollParent()},t.prototype.checkScrolling=function(){var t;if(this._ensureInit(),t=this.tree_widget.dnd_handler.hovered_area,t&&t.top!==this.previous_top)return this.previous_top=t.top,this.$scroll_parent?this._handleScrollingWithScrollParent(t):this._handleScrollingWithDocument(t)},t.prototype._handleScrollingWithScrollParent=function(t){var e;return e=this.scroll_parent_top+this.$scroll_parent[0].offsetHeight-t.bottom,e<20?(this.$scroll_parent[0].scrollTop+=20,this.tree_widget.refreshHitAreas(),this.previous_top=-1):t.top-this.scroll_parent_top<20?(this.$scroll_parent[0].scrollTop-=20,this.tree_widget.refreshHitAreas(),this.previous_top=-1):void 0},t.prototype._handleScrollingWithDocument=function(t){var e;return e=t.top-i(document).scrollTop(),e<20?i(document).scrollTop(i(document).scrollTop()-20):i(window).height()-(t.bottom-i(document).scrollTop())<20?i(document).scrollTop(i(document).scrollTop()+20):void 0},t.prototype.scrollTo=function(t){var e;return this._ensureInit(),this.$scroll_parent?this.$scroll_parent[0].scrollTop=t:(e=this.tree_widget.$el.offset().top,i(document).scrollTop(t+e))},t.prototype.isScrolledIntoView=function(t){var e,n,r,o,s;return this._ensureInit(),e=i(t),this.$scroll_parent?(s=0,o=this.$scroll_parent.height(),r=e.offset().top-this.scroll_parent_top,n=r+e.height()):(s=i(window).scrollTop(),o=s+i(window).height(),r=e.offset().top,n=r+e.height()),n<=o&&r>=s},t}(),t.exports=n},function(t,e){var i,n;i=jQuery,n=function(){function t(t){this.tree_widget=t,this.clear()}return t.prototype.getSelectedNode=function(){var t;return t=this.getSelectedNodes(),!!t.length&&t[0]},t.prototype.getSelectedNodes=function(){var t,e,i;if(this.selected_single_node)return[this.selected_single_node];i=[];for(t in this.selected_nodes)e=this.tree_widget.getNodeById(t),e&&i.push(e);return i},t.prototype.getSelectedNodesUnder=function(t){var e,i,n;if(this.selected_single_node)return t.isParentOf(this.selected_single_node)?[this.selected_single_node]:[];n=[];for(e in this.selected_nodes)i=this.tree_widget.getNodeById(e),i&&t.isParentOf(i)&&n.push(i);return n},t.prototype.isNodeSelected=function(t){return t.id?this.selected_nodes[t.id]:!!this.selected_single_node&&this.selected_single_node.element===t.element},t.prototype.clear=function(){return this.selected_nodes={},this.selected_single_node=null},t.prototype.removeFromSelection=function(t,e){if(null==e&&(e=!1),t.id){if(delete this.selected_nodes[t.id],e)return t.iterate(function(e){return function(i){return delete e.selected_nodes[t.id],!0}}(this))}else if(this.selected_single_node&&t.element===this.selected_single_node.element)return this.selected_single_node=null},t.prototype.addToSelection=function(t){return t.id?this.selected_nodes[t.id]=!0:this.selected_single_node=t},t}(),t.exports=n},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;n=i(1812),s=i(788),r=i(688),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="StepModalView",e.prototype.className="step-modal-view modal-dialog flex-vert",e.prototype.events={"click .prev-handler":"goPrev"},e.prototype.initialize=function(t){return this.contentList=[],this.modal=new r({cursor:0}),this.$el.addClass("step-modal-view"),this.listenTo(this.modal,"change",this.renderBasic),this.assembleContent(),this.renderBasic()},e.prototype.renderBasic=function(){var t,e,i,r;return e=this.modal.get("cursor"),i=this.contentList[e],r=i.title,t=i.body,this.$el.html(n({title:r,body:t,isFirst:0===e})),this.componentUpdated(e)},e.prototype.goNext=function(){return this.setCursor(this.modal.get("cursor")+1)},e.prototype.goPrev=function(){return this.setCursor(this.modal.get("cursor")-1)},e.prototype["goto"]=function(t){return this.setCursor(t)},e.prototype.setCursor=function(t){return this.modal.set("cursor",t)},e.prototype.assembleContent=function(){},e.prototype.componentUpdated=function(){},e}(s)},function(t,e){t.exports=function(t){var e='<header class="modal-header flex-static"> <a class="prev-handler icon icon-chevron-left ';return t.isFirst&&(e+="hide"),e+='"></a> <h4 class="modal-title">'+t.title+'</h4> <a class="modal-close icon icon-remove" data-dismiss="modal"></a></header><div class="modal-body flex-fill"> '+t.body+"</div>"}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="<span class='icon icon-menu'></span><span class=\"name\">"+e(t.name)+"</span>";return t.hasChild&&(i+=" <span class='icon icon-chevron-right'></span>"),i}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="team-list-wrapper"> <div class="team-list"> <ul class="jqtree-tree"> <!-- 仿照 jqtree dom 结构 --> ',n=t.teams;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li class="team-item ',r.children&&r.children.length&&(i+="has-child"),i+='"> <div class="jqtree-element"> <div class="jqtree-title flex-horiz flex-vcenter"> <span class="icon icon-menu"></span> <span class="name">'+e(r.name)+"</span> ",r.children&&r.children.length&&(i+=' <span class="icon icon-chevron-right"></span> '),i+=" </div> </div> </li> ";return i+=" </ul> </div></div>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m=function(t,e){function i(){this.constructor=t}for(var n in e)f.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},f={}.hasOwnProperty;h=i(358),n=i(357),u=i(788),l=i(684),d=i(786),p=i(1330),o=i(1816),a=i(1829),r=i(1831),s=i(1833),t.exports=c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.viewName="OrganizationSettingsView",e.prototype.className="organization-settings-view",e.prototype.initialize=function(t){var e;return e=this.requestSubView(d),this.options=h.assign(t,{onClose:e.close.bind(e)}),this.render(this.options,e),this.listen(this.options)},e.prototype.listen=function(t){return this.listenTo(t.organizationModel,"change:_roleId remove destroy",function(){return this.remove()})},e.prototype.render=function(t,e){var i;return i={title:tb_i18n.get("organization.settings"),list:[{text:tb_i18n.get("organization.settings.tab.infomation"),icon:"icon-building",view:function(e){return function(){return e.requestSubView(o,t).$el}}(this)},{text:tb_i18n.get("organization.settings.tab.pay"),icon:"icon-normal",view:function(e){return function(){return e.requestSubView(a,t).$el}}(this)},{text:tb_i18n.get("organization.settings.tab.consultant"),icon:"icon-human",view:function(e){return function(){return e.requestSubView(r,t).$el}}(this)},{text:tb_i18n.get("organization.settings.tab.other"),icon:"icon-more",view:function(e){return function(){return e.requestSubView(s,t).$el}}(this)}]},e.open(p,i)},e}(u)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h=function(t,e){function i(){this.constructor=t}for(var n in e)m.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},m={}.hasOwnProperty;d=i(358),n=i(357),u=i(788),o=i(401),p=i(1336),r=i(1333),s=i(1817),a=i(1821),c=i(1828),t.exports=l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.viewName="OrgSettingsInfoView",e.prototype.className="org-settings-info-view",e.prototype.initialize=function(t){var e;return this.organizationModel=t.organizationModel,this.changes={},e=this.getForm(),this.render(e,t),this.listen(e,t)},e.prototype.listen=function(t,e){return t.on("submit",d.partial(this.onSubmit,t).bind(this)),t.on("change",d.debounce(this.onChange.bind(this,t),100))},e.prototype.hasPermission=function(){return this.organizationModel.hasPermission("put.info")},e.prototype.onSubmit=function(t,e){var i,n;if(e.preventDefault(),this.hasPermission()&&!d.isEmpty(this.changes))return n=Promise.resolve(),i=d.pick(this.changes,"name","description","isPublic"),d.isEmpty(i)||(n=n.then(function(t){return function(){return new Promise(function(e,n){return t.organizationModel.save(null,{attrs:i,success:function(i){return t.$el?e(i):n()},error:n})})}}(this))),n.then(function(t){return t?Promise.resolve():Promise.reject()}).then(function(t){return function(){return t.changes={},t.disableSubmitButton(!0),o.success(tb_i18n.get("organization.settings.save.success"))}}(this))["catch"](function(t){if(t)return console.error(t),o.error(t)})},e.prototype.onChange=function(t){var e,i,n;if(this.hasPermission())return n=t.data,e=t.validate(),d.isEmpty(e)?(this.changes={},i=t.getValue(),i.name!==this.organizationModel.get("name")&&(this.changes.name=i.name),i.description!==this.organizationModel.get("description")&&(this.changes.description=i.description),i.isPublic!==this.organizationModel.get("isPublic")&&(this.changes.isPublic=i.isPublic),this.disableSubmitButton(d.isEmpty(this.changes))):(e.name&&t.fields.name.$el.addClass("is-error"),void this.disableSubmitButton(!0))},e.prototype.getForm=function(){var t,e,i;return i={name:{type:"Text",title:tb_i18n.get("organization.name"),editorAttrs:{maxlength:30,minlength:1,autofocus:!0},validators:["required"]},description:{type:"TextArea",title:tb_i18n.get("organization.desc"),editorAttrs:{rows:2,placeholder:this.hasPermission()?tb_i18n.get("organization.settings.desc.placeholder"):""}},isPublic:{type:r,title:tb_i18n.get("organization.setting.permission"),options:d.compact([{val:!0,label:tb_i18n.get("organization.setting.public")},{val:!1,label:tb_i18n.get("organization.setting.private")}])}},this.hasPermission()||(i=d.mapObject(i,function(t){return t.editorAttrs=d.assign({},t.editorAttrs,{disabled:!0}),t})),e={name:this.organizationModel.get("name"),description:this.organizationModel.get("description"),isPublic:this.organizationModel.get("isPublic")},n.Form.editors.Text.prototype.events.keydown="determineChange",n.Form.validators.errMessages.required="",new(t=n.Form.extend({template:function(t){return function(){return c(t)}}(this),schema:i,data:e}))},e.prototype.disableSubmitButton=function(t){var e;if(this.$el)return e=this.$("input.submit"),e.attr("disabled",t)},e.prototype.renderNoPermissionSection=function(){if(!this.hasPermission())return this.$(".no-permission-section").html(p)},e.prototype.renderAvatarSection=function(t){return this.$(".avatar-section").html(this.requestSubView(s,t).$el)},e.prototype.renderBelongingSection=function(t){return this.$(".belonging-section").html(this.requestSubView(a,t).$el)},e.prototype.render=function(t,e){return t.render(),this.$el.html(t.el),this.renderNoPermissionSection(),this.renderAvatarSection(e),this.renderBelongingSection(e),this.disableSubmitButton(!0)},e}(u)},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;c=i(788),r=i(401),a=i(925),l=i(786),s=i(1818),n=i(1820),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="OrgAvatarView",e.prototype.className="org-avatar-view",e.prototype.events={"click .avatar-upload-button":"onCropAvatar"},e.prototype.initialize=function(t){return this.organizationModel=t.organizationModel,this.uploader=null,this.$cropAvatarInput=null,this.initUploader(t.organizationModel),this.render(),this.listen()},e.prototype.listen=function(){return this.listenTo(this.organizationModel,"change:logo",this.renderAvatar)},e.prototype.hasPermission=function(){return this.organizationModel.hasPermission("put.info")},e.prototype.getAvatar=function(){return this.organizationModel.get("logo")},e.prototype.renderAvatar=function(t){var e,i;return i=new window.Image,e=t.get("logo"),i.onload=function(t){return function(){if(t.$el)return t.$(".avatar").css({"background-image":"url("+e+")"})}}(this),i.src=e},e.prototype.initUploader=function(t){var e;return e=this.$el.find(".progress-mask"),this.uploader=new a({model:t,thumb:{width:200,height:200},type:"logo",duplicate:!0,onCreate:function(e){return t.set("logo",e.thumbnailUrl)},onStart:function(){return e.css("clip","rect(0, 132px, 132px, 0)").html("")},onProgress:function(t){var i;return i=132*t/100,e.css("clip","rect("+i+"px, 132px, 132px, 0)")},onComplete:function(i){return e.css("clip","rect(132px, 132px, 132px, 0)"),t.save(null,{attrs:{logo:i.thumbnailUrl}})},onError:function(){return t.save({logo:t.previous("logo")}),r.show({message:tb_i18n.get("organization.settings.avatar.upload.failed"),status:"error"})},onFinish:function(){return r.show({message:tb_i18n.get("organization.settings.avatar.upload.success"),status:"success"})}})},e.prototype.onCropAvatar=function(t){var e;return t.preventDefault(),null!=(e=this.$cropAvatarInput)&&e.remove(),this.$cropAvatarInput=$("<input type='file' accept='image/*'>"),this.$cropAvatarInput.on("change",function(t){return function(e){return t.requestSubView(l).open(s,{file:e.target.files[0],backdrop:"static",avatarUpload:function(e){return t.avatarUpload(e)}})}}(this)).trigger("click")},e.prototype.avatarUpload=function(t){return this.uploader.addFile(t),this.uploader.upload()},e.prototype.render=function(){return this.$el.html(n(this))},e}(c)},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;a=i(358),c=i(678),s=i(788),r=i(1349),n=i(1819),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="OrganizationAvatarCropView",e.prototype.className="organization-avatar-crop-view modal modal-dialog",e.prototype.hotkeys={enter:"upload"},e.prototype.events={"click .save":"upload"},e.prototype.initialize=function(t){return this.file=t.file,this.avatarUpload=t.avatarUpload,this},e.prototype.onOpen=function(){var t,e;return this.$el.html(n()),this.showLoadingIndicator(this.$(".image-cropper-wrapper")),t=this.$(".image-cropper-wrapper"),e=this.$el.find(".preview canvas")[0],a.delay(function(i){return function(){return i.imageCropper=new r({input:i.$(".image-cropper-input")[0],container:t[0],containerWidth:t.width(),containerHeight:320,widthAdapt:!0,cropperWidth:200,ratio:1,round:!0,hd:!0,file:i.file,crop:function(t){var i;return i=e.getContext("2d"),i.clearRect(0,0,e.width,e.height),i.drawImage(t,0,0,e.width,e.height)}}),i.hideLoadingIndicator(i.$(".cropper-wrapper"))}}(this),300),this},e.prototype.upload=function(){var t,e,i,n;return null!=(i=this.imageCropper)&&i.destroy(),t=this.avatarUpload,e=this.imageCropper,"function"==typeof(null!=(n=this.parentView)?n.close:void 0)?this.parentView.close():this.$el.addClass("hide"),t(e.toBlob())},e.prototype.remove=function(){var t;return null!=(t=this.imageCropper)&&t.destroy(),e.__super__.remove.apply(this,arguments)},e}(s)},function(t,e){t.exports=function(t){var e='<div class="modal-content"> <div class="modal-header"> <div class="modal-title">'+tb_i18n.get("organization.avatarCrop.edit.organization.avatar")+'</div> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </div> <div class="modal-body"> <div class="source-wrapper"> <div class="cropper-wrapper"> <div class="image-cropper-wrapper"></div> </div> <div class="crop-hint"> <input type="file" accept="image/*" id="org-avatar-input" class="image-cropper-input" style="display:none"> <a class="image-input"> <label for="org-avatar-input" style="margin:0;cursor:pointer;"> <span class="icon icon-picture"></span> '+tb_i18n.get("organization.avatarCrop.choose")+" </label> </a> <span>"+tb_i18n.get("organization.avatarCrop.hint")+'</span> </div> </div> <div class="preview-wrapper"> <p class="title">'+tb_i18n.get("organization.avatarCrop.preview")+'</p> <div class="preview"> <canvas width="200" height="200"></canvas> <div class="prev-hint">64&times;64</div> </div> </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-link cancel" data-dismiss="modal">'+tb_i18n.get("cancel")+'</button> <button type="submit" class="btn btn-primary save">'+tb_i18n.get("save")+"</button> </div></div>";return e}},function(t,e){t.exports=function(t){var e="<label>"+tb_i18n.get("organization.settings.avatar")+'</label><div> <div class="avatar" style="background-image: url('+t.getAvatar()+')"></div> <div class="progress-mask"></div></div>';return t.hasPermission()&&(e+=' <button class="avatar-upload-button"> '+tb_i18n.get("organization.settings.avatar.upload")+" </button>"),e}},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;l=i(358),a=i(788),n=i(699),c=i(786),s=i(1822),r=i(1827),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="OrgBelongingView",e.prototype.className="org-belonging-view",e.prototype.events={"click .transfer-handler":"onTransfer"},e.prototype.initialize=function(t){return this.organizationModel=t.organizationModel,this.owner=null,this.loadMembers(this.organizationModel).then(function(t){return function(e){return t.owner=t.findOwner(e),t.render()}}(this))["catch"](console.error.bind(console))},e.prototype.loadMembers=function(t){return new Promise(function(e,i){return n.fetch(t.id,{boundToObjectType:"organization",success:e,error:i})})},e.prototype.findOwner=function(t){var e;return e=t.filter(function(t){return 2===t.getRoleScope()}),l.chain(e).sortBy(function(t){return new Date(t.get("joined")).valueOf()}).first().value()},e.prototype.getOwnerName=function(){return this.owner.get("name")},e.prototype.getOwnerAvatar=function(){return this.owner.get("avatarUrl")},e.prototype.onTransfer=function(t){var e;return t.preventDefault(),e=$(t.currentTarget),this.requestSubView(c).open(s,{organizationModel:this.organizationModel})},e.prototype.hasPermission=function(){return this.organizationModel.hasPermission("del")},e.prototype.render=function(){return this.$el.html(r(this))},e}(a)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},v={}.hasOwnProperty;m=i(358),f=i(678),o=i(401),d=i(788),a=i(688),u=i(1340),s=i(699),c=i(1341),h=i(786),r=i(805),l=i(1823),n=i(1826),t.exports=p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.viewName="OrganizationTransferView",e.prototype.className="organization-transfer-view modal-dialog modal-padding",e.prototype.events={"click .owner-select":"toggleOwnerSelector","click .confirm-handler":"onConfirm"},e.prototype.initialize=function(t){return this.organizationModel=t.organizationModel,this.load({success:function(t){return function(){return t.renderBasic()}}(this)}),this},e.prototype.renderBasic=function(t){return null==t&&(t={}),this.$el.html(n(t)),this.$confirmHandler=this.$(".confirm-handler"),this},e.prototype.load=function(t){return null==t&&(t={}),this.showLoadingIndicator(),s.fetch(this.organizationModel.id,{boundToObjectType:"organization",success:function(e){return function(i){if(e.$el)return e.membersCollection=i,t.success()}}(this)})},e.prototype.toggleOwnerSelector=function(t){var e,i,n;return e=$(t.currentTarget),e.data("bs.popover")?this:(i=this.membersCollection.toJSON().filter(function(t){return t._id!==f.user.id}),null!=(n=this.ownerSelectorView)&&n.remove(),this.ownerSelectorView=this.requestSubView(l,{$toggler:e,members:i,select:function(t){return function(e){return t.ownerId=e[0],t.ownerModel=t.membersCollection.get(t.ownerId),t.renderBasic(t.ownerModel.toJSON())}}(this)}).show(),this)},e.prototype.onConfirm=function(){if(this.ownerId)return this.requestSubView(h).open(r,{title:tb_i18n.get("confirm")+tb_i18n.get("organization.settings.transfer"),content:tb_i18n.get("organization.settings.transfer.warning"),confirmText:tb_i18n.get("organization.settings.transfer.confirm"),confirmStyle:"danger",onConfirm:function(t){return function(){return t.submit()}}(this)})},e.prototype.submit=function(){return this.organizationModel.transfer(this.ownerId,{wait:!0,success:function(t){return function(){return o.success(tb_i18n.get("organization.settings.transfer.success")),m.delay(function(){return t.close(),f.router.navigate("/projects",{trigger:!0})})}}(this),error:function(t){return o.error(t.message)}}),this},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.remove(),this},e}(d)},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;l=i(358),n=i(1824),r=i(1825),s=i(813),a=i(797),c=i(677),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="OrganizationOwnerSelectorView",e.prototype.className="organization-owner-selector-view",e.prototype.popoverTitle="Menu",e.prototype.width=320,e.prototype.events={"click .owner-item":"selectMember","mouseenter .member-item":"activate","input .filter-input":"onFilter"},e.prototype.initialize=function(t){return this.members=t.members||[],e.__super__.initialize.apply(this,arguments),this},e.prototype.render=function(){return this.$el.html(n()),this.$ul=this.$("ul"),this.$("input").focusAtEnd(),this.setupScroll(this.$ul),this.renderOwners({members:this.members}),this},e.prototype.renderOwners=function(t){return this.$ul.html(r(t)),this},e.prototype.selectMember=function(t){var e,i;return e=$(t.currentTarget).data("id"),this.hide(),"function"==typeof(i=this.options).select&&i.select([e]),this},e.prototype.onFilter=function(t){var e,i;return e=this.$(t.target),i=e.val().trim().toLowerCase(),i?(this.query=i,this.renderOwners({members:c.memberFilter(this.members,this.query)})):this.renderOwners({members:this.members}),this},e.prototype.activate=function(t){var e;if(e=$(t.currentTarget),e.length&&!e.hasClass("active"))return e.addClass("active").siblings().removeClass("active"),this},e}(s),l.extend(o.prototype,a),t.exports=o},function(t,e){t.exports=function(t){var e='<div class="menu-input"> <input class="filter-input form-control" placeholder="'+tb_i18n.get("organization.settings.search.owner")+'"/></div><ul class="list-unstyled thin-scroll"></ul>';return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="";t.members.length>0&&(i+=" <p>"+tb_i18n.get("organization.member")+"</p>");var n=t.members;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li class="owner-item" data-id="'+r._id+'"> <a> <div class="avatar img-circle" style="background-image:url('+r.avatarUrl+');"></div> '+e(r.name)+" </a> </li>";return i}},function(t,e){t.exports=function(t){var e='<div class="modal-content"> <header class="modal-header"> <h4 class="modal-title text-center">'+tb_i18n.get("organization.settings.transfer")+'</h4> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </header> <div class="modal-body"> <p>'+tb_i18n.get("organization.settings.transfer.tips")+'</p> <a class="owner-select"> ';return(t.logo||t.avatarUrl)&&(e+=' <div class="avatar img-circle" style="background-image:url('+(t.logo||t.avatarUrl)+');"></div> '),e+=' <span class="owner-name">'+(t.name||tb_i18n.get("organization.settings.select.owner"))+'</span> <span class="icon icon-chevron-down"></span> </a> </div> <div class="modal-footer"> <button class="confirm-handler btn btn-primary ',t._id||(e+="disabled"),e+='">'+tb_i18n.get("confirm")+"</button> </div></div>"}},function(t,e){t.exports=function(t){var e="<label>"+tb_i18n.get("organization.settings.label.belonging")+'</label><div class="org-belonging-item"> <div class="org-belonging-avatar" style="background-image: url('+t.getOwnerAvatar()+')"></div> <span class="org-belonging-name">'+t.getOwnerName()+"</span> ";return t.hasPermission()&&(e+=' <button class="transfer-handler"> '+tb_i18n.get("organization.settings.button.transfer")+" </button> "),e+="</div>"}},function(t,e){t.exports=function(t){var e='<form class="org-info-form" > <div class="no-permission-section"> </div> <section class="avatar-section"> </section> <section> <div data-fields="name"></div> </section> <section> <div data-fields="description"></div> </section> <section> <div data-fields="isPublic"></div> </section> <section class="belonging-section"> </section> ';return t.hasPermission()&&(e+=' <hr class="seperator"> <section class="action-section"> <input class="btn form-handler submit" type="submit" value="'+tb_i18n.get("save")+'"></input> </section> '),e+="</form>"}},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=i(788),r=i(429),n=i(699),o=i(1830),t.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.viewName="OrgSettingsPayView",e.prototype.className="org-settings-pay-view",e.prototype.initialize=function(t){return this.organizationModel=t.organizationModel,this.loadMembers(this.organizationModel).then(function(t){return function(e){return t.memberCollection=e,t.render()}}(this))["catch"](console.error.bind(console))},e.prototype.loadMembers=function(t){return new Promise(function(e,i){return n.fetch(t.id,{boundToObjectType:"organization",success:e,error:i})})},e.prototype.getData=function(){var t,e,i,n;switch(i=this.organizationModel.toJSON(),n=this.organizationModel.getPaymentPlan(),i.plan=n,e=r(n.expired),i.deadline=e.format("ll"),i.membersCount=this.memberCollection.length,i.membersLimit=n.membersLimit,i.created=r(i.created).format("ll"),t=r(),n.status){case"trial":e.isBefore(t)?i.status={key:"trial_overdue",copy:tb_i18n.get("organization.trial.overdue")}:i.status={key:"trial",copy:tb_i18n.get("organization.trial")};break;case"paid":e.isBefore(t)?i.status={key:"paid_overdue",copy:tb_i18n.get("organization.paid.overdue")}:i.status={key:"paid",copy:tb_i18n.get("organization.paid")},i.membersLimit>9999&&(e.isBefore(t)?i.status={key:"paid_overdue",copy:tb_i18n.get("organization.paid.overdue")}:i.status={key:"paid_4990",copy:tb_i18n.get("organization.paid")})}return i},e.prototype.render=function(){return this.$el.html(o(this.getData()))},e}(a)},function(t,e,i){t.exports=function(t){var e="",n=i(798);return e+='<div class="settings-part payment-info-container"> <div class="organization-members organization-subscription"> <h5 class="status-key">'+tb_i18n.get("organization.members.key")+'</h5> <p class="status-content"> '+tb_i18n.get("organization.current.members.number",t.membersCount)+" ",e+=t.membersLimit<1e4?" "+tb_i18n.get("organization.current.members.limit",t.membersLimit)+" ":" "+tb_i18n.get("organization.current.members.unlimit")+" ",e+=' </p> </div> <div class="organization-created organization-subscription"> <h5 class="status-key">'+tb_i18n.get("organization.created.key")+'</h5> <p class="status-content">'+t.created+'</p> </div> <div class="organization-expired organization-subscription"> <h5 class="status-key">'+tb_i18n.get("organization.expired.key")+"</h5> ",e+=t.plan.restDays>9999?' <p class="status-content">'+tb_i18n.get("organization.statistics.none")+"</p> ":' <p class="status-content">'+t.deadline+"</p> ",e+=' </div> <div class="organization-status organization-subscription"> <h5 class="status-key">'+tb_i18n.get("organization.status.key")+'</h5> <p class="status-content">'+t.status.copy+'</p> </div> <div class="btn-group"> ',"trial"===t.plan.status?e+=' <a class="btn-primary btn" href="'+n.pay.orgNew(t._id)+"\" target=\"_blank\" data-gta=\"{action: 'create order', type: 'business', control: 'new'}\"> "+tb_i18n.get("organization.payment.buy")+" </a> ":"paid"===t.status.key?e+=' <a class="btn-primary btn" href="'+n.pay.orgRenew(t._id)+"\" target=\"_blank\" data-gta=\"{action: 'create order', type: 'business', control: 'renew'}\"> "+tb_i18n.get("organization.buy.years")+' </a> <a class="btn-primary btn" href="'+n.pay.orgAddMember(t._id)+"\" target=\"_blank\" data-gta=\"{action: 'create order', type: 'business', control: 'add member'}\"> "+tb_i18n.get("organization.buy.members")+" </a> ":"paid_overdue"===t.status.key?e+=' <a class="btn-primary btn" href="'+n.pay.orgRenew(t._id)+"\" target=\"_blank\" data-gta=\"{action: 'create order', type: 'business', control: 'renew'}\"> "+tb_i18n.get("organization.buy.now")+" </a> ":"paid_4990"===t.status.key&&(e+=' <a class="btn-primary btn" href="'+n.pay.orgOldRenew(t._id)+"\" target=\"_blank\" data-gta=\"{action: 'create order', type: 'business', control: 'renew'}\"> "+tb_i18n.get("organization.buy.years")+" </a> "),
e+=' <a class="btn-default btn" href="'+n.pay.orgOrder(t._id)+'" target="_blank" data-gta="{action: \'view order\', type: \'business\'}"> '+tb_i18n.get("organization.check.order")+" </a> </div></div>"}},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=i(788),n=i(1832),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.viewName="OrgSettingsConsultView",e.prototype.className="org-settings-consult-view",e.prototype.initialize=function(t){return this.organizationModel=t.organizationModel,this.render()},e.prototype.render=function(){return this.$el.html(n(this))},e}(o)},function(t,e){t.exports=function(t){var e='<div class="settings-part consultant-container"> <h4>'+tb_i18n.get("organization.exclusive.consultant")+"</h4> <p> "+tb_i18n.get("organization.exclusive.consultant.service")+" </p> <p> "+tb_i18n.get("organization.exclusive.consultant.mail","cs@teambition.com")+" </p> <p> "+tb_i18n.get("organization.exclusive.consultant.phone","021-80323105")+" </p></div>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f=function(t,e){function i(){this.constructor=t}for(var n in e)g.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},g={}.hasOwnProperty;m=i(678),h=i(679),u=i(788),r=i(401),c=i(696),d=i(786),p=i(1373),n=i(805),o=i(1834),s=i(1836),l=i(1378),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.viewName="OrgSettingsMoreView",e.prototype.className="org-settings-more-view",e.prototype.events={"click .btn-leave-organization":"onLeave","click .btn-delete-organization":"onDelete"},e.prototype.initialize=function(t){return this.options=t,this.organizationModel=t.organizationModel,this.render()},e.prototype.hasPermission=function(){return this.organizationModel.hasPermission("del")},e.prototype.onLeave=function(t){var e,i;return t.preventDefault(),e=this.options.onClose,i=function(t){return function(){return t.organizationModel.quit({wait:!0,success:function(){return c.get(0).fetch({reset:!0}),r.success(tb_i18n.get("organization.settings.leave.success")),m.router.navigate("projects",{trigger:!0}),e()}})}}(this),this.requestSubView(d).open(n,{title:tb_i18n.get("organization.settings.leave"),content:tb_i18n.get("organization.settings.leave.msg"),onConfirm:i})},e.prototype.onDelete=function(t){var e;return t.preventDefault(),e=this.options.onClose,this.requestSubView(d).open(p,{model:this.organizationModel,template:function(){return l({title:tb_i18n.get("organization.settings.delete"),message:tb_i18n.get("organization.settings.delete.msg"),button:tb_i18n.get("organization.settings.delete")})},success:function(){return c.get(0).fetch({reset:!0}),r.success(tb_i18n.get("organization.settings.delete.success")),m.router.navigate("projects",{trigger:!0}),e()}})},e.prototype.renderDingDingSection=function(){if(h.FEATURES.dingding)return this.$(".dingding-section").html(this.requestSubView(o,this.options).$el)},e.prototype.render=function(){return this.$el.html(s(this)),this.renderDingDingSection()},e}(u)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;u=i(358),n=i(357),l=i(788),s=i(401),a=i(680),p=i(786),r=i(805),o=i(1835),t.exports=c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.viewName="OrgDingDingView",e.prototype.className="org-ding-ding-view",e.prototype.events={"click .unbind":"unbind"},e.prototype.initialize=function(t){if(this.organizationModel=t.organizationModel,this.hasBindPermission())return this.dingtalk={refer:"dingtalk",refId:void 0,title:void 0,isActive:void 0},this.loadBindData().then(function(t){return function(){return t.render()}}(this))},e.prototype.loadBindData=function(){return a.get("organizations/"+this.organizationModel.get("_id")+"/bind",{}).then(function(t){return function(e){var i;if(i=u.find(e,function(t){return"dingtalk"===t.refer}))return t.dingtalk=i}}(this))},e.prototype.postBindData=function(t){return a.post("organizations/"+this.organizationModel.get("_id")+"/bind",{refer:"dingtalk",refId:t})},e.prototype.hasBindPermission=function(){return this.organizationModel.getRoleScope()>=1&&"paid"===this.organizationModel.getPaymentPlan().status},e.prototype.hasUnbindPermission=function(){return this.organizationModel.getRoleScope()>=1},e.prototype.disableSubmitButton=function(t){var e;if(this.$el)return e=this.$("input.submit"),e.attr("disabled",t)},e.prototype.unbind=function(t){var e;return t.preventDefault(),e=this.dingtalk.title?'"'+this.dingtalk.title+'"':"",this.requestSubView(p).open(r,{title:"解除绑定钉钉企业",content:"您确定要解除绑定钉钉企业"+e+"?",onConfirm:function(t){return function(){return a.del("organizations/"+t.organizationModel.get("_id")+"/bind/dingtalk").then(function(){return t.dingtalk.refId=void 0,t.dingtalk.title=void 0,t.dingtalk.isActive=void 0,t.render()})}}(this)})},e.prototype.onChange=function(t){var e,i;return i=t.data,e=t.validate(),this.disableSubmitButton(!!(null!=e?e.corpId:void 0))},e.prototype.onSubmit=function(t,e){var i;return e.preventDefault(),i=t.getValue().corpId,this.postBindData(i).then(function(t){return function(e){return t.dingtalk.refId=e.refId,t.dingtalk.title=e.title,t.render(),s.success("您的企业已同钉钉企业绑定。")}}(this))["catch"](console.error.bind(console)).then(function(t){return function(){return t.disableSubmitButton(!1)}}(this))},e.prototype.getForm=function(){var t,e;return e={corpId:{type:"Text",validators:["required"],editorAttrs:{autofocus:!0,placeholder:"请输入企业CorpID"}}},n.Form.validators.errMessages.required="",new(t=n.Form.extend({template:function(t){return function(){return o(t)}}(this),schema:e}))},e.prototype.render=function(){var t;return t=this.getForm(),t.render(),t.on("submit",u.partial(this.onSubmit,t).bind(this)),t.on("change",u.debounce(this.onChange.bind(this,t),100)),this.$el.html(t.el),this.$("label[for=corpId]").remove(),this.disableSubmitButton(!0)},e}(l)},function(t,e){t.exports=function(t){var e='<div class="settings-part advanced-settings org-dingding-settings"> <hr class="seperator" /> <h4>绑定钉钉企业</h4> ';return t.dingtalk.refId?(e+=" <p> ",e+=t.dingtalk.title?' 您的企业已同钉钉企业"'+t.dingtalk.title+'"绑定。 ':" 您的企业已同钉钉企业绑定。 ",e+=" ",t.dingtalk.isActive||(e+=' （请钉钉企业创建者用钉钉扫描以下二维码激活应用） <div class="qrcode"></div> '),e+=" </p> ",t.hasUnbindPermission()&&(e+=' <p class="btn-group"> <a class="btn btn-primary form-control unbind"> 解除绑定 </a> </p> '),e+=" "):e+=' <p> 该操作仅限钉钉企业创建者；请前往钉钉后台查找到企业CorpID，填入下面的输入框，完成绑定操作。 </p> <form class="org-dingding-form"> <div class="corpid-input" data-fields="corpId"></div> <input class="btn form-handler submit" type="submit" value="绑定"></input> </form> ',e+="</div>"}},function(t,e){t.exports=function(t){var e='<div class="settings-part advanced-settings"> ';return e+=t.hasPermission()?" <h4>"+tb_i18n.get("organization.settings.delete.title")+'</h4> <p class="muted">'+tb_i18n.get("organization.settings.delete.msg")+'</p> <p class="btn-group"> <a class="btn btn-danger btn-delete-organization form-control"> '+tb_i18n.get("organization.settings.button.delete")+" </a> </p> ":" <h4>"+tb_i18n.get("organization.settings.leave.title")+'</h4> <p class="muted">'+tb_i18n.get("organization.settings.leave.msg")+'</p> <p class="btn-group"> <a class="btn btn-danger btn-leave-organization form-control"> '+tb_i18n.get("organization.settings.leave")+" </a> </p> ",e+='</div><div class="dingding-section"></div>'}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m=function(t,e){function i(){this.constructor=t}for(var n in e)f.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},f={}.hasOwnProperty;d=i(358),h=i(678),a=i(401),u=i(786),c=i(813),l=i(1838),n=i(1839),r=i(1840),s=i(1841),o=i(1842),t.exports=p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return m(e,t),e.prototype.viewName="TeamMenuView",e.prototype.className="team-menu-view",e.prototype.popoverTitle="",e.prototype.events={"click .team-detail-handler":"openTeamDetail","click .edit-team-handler":"enterEditSubMenu","click .delete-team-handler":"enterDeleteSubMenu","click .team-creator-icons .icon":"chooseTeamIcon","submit .team-creator-form":"submitCreateForm","submit .team-edit-form":"submitEditForm","submit .team-delete-form":"submitDeleteForm"},i={"icon-team-tie":"#8193BA","icon-team-stamp":"#98C93B","icon-team-terminal":"#00A7E0","icon-team-notebook":"#55C3D4","icon-team-flag":"#ED8747","icon-team-location":"#5374ED","icon-team-loudspeaker":"#8193BA","icon-team-bulb":"#98C93B","icon-team-compass":"#00A7E0","icon-team-briefcase":"#55C3D4","icon-team-pen":"#ED8747","icon-team-graph":"#5374ED","icon-team-talk":"#8193BA","icon-team-camera":"#98C93B","icon-team-building":"#00A7E0","icon-team-bus":"#55C3D4","icon-team-calculator":"#ED8747","icon-team-medal":"#5374ED"},e.prototype.initialize=function(t){return null==t&&(t={}),this.options=t,this.isLevelOneTeam=this.options.isLevelOneTeam,this.organizationModel=this.options.organizationModel,this.permissions=this.organizationModel.hasPermissions("team.post","team.del"),"create"===this.options.type?this.popoverTitle=this.isLevelOneTeam?tb_i18n.get("team.create"):tb_i18n.get("team.create.sub"):this.popoverTitle=tb_i18n.get("team.menu"),e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){return"create"===this.options.type?this.renderCreateForm():this.renderTeamMenu()},e.prototype.renderCreateForm=function(){var t,e,n;if(this.permissions.teamPost)return this.isLevelOneTeam?e=tb_i18n.get("team.create.placeholder"):(e=tb_i18n.get("team.create.sub.placeholder"),n=tb_i18n.get("team.belongsTo",this.options.parentName)||""),t={teamIcons:d.pairs(i),tips:n,placeholder:e,permissions:this.permissions},this.$el.html(r(t)),this.$nameInput=this.$("input")},e.prototype.renderTeamMenu=function(){var t;if(this.options.teamModel&&this.options.organizationModel)return t=d.extend(this.options.teamModel.toJSON(),{permissions:this.permissions}),this.teamId=t._id,this.organization=this.options.organizationModel,this.$el.html(n(t))},e.prototype.openTeamDetail=function(){return this.requestSubView(u).open(l,{_teamId:this.teamId,organizationModel:this.organization}),this.hide()},e.prototype.enterEditSubMenu=function(){var t;return t=d.extend(this.options.teamModel.toJSON(),{teamIcons:d.pairs(i),isLevelOneTeam:this.isLevelOneTeam}),this.isLevelOneTeam||(t.tips=tb_i18n.get("team.belongsTo",this.options.parentName)),this.enterSubMenu(tb_i18n.get("team.menu.edit.title"),function(e){return function(){return e.$el.html(s(t)),e.$("input").focusAtEnd()}}(this))},e.prototype.enterDeleteSubMenu=function(){return this.enterSubMenu(tb_i18n.get("team.menu.delete.title"),function(t){return function(){return t.$el.html(o({}))}}(this))},e.prototype.chooseTeamIcon=function(t){var e;return t.preventDefault(),e=$(t.currentTarget),e.addClass("active").siblings().removeClass("active"),this.$teamIcon={name:e.data("type"),color:i[e.data("type")]}},e.prototype.submitCreateForm=function(t){var e,i;return t.preventDefault(),(e=this.$nameInput.val().trim())?(this.hide(),this.isLevelOneTeam&&(i=this.$teamIcon?this.$teamIcon.name+","+this.$teamIcon.color:"icon-team-tie,#8193BA"),this.options.onConfirm({name:e,style:i})):this.$nameInput.focusAtEnd()},e.prototype.submitEditForm=function(t){var e,i,n;return t.preventDefault(),e=$(t.currentTarget),(i=e.find("input").val().trim())?(this.isLevelOneTeam&&(n=this.$teamIcon?this.$teamIcon.name+","+this.$teamIcon.color:"icon-team-tie,#8193BA"),this.options.teamModel.save({name:i,style:n},{success:function(t){return function(){return t.hide()}}(this)})):e.find("input").focusAtEnd()},e.prototype.submitDeleteForm=function(t){return t.preventDefault(),this.hide(),this.options.teamModel.destroy({success:function(){return a.success(tb_i18n.get("delete.success"))}})},e}(c)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;p=i(358),u=i(678),c=i(677),l=i(788),n=i(699),r=i(696),a=i(1010),s=i(1195),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.viewName="TeamManagerView",e.prototype.className="team-manager-view",e.prototype.initialize=function(t){return this.options=null!=t?t:{},this.organizationModel=this.options.organizationModel,this.load({success:function(t){return function(){return t.renderBasic(),t.listen()}}(this)})},e.prototype.load=function(t){return Promise.all([new Promise(function(t){return function(e,i){return n.fetch(t.organizationModel.id,{boundToObjectType:"organization",success:e,error:function(t,e){return i(e)}})}}(this)),new Promise(function(t){return function(e,i){return r.fetch(t.options._teamId,{boundToObjectType:"team",success:e,error:function(t,e){return i(e)}})}}(this)),new Promise(function(t){return function(e,i){return r.fetch(t.organizationModel.id,{boundToObjectType:"organization",success:e,error:function(t,e){return i(e)}})}}(this)),new Promise(function(t){return function(e,i){return a.fetchOne(t.organizationModel.id,t.options._teamId,{boundToObjectType:"organization",success:e,error:function(t,e){return i(e)}})}}(this))]).then(function(e){return function(i){return e.organizationMembersCollection=i[0],e.teamProjectsCollection=i[1],e.organizationProjectsCollection=i[2],e.teamModel=i[3],t.success()}}(this))["catch"](function(t){return console.error(t)}),this},e.prototype.listen=function(){return this.listenTo(this.teamProjectsCollection,"add remove",function(){})},e.prototype.renderBasic=function(){var t,e;return t=this.teamModel.toJSON(),t.permissions=this.organizationModel.hasPermissions("team.post"),t.isTeamDefault="default"===this.teamModel.get("type"),t=p.extend({objType:"team",cardModel:this.teamModel,modalTitle:tb_i18n.get("team.detail"),organizationModel:this.organizationModel,membersCollection:this.organizationMembersCollection,teamProjectsCollection:this.teamProjectsCollection,organizationProjectsCollection:this.organizationProjectsCollection},t),e=this.requestSubView(s,t),this.$el.html(e.$el),this},e}(l)},function(t,e){t.exports=function(t){var e='<ul class="list"> <li> <a class="team-detail-handler" data-gta="{action: \'open detail\', type: \'team\'}"> '+tb_i18n.get("team.detail")+" </a> </li> ";return t.permissions.teamPost&&(e+=' <li> <a class="edit-team-handler" data-gta="{action: \'edit team\'}"> '+tb_i18n.get("team.menu.edit.title")+" </a> </li> "),e+=" ",t.permissions.teamDel&&(e+=' <hr/> <li> <a class="delete-team-handler" data-gta="{action: \'delete team\'}"> '+tb_i18n.get("team.menu.delete.title")+" </a> </li> "),e+="</ul>"}},function(t,e){t.exports=function(t){var e='<form class="team-creator-form"> <input class="form-control" type="text" placeholder="'+t.placeholder+'" autofocus="autofocus"></input> ';if(t.tips)e+=" <p>"+t.tips+"</p> ";else{e+=' <div class="team-creator-icons"> ';var i=t.teamIcons;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <span class="icon '+n[0]+" ",0==r&&(e+="active"),e+='" data-type="'+n[0]+'" style="color: '+n[1]+'"></span> ';e+=" </div> "}return e+=' <button class="btn btn-primary" type="submit" data-gta="event" data-label="create team">'+tb_i18n.get("create")+"</button></form>"}},function(t,e){t.exports=function(t){var e='<form class="team-edit-form"> <input class="form-control" type="text" value="'+t.name+'"></input> ';if(t.isLevelOneTeam){e+=' <div class="team-creator-icons"> ';var i=t.teamIcons;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <span class="icon '+n[0]+" ",0==r&&(e+="active"),e+='" data-type="'+n[0]+'" style="color: '+n[1]+'"></span> ';e+=" </div> "}else e+=" <p>"+t.tips+"</p> ";return e+=' <button class="btn btn-primary" type="submit" data-gta="event" data-label="edit team">'+tb_i18n.get("save")+"</button></form>"}},function(t,e){t.exports=function(t){var e='<form class="team-delete-form"> <p>'+tb_i18n.get("team.menu.confirm.delete")+'</p> <button class="btn btn-danger" type="submit" data-gta="event" data-label="delete team">'+tb_i18n.get("confirm")+"</button></form>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b=function(t,e){function i(){this.constructor=t}for(var n in e)k.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},k={}.hasOwnProperty,w=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};v=i(358),y=i(678),f=i(788),h=i(689),o=i(401),m=i(1011),a=i(700),d=i(687),p=i(699),g=i(786),s=i(1678),c=i(1680),r=i(1844),n=i(1846),l=i(1847),t.exports=u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.viewName="OrganizationMemberaddView",e.prototype.className="org-memberadd-view modal-dialog flex-vert flex-fill",e.prototype.events={"click .batch-invite-handler":"openBatchAdd","click .add-member-handler":"addMember","input .member-info-input":"filter","change .member-info-input":"filter"},e.prototype.initialize=function(t){var e,i,n,r,o,s,a,c;if(this.options=t,this.options.target)return this.ready=!1,(e=this.options).title||(e.title=tb_i18n.get("organization.memberadd.title")),(i=this.options).inviteText||(i.inviteText=tb_i18n.get("organization.memberadd.inviteText")),(n=this.options).inviteTextClass||(n.inviteTextClass=""),(r=this.options).searchTip||(r.searchTip=tb_i18n.get("organization.memberadd.searchTip")),(o=this.options).sourceTitle||(o.sourceTitle=tb_i18n.get("organization.memberadd.cooperatedMember")),null==(s=this.options).globalSearch&&(s.globalSearch=!0),null==(a=this.options).enableSourceTitle&&(a.enableSourceTitle=!0),this.organizationModel=this.options.organizationModel,this.targetType=function(){switch(!1){case this.options.target instanceof m!=!0:return"team";case this.options.target instanceof d!=!0:return"organization"}}.call(this),this.gtaCategory="team"===this.targetType?"team":"org",null==(c=this.options).showMemberProgress&&(c.showMemberProgress=!0),this.showMemberProgress=this.options.showMemberProgress&&this.organizationModel.getPaymentPlan().membersLimit<h.UNLIMIT_MEMBERS,this.renderBasic(),this.renderContent(),this},e.prototype.renderBasic=function(){return this.$el.html(n(this.options)),this.showMemberProgress&&this.$el.addClass("show-member-progress"),this.$emptySearchPlaceHolder=this.$(".empty-search-placeholder"),this.$emptyProjectPlaceHolder=this.$(".empty-project-placeholder"),this.$memberContainer=this.$(".member-wrapper"),this.$memberList=this.$(".member-list"),this.$invitedMemberList=this.$(".invited-member-list"),this.$memberProgress=this.$(".member-progress"),this},e.prototype.renderContent=function(){return this.$(".placeholder-wrapper, .list-wrapper").hide(),this.showLoadingIndicator(this.$invitedMemberList),this.loadData({success:function(t){return function(){return t.ready=!0,t.renderList(),t.hideLoadingIndicator(),t.options.globalSearch&&t.initMemberFinder(),t.showMemberProgress&&t.renderMemberProgress(),t.listen()}}(this)})},e.prototype.loadData=function(t){return new Promise(function(t){return function(e,i){return p.fetch(t.options.organizationModel.id,{boundToObjectType:"organization",success:e,error:function(t,e){return i(e)}})}}(this)).then(function(e){return function(i){var n,r;return e.organizationMembersCollection=i,r=[],e.options.source instanceof p?e.sourceMembersCollection=e.options.source:e.options.source||r.push(new Promise(function(t,i){return e.options.target.getRecommendMembers({success:function(i){return e.sourceMembersCollection=new p(i),t()},error:function(t,e){return i(e)}})})),"organization"===e.targetType?e.targetMembersCollection=e.organizationMembersCollection:"team"===e.targetType&&(n=e.organizationMembersCollection.filter(function(t){var i;return i=e.options.target.id,w.call(t.get("teams"),i)>=0}),e.targetMembersCollection=new p(n,{boundToObjectType:"team",_boundToObjectId:e.options.target.id})),Promise.all(r).then(function(){return null!=t?t.success():void 0})["catch"](function(t){return console.error(t)})}}(this))["catch"](function(t){return console.error(t)})},e.prototype.renderList=function(){var t;return t=this.renderMembers(),t?this.$memberContainer.show():(this.$emptyProjectPlaceHolder.show(),this.$emptyProjectPlaceHolder.find(".tip").html(1===this.targetMembersCollection.length?tb_i18n.get("organization.memberadd.noMemberInviteSomeone"):tb_i18n.get("organization.memberadd.allRecommendInvited"))),this.filter()},e.prototype.renderMembers=function(){var t;return t=0,this.sourceMembersCollection.each(function(e){return function(i){var n,r;if(r=i.toJSON(),r._userMeId=y.user.id,!e.targetMembersCollection.get(i.id)&&"teambition@teambition.com"!==r.email)return n=e.$memberList.find(".member[data-id="+i.id+"]"),n.length?n.replaceWith(l(r)):e.$memberList.append(l(r)),++t}}(this)),t},e.prototype.checkMembersExceed=function(){var t,e;return e=this.organizationMembersCollection.length>=this.organizationModel.getPaymentPlan().membersLimit,e&&"function"==typeof(t=this.options).onMembersExceed&&t.onMembersExceed(),e},e.prototype.addMember=function(t,e){var i,n,r,o,s,a;if(null==e&&(e={}),r="currentTarget"in t?(i=$(t.currentTarget)).closest(".member").data("email"):t.item.email||("email"===t.item.type?t.item.value:void 0),s=this.organizationMembersCollection.toJSON().map(function(t){return t.email}),(v.contains(s,r)||!this.checkMembersExceed())&&r)return(a=this.targetMembersCollection.where({email:r}),o=a[0],a).length?("function"==typeof(n=this.options).onMemberWasAdded&&n.onMemberWasAdded(o),"function"==typeof e.success&&e.success()):this.targetMembersCollection.addMember({email:r},{success:function(t){return function(){var i;return"function"==typeof(i=t.options).onMemberAddSuccess&&i.onMemberAddSuccess(),"function"==typeof e.success?e.success():void 0}}(this)}),null==e.ignoreGTA&&y.gta.event({action:"added member",category:this.gtaCategory,type:"team"===this.targetType?"org member":"worked with",control:"team"===this.targetType?"single import":"button",method:this.$(".member-info-input").val()?"filter":"click"}),this},e.prototype.openBatchAdd=function(){var t;if(!this.checkMembersExceed())return t=this.organizationModel.getPaymentPlan().membersLimit-this.organizationMembersCollection.length,t=t>0?t:0,this.requestSubView(g).open(r,{membersLeft:t,onConfirm:function(t){return function(e){if(e.length)return t.targetMembersCollection.addMember({email:e},{success:function(t){return o.success(tb_i18n.get("organization.settings.add.members.success",t.length)),y.gta.event({action:"added member",type:"batch",control:"button",category:this.gtaCategory})}})}}(this)}),y.gta.event({action:"add member",type:"batch",control:"button",category:this.gtaCategory})},e.prototype.initMemberFinder=function(){return this.requestSubView(s,{collection:this.sourceMembersCollection,$searchbox:this.$(".member-info-input"),newEmailPrefix:this.options.globalSearch?tb_i18n.get("member.finder.sendInvitationMailTo"):"",select:function(t){return function(e){return t.addMember(e,{ignoreGTA:!0,success:function(){var i,n,r;if(e.item.inProject=!0,!t.$(".invited-member-list > .member[data-id='"+e.item._id+"']").length){if(r=t.targetMembersCollection.where({email:e.item.email||e.item.value}),0===r.length)return;n=r[0].toJSON(),n._userMeId=y.user.id,n.inProject=!0,t.$invitedMemberList.append(l(n)),t.$emptyProjectPlaceHolder.hide()}return"function"==typeof(i=t.options).onMemberAddFromInputSuccess&&i.onMemberAddFromInputSuccess(),y.gta.event({action:"added member",type:"single",control:"invite "+(e.item.isNew?"new":"existing")+" user",category:t.gtaCategory})}})}}(this)})},e.prototype.filter=function(t){var e,i;if(this.ready&&(i=this.$(".member-info-input").val(),this.query!==i))return this.query=i,e=this.filterMember(i),e||this.$emptyProjectPlaceHolder.is(":visible")?(this.$invitedMemberList.show(),this.$emptySearchPlaceHolder.hide()):(this.$invitedMemberList.hide(),this.$emptySearchPlaceHolder.show(),this.$emptySearchPlaceHolder.find(".tip").html(tb_i18n.get("organization.memberadd.searchCantfind",i)))},e.prototype.filterMember=function(t){var e,i,n;return n=!t,n?this.$memberContainer.find("header, li.member").show():(i=this.$memberList,i.find("li.member").hide(),e=this.$memberContainer.children("header").hide(),this.sourceMembersCollection.filter(function(e){var i,r,o,s;if("teambition@teambition.com"===e.get("email"))return!1;for(s=["name","py","pinyin","email"],r=0,o=s.length;r<o;r++)if(i=s[r],~(e.get(i)||"").indexOf(t))return n=!0;return!1}).map(function(t){return e.show(),i.find(".member[data-id="+t.id+"]").show()})),n},e.prototype.listen=function(){return this.listenTo(this.target,"remove",this.close),this.listenTo(this.targetMembersCollection,"add",function(t,e){var i;return null!=(i=this.$(".member[data-id="+t.id+"] .add-member-handler"))?i.replaceWith("<p class='added'>"+tb_i18n.get("project.memberadd.added")+"</p>"):void 0}),this.listenTo(this.targetMembersCollection,"remove",function(t,e){var i;return null!=(i=this.$(".member[data-id="+t.id+"] .add-member-handler"))?i.replaceWith("<button class='button-add add-member-handler'>"+tb_i18n.get("project.memberadd.add")+"</button>"):void 0}),this.listenTo(this.organizationMembersCollection,"add destroy remove",function(t){return function(){if(t.showMemberProgress)return t.renderMemberProgress()}}(this)),this},e.prototype.renderMemberProgress=function(){var t;return null!=(t=this.memberProgressView)&&t.remove(),this.memberProgressView=this.requestSubView(c,{exist:this.organizationMembersCollection.length,organizationModel:this.organizationModel}),this.$memberProgress.html(this.memberProgressView.$el),this},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.close(),this},e}(f)},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;l=i(358),p=i(678),a=i(677),c=i(788),o=i(401),n=i(1845),s=20,t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="BatchAddMembersView",e.prototype.className="batch-add-members-view modal-dialog flex-vert flex-fill",e.prototype.events={"input textarea":"onEmailsInput","click .submit":"submit"},e.prototype.initialize=function(t){return null==t&&(t={}),this.membersLeft=t.membersLeft||0,this.onConfirm=t.onConfirm,this.emails=[],this.renderBasic(),this.renderTips(),this.checkStatusOfSubmit()},e.prototype.renderBasic=function(){var t,e;return e=tb_i18n.get("add.members.by.emails"),t=this.membersLeft>s?tb_i18n.get("add.members.by.emails.placeholder.unlimit"):tb_i18n.get("add.members.by.emails.placeholder",this.membersLeft),this.$el.html(n({title:e,placeholder:t})),this.$submit=this.$(".submit")},e.prototype.renderTips=function(){var t,e;return t=this.getMembersGap(),e=t<0?tb_i18n.get("add.members.tips.add.exceed"):tb_i18n.get("add.members.tips.add.remian",t),this.$(".tips").text(e)},e.prototype.checkStatusOfSubmit=function(){var t;return t=this.getMembersGap(),t<0||0===this.emails.length?this.$submit.addClass("disabled"):this.$submit.removeClass("disabled")},e.prototype.onEmailsInput=function(t){var e,i;return i=$(t.currentTarget).val(),i=i.replace(/，|；|,|;/g," ").replace(/\s+/g," ").trim(),e=i.split(" "),e=l.filter(l.uniq(e),function(t){return a.isEmail(t)}),this.emails=e||[],this.renderTips(),this.checkStatusOfSubmit()},e.prototype.getMembersGap=function(){return Math.min(this.membersLeft,s)-this.emails.length},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.remove(),this},e.prototype.submit=function(){var t;return t=this.getMembersGap(),t<0?o.error(tb_i18n.get("add.members.error.limit")):(this.onConfirm(this.emails),this.close())},e}(c)},function(t,e){t.exports=function(t){var e='<div class="modal-header text-center flex-static"> <div class="modal-title text-center">'+t.title+'</div> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a></div><div class="modal-body flex thin-scroll flex-fill"> <textarea class="emails form-control flex-fill" placeholder="'+t.placeholder+'"></textarea></div><div class="modal-footer"> <p class="tips"></p> <button type="button" class="btn btn-primary submit">'+tb_i18n.get("confirm")+"</button></div>";return e}},function(t,e){t.exports=function(t){var e='<div class="modal-header text-center flex-static"> <div class="modal-title text-center">'+t.title+'</div> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a></div><div class="guide-settings-content modal-body thin-scroll flex-fill"> <div class="add-member-header"> <div class="'+t.inviteTextClass+'">'+t.inviteText+"</div> ";return t.onBatchInvite&&(e+=' <a class="link-add-handler batch-invite-handler"> '+tb_i18n.get("organization.memberadd.batch.invite")+" </a> "),e+=' </div> <div class="member-finder',t.enableSourceTitle||(e+=" no-title-list"),e+='"> <input type="text" class="form-control member-info-input" placeholder="'+t.searchTip+'"> </div> <div class="placeholder-wrapper empty-project-placeholder"> <div class="illustration"></div> <p class="tip"></p> </div> <div class="placeholder-wrapper empty-search-placeholder"> <div class="illustration"></div> <p class="tip"></p> </div> <ul class="list invited-member-list"></ul> <div class="list-wrapper member-wrapper"> ',t.enableSourceTitle&&(e+=" <header>"+t.sourceTitle+"</header> "),e+=' <ul class="list member-list"></ul> </div></div><div class="member-progress"></div>'}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li class="member" data-id="'+t._id+'" data-email="'+t.email+'"> <div class="avatar img-circle img-24" style="background-image:url('+t.avatarUrl+');"></div> <p class="abstract"> ';return i+=t._userId===t._userMeId?' <span class="name" data-title="'+e(t.name)+"("+tb_i18n.get("me")+')">'+e(t.name)+"("+tb_i18n.get("me")+")</span> ":' <span class="name" data-title="'+t.name+'">'+e(t.name)+"</span> ",i+=' </p> <div class="status"> ',i+=t.inProject?' <p class="added">'+tb_i18n.get("project.memberadd.added")+"</p> ":' <button class="btn btn-default button-add add-member-handler">'+tb_i18n.get("project.memberadd.add")+"</button> ",i+=" </div></li>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;l=i(358),u=i(678),p=i(679),n=i(1849),a=i(813),s=i(699),r=i(401),c=i(677),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.viewName="MemberMenuView",e.prototype.className="organization-member-menu-view",e.prototype.popoverTitle="",e.prototype.width=245,e.prototype.events={"click .resend-handler":"resendInvitation","click .role-handler":"setRole","click .remove-from-org":"removeFromOrg"},e.prototype.initialize=function(t){return null==t&&(t={}),this.popoverTitle=tb_i18n.get("organization.member.menu"),this.options=t,e.__super__.initialize.apply(this,arguments)},e.prototype.render=function(){var t,e,i,r;return r=this.options.organizationModel,e=this.options.memberModel,i=c.getMemberPermissions(r,e),t=l.extend(e.toJSON(),i,{_organizationId:r.get("_organizationId")
}),this.$el.html(n(t))},e.prototype.resendInvitation=function(t){return this.hide(),this.options.memberModel.saveAttr("resend",null,{wait:!0,success:function(){return r.success(tb_i18n.get("organization.email.sent30"))}})},e.prototype.removeFromOrg=function(t){return this.hide(),this.options.membersCollection.removeMember(this.options.memberModel.id,{wait:!0,success:function(t){return function(){return t.options.onRemove(),r.success(tb_i18n.get("remove.success"))}}(this)})},e.prototype.setRole=function(t){var e,i;if(this.hide(),e=$(t.currentTarget),i=e.data("role"),1===i.length&&(i=+i),i!==this.options.memberModel.get("_roleId"))return this.options.memberModel.saveAttr("_roleId",i,{wait:!0,success:function(t){return function(e){var i,n;return n=e.getRole(),"function"==typeof(i=t.options).success?i.success(n):void 0}}(this)})},e}(a)},function(t,e){t.exports=function(t){var e='<ul class="list"> ';return 0==t.isActive&&t.password?e+=' <li> <a class="resend-handler"> '+tb_i18n.get("project.settings.resend",t.password)+" </a> </li> ":t.canManageMemberRole&&(e+=' <li class="',1==t._roleId&&(e+="selected"),e+='" data-gta="{action: \'change member permission\', control: \'Org Member List\'}"> <a class="role-handler" data-role="1"> '+tb_i18n.get("manager")+' </a> </li> <li class="',0==t._roleId&&(e+="selected"),e+='" data-gta="{action: \'change member permission\', control: \'Org Member List\'}"> <a class="role-handler" data-role="0"> '+tb_i18n.get("member")+" </a> </li> "),e+=" ",t.canDeleteMember&&(e+=" <hr/> <div class=\"remove-wrapper\"> <a class=\"remove-from-org\" data-gta=\"{action: 'remove member', type: 'org member', control: 'Org Member List'}\"> "+tb_i18n.get("organization.member.remove")+" </a> </div> "),e+="</ul>"}},function(t,e,i){t.exports=function(t){var e="",n=i(798);return e+='<!-- 左边 部门 --><div class="teams-side-bar thin-scroll"> <div class="search-input"> <span class="icon icon-search"></span> <input class="filter-input form-control"/> </div> <div class="filter-group"> <h5>'+tb_i18n.get("member")+'</h5> <ul class="list-unstyled"> <li class="team-node team-all" data-id="all" data-gta="{action: \'open org member group\', type: \'all\'}"> <span class="icon icon-org-users"></span> '+tb_i18n.get("members.manager.all.members")+' </li> <li class="team-node team-new" data-id="new" data-gta="{action: \'open org member group\', type: \'new\'}"> <span class="icon icon-org-avatar"></span> '+tb_i18n.get("members.manager.new.members")+' </li> <li class="team-node team-unassigned" data-id="unassigned" data-gta="{action: \'open org member group\', type: \'unarranged\'}"> <span class="icon icon-org-who"></span> '+tb_i18n.get("members.manager.unassigned.members")+' </li> </ul> </div> <div class="filter-group"> <h5>'+tb_i18n.get("team")+'</h5> <div class="teams-list"></div> ',t.permissions.teamPost&&(e+=' <a class="btn btn-text add-team-handler" data-gta="{action: \'add team\'}"> <span class="icon icon-circle-cross"></span> '+tb_i18n.get("team.create")+" </a> "),e+=' </div> <div class="filter-group"> <h5>'+tb_i18n.get("more")+"</h5> ",t.canReorderTeam&&(e+=' <a class="btn btn-text order-teams-handler"> <span class="icon icon-reorder"></span> '+tb_i18n.get("organization.settings.order.teams")+" </a> "),e+=' <a class="btn btn-text" href="'+n.permissions(t._organizationId)+'" target="_blank" data-gta="{action: \'view and manage permission\'}"> <span class="icon icon-cog"></span> ',e+=t.permissions.rolePost||t.permissions.rolePut||t.permissions.roleDel?" "+tb_i18n.get("organization.settings.roles.config")+" ":" "+tb_i18n.get("organization.settings.roles.onlyread")+" ",e+=' </a> </div></div><!-- 右边 成员 --><div class="team-members thin-scroll"> <div class="team-header flex flex-between flex-vcenter"></div> <ul class="member-list"></ul></div>'}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="",n=t.members;if(n)for(var r,o=-1,s=n.length-1;o<s;){if(r=n[o+=1],i+=' <li class="member flex flex-between flex-vcenter" data-id="'+r._id+'"> <div class="avatar img-circle img-36 pull-left" style="background-image: url('+r.avatarUrl+')"> ',r.hasVisited||(i+=' <span class="icon icon-leave-state never-visit"></span> '),i+=' </div> <div class="member-info"> <div class="member-name">'+e(r.name)+'</div> <p class="member-title muted">'+(r.title||r.email||"")+'</p> </div> <div class="member-teams"> ',r.teamsText){if(i+=" ",r.teamsColors&&r.teamsColors.length){i+=' <div class="team-icons"> <div class="team-points"> ';var a=r.teamsColors;if(a)for(var c,l=-1,p=a.length-1;l<p;)c=a[l+=1],i+=' <span class="team-point" style="background-color: '+c+'"></span> ';i+=" </div> </div> "}i+=" <span>"+r.teamsText+"</span> "}else t.permissions.postMember&&(i+=' <a class="assign-team" data-id="'+r._id+"\" data-gta=\"{action: 'add member', control: 'Org Member List', category: 'team'}\"> <span class=\"icon icon-plus\"></span> "+tb_i18n.get("organization.member.assign.team")+" </a> ");i+=' </div> <div class="member-menu-wrapper flex flex-end"> ',t.isFakeTeam?(i+=' <a class="org-member-menu-handler ',(r.canManageMemberRole||r.canDeleteMember)&&r._id!==teambition.user.id||(i+="disabled"),i+='" data-id="'+r._id+'"> <span class="menu-name">'+e(r.roleName)+'</span> <span class="icon icon-chevron-down"></span> </a> '):(i+=" ",r.isDirectMember?(i+=" ",i+=(t.permissions.delMember||t.permissions.putDefaultrole||r.canDeleteMember)&&r._id!==teambition.user.id?' <a class="team-member-menu-handler" data-id="'+r._id+'"> <span class="menu-name">'+tb_i18n.get("remove")+'</span> <span class="icon icon-chevron-down"></span> </a> ':" <p>"+tb_i18n.get("team.member.team")+"</p> ",i+=" "):i+=" <p>"+tb_i18n.get("team.member.subteam")+"</p> ",i+=" "),i+=" </div> </li>"}return t.members.length||(i+=' <div class="search-no-result flex flex-vert flex-center flex-vcenter"> <img src="'+t.placeholder+'"/> <p>'+tb_i18n.get("team.manger.no.member")+"</p> </div>"),i}},function(t,e){t.exports=function(t){var e='<div class="team-member-title"> <span class="team-name">'+t.name+'</span> · <span class="team-members-count">'+t.membersCount+'</span></div><div class="team-menu flex"> ';return t.permissions.postMember&&(e+=' <a class="btn btn-text add-member-handler ',e+=t.isFakeTeam?"to-org":"to-team",e+="\" data-gta=\"{action: 'begin add member', type: 'org member', control: 'Org Member List', category: '",e+=t.isFakeTeam?"org":"team",e+='\'}"> <span class="icon icon-circle-cross"></span> <span>'+tb_i18n.get("members.manager.add.member")+"</span> </a> "),e+=" ",t.isFakeTeam||(e+=" ",t.permissions.teamPost&&t.level<9&&(e+=' <a class="btn btn-text add-subteam-handler" data-gta="{action: \'add subteam\'}"> <span class="icon icon-circle-cross"></span> <span>'+tb_i18n.get("team.create.sub")+"</span> </a> "),e+=' <a class="btn btn-text team-more-menu" data-id="'+t._id+'"> <span class="icon icon-more"></span> <span>'+tb_i18n.get("more")+"</span> </a> "),e+="</div>"}},function(t,e,i){t.exports=i.p+"images/no-member.01a5dbe6.png"},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;l=i(358),n=i(1855),p=i(679),o=i(684),a=i(788),c=i(786),s=i(1474),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="OrganizationExpiringView",e.prototype.className="organization-expiring modal-dialog modal-padding",e.prototype.events={"click .export-projects":"openProjectsExportTransfer","click .contact-owner":"close","click .icon-remove":"close"},e.prototype.initialize=function(t){if(t._organizationId)return this.options=t,this.organizationsCollection=o.get(0),this.organizationModel=this.organizationsCollection.get(t._organizationId),this.render(),this},e.prototype.render=function(){return this.$el.html(n({_organizationId:this.organizationModel.id,_organizationName:this.organizationModel.get("name"),_roleId:this.organizationModel.get("_roleId"),permissions:this.organizationModel.hasPermissions("put.transferOut"),projectsCount:this.organizationModel.get("projectIds").length,plan:this.organizationModel.getPaymentPlan()})),this},e.prototype.openProjectsExportTransfer=function(){var t,e;return t=o.get(0).getOrganizationsByRight(2),e=l.pluck(t,"id"),e.push(0),this.requestSubView(c).open(s,{sourceId:this.organizationModel.id,sourceTitle:this.organizationModel.get("name"),targetIds:e,action:"export"}),this},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.remove(),this},e.prototype.remove=function(){var t;return"function"==typeof(t=this.options).onclose&&t.onclose(),e.__super__.remove.apply(this,arguments)},e}(a)},function(t,e,i){t.exports=function(t){var e="",n=i(798);return e+='<div class="modal-content"> <header class="modal-header text-center"> <a class="modal-close modal-close pull-right icon icon-remove"></a> <h4 class="modal-title">'+tb_i18n.get("organization.expiring.title")+'</h4> </header> <div class="modal-body"> ',e+=t._roleId>=0?' <p class="description">'+tb_i18n.get("organization.expiring.content",t._organizationName)+"</p> ":' <p class="description">'+tb_i18n.get("organization.expiring.contact.owner",t._organizationName)+"</p> ",e+=' <div class="organization-expiring-handler-set clearfix"> ',t._roleId>=0?(e+=" ",e+="trial"===t.plan.status?' <a href="'+n.pay.orgNew(t._organizationId)+'" target="_blank" class="btn btn-primary btn-block">'+tb_i18n.get("organization.expiring.go.pay.new")+"</a> ":' <a href="'+n.pay.orgRenew(t._organizationId)+'" target="_blank" class="btn btn-primary btn-block">'+tb_i18n.get("organization.expiring.go.pay.renew")+"</a> ",e+=" ",t.projectsCount>0&&t.permissions.putTransferOut&&(e+=' <a class="btn btn-primary ghost export-projects btn-block">'+tb_i18n.get("projects.export")+"</a> "),e+=" "):e+=' <a class="btn btn-primary contact-owner btn-block">'+tb_i18n.get("organization.expiring.btn.ok")+"</a> ",e+=" </div> </div></div>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w=function(t,e){function i(){this.constructor=t}for(var n in e)_.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},_={}.hasOwnProperty;b=i(358),k=i(678),s=i(401),g=i(677),v=i(788),a=i(680),f=i(1011),u=i(699),h=i(696),m=i(1010),r=i(583),o=i(976),y=i(786),n=i(1685),p=i(1857),l=i(1858),c=i(1859),t.exports=d=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.viewName="OrganizationGuideView",e.prototype.className="organization-guide-view modal-dialog modal-padding",e.prototype.events={"click .project-item":"addToSelected","click .confirm-introduce":"confirmIntroduce","click .confirm-import-projects":"confirmImportProjects","click .confirm-import-members":"confirmImportMembers","click .play-ctrl":"playToggle"},e.prototype.initialize=function(t){return null==t&&(t={}),this.options=t,this.steps=["introduce","importProjects","importMembers"],this.stepTemplateMap={introduce:p,importProjects:l,importMembers:c},this.currentStep=this.options.initStep||"importProjects",this.organizationModel=this.options.organizationModel,this.currentStep===this.steps[0]?(this.renderIntroduce(),this.listen()):this.currentStep===this.steps[1]&&this.renderImportProjects(),this},e.prototype.listen=function(){var t,e,i;return null!=(t=this.video)&&(t.onplay=function(t){return function(){return t.$playCtrl.hide(),b.delay(function(){return t.video.controls=!0},800)}}(this)),null!=(e=this.video)?e.onpause=null!=(i=this.video)?i.onended=function(t){return function(){return t.$playCtrl.show(),b.delay(function(){return t.video.controls=!1},800)}}(this):void 0:void 0},e.prototype.renderStep=function(t,e){var i;return i=this.stepTemplateMap[t],this.$el.html(i(e)),this},e.prototype.renderIntroduce=function(){var t;return t={poster:i(1860),video:"http://dn-site.oss-cn-hangzhou.aliyuncs.com/videos/web_onboarding_organizations.mp4"},this.renderStep(this.steps[0],t),this.video=this.$("video")[0],this.$playCtrl=this.$(".play-ctrl")},e.prototype.confirmIntroduce=function(){return this.renderImportProjects()},e.prototype.renderImportProjects=function(){var t;return t=function(t){return function(e){return(null!=e?e.length:void 0)>0?t.renderStep(t.steps[1],{projects:e}):t.renderImportMembers()}}(this),h.fetch(0,{success:function(e){return e=e.models.filter(function(t){return t.hasPermission("put.transfer")&&!t.get("_organizationId")}),e=e.map(function(t){return t.toJSON()}),t(e)}})},e.prototype.addToSelected=function(t){return this.$(t.currentTarget).toggleClass("selected"),this},e.prototype.getSelected=function(t){var e,i;return i=[],e=this.$el.find(".project-item.selected"),b.each(e,function(t){return function(e){var n,r;return n=t.$(e).data("id"),r=h.findOne(0,n),i.push(r)}}(this)),i},e.prototype.confirmImportProjects=function(){return this.getSelected().length?b.reduce(this.getSelected(),function(t){return function(e,i){return e.then(function(){return new Promise(function(e,n){return i.transfer(t.organizationModel.id,{ownerType:"organization",wait:!0,beforeSend:function(){},success:e,error:n})})})}}(this),Promise.resolve()).then(function(t){return function(){return s.show({message:tb_i18n.get("project.transfer.success"),status:"success"}),t.renderImportMembers()}}(this))["catch"](function(t){return function(e){var i;switch(i=e.message,e.code){case 207:i=tb_i18n.get("project.settings.over.plan.warn");break;case 301:i=tb_i18n.get("project.settings.no.right.warn");break;case 302:i=tb_i18n.get("project.settings.no.exist.warn")}return s.show({message:i,status:"error"}),t.renderImportMembers()}}(this)):this.renderImportMembers()},e.prototype.renderImportMembers=function(){return this.renderStep(this.steps[2]),new r({$wrap:this.$(".select-members"),org:this.organizationModel.toJSON(),userMe:k.user.toJSON(),tabList:["members"],membersLimit:-1,locale:tb_i18n.getLanguage(),apiGetOrgMembers:this.apiGetOrgMembers,apiGetOrgWorkedMembers:this.apiGetOrgWorkedMembers,apiPostAddOrgMember:this.apiPostAddOrgMember,apiDeleteOrgMember:this.apiDeleteOrgMember}),this},e.prototype.apiGetOrgMembers=function(t){return a.get("organizations/"+t+"/members")},e.prototype.apiGetOrgWorkedMembers=function(t){return a.get("organizations/"+t+"/recommendMembers")},e.prototype.apiPostAddOrgMember=function(t,e){return a.post("organizations/"+t+"/members",e)},e.prototype.apiDeleteOrgMember=function(t,e){return a.del("organizations/"+t+"/members/"+e)},e.prototype.confirmImportMembers=function(){return this.close()},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.remove(),this},e.prototype.playToggle=function(){if(this.video)return this.video.isPlaying?this.video.pause():this.video.play(),this},e}(v)},function(t,e){t.exports=function(t){var e='<div class="modal-content introduce"> <div class="modal-header"> <div class=\'modal-title\'>'+tb_i18n.get("organization.help.header")+'</div> <a class="modal-close icon icon-remove" data-dismiss="modal"></a> </div> <div class="modal-body"> <p>'+tb_i18n.get("organization.help.description1")+'</p> <div class="video-container"> <video poster="'+t.poster+'" preload="metadata"> <source src="'+t.video+'" type="video/mp4"> </video> <span class="icon icon-play play-ctrl"></span> </div> </div> <div class="modal-footer"> <a class="btn btn-primary form-control confirm-introduce">'+tb_i18n.get("enter.organization.guide")+"</a> </div></div>";return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="modal-content import-projects"> <div class="modal-header"> <div class=\'modal-title\'>'+tb_i18n.get("enter.organization.guide")+'</div> <a class="modal-close icon icon-remove" data-dismiss="modal"></a> </div> <div class="modal-body"> <h4>'+tb_i18n.get("organization.guide.import.projects")+"</h4> <p>"+tb_i18n.get("organization.guide.import.projects.description")+'</p> <div class="select-projects thin-scroll"> ',n=t.projects;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li data-id="'+r._id+'" class="project-item"> <div class="logo" style="background-image:url('+r.logo+');"></div> <div class="project-info"> <div class="project-name hinted" data-title="'+r.name+'">'+e(r.name)+'</div> <div class="project-flag"> <span class="icon icon-tick-thin"></span> </div> </div> </li> ';return i+=' </div> </div> <div class="modal-footer"> <button class="btn btn-primary pull-right confirm-import-projects">'+tb_i18n.get("org.guide.next")+"</button> </div></div>"}},function(t,e){t.exports=function(t){var e='<div class="modal-content import-members"> <div class="modal-header"> <div class=\'modal-title\'>'+tb_i18n.get("enter.organization.guide")+'</div> <a class="modal-close icon icon-remove" data-dismiss="modal"></a> </div> <div class="modal-body"> <h4>'+tb_i18n.get("organization.guide.import.members")+"</h4> <p>"+tb_i18n.get("organization.guide.import.members.description")+'</p> <div class="select-members"> </div> </div> <div class="modal-footer"> <button class="btn btn-primary pull-right confirm-import-members">'+tb_i18n.get("confirm")+"</button> </div></div>";return e}},function(t,e,i){t.exports=i.p+"images/web_onboarding_guide.68d6be9a.png"},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T=function(t,e){function i(){this.constructor=t}for(var n in e)M.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},M={}.hasOwnProperty;_=i(358),j=i(678),p=i(429),k=i(788),s=i(680),v=i(797),b=i(677),f=i(1862),y=i(996),h=i(696),a=i(699),w=i(786),c=i(1194),d=i(1863),r=i(1872),o=i(1873),g=i(1874),l=i(1875),n=$(window),m=p("2015-08-15"),t.exports=u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return T(e,t),e.prototype.viewName="OrganizationReportView",e.prototype.className="organization-report-view card",e.prototype.events={"click .switch-handler":"switchWeek","click a.org-reports-rank-member":"showMemberOverall","click .task":"openTaskDetail"},e.prototype.initialize=function(t){if(this.options=null!=t?t:{},this.options.organizationModel)return this.startOfWeek=p().startOf("week"),this.organization=this.options.organizationModel,this.createTime=p(this.organization.get("created")),this.dueTime=p().subtract(7,"day"),this.projectsCollection=h.get(0),this.createTime.isAfter(this.dueTime)?this.$el.html(this.requestSubView(d,{organization:this.organization,type:"report",header:{title:tb_i18n.get("organization.report.blank.title"),description:tb_i18n.get("organization.report.blank.description")}}).$el).addClass("organization-report-content"):(this.renderBasic(),this.load({success:function(t){return function(){return t.renderBody()}}(this)}))},e.prototype.load=function(t){var e,i;return null==t&&(t={}),this.showLoadingIndicator(this.$body.empty()),e=this.startOfWeek.clone().add(1,"day"),i=this.startOfWeek.isBefore(p(),"week"),s.ajax("organizations/"+this.organization.id+"/statistics/"+e.toISOString(),{expireCache:{namespace:"org_report_frozen_"+e.valueOf(),expire:i?3600:300},success:function(i){return function(n){return i.hideLoadingIndicator({animated:!0}),i.isFrozen=n.isFrozen||i.startOfWeek.isBefore(p().startOf("week")),i.reportModel=new f(n,{date:e}),i.listen(),t.success()}}(this)}),a.fetch(this.organization.id,{boundToObjectType:"organization",success:function(t){return function(e){return t.memberCollection=e}}(this)})},e.prototype.listen=function(){return this.stopListening(),this.listenTo(this.reportModel,"change",this.renderBody)},e.prototype.renderBasic=function(){return this.$el.html(r()).addClass("organization-report-content"),this.$header=this.$(".org-reports-header"),this.$body=this.$(".org-reports-body"),this.renderHeader()},e.prototype.renderHeader=function(){return this.$header.html(o({hasPrev:this.startOfWeek.isAfter(m,"week")&&this.startOfWeek.isAfter(p(this.organization.get("created")),"week"),hasNext:this.startOfWeek.isBefore(p(),"week"),startDate:this.startOfWeek.format("M.D"),endDate:this.startOfWeek.clone().endOf("week").format("M.D"),weekNumber:this.startOfWeek.format("wo")}))},e.prototype.renderBody=function(){var t;return t=this.reportModel.toJSON(),t.isFrozen=this.isFrozen,this.$body.html(g(t)),this.$tabs=this.$(".org-reports-tab"),this.$tabContents=this.$(".org-reports-tab-content"),this.$states=this.$('.org-reports-tab-content[data-tab="states"] .org-reports-tab-list'),this.$doneList=this.$('.org-reports-tab-content[data-tab="done"] .org-reports-tab-list'),this.$delayList=this.$('.org-reports-tab-content[data-tab="delay"] .org-reports-tab-list'),this.renderDelayTasks(),this.renderDoneTasks()},e.prototype.restructTasks=function(t){var e,i,n,r,o,s;i=[],n=_.groupBy(t,"_executorId");for(e in n)r={tasks:n[e],executor:n[e][0].executor},24===e.length?i.push(r):s=_.clone(r);return o=_.sortBy(i,function(t){return-t.tasks.length}),s&&o.push(s),o},e.prototype.extendDelayTasks=function(t){var e,i,n,r;for(n=[],e=0,i=t.length;e<i;e++)r=t[e],n.push(_.extend({},r,{isDone:!1,dueDate:r.dueDate?b.formatDate(r.dueDate):void 0,accomplished:r.accomplished?b.formatDate(r.accomplished):void 0}));return n},e.prototype.extendDoneTasks=function(t){var e,i,n,r;for(n=[],e=0,i=t.length;e<i;e++)r=t[e],n.push(_.extend({},r,{isDone:!0,dueDate:r.dueDate?b.formatDate(r.dueDate):void 0,accomplished:r.accomplished?b.formatDate(r.accomplished):void 0}));return n},e.prototype.renderDelayTasks=function(){var t,e,i,n,r,o,s,a;for(t=this.$delayList.empty(),a=this.reportModel.get("delayTasks"),a=a.filter(this.getTaskFilter()),a.sort(this.getDelaySorter()),a=this.extendDelayTasks(a),o=this.restructTasks(a),s=[],n=0,r=o.length;n<r;n++)i=o[n],i.control="Delayed Task List",e=l(i),s.push(t.append(e));return s},e.prototype.renderDoneTasks=function(){var t,e,i,n,r,o,s,a;for(t=this.$doneList.empty(),a=this.reportModel.get("doneTasks"),a=a.filter(this.getTaskFilter()),a.sort(this.getDoneSorter()),a=this.extendDoneTasks(a),o=this.restructTasks(a),s=[],n=0,r=o.length;n<r;n++)i=o[n],i.control="Completed Task List",e=l(i),s.push(t.append(e));return s},e.prototype.switchWeek=function(t){var e,i;return e=$(null!=t?t.currentTarget:void 0),i=e.data("type"),this.startOfWeek["next"===i?"add":"subtract"](1,"weeks"),this.renderHeader(),this.load({success:function(t){return function(){return t.renderBody()}}(this)})},e.prototype.showMemberOverall=function(t){var e,i,n,r;switch(e=$(null!=t?t.currentTarget:void 0),i=e.data("id"),i&&this.memberCollection&&(null!=(n=this.memberOverallView)&&n.remove(),this.memberOverallView=this.requestSubView(w).open(c,{memberModel:this.memberCollection.get(i),organizationModel:this.organization})),e.parents(".org-reports-tab-content").data("tab")){case"delay":r="Delayed List";break;case"done":r="Completed List";break;default:r="Unknow"}return j.gta.event({action:"open detail",type:"org member",control:r}),this},e.prototype.openTaskDetail=function(t){var e,i;if(e=$(null!=t?t.currentTarget:void 0),i=e.data("id"))return j.APP.openTaskPreviewer(i)},e.prototype.getDelaySorter=function(){return function(t,e){var i,n;return i=new Date(t.dueDate),n=new Date(e.dueDate),i-n}},e.prototype.getDoneSorter=function(){return function(t,e){var i,n;return i=new Date(t.accomplished),n=new Date(e.accomplished),i-n}},e.prototype.getTaskFilter=function(){var t;return t=this.projectsCollection,function(e){return!!t.get(null!=e?e._projectId:void 0)}},e}(k)},function(t,e,i){var n,r,o,s,a,c=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;a=i(678),r=i(429),n=i(688),s=i(358),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.name="report",e.prototype.defaults={counts:{delay:0,done:0,"new":0},delayTasks:[],doneTasks:[],newTasks:[],ranks:{delay:[],done:[]}},e.prototype.initialize=function(t,i){var n;return null==t&&(t={}),null==i&&(i={}),n=r(i.date),this.id=t._id=n.format("YYYY.MM.DD"),e.__super__.initialize.call(this,t,i)},e.prototype.initSubscribe=function(){var t,e,i,n;for(n=["delayTasks","doneTasks"],t=0,e=n.length;t<e;t++)i=n[t],this.subscribeList(i);return this},e.prototype.subscribeList=function(t){var e,i,n,r,o;for(n=this.get(t)||[],r=[],e=0,i=n.length;e<i;e++)o=n[e],this.subscribeTo(o._id,"change",function(e){return function(i){return e.updateTasksOfList(t,i.toJSON())}}(this)),r.push(this.subscribeTo(o._id,"destroy",function(e){return function(i){return e.removeTaskOfList(t,i)}}(this)));return r},e.prototype.updateTasksOfList=function(t,e){var i,n,o,a,c,l;for(c=this.get(t)||[],a=[],i=r(e.dueDate),n=0,o=c.length;n<o;n++)l=c[n],l._id===e._id?a.push(s.extend({},l,e)):a.push(l);return this.set(t,a),this},e.prototype.removeTaskOfList=function(t,e){var i,n,r,o,s;for(s=this.get(t)||[],r=[],i=0,n=s.length;i<n;i++)o=s[i],o._id!==e&&r.push(o);return this.set(t,r),this},e}(n)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b=function(t,e){function i(){this.constructor=t}for(var n in e)k.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},k={}.hasOwnProperty;v=i(358),f=i(788),s=i(401),m=i(798),g=i(786),a=i(699),n=i(1685),u=i(1460),c=i(1843),d=i(1837),o=i(805),h=i(1864),l=i(1843),r=i(1866),y=function(){return{project:{poster:i(1867),video:"http://dn-site.oss-cn-hangzhou.aliyuncs.com/videos/web_onboarding_projects.mp4"},member:{poster:i(1868),video:"http://dn-site.oss-cn-hangzhou.aliyuncs.com/videos/web_onboarding_members.mp4"},team:{poster:i(1869),video:"http://dn-site.oss-cn-hangzhou.aliyuncs.com/videos/web_onboarding_teams.mp4"},report:{poster:i(1870),video:"http://dn-site.oss-cn-hangzhou.aliyuncs.com/videos/web_onboarding_report.mp4"},statistics:{poster:i(1871),video:"http://dn-site.oss-cn-hangzhou.aliyuncs.com/videos/web_onboarding_dashboards.mp4"}}},t.exports=p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.viewName="OrganizationPlaceholderView",e.prototype.className="organization-placeholder-view",e.prototype.events={"click .create-project":"openProjectCreator","click .import-project":"openProjectsImportTransfer","click .add-members":"showMemberSettings","click .create-team":"openTeamCreator","click .play-ctrl":"playToggle"},e.prototype.initialize=function(t){if(t.organization)return this.options=t,this.organization=this.options.organization,this.sliderInfo=y(),this.type=this.options.type,this.renderBasic().listen()},e.prototype.renderBasic=function(){var t;return this.options.roleScope=this.options.organization.getRoleScope(),t=v.extend({sliderInfo:this.sliderInfo[this.type]},this.options),this.$el.html(r(t)),this.$sliderWrap=this.$(".organization-placeholder-video"),this.$content=this.$(".slider-container"),this.$video=this.$("video"),this.video=this.$video[0],this.$playCtrl=this.$(".play-ctrl"),this},e.prototype.listen=function(){var t,e,i;return null!=(t=this.video)&&(t.onplay=function(t){return function(){return t.$playCtrl.hide(),v.delay(function(){return t.video.controls=!0},800)}}(this)),null!=(e=this.video)?e.onpause=null!=(i=this.video)?i.onended=function(t){return function(){return t.$playCtrl.show(),v.delay(function(){return t.video.controls=!1},800)}}(this):void 0:void 0},e.prototype.openProjectCreator=function(){return this.requestSubView(g).open(u),this},e.prototype.openProjectsImportTransfer=function(){return this.requestSubView(g).open(h,{targetId:this.organization.id,success:function(t){return function(e){return Promise.all(v.map(e,function(t){return new Promise(function(e,i){return a.fetch(t.get("_id"),{boundToObjectType:"project",success:e,error:function(t,e){return i(e)}})})})).then(function(i){var n;return n=v.reduce(i,function(t,e){return e.models.forEach(function(e){return t.push(e)}),t},new a),t.requestSubView(g).open(l,{title:tb_i18n.get("organization.transfer.project.member.title"),inviteText:tb_i18n.get("organization.transfer.project.member.description",e.length),inviteTextClass:"gray",searchTip:tb_i18n.get("organization.transfer.project.member.search.member"),globalSearch:!1,source:n,enableSourceTitle:!1,target:t.organization,organizationModel:t.organization,onMembersExceed:function(){return t.requestSubView(g).open(o,{title:tb_i18n.get("organization.member.exceed"),content:tb_i18n.get("organization.member.exceed.description",t.organization.getPaymentPlan().membersLimit),confirmText:tb_i18n.get("organization.settings.add.member.toplimit"),confirmHref:m.pay.orgAddMember(t.organization.id)})}})})["catch"](function(t){return console.error(t)})}}(this)}),this},e.prototype.showMemberSettings=function(){var t,e;return t=function(t){return function(){var e;return e=function(e){var i;return i=t.organization.getPaymentPlan().membersLimit,t.requestSubView(g).open(n,{type:"emails",model:t.organization,isOrganization:!0,membersLeft:i,addHandler:function(t){if(t.length)return e.addMember({email:t},{success:function(t){var e;return e=t.length,s.show({message:tb_i18n.get("organization.settings.add.members.success",e),status:"success"})}})}})},a.fetch(t.organization.id,{boundToObjectType:"organization",success:e})}}(this),e=function(){return s.error(tb_i18n.get("add.members.error.message"))},this.requestSubView(g).open(c,{target:this.organization,onBatchInvite:t,onMembersExceed:e,organizationModel:this.organization}),this},e.prototype.openTeamCreator=function(t){var e;return e=$(t.currentTarget),this.requestSubView(g).open(d,{type:"create",$toggler:e,organizationModel:this.organization}),this},e.prototype.playToggle=function(){if(this.video)return this.video.isPlaying?this.video.pause():this.video.play(),this},e}(f)},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty,h=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};l=i(358),p=i(678),c=i(788),r=i(401),n=i(1865),s=i(696),o=i(684),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.viewName="TransferProjectsView",e.prototype.className="transfer-projects-view modal-dialog modal-padding flex-vert",e.prototype.events={"click .confirm-handler":"submit","click .project-item":"checkProject"},e.prototype.initialize=function(t){return this.options=t,!!this.options&&(this.selfProjects=s.fetch(0).getSelfProject(),this.selfProjects=this.selfProjects.filter(function(t){return 2===t.get("_roleId")}),this.renderBasic(),this)},e.prototype.renderBasic=function(){return this.$el.html(n({selfProjects:this.selfProjects})),this.$submitter=this.$(".confirm-handler")},e.prototype.checkProject=function(t){return $(t.target).closest(".project-item").children(".project-checkbox").toggleClass("selected"),$(".confirm-handler").toggleClass("disabled",!$(".project-checkbox.selected").length)},e.prototype.submit=function(){var t,e,i;if(t=$(".project-checkbox.selected"),t.length)return e=[],t.closest(".project-item").each(function(){return e.push($(this).data("project-id"))}),i=this.selfProjects.filter(function(t){var i;return i=t.id,h.call(e,i)>=0}),Promise.all(l.map(i,function(t){return function(e){return new Promise(function(i,n){return e.transfer(t.options.targetId,{wait:!0,ownerType:"organization",beforeSend:function(){return t.$submitter.addClass("disabled").html(tb_i18n.get("project.transferring"))},success:i,
error:n})})}}(this))).then(function(t){return function(){var e;return r.success(tb_i18n.get("project.transfer.success")),"function"==typeof(e=t.options).success&&e.success(i),t.close()}}(this))["catch"](function(t){return function(e){var i;switch(i=e.message,e.code){case 207:i=tb_i18n.get("project.settings.over.plan.warn");break;case 301:i=tb_i18n.get("project.settings.no.right.warn");break;case 302:i=tb_i18n.get("project.settings.no.exist.warn")}return r.error(i),t.$submitter.removeClass("disabled").html(tb_i18n.get("confirm")),t.isTransferring=!1}}(this))},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.remove(),this},e}(c)},function(t,e){t.exports=function(t){var e='<div class="modal-content"> <header class="modal-header text-center flex-static"> <h4 class="modal-title">'+tb_i18n.get("projects.transfer.to.organization")+'</h4> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </header> <div class="modal-body thin-scroll flex-fill"> <ul class="project-list"> ',i=t.selfProjects;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <li class="project-item flex-horiz flex-between" data-project-id="'+n.id+'"> <div class="project-icon" style="background-image:url('+n.get("logo")+')"></div> <div class="project-title"> <span>'+n.get("name")+'</span> </div> <div class="project-checkbox"> <span class="icon icon-tick"></span> </div> </li> ';return e+=' </ul> </div> <footer class="modal-footer flex-static"> <button class="confirm-handler btn btn-primary pull-right disabled"> '+tb_i18n.get("projects.transfer.to.organization.confirm")+" </button> </footer></div>"}},function(t,e){t.exports=function(t){var e='<div class="organization-placeholder-topside organization-placeholder"> <header> <h4>'+t.header.title+"</h4> <p> "+t.header.description+" ";return("member"===t.type||"project"===t.type)&&t.roleScope>1&&(e+=" "+tb_i18n.get("enter.organization.guide.text1")+' <a class="organization-guide-enter">'+tb_i18n.get("enter.organization.guide")+"</a> "+tb_i18n.get("enter.organization.guide.text2")+" "),e+=' </p> </header></div><div class="organization-placeholder-video organization-placeholder"> <div class="slider-container"> <video class="active slider-child" poster="'+t.sliderInfo.poster+'" preload="metadata"> <source src="'+t.sliderInfo.video+'" type="video/mp4"> </video> <span class="icon icon-play play-ctrl"></span> </div></div>',t.roleScope>-1&&(e+=' <div class="button-group ',"statistics"!==t.type&&"report"!==t.type||(e+="hide"),e+='"> <div class="organization-handler"> ',"project"===t.type?e+=' <a class="btn btn-primary create-project project-handler" data-gta="event" data-label="organization create project">'+tb_i18n.get("project.creator.create.project")+'</a> <a class="btn btn-default import-project project-handler">'+tb_i18n.get("projects.import")+"</a> ":"member"===t.type&&t.permissions.addMembers?e+=' <a class="btn btn-primary add-members">'+tb_i18n.get("members.manager.add.member")+"</a> ":"team"===t.type&&t.permissions.createTeam&&(e+=' <a class="btn btn-primary create-team">'+tb_i18n.get("org.guide.team.create")+"</a> "),e+=" </div> </div>"),e}},function(t,e,i){t.exports=i.p+"images/web_onboarding_projects.a4a46ba0.png"},function(t,e,i){t.exports=i.p+"images/web_onboarding_members.2b8fef88.png"},function(t,e,i){t.exports=i.p+"images/web_onboarding_teams.19db8c92.png"},function(t,e,i){t.exports=i.p+"images/web_onboarding_report.2f387853.png"},function(t,e,i){t.exports=i.p+"images/web_onboarding_statistics.792f9e42.png"},function(t,e){t.exports=function(t){var e='<div class="org-reports-header row-flex"></div><div class="org-reports-body"></div>';return e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<header> <a class="switch-handler link-add-handler ';return t.hasPrev||(i+="on-hidden"),i+='" data-type="prev" data-gta="{action: \'switch week\', type: \'last\'}"> <span class="icon icon-chevron-left"></span> '+tb_i18n.get("org.reports.arrowLeft")+' </a></header><section> <div class="org-reports-header-title"> ',i+=t.hasNext?" <b>"+e(t.startDate)+" - "+e(t.endDate)+tb_i18n.get("comma")+e(t.weekNumber)+"</b> ":" <b>"+e(t.startDate)+" - "+e(t.endDate)+tb_i18n.get("comma")+tb_i18n.get("org.reports.currentWeek")+"</b> ",i+=' </div></section><footer> <a class="switch-handler link-add-handler ',t.hasNext||(i+="on-hidden"),i+='" data-type="next" data-gta="{action: \'switch week\', type: \'next\'}"> '+tb_i18n.get("org.reports.arrowRight")+' <span class="icon icon-chevron-right"></span> </a></footer>'}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="org-reports-all"> <div class="org-reports-all-title"> <b>'+tb_i18n.get("org.reports.all.title")+'</b> </div> <div class="org-reports-all-cards row-flex"> <section> <div class="org-reports-all-card on-done" data-tab="done"> <span class="org-reports-all-card-title">'+tb_i18n.get("org.reports.all.tips.done")+'</span> <br> <span class="org-reports-all-num">'+e(t.counts.done||0)+'</span> </div> </section> <section> <div class="org-reports-all-card on-delay" data-tab="delay"> <span class="org-reports-all-card-title">'+tb_i18n.get("org.reports.all.tips.delay")+'</span> <br> <span class="org-reports-all-num">'+e(t.counts.delay||0)+'</span> </div> </section> <section> <div class="org-reports-all-card on-create" data-tab="create"> <span class="org-reports-all-card-title">'+tb_i18n.get("org.reports.all.tips.create")+'</span> <br> <span class="org-reports-all-num">'+e(t.counts["new"]||0)+'</span> </div> </section> </div> <div class="org-reports-ranks on-done row-flex"> ';if(t.ranks.done.length){i+=' <section class="org-reports-rank on-done"> <div class="org-reports-title">'+tb_i18n.get("org.reports.rank.tips.done")+'</div> <div class="org-reports-rank-list"> ';var n=t.ranks.done;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <div class="org-reports-rank-item"> <a class="org-reports-rank-member" data-id="'+e(r._id)+"\" data-gta=\"{action: 'open detail', type: 'org member', control: 'Complete Rank List'}\"> <span class=\"org-reports-rank-level\">"+(o+1)+'</span> <span class="avatar img-24 img-circle" style="background-image:url('+r.avatarUrl+')"></span> <span class="org-reports-rank-result">'+tb_i18n.get("org.reports.rank.tips.doneResult",r.name,r.count)+"</span> </a> </div> ";i+=" </div> </section> "}if(i+=" ",t.ranks.delay.length){i+=' <section class="org-reports-rank"> <div class="org-reports-title">'+tb_i18n.get("org.reports.rank.tips.delay")+'</div> <div class="org-reports-rank-list"> ';var a=t.ranks.delay;if(a)for(var r,o=-1,c=a.length-1;o<c;)r=a[o+=1],i+=' <div class="org-reports-rank-item on-delay"> <a class="org-reports-rank-member" data-id="'+e(r._id)+"\" data-gta=\"{action: 'open detail', type: 'org member', control: 'Overdue Rank List'}\"> <span class=\"org-reports-rank-level\">"+(o+1)+'</span> <span class="avatar img-24 img-circle" style="background-image:url('+r.avatarUrl+')"></span> <span class="org-reports-rank-result">'+tb_i18n.get("org.reports.rank.tips.delayResult",r.name,r.count)+"</span> </a> </div> ";i+=" </div> </section> "}return i+=' </div> <div class="org-reports-detail"> <div class="org-reports-tab-content hide" data-tab="states"> <div class="org-reports-title">'+tb_i18n.get("org.reports.states.tips.title")+'</div> <div class="org-reports-tab-list"></div> </div> <div class="org-reports-tab-content" data-tab="delay"> <div class="org-reports-title">'+tb_i18n.get("org.reports.tasks.tips.delay")+'</div> <div class="org-reports-tab-list"></div> </div> <div class="org-reports-tab-content" data-tab="done"> <div class="org-reports-title">'+tb_i18n.get("org.reports.tasks.tips.done")+'</div> <div class="org-reports-tab-list"></div> </div> </div></div>'}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="org-reports-member-tasks"> <div class="org-reports-member-tasks-header"> ';i+=t.executor?' <a class="org-reports-rank-member" data-id="'+e(t.executor._id)+'"> <span class="avatar img-24 img-circle pull-left" style="background-image:url('+t.executor.avatarUrl+')"></span> <span>'+t.executor.name+"</span> </a> ":' <a class="org-reports-rank-member"> <span class="avatar img-circle img-24 no-avatar"></span> </a> ',i+=" </div> <ul> ";var n=t.tasks;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],i+=' <li class="task ',r.isDone&&(i+="done"),i+='" data-id="'+r._id+"\" data-gta=\"{action: 'open detail', type: 'task', control: '"+t.control+'\'}"> <div class="check-box"> <span class="icon icon-tick"></span> </div> <div class="task-content-set"> <div class="task-content-wrapper"> <div class="task-content"> '+e(r.content)+" ",r.project&&r.project.name&&(i+=' <span class="task-tag">'+e(r.project.name)+"</span> "),i+=" </div> ",!r.isDone&&r.dueDate?(i+=' <time class="task-duedate label ',"overdue"===r.dueDate.dateClass?i+="label-important":"today"===r.dueDate.dateClass?i+="label-warning":"upcoming"===r.dueDate.dateClass&&(i+="label-info"),i+='"> <span class="icon icon-calendar2 ',"normal"!==r.dueDate.dateClass&&(i+="icon-white"),i+='"></span> ',i+="today"===r.dueDate.dateClass?" <span>"+r.dueDate.dateTimeString+"</span> ":" <span>"+r.dueDate.dateString+"</span> ",i+=" </time> "):r.isDone&&r.accomplished&&(i+=' <time class="task-accomplished-date"> '+r.accomplished.dateString+" </time> "),i+=" </div> </div> </li> ";return i+=" </ul></div>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_=function(t,e){return function(){return t.apply(e,arguments)}},j=function(t,e){function i(){this.constructor=t}for(var n in e)T.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},T={}.hasOwnProperty;k=i(358),w=i(678),a=i(401),y=i(788),c=i(699),f=i(696),o=i(976),l=i(1473),v=i(1474),u=i(1460),h=i(1329),p=i(1863),b=i(786),r=i(1877),s=i(1878),m=i(1879),d=i(1880),n=$(window),t.exports=g=function(t){function e(){return this.renderDividerTip=_(this.renderDividerTip,this),this.toggleArchivedOrganizationProjects=_(this.toggleArchivedOrganizationProjects,this),e.__super__.constructor.apply(this,arguments)}return j(e,t),e.prototype.viewName="ProjectsManagerView",e.prototype.className="projects-manager-view",e.prototype.projectArchivedContentShown=!1,e.prototype.events={"click .archived-project":"unarchiveOrganizationProject","click .archived-projects-toggler":"toggleArchivedOrganizationProjects","click .enter-project":"enterProject","click .btn-enter-project":"enterProject","click .btn-join-project":"joinProject","click .edit-handler":"editProject","click .btn-open-project-creator":"openProjectCreator","click .import-projects":"openProjectsImportTransfer","click .divider-move":"moveDivider","click .divider-remove":"removeDivider","click .divider-name":"editDividerTitle","click .filter-handler":"filterSection","click .sort-handler":"sortProjects","keydown .divider-input":"quickSubmit","blur .divider-input":"submitDividerTitle"},e.prototype.initialize=function(t){return this.options=null!=t?t:{},this.organization=this.options.organizationModel,this._organizationId=this.organization.id,this.showLoadingIndicator(),this.projectsArchivedCollection=f.get("archived_"+this._organizationId),this.currentSortBy="",f.fetchT(this.organization.id,{boundToObjectType:"organization"})(function(t){return function(e,i){return e?console.error(e):(t.projectsCollection=i,t.projectsCollection.each(function(t){return t.set("isOverdue",t.getPaymentPlan().isOverdue)}),t.hideLoadingIndicator(),t.renderBasic(),t.listen(),t.organization.hasPermission("put.dividers")?t.registerAsResponsive():void 0)}}(this))},e.prototype.layout=function(){var t,e;if(t=this.$(".project:eq(0)").width(),e=t<300?4:3,e!==this.ranks)return this.ranks=e,this.renderDividerTip(),this},e.prototype.listen=function(){return this.listenTo(this.projectsCollection,"add remove",this.renderBasic),this.listenTo(this.projectsArchivedCollection,"add remove",this.renderArchiveProjects),this.listenTo(this.projectsCollection,"change:name change:description change:logo change:_roleId",this.renderProject),this.listenTo(this.projectsArchivedCollection,"change:name change:description",this.renderProject),this.listenTo(this.projectsCollection,"change:isArchived",function(t,e){if(e)return this.projectsCollection.remove(t),this.projectsArchivedCollection.add(t)}),this.listenTo(this.projectsArchivedCollection,"change:isArchived",function(t,e){if(!e)return this.projectsArchivedCollection.remove(t),this.projectsCollection.add(t)}),this.listenTo(this.organization,"change:projectIds",this.renderBasic),this},e.prototype.renderBasic=function(){var t;return t={},t.roleScope=this.organization.getRoleScope(),t.permissions=this.organization.hasPermissions("put.transferIn"),t.isOverdue=this.organization.isOverdue(),t._organizationId=this._organizationId,t.myOwnProjectCount=f.get(0).getSelfOwnProjectCount(),0===this.projectsCollection.length?this.$el.html(this.requestSubView(p,{organization:this.organization,type:"project",header:{title:tb_i18n.get("organization.project.blank.title"),description:tb_i18n.get("organization.project.blank.description")}}).$el):(this.$el.html(r(t)),this.$projectMangerContent=this.$(".projects-manager-content"),this.$projectArchivedContent=this.$(".projects-archived-content"),this.renderProjects()),this},e.prototype.renderProjects=function(){var t,e;return this.$projectMangerContent.empty(),e=this.projectsCollection.models.slice(),t=this.organization.get("projectIds"),(null!=t?t.length:void 0)&&e.sort(function(e,i){return(t.indexOf(e.id)+1||999)-(t.indexOf(i.id)+1||999)}),k.each(e,function(t){return function(e){return t.renderProject(e)}}(this)),this.renderDivider(),this.organization.hasPermission("put.dividers")?(this.$el.addClass("divider-editable"),this.ranks=0,this.layout(),this.setupSortable(),this.renderProjectsFilter(),this):this},e.prototype.renderArchiveProjects=function(){return this.$projectArchivedContent.empty(),this.projectsArchivedCollection.each(function(t){return function(e){var i;return i=e.toJSON(),i.roleScope=e.getRoleScope(),i.permissions=e.hasPermissions("put.archive"),t.$projectArchivedContent.append(m(i))}}(this)),this},e.prototype.renderProjectsFilter=function(){return this.$el.find(".projects-filter").remove(),this.getPrjectsStatus(),this.$el.find(".projects-handler-set").append(d({sortBy:this.currentSortBy,dividers:this.projectsStatus.dividers})),this},e.prototype.renderProject=function(t){var e,i,n;return e=this.$projectMangerContent.find(".project[data-id="+t.id+"]"),n=t.toJSON(),n.roleScope=t.getRoleScope(),n.permissions=t.hasPermissions("put.archive"),n.visibility=t.get("visibility"),n._orgRoleId=this.organization.get("_roleId"),n.isOverdue=this.organization.isOverdue(),i=$(m(n)),e.length?e.replaceWith(i):n.isArchived!==!0&&i.appendTo(this.$projectMangerContent),this},e.prototype.loadArchivedOrganizationProjects=function(t){var e;return e=k.extend({success:function(){},beforeSend:function(){},error:function(){},attrs:{isArchived:!0,_organizationId:this._organizationId}},t),f.fetch("archived_"+this._organizationId,e)},e.prototype.toggleArchivedOrganizationProjects=function(t){return this.projectArchivedContentShown?(this.$projectArchivedContent.empty(),$(t.currentTarget).text(tb_i18n.get("show")),this.projectArchivedContentShown=!1,w.gta.event({action:"hide archived projects",control:"Title Link"})):($(t.currentTarget).text(tb_i18n.get("hide")),this.loadArchivedOrganizationProjects({success:function(t){return function(e){return t.renderArchiveProjects(),t.projectArchivedContentShown=!0}}(this)}),w.gta.event({action:"show archived projects",control:"Title Link"})),this},e.prototype.unarchiveOrganizationProject=function(t){var e;if(e=this.projectsArchivedCollection.get($(t.currentTarget).data("id")))return this.requestSubView(o,{title:tb_i18n.get("portal.unarchive.project.title"),description:tb_i18n.get("portal.unarchive.project.description"),onConfirm:function(){return w.gta.event({action:"unarchive content",type:"Project",control:"Project Cover"}),e.save(null,{attrs:{isArchived:!1},success:function(){return a.show({message:tb_i18n.get("portal.unarchive.success"),status:"success"})},error:function(t){return a.show({message:tb_i18n.get("portal.unarchive.error"),status:"error"})}})}})},e.prototype.setupSortable=function(){var t,e;return t=document.body,e=function(e){var i,r;if(i=e[0].getBoundingClientRect(),i.top<130){if(t.scrollTop<5)return;return t.scrollTop-=15}if(i.bottom+30>(r=n.height())){if(t.scrollTop>t.scrollHeight-r-5)return;return t.scrollTop+=15}},this.$projectMangerContent.sortable({items:".project, .divider-wrap",helper:"clone",cancel:".divider-wrap",placeholder:"project sortable-placeholder",tolerance:"pointer",zIndex:2001,scroll:!1,start:function(t){return function(){return t.$projectMangerContent.find(".divider-tip").hide()}}(this),stop:function(t){return function(){return t.$projectMangerContent.find(".divider-tip").show()}}(this),sort:function(t,i){return e(i.helper)},update:function(t){return function(e,i){var n;return t.renderDividerTip(),n=t.updatePosition(),t.saveSection("projectIds",n),t.saveSection("dividers",n),t.renderProjectsFilter()}}(this)}),this},e.prototype.openProjectsImportTransfer=function(){return this.requestSubView(b).open(v,{sourceId:0,targetIds:[this.organization.id]}),this},e.prototype.enterProject=function(t){var e;return e=$(t.currentTarget).data("id"),this._enterProject(e)},e.prototype._enterProject=function(t){var e;return w.gta.event(null,"click","projects - enter project"),e=this.projectsCollection.get(t),e.getPaymentPlan().isOverdue?this.requestSubView(b).open(l,{_organizationId:e.get("_organizationId"),projectModel:e}):w.router.navigate("project/"+t+"/"+e.getFirstApp(),{trigger:!0})},e.prototype.joinProject=function(t){var e,i,n;if(e=$(t.target),i=$(t.currentTarget).data("id"),e.html(tb_i18n.get("project.manager.joining")).addClass("hover"),n=this.projectsCollection.get(i))return n.join({success:function(t){return function(){return e.html(tb_i18n.get("project.manager.success.join")),n.set("_roleId",2),c.get(n.id).fetch(),f.get(0).add(n),setTimeout(function(){return t._enterProject(i)},1e3)}}(this)})},e.prototype.loadProjectMembers=function(t){return t=k.extend(t,{boundToObjectType:"project"}),c.fetch(t._projectId,t),this},e.prototype.editProject=function(t){var e,i;return e=$(t.currentTarget).closest(".project").data("id"),i=this.projectsCollection.get(e),new h({projectModel:i}),!1},e.prototype.openProjectCreator=function(t){var e,i;return e=this.$(t.target),i=e.data("id"),this.requestSubView(b).open(u,{_organizationId:i}),this},e.prototype.renderDivider=function(){var t,e,i;return this.projectsCollection.length?(t=this.organization.get("dividers")||[],i=this.organization.get("projectIds")||[],e=this.organization.hasPermissions("put.dividers"),k.each(t,function(n){return function(r,o){var a,c,l,p,u,d;for(l=function(t){var e;return e=i[t],n.$projectMangerContent.find(".project[data-id="+e+"]")},u=r.pos,p=(null!=(d=t[o+1])?d.pos:void 0)||i.length-1,c=l(u);!c.length&&++u<p;)c=l(u);return a=$(s({name:r.name,permissions:e})),a.addClass("divider-section"),c.length?a.insertBeforeH(c):e.putDividers?a.appendTo(n.$projectMangerContent):void 0}}(this)),this):this},e.prototype.renderDividerTip=function(){var t,e,i,n;return(null!=(n=this.projectsCollection)?n.length:void 0)?(this.$projectMangerContent.children(".divider-tip").remove(),e=0,i=this.organization.hasPermissions("put.dividers"),this.$projectMangerContent.children(".project").each(function(t){return function(n,r){var o,a;return a=$(r),a.prev(".divider-wrap").length?e=1:e++%t.ranks?void 0:(o=$(s({name:tb_i18n.get("project.create.section"),permissions:i})),o.addClass("divider-tip"),a.beforeH(o))}}(this)),this.$projectMangerContent.children().last().hasClass("divider-wrap")||(t=$(s({name:tb_i18n.get("project.create.section"),permissions:i})),t.addClass("divider-tip"),t.appendTo(this.$projectMangerContent)),this):this},e.prototype.moveDivider=function(t){var e,i,n,r,o;if(n=$(t.target),e=n.closest(".divider-wrap"),"up"===n.data("direction")){if(r=e.prevAll(".divider-section").first(),!r.length)return;i=e.nextUntil(".divider-section"),e.insertBeforeH(r),i.insertBefore(r)}else{if(r=e.nextAll(".divider-section").first(),!r.length)return;i=r.nextUntil(".divider-section"),r.insertBeforeH(e),i.insertBeforeH(e)}return o=this.updatePosition(),this.saveSection("projectIds",o),this.saveSection("dividers",o),this.renderProjectsFilter(),this.renderDividerTip()},e.prototype.getPrjectsStatus=function(){var t,e;return e={},t=[],this.$projectMangerContent.children().each(function(i){var n,r;return n=$(this),r=t.length-1,n.hasClass("project")?(e[r]||(e[r]=[]),e[r].push(n.data("id"))):n.hasClass("divider-section")?t.push({hidden:n.hasClass("hide"),name:n.find(".divider-name").text().trim()}):void 0}),this.projectsStatus={dividers:t,projects:e}},e.prototype.updatePosition=function(){var t,e,i;return i=[],e=[],t=0,this.$projectMangerContent.children().each(function(n){var r;if(r=$(this),!r.hasClass("divider-tip"))return r.hasClass("project")?(i.push(r.data("id")),t++):r.hasClass("divider-wrap")?e.push({pos:t,name:r.find(".divider-name").text().trim()}):void 0}),{dividers:e,projectIds:i}},e.prototype.saveSection=function(t,e){if(e=e[t],!k.isEqual(e,this.organization.get(t)))return this.organization.saveSection(t,e,{success:function(i){return function(){return i.organization.set(t,e,{silent:!0})}}(this)}),this},e.prototype.removeDivider=function(t){var e,i,n;return i=$(t.target),e=i.closest(".divider-wrap"),e.remove(),this.renderDividerTip(),n=this.updatePosition(),this.saveSection("projectIds",n),this.saveSection("dividers",n),this.renderProjectsFilter()},e.prototype.quickSubmit=function(t){if(13===t.keyCode)return this.submitDividerTitle(t)},e.prototype.submitDividerTitle=function(t){var e,i,n;if(i=$(t.target),e=i.closest(".divider-wrap"),e.removeClass("editing"),n=i.val().trim(),n&&n!==e.find(".divider-name").text())return e.removeClass("divider-tip").addClass("divider-section"),e.find(".divider-name").text(n),this.saveSection("dividers",this.updatePosition()),this.renderProjectsFilter()},e.prototype.editDividerTitle=function(t){var e,i,n;return this.organization.hasPermission("put.dividers")?(i=$(t.target),e=i.closest(".divider-wrap"),e.addClass("editing"),n=i.text(),n===tb_i18n.get("project.create.section")&&(n=""),e.find(".divider-input").val(n).focusAtEnd()):this},e.prototype.filterSection=function(t){var e,i,n;return t.stopPropagation(),e=$(t.currentTarget),e.toggleClass("selected"),i=e.hasClass("selected")?"removeClass":"addClass",n=e.data("index"),this.$projectMangerContent.children(".divider-section").eq(n)[i]("hide"),k.each(this.projectsStatus.projects[n],function(t){return function(e){return t.$projectMangerContent.find(".project[data-id="+e+"]")[i]("hide")}}(this)),w.gta.event(null,"click","organization|projects filter by section")},e.prototype.sortProjects=function(t){var e,i;return t.stopPropagation(),e=$(t.currentTarget),i=e.data("type"),i===this.currentSortBy?(this.currentSortBy="",e.removeClass("selected")):(this.currentSortBy=i,e.addClass("selected").siblings(".sort-handler").removeClass("selected")),k.each(this.projectsStatus.projects,function(t){return function(e){var i,n;if(e&&e.length>=2){switch(n=e[0],t.currentSortBy){case"name":e=e.slice(0).sort(function(e,i){var n,r;return e=null!=(n=t.projectsCollection.get(e))?n.get("name"):void 0,i=null!=(r=t.projectsCollection.get(i))?r.get("name"):void 0,e>i?1:e<i?-1:0})}return i=t.$projectMangerContent.find(".project[data-id="+e[0]+"]"),n!==e[0]&&i.insertBeforeH(t.$projectMangerContent.find(".project[data-id="+n+"]")),k.each(e.slice(1),function(e){var n;return n=t.$projectMangerContent.find(".project[data-id="+e+"]"),n.insertAfterH(i),i=n})}}}(this)),w.gta.event(null,"click","organization|projects order by "+this.currentSortBy)},e}(y)},function(t,e){t.exports=function(t){var e="";return t.roleScope>=0&&(e+='<div class="projects-manager-header"> <ol class="breadcrumbs"> <li> '+tb_i18n.get("projects.manager.all.project")+' </li> </ol> <div class="projects-handler-set pull-right"> ',t.permissions.putTransferIn&&t.myOwnProjectCount>0&&(e+=' <a class="import-projects" data-gta="{action: \'import org projects\', control: \'text link\'}"> <span class="icon icon-import-project"></span> '+tb_i18n.get("projects.import")+" </a> "),e+=" </div></div>"),e+='<div class="projects-manager-content clearfix"></div>',t.roleScope>0&&(e+=' <header class="projects-archived-header"> <div class="project-category-title"> '+tb_i18n.get("archived.projects")+'・ <a class="archived-projects-toggler">'+tb_i18n.get("show")+'</a> </div> <hr> </header> <div class="projects-archived-content clearfix"></div>'),e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<div class="divider-wrap"> <div class="divider-title divider-name" data-gta="{action: \'add org section\'}">'+e(t.name)+"</div> ";return t.permissions.putDividers&&(i+=' <div class="divider-title divider-title-editor"> <input type="text" class="form-control divider-input" placeholder="'+tb_i18n.get("project.section.name")+'"/> </div> <div class="divider-tools"> <a class="hinted icon icon-chevron-up divider-move" data-direction="up" data-title="'+tb_i18n.get("project.section.up")+'"></a> <a class="hinted icon icon-chevron-down divider-move" data-direction="down" data-title="'+tb_i18n.get("project.section.down")+'"></a> <a class="hinted icon icon-remove divider-remove" data-title="'+tb_i18n.get("project.section.remove")+'"></a> </div> '),i+="</div>"}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="";return t.isArchived?(i+=' <div class="project archived-project card pull-left hinted" data-title="'+e(t.name)+'" data-hinted-delay="1000" data-id="'+t._id+'" style="background-image:url('+t.logo+')"> <div class="project-info"> <h3 class="project-name">'+e(t.name)+'</h3> <p class="project-desc">'+e(t.description)+"</p> </div> ",t.permissions.putArchive&&(i+=' <a class="unarchive-project-handler"> <span class="icon icon-repeat"></span> </a> '),i+=" </div>"):(i+=' <div class="project ',(t.roleScope>-1||t.roleScope==-1&&2!=t._orgRoleId||t.roleScope==-1&&"organization"==t.visibility)&&(i+="enter-project"),i+=' card hinted" data-title="'+e(t.name)+'" data-hinted-delay="1000" style="background-image:url('+t.logo+')" data-id="'+t._id+'" data-gta="{action: \'open detail\', control: \'Project Cover\'}"> <div class="project-info"> <!--  项目中有权限 或者 组织中有权限（注意组织中的管理员，只能看到自己参与的项目） --> <a class="icon icon-pencil edit-handler" data-id="'+t._id+'" data-gta="event" data-label="organizaion projects||project settings"></a> <div> <h3 class="project-name">'+e(t.name)+'</h3> </div> <p class="project-desc">'+e(t.description)+"</p> ",t.roleScope<0&&2==t._orgRoleId&&(i+=' <div class="no-right-overlay"> <p> <span>'+tb_i18n.get("project.manager.not.member")+"</span> <br /> <br /> <a class='btn btn-primary btn-enter-project' data-id=\""+t._id+'">'+tb_i18n.get("project.manager.enter")+"</a> <a class='btn btn-primary btn-join-project' data-id=\""+t._id+'">'+tb_i18n.get("project.manager.join")+"</a> </p> </div> "),i+=" </div> ","all"==t.visibility?i+=' <span class="label visibility-label"><span class="icon icon-earth"></span>'+tb_i18n.get("public")+"</span> ":"organization"==t.visibility&&(i+=' <span class="label visibility-label"><span class="icon icon-building"></span>'+tb_i18n.get("organization.visible")+"</span> "),i+=" ",t.isOverdue&&(i+=' <div class="is-overdue"> <hr /> <div class="lock-wrap"> <span class="icon icon-lock"></span> </div> </div> '),i+=" </div>"),i}},function(t,e){t.exports=function(t){var e='<div class="projects-filter"> <a data-toggle="dropdown" data-gta="event" data-label="projects - filter and sort"> <span>'+tb_i18n.get("project.manager.filter")+'</span> <span class="icon icon-chevron-down"></span> </a> <ul class="dropdown-menu"> ',i=t.dividers;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <li class="filter-handler ',n.hidden||(e+="selected"),e+='" data-index="'+r+'"> <a>'+n.name+"</a> </li> ";return e+=" ",t.dividers.length&&(e+=' <li class="divider"></li> '),e+=' <li class="sort-handler ',"name"==t.sortBy&&(e+="selected"),e+='" data-type="name"> <a>'+tb_i18n.get("project.manager.sort.by.name")+"</a> </li> </ul></div>"}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_,j,T,M,C,x,S,I,z,P=function(t,e){return function(){return t.apply(e,arguments)}},D=function(t,e){function i(){this.constructor=t}for(var n in e)O.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},O={}.hasOwnProperty;S=i(358),z=i(678),I=i(679),g=i(429),C=i(788),M=i(677),l=i(425),y=i(697),u=i(699),_=i(797),c=i(1882),p=i(680),x=i(786),j=i(1884),v=i(1863),d=i(1194),a=i(1886),m=i(1887),h=i(1888),f=i(1889),k=i(1890),b=i(1891),w=i(1892),n=50,r=5,o=200,s=20,T=function(t){function e(){return this.searchItem=P(this.searchItem,this),e.__super__.constructor.apply(this,arguments)}return D(e,t),e.prototype.viewName="StatisticsView",e.prototype.className="statistics-view",e.prototype.events={"click .tab.projects":"projectsTab","click .tab.members":"membersTab","click .enter-project":"enterProject","click .enter-member":"showMemberOverall","click [role=menuitem]":"filter","input [type=search]":"search","focus [type=search]":"search","click [type=search]":"search","keydown [type=search]":"itemSelect","mousewheel .dropdown-menu":M.mousewheel},e.prototype.initialize=function(t){var e,i;if(t.organizationModel)return this.organization=t.organizationModel,e=g(this.organization.get("created")),i=g().subtract(7,"day"),this.tab=t.tab?t.tab:"project",this.updateUrl(),this.membersHasMore=this.projectsHasMore=!0,this.membersPage=this.projectsPage=1,this.setupScroll(),e.isAfter(i)?this.$el.html(this.requestSubView(v,{organization:this.organization,type:"statistics",header:{title:tb_i18n.get("organization.statistics.blank.title"),description:tb_i18n.get("organization.statistics.blank.description")}}).$el):(this.organization.fetchChartsData({success:function(t){return function(e){return t.renderCharts(e),t.organization.fetchGroupsData({success:function(e){return t.groupsData=S.filter(e,function(t){return"default"!==t.type}),t.enterTab()}})}}(this)}),this.organization.fetchProjects({success:function(t){return function(e){return t.projects=S.map(e,function(t){return{id:t._id,name:t.name,pinyin:t.pinyin,py:t.py,avatar:t.logo,type:"project"}})}}(this)}),this.organization.fetchMembers({success:function(t){return function(e){return t.members=S.map(e,function(t){return{id:t._id,name:t.name,pinyin:t.pinyin,py:t.py,avatar:t.avatarUrl,type:"member"}})}}(this)})),u.fetch(this.organization.id,{boundToObjectType:"organization",success:function(t){return function(e){return t.memberCollection=e;
}}(this)}),this},e.prototype.enterTab=function(){switch(this.tab){case"project":this.projectsTab();break;case"member":this.membersTab()}return this},e.prototype.projectsTab=function(){var t;return this.tab="project",this.projectsPage=1,this.projectType="delay",this.dividerIndex=-1,this.updateUrl(),null!=(t=this.statisticsSearchView)&&t.remove(),this.renderProjectsHeader(),this.renderProjectsData(),this.enableTheadFloating(),z.gta.event({action:"switch dashboard tab",type:"projects"}),this},e.prototype.membersTab=function(){var t;return this.tab="member",this.membersPage=1,this.memberType="delay",this.team="all",this.updateUrl(),null!=(t=this.statisticsSearchView)&&t.remove(),this.renderMembersHeader(),this.renderMembersData(),this.enableTheadFloating(),z.gta.event({action:"switch dashboard tab",type:"members"}),this},e.prototype.renderCharts=function(t){var e,i,n;return n=S.map(t.projectCounts,function(t){return t||(t=0)}),i=S.map(t.memberCounts,function(t){return t||(t=0)}),e=S.map(t.activenessCounts,function(t){return t||(t=0)}),t.projectsNow=n.slice(-1)[0],t.projectOffset=t.projectsNow-n.slice(-2)[0],t.projectIsRise=t.projectOffset>=0,t.projectOffset=Math.abs(t.projectOffset),t.membersNow=i.slice(-1)[0],t.memberOffset=t.membersNow-i.slice(-2)[0],t.memberIsRise=t.memberOffset>=0,t.memberOffset=Math.abs(t.memberOffset),t.activenessNow=e.slice(-1)[0],t.activenessOffset=t.activenessNow-e.slice(-2)[0],t.activenessIsRise=t.activenessOffset>=0,t.activenessOffset=Math.abs(t.activenessOffset),this.$el.html(a(t)),S.delay(function(r){return function(){return r.chartsData([{data:n,isRise:t.projectIsRise,getText:function(t){var e,i,o;return i=r.getDate(t.x,n.length),o=i[0],e=i[1],[""+o+tb_i18n.get("organization.statistics.year")+e+tb_i18n.get("organization.statistics.month"),t.y+" "+tb_i18n.get("organization.statistics.projectsAmount")]}},{data:i,isRise:t.memberIsRise,getText:function(t){var e,n,o;return n=r.getDate(t.x,i.length),o=n[0],e=n[1],[""+o+tb_i18n.get("organization.statistics.year")+e+tb_i18n.get("organization.statistics.month"),t.y+" "+tb_i18n.get("organization.statistics.membersAmount")]}},{data:e,isRise:t.activenessIsRise,getText:function(t){var i,n,o,s,a;return a=r.getPeriod(t.x,e.length),n=a[0],i=a[1],s=a[2],o=a[3],[""+n+tb_i18n.get("organization.statistics.monthShow")+i+(" ~ "+s+tb_i18n.get("organization.statistics.monthShow")+o),tb_i18n.get("organization.statistics.activeness")+" "+t.y]}}])}}(this),300),this},e.prototype.getDate=function(t,e){var i;return i=new g,i.subtract(e-t,"month"),[i.year(),i.month()+1]},e.prototype.getPeriod=function(t,e){var i,n,r;return i=new g,n=new g,r=e-t,i.startOf("week").subtract(7*(r+1),"day"),n.startOf("week").subtract(7*r+1,"day"),[i.month()+1,i.date(),n.month()+1,n.date()]},e.prototype.chartsData=function(t){return S.each(t,function(t){return function(e,i){var n,r,o,s,a,l;return n=S.map(e.data,function(t,e){return{x:e+1,y:t}}),o=2*S.max(e.data),e.isRise?(s="#7ed321",a="#c2ea93",l="#f4fbed"):(s="#efbb4d",a="#faec89",l="#fdf3e0"),r=c(n,{width:300,height:85,minY:0,maxY:o,stroke:s,strokeBegin:a,strokeEnd:l,getText:e.getText}),t.$(".chart").eq(i).html(r)}}(this)),this},e.prototype.renderMembersHeader=function(){return this.$(".statistics-content").html(m(this.groupsData)),this},e.prototype.renderMembersData=function(t,e){return t||(t={}),e||(e=!1),this.organization.fetchMembersData(t,{success:function(t){return function(i){if("member"===t.tab)return t.membersHasMore=i.hasMore,t.addExtraData(i,"member"),e?(t.$(".loading-indicator-wrap").empty(),t.showLoadingIndicator(t.$(".loading-indicator-wrap")),S.delay(function(){return t.hideLoadingIndicator(t.$(".loading-indicator-wrap")),t.$(".data-content tbody").append(f(i))},300)):(t.$(".statistics-table").html(""),t.showLoadingIndicator(t.$(".statistics-table")),S.delay(function(){return t.$(".statistics-table").html(h(i)),t.$(".data-content tbody").append(f(i))},300))}}(this)}),this},e.prototype.renderMemberData=function(t){return this.organization.fetchMember(t,{success:function(t){return function(e){return e={data:[e]},t.addExtraData(e,"member"),t.$(".data-content tbody").html(f(e))}}(this)})},e.prototype.renderProjectsHeader=function(){return this.$(".statistics-content").html(k(this.organization.get("dividers"))),this},e.prototype.renderProjectsData=function(t,e){return t||(t={}),e||(e=!1),this.organization.fetchProjectsData(t,{success:function(t){return function(i){if("project"===t.tab)return t.projectsHasMore=i.hasMore,t.addExtraData(i,"project"),e?(t.$(".loading-indicator-wrap").empty(),t.showLoadingIndicator(t.$(".loading-indicator-wrap")),S.delay(function(){return t.hideLoadingIndicator(t.$(".loading-indicator-wrap")),t.$(".data-content tbody").append(w(i))},300)):(t.$(".statistics-table").html(""),t.showLoadingIndicator(t.$(".statistics-table")),S.delay(function(){return t.$(".statistics-table").html(b(i)),t.$(".data-content tbody").append(w(i))},300))}}(this)}),this},e.prototype.renderProjectData=function(t){return this.organization.fetchProject(t,{success:function(t){return function(e){return e={data:[e]},t.addExtraData(e,"project"),t.$(".data-content tbody").html(w(e))}}(this)})},e.prototype.addExtraData=function(t,e){return S.each(t.data,function(t){var i,a,c,l,p,u,d;if(d=t.unworkingTasksCount+t.workingTasksCount+t.delayTasksCount){switch(l=Math.floor(t.unworkingTasksCount/d*100),p=Math.ceil(t.workingTasksCount/d*100),u=100-l-p,e){case"member":i=n,a=r;break;case"project":i=o,a=s}return c=d>=i?100:d>a?25+Math.floor(75*(d-a)/(i-a)):25,t.rate1=l+"%",t.rate2=p+"%",t.rate3=u+"%",t.barWidth=c+"%"}return t.barWidth=t.rate1=t.rate2=t.rate3="0%"}),this},e.prototype.enableTheadFloating=function(){return S.delay(function(t){return function(){var e;if(t.$el)return e=t.$(".table"),e.floatThead("destroy"),e.floatThead({position:"fixed",top:90})}}(this),600)},e.prototype.filter=function(t){var e,i,n,r,o,s;switch(t?(e=$(t.currentTarget),this.tab=e.data("tab")||this.tab,i=e.data("filter"),this.$("."+i+" .icon-tick").addClass("hide"),e.find(".icon-tick").removeClass("hide"),n=e.find(".filter-value").html().trim()):e=$("div"),this.tab){case"member":this.membersPage=1,this.memberType=e.data("type")||this.memberType,this.team=e.data("team")||this.team,r={},this.memberType&&(r.type=this.memberType),this.team&&(r.team=this.team),this.renderMembersData(r),e.data("type")&&this.$("#filter-member-type").html(n),e.data("team")&&this.$("#filter-member-team").html(n);break;case"project":this.projectsPage=1,this.projectType=e.data("type")||this.projectType,this.dividerIndex=(null!=(o=e.data("index"))?o.toString():void 0)||this.dividerIndex,r={},this.projectType&&(r.type=this.projectType),this.dividerIndex&&(r.divider_index=this.dividerIndex),this.renderProjectsData(r),(null!=(s=e.data("index"))?s.toString():void 0)&&this.$("#filter-project-divider").html(n),e.data("type")&&this.$("#filter-project-type").html(n)}return this},e.prototype.enterProject=function(t){var e,i;return e=$(t.currentTarget).data("id"),i=y.get(e),z.router.navigate("project/"+e+"/"+i.getFirstApp(),{trigger:!0})},e.prototype.showMemberOverall=function(t){var e,i;if(this.memberCollection)return e=$(t.currentTarget).data("id"),null!=(i=this.memberOverallView)&&i.remove(),this.memberOverallView=this.requestSubView(x).open(d,{memberModel:this.memberCollection.get(e),organizationModel:this.organization})},e.prototype.search=function(t){var e,i,n;if(e=$(t.currentTarget),i=e.val().trim().replace(/\/|\\/g,"")){switch(this.tab){case"member":n=this.keywordSearch(this.members,i);break;case"project":n=this.keywordSearch(this.projects,i)}this.membersHasMore=this.projectsHasMore=!1,this.renderSearch(n)}else this.closeSearch(),this.searched&&(this.filter(),this.searched=!1);return this},e.prototype.keywordSearch=function(t,e){var i,n;return i=new RegExp(e,"i"),n=S.filter(t,function(t){return i.test(t.name)||i.test(t.pinyin)||i.test(t.py)})},e.prototype.renderSearch=function(t){var e;return null!=(e=this.statisticsSearchView)&&e.remove(),this.statisticsSearchView=this.requestSubView(j,{hideDelay:0,$toggler:this.$("[type=search]"),set:t,searchItem:this.searchItem}).show(),this},e.prototype.searchItem=function(t,e){switch(this.closeSearch(),t){case"member":this.renderMemberData(e);break;case"project":this.renderProjectData(e)}return this.searched=!0,this},e.prototype.closeSearch=function(){var t;return null!=(t=this.statisticsSearchView)&&t.remove(),this},e.prototype.loadMore=function(t){var e;switch("function"==typeof t&&t(),this.tab){case"member":if(!this.membersHasMore)return;e={},this.memberType&&(e.type=this.memberType),this.team&&(e.team=this.team),e.page=++this.membersPage,this.renderMembersData(e,!0);break;case"project":if(!this.projectsHasMore)return;e={},this.projectType&&(e.type=this.projectType),this.dividerIndex&&(e.index=this.dividerIndex),e.page=++this.projectsPage,this.renderProjectsData(e,!0)}return this},e.prototype.itemSelect=function(t){var e,i;if(!(null!=(e=this.statisticsSearchView)?e.$el:void 0))return this;switch(13!==(i=t.keyCode)&&38!==i&&40!==i||t.preventDefault(),t.keyCode){case 13:this.statisticsSearchView.getSelected().click();break;case 38:this.statisticsSearchView.selectSwitch("up");break;case 40:this.statisticsSearchView.selectSwitch("down")}return this},e.prototype.updateUrl=function(){var t;return t="/organization/"+this.organization.id+"/statistics/"+this.tab,z.router.navigate(t,{trigger:!1}),this},e.prototype.remove=function(){return e.__super__.remove.apply(this,arguments)},e}(C),S.extend(T.prototype,_),t.exports=T},function(t,e,i){var n,r,o,s;n=i(358),s=i(1883),r=i(364),o={width:260,height:150,minX:null,maxX:null,minY:null,maxY:null,stroke:"#7ed321",strokeBegin:"#7ed321",strokeEnd:"white",threshold:15,getText:null,fontSize:11,rectWidth:94,lineHeight:1.5},t.exports=function(t,e){var i,a,c,l,p,u,d,h,m,f,g,v,y;return e=n.extend({},o,e),null==e.minX&&(e.minX=r.min(t,function(t){return t.x})),null==e.minY&&(e.minY=r.min(t,function(t){return t.y})),null==e.maxX&&(e.maxX=r.max(t,function(t){return t.x})),null==e.maxY&&(e.maxY=r.max(t,function(t){return t.y})),g=s.newSVG().attr({"class":"d3chart",width:e.width,height:e.height}),l=s.getId(),c="d3chart-fill-"+l,h="d3chart-shadow-"+l,s.addShadowFilter(g,h),s.addLinearGradient(g,c,e.strokeBegin,e.strokeEnd),v=r.scale.linear().domain([e.minX,e.maxX]).range([0,e.width]),y=r.scale.linear().domain([e.minY,e.maxY]).range([e.height,0]),t=n.map(t,function(t,e){return{x:t.x,y:t.y,dx:v(t.x),dy:y(t.y),index:e}}),u={line:{},area:{}},p=r.svg.line().x(function(t){return t.dx}).y(function(t){return t.dy}).interpolate("monotone"),u.line.el=g.append("path").attr({"class":"d3chart-line",stroke:e.stroke,d:p(t)}),i=r.svg.area().x(function(t){return t.dx}).y0(e.height).y1(function(t){return t.dy}).interpolate("monotone"),u.area.el=g.append("path").attr({"class":"d3chart-area",d:i(t)}).style("fill","url(#"+c+")"),a={show:function(){if(this.hidden)return this.hidden=!1,this.circle.wrap.style("display","block"),this.tips.wrap.style("display","block")},hide:function(){if(!(this.hidden||u.line.hovered||u.area.hovered))return this.hidden=!0,this.circle.wrap.style("display","none"),this.tips.wrap.style("display","none")},circle:{wrap:g.append("g").attr("class","d3chart-circle")},tips:{wrap:g.append("g").attr("class","d3chart-text")}},a.circle.el=function(){var t;return t=a.circle.wrap,t.append("circle").attr({"class":"d3chart-outer-circle",r:3}).style("filter","url(#"+h+")"),t.append("circle").attr({"class":"d3chart-inner-circle",r:1,fill:e.stroke}),t.selectAll("circle")}(),a.tips.rect=a.tips.wrap.append("rect").style("filter","url(#"+h+")").attr({width:e.rectWidth,rx:5,ry:5}),a.hide(),m=function(t){var e;return e=a.circle.el,e.attr({cx:t.dx,cy:t.dy})},f=function(t){var i,n,r,o,c;return i=("function"==typeof e.getText?e.getText(t):void 0)||[t.y],n=e.fontSize*(e.lineHeight*(i.length+1)-1),a.tips.rect.attr("height",n),o=s.ensureRange(t.dx-5,0,e.width-e.rectWidth),c=s.ensureRange(t.dy-n-10,0,e.height-n),r=a.tips.wrap,r.attr("transform","translate("+o+","+c+")"),r.selectAll("text").remove(),r.selectAll("text").data(i).enter().append("text").attr({x:.5*e.fontSize,y:function(t,i){return e.fontSize*e.lineHeight*(i+1)},"font-size":e.fontSize}).text(function(t){return t})},d=function(){var i,o;return o=r.event.offsetX,i=n.reduce(t,function(t,i){var n;return n=Math.abs(i.dx-o),n<e.threshold&&(null==t.delta||t.delta>n)&&(t.delta=n,t.d=i),t},{}),i.d?(m(i.d),f(i.d),a.show()):a.hide()},u.line.el.on("mousemove",function(){return u.line.hovered=!0,d()}).on("mouseleave",function(){return u.line.hovered=!1,a.hide()}),u.area.el.on("mousemove",function(){return u.area.hovered=!0,d()}).on("mouseleave",function(){return u.area.hovered=!1,a.hide()}),g[0][0]}},function(t,e,i){var n,r,o,s,a,c,l,p,u;c=i(364),r=0,n=document.createDocumentFragment(),p=function(){return r+=1},l=function(t,e,i){return null!==i&&t>i&&(t=i),null!==e&&t<e&&(t=e),t},u=function(){return c.select(n).append("svg").remove()},o=function(t,e){return t.append("defs").append("clipPath").attr("id",e)},a=function(t,e,i){var n,r;return null==i&&(i=[.5,.5,.5,1]),r=t.append("defs").append("filter").attr({id:e,width:1.4,height:1.4,x:-.2,y:-.1}),r.append("feColorMatrix").attr({type:"matrix",values:"0 0 0 "+i[0]+" 0 "+("0 0 0 "+i[1]+" 0 ")+("0 0 0 "+i[2]+" 0 ")+("0 0 0 "+i[3]+" 0 ")}),r.append("feGaussianBlur").attr({stdDeviation:1,result:"blur"}),r.append("feOffset").attr({"in":"blur",dx:0,dy:1,result:"offsetBlur"}),n=r.append("feMerge"),n.append("feMergeNode").attr("in","offsetBlur"),n.append("feMergeNode").attr("in","SourceGraphic")},s=function(t,e,i,n){var r;return null==n&&(n="white"),r=t.append("defs").append("linearGradient").attr({id:e,x1:0,y1:-.5,x2:0,y2:1}),r.append("stop").attr("offset",0).style("stop-color",i),r.append("stop").attr("offset",1).style("stop-color",n)},t.exports={getId:p,ensureRange:l,newSVG:u,addClipPath:o,addShadowFilter:a,addLinearGradient:s}},function(t,e,i){var n,r,o,s,a,c,l=function(t,e){function i(){this.constructor=t}for(var n in e)p.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},p={}.hasOwnProperty;c=i(358),a=i(677),o=i(797),r=i(813),n=i(1885),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.viewName="StatisticsSearchView",e.prototype.className="statistics-search-result-view",e.prototype.popoverTitle="Menu",e.prototype.width=200,e.prototype.placement="auto bottom",e.prototype.hotkeys={esc:function(t){var e;return t.preventDefault(),null!=(e=this.$popover)&&e.parent().trigger("click"),this.hide()}},e.prototype.events={"click .search-result-item":"searchItem",mousewheel:a.mousewheel},e.prototype.initialize=function(t){if(null!=t?t.set:void 0)return this.set=t.set,e.__super__.initialize.apply(this,arguments),this},e.prototype.render=function(){return this.$el.html(n(this.set)),this.setupScroll(this.$(".search-item")),this},e.prototype.searchItem=function(t){var e,i,n;return e=$(t.currentTarget),n=e.data("type"),i=e.data("id"),this.options.searchItem(n,i)},e.prototype.selectSwitch=function(t){var e,i,n,r,o;if(this.$items||(this.$items=this.$(".search-result-item")),!this.$items.length)return this;switch(e=this.$items.filter(".active"),t){case"up":o=e.removeClass("active").prev(),n=this.$items.filter("li:last"),o.length>0?o.addClass("active"):n.addClass("active");break;case"down":r=e.removeClass("active").next(),i=this.$items.filter("li:first"),r.length>0?r.addClass("active"):i.addClass("active")}return this.slideTo(this.$items.filter(".active"))},e.prototype.getSelected=function(){return this.$(".search-result-item.active")},e}(r),c.extend(s.prototype,o),t.exports=s},function(t,e){t.exports=function(t){var e='<div class="result-hint text-center"> ';e+=t.length?"<span>"+t.length+tb_i18n.get("organization.statistics.count")+"</span>":"<span>"+tb_i18n.get("organization.statistics.none")+"</span>",e+="<span>"+tb_i18n.get("organization.statistics.searchResult")+'</span></div><ul class="search-item thin-scroll"> ';var i=t;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <li data-type="'+n.type+'" data-id='+n.id+' class="search-result-item ',0==r&&(e+="active"),e+='"> <div style="background-image:url('+n.avatar+')" class="',"project"==n.type&&(e+="project-logo"),e+=' avatar pull-left"></div> <p class="title">'+n.name+"</p> </li> ";return e+="</ul>"}},function(t,e){t.exports=function(t){var e='<div class="dashboards-charts"> <div class="data-card"> <p class="title">'+tb_i18n.get("organization.statistics.chartProjects")+'</p> <p class="data"> <span class="value">'+(t.projectsNow||0)+'</span> <span class="flag arrow ';return t.projectIsRise&&(e+="arrow-up green"),e+=' icon icon-caret"></span>&nbsp; <span class="flag ',t.projectIsRise&&(e+="green"),e+='">'+t.projectOffset+'</span> </p> <div class="chart"></div> </div> <div class="data-card"> <p class="title">'+tb_i18n.get("organization.statistics.chartMembers")+'</p> <p class="data"> <span class="value">'+(t.membersNow||0)+'</span> <span class="flag arrow ',t.memberIsRise&&(e+="arrow-up green"),e+=' icon icon-caret"></span>&nbsp; <span class="flag ',t.memberIsRise&&(e+="green"),e+='">'+t.memberOffset+'</span> </p> <div class="chart"></div> </div> <div class="data-card"> <p class="title"> <span>'+tb_i18n.get("organization.statistics.weeklyActiveness")+'</span>&nbsp; <span class="icon icon-help hinted" data-title="'+tb_i18n.get("organization.statistics.weeklyActiveness.hint")+'"></span> </p> <p class="data"> <span class="value">'+(t.activenessNow||0)+'</span> <span class="flag arrow ',t.activenessIsRise&&(e+="arrow-up green"),e+=' icon icon-caret"></span>&nbsp; <span class="flag ',t.activenessIsRise&&(e+="green"),e+='">'+t.activenessOffset+'</span> </p> <div class="chart"></div> </div></div><div class="statistics-content"></div>'}},function(t,e){t.exports=function(t){var e='<div class="header clearfix"> <div class="pull-left tabs"> <a class="item tab projects">'+tb_i18n.get("organization.statistics.projecttab.title")+'</a> <a class="item tab members active">'+tb_i18n.get("organization.statistics.membertab.title")+'</a> </div> <div class="pull-right"> <div class="dropdown item filter"> <a class="dropdown-toggle" id="filter-team" data-toggle="dropdown" data-gta="{action: \'filter dashboards\', type: \'members\'}"> <span id="filter-member-team">'+tb_i18n.get("organization.statistics.membertab.all")+'</span>&nbsp; <span class="icon icon-chevron-down"></span> </a> <ul class="dropdown-menu member-team thin-scroll" aria-labelledby="members-filter1" role="menu"> <li> <a role="menuitem" tabindex="-1" data-team="all" data-tab="member" data-filter="member-team"> <span class="filter-value">'+tb_i18n.get("organization.statistics.membertab.all")+'</span> <span class="icon icon-tick"></span> </a> </li> <li> <a role="menuitem" tabindex="-1" data-team="new" data-tab="member" data-filter="member-team"> <span class="filter-value">'+tb_i18n.get("organization.statistics.membertab.new")+'</span> <span class="icon icon-tick hide"></span> </a> </li> ',i=t;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <li> <a role="menuitem" tabindex="-1" data-team='+n._id+' data-tab="member" data-filter="member-team"> <span class="filter-value">'+n.name+'</span> <span class="icon icon-tick hide"></span> </a> </li> ';return e+=' </ul> </div> <div class="dropdown item filter"> <a class="dropdown-toggle" id="filter-type" data-toggle="dropdown" data-gta="{action: \'sort dashboards\', type: \'members\'}"> <span id="filter-member-type">'+tb_i18n.get("organization.statistics.membertab.byDelayRate")+"</span>"+tb_i18n.get("organization.statistics.sorting")+'&nbsp; <span class="icon icon-chevron-down"></span> </a> <ul class="dropdown-menu member-type thin-scroll" aria-labelledby="filter-type" role="menu"> <li> <a role="menuitem" tabindex="-1" data-type="delay" data-tab="member" data-filter="member-type"> <span class="filter-value">'+tb_i18n.get("organization.statistics.membertab.byDelayRate")+'</span> <span class="icon icon-tick"></span> </a> </li> <li> <a role="menuitem" tabindex="-1" data-type="done" data-tab="member" data-filter="member-type"> <span class="filter-value">'+tb_i18n.get("organization.statistics.membertab.byDoneRate")+'</span> <span class="icon icon-tick hide"></span> </a> </li> </ul> </div> <div class="item search"> <span class="icon icon-search"></span> <input class="form-control search-input" type="search" data-target="member" placeholder="'+tb_i18n.get("organization.statistics.searchMember")+'"> </div> </div></div><div class="statistics-table"></div>'}},function(t,e){t.exports=function(t){var e='<div class="data-content"> ';return e+=t.data.length?' <table class="table"> <thead> <tr> <td>'+tb_i18n.get("organization.statistics.membertab.name")+"</td> <td>"+tb_i18n.get("organization.statistics.membertab.projectsJoined")+"</td> <td>"+tb_i18n.get("organization.statistics.membertab.done.undo")+"</td> <td>"+tb_i18n.get("organization.statistics.membertab.undergoing")+"</td> </tr> </thead> <tbody></tbody> </table> ":' <p class="empty-hint">'+tb_i18n.get("organization.statistics.membertab.noContent")+"</p> ",e+=' <div class="loading-indicator-wrap"></div></div>'}},function(t,e){t.exports=function(t){var e="",i=t.data;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <tr class="enter-member" data-id='+n._id+" data-gta=\"{action: 'open detail', type: 'org member', control: 'Dashboards List'}\"> <td> <div class=\"avatar img-circle member-avatar pull-left\" style=\"background-image:url("+n.avatarUrl+')"></div> <p> <span class="name">'+n.name+"</span> ",n.isNew&&(e+='<span class="icon icon-new"></span>'),e+=" </p> </td> <td>"+(n.projectsCount||0)+"</td> <td>"+(n.doneTasksCount||0)+"/"+(n.totalTasksCount||0)+"</td> <td> ",e+="0%"!=n.barWidth?' <div class="task-bar"> <div class="progress task-progress" style="width:'+n.barWidth+'"> <div class="progress-bar undergoing hinted" data-title="'+tb_i18n.get("organization.statistics.undergoing")+": "+n.unworkingTasksCount+'" style="width:'+n.rate1+'"></div> <div class="progress-bar deadline hinted" data-title="'+tb_i18n.get("organization.statistics.going")+": "+n.workingTasksCount+'" style="width:'+n.rate2+'"></div> <div class="progress-bar undo hinted" data-title="'+tb_i18n.get("organization.statistics.overdue")+": "+n.delayTasksCount+'" style="width:'+n.rate3+'"></div> </div> </div> ':" 0 ",e+=" </td> </tr>";return e}},function(t,e){t.exports=function(t){var e='<div class="header"> <div class="pull-left tabs"> <a class="item tab projects active">'+tb_i18n.get("organization.statistics.projecttab.title")+'</a> <a class="item tab members">'+tb_i18n.get("organization.statistics.membertab.title")+'</a> </div> <div class="pull-right"> <div class="dropdown item filter"> <a class="dropdown-toggle" id="filter-divider" data-toggle="dropdown" data-gta="{action: \'filter dashboards\', type: \'projects\'}"> <span id="filter-project-divider">'+tb_i18n.get("organization.statistics.projecttab.all")+'</span>&nbsp; <span class="icon icon-chevron-down"></span> </a> <ul class="dropdown-menu project-divider thin-scroll" aria-labelledby="filter-divider" role="menu"> <li> <a role="menuitem" tabindex="-1" data-index="-1" data-tab="project" data-filter="project-divider"> <span class="filter-value">'+tb_i18n.get("organization.statistics.projecttab.all")+'</span> <span class="icon icon-tick"></span> </a> </li> ',i=t;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <li> <a role="menuitem" tabindex="-1" data-index="'+r+'" data-tab="project" data-filter="project-divider"> <span class="filter-value">'+n.name+'</span> <span class="icon icon-tick hide"></span> </a> </li> ';return e+=' </ul> </div> <div class="dropdown item filter"> <a class="dropdown-toggle" id="filter-type" data-toggle="dropdown" data-gta="{action: \'sort dashboards\', type: \'projects\'}"> <span id="filter-project-type">'+tb_i18n.get("organization.statistics.projecttab.byDelayRate")+"</span>"+tb_i18n.get("organization.statistics.sorting")+'&nbsp; <span class="icon icon-chevron-down"></span> </a> <ul class="dropdown-menu project-type thin-scroll" aria-labelledby="filter-type" role="menu"> <li> <a role="menuitem" tabindex="-1" data-type="delay" data-tab="project" data-filter="project-type"> <span class="filter-value">'+tb_i18n.get("organization.statistics.projecttab.byDelayRate")+'</span> <span class="icon icon-tick"></span> </a> </li> <li> <a role="menuitem" tabindex="-1" data-type="done" data-tab="project" data-filter="project-type"> <span class="filter-value">'+tb_i18n.get("organization.statistics.projecttab.byDoneRate")+'</span> <span class="icon icon-tick hide"></span> </a> </li> <li> <a role="menuitem" tabindex="-1" data-type="activeness" data-tab="project" data-filter="project-type"> <span class="filter-value">'+tb_i18n.get("organization.statistics.projecttab.byActiveness")+'</span> <span class="icon icon-tick hide"></span> </a> </li> </ul> </div> <div class="item search"> <span class="icon icon-search"></span> <input class="form-control search-input" type="search" data-target="project" placeholder="'+tb_i18n.get("organization.statistics.searchProject")+'"> </div> </div></div><div class="statistics-table"></div>'}},function(t,e){t.exports=function(t){var e='<div class="data-content"> ';return e+=t.data.length?' <table class="table"> <thead> <tr> <td>'+tb_i18n.get("organization.statistics.projecttab.project")+"</td> <td>"+tb_i18n.get("organization.statistics.projecttab.member")+"</td> <td> <span>"+tb_i18n.get("organization.statistics.projecttab.weeklyActiveness")+'</span>&nbsp; <span class="icon icon-help hinted" data-title="'+tb_i18n.get("organization.statistics.projecttab.weeklyActivenessHint")+'"></span> </td> <td>'+tb_i18n.get("organization.statistics.projecttab.doneUndo")+"</td> <td>"+tb_i18n.get("organization.statistics.projecttab.undergoings")+"</td> </tr> </thead> <tbody></tbody> </table> ":' <p class="empty-hint">'+tb_i18n.get("organization.statistics.projecttab.noContent")+"</p> ",e+=' <div class="loading-indicator-wrap"></div></div>'}},function(t,e){t.exports=function(t){var e="",i=t.data;if(i)for(var n,r=-1,o=i.length-1;r<o;)n=i[r+=1],e+=' <tr> <td class="enter-project" data-id='+n._id+" data-gta=\"{action: 'open detail', type: 'project', control: 'Dashboards List'}\"> <div style=\"background-image:url("+n.logo+')" class="project pull-left"></div> <p><span class="name">'+n.name+"</span></p> </td> <td>"+(n.membersCount||0)+"</td> <td>"+(n.activeness||0)+"</td> <td>"+(n.doneTasksCount||0)+"/"+(n.totalTasksCount||0)+"</td> <td> ",e+="0%"!=n.barWidth?' <div class="task-bar"> <div class="progress task-progress" style="width:'+n.barWidth+'"> <div class="progress-bar undergoing hinted" data-title="'+tb_i18n.get("organization.statistics.undergoing")+": "+n.unworkingTasksCount+'" style="width:'+n.rate1+'"></div> <div class="progress-bar deadline hinted" data-title="'+tb_i18n.get("organization.statistics.going")+": "+n.workingTasksCount+'" style="width:'+n.rate2+'"></div> <div class="progress-bar undo hinted" data-title="'+tb_i18n.get("organization.statistics.overdue")+": "+n.delayTasksCount+'" style="width:'+n.rate3+'"></div> </div> </div> ':" 0 ",e+=" </td> </tr>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p=function(t,e){function i(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;i(1894),c=i(678),r=i(401),s=i(788),l=i(1739),a=i(1740),n=i(1896),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.viewName="OrganizationPluginView",e.prototype.className="organization-plugin-view",e.prototype.initialize=function(t){return this.organizationModel=t.organizationModel,this.pluginModel=a.getBy("organization").get(t._pluginId),this.isOrgPlugin()?this.render().listen():c.router.navigate("/organization/"+this.organizationModel.id+"/projects",{trigger:!0})},e.prototype.listen=function(){return this.listenTo(this.pluginModel,"remove",function(){return r.log(tb_i18n.get("project.app.plugin.remove.essage")),c.router.navigate("/organization/"+this.organizationModel.id+"/projects",{trigger:!0})})},e.prototype.isOrgPlugin=function(){var t;return!!this.pluginModel&&(t=this.pluginModel.toJSON(),"iframe"===t.mode&&"app_for_organization"===t.consumer.appType)},e.prototype.render=function(){var t;return t=l.replaceMark(this.pluginModel.get("url"),this.organizationModel.toJSON()),this.$el.html(n({link:t})),this},e}(s)},function(t,e){},,function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<iframe class="organization-iframe" src="'+e(t.link)+'" frameBorder="none"></iframe>';return i}},function(t,e){t.exports=function(t){var e="<!-- DO NOT REMOVE tb_i18n.get('organization.nav.projects') tb_i18n.get('organization.nav.members') tb_i18n.get('organization.nav.reports') tb_i18n.get('organization.nav.statistics') tb_i18n.get('setting')-->",i=[{type:"projects",gta:"projects",locale:"organization.nav.projects"},{type:"members",gta:"members",locale:"organization.nav.members"},{type:"reports",gta:"reports",locale:"organization.nav.reports",isPrivate:!0},{type:"statistics",gta:"dashboards",locale:"organization.nav.statistics",isPrivate:!0},{type:"setting",gta:"settings",locale:"setting",isPrivate:!0}];e+='<div class="organization-header flex"><div class="org-name-wrap flex-space flex flex-vcenter"> <p class="org-name hinted" data-title="'+t.name+'">'+t.name+'</p></div><div class="organization-nav sub-nav"> <ul class="nav nav-underscore"> ';var n=i;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],e+=" ",(!r.isPrivate||r.isPrivate&&t.roleScope>=0)&&(e+=' <li class="organization-nav-'+r.type+'"> <a data-tab-name="'+r.type+'" data-gta="{action: \'Enter org '+r.gta+"'}\"> "+tb_i18n.get(r.locale)+" </a> </li> "),e+=" ";return e+=' </ul></div><div class="plan-tips-wrap flex-space flex flex-end flex-vcenter"></div></div><div class="organization-content organization-wrap clearfix"><div class="organization-tab-content"></div></div>'}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<a class="plan-tips bg-primary text-center" href="'+e(t.payUrl)+'" target="_blank" data-gta="event" data-label="org - payments"> '+t.expireHint+", "+t.payHint+"</a>";return i}},function(t,e,i){var n,r,o,s,a,c;s=i(358),n=[{type:"plugin_for_tasklist",mode:"api"},{type:"plugin_for_project",mode:"redirect"},{type:"plugin_for_stage",mode:"iframe"},{type:"plugin_for_task",mode:"iframe"},{type:"plugin_for_bookkeeping",mode:"iframe"},{type:"plugin_for_entry",mode:"iframe"},{type:"plugin_for_event",mode:"iframe"},{type:"plugin_for_work",mode:"iframe"},{type:"plugin_for_post",mode:"redirect"},{type:"app_for_project",mode:"iframe"}],r=[{type:"app_for_me",mode:"iframe"}],o=[{type:"app_for_organization",mode:"iframe"}],e.appsForProject=function(t){return a(t,n)},e.appsForMe=function(t){return a(t,r)},e.appsForOrganization=function(t){return a(t,o)},a=function(t,e){var i,n;return i=c(e,"one"),n=c(e,"two"),console.log("同步注册第一组插件"),t.add(i),s.delay(function(){return console.log("5s后 异步注册第二组插件"),t.add(n)},5e3),s.delay(function(){return console.log("10s后 异步移除第一组插件"),t.remove(i)},1e4)},c=function(t,e){return s.map(t,function(t,i){return{_id:e+"_"+i,_consumerId:"541abd1931e521443c95cf2d",_projectId:"56306505936ffdcfabf14032",_creatorId:"55c060cab7988742626e5a06",url:"http://www.baidu.com",mode:t.mode,avatarUrl:"http://account.project.ci/my/static/images/apps/default.png",
consumer:{name:e,appType:t.type}}})}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<iframe class="app-iframe" src="'+e(t.link)+'" frameBorder="none"></iframe>';return i}},function(t,e){t.exports=function(t){var e='<div class="project-app-navigation"></div><div class="project-app-content row-flex"> <header></header> <section></section> <footer></footer></div>';return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w,_=function(t,e){return function(){return t.apply(e,arguments)}},j=function(t,e){function i(){this.constructor=t}for(var n in e)T.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},T={}.hasOwnProperty;b=i(358),w=i(678),g=i(677),k=i(679),v=i(788),a=i(401),p=i(684),f=i(696),c=i(699),o=i(976),l=i(1473),d=i(1460),h=i(1329),y=i(786),r=i(1903),s=i(1904),m=i(1905),n=i(1906),t.exports=u=function(t){function e(){return this.toggleArchivedProjects=_(this.toggleArchivedProjects,this),e.__super__.constructor.apply(this,arguments)}return j(e,t),e.prototype.viewName="PortalView",e.prototype.className="portal-view fade",e.prototype.archivedProjectsShown=!1,e.prototype.events={"click .active-project":"enterProject","click .archived-project":"unarchiveProject","click .edit-handler":"editProject","click .flag-handler":"flagProject","click .navigate-to-organization-handler":"navigateToOrganization","click .archived-projects-toggler":"toggleArchivedProjects","click .create-project-handler":"openProjectCreator"},e.prototype.initialize=function(){return this.projectsCollection=f.get(0),this.projectsArchivedCollection=f.get("archived_0"),this.organizationsCollection=p.get(0),this.renderBasic(),this.renderContent(),this.listen(),this.setupPlaceholder(this.projectsCollection,"project"),b.delay(function(t){return function(){if(t.$el)return t.$el.addClass("in")}}(this),100),b.delay(function(){return $("#navigator .projects-handler").addClass("active")}),this},e.prototype.listen=function(){return this.listenTo(this.projectsCollection,"add remove",this.renderContent),this.listenTo(this.projectsArchivedCollection,"add remove",function(t){return function(){if(t.archivedProjectsShown)return t.renderArchiveProjects()}}(this)),this.listenTo(this.projectsCollection,"change",this.refreshProject),this.listenTo(this.projectsCollection,"change:isArchived",function(t){return function(e,i){if(i)return t.projectsCollection.remove(e),t.projectsArchivedCollection.add(e)}}(this)),this.listenTo(this.projectsArchivedCollection,"change:isArchived",function(t){return function(e,i){if(!i)return t.projectsArchivedCollection.remove(e),t.projectsCollection.add(e)}}(this)),this.listenTo(this.projectsCollection,"change:_organizationId change:plan",function(t){return function(){return t.renderBasic(),t.renderContent()}}(this)),this.listenTo(this.organizationsCollection,"add remove",function(t){return function(){return t.renderBasic(),t.renderContent()}}(this)),this},e.prototype.renderBasic=function(){var t;return t=this.assembleData(),this.$el.html(r(t)),this.$projects=this.$(".projects:not(.archived-projects):not(.flagged-projects)"),this.$projectArchivedContent=this.$(".archived-projects"),this.$flaggedProjects=this.$(".flagged-projects"),this},e.prototype.renderContent=function(){var t;return t=this.assembleData(),this.renderProjects(t),this.checkFlagged(),this.checkOrganizationProjects(),this},e.prototype.assembleData=function(){var t,e;return t=[],e=this.projectsCollection.groupBy(function(t){return function(e){var i;return i=e.get("_organizationId"),i&&!t.organizationsCollection.get(i)&&e.get("organization")&&t.organizationsCollection.add(e.get("organization")),i||null}}(this)),this.organizationsCollection.each(function(i){var n,r;return n=i.toJSON(),n.isOverdue=i.isOverdue(),n.projects=e[i.id]||[],n.permissions=i.hasPermissions("get.info"),n.plan=i.getPaymentPlan(),r=i.get("projectIds"),r&&n.projects.sort(function(t,e){return(r.indexOf(t.id)+1||999)-(r.indexOf(e.id)+1||999)}),t.push(n)}),t=b.sortBy(t,function(t){return t.name}),t.unshift({_id:"null",projects:e["null"]}),t},e.prototype.renderProjects=function(t){var e,i;return this.$projects.empty(),i=this.projectsCollection.getSelfProjectCount(),e=w.user.get("_id"),b.each(t,function(t){return function(i){var r,o,s,a,l;if(a=b.sortBy(i.projects,function(t){return t.getPaymentPlan().isOverdue}),b.each(a,function(i){var n,r,o;if(n=i.get("_id"),o=c.find(n),r=!o||o.get(e),r||i.get("isStar"))return t.renderProject(i),t.renderFlag(i)}),"null"!==i._id&&b.delay(function(){return t.renderDivider(i)}),s=t.organizationsCollection.get(i._id),l=null!=s?s.getRoleScope():void 0,l>=0||"null"===i._id){if((null!=s?s.isOverdue():void 0)===!0)return;return r=$(n({_id:i._id})),o=t.$(".organization-"+i._id),o.append(r)}}}(this)),this},e.prototype.renderDivider=function(t){var e,i,n;if(this.$el)return e=this.$(".organization-"+t._id),i=t.dividers||[],n=t.projectIds||[],b.each(i,function(t,r){var o,a,c,l,p,u,d;for(l=function(t){return e.find(".project[data-id="+n[t]+"]")},u=t.pos,p=(null!=(d=i[r+1])?d.pos:void 0)||n.length-1,c=l(u);!c.length&&++u<p;)c=l(u);if(c.length)return a=c.prev(),a.hasClass("divider-wrap")&&a.remove(),o=$(s({name:t.name})),o.insertBeforeH(c)}),e.children().first().hasClass("divider")&&e.closest(".organization").addClass("first-divider"),this},e.prototype.renderArchiveProjects=function(){return this.$projectArchivedContent.empty(),this.projectsArchivedCollection.each(function(t){return function(e){var i;return i=e.toJSON(),i.permissions=e.hasPermissions("put.info","put.archive"),i.allUnreadCount=e.getAllUnreadCount(),t.$projectArchivedContent.append(m(i))}}(this)),this},e.prototype.renderProject=function(t){var e,i,n,r;return n=t.get("_organizationId"),e=this.$(".organization-"+n),r=t.toJSON(),r.isOverdue=t.getPaymentPlan().isOverdue,r.permissions=t.hasPermissions("put.info","put.archive"),r.allUnreadCount=t.getAllUnreadCount(),i=$(m(r)),e.append(i),this},e.prototype.removeProject=function(t){return this.$("[data-id="+t.id+"]").remove(),this},e.prototype.refreshProject=function(t){var e;return e=t.toJSON(),e.isOverdue=t.getPaymentPlan().isOverdue,e.permissions=t.hasPermissions("put.info","put.archive"),e.allUnreadCount=t.getAllUnreadCount(),this.$projects.find("[data-id="+t.id+"]").replaceWith(m(e)),this.renderFlag(t),this},e.prototype.enterProject=function(t){var e,i;return e=$(t.currentTarget).data("id"),i=this.projectsCollection.get(e),i.getPaymentPlan().isOverdue?this.requestSubView(y).open(l,{_organizationId:i.get("_organizationId"),projectModel:i,_projectId:e}):w.router.navigate("project/"+e+"/"+i.getFirstApp(),{trigger:!0}),this},e.prototype.editProject=function(t){var e,i;return e=$(t.currentTarget).closest(".project").data("id"),i=this.projectsCollection.get(e),new h({projectModel:i}),!1},e.prototype.flagProject=function(t){var e,i;return e=$(t.currentTarget).closest(".project").data("id"),i=this.projectsCollection.get(e),i.toggleStar({success:function(t){return a.hide(),a.show({message:t.isStar?tb_i18n.get("portal.project.star.success"):tb_i18n.get("portal.project.un.star.success"),status:"success"}),w.gta.event({action:(t.isStar?"":"un")+"star project",control:"Project Cover"})}}),!1},e.prototype.renderFlag=function(t){var e,i,n,r;return n=t.get("isStar"),r=".project[data-id="+t.id+"]",n?(i=this.$projects.find(r),e=this.$flaggedProjects.find(r),e.length?e.replaceWith(i.clone()):this.$flaggedProjects.append(i.clone().addClass("animation")),this.checkFlagged()):(i=this.$flaggedProjects.find(r),i.length&&i.transition({scale:.5,opacity:0},300,function(t){return function(){return i.remove(),t.checkFlagged()}}(this))),this.$(r)[n?"addClass":"removeClass"]("flagged"),this},e.prototype.navigateToOrganization=function(t){var e;return e=$(t.currentTarget).data("id"),w.router.navigate("/organization/"+e+"/projects",{trigger:!0}),this},e.prototype.checkFlagged=function(){return this.$flaggedProjects.parent()[this.$flaggedProjects.children().length?"removeClass":"addClass"]("no-project"),this},e.prototype.checkOrganizationProjects=function(){return this.$(".organization").each(function(){var t;return t=$(this),0===t.find(".project").length?t.addClass("no-organization-project"):t.removeClass("no-organization-project")})},e.prototype.loadArchivedProjects=function(t){var e;return e=b.extend({success:function(){},beforeSend:function(){},error:function(){},attrs:{isArchived:!0}},t),f.fetch("archived_0",e),this},e.prototype.toggleArchivedProjects=function(t){return this.archivedProjectsShown?(this.$projectArchivedContent.empty(),$(t.currentTarget).text(tb_i18n.get("show")),this.archivedProjectsShown=!1,w.gta.event({action:"hide archived projects",control:"Title Link"})):($(t.currentTarget).text(tb_i18n.get("hide")),this.loadArchivedProjects({success:function(t){return function(e){return t.archivedProjectsShown=!0,t.renderArchiveProjects(),w.gta.event({action:"show archived projects",control:"Title Link"})}}(this)}))},e.prototype.unarchiveProject=function(t){var e;if(e=this.projectsArchivedCollection.get($(t.currentTarget).data("id")))return this.requestSubView(o,{title:tb_i18n.get("portal.unarchive.project.title"),description:tb_i18n.get("portal.unarchive.project.description"),onConfirm:function(){return w.gta.event({action:"unarchive content",type:"Project",control:"Project Cover"}),e.save(null,{attrs:{isArchived:!1},success:function(){return a.show({message:tb_i18n.get("portal.unarchive.success"),status:"success"})},error:function(t){return a.show({message:tb_i18n.get("portal.unarchive.error"),status:"error"})}})}})},e.prototype.openProjectCreator=function(t){var e,i;return e=this.$(t.currentTarget),i=e.data("id"),this.requestSubView(y).open(d,{_organizationId:i}),this},e.prototype.remove=function(){return e.__super__.remove.apply(this,arguments),$("#navigator .projects-handler").removeClass("active"),$(window).off(".portal-view")},e}(v)},function(t,e,i){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),n="",r=i(798);i(679);n+='<ul class="project-category"> <li class="project-category-item no-project"> <header class="project-category-header"> <div class="project-category-title">'+tb_i18n.get("flagged.projects")+'</div> <hr> </header> <ul class="projects clearfix flagged-projects"></ul> </li> ';var o=t;if(o)for(var s,a=-1,c=o.length-1;a<c;)s=o[a+=1],n+=" ","null"==s._id?n+=' <li class="project-category-item personal"> <header class="project-category-header"> <div class="project-category-title">'+tb_i18n.get("my.projects")+'</div> <hr> </header> <ul class="projects clearfix organization-null"></ul> </li> ':(n+=' <li class="project-category-item organization"> <header class="project-category-header"> <div class="project-category-title"> '+e(s.name)+" ",s.permissions.getInfo&&(n+='· <a class="navigate-to-organization-handler" data-id="'+s._id+'" data-gta="{action: \'enter organization',s.isOverdue&&(n+=" expiration', type:'organization"),n+="', control: 'Title Link'}\"> "+tb_i18n.get("portal.enter.organization.home.page")+' <span class="icon icon-chevron-right"></span> </a> '),n+=' </div> <hr> </header> <ul class="projects clearfix organization-'+s._id+'"></ul> <div class="placeholder muted"> ',s.isOverdue?(n+=" "+tb_i18n.get("organization.overdue.message")+" ",n+="trial"===s.plan.status?' <a href="'+r.pay.orgNew(s._id)+'" class="organization-pay-link" target="_blank">'+tb_i18n.get("organization.payment.buy")+"</a> ":' <a href="'+r.pay.orgRenew(s._id)+'" class="organization-pay-link" target="_blank">'+tb_i18n.get("organization.buy.now")+"</a> ",n+=" "):n+=' <a class="create-project-handler" data-id="'+s._id+'"> <span class="icon icon-plus"></span> '+tb_i18n.get("portal.create.project")+" </a> ",n+=" </div> </li> "),n+=" ";return n+=' <li class="project-category-item"> <header class="project-category-header"> <div class="project-category-title"> '+tb_i18n.get("archived.projects")+'・ <a class="archived-projects-toggler">'+tb_i18n.get("show")+'</a> </div> <hr> </header> <ul class="projects clearfix archived-projects"></ul> </li></ul>'}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i='<li class="divider-wrap"> <div class="divider-title">'+e(t.name)+"</div></li>";return i}},function(t,e){t.exports=function(t){var e="undefined"!=typeof _encodeHTML?_encodeHTML:function(t){var e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},i=t?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(t){return t?t.toString().replace(i,function(t){return e[t]||t}):""}}(),i="";return t.isArchived?(i+=' <li class="project archived-project card pull-left hinted" data-title="'+e(t.name)+'" data-hinted-delay="1000" data-id="'+t._id+'" style="background-image:url('+t.logo+')"> <div class="project-info"> <h3 class="project-name">'+e(t.name)+'</h3> <p class="project-desc">'+e(t.description)+"</p> </div> ",t.permissions.putArchive&&(i+=' <a class="unarchive-project-handler"> <span class="icon icon-repeat"></span> </a> '),i+=" </li>"):(i+=' <li class="project active-project card pull-left ',t.isStar&&(i+="flagged"),i+=" hinted ","demo"===t.category&&(i+="fullstory-demo"),i+='" data-title="'+e(t.name)+'" data-hinted-delay="1000" data-id="'+t._id+'" style="background-image:url('+t.logo+')" data-gta="{action: ',i+=t.isOverdue?"'enter organization expiration', method: 'click'":"'open detail'",i+=", type: 'Project', control: 'Project Cover', category: '"+t.category+'\'}"> <div class="project-info"> <div> <div class="edit-set pull-right"> ',t.isOverdue?i+=' <a class="icon icon-pencil edit-handler" data-gta="event" data-label="portal||to edit project"></a> ':(i+=" ",t.allUnreadCount&&t.pushStatus?(i+=' <span class="project-cicle ',t.allUnreadCount>=10&&(i+="on-big"),i+=' hinted" data-title="'+tb_i18n.get("portal.project.notification")+'">',i+=t.allUnreadCount>99?"99+":""+t.allUnreadCount,i+="</span> "):t.allUnreadCount&&(i+=' <span class="project-cicle on-white hinted" data-title="'+tb_i18n.get("portal.project.notification")+'"></span> '),i+=' <a class="icon icon-star flag-handler"></a> '),i+=' </div> <h3 class="project-name">'+e(t.name)+'</h3> </div> <p class="project-desc">'+e(t.description)+"</p> </div> ","all"==t.visibility?i+=' <span class="label visibility-label"><span class="icon icon-earth"></span>'+tb_i18n.get("public")+"</span> ":"organization"==t.visibility&&(i+=' <span class="label visibility-label"><span class="icon icon-building"></span>'+tb_i18n.get("organization.visible")+"</span> "),i+=" ",t.isOverdue&&(i+=' <div class="is-overdue"> <hr /> <div class="lock-wrap"> <span class="icon icon-lock"></span> </div> </div> '),i+=" </li>"),i}},function(t,e){t.exports=function(t){var e='<li class="project card pull-left add-project-button"><a class="create-project-handler"data-gta="{action: \'add content\', type: \'project\', control: \'Project Cover\'}"data-id="'+t._id+'"><span class="icon icon-circle-cross"></span><span class="add-project-button-label">'+tb_i18n.get("portal.create.project")+"</span></a></li>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){return function(){return t.apply(e,arguments)}},h=function(t,e){function i(){this.constructor=t}for(var n in e)m.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},m={}.hasOwnProperty;u=i(358),o=i(401),n=i(1908),r=i(976),s=i(677),a=i(788),p=i(810),c=i(966),t.exports=l=function(t){function e(){return this.close=d(this.close,this),this.removeWork=d(this.removeWork,this),e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.viewName="WorksBackgroundUploaderView",e.prototype.tagName="section",e.prototype.className="works-background-uploader",e.prototype.events={"click .maximize-creator":"maximize","click .minimize-creator":"minimize","click .close-creator":"closeCreator"},e.prototype.initialize=function(){return this.total=0,this.uploadedCount=0,this.renderBasic(),this},e.prototype.listen=function(t){return this.listenTo(t,"add",this.renderWork),this.listenTo(t,"remove",function(e){return function(){return e.removeWork(),e.checkUpload(t)}}(this)),this.listenTo(t,"change:completed",function(e){return function(i,n){return e.uploadedCount++,e.checkUpload(t)}}(this)),this},e.prototype.renderBasic=function(){return this.$el.html(n()),this.$workSet=this.$(".work-set"),this.$title=this.$(".card-title-doing"),this.$maxHandle=this.$(".maximize-creator"),this.$minHandle=this.$(".minimize-creator"),this},e.prototype.renderWorks=function(t){return t.each(function(t){return function(e){return t.renderWork(e)}}(this)),this},e.prototype.renderWork=function(t){return this.requestSubView(c,{workModel:t,isBackground:!0}).$el.addClass("card").prependTo(this.$workSet),this.total++,this.refreshTitle(),this.maximize(),this},e.prototype.addWorks=function(t,e){return t.inWorksBgUploader=!0,t._projectId=e._projectId,t.success=e.success||function(){},this.uploadedCount+=t.length-t.getUploadingCount(),this.listen(t),this},e.prototype.removeWork=function(){return this.total--,this.total>0?this.refreshTitle():(this.total=0,this.uploadedCount=0,this.$el.hide(),this.$workSet.empty()),this},e.prototype.checkUpload=function(t){return this.refreshTitle(),t.getUploadingCount()||this.submit(t),this},e.prototype.submit=function(t){var e;return e=t.toJSON().filter(function(t){return!t.isUpdateVersion}),t.addWorks(e,{_projectId:t._projectId,success:function(e){return function(i){var n;return null!=(n=p.find(t._boundToObjectId))&&n.add(i),t.reset(null,{silent:!0}),t.inWorksBgUploader=!1,t.success(i),e.stopListening(t),e.refreshTitle(),u.delay(function(){if(e.uploadedCount===e.total)return e.minimize()},2e3)}}(this),error:function(t){return function(){return o.show({message:tb_i18n.get("works.background.uploader.error"),status:"error"}),t.minimize()}}(this)}),this},e.prototype.refreshTitle=function(){var t,e;return t=this.uploadedCount,e=this.total,t===e?this.$title.text(tb_i18n.get("works.background.uploader.uploaded")):this.$title.text(tb_i18n.get("works.background.uploader.uploading",t,e)),this},e.prototype.closeCreator=function(){return this.uploadedCount===this.total?this.close():this.requestSubView(r,{title:tb_i18n.get("works.background.uploader.close.confirm.title"),description:tb_i18n.get("works.background.uploader.close.confirm"),onConfirm:function(t){return function(){return u.each(t.subViews,function(t){var e;return null!=(e=t.workModel)?e.removeFile():void 0}),t.close()}}(this)})},e.prototype.close=function(){return this.total=0,this.uploadedCount=0,this.$el.hide(),this.$workSet.empty(),this},e.prototype.maximize=function(){return this.$el.removeClass("minimize").show(),this},e.prototype.minimize=function(){return this.$el.addClass("minimize").show(),this},e}(a)},function(t,e){t.exports=function(t){var e='<div class="card"> <div class="card-header"> <p class="card-title"> <span class="card-title-doing"></span> </p> <a class="maximize-creator pi pi-window-max"></a> <a class="minimize-creator pi pi-window-min"></a> <a class="close-creator icon icon-remove"></a> </div> <ul class="work-set clearfix thin-scroll"></ul></div>';return e}},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(358),n=i(1535),o=i(1285),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="taskDetailPanel",e.prototype.className="task-detail-panel panel-view",e.prototype.defaultLayer=o,e.prototype.delayRatio=.5,e.prototype.initialize=function(t){return!(!t||!t.taskModel&&!t._taskId)&&(this._taskId=t._taskId||t.taskModel.id,s.isNumber(t.rightOffset)&&(this.rightOffset=t.rightOffset),e.__super__.initialize.apply(this,arguments))},e.prototype.isSame=function(t){var e,i;return e=t._taskId||(null!=(i=t.taskModel)?i.id:void 0),e===this._taskId},e}(n)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(358),n=i(1535),r=i(1277),t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="PostPanelView",e.prototype.className="post-panel panel-view",e.prototype.defaultLayer=r,e.prototype.delayRatio=.5,e.prototype.initialize=function(t){return!(!t||!t.postModel&&!t._postId)&&(this._postId=t._postId||t.postModel.id,s.isNumber(t.rightOffset)&&(this.rightOffset=t.rightOffset),e.__super__.initialize.apply(this,arguments))},e.prototype.isSame=function(t){var e,i;return e=t._postId||(null!=(i=t.postModel)?i.id:void 0),e===this._postId},e}(n)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(358),r=i(1228),o=i(1535),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="EventDetailPanel",e.prototype.className="event-detail-panel panel-view",e.prototype.defaultLayer=r,e.prototype.delayRatio=.5,e.prototype.initialize=function(t){var i,n;return!(!t||!t.eventModel&&!t._eventId)&&((null!=(i=t.eventModel)?i.fakeId:void 0)?this._eventId=t.eventModel.fakeId:this._eventId=t._eventId||(null!=(n=t.eventModel)?n.id:void 0),s.isNumber(t.rightOffset)&&(this.rightOffset=t.rightOffset),e.__super__.initialize.apply(this,arguments))},e.prototype.isSame=function(t){var e,i;return(null!=(e=t.eventModel)?e.fakeId:void 0)?this._eventId===t.eventModel.fakeId:this._eventId===(t._eventId||(null!=(i=t.eventModel)?i.id:void 0))},e}(o)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i(358),n=i(795),o=i(1535),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.viewName="EntryDetailPanelView",e.prototype.className="entry-detail-panel panel-view",e.prototype.defaultLayer=n,e.prototype.delayRatio=.5,e.prototype.initialize=function(t){if(!(null!=t?t._entryId:void 0))throw new Error(this.viewName+":options should have _entryId");return this._entryId=t._entryId,s.isNumber(t.rightOffset)&&(this.rightOffset=t.rightOffset),e.__super__.initialize.apply(this,arguments)},e.prototype.isSame=function(t){var e;return e=t._entryId,e===this._entryId},e}(o)},function(t,e,i){t.exports=i.p+"images/reminder@2x.103bba93.png"},function(t,e,i){t.exports=i.p+"images/default@2x.3a9b6092.png"},function(t,e,i){var n,r,o,s=[].slice;o=i(358),n=i(357),t.exports=r=function(){function t(){this.hookerSet={},this.eventsLog={},this.on("all",this.logEvent,this)}return t.prototype.name="hook",t.prototype.triggerBefore=function(t,e,i){var n;return n=this.getHookers(t),o.each(n,function(t){return e.apply(i,t)})},t.prototype.logEvent=function(){var t,e,i,n,r;if(e=arguments[0],r=arguments[1],t=3<=arguments.length?s.call(arguments,2):[],null!=r?r.cid:void 0)return n=this.getHookers(e),t.unshift(r),n[r.cid]=t,i=this.getLogEvents(r.cid),i[e]=!0},t.prototype.removeLog=function(t,e){var i,n;if((null!=t?t.cid:void 0)&&this.eventsLog[t.cid])return e?(n=this.getHookers(e),delete n[t.cid]):(i=this.getLogEvents(t.cid),o.each(i,function(e){return function(i,n){return e.removeLog(t,n)}}(this))),delete this.eventsLog[t.cid]},t.prototype.getHookers=function(t){return this.getDefaultObj(this.hookerSet,t)},t.prototype.getLogEvents=function(t){return this.getDefaultObj(this.eventsLog,t)},t.prototype.getDefaultObj=function(t,e){var i;return i=t[e],i||(i={},t[e]=i),i},t}(),o.extend(r.prototype,n.Events)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;i(1917),p=i(358),u=i(678),l=i(788),n=i(1920),a=i(1921),r=i(1922),s="on-open",o="on-hide",t.exports=c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.viewName="UserSatisfactionView",e.prototype.className="user-satisfaction-view",e.prototype.userId=null,e.prototype.score=-1,e.prototype.events={"click .satisfaction-switcher":"toggle","click .satisfaction-circle":"handleSatisfaction","focus .satisfaction-feedback-input":"showSubmit","blur .satisfaction-feedback-input":"hideSubmit","click .reply-handler":"submitFeedback","keyup .satisfaction-feedback-input":"quickSubmit"},e.prototype.initialize=function(t){return this.userId=t,this.$el.html(n()),this.$form=this.$(".satisfaction-form"),this.enterScore()},e.prototype.toggle=function(){var t;return this.$el.toggleClass(s),t=this.$el.hasClass(s)?"start":"close","close"===t&&this.score>=0&&p.delay(function(t){return function(){return t.remove()}}(this),300),u.gta.event({action:t+" nps"})},e.prototype.handleSatisfaction=function(t){return this.score=$(t.currentTarget).data("index"),this.enterFeedback(),u.ab.createNPS(this.userId,this.score)["catch"](function(t){return function(){return t.enterScore()}}(this)),u.gta.event({action:"add content",type:"nps score",category:this.score})},e.prototype.showSubmit=function(t){return $(t.currentTarget).parent().addClass(s)},e.prototype.hideSubmit=function(t){var e;if(e=this.$(".satisfaction-feedback-input").val(),!e)return $(t.currentTarget).parent().removeClass(s)},e.prototype.quickSubmit=function(t){if(13===t.keyCode&&(t.ctrlKey||t.metaKey||t.shiftKey))return t.preventDefault(),this.submitFeedback(t)},e.prototype.submitFeedback=function(t){var e,i;return e=$(t.currentTarget),e.attr("disabled","disabled"),i=this.$(".satisfaction-feedback-input").val(),u.ab.createFeedback(u.user.id,i).then(function(t){return function(){return t.hide()}}(this))["catch"](function(){return e.removeAttr("disabled")}),u.gta.event({action:"add content",type:"nps feedback"})},e.prototype.enterScore=function(){return this.$form.html(a())},e.prototype.enterFeedback=function(){var t;return this.$el.addClass("nps-feedback"),t=this.getSatisfactioneLevel(),this.$form.html(r(t))},e.prototype.getSatisfactioneLevel=function(){return this.score<=6?0:this.score<=8?1:2},e.prototype.hide=function(){return this.$el.addClass(o),p.delay(function(t){return function(){return t.remove()}}(this),218)},e}(l)},function(t,e){},,,function(t,e){t.exports=function(t){var e='<div class="satisfaction-form"></div><div class="satisfaction-switcher"> <a class="icon icon-star"></a> <a class="icon icon-remove"></a></div><div class="satisfaction-switcher-shadow"></div>';return e}},function(t,e){t.exports=function(t){var e="",i=new Array(11).fill(0);e+='<div class="satisfaction-score-wrap"> <h5 class="satisfaction-form-header"> '+tb_i18n.get("user.satisfaction.recommend")+' </h5> <div class="satisfaction-circle-wrap row-flex"> ';var n=i;if(n)for(var r,o=-1,s=n.length-1;o<s;)r=n[o+=1],e+=' <a class="satisfaction-circle" data-index="'+o+'">'+o+"</a> ";return e+=' </div> <div class="satisfaction-description row-flex"> <header> '+tb_i18n.get("user.satisfaction.bad")+' </header> <section> <div class="satisfaction-description-line"></div> </section> <footer> '+tb_i18n.get("user.satisfaction.good")+" </footer> </div></div>"}},function(t,e){t.exports=function(t){var e="<!--tb_i18n.get('user.satisfaction.feedback.0')tb_i18n.get('user.satisfaction.feedback.1')tb_i18n.get('user.satisfaction.feedback.2')--><div class=\"satisfaction-feedback-wrap\"> <h5 class=\"satisfaction-form-header\"> "+tb_i18n.get("user.satisfaction.feedback."+t)+' </h5> <div class="satisfaction-input-wrap clearfix"> <textarea class="satisfaction-feedback-input form-control" placeholder="'+tb_i18n.get("user.satisfaction.placeholder")+'"></textarea> <a class="btn btn-primary reply-handler pull-right"> '+tb_i18n.get("user.satisfaction.send")+" </a> </div></div>";return e}},function(t,e,i){var n,r,o,s,a,c,l,p,u=function(t,e){function i(){this.constructor=t}for(var n in e)d.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},d={}.hasOwnProperty;a=i(358),p=i(678),c=i(679),o=i(680),r=i(357),l=i(1924),s=i(429),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.name="abtest",e.prototype.fetch=function(t){return c.AB_HOST?this._ajax("cohort/"+t,null,{silentError:!0,type:"GET"}).then(function(t){return function(e){return t.set(e)}}(this))["catch"](function(){}):Promise.resolve()},e.prototype.createNPS=function(t,e){var i;return c.AB_HOST?(i=this._data(t,{npsScore:e}),this._ajax("nps",i,{type:"POST"})):Promise.resolve()},e.prototype.createFeedback=function(t,e){var i;return c.AB_HOST?(i=this._data(t,{feedback:e}),this._ajax("nps/feedback",i,{type:"POST"})):Promise.resolve()},e.prototype.hasTest=function(t){return this._judage(l[t])||this._judage(t)},e.prototype._options=function(t,e,i){var n,r,o;return t=c.AB_HOST+"/api/v1/"+t,r={Authorization:"JWT "+c.AB_AUTHORIZATION},n="application/json",o=a.extend({},i,{url:t,data:e,headers:r,contentType:n}),o.data&&(o.data=JSON.stringify(o.data)),o},e.prototype._data=function(t,e){var i,n,r;return r=t,i=s().format("YYYY-M-D"),n=p.gta.page,a.extend({},e,{userKey:r,created:i,page:n})},e.prototype._ajax=function(t,e,i){return o.ajax(this._options(t,e,i))},e.prototype._judage=function(t){var e;return e=this.get("cohorts"),Boolean(~a.findIndex(e,{name:t}))},e}(r.Model)},function(t,e){t.exports={international:"us-region-test"}},function(t,e,i){var n,r,o,s=function(t,e){function i(){this.constructor=t}for(var n in e)a.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},a={}.hasOwnProperty;o=i(358),r=i(688),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.name="abtests",e.prototype.urlRoot="preferences",e.prototype.registedTest=[],e.prototype.register=function(t){return o.isArray(t)?o.each(t,function(t){return function(e){return t.set(e,!1),t.registedTest.push(e)}}(this)):o.isObject(t)?o.each(t,function(t){return function(e,i){return t.set(i,e),t.registedTest.push(i)}}(this)):2===arguments.length?(this.set.apply(this,arguments),this.registedTest.push(t)):void 0},e.prototype.parse=function(t){return o.assign(this.toJSON(),t.abtest||t)},e.prototype.sync=function(t,i,n){switch(null==n&&(n={}),t){case"update":return n.url=this.urlRoot+"/abtest",n.attrs=o.pick(this.attributes,this.registedTest),e.__super__.sync.apply(this,arguments);case"read":return n.url=this.urlRoot,this.registedTest.length&&(n.data||(n.data={}),n.data.abtest=this.registedTest,n.traditional=!0),e.__super__.sync.apply(this,arguments)}},e.prototype.isNew=function(){return!1},e.prototype.listTest=function(){return o.keys(this.attributes)},e.prototype.toGTAProperties=function(){var t;return t=o.pick(this.attributes,this.registedTest),o.map(t,function(t,e){return(e+"."+t).toLowerCase()})},e}(r)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,
t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty,m=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};a=i(358),p=i(678),c=i(679),r=i(429),n=i(688),s=i(681),l=s.namespace("preference"),u=function(t){var e,i;return i=location.host.split(".").slice(-2),i[1]>=0||(e=i.join(".")),$.removeCookie("lang"),$.cookie("lang",t,{expires:7,path:"/",domain:e||location.host})},t.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.name="preference",e.prototype.urlRoot="preferences",e.prototype.defaults={memberBarMode:"mini",hideDoneTasks:0,postMode:"html",quickCreateTask:!1,quickReply:!1,tips:{}},e.prototype.initialize=function(){var t;return this.localCacheId=this.get("_userId"),t=l(this.localCacheId),t&&this.set(t),this.on("change",function(t){return function(){return l(t.localCacheId,t.toJSON())}}(this)),e.__super__.initialize.apply(this,arguments)},e.prototype.toggleMemberBarMode=function(t){var e;return null==t&&(t="full"===this.get("memberBarMode")?"mini":"full"),p.user.get("isGhost")?this.set("memberBarMode",t):(e={memberBarMode:t},this.save(e,{attrs:e})),t},e.prototype.quickReply=function(t){var e;return e={quickReply:!!t},null!=t&&this.save(e,{attrs:e}),this.get("quickReply")},e.prototype.quickCreateTask=function(t){var e;return e={quickCreateTask:!!t},null!=t&&this.save(e,{attrs:e}),this.get("quickCreateTask")},e.prototype.togglePostMode=function(t){var e;return e={postMode:t},t&&this.save(e,{attrs:e}),this.get("postMode")},e.prototype.toggleTasklistBar=function(t){return null!=t&&this.set("pinTasklistBar",!!t),this.get("pinTasklistBar")},e.prototype.tempMark=function(t,e){return null!=e&&l("temp_"+t,e),l("temp_"+t)},e.prototype.tasklistSortInProject=function(t,e){var i,n;return n=this.get("tasklist")||{},this.get("tasklist")||this.set("tasklist",n),a.isArray(e)&&!a.isEqual(e,n[t])&&(n[t]=e,i={},i[t]=e,this.saveAttr("tasklist",i)),n[t]||[]},e.prototype.structureNotification=function(t){var e,i,n,r,o,s,a,c,l,p,u,d,h,m,f,g,v,y,b,k,w;e=this.attributes.notification,r={comment:{mobile:null!=(o=e.comment)?o.mobile:void 0,email:null!=(s=e.comment)?s.email:void 0},involve:{mobile:null!=(h=e.involve)?h.mobile:void 0,email:null!=(m=e.involve)?m.email:void 0},newpost:{mobile:null!=(f=e.newpost)?f.mobile:void 0,email:null!=(g=e.newpost)?g.email:void 0},newtask:{mobile:null!=(v=e.newtask)?v.mobile:void 0,email:null!=(y=e.newtask)?y.email:void 0},newwork:{mobile:null!=(b=e.newwork)?b.mobile:void 0,email:null!=(k=e.newwork)?k.email:void 0},newevent:{mobile:null!=(a=e.newevent)?a.mobile:void 0,email:null!=(c=e.newevent)?c.email:void 0},update:{mobile:null!=(l=e.update)?l.mobile:void 0,email:null!=(p=e.update)?p.email:void 0},daily:{email:null!=(u=e.daily)?u.email:void 0},monthly:{email:null!=(d=e.monthly)?d.email:void 0}};for(i in t)w=t[i],n=i.split("."),r[n[0]][n[1]]=w;return r},e.prototype.updateNotification=function(t,e){var i;return e||(e={}),i={notification:this.structureNotification(t)},e.attrs=i,this.save(i,e),this},e.prototype.updateFeatureGuide=function(t,e){var i;return null==e&&(e={}),i=a.clone(this.get("tips")),i[t]=!0,e.url=this.url()+"/tips",this.save({tips:i},e),this},e.prototype.initLanguage=function(){var t;return t=this.getLanguage(),$("html").attr("lang",t),r.locale(t),tb_i18n.setLanguage(t),u(t),"function"==typeof window.initNwPlugin?window.initNwPlugin(t):void 0},e.prototype.getLanguage=function(){var t,e,i,n;return i={"zh-TW":"zh_tw"},t=c.acceptLanguages,n=c.LANGUAGES,e=tb_i18n.guessLanguage(t,n,i),this.get("language")||e},e.prototype.setLanguage=function(t){return t!==this.get("language")&&(!(m.call(c.LANGUAGES,t)<0)&&this.save({language:t},{attrs:{language:t},success:function(e){return function(){return e.initLanguage(),u(t),p.APP.reset(),p.router.loadUrl()}}(this)}))},e.prototype.getIsUsePanelToOpenTask=function(){return this.get("isUsePanel")||"slide"===this.get("openWindowMode")},e}(n)},function(t,e,i){var n,r,o,s,a=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty,l=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};s=i(358),o=i(685),n=i(1928),t.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.name="applications",e.prototype.url="/applications",e.prototype.model=n,e.prototype.getCommonApps=function(){return this._filterAppsByType(0)},e.prototype.getNavApps=function(){return this._filterAppsByType(1)},e.prototype.getPremiumApps=function(){return this._filterAppsByType(2)},e.prototype.getOnlineApps=function(){return this.filter(function(t){return"online"===t.get("status")})},e.prototype.getOnlineAppNames=function(){return s.map(this.getOnlineApps(),function(t){return t.get("name")})},e.prototype.getPlugins=function(){return this._filterAppsByType([0,2])},e.prototype.checkIsAppOnline=function(t){return null!=this.findWhere(function(e){return e.get("name")===t&&"online"===e.get("status")})},e.prototype.checkIsPremiumApp=function(t){return null!=this.findWhere(function(e){return e.get("name")===t&&2===e.get("type")})},e.prototype._filterAppsByType=function(t){return t instanceof Array||(t=[t]),s.filter(this.getOnlineApps(),function(e){var i;return i=e.get("type"),l.call(t,i)>=0})},e}(o)},function(t,e,i){var n,r,o=function(t,e){function i(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},s={}.hasOwnProperty;r=i(688),t.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.name="application",e}(r)},function(t,e,i){var n,r,o,s,a,c,l,p,u,d=function(t,e){function i(){this.constructor=t}for(var n in e)h.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;l=i(358),u=i(678),c=i(788),p=i(679),s=i(429),o=i(680),r=i(1930),n=$("body"),t.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.viewName="ProOverdueTip",e.prototype.className="pro-overdue-tips col-flex",e.prototype.events={"click .enter-free-version":"enterFreeVersion"},e.prototype.initialize=function(t){return e.__super__.initialize.apply(this,arguments),this.renderBasic()},e.prototype.renderBasic=function(){var t;return this.$el.html(r()),n.addClass("modal-open"),t=this.$(".version-tips-wrap").css({opacity:0,top:28}),l.delay(function(){return t.transition({opacity:1,top:50},318,"ease-out")},500)},e.prototype.hide=function(){if(!this.isHidden)return this.isHidden=!0,this.parentView.$el.transition({opacity:0},318,function(t){return function(){var e;return null!=(e=t.parentView)?e.remove():void 0}}(this))},e.prototype.enterFreeVersion=function(){return o.ajax({method:"PUT",url:"/api/users/me/trial",success:function(t){return function(e){return u.router.gotoTeambition(),t.hide()}}(this)})},e}(c)},function(t,e,i){t.exports=function(t){var e="",n=i(798),r=i(1931);return e+='<div class="version-tips-wrap"> <a class="modal-close icon icon-remove"  data-dismiss="modal" data-gta="event" data-label="close profession-tip"></a> <div class="version-tips-content"> <img class="image" src="'+r+'" alt=""> <h4 class="title"> <span>'+tb_i18n.get("globalGuide.version.profession.overdue")+'</span> </h4> <div class="update-content"> <p> <span>'+tb_i18n.get("globalGuide.profession.account.tip")+'</span> </p> </div> <a class="btn btn-primary pro-version first-btn" href="'+n.pay.userRenew+'" target="_blank" data-gta="{action: \'pay for profession version\'}"> '+tb_i18n.get("globalGuide.prefession.paynow")+' </a> <a class="btn btn-primary enter-free-version second-btn" data-gta="{action: \'enter free version\'}"> '+tb_i18n.get("globalGuide.prefession.goonfree")+" </a> </div></div>"}},function(t,e,i){t.exports=i.p+"images/pro.cb1405d4.png"}]);